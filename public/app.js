(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var abcjs = require("abcjs");
var SCRAPBOXURL = "https://scrapbox.io/stk-study-music-theory/";
var inputEl = document.getElementById("abcinput");
var parseLink = function (abc) {
    var parsedLinks = [];
    var linkMached = abc.match(/%Links:.*/);
    console.log("parseLink", "linkMatched", linkMached);
    if (!linkMached) {
        return [];
    }
    var linkStr = linkMached[0].replace(/%Links:/, "");
    var links = linkStr.split(",");
    console.log("parseLink", "links", links);
    if (links.length < 1) {
        return [];
    }
    for (var _i = 0, links_1 = links; _i < links_1.length; _i++) {
        var link = links_1[_i];
        var arr = link.split(" ");
        if (arr.length < 2)
            continue;
        parsedLinks.push({ startChar: Number(arr[0]), pageTitle: arr[1] });
    }
    console.log("parseLink", "parsedLinks", parsedLinks);
    return parsedLinks;
};
var generateClickListener = function (links) {
    return function (abcElem, tuneNumber, classes) {
        console.log("abcClickListener", abcElem, tuneNumber, classes);
        if (!abcElem.el_type || !links.length) {
            return;
        }
        for (var _i = 0, links_2 = links; _i < links_2.length; _i++) {
            var link = links_2[_i];
            if (link.startChar === abcElem.startChar) {
                console.log("abcClickListener", "Linked note is clicked.", "startChar:", link.startChar);
                window.open(SCRAPBOXURL + link.pageTitle);
            }
        }
    };
};
var render = function (abc, links) {
    var options = {
        clickListener: generateClickListener(links),
        add_classes: true
    };
    abcjs.renderAbc("svgoutput", abc, options);
};
inputEl.addEventListener("input", function (e) {
    var ABC = e.target.value;
    render(ABC, parseLink(ABC));
});

},{"abcjs":2}],2:[function(require,module,exports){
var animation = require('./src/api/abc_animation');
var tuneBook = require('./src/api/abc_tunebook');

var abcjs = {};

abcjs.signature = "abcjs-basic v5.3.2";

Object.keys(animation).forEach(function (key) {
	abcjs[key] = animation[key];
});

Object.keys(tuneBook).forEach(function (key) {
	abcjs[key] = tuneBook[key];
});

abcjs.renderAbc = require('./src/api/abc_tunebook_svg');
abcjs.TimingCallbacks = require('./src/api/abc_timing_callbacks');

var editor = require('./src/edit/abc_editor');
abcjs['Editor'] = editor;

module.exports = abcjs;

},{"./src/api/abc_animation":3,"./src/api/abc_timing_callbacks":4,"./src/api/abc_tunebook":5,"./src/api/abc_tunebook_svg":6,"./src/edit/abc_editor":8}],3:[function(require,module,exports){
//    abc_animation.js: handles animating the music in real time.
//    Copyright (C) 2014-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var spacing = require('../write/abc_spacing');
var parseCommon = require('../parse/abc_common');
var TimingCallbacks = require('./abc_timing_callbacks');

var animation = {};

(function() {
	"use strict";

	var timer;
	var cursor;
	animation.startAnimation = function(paper, tune, options) {
		//options.bpm
		//options.showCursor
		//options.hideCurrentMeasure
		//options.hideFinishedMeasures
		if (timer) {
			timer.stop();
			timer = undefined;
		}

		if (options.showCursor && !paper.querySelector('.abcjs-cursor')) {
			cursor = document.createElement('DIV');
			cursor.className = 'abcjs-cursor cursor';
			cursor.style.position = 'absolute';

			paper.appendChild(cursor);
			paper.style.position = 'relative';
		}

		function hideMeasures(elements) {
			for (var i = 0; i < elements.length; i++) {
				var element = elements[i];
				if (!element.classList.contains('abcjs-bar'))
					element.style.display = "none";
			}
		}

		var lastMeasure;
		function disappearMeasuresAfter(selector) {
			if (lastMeasure) {
				var elements = paper.querySelectorAll(lastMeasure);
				hideMeasures(elements);
			}
			lastMeasure = selector;
		}

		function disappearMeasuresBefore(selector) {
			var elements = paper.querySelectorAll(selector);
			hideMeasures(elements);
		}

		function measureCallback(selector) {
			if (options.hideCurrentMeasure) {
				disappearMeasuresBefore(selector);
			} else if (options.hideFinishedMeasures) {
				disappearMeasuresAfter(selector);
			}
		}

		function getLineAndMeasure(element) {
			return '.abcjs-l' + element.line + '.abcjs-m' + element.measureNumber;
		}

		function setCursor(range) {
			if (range) {
				if (range.measureStart) {
					var selector = getLineAndMeasure(range);
					if (selector)
						measureCallback(selector);
				}
				cursor.style.left = range.left + "px";
				cursor.style.top = range.top + "px";
				cursor.style.width = range.width + "px";
				cursor.style.height = range.height + "px";
			} else {
				timer.stop();
				timer = undefined;
			}
		}

		timer = new TimingCallbacks(tune, {
			qpm: options.bpm,
			eventCallback: setCursor
		});
		timer.start();
	};

	animation.pauseAnimation = function(pause) {
		if (pause)
			timer.pause();
		else
			timer.start();
	};

	animation.stopAnimation = function() {
		timer.stop();
		timer = undefined;
	};

})();

module.exports = animation;

},{"../parse/abc_common":9,"../write/abc_spacing":32,"./abc_timing_callbacks":4}],4:[function(require,module,exports){

var TimingCallbacks = function(target, params) {
	var self = this;
	if (!params) params = {};
	self.qpm = params.qpm;
	if (!self.qpm) {
		var tempo = target.metaText ? target.metaText.tempo : null;
		self.qpm = target.getBpm(tempo);
	}
	self.extraMeasuresAtBeginning = params.extraMeasuresAtBeginning ? params.extraMeasuresAtBeginning : 0;
	self.beatCallback = params.beatCallback; // This is called for each beat.
	self.eventCallback = params.eventCallback;   // This is called for each note or rest encountered.
	self.lineEndCallback = params.lineEndCallback;   // This is called when the end of a line is approaching.
	self.lineEndAnticipation = params.lineEndAnticipation ? params.lineEndAnticipation : 0;   // How many milliseconds before the end should the call happen.

	self.replaceTarget = function(newTarget) {
		newTarget.setTiming(self.qpm, self.extraMeasuresAtBeginning);
		if (newTarget.noteTimings.length === 0)
			return;
		if (self.lineEndCallback) {
			self.lineEndTimings = getLineEndTimings(newTarget.noteTimings, self.lineEndAnticipation);
		}
		self.noteTimings = newTarget.noteTimings;
	};

	self.replaceTarget(target);
	if (self.noteTimings.length === 0)
		return;

	// noteTimings contains an array of events sorted by time. Events that happen at the same time are in the same element of the array.
	self.noteTimings = target.noteTimings;
	self.millisecondsPerBeat = 1000 / (self.qpm / 60);
	self.lastMoment = self.noteTimings[self.noteTimings.length-1].milliseconds;

	self.startTime = null;
	self.currentBeat = 0;
	self.currentEvent = 0;
	self.isPaused = false;
	self.pausedTime = null;
	self.justUnpaused = false;

	self.doTiming = function(timestamp) {
		if (!self.startTime) {
			self.startTime = timestamp;
		} else if (self.justUnpaused) {
			// Add the amount we paused to the start time to get the right place.
			var timePaused = (timestamp - self.pausedTime);
			self.startTime += timePaused;
		}
		self.justUnpaused = false;

		if (self.isPaused) {
			self.pausedTime = timestamp;
		} else {
			var currentTime = timestamp - self.startTime;
			currentTime += 50; // Add a little slop because this function isn't called exactly.
			if (currentTime < self.lastMoment)
				requestAnimationFrame(self.doTiming);

			if (self.currentBeat * self.millisecondsPerBeat < currentTime) {
				if (self.beatCallback)
					self.beatCallback(self.currentBeat);
				self.currentBeat++;
			}

			while (self.noteTimings.length > self.currentEvent && self.noteTimings[self.currentEvent].milliseconds < currentTime) {
				if (self.eventCallback)
					self.eventCallback(self.noteTimings[self.currentEvent]);
				self.currentEvent++;
			}

			if (self.lineEndCallback && self.lineEndTimings.length && self.lineEndTimings[0].milliseconds <= currentTime) {
				self.lineEndCallback(self.lineEndTimings[0]);
				self.lineEndTimings.shift();
			}

			if (currentTime >= self.lastMoment &&self.eventCallback)
				self.eventCallback(null);
			}
	};

	self.start = function() {
		if (self.isPaused) {
			self.isPaused = false;
			self.justUnpaused = true;
		}
		requestAnimationFrame(self.doTiming);
	};
	self.pause = function() {
		self.isPaused = true;
	};
	self.reset = function() {
		self.currentBeat = 0;
		self.currentEvent = 0;
		self.startTime = null;
		self.pausedTime = null;
		if (self.lineEndCallback) {
			self.lineEndTimings = getLineEndTimings(self.noteTimings, self.lineEndAnticipation);
		}
	};
	self.stop = function() {
		self.pause();
		self.reset();
	};
};

function getLineEndTimings(timings, anticipation) {
	// Returns an array of milliseconds to call the lineEndCallback.
	// This figures out the timing of the beginning of each line and subtracts the anticipation from it.
	var callbackTimes = [];
	var lastTop = null;
	for (var i = 0; i < timings.length; i++) {
		var timing = timings[i];
		if (timing.top !== lastTop) {
			callbackTimes.push({ milliseconds: timing.milliseconds - anticipation, top: timing.top, bottom: timing.top+timing.height });
			lastTop = timing.top;
		}
	}
	return callbackTimes;
}

module.exports = TimingCallbacks;


},{}],5:[function(require,module,exports){
//    abc_tunebook.js: splits a string representing ABC Music Notation into individual tunes.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

/*global document */
/*global window, ABCJS, console */

var parseCommon = require('../parse/abc_common');
var Parse = require('../parse/abc_parse');

var tunebook = {};

(function() {
	"use strict";

	tunebook.numberOfTunes = function(abc) {
		var tunes = abc.split("\nX:");
		var num = tunes.length;
		if (num === 0) num = 1;
		return num;
	};

	var TuneBook = tunebook.TuneBook = function(book) {
		var This = this;
		var directives = "";
		book = parseCommon.strip(book);
		var tunes = book.split("\nX:");
		for (var i = 1; i < tunes.length; i++)	// Put back the X: that we lost when splitting the tunes.
			tunes[i] = "X:" + tunes[i];
		// Keep track of the character position each tune starts with.
		var pos = 0;
		This.tunes = [];
		parseCommon.each(tunes, function(tune) {
			This.tunes.push({ abc: tune, startPos: pos});
			pos += tune.length + 1; // We also lost a newline when splitting, so count that.
		});
		if (This.tunes.length > 1 && !parseCommon.startsWith(This.tunes[0].abc, 'X:')) {	// If there is only one tune, the X: might be missing, otherwise assume the top of the file is "intertune"
			// There could be file-wide directives in this, if so, we need to insert it into each tune. We can probably get away with
			// just looking for file-wide directives here (before the first tune) and inserting them at the bottom of each tune, since
			// the tune is parsed all at once. The directives will be seen before the engraver begins processing.
			var dir = This.tunes.shift();
			var arrDir = dir.abc.split('\n');
			parseCommon.each(arrDir, function(line) {
				if (parseCommon.startsWith(line, '%%'))
					directives += line + '\n';
			});
		}
		This.header = directives;

		// Now, the tune ends at a blank line, so truncate it if needed. There may be "intertune" stuff.
		parseCommon.each(This.tunes, function(tune) {
			var end = tune.abc.indexOf('\n\n');
			if (end > 0)
				tune.abc = tune.abc.substring(0, end);
			tune.pure = tune.abc;
			tune.abc = directives + tune.abc;

			// for the user's convenience, parse and store the title separately. The title is between the first T: and the next \n
			var title = tune.pure.split("T:");
			if (title.length > 1) {
				title = title[1].split("\n");
				tune.title = title[0].replace(/^\s+|\s+$/g, '');
			} else
				tune.title = "";

			// for the user's convenience, parse and store the id separately. The id is between the first X: and the next \n
			var id = tune.pure.substring(2, tune.pure.indexOf("\n"));
			tune.id = id.replace(/^\s+|\s+$/g, '');
		});
	};

	TuneBook.prototype.getTuneById = function(id) {
		for (var i = 0; i < this.tunes.length; i++) {
			if (this.tunes[i].id === id)
				return this.tunes[i];
		}
		return null;
	};

	TuneBook.prototype.getTuneByTitle = function(title) {
		for (var i = 0; i < this.tunes.length; i++) {
			if (this.tunes[i].title === title)
				return this.tunes[i];
		}
		return null;
	};

	tunebook.parseOnly = function(abc, params) {
		var tunes = [];
		var numTunes = tunebook.numberOfTunes(abc);

		// this just needs to be passed in because this tells the engine how many tunes to process.
		var output = [];
		for (var i = 0; i < numTunes; i++) {
			output.push(1);
		}
		function callback() {
			// Don't need to do anything with the parsed tunes.
		}
		return tunebook.renderEngine(callback, output, abc, params);
	};

	tunebook.renderEngine = function (callback, output, abc, params) {
		var ret = [];
		var isArray = function(testObject) {
			return testObject && !(testObject.propertyIsEnumerable('length')) && typeof testObject === 'object' && typeof testObject.length === 'number';
		};

		// check and normalize input parameters
		if (output === undefined || abc === undefined)
			return;
		if (!isArray(output))
			output = [ output ];
		if (params === undefined)
			params = {};
		var currentTune = params.startingTune ? parseInt(params.startingTune, 10) : 0;

		// parse the abc string
		var book = new TuneBook(abc);
		var abcParser = new Parse();

		// output each tune, if it exists. Otherwise clear the div.
		for (var i = 0; i < output.length; i++) {
			var div = output[i];
			if (typeof(div) === "string")
				div = document.getElementById(div);
			if (div) {
				if (currentTune >= 0 && currentTune < book.tunes.length) {
					abcParser.parse(book.tunes[currentTune].abc, params);
					var tune = abcParser.getTune();
					var override = callback(div, tune, i, book.tunes[currentTune].abc);
					ret.push(override ? override : tune);
				} else {
					if (div.hasOwnProperty('innerHTML'))
						div.innerHTML = "";
				}
			}
			currentTune++;
		}
		return ret;
	};

})();

module.exports = tunebook;

},{"../parse/abc_common":9,"../parse/abc_parse":10}],6:[function(require,module,exports){
var tunebook = require('./abc_tunebook');

var EngraverController = require('../write/abc_engraver_controller');
var Parse = require('../parse/abc_parse');

var resizeDivs = {};
function resizeOuter() {
    var width = window.innerWidth;
    for (var id in resizeDivs) {
        if (resizeDivs.hasOwnProperty(id)) {
            var outer = resizeDivs[id];
            var ofs = outer.offsetLeft;
            width -= ofs * 2;
            outer.style.width = width + "px";
        }
    }
}

window.addEventListener("resize", resizeOuter);
window.addEventListener("orientationChange", resizeOuter);

function renderOne(div, tune, params, tuneNumber) {
    var width = params.width ? params.width : 800;
    if (params.viewportHorizontal) {
        // Create an inner div that holds the music, so that the passed in div will be the viewport.
        div.innerHTML = '<div class="abcjs-inner"></div>';
        if (params.scrollHorizontal) {
            div.style.overflowX = "auto";
            div.style.overflowY = "hidden";
        } else
            div.style.overflow = "hidden";
        resizeDivs[div.id] = div; // We use a hash on the element's id so that multiple calls won't keep adding to the list.
        div = div.children[0]; // The music should be rendered in the inner div.
    }
    else if (params.viewportVertical) {
        // Create an inner div that holds the music, so that the passed in div will be the viewport.
        div.innerHTML = '<div class="abcjs-inner scroll-amount"></div>';
        div.style.overflowX = "hidden";
        div.style.overflowY = "auto";
        div = div.children[0]; // The music should be rendered in the inner div.
    }
    else
	    div.innerHTML = "";
    var engraver_controller = new EngraverController(div, params);
    engraver_controller.engraveABC(tune, tuneNumber);
    tune.engraver = engraver_controller;
    if (params.viewportVertical || params.viewportHorizontal) {
        // If we added a wrapper around the div, then we need to size the wrapper, too.
        var parent = div.parentNode;
        parent.style.width = div.style.width;
    }
}

function renderEachLineSeparately(div, tune, params, tuneNumber) {
    function initializeTuneLine(tune) {
        return {
            formatting: tune.formatting,
            media: tune.media,
            version: tune.version,
            metaText: {},
            lines: []
        };
    }

    // Before rendering, chop up the returned tune into an array where each element is a line.
    // The first element of the array gets the title and other items that go on top, the last element
    // of the array gets the extra text that goes on bottom. Each element gets any non-music info that comes before it.
    var tunes = [];
    var tuneLine;
    for (var i = 0; i < tune.lines.length; i++) {
        var line = tune.lines[i];
        if (!tuneLine)
            tuneLine = initializeTuneLine(tune);

        if (i === 0) {
            // These items go on top of the music
            tuneLine.metaText.tempo = tune.metaText.tempo;
            tuneLine.metaText.title = tune.metaText.title;
            tuneLine.metaText.header = tune.metaText.header;
            tuneLine.metaText.rhythm = tune.metaText.rhythm;
            tuneLine.metaText.origin = tune.metaText.origin;
            tuneLine.metaText.composer = tune.metaText.composer;
            tuneLine.metaText.author = tune.metaText.author;
            tuneLine.metaText.partOrder = tune.metaText.partOrder;
        }

        // push the lines until we get to a music line
        tuneLine.lines.push(line);
        if (line.staff) {
            tunes.push(tuneLine);
            tuneLine = undefined;
        }
    }
    // Add any extra stuff to the last line.
    if (tuneLine) {
        var lastLine = tunes[tunes.length-1];
        for (var j = 0; j < tuneLine.lines.length; j++)
            lastLine.lines.push(tuneLine.lines[j]);
    }

    // These items go below the music
    tuneLine = tunes[tunes.length-1];
    tuneLine.metaText.unalignedWords = tune.metaText.unalignedWords;
    tuneLine.metaText.book = tune.metaText.book;
    tuneLine.metaText.source = tune.metaText.source;
    tuneLine.metaText.discography = tune.metaText.discography;
    tuneLine.metaText.notes = tune.metaText.notes;
    tuneLine.metaText.transcription = tune.metaText.transcription;
    tuneLine.metaText.history = tune.metaText.history;
    tuneLine.metaText['abc-copyright'] = tune.metaText['abc-copyright'];
    tuneLine.metaText['abc-creator'] = tune.metaText['abc-creator'];
    tuneLine.metaText['abc-edited-by'] = tune.metaText['abc-edited-by'];
    tuneLine.metaText.footer = tune.metaText.footer;

    // Now create sub-divs and render each line. Need to copy the params to change the padding for the interior slices.
    var ep = {};
    for (var key in params) {
        if (params.hasOwnProperty(key)) {
            ep[key] = params[key];
        }
    }
    var origPaddingTop = ep.paddingtop;
    var origPaddingBottom = ep.paddingbottom;
    div.innerHTML = "";
    for (var k = 0; k < tunes.length; k++) {
        var lineEl = document.createElement("div");
        div.appendChild(lineEl);

        if (k === 0) {
	        ep.paddingtop = origPaddingTop;
	        ep.paddingbottom = -20;
        } else if (k === tunes.length-1) {
	        ep.paddingtop = 10;
	        ep.paddingbottom = origPaddingBottom;
        } else {
	        ep.paddingtop = 10;
	        ep.paddingbottom = -20;
        }
        renderOne(lineEl, tunes[k], ep, tuneNumber);
    }
}

// A quick way to render a tune from javascript when interactivity is not required.
// This is used when a javascript routine has some abc text that it wants to render
// in a div or collection of divs. One tune or many can be rendered.
//
// parameters:
//      output: an array of divs that the individual tunes are rendered to.
//          If the number of tunes exceeds the number of divs in the array, then
//          only the first tunes are rendered. If the number of divs exceeds the number
//          of tunes, then the unused divs are cleared. The divs can be passed as either
//          elements or strings of ids. If ids are passed, then the div MUST exist already.
//          (if a single element is passed, then it is an implied array of length one.)
//          (if a null is passed for an element, or the element doesn't exist, then that tune is skipped.)
//      abc: text representing a tune or an entire tune book in ABC notation.
//      renderParams: hash of:
//          startingTune: an index, starting at zero, representing which tune to start rendering at.
//              (If this element is not present, then rendering starts at zero.)
//          width: 800 by default. The width in pixels of the output paper
var renderAbc = function(output, abc, parserParams, engraverParams, renderParams) {
    // Note: all parameters have been condensed into the first ones. It doesn't hurt anything to allow the old format, so just copy them here.
    var params = {};
    var key;
    if (parserParams) {
        for (key in parserParams) {
            if (parserParams.hasOwnProperty(key)) {
                params[key] = parserParams[key];
            }
        }
    }
    if (engraverParams) {
        for (key in engraverParams) {
            if (engraverParams.hasOwnProperty(key)) {
	            // There is a conflict with the name of the parameter "listener". If it is in the second parameter, then it is for click.
	            if (key === "listener") {
	            	if (engraverParams[key].highlight)
		                params.clickListener = engraverParams[key].highlight;
	            } else
                    params[key] = engraverParams[key];
            }
        }
    }
    if (renderParams) {
        for (key in renderParams) {
            if (renderParams.hasOwnProperty(key)) {
                params[key] = renderParams[key];
            }
        }
    }

    function callback(div, tune, tuneNumber, abcString) {
        if (params.wrap && params.staffwidth) {
	        tune = doLineWrapping(div, tune, tuneNumber, abcString, params);
	        return tune;
        }
        else if (!params.oneSvgPerLine || tune.lines.length < 2)
            renderOne(div, tune, params, tuneNumber);
        else
            renderEachLineSeparately(div, tune, params, tuneNumber);
        return null;
    }

    return tunebook.renderEngine(callback, output, abc, params);
};

function calcLineBreaks(widths, lineBreakPoint) {
	var lineBreaks = [];
	var totalThisLine = 0;
	// run through each measure and see if the accumulation is less than the ideal.
	// if it passes the ideal, then see whether the last or this one is closer to the ideal.
	for (var i = 0; i < widths.length; i++) {
		var width = widths[i];
		var attemptedWidth = totalThisLine + width;
		if (attemptedWidth < lineBreakPoint)
			totalThisLine = attemptedWidth;
		else {
			// This just passed the ideal, so see whether the previous or the current number of measures is closer.
			var oldDistance = lineBreakPoint - totalThisLine;
			var newDistance = attemptedWidth - lineBreakPoint;
			if (oldDistance < newDistance && totalThisLine > 0) {
				lineBreaks.push(i - 1);
				totalThisLine = width;
			} else {
				lineBreaks.push(i);
				totalThisLine = 0;
			}
		}
	}
	return { lineBreaks: lineBreaks, totalThisLine: totalThisLine };
}

function doLineWrapping(div, tune, tuneNumber, abcString, params) {
	var engraver_controller = new EngraverController(div, params);
	var widths = engraver_controller.getMeasureWidths(tune);
    // For calculating how much can go on the line, it depends on the width of the line. It is a convenience to just divide it here
    // by the minimum spacing instead of multiplying the min spacing later.
    // The scaling works differently: this is done by changing the scaling of the outer SVG, so the scaling needs to be compensated
    // for here, because the actual width will be different from the calculated numbers.
	var scale = params.scale ? Math.max(params.scale, 0.1) : 1;
	var minSpacing = params.wrap.minSpacing ? Math.max(parseFloat(params.wrap.minSpacing), 1) : 1;
	var onlyLineLimit = params.wrap.onlyLineLimit ? Math.max(parseFloat(params.wrap.onlyLineLimit), 1) : 5;
	var lastLineLimit = params.wrap.lastLineLimit ? Math.max(parseFloat(params.wrap.lastLineLimit), 1) : 5;
	var lineBreakPoint = (params.staffwidth - widths.left) / minSpacing / scale;
	var minLineSize = (params.staffwidth - widths.left) / onlyLineLimit / scale;
	var minLastLineSize = (params.staffwidth - widths.left) / lastLineLimit / scale;

	var ret = calcLineBreaks(widths.measureWidths, lineBreakPoint);

    var staffWidth = params.staffwidth;
    if (ret.lineBreaks.length === 0) {
		// Everything fits on one line, so see if there is TOO much space and the staff width needs to be shortened.
	    if (minLineSize > 0 && ret.totalThisLine > 0)
		    staffWidth = staffWidth / (minLineSize / ret.totalThisLine);
    } else if (ret.totalThisLine < minLastLineSize) {
    	// the last line is too short, so attempt to redistribute by changing the min.
	    // We will try more and less space alternatively. The space can't be less than 1.0, and we'll try in 0.1 increments.
	    var minTrys = [];
	    if (minSpacing > 1.1)
	    	minTrys.push(minSpacing - 0.1);
	    minTrys.push(minSpacing + 0.1);
	    if (minSpacing > 1.2)
	    	minTrys.push(minSpacing - 0.2);
	    minTrys.push(minSpacing + 0.2);
	    if (minSpacing > 1.3)
	    	minTrys.push(minSpacing - 0.3);
	    minTrys.push(minSpacing + 0.3);
	    for (var i = 0; i < minTrys.length && ret.totalThisLine < minLastLineSize; i++) {
		    lineBreakPoint = (params.staffwidth - widths.left) / minTrys[i] / scale;
		    ret = calcLineBreaks(widths.measureWidths, lineBreakPoint);
	    }
    }

	var abcParser = new Parse();
	var revisedParams = {
	    lineBreaks: ret.lineBreaks,
		staffwidth: staffWidth
    };
	for (var key in params) {
		if (params.hasOwnProperty(key) && key !== 'wrap' && key !== 'staffwidth') {
			revisedParams[key] = params[key];
		}
	}

	abcParser.parse(abcString, revisedParams);
	tune = abcParser.getTune();
	renderOne(div, tune, revisedParams, tuneNumber);
	return tune;
}

module.exports = renderAbc;

},{"../parse/abc_parse":10,"../write/abc_engraver_controller":28,"./abc_tunebook":5}],7:[function(require,module,exports){
//    abc_tune.js: a computer usable internal structure representing one tune.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var parseCommon = require('../parse/abc_common');
var parseKeyVoice = require('../parse/abc_parse_key_voice');
var spacing = require('../write/abc_spacing');

/**
 * This is the data for a single ABC tune. It is created and populated by the window.ABCJS.parse.Parse class.
 * Also known as the ABCJS Abstract Syntax Tree
 * @alternateClassName ABCJS.Tune
 */
var Tune = function() {
	// The structure consists of a hash with the following two items:
	// metaText: a hash of {key, value}, where key is one of: title, author, rhythm, source, transcription, unalignedWords, etc...
	// tempo: { noteLength: number (e.g. .125), bpm: number }
	// lines: an array of elements, or one of the following:
	//
	// STAFF: array of elements
	// SUBTITLE: string
	//
	// TODO: actually, the start and end char should modify each part of the note type
	// The elements all have a type field and a start and end char
	// field. The rest of the fields depend on the type and are listed below:
	// REST: duration=1,2,4,8; chord: string
	// NOTE: accidental=none,dbl_flat,flat,natural,sharp,dbl_sharp
	//		pitch: "C" is 0. The numbers refer to the pitch letter.
	//		duration: .5 (sixteenth), .75 (dotted sixteenth), 1 (eighth), 1.5 (dotted eighth)
	//			2 (quarter), 3 (dotted quarter), 4 (half), 6 (dotted half) 8 (whole)
	//		chord: { name:chord, position: one of 'default', 'above', 'below' }
	//		end_beam = true or undefined if this is the last note in a beam.
	//		lyric: array of { syllable: xxx, divider: one of " -_" }
	//		startTie = true|undefined
	//		endTie = true|undefined
	//		startTriplet = num <- that is the number to print
	//		endTriplet = true|undefined (the last note of the triplet)
	// TODO: actually, decoration should be an array.
	//		decoration: upbow, downbow, accent
	// BAR: type=bar_thin, bar_thin_thick, bar_thin_thin, bar_thick_thin, bar_right_repeat, bar_left_repeat, bar_double_repeat
	//	number: 1 or 2: if it is the start of a first or second ending
	// CLEF: type=treble,bass
	// KEY-SIG:
	//		accidentals[]: { acc:sharp|dblsharp|natural|flat|dblflat,  note:a|b|c|d|e|f|g }
	// METER: type: common_time,cut_time,specified
	//		if specified, { num: 99, den: 99 }

	this.getBeatLength = function() {
		for (var i = 0; i < this.lines.length; i++) {
			if (this.lines[i].staff) {
				for (var j = 0; j < this.lines[i].staff.length; j++) {
					if (this.lines[i].staff[j].meter) {
						var meter = this.lines[i].staff[j].meter;
						if (meter.type === "specified") {
							if (meter.value.length > 0) {
								var num = parseInt(meter.value[0].num, 10);
								var den = parseInt(meter.value[0].den, 10);
								if (num === 3 && den === 8) return 3/8;
								if (num === 6 && den === 8) return 3/8;
								if (num === 9 && den === 8) return 3/8;
								if (num === 12 && den === 8) return 3/8;
								return 1/den;
							}
							else
								return 1/4; // No meter was specified, so use this default
						} else if (meter.type === 'cut_time') {
							return 1/2;
						} else {
							return 1/4; // TODO-PER: this works for common time, but not for the ancient meters.
						}
					}
				}
			}
		}
		return 1/4; // No meter was specified, so use this default
	};

	this.getPickupLength = function() {
		var pickupLength = 0;
		for (var i = 0; i < this.lines.length; i++) {
			if (this.lines[i].staff) {
				for (var j = 0; j < this.lines[i].staff.length; j++) {
					for (var v = 0; v < this.lines[i].staff[j].voices.length; v++) {
						var voice = this.lines[i].staff[j].voices[v];
						var hasNote = false;
						for (var el = 0; el < voice.length; el++) {
							if (voice[el].duration)
								pickupLength += voice[el].duration;
							if (pickupLength >= this.getBarLength())
								pickupLength -= this.getBarLength();
							if (voice[el].el_type === 'bar')
								return pickupLength;
						}
					}
				}
			}
		}
		return pickupLength;
	};

	this.getBarLength = function() {
		var meter = this.getMeterFraction();
		return meter.num / meter.den;
	};

	this.millisecondsPerMeasure = function(bpmOverride) {
		var bpm;
		if (bpmOverride) {
			bpm = bpmOverride;
		} else {
			var tempo = this.metaText ? this.metaText.tempo : null;
			bpm = this.getBpm(tempo);
		}
		if (bpm <= 0)
			bpm = 1; // I don't think this can happen, but we don't want a possibility of dividing by zero.

		var beatsPerMeasure;
		var meter = this.getMeterFraction();
		if (meter.den === 8) {
			beatsPerMeasure = meter.num / 3;
		} else {
			beatsPerMeasure = meter.num;
		}
		if (beatsPerMeasure <= 0) // This probably won't happen in any normal case - but it is possible that the meter could be set to something nonsensical.
			beatsPerMeasure = 1;

		var minutesPerMeasure = beatsPerMeasure / bpm;
		return minutesPerMeasure * 60000;
	};

	this.reset = function () {
		this.version = "1.0.1";
		this.media = "screen";
		this.metaText = {};
		this.formatting = {};
		this.lines = [];
		this.staffNum = 0;
		this.voiceNum = 0;
		this.lineNum = 0;
	};

	this.resolveOverlays = function() {
		var madeChanges = false;
		for (var i = 0; i < this.lines.length; i++) {
			var line = this.lines[i];
			if (line.staff) {
				for (var j = 0; j < line.staff.length; j++) {
					var staff = line.staff[j];
					var overlayVoice = [];
					for (var k = 0; k < staff.voices.length; k++) {
						var voice = staff.voices[k];
						overlayVoice.push({ hasOverlay: false, voice: [], snip: []});
						var durationThisBar = 0;
						var inOverlay = false;
						var snipStart = -1;
						for (var kk = 0; kk < voice.length; kk++) {
							var event = voice[kk];
							if (event.el_type === "overlay" && !inOverlay) {
								madeChanges = true;
								inOverlay = true;
								snipStart = kk;
								overlayVoice[k].hasOverlay = true;
							} else if (event.el_type === "bar") {
								if (inOverlay) {
									// delete the overlay events from this array without messing up this loop.
									inOverlay = false;
									overlayVoice[k].snip.push({ start: snipStart, len: kk - snipStart});
									overlayVoice[k].voice.push(event); // Also end the overlay with the barline.
								} else {
									overlayVoice[k].voice.push({ el_type: "note", duration: durationThisBar, rest: {type: "invisible"}, startChar: event.startChar, endChar: event.endChar });
									overlayVoice[k].voice.push(event);
								}
								durationThisBar = 0;
							} else if (event.el_type === "note") {
								if (inOverlay) {
									overlayVoice[k].voice.push(event);
								} else {
									durationThisBar += event.duration;
								}
							} else if (event.el_type === "scale" || event.el_type === "stem" || event.el_type === "overlay" || event.el_type === "style" || event.el_type === "transpose") {
								// These types of events are duplicated on the overlay layer.
								overlayVoice[k].voice.push(event);
							}
						}
						if (overlayVoice[k].hasOverlay && overlayVoice[k].snip.length === 0) {
							// there was no closing bar, so we didn't set the snip amount.
							overlayVoice[k].snip.push({ start: snipStart, len: voice.length - snipStart});
						}
					}
					for (k = 0; k < overlayVoice.length; k++) {
						var ov = overlayVoice[k];
						if (ov.hasOverlay) {
							staff.voices.push(ov.voice);
							for (var kkk = ov.snip.length-1; kkk >= 0; kkk--) {
								var snip = ov.snip[kkk];
								staff.voices[k].splice(snip.start, snip.len);
							}
						}
					}
				}
			}
		}
		return madeChanges;
	};

	this.cleanUp = function(defWidth, defLength, barsperstaff, staffnonote, currSlur) {
		this.closeLine();	// Close the last line.

		// If the tempo was created with a string like "Allegro", then the duration of a beat needs to be set at the last moment, when it is most likely known.
		if (this.metaText.tempo && this.metaText.tempo.bpm && !this.metaText.tempo.duration)
			this.metaText.tempo.duration = [ this.getBeatLength() ];

		// Remove any blank lines
		var anyDeleted = false;
		var i, s, v;
		for (i = 0; i < this.lines.length; i++) {
			if (this.lines[i].staff !== undefined) {
				var hasAny = false;
				for (s = 0; s < this.lines[i].staff.length; s++) {
					if (this.lines[i].staff[s] === undefined) {
						anyDeleted = true;
						this.lines[i].staff[s] = null;
						//this.lines[i].staff[s] = { voices: []};	// TODO-PER: There was a part missing in the abc music. How should we recover?
					} else {
						for (v = 0; v < this.lines[i].staff[s].voices.length; v++) {
							if (this.lines[i].staff[s].voices[v] === undefined)
								this.lines[i].staff[s].voices[v] = [];	// TODO-PER: There was a part missing in the abc music. How should we recover?
							else
								if (this.containsNotes(this.lines[i].staff[s].voices[v])) hasAny = true;
						}
					}
				}
				if (!hasAny) {
					this.lines[i] = null;
					anyDeleted = true;
				}
			}
		}
		if (anyDeleted) {
			this.lines = parseCommon.compact(this.lines);
			parseCommon.each(this.lines, function(line) {
				if (line.staff)
					line.staff = parseCommon.compact(line.staff);
			});
		}

		// if we exceeded the number of bars allowed on a line, then force a new line
		if (barsperstaff) {
			while (wrapMusicLines(this.lines, barsperstaff)) {
				// This will keep wrapping until the end of the piece.
			}
		}

		// If we were passed staffnonote, then we want to get rid of all staffs that contain only rests.
		if (staffnonote) {
			anyDeleted = false;
			for (i = 0; i < this.lines.length; i++) {
				if (this.lines[i].staff !== undefined) {
					for (s = 0; s < this.lines[i].staff.length; s++) {
						var keepThis = false;
						for (v = 0; v < this.lines[i].staff[s].voices.length; v++) {
							if (this.containsNotesStrict(this.lines[i].staff[s].voices[v])) {
								keepThis = true;
							}
						}
						if (!keepThis) {
							anyDeleted = true;
							this.lines[i].staff[s] = null;
						}
					}
				}
			}
			if (anyDeleted) {
				parseCommon.each(this.lines, function(line) {
					if (line.staff)
						line.staff = parseCommon.compact(line.staff);
				});
			}
		}

		// Remove the temporary working variables
		for (i = 0; i < this.lines.length; i++) {
			if (this.lines[i].staff) {
				for (s = 0; s < this.lines[i].staff.length; s++)
						delete this.lines[i].staff[s].workingClef;
			}
		}

		// If there are overlays, create new voices for them.
		while (this.resolveOverlays()) {
			// keep resolving overlays as long as any are found.
		}

		function cleanUpSlursInLine(line) {
			var x;
//			var lyr = null;	// TODO-PER: debugging.

			var addEndSlur = function(obj, num, chordPos) {
				if (currSlur[chordPos] === undefined) {
					// There isn't an exact match for note position, but we'll take any other open slur.
					for (x = 0; x < currSlur.length; x++) {
						if (currSlur[x] !== undefined) {
							chordPos = x;
							break;
						}
					}
					if (currSlur[chordPos] === undefined) {
						var offNum = chordPos*100+1;
						parseCommon.each(obj.endSlur, function(x) { if (offNum === x) --offNum; });
						currSlur[chordPos] = [offNum];
					}
				}
				var slurNum;
				for (var i = 0; i < num; i++) {
					slurNum = currSlur[chordPos].pop();
					obj.endSlur.push(slurNum);
//					lyr.syllable += '<' + slurNum;	// TODO-PER: debugging
				}
				if (currSlur[chordPos].length === 0)
					delete currSlur[chordPos];
				return slurNum;
			};

			var addStartSlur = function(obj, num, chordPos, usedNums) {
				obj.startSlur = [];
				if (currSlur[chordPos] === undefined) {
					currSlur[chordPos] = [];
				}
				var nextNum = chordPos*100+1;
				for (var i = 0; i < num; i++) {
					if (usedNums) {
						parseCommon.each(usedNums, function(x) { if (nextNum === x) ++nextNum; });
						parseCommon.each(usedNums, function(x) { if (nextNum === x) ++nextNum; });
						parseCommon.each(usedNums, function(x) { if (nextNum === x) ++nextNum; });
					}
					parseCommon.each(currSlur[chordPos], function(x) { if (nextNum === x) ++nextNum; });
					parseCommon.each(currSlur[chordPos], function(x) { if (nextNum === x) ++nextNum; });

					currSlur[chordPos].push(nextNum);
					obj.startSlur.push({ label: nextNum });
//					lyr.syllable += ' ' + nextNum + '>';	// TODO-PER:debugging
					nextNum++;
				}
			};

			for (var i = 0; i < line.length; i++) {
				var el = line[i];
//				if (el.lyric === undefined)	// TODO-PER: debugging
//					el.lyric = [{ divider: '-' }];	// TODO-PER: debugging
//				lyr = el.lyric[0];	// TODO-PER: debugging
//				lyr.syllable = '';	// TODO-PER: debugging
				if (el.el_type === 'note') {
					if (el.gracenotes) {
						for (var g = 0; g < el.gracenotes.length; g++) {
							if (el.gracenotes[g].endSlur) {
								var gg = el.gracenotes[g].endSlur;
								el.gracenotes[g].endSlur = [];
								for (var ggg = 0; ggg < gg; ggg++)
									addEndSlur(el.gracenotes[g], 1, 20);
							}
							if (el.gracenotes[g].startSlur) {
								x = el.gracenotes[g].startSlur;
								addStartSlur(el.gracenotes[g], x, 20);
							}
						}
					}
					if (el.endSlur) {
						x = el.endSlur;
						el.endSlur = [];
						addEndSlur(el, x, 0);
					}
					if (el.startSlur) {
						x = el.startSlur;
						addStartSlur(el, x, 0);
					}
					if (el.pitches) {
						var usedNums = [];
						for (var p = 0; p < el.pitches.length; p++) {
							if (el.pitches[p].endSlur) {
								var k = el.pitches[p].endSlur;
								el.pitches[p].endSlur = [];
								for (var j = 0; j < k; j++) {
									var slurNum = addEndSlur(el.pitches[p], 1, p+1);
									usedNums.push(slurNum);
								}
							}
						}
						for (p = 0; p < el.pitches.length; p++) {
							if (el.pitches[p].startSlur) {
								x = el.pitches[p].startSlur;
								addStartSlur(el.pitches[p], x, p+1, usedNums);
							}
						}
						// Correct for the weird gracenote case where ({g}a) should match.
						// The end slur was already assigned to the note, and needs to be moved to the first note of the graces.
						if (el.gracenotes && el.pitches[0].endSlur && el.pitches[0].endSlur[0] === 100 && el.pitches[0].startSlur) {
							if (el.gracenotes[0].endSlur)
								el.gracenotes[0].endSlur.push(el.pitches[0].startSlur[0].label);
							else
								el.gracenotes[0].endSlur = [el.pitches[0].startSlur[0].label];
							if (el.pitches[0].endSlur.length === 1)
								delete el.pitches[0].endSlur;
							else if (el.pitches[0].endSlur[0] === 100)
								el.pitches[0].endSlur.shift();
							else if (el.pitches[0].endSlur[el.pitches[0].endSlur.length-1] === 100)
								el.pitches[0].endSlur.pop();
							if (currSlur[1].length === 1)
								delete currSlur[1];
							else
								currSlur[1].pop();
						}
					}
				}
			}
		}

		// TODO-PER: This could be done faster as we go instead of as the last step.
		function fixClefPlacement(el) {
			parseKeyVoice.fixClef(el);
			//if (el.el_type === 'clef') {
//				var min = -2;
//				var max = 5;
//				switch(el.type) {
//					case 'treble+8':
//					case 'treble-8':
//						break;
//					case 'bass':
//					case 'bass+8':
//					case 'bass-8':
//						el.verticalPos = 20 + el.verticalPos; min += 6; max += 6;
//						break;
//					case 'tenor':
//					case 'tenor+8':
//					case 'tenor-8':
//						el.verticalPos = - el.verticalPos; min = -40; max = 40;
////						el.verticalPos+=2; min += 6; max += 6;
//						break;
//					case 'alto':
//					case 'alto+8':
//					case 'alto-8':
//						el.verticalPos = - el.verticalPos; min = -40; max = 40;
////						el.verticalPos-=2; min += 4; max += 4;
//						break;
//				}
//				if (el.verticalPos < min) {
//					while (el.verticalPos < min)
//						el.verticalPos += 7;
//				} else if (el.verticalPos > max) {
//					while (el.verticalPos > max)
//						el.verticalPos -= 7;
//				}
			//}
		}

		function wrapMusicLines(lines, barsperstaff) {
			for (i = 0; i < lines.length; i++) {
				if (lines[i].staff !== undefined) {
					for (s = 0; s < lines[i].staff.length; s++) {
						var permanentItems = [];
						for (v = 0; v < lines[i].staff[s].voices.length; v++) {
							var voice = lines[i].staff[s].voices[v];
							var barNumThisLine = 0;
							for (var n = 0; n < voice.length; n++) {
								if (voice[n].el_type === 'bar') {
									barNumThisLine++;
									if (barNumThisLine >= barsperstaff) {
										// push everything else to the next line, if there is anything else,
										// and there is a next line. If there isn't a next line, create one.
										if (n < voice.length - 1) {
											var nextLine = getNextMusicLine(lines, i);
											if (!nextLine) {
												var cp = JSON.parse(JSON.stringify(lines[i]));
												lines.push(parseCommon.clone(cp));
												nextLine = lines[lines.length - 1];
												for (var ss = 0; ss < nextLine.staff.length; ss++) {
													for (var vv = 0; vv < nextLine.staff[ss].voices.length; vv++)
														nextLine.staff[ss].voices[vv] = [];
												}
											}
											var startElement = n + 1;
											var section = lines[i].staff[s].voices[v].slice(startElement);
											lines[i].staff[s].voices[v] = lines[i].staff[s].voices[v].slice(0, startElement);
											nextLine.staff[s].voices[v] = permanentItems.concat(section.concat(nextLine.staff[s].voices[v]));
											return true;
										}
									}
								} else if (!voice[n].duration) {
									permanentItems.push(voice[n]);
								}
							}
						}
					}
				}
			}
			return false;
		}

		function getNextMusicLine(lines, currentLine) {
			currentLine++;
			while (lines.length > currentLine) {
				if (lines[currentLine].staff)
					return lines[currentLine];
				currentLine++;
			}
			return null;
		}

		for (this.lineNum = 0; this.lineNum < this.lines.length; this.lineNum++) {
			var staff = this.lines[this.lineNum].staff;
			if (staff) {
				for (this.staffNum = 0; this.staffNum < staff.length; this.staffNum++) {
					if (staff[this.staffNum].clef)
						fixClefPlacement(staff[this.staffNum].clef);
					for (this.voiceNum = 0; this.voiceNum < staff[this.staffNum].voices.length; this.voiceNum++) {
						var voice = staff[this.staffNum].voices[this.voiceNum];
						cleanUpSlursInLine(voice);
						for (var j = 0; j < voice.length; j++) {
							if (voice[j].el_type === 'clef')
								fixClefPlacement(voice[j]);
						}
						if (voice.length > 0 && voice[voice.length-1].barNumber) {
							// Don't hang a bar number on the last bar line: it should go on the next line.
							var nextLine = getNextMusicLine(this.lines, this.lineNum);
							if (nextLine)
								nextLine.staff[0].barNumber = voice[voice.length-1].barNumber;
							delete voice[voice.length-1].barNumber;
						}
					}
				}
			}
		}

		if (!this.formatting.pagewidth)
			this.formatting.pagewidth = defWidth;
		if (!this.formatting.pageheight)
			this.formatting.pageheight = defLength;

		// Remove temporary variables that the outside doesn't need to know about
		delete this.staffNum;
		delete this.voiceNum;
		delete this.lineNum;
		delete this.potentialStartBeam;
		delete this.potentialEndBeam;
		delete this.vskipPending;

		return currSlur;
	};

	this.reset();

	this.getLastNote = function() {
		if (this.lines[this.lineNum] && this.lines[this.lineNum].staff && this.lines[this.lineNum].staff[this.staffNum] &&
			this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum]) {
			for (var i = this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum].length-1; i >= 0; i--) {
				var el = this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum][i];
				if (el.el_type === 'note') {
					return el;
				}
			}
		}
		return null;
	};

	this.addTieToLastNote = function() {
		// TODO-PER: if this is a chord, which note?
		var el = this.getLastNote();
		if (el && el.pitches && el.pitches.length > 0) {
			el.pitches[0].startTie = {};
			return true;
		}
		return false;
	};

	this.getDuration = function(el) {
		if (el.duration) return el.duration;
		//if (el.pitches && el.pitches.length > 0) return el.pitches[0].duration;
		return 0;
	};

	this.closeLine = function() {
		if (this.potentialStartBeam && this.potentialEndBeam) {
			this.potentialStartBeam.startBeam = true;
			this.potentialEndBeam.endBeam = true;
		}
		delete this.potentialStartBeam;
		delete this.potentialEndBeam;
	};

	this.appendElement = function(type, startChar, endChar, hashParams)
	{
		var This = this;
		var pushNote = function(hp) {
			if (hp.pitches !== undefined) {
				var mid = This.lines[This.lineNum].staff[This.staffNum].workingClef.verticalPos;
				parseCommon.each(hp.pitches, function(p) { p.verticalPos = p.pitch - mid; });
			}
			if (hp.gracenotes !== undefined) {
				var mid2 = This.lines[This.lineNum].staff[This.staffNum].workingClef.verticalPos;
				parseCommon.each(hp.gracenotes, function(p) { p.verticalPos = p.pitch - mid2; });
			}
			This.lines[This.lineNum].staff[This.staffNum].voices[This.voiceNum].push(hp);
		};
		hashParams.el_type = type;
		if (startChar !== null)
			hashParams.startChar = startChar;
		if (endChar !== null)
			hashParams.endChar = endChar;
		var endBeamHere = function() {
			This.potentialStartBeam.startBeam = true;
			hashParams.endBeam = true;
			delete This.potentialStartBeam;
			delete This.potentialEndBeam;
		};
		var endBeamLast = function() {
			if (This.potentialStartBeam !== undefined && This.potentialEndBeam !== undefined) {	// Do we have a set of notes to beam?
				This.potentialStartBeam.startBeam = true;
				This.potentialEndBeam.endBeam = true;
			}
			delete This.potentialStartBeam;
			delete This.potentialEndBeam;
		};
		if (type === 'note') { // && (hashParams.rest !== undefined || hashParams.end_beam === undefined)) {
			// Now, add the startBeam and endBeam where it is needed.
			// end_beam is already set on the places where there is a forced end_beam. We'll remove that here after using that info.
			// this.potentialStartBeam either points to null or the start beam.
			// this.potentialEndBeam either points to null or the start beam.
			// If we have a beam break (note is longer than a quarter, or an end_beam is on this element), then set the beam if we have one.
			// reset the variables for the next notes.
			var dur = This.getDuration(hashParams);
			if (dur >= 0.25) {	// The beam ends on the note before this.
				endBeamLast();
			} else if (hashParams.force_end_beam_last && This.potentialStartBeam !== undefined) {
				endBeamLast();
			} else if (hashParams.end_beam && This.potentialStartBeam !== undefined) {	// the beam is forced to end on this note, probably because of a space in the ABC
				if (hashParams.rest === undefined)
					endBeamHere();
				else
					endBeamLast();
			} else if (hashParams.rest === undefined) {	// this a short note and we aren't about to end the beam
				if (This.potentialStartBeam === undefined) {	// We aren't collecting notes for a beam, so start here.
					if (!hashParams.end_beam) {
						This.potentialStartBeam = hashParams;
						delete This.potentialEndBeam;
					}
				} else {
					This.potentialEndBeam = hashParams;	// Continue the beaming, look for the end next note.
				}
			}

			//  end_beam goes on rests and notes which precede rests _except_ when a rest (or set of adjacent rests) has normal notes on both sides (no spaces)
//			if (hashParams.rest !== undefined)
//			{
//				hashParams.end_beam = true;
//				var el2 = this.getLastNote();
//				if (el2) el2.end_beam = true;
//				// TODO-PER: implement exception mentioned in the comment.
//			}
		} else {	// It's not a note, so there definitely isn't beaming after it.
			endBeamLast();
		}
		delete hashParams.end_beam;	// We don't want this temporary variable hanging around.
		delete hashParams.force_end_beam_last;	// We don't want this temporary variable hanging around.
		pushNote(hashParams);
	};

	this.appendStartingElement = function(type, startChar, endChar, hashParams2)
	{
		// If we're in the middle of beaming, then end the beam.
		this.closeLine();

		// We only ever want implied naturals the first time.
		var impliedNaturals;
		if (type === 'key') {
			impliedNaturals = hashParams2.impliedNaturals;
			delete hashParams2.impliedNaturals;
			delete hashParams2.explicitAccidentals;
		}

		// Clone the object because it will be sticking around for the next line and we don't want the extra fields in it.
		var hashParams = parseCommon.clone(hashParams2);

		if (this.lines[this.lineNum].staff) { // be sure that we are on a music type line before doing the following.
			// If this is a clef type, then we replace the working clef on the line. This is kept separate from
			// the clef in case there is an inline clef field. We need to know what the current position for
			// the note is.
			if (type === 'clef')
				this.lines[this.lineNum].staff[this.staffNum].workingClef = hashParams;

			// If this is the first item in this staff, then we might have to initialize the staff, first.
			if (this.lines[this.lineNum].staff.length <= this.staffNum) {
				this.lines[this.lineNum].staff[this.staffNum] = {};
				this.lines[this.lineNum].staff[this.staffNum].clef = parseCommon.clone(this.lines[this.lineNum].staff[0].clef);
				this.lines[this.lineNum].staff[this.staffNum].key = parseCommon.clone(this.lines[this.lineNum].staff[0].key);
				if (this.lines[this.lineNum].staff[0].meter)
					this.lines[this.lineNum].staff[this.staffNum].meter = parseCommon.clone(this.lines[this.lineNum].staff[0].meter);
				this.lines[this.lineNum].staff[this.staffNum].workingClef = parseCommon.clone(this.lines[this.lineNum].staff[0].workingClef);
				this.lines[this.lineNum].staff[this.staffNum].voices = [[]];
			}

			// These elements should not be added twice, so if the element exists on this line without a note or bar before it, just replace the staff version.
			var voice = this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum];
			for (var i = 0; i < voice.length; i++) {
				if (voice[i].el_type === 'note' || voice[i].el_type === 'bar') {
					hashParams.el_type = type;
					hashParams.startChar = startChar;
					hashParams.endChar = endChar;
					if (impliedNaturals)
						hashParams.accidentals = impliedNaturals.concat(hashParams.accidentals);
					voice.push(hashParams);
					return;
				}
				if (voice[i].el_type === type) {
					hashParams.el_type = type;
					hashParams.startChar = startChar;
					hashParams.endChar = endChar;
					if (impliedNaturals)
						hashParams.accidentals = impliedNaturals.concat(hashParams.accidentals);
					voice[i] = hashParams;
					return;
				}
			}
			// We didn't see either that type or a note, so replace the element to the staff.
			this.lines[this.lineNum].staff[this.staffNum][type] = hashParams2;
		}
	};

	this.getNumLines = function() {
		return this.lines.length;
	};

	this.pushLine = function(hash) {
		if (this.vskipPending) {
			hash.vskip = this.vskipPending;
			delete this.vskipPending;
		}
		this.lines.push(hash);
	};

	this.addSubtitle = function(str) {
		this.pushLine({subtitle: str});
	};

	this.addSpacing = function(num) {
		this.vskipPending = num;
	};

	this.addNewPage = function(num) {
		this.pushLine({newpage: num});
	};

	this.addSeparator = function(spaceAbove, spaceBelow, lineLength) {
		this.pushLine({separator: {spaceAbove: spaceAbove, spaceBelow: spaceBelow, lineLength: lineLength}});
	};

	this.addText = function(str) {
		this.pushLine({text: str});
	};

	this.addCentered = function(str) {
		this.pushLine({text: [{text: str, center: true }]});
	};

	this.containsNotes = function(voice) {
		for (var i = 0; i < voice.length; i++) {
			if (voice[i].el_type === 'note' || voice[i].el_type === 'bar')
				return true;
		}
		return false;
	};

	this.containsNotesStrict = function(voice) {
		for (var i = 0; i < voice.length; i++) {
			if (voice[i].el_type === 'note' && voice[i].rest === undefined)
				return true;
		}
		return false;
	};

//	anyVoiceContainsNotes: function(line) {
//		for (var i = 0; i < line.staff.voices.length; i++) {
//			if (this.containsNotes(line.staff.voices[i]))
//				return true;
//		}
//		return false;
//	},

	this.startNewLine = function(params) {
		// If the pointed to line doesn't exist, just create that. If the line does exist, but doesn't have any music on it, just use it.
		// If it does exist and has music, then increment the line number. If the new element doesn't exist, create it.
		var This = this;
		this.closeLine();	// Close the previous line.
		var createVoice = function(params) {
			This.lines[This.lineNum].staff[This.staffNum].voices[This.voiceNum] = [];
			if (This.isFirstLine(This.lineNum)) {
				if (params.name) {if (!This.lines[This.lineNum].staff[This.staffNum].title) This.lines[This.lineNum].staff[This.staffNum].title = [];This.lines[This.lineNum].staff[This.staffNum].title[This.voiceNum] = params.name;}
			} else {
				if (params.subname) {if (!This.lines[This.lineNum].staff[This.staffNum].title) This.lines[This.lineNum].staff[This.staffNum].title = [];This.lines[This.lineNum].staff[This.staffNum].title[This.voiceNum] = params.subname;}
			}
			if (params.style)
				This.appendElement('style', null, null, {head: params.style});
			if (params.stem)
				This.appendElement('stem', null, null, {direction: params.stem});
			else if (This.voiceNum > 0) {
				if (This.lines[This.lineNum].staff[This.staffNum].voices[0]!== undefined) {
					var found = false;
					for (var i = 0; i < This.lines[This.lineNum].staff[This.staffNum].voices[0].length; i++) {
						if (This.lines[This.lineNum].staff[This.staffNum].voices[0].el_type === 'stem')
							found = true;
					}
					if (!found) {
						var stem = { el_type: 'stem', direction: 'up' };
						This.lines[This.lineNum].staff[This.staffNum].voices[0].splice(0,0,stem);
					}
				}
				This.appendElement('stem', null, null, {direction: 'down'});
			}
			if (params.scale)
				This.appendElement('scale', null, null, { size: params.scale} );
		};
		var createStaff = function(params) {
			if (params.key && params.key.impliedNaturals) {
				params.key.accidentals = params.key.accidentals.concat(params.key.impliedNaturals);
				delete params.key.impliedNaturals;
			}

			This.lines[This.lineNum].staff[This.staffNum] = {voices: [ ], clef: params.clef, key: params.key, workingClef: params.clef };
			if (params.stafflines !== undefined) {
				This.lines[This.lineNum].staff[This.staffNum].clef.stafflines = params.stafflines;
				This.lines[This.lineNum].staff[This.staffNum].workingClef.stafflines = params.stafflines;
			}
			if (params.staffscale) {
				This.lines[This.lineNum].staff[This.staffNum].staffscale = params.staffscale;
			}
			if (params.tripletfont) This.lines[This.lineNum].staff[This.staffNum].tripletfont = params.tripletfont;
			if (params.vocalfont) This.lines[This.lineNum].staff[This.staffNum].vocalfont = params.vocalfont;
			if (params.bracket) This.lines[This.lineNum].staff[This.staffNum].bracket = params.bracket;
			if (params.brace) This.lines[This.lineNum].staff[This.staffNum].brace = params.brace;
			if (params.connectBarLines) This.lines[This.lineNum].staff[This.staffNum].connectBarLines = params.connectBarLines;
			if (params.barNumber) This.lines[This.lineNum].staff[This.staffNum].barNumber = params.barNumber;
			createVoice(params);
			// Some stuff just happens for the first voice
			if (params.part)
				This.appendElement('part', params.startChar, params.endChar, {title: params.part});
			if (params.meter !== undefined) This.lines[This.lineNum].staff[This.staffNum].meter = params.meter;
		};
		var createLine = function(params) {
			This.lines[This.lineNum] = {staff: []};
			createStaff(params);
		};
		if (this.lines[this.lineNum] === undefined) createLine(params);
		else if (this.lines[this.lineNum].staff === undefined) {
			this.lineNum++;
			this.startNewLine(params);
		} else if (this.lines[this.lineNum].staff[this.staffNum] === undefined) createStaff(params);
		else if (this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum] === undefined) createVoice(params);
		else if (!this.containsNotes(this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum])) return;
		else {
			this.lineNum++;
			this.startNewLine(params);
		}
	};

	this.hasBeginMusic = function() {
		// return true if there exists at least one line that contains "staff"
		for (var i = 0; i < this.lines.length; i++) {
			if (this.lines[i].staff)
				return true;
		}
		return false;
	};

	this.isFirstLine = function(index) {
		for (var i = index-1; i >= 0; i--) {
			if (this.lines[i].staff !== undefined) return false;
		}
		return true;
	};

	this.getMeter = function() {
		for (var i = 0; i < this.lines.length; i++) {
			var line = this.lines[i];
			if (line.staff) {
				for (var j = 0; j < line.staff.length; j++) {
					var meter = line.staff[j].meter;
					if (meter) {
						return meter;
					}
				}
			}
		}
		return { type: "common_time", };
	};

	this.getMeterFraction = function() {
		var meter = this.getMeter();
		var num = 4;
		var den = 4;
		if (meter) {
			if (meter.type === 'specified') {
				num = parseInt(meter.value[0].num, 10);
				den = parseInt(meter.value[0].den,10);
			} else if (meter.type === 'cut_time') {
				num = 2;
				den = 2;
			} else if (meter.type === 'common_time') {
				num = 4;
				den = 4;
			}
		}
		this.meter = { num: num, den: den };
		return this.meter; // TODO-PER: is this saved value used anywhere? A get function shouldn't change state.
	};

	this.getCurrentVoice = function() {
		if (this.lines[this.lineNum] !== undefined && this.lines[this.lineNum].staff[this.staffNum] !== undefined && this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum] !== undefined)
			return this.lines[this.lineNum].staff[this.staffNum].voices[this.voiceNum];
		else return null;
	};

	this.setCurrentVoice = function(staffNum, voiceNum) {
		this.staffNum = staffNum;
		this.voiceNum = voiceNum;
		for (var i = 0; i < this.lines.length; i++) {
			if (this.lines[i].staff) {
				if (this.lines[i].staff[staffNum] === undefined || this.lines[i].staff[staffNum].voices[voiceNum] === undefined ||
					!this.containsNotes(this.lines[i].staff[staffNum].voices[voiceNum] )) {
					this.lineNum =  i;
					return;
				}
			}
		}
		this.lineNum =  i;
	};

	this.addMetaText = function(key, value) {
		if (this.metaText[key] === undefined)
			this.metaText[key] = value;
		else
			this.metaText[key] += "\n" + value;
	};

	this.addMetaTextArray = function(key, value) {
		if (this.metaText[key] === undefined)
			this.metaText[key] = [value];
		else
			this.metaText[key].push(value);
	};
	this.addMetaTextObj = function(key, value) {
		this.metaText[key] = value;
	};

	function addVerticalInfo(timingEvents) {
		// Add vertical info to the bar events: put the next event's top, and the event after the next measure's top.
		var lastBarTop;
		var lastBarBottom;
		var lastEventTop;
		var lastEventBottom;
		for (var e = timingEvents.length - 1; e >= 0; e--) {
			var ev = timingEvents[e];
			if (ev.type === 'bar') {
				ev.top = lastEventTop;
				ev.nextTop = lastBarTop;
				lastBarTop = lastEventTop;

				ev.bottom = lastEventBottom;
				ev.nextBottom = lastBarBottom;
				lastBarBottom = lastEventBottom;
			} else if (ev.type === 'event') {
				lastEventTop = ev.top;
				lastEventBottom = ev.top + ev.height;
			}
		}
	}

	function makeSortedArray(hash) {
		var arr = [];
		for (var k in hash) {
			if (hash.hasOwnProperty(k))
				arr.push(hash[k]);
		}
		arr = arr.sort(function (a, b) {
			var diff = a.milliseconds - b.milliseconds;
			// if the events have the same time, make sure a bar comes before a note
			if (diff !== 0) {
				return diff;
			}
			else {
				return a.type === "bar" ? -1 : 1;
			}
		});
		return arr;
	}

	this.addElementToEvents = function(eventHash, element, voiceTimeMilliseconds, top, height, line, measureNumber, timeDivider, isTiedState, nextIsBar) {
		if (element.hint)
			return { isTiedState: undefined, duration: 0 };
		var realDuration = element.durationClass ? element.durationClass : element.duration;
		if (element.abcelem.rest && element.abcelem.rest.type === "spacer")
			realDuration = 0;
		if (realDuration > 0) {
			var es = [];
			// If there is an invisible rest, then there are not elements, so don't push a null one.
			for (var i = 0; i < element.elemset.length; i++) {
				if (element.elemset[i] !== null)
					es.push(element.elemset[i]);
			}
			var isTiedToNext = element.startTie;
			if (isTiedState !== undefined) {
				eventHash["event" + isTiedState].elements.push(es); // Add the tied note to the first note that it is tied to
				if (!isTiedToNext)
					isTiedState = undefined;
			} else {
				// the last note wasn't tied.
				if (!eventHash["event" + voiceTimeMilliseconds]) {
					eventHash["event" + voiceTimeMilliseconds] = {
						type: "event",
						milliseconds: voiceTimeMilliseconds,
						line: line,
						measureNumber: measureNumber,
						top: top,
						height: height,
						left: element.x,
						width: element.w,
						elements: [es],
						startChar: element.abcelem.startChar,
						endChar: element.abcelem.endChar,
						startCharArray: [element.abcelem.startChar],
						endCharArray: [element.abcelem.endChar]
					};
				} else {
					// If there is more than one voice then two notes can fall at the same time. Usually they would be lined up in the same place, but if it is a whole rest, then it is placed funny. In any case, the left most element wins.
					eventHash["event" + voiceTimeMilliseconds].left = Math.min(eventHash["event" + voiceTimeMilliseconds].left, element.x);
					eventHash["event" + voiceTimeMilliseconds].elements.push(es);
					eventHash["event" + voiceTimeMilliseconds].startCharArray.push(element.abcelem.startChar);
					eventHash["event" + voiceTimeMilliseconds].endCharArray.push(element.abcelem.endChar);
				}
				if (nextIsBar) {
					eventHash["event" + voiceTimeMilliseconds].measureStart = true;
					nextIsBar = false;
				}
				if (isTiedToNext)
					isTiedState = voiceTimeMilliseconds;
			}
		}
		return { isTiedState: isTiedState, duration: realDuration / timeDivider, nextIsBar: nextIsBar || element.type === 'bar' };
	};

	this.makeVoicesArray = function() {
		// First make a new array that is arranged by voice so that the repeats that span different lines are handled correctly.
		var voicesArr = [];
		for (var line = 0; line < this.engraver.staffgroups.length; line++) {
			var group = this.engraver.staffgroups[line];
			var firstStaff = group.staffs[0];
			var middleC = firstStaff.absoluteY;
			var top = middleC - firstStaff.top * spacing.STEP;
			var lastStaff = group.staffs[group.staffs.length - 1];
			middleC = lastStaff.absoluteY;
			var bottom = middleC - lastStaff.bottom * spacing.STEP;
			var height = bottom - top;

			var voices = group.voices;
			for (var v = 0; v < voices.length; v++) {
				var measureNumber = 0;
				var noteFound = false;
				if (!voicesArr[v])
					voicesArr[v] = [];
				var elements = voices[v].children;
				for (var elem = 0; elem < elements.length; elem++) {
					voicesArr[v].push({top: top, height: height, line: line, measureNumber: measureNumber, elem: elements[elem]});
					if (elements[elem].type === 'bar' && noteFound) // Count the measures by counting the bar lines, but skip a bar line that appears at the left of the music, before any notes.
						measureNumber++;
					if (elements[elem].type === 'note')
						noteFound = true;
				}
			}
		}
		return voicesArr;
	};

	this.setupEvents = function(startingDelay, timeDivider) {
		var timingEvents = [];

		var eventHash = {};
		// The time is the number of seconds from the beginning of the piece.
		// The units we are scanning are in notation units (i.e. 0.25 is a quarter note)
		var time = startingDelay;
		var isTiedState;
		var nextIsBar = true;
		var voices = this.makeVoicesArray();
		for (var v = 0; v < voices.length; v++) {
			var voiceTime = time;
			var voiceTimeMilliseconds = Math.round(voiceTime * 1000);
			var startingRepeatElem = 0;
			var endingRepeatElem = -1;
			var elements = voices[v];
			for (var elem = 0; elem < elements.length; elem++) {
				var element = elements[elem].elem;
				if (element.abcelem.el_type === "tempo") {
					var bpm = this.getBpm(element.abcelem);
					var beatLength = this.getBeatLength();
					var beatsPerSecond = bpm / 60;
					timeDivider = beatLength * beatsPerSecond;
				}
				var ret = this.addElementToEvents(eventHash, element, voiceTimeMilliseconds, elements[elem].top, elements[elem].height, elements[elem].line, elements[elem].measureNumber, timeDivider, isTiedState, nextIsBar);
				isTiedState = ret.isTiedState;
				nextIsBar = ret.nextIsBar;
				voiceTime += ret.duration;
				voiceTimeMilliseconds = Math.round(voiceTime * 1000);
				if (element.type === 'bar') {
					var barType = element.abcelem.type;
					var endRepeat = (barType === "bar_right_repeat" || barType === "bar_dbl_repeat");
					var startEnding = (element.abcelem.startEnding === '1');
					var startRepeat = (barType === "bar_left_repeat" || barType === "bar_dbl_repeat" || barType === "bar_right_repeat");
					if (endRepeat) {
						if (endingRepeatElem === -1)
							endingRepeatElem = elem;
						for (var el2 = startingRepeatElem; el2 < endingRepeatElem; el2++) {
							var element2 = elements[el2].elem;
							ret = this.addElementToEvents(eventHash, element2, voiceTimeMilliseconds, elements[el2].top, elements[el2].height, elements[el2].line, elements[el2].measureNumber, timeDivider, isTiedState, nextIsBar);
							isTiedState = ret.isTiedState;
							nextIsBar = ret.nextIsBar;
							voiceTime += ret.duration;
							voiceTimeMilliseconds = Math.round(voiceTime * 1000);
						}
						nextIsBar = true;
						endingRepeatElem = -1;
					}
					if (startEnding)
						endingRepeatElem = elem;
					if (startRepeat)
						startingRepeatElem = elem;
				}
			}
		}
		// now we have all the events, but if there are multiple voices then there may be events out of order or duplicated, so normalize it.
		timingEvents = makeSortedArray(eventHash);
		addVerticalInfo(timingEvents);
		return timingEvents;
	};

	function getVertical(group) {
		var voices = group.voices;
		var firstStaff = group.staffs[0];
		var middleC = firstStaff.absoluteY;
		var top = middleC - firstStaff.top*spacing.STEP;
		var lastStaff = group.staffs[group.staffs.length-1];
		middleC = lastStaff.absoluteY;
		var bottom = middleC - lastStaff.bottom*spacing.STEP;
		var height = bottom - top;
		return { top: top, height: height };
	}

	this.getBpm = function(tempo) {
		var bpm;
		if (tempo) {
			bpm = tempo.bpm;
			var beatLength = this.getBeatLength();
			var statedBeatLength = tempo.duration && tempo.duration.length > 0 ? tempo.duration[0] : beatLength;
			bpm = bpm * statedBeatLength / beatLength;
		}
		if (!bpm) {
			bpm = 180;
			// Compensate for compound meter, where the beat isn't a beat.
			var meter = this.getMeterFraction();
			if (meter && meter.den === 8) {
				bpm = 120;
			}
		}
		return bpm;
	};

	this.setTiming = function (bpm, measuresOfDelay) {
		if (!bpm) {
			var tempo = this.metaText ? this.metaText.tempo : null;
			bpm = this.getBpm(tempo);
		}

		var beatLength = this.getBeatLength();
		var beatsPerSecond = bpm / 60;

		var measureLength = this.getBarLength();

		var startingDelay = measureLength / beatLength * measuresOfDelay / beatsPerSecond;
		if (startingDelay)
			startingDelay -= this.getPickupLength() / beatLength / beatsPerSecond;
		var timeDivider = beatLength * beatsPerSecond;

		this.noteTimings = this.setupEvents(startingDelay, timeDivider);
	};
};

module.exports = Tune;

},{"../parse/abc_common":9,"../parse/abc_parse_key_voice":13,"../write/abc_spacing":32}],8:[function(require,module,exports){
// abc_editor.js
// window.ABCJS.Editor is the interface class for the area that contains the ABC text. It is responsible for
// holding the text of the tune and calling the parser and the rendering engines.
//
// EditArea is an example of using a textarea as the control that is shown to the user. As long as
// the same interface is used, window.ABCJS.Editor can use a different type of object.
//
// EditArea:
// - constructor(textareaid)
//		This contains the id of a textarea control that will be used.
// - addSelectionListener(listener)
//		A callback class that contains the entry point fireSelectionChanged()
// - addChangeListener(listener)
//		A callback class that contains the entry point fireChanged()
// - getSelection()
//		returns the object { start: , end: } with the current selection in characters
// - setSelection(start, end)
//		start and end are the character positions that should be selected.
// - getString()
//		returns the ABC text that is currently displayed.
// - setString(str)
//		sets the ABC text that is currently displayed, and resets the initialText variable
// - getElem()
//		returns the textarea element
// - string initialText
//		Contains the starting text. This can be compared against the current text to see if anything changed.
//

/*global document, window, clearTimeout, setTimeout */

var TuneBook = require('../api/abc_tunebook').TuneBook;
var parseCommon = require('../parse/abc_common');
var Parse = require('../parse/abc_parse');
var TextPrinter = require('../transform/abc2abc_write');
var EngraverController = require('../write/abc_engraver_controller');

// Polyfill for CustomEvent for old IE versions
if ( typeof window.CustomEvent !== "function" ) {
	function CustomEvent(event, params) {
		params = params || {bubbles: false, cancelable: false, detail: undefined};
		var evt = document.createEvent('CustomEvent');
		evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);
		return evt;
	}
	CustomEvent.prototype = window.Event.prototype;
	window.CustomEvent = CustomEvent;
}

var EditArea = function(textareaid) {
  this.textarea = document.getElementById(textareaid);
  this.initialText = this.textarea.value;
  this.isDragging = false;
}

EditArea.prototype.addSelectionListener = function(listener) {
  this.textarea.onmousemove = function(ev) {
	  if (this.isDragging)
	    listener.fireSelectionChanged();
  };
};

EditArea.prototype.addChangeListener = function(listener) {
  this.changelistener = listener;
  this.textarea.onkeyup = function() {
    listener.fireChanged();
  };
  this.textarea.onmousedown = function() {
	this.isDragging = true;
    listener.fireSelectionChanged();
  };
  this.textarea.onmouseup = function() {
	this.isDragging = false;
    listener.fireChanged();
  };
  this.textarea.onchange = function() {
    listener.fireChanged();
  };
};

//TODO won't work under IE?
EditArea.prototype.getSelection = function() {
  return {start: this.textarea.selectionStart, end: this.textarea.selectionEnd};
};

EditArea.prototype.setSelection = function(start, end) {
	if(this.textarea.setSelectionRange)
	   this.textarea.setSelectionRange(start, end);
	else if(this.textarea.createTextRange) {
		// For IE8
	   var e = this.textarea.createTextRange();
	   e.collapse(true);
	   e.moveEnd('character', end);
	   e.moveStart('character', start);
	   e.select();
	}
  this.textarea.focus();
};

EditArea.prototype.getString = function() {
  return this.textarea.value;
};

EditArea.prototype.setString = function(str) {
  this.textarea.value = str;
  this.initialText = this.getString();
  if (this.changelistener) {
    this.changelistener.fireChanged();
  }
};

EditArea.prototype.getElem = function() {
  return this.textarea;
};

//
// window.ABCJS.Editor:
//
// constructor(editarea, params)
//		if editarea is a string, then it is an HTML id of a textarea control.
//		Otherwise, it should be an instantiation of an object that expresses the EditArea interface.
//
//		params is a hash of:
//		canvas_id: or paper_id: HTML id to draw in. If not present, then the drawing happens just below the editor.
//		generate_midi: if present, then midi is generated.
//		midi_id: if present, the HTML id to place the midi control. Otherwise it is placed in the same div as the paper.
//		midi_download_id: if present, the HTML id to place the midi download link. Otherwise it is placed in the same div as the paper.
//		generate_warnings: if present, then parser warnings are displayed on the page.
//		warnings_id: if present, the HTML id to place the warnings. Otherwise they are placed in the same div as the paper.
//		onchange: if present, the callback function to call whenever there has been a change.
//		gui: if present, the paper can send changes back to the editor (presumably because the user changed something directly.)
//		parser_options: options to send to the parser engine.
//		midi_options: options to send to the midi engine.
//		render_options: options to send to the render engine.
//		indicate_changed: the dirty flag is set if this is true.
//
// - setReadOnly(bool)
//		adds or removes the class abc_textarea_readonly, and adds or removes the attribute readonly=yes
// - setDirtyStyle(bool)
//		adds or removes the class abc_textarea_dirty
// - renderTune(abc, parserparams, div)
//		Immediately renders the tune. (Useful for creating the SVG output behind the scenes, if div is hidden)
//		string abc: the ABC text
//		parserparams: params to send to the parser
//		div: the HTML id to render to.
// - modelChanged()
//		Called when the model has been changed to trigger re-rendering
// - parseABC()
//		Called internally by fireChanged()
//		returns true if there has been a change since last call.
// - updateSelection()
//		Called when the user has changed the selection. This calls the engraver_controller to show the selection.
// - fireSelectionChanged()
//		Called by the textarea object when the user has changed the selection.
// - paramChanged(engraverparams)
//		Called to signal that the engraver params have changed, so re-rendering should occur.
// - fireChanged()
//		Called by the textarea object when the user has changed something.
// - setNotDirty()
//		Called by the client app to reset the dirty flag
// - isDirty()
//		Returns true or false, whether the textarea contains the same text that it started with.
// - highlight(abcelem)
//		Called by the engraver_controller to highlight an area.
// - pause(bool)
//		Stops the automatic rendering when the user is typing.
//

var Editor = function(editarea, params) {
	// Copy all the options that will be passed through
	this.abcjsParams = {};
	var key;
	if (params.abcjsParams) {
		for (key in params.abcjsParams) {
			if (params.abcjsParams.hasOwnProperty(key)) {
				this.abcjsParams[key] = params.abcjsParams[key];
			}
		}
	}
	if (params.midi_options) {
		for (key in params.midi_options) {
			if (params.midi_options.hasOwnProperty(key)) {
				this.abcjsParams[key] = params.midi_options[key];
			}
		}
	}
	if (params.parser_options) {
		for (key in params.parser_options) {
			if (params.parser_options.hasOwnProperty(key)) {
				this.abcjsParams[key] = params.parser_options[key];
			}
		}
	}
	if (params.render_options) {
		for (key in params.render_options) {
			if (params.render_options.hasOwnProperty(key)) {
				this.abcjsParams[key] = params.render_options[key];
			}
		}
	}

	if (params.indicate_changed)
		this.indicate_changed = true;
  if (typeof editarea === "string") {
    this.editarea = new EditArea(editarea);
  } else {
    this.editarea = editarea;
  }
  this.editarea.addSelectionListener(this);
  this.editarea.addChangeListener(this);

  if (params.canvas_id) {
    this.div = document.getElementById(params.canvas_id);
  } else if (params.paper_id) {
    this.div = document.getElementById(params.paper_id);
  } else {
    this.div = document.createElement("DIV");
    this.editarea.getElem().parentNode.insertBefore(this.div, this.editarea.getElem());
  }

	// If the user wants midi, then store the elements that it will be written to. The element could either be passed in as an id,
	// an element, or nothing. If nothing is passed in, then just put the midi on top of the generated music.
	if (params.generate_midi) {
	  	this.generate_midi = params.generate_midi;
		if (this.abcjsParams.generateDownload) {
			if (typeof params.midi_download_id === 'string')
				this.downloadMidi = document.getElementById(params.midi_download_id);
			else if (params.midi_download_id) // assume, if the var is not a string it is an element. If not, it will crash soon enough.
				this.downloadMidi = params.midi_download_id;
		}
		if (this.abcjsParams.generateInline !== false) { // The default for this is true, so undefined is also true.
			if (typeof params.midi_id === 'string')
				this.inlineMidi = document.getElementById(params.midi_id);
			else if (params.midi_id) // assume, if the var is not a string it is an element. If not, it will crash soon enough.
				this.inlineMidi = params.midi_id;
		}
	}

  if (params.generate_warnings || params.warnings_id) {
    if (params.warnings_id) {
      this.warningsdiv = document.getElementById(params.warnings_id);
    } else {
      this.warningsdiv = this.div;
    }
  }
  
  this.onchangeCallback = params.onchange;

  if (params.gui) {
    this.target = document.getElementById(editarea);
    this.abcjsParams.editable = true;
  } 
  this.oldt = "";
  this.bReentry = false;
  this.parseABC();
  this.modelChanged();

  this.addClassName = function(element, className) {
    var hasClassName = function(element, className) {
      var elementClassName = element.className;
      return (elementClassName.length > 0 && (elementClassName === className ||
        new RegExp("(^|\\s)" + className + "(\\s|$)").test(elementClassName)));
    };

    if (!hasClassName(element, className))
      element.className += (element.className ? ' ' : '') + className;
    return element;
  };

  this.removeClassName = function(element, className) {
    element.className = parseCommon.strip(element.className.replace(
      new RegExp("(^|\\s+)" + className + "(\\s+|$)"), ' '));
    return element;
  };

  this.setReadOnly = function(readOnly) {
	  var readonlyClass = 'abc_textarea_readonly';
	  var el = this.editarea.getElem();
    if (readOnly) {
      el.setAttribute('readonly', 'yes');
	  this.addClassName(el, readonlyClass);
	} else {
      el.removeAttribute('readonly');
	  this.removeClassName(el, readonlyClass);
    }
  };
};

Editor.prototype.renderTune = function(abc, params, div) {
  var tunebook = new TuneBook(abc);
  var abcParser = Parse();
  abcParser.parse(tunebook.tunes[0].abc, params); //TODO handle multiple tunes
  var tune = abcParser.getTune();
  var engraver_controller = new EngraverController(div, this.abcjsParams);
  engraver_controller.engraveABC(tune);
};

Editor.prototype.redrawMidi = function() {
	if (this.generate_midi && !this.midiPause) {
		var event = new window.CustomEvent("generateMidi", {
			detail: {
				tunes: this.tunes,
				abcjsParams: this.abcjsParams,
				downloadMidiEl: this.downloadMidi,
				inlineMidiEl: this.inlineMidi,
				engravingEl: this.div
			}
		});
		window.dispatchEvent(event);
	}
};

Editor.prototype.modelChanged = function() {
  if (this.tunes === undefined) {
    if (this.downloadMidi !== undefined)
		this.downloadMidi.innerHTML = "";
    if (this.inlineMidi !== undefined)
		this.inlineMidi.innerHTML = "";
    this.div.innerHTML = "";
	return;
  }

  if (this.bReentry)
    return; // TODO is this likely? maybe, if we rewrite abc immediately w/ abc2abc
  this.bReentry = true;
  this.timerId = null;
  this.div.innerHTML = "";
  this.engraver_controller = new EngraverController(this.div, this.abcjsParams);
  this.engraver_controller.engraveABC(this.tunes);
	this.tunes[0].engraver = this.engraver_controller;	// TODO-PER: We actually want an output object for each tune, not the entire controller. When refactoring, don't save data in the controller.
	this.redrawMidi();

  if (this.warningsdiv) {
    this.warningsdiv.innerHTML = (this.warnings) ? this.warnings.join("<br />") : "No errors";
  } 
  if (this.target) {
    var textprinter = new TextPrinter(this.target, true);
    textprinter.printABC(this.tunes[0]); //TODO handle multiple tunes
  }
  this.engraver_controller.addSelectListener(this.highlight.bind(this));
  this.updateSelection();
  this.bReentry = false;
};

// Call this to reparse in response to the printing parameters changing
Editor.prototype.paramChanged = function(engraverParams) {
	if (engraverParams) {
		for (var key in engraverParams) {
			if (engraverParams.hasOwnProperty(key)) {
				this.abcjsParams[key] = engraverParams[key];
			}
		}
	}
	this.oldt = "";
	this.fireChanged();
};

// return true if the model has changed
Editor.prototype.parseABC = function() {
  var t = this.editarea.getString();
  if (t===this.oldt) {
    this.updateSelection();
    return false;
  }
  
  this.oldt = t;
  if (t === "") {
	this.tunes = undefined;
	this.warnings = "";
	return true;
  }
  var tunebook = new TuneBook(t);
  
  this.tunes = [];
  this.startPos = [];
  this.warnings = [];
  for (var i=0; i<tunebook.tunes.length; i++) {
    var abcParser = new Parse();
    abcParser.parse(tunebook.tunes[i].abc, this.abcjsParams);
    this.tunes[i] = abcParser.getTune();
	  this.startPos[i] = tunebook.tunes[i].startPos;
    var warnings = abcParser.getWarnings() || [];
    for (var j=0; j<warnings.length; j++) {
      this.warnings.push(warnings[j]);
    }
  }
  return true;
};

Editor.prototype.updateSelection = function() {
  var selection = this.editarea.getSelection();
  try {
    this.engraver_controller.rangeHighlight(selection.start, selection.end);
  } catch (e) {} // maybe printer isn't defined yet?
};

Editor.prototype.fireSelectionChanged = function() {
  this.updateSelection();
};

Editor.prototype.setDirtyStyle = function(isDirty) {
	if (this.indicate_changed === undefined)
		return;
  var addClassName = function(element, className) {
    var hasClassName = function(element, className) {
      var elementClassName = element.className;
      return (elementClassName.length > 0 && (elementClassName === className ||
        new RegExp("(^|\\s)" + className + "(\\s|$)").test(elementClassName)));
    };

    if (!hasClassName(element, className))
      element.className += (element.className ? ' ' : '') + className;
    return element;
  };

  var removeClassName = function(element, className) {
    element.className = parseCommon.strip(element.className.replace(
      new RegExp("(^|\\s+)" + className + "(\\s+|$)"), ' '));
    return element;
  };
  
	var readonlyClass = 'abc_textarea_dirty';
	var el = this.editarea.getElem();
	if (isDirty) {
		addClassName(el, readonlyClass);
	} else {
		removeClassName(el, readonlyClass);
    }
};

// call when abc text is changed and needs re-parsing
Editor.prototype.fireChanged = function() {
  if (this.bIsPaused)
    return;
  if (this.parseABC()) {
    var self = this;
    if (this.timerId)	// If the user is still typing, cancel the update
      clearTimeout(this.timerId);
    this.timerId = setTimeout(function () {
      self.modelChanged();
    }, 300);	// Is this a good compromise between responsiveness and not redrawing too much?
	  var isDirty = this.isDirty();
	  if (this.wasDirty !== isDirty) {
		  this.wasDirty = isDirty;
		  this.setDirtyStyle(isDirty);
	  }
	  if (this.onchangeCallback)
		  this.onchangeCallback(this);
	  }
};

Editor.prototype.setNotDirty = function() {
	this.editarea.initialText = this.editarea.getString();
	this.wasDirty = false;
	this.setDirtyStyle(false);
};

Editor.prototype.isDirty = function() {
	if (this.indicate_changed === undefined)
		return false;
	return this.editarea.initialText !== this.editarea.getString();
};

Editor.prototype.highlight = function(abcelem, tuneNumber, classes) {
	// TODO-PER: The marker appears to get off by one for each tune parsed. I'm not sure why, but adding the tuneNumber in corrects it for the time being.
	var offset = (tuneNumber !== undefined) ? this.startPos[tuneNumber] + tuneNumber : 0;

  this.editarea.setSelection(offset + abcelem.startChar, offset + abcelem.endChar);
};

Editor.prototype.pause = function(shouldPause) {
	this.bIsPaused = shouldPause;
	if (!shouldPause)
		this.fireChanged();
};

Editor.prototype.pauseMidi = function(shouldPause) {
	this.midiPause = shouldPause;
	if (!shouldPause)
		this.redrawMidi();
};

module.exports = Editor;

},{"../api/abc_tunebook":5,"../parse/abc_common":9,"../parse/abc_parse":10,"../transform/abc2abc_write":16,"../write/abc_engraver_controller":28}],9:[function(require,module,exports){
//    abc_parse.js: parses a string representing ABC Music Notation into a usable internal structure.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var parseCommon = {};

parseCommon.clone = function(source) {
	var destination = {};
	for (var property in source)
		if (source.hasOwnProperty(property))
			destination[property] = source[property];
	return destination;
};

parseCommon.cloneArray = function(source) {
	var destination = [];
	for (var i = 0; i < source.length; i++) {
		destination.push(parseCommon.clone(source[i]));
	}
	return destination;
};

parseCommon.cloneHashOfHash = function(source) {
	var destination = {};
	for (var property in source)
		if (source.hasOwnProperty(property))
			destination[property] = parseCommon.clone(source[property]);
	return destination;
};

parseCommon.cloneHashOfArrayOfHash = function(source) {
	var destination = {};
	for (var property in source)
		if (source.hasOwnProperty(property))
			destination[property] = parseCommon.cloneArray(source[property]);
	return destination;
};

parseCommon.gsub = function(source, pattern, replacement) {
	return source.split(pattern).join(replacement);
};

parseCommon.strip = function(str) {
	return str.replace(/^\s+/, '').replace(/\s+$/, '');
};

parseCommon.startsWith = function(str, pattern) {
	return str.indexOf(pattern) === 0;
};

parseCommon.endsWith = function(str, pattern) {
	var d = str.length - pattern.length;
	return d >= 0 && str.lastIndexOf(pattern) === d;
};

parseCommon.each = function(arr, iterator, context) {
	for (var i = 0, length = arr.length; i < length; i++)
	  iterator.apply(context, [arr[i],i]);
};

parseCommon.last = function(arr) {
	if (arr.length === 0)
		return null;
	return arr[arr.length-1];
};

parseCommon.compact = function(arr) {
	var output = [];
	for (var i = 0; i < arr.length; i++) {
		if (arr[i])
			output.push(arr[i]);
	}
	return output;
};

parseCommon.detect = function(arr, iterator) {
	for (var i = 0; i < arr.length; i++) {
		if (iterator(arr[i]))
			return true;
	}
	return false;
};

// The following is a polyfill for Object.remove for IE9, IE10, and IE11.
// from:https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/remove()/remove().md
(function (arr) {
	arr.forEach(function (item) {
		if (item.hasOwnProperty('remove')) {
			return;
		}
		Object.defineProperty(item, 'remove', {
			configurable: true,
			enumerable: true,
			writable: true,
			value: function remove() {
				if (this.parentNode !== null)
					this.parentNode.removeChild(this);
			}
		});
	});
})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);

module.exports = parseCommon;

},{}],10:[function(require,module,exports){
//    abc_parse.js: parses a string representing ABC Music Notation into a usable internal structure.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

/*global window */

var parseCommon = require('./abc_common');
var parseDirective = require('./abc_parse_directive');
var ParseHeader = require('./abc_parse_header');
var parseKeyVoice = require('./abc_parse_key_voice');
var Tokenizer = require('./abc_tokenizer');
var transpose = require('./abc_transpose');

var Tune = require('../data/abc_tune');

var Parse = function() {
	"use strict";
	var tune = new Tune();
	var tokenizer = new Tokenizer();

	this.getTune = function() {
		return tune;
	};

	function addPositioning(el, type, value) {
		if (!el.positioning) el.positioning = {};
		el.positioning[type] = value;
	}

	function addFont(el, type, value) {
		if (!el.fonts) el.fonts = {};
		el.fonts[type] = value;
	}

	var multilineVars = {
		reset: function() {
			for (var property in this) {
				if (this.hasOwnProperty(property) && typeof this[property] !== "function") {
					delete this[property];
				}
			}
			this.iChar = 0;
			this.key = {accidentals: [], root: 'none', acc: '', mode: '' };
			this.meter = null; // if no meter is specified, free meter is assumed
			this.origMeter = null;	// this is for new voices that are created after we set the meter.
			this.hasMainTitle = false;
			this.default_length = 0.125;
			this.clef = { type: 'treble', verticalPos: 0 };
			this.next_note_duration = 0;
			this.start_new_line = true;
			this.is_in_header = true;
			this.is_in_history = false;
			this.partForNextLine = "";
			this.havent_set_length = true;
			this.voices = {};
			this.staves = [];
			this.macros = {};
			this.currBarNumber = 1;
			this.barCounter = {};
			this.inTextBlock = false;
			this.inPsBlock = false;
			this.ignoredDecorations = [];
			this.textBlock = "";
			this.score_is_present = false;	// Can't have original V: lines when there is the score directive
			this.inEnding = false;
			this.inTie = false;
			this.inTieChord = {};
			this.vocalPosition = "auto";
			this.dynamicPosition = "auto";
			this.chordPosition = "auto";
			this.ornamentPosition = "auto";
			this.volumePosition = "auto";
			this.openSlurs = [];
		},
		differentFont: function(type, defaultFonts) {
			if (this[type].decoration !== defaultFonts[type].decoration) return true;
			if (this[type].face !== defaultFonts[type].face) return true;
			if (this[type].size !== defaultFonts[type].size) return true;
			if (this[type].style !== defaultFonts[type].style) return true;
			if (this[type].weight !== defaultFonts[type].weight) return true;
			return false;
		},
		addFormattingOptions: function(el, defaultFonts, elType) {
			if (elType === 'note') {
				if (this.vocalPosition !== 'auto') addPositioning(el, 'vocalPosition', this.vocalPosition);
				if (this.dynamicPosition !== 'auto') addPositioning(el, 'dynamicPosition', this.dynamicPosition);
				if (this.chordPosition !== 'auto') addPositioning(el, 'chordPosition', this.chordPosition);
				if (this.ornamentPosition !== 'auto') addPositioning(el, 'ornamentPosition', this.ornamentPosition);
				if (this.volumePosition !== 'auto') addPositioning(el, 'volumePosition', this.volumePosition);
				if (this.differentFont("annotationfont", defaultFonts)) addFont(el, 'annotationfont', this.annotationfont);
				if (this.differentFont("gchordfont", defaultFonts)) addFont(el, 'gchordfont', this.gchordfont);
				if (this.differentFont("vocalfont", defaultFonts)) addFont(el, 'vocalfont', this.vocalfont);
				if (this.differentFont("tripletfont", defaultFonts)) addFont(el, 'tripletfont', this.tripletfont);
			} else if (elType === 'bar') {
				if (this.dynamicPosition !== 'auto') addPositioning(el, 'dynamicPosition', this.dynamicPosition);
				if (this.chordPosition !== 'auto') addPositioning(el, 'chordPosition', this.chordPosition);
				if (this.ornamentPosition !== 'auto') addPositioning(el, 'ornamentPosition', this.ornamentPosition);
				if (this.volumePosition !== 'auto') addPositioning(el, 'volumePosition', this.volumePosition);
				if (this.differentFont("measurefont", defaultFonts)) addFont(el, 'measurefont', this.measurefont);
				if (this.differentFont("repeatfont", defaultFonts)) addFont(el, 'repeatfont', this.repeatfont);
			}
		}
	};

	var addWarning = function(str) {
		if (!multilineVars.warnings)
			multilineVars.warnings = [];
		multilineVars.warnings.push(str);
	};

	var addWarningObject = function(warningObject) {
		if (!multilineVars.warningObjects)
			multilineVars.warningObjects = [];
		multilineVars.warningObjects.push(warningObject);
	};

	var encode = function(str) {
		var ret = parseCommon.gsub(str, '\x12', ' ');
		ret = parseCommon.gsub(ret, '&', '&amp;');
		ret = parseCommon.gsub(ret, '<', '&lt;');
		return parseCommon.gsub(ret, '>', '&gt;');
	};

	var warn = function(str, line, col_num) {
		if (!line) line = " ";
		var bad_char = line.charAt(col_num);
		if (bad_char === ' ')
			bad_char = "SPACE";
		var clean_line = encode(line.substring(0, col_num)) +
			'<span style="text-decoration:underline;font-size:1.3em;font-weight:bold;">' + bad_char + '</span>' +
			encode(line.substring(col_num+1));
		addWarning("Music Line:" + tune.getNumLines() + ":" + (col_num+1) + ': ' + str + ":  " + clean_line);
		addWarningObject({message:str, line:line, startChar: multilineVars.iChar + col_num, column: col_num});
	};
	var header = new ParseHeader(tokenizer, warn, multilineVars, tune);

	this.getWarnings = function() {
		return multilineVars.warnings;
	};
	this.getWarningObjects = function() {
		return multilineVars.warningObjects;
	};

	var letter_to_chord = function(line, i)
	{
		if (line.charAt(i) === '"')
		{
			var chord = tokenizer.getBrackettedSubstring(line, i, 5);
			if (!chord[2])
				warn("Missing the closing quote while parsing the chord symbol", line , i);
			// If it starts with ^, then the chord appears above.
			// If it starts with _ then the chord appears below.
			// (note that the 2.0 draft standard defines them as not chords, but annotations and also defines @.)
			if (chord[0] > 0 && chord[1].length > 0 && chord[1].charAt(0) === '^') {
				chord[1] = chord[1].substring(1);
				chord[2] = 'above';
			} else if (chord[0] > 0 && chord[1].length > 0 && chord[1].charAt(0) === '_') {
				chord[1] = chord[1].substring(1);
				chord[2] = 'below';
			} else if (chord[0] > 0 && chord[1].length > 0 && chord[1].charAt(0) === '<') {
				chord[1] = chord[1].substring(1);
				chord[2] = 'left';
			} else if (chord[0] > 0 && chord[1].length > 0 && chord[1].charAt(0) === '>') {
				chord[1] = chord[1].substring(1);
				chord[2] = 'right';
			} else if (chord[0] > 0 && chord[1].length > 0 && chord[1].charAt(0) === '@') {
				// @-15,5.7
				chord[1] = chord[1].substring(1);
				var x = tokenizer.getFloat(chord[1]);
				if (x.digits === 0)
					warn("Missing first position in absolutely positioned annotation.", line , i);
				chord[1] = chord[1].substring(x.digits);
				if (chord[1][0] !== ',')
					warn("Missing comma absolutely positioned annotation.", line , i);
				chord[1] = chord[1].substring(1);
				var y = tokenizer.getFloat(chord[1]);
				if (y.digits === 0)
					warn("Missing second position in absolutely positioned annotation.", line , i);
				chord[1] = chord[1].substring(y.digits);
				var ws = tokenizer.skipWhiteSpace(chord[1]);
				chord[1] = chord[1].substring(ws);
				chord[2] = null;
				chord[3] = { x: x.value, y: y.value };
			} else {
				chord[1] = chord[1].replace(/([ABCDEFG0-9])b/g, "$1♭");
				chord[1] = chord[1].replace(/([ABCDEFG0-9])#/g, "$1♯");
				chord[2] = 'default';
				chord[1] = transpose.chordName(multilineVars, chord[1]);
			}
			return chord;
		}
		return [0, ""];
	};

	var legalAccents = [ "trill", "lowermordent", "uppermordent", "mordent", "pralltriller", "accent",
		"fermata", "invertedfermata", "tenuto", "0", "1", "2", "3", "4", "5", "+", "wedge",
		"open", "thumb", "snap", "turn", "roll", "breath", "shortphrase", "mediumphrase", "longphrase",
		"segno", "coda", "D.S.", "D.C.", "fine",
		"slide", "^", "marcato",
		"upbow", "downbow", "/", "//", "///", "////", "trem1", "trem2", "trem3", "trem4",
		"turnx", "invertedturn", "invertedturnx", "trill(", "trill)", "arpeggio", "xstem", "mark", "umarcato",
		"style=normal", "style=harmonic", "style=rhythm", "style=x"
	];
	var volumeDecorations = [ "p", "pp", "f", "ff", "mf", "mp", "ppp", "pppp",  "fff", "ffff", "sfz" ];
	var dynamicDecorations = ["crescendo(", "crescendo)", "diminuendo(", "diminuendo)"];

	var accentPseudonyms = [ ["<", "accent"], [">", "accent"], ["tr", "trill"],
		["plus", "+"], [ "emphasis", "accent"],
		[ "^", "umarcato" ], [ "marcato", "umarcato" ] ];
	var accentDynamicPseudonyms = [ ["<(", "crescendo("], ["<)", "crescendo)"],
		[">(", "diminuendo("], [">)", "diminuendo)"] ];
	var letter_to_accent = function(line, i)
	{
		var macro = multilineVars.macros[line.charAt(i)];

		if (macro !== undefined) {
			if (macro.charAt(0) === '!' || macro.charAt(0) === '+')
				macro = macro.substring(1);
			if (macro.charAt(macro.length-1) === '!' || macro.charAt(macro.length-1) === '+')
				macro = macro.substring(0, macro.length-1);
			if (parseCommon.detect(legalAccents, function(acc) {
					return (macro === acc);
				}))
				return [ 1, macro ];
			else if (parseCommon.detect(volumeDecorations, function(acc) {
					return (macro === acc);
				})) {
				if (multilineVars.volumePosition === 'hidden')
					macro = "";
				return [1, macro];
			} else if (parseCommon.detect(dynamicDecorations, function(acc) {
					if (multilineVars.dynamicPosition === 'hidden')
						macro = "";
					return (macro === acc);
				})) {
				return [1, macro];
			} else {
				if (!parseCommon.detect(multilineVars.ignoredDecorations, function(dec) {
					return (macro === dec);
				}))
					warn("Unknown macro: " + macro, line, i);
				return [1, '' ];
			}
		}
		switch (line.charAt(i))
		{
			case '.':return [1, 'staccato'];
			case 'u':return [1, 'upbow'];
			case 'v':return [1, 'downbow'];
			case '~':return [1, 'irishroll'];
			case '!':
			case '+':
				var ret = tokenizer.getBrackettedSubstring(line, i, 5);
				// Be sure that the accent is recognizable.
			if (ret[1].length > 0 && (ret[1].charAt(0) === '^' || ret[1].charAt(0) ==='_'))
					ret[1] = ret[1].substring(1);	// TODO-PER: The test files have indicators forcing the ornament to the top or bottom, but that isn't in the standard. We'll just ignore them.
				if (parseCommon.detect(legalAccents, function(acc) {
					return (ret[1] === acc);
				}))
					return ret;
				if (parseCommon.detect(volumeDecorations, function(acc) {
						return (ret[1] === acc);
					})) {
					if (multilineVars.volumePosition === 'hidden' )
						ret[1] = '';
						return ret;
				}
				if (parseCommon.detect(dynamicDecorations, function(acc) {
						return (ret[1] === acc);
					})) {
					if (multilineVars.dynamicPosition === 'hidden' )
						ret[1] = '';
						return ret;
				}

				if (parseCommon.detect(accentPseudonyms, function(acc) {
					if (ret[1] === acc[0]) {
						ret[1] = acc[1];
						return true;
					} else
						return false;
				}))
					return ret;

				if (parseCommon.detect(accentDynamicPseudonyms, function(acc) {
					if (ret[1] === acc[0]) {
						ret[1] = acc[1];
						return true;
					} else
						return false;
				})) {
					if (multilineVars.dynamicPosition === 'hidden' )
						ret[1] = '';
						return ret;
				}
				// We didn't find the accent in the list, so consume the space, but don't return an accent.
				// Although it is possible that ! was used as a line break, so accept that.
			if (line.charAt(i) === '!' && (ret[0] === 1 || line.charAt(i+ret[0]-1) !== '!'))
					return [1, null ];
				warn("Unknown decoration: " + ret[1], line, i);
				ret[1] = "";
				return ret;
			case 'H':return [1, 'fermata'];
			case 'J':return [1, 'slide'];
			case 'L':return [1, 'accent'];
			case 'M':return [1, 'mordent'];
			case 'O':return[1, 'coda'];
			case 'P':return[1, 'pralltriller'];
			case 'R':return [1, 'roll'];
			case 'S':return [1, 'segno'];
			case 'T':return [1, 'trill'];
		}
		return [0, 0];
	};

	var letter_to_spacer = function(line, i)
	{
		var start = i;
		while (tokenizer.isWhiteSpace(line.charAt(i)))
			i++;
		return [ i-start ];
	};

	// returns the class of the bar line
	// the number of the repeat
	// and the number of characters used up
	// if 0 is returned, then the next element was not a bar line
	var letter_to_bar = function(line, curr_pos)
	{
		var ret = tokenizer.getBarLine(line, curr_pos);
		if (ret.len === 0)
			return [0,""];
		if (ret.warn) {
			warn(ret.warn, line, curr_pos);
			return [ret.len,""];
		}

		// Now see if this is a repeated ending
		// A repeated ending is all of the characters 1,2,3,4,5,6,7,8,9,0,-, and comma
		// It can also optionally start with '[', which is ignored.
		// Also, it can have white space before the '['.
		for (var ws = 0; ws < line.length; ws++)
			if (line.charAt(curr_pos + ret.len + ws) !== ' ')
				break;
		var orig_bar_len = ret.len;
		if (line.charAt(curr_pos+ret.len+ws) === '[') {
			ret.len += ws + 1;
		}

		// It can also be a quoted string. It is unclear whether that construct requires '[', but it seems like it would. otherwise it would be confused with a regular chord.
		if (line.charAt(curr_pos+ret.len) === '"' && line.charAt(curr_pos+ret.len-1) === '[') {
			var ending = tokenizer.getBrackettedSubstring(line, curr_pos+ret.len, 5);
			return [ret.len+ending[0], ret.token, ending[1]];
		}
		var retRep = tokenizer.getTokenOf(line.substring(curr_pos+ret.len), "1234567890-,");
		if (retRep.len === 0 || retRep.token[0] === '-')
			return [orig_bar_len, ret.token];

		return [ret.len+retRep.len, ret.token, retRep.token];
	};

	var tripletQ = {
		2: 3,
		3: 2,
		4: 3,
		5: 2, // TODO-PER: not handling 6/8 rhythm yet
		6: 2,
		7: 2, // TODO-PER: not handling 6/8 rhythm yet
		8: 3,
		9: 2 // TODO-PER: not handling 6/8 rhythm yet
	};
	var letter_to_open_slurs_and_triplets =  function(line, i) {
		// consume spaces, and look for all the open parens. If there is a number after the open paren,
		// that is a triplet. Otherwise that is a slur. Collect all the slurs and the first triplet.
		var ret = {};
		var start = i;
		while (line.charAt(i) === '(' || tokenizer.isWhiteSpace(line.charAt(i))) {
			if (line.charAt(i) === '(') {
				if (i+1 < line.length && (line.charAt(i+1) >= '2' && line.charAt(i+1) <= '9')) {
					if (ret.triplet !== undefined)
						warn("Can't nest triplets", line, i);
					else {
						ret.triplet = line.charAt(i+1) - '0';
						ret.tripletQ = tripletQ[ret.triplet];
						ret.num_notes = ret.triplet;
						if (i+2 < line.length && line.charAt(i+2) === ':') {
							// We are expecting "(p:q:r" or "(p:q" or "(p::r"
							// That is: "put p notes into the time of q for the next r notes"
							// if r is missing, then it is equal to p.
							// if q is missing, it is determined from this table:
							// (2 notes in the time of 3
							// (3 notes in the time of 2
							// (4 notes in the time of 3
							// (5 notes in the time of n | if time sig is (6/8, 9/8, 12/8), n=3, else n=2
							// (6 notes in the time of 2
							// (7 notes in the time of n
							// (8 notes in the time of 3
							// (9 notes in the time of n
							if (i+3 < line.length && line.charAt(i+3) === ':') {
								// The second number, 'q', is not present.
								if (i+4 < line.length && (line.charAt(i+4) >= '1' && line.charAt(i+4) <= '9')) {
									ret.num_notes = line.charAt(i+4) - '0';
									i += 3;
								} else
									warn("expected number after the two colons after the triplet to mark the duration", line, i);
							} else if (i+3 < line.length && (line.charAt(i+3) >= '1' && line.charAt(i+3) <= '9')) {
								ret.tripletQ = line.charAt(i+3) - '0';
								if (i+4 < line.length && line.charAt(i+4) === ':') {
									if (i+5 < line.length && (line.charAt(i+5) >= '1' && line.charAt(i+5) <= '9')) {
										ret.num_notes = line.charAt(i+5) - '0';
										i += 4;
									}
								} else {
									i += 2;
								}
							} else
								warn("expected number after the triplet to mark the duration", line, i);
						}
					}
					i++;
				}
				else {
					if (ret.startSlur === undefined)
						ret.startSlur = 1;
					else
						ret.startSlur++;
				}
			}
			i++;
		}
		ret.consumed = i-start;
		return ret;
	};

	var addWords = function(line, words) {
		if (!line) { warn("Can't add words before the first line of music", line, 0); return; }
		words = parseCommon.strip(words);
		if (words.charAt(words.length-1) !== '-')
			words = words + ' ';	// Just makes it easier to parse below, since every word has a divider after it.
		var word_list = [];
		// first make a list of words from the string we are passed. A word is divided on either a space or dash.
		var last_divider = 0;
		var replace = false;
		var addWord = function(i) {
			var word = parseCommon.strip(words.substring(last_divider, i));
			last_divider = i+1;
			if (word.length > 0) {
				if (replace)
					word = parseCommon.gsub(word,'~', ' ');
				var div = words.charAt(i);
				if (div !== '_' && div !== '-')
					div = ' ';
				word_list.push({syllable: tokenizer.translateString(word), divider: div});
				replace = false;
				return true;
			}
			return false;
		};
		for (var i = 0; i < words.length; i++) {
			switch (words.charAt(i)) {
				case ' ':
				case '\x12':
					addWord(i);
					break;
				case '-':
					if (!addWord(i) && word_list.length > 0) {
						parseCommon.last(word_list).divider = '-';
						word_list.push({skip: true, to: 'next'});
					}
					break;
				case '_':
					addWord(i);
					word_list.push({skip: true, to: 'slur'});
					break;
				case '*':
					addWord(i);
					word_list.push({skip: true, to: 'next'});
					break;
				case '|':
					addWord(i);
					word_list.push({skip: true, to: 'bar'});
					break;
				case '~':
					replace = true;
					break;
			}
		}

		var inSlur = false;
		parseCommon.each(line, function(el) {
			if (word_list.length !== 0) {
				if (word_list[0].skip) {
					switch (word_list[0].to) {
						case 'next': if (el.el_type === 'note' && el.pitches !== null && !inSlur) word_list.shift(); break;
						case 'slur': if (el.el_type === 'note' && el.pitches !== null) word_list.shift(); break;
						case 'bar': if (el.el_type === 'bar') word_list.shift(); break;
					}
					if (el.el_type !== 'bar') {
						if (el.lyric === undefined)
							el.lyric = [{syllable: "", divider: " "}];
						else
							el.lyric.push({syllable: "", divider: " "});
					}
				} else {
					if (el.el_type === 'note' && el.rest === undefined && !inSlur) {
						var lyric = word_list.shift();
						if (lyric.syllable)
							lyric.syllable = lyric.syllable.replace(/ +/g,'\xA0');
						if (el.lyric === undefined)
							el.lyric = [ lyric ];
						else
							el.lyric.push(lyric);
					}
				}
			}
		});
	};

	var addSymbols = function(line, words) {
		// TODO-PER: Currently copied from w: line. This needs to be read as symbols instead.
		if (!line) { warn("Can't add symbols before the first line of music", line, 0); return; }
		words = parseCommon.strip(words);
		if (words.charAt(words.length-1) !== '-')
			words = words + ' ';	// Just makes it easier to parse below, since every word has a divider after it.
		var word_list = [];
		// first make a list of words from the string we are passed. A word is divided on either a space or dash.
		var last_divider = 0;
		var replace = false;
		var addWord = function(i) {
			var word = parseCommon.strip(words.substring(last_divider, i));
			last_divider = i+1;
			if (word.length > 0) {
				if (replace)
					word = parseCommon.gsub(word, '~', ' ');
				var div = words.charAt(i);
				if (div !== '_' && div !== '-')
					div = ' ';
				word_list.push({syllable: tokenizer.translateString(word), divider: div});
				replace = false;
				return true;
			}
			return false;
		};
		for (var i = 0; i < words.length; i++) {
			switch (words.charAt(i)) {
				case ' ':
				case '\x12':
					addWord(i);
					break;
				case '-':
					if (!addWord(i) && word_list.length > 0) {
						parseCommon.last(word_list).divider = '-';
						word_list.push({skip: true, to: 'next'});
					}
					break;
				case '_':
					addWord(i);
					word_list.push({skip: true, to: 'slur'});
					break;
				case '*':
					addWord(i);
					word_list.push({skip: true, to: 'next'});
					break;
				case '|':
					addWord(i);
					word_list.push({skip: true, to: 'bar'});
					break;
				case '~':
					replace = true;
					break;
			}
		}

		var inSlur = false;
		parseCommon.each(line, function(el) {
			if (word_list.length !== 0) {
				if (word_list[0].skip) {
					switch (word_list[0].to) {
						case 'next': if (el.el_type === 'note' && el.pitches !== null && !inSlur) word_list.shift(); break;
						case 'slur': if (el.el_type === 'note' && el.pitches !== null) word_list.shift(); break;
						case 'bar': if (el.el_type === 'bar') word_list.shift(); break;
					}
				} else {
					if (el.el_type === 'note' && el.rest === undefined && !inSlur) {
						var lyric = word_list.shift();
						if (el.lyric === undefined)
							el.lyric = [ lyric ];
						else
							el.lyric.push(lyric);
					}
				}
			}
		});
	};

	var getBrokenRhythm = function(line, index) {
		switch (line.charAt(index)) {
			case '>':
			if (index < line.length - 1 && line.charAt(index+1) === '>')	// double >>
					return [2, 1.75, 0.25];
				else
					return [1, 1.5, 0.5];
				break;
			case '<':
			if (index < line.length - 1 && line.charAt(index+1) === '<')	// double <<
					return [2, 0.25, 1.75];
				else
					return [1, 0.5, 1.5];
				break;
		}
		return null;
	};

	// TODO-PER: make this a method in el.
	var addEndBeam = function(el) {
		if (el.duration !== undefined && el.duration < 0.25)
			el.end_beam = true;
		return el;
	};

	var pitches = {A: 5, B: 6, C: 0, D: 1, E: 2, F: 3, G: 4, a: 12, b: 13, c: 7, d: 8, e: 9, f: 10, g: 11};
	var rests = {x: 'invisible', y: 'spacer', z: 'rest', Z: 'multimeasure' };
	var getCoreNote = function(line, index, el, canHaveBrokenRhythm) {
		//var el = { startChar: index };
		var isComplete = function(state) {
			return (state === 'octave' || state === 'duration' || state === 'Zduration' || state === 'broken_rhythm' || state === 'end_slur');
		};
		var state = 'startSlur';
		var durationSetByPreviousNote = false;
		while (1) {
			switch(line.charAt(index)) {
				case '(':
					if (state === 'startSlur') {
						if (el.startSlur === undefined) el.startSlur = 1; else el.startSlur++;
					} else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case ')':
					if (isComplete(state)) {
						if (el.endSlur === undefined) el.endSlur = 1; else el.endSlur++;
					} else return null;
					break;
				case '^':
					if (state === 'startSlur') {el.accidental = 'sharp';state = 'sharp2';}
					else if (state === 'sharp2') {el.accidental = 'dblsharp';state = 'pitch';}
					else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case '_':
					if (state === 'startSlur') {el.accidental = 'flat';state = 'flat2';}
					else if (state === 'flat2') {el.accidental = 'dblflat';state = 'pitch';}
					else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case '=':
					if (state === 'startSlur') {el.accidental = 'natural';state = 'pitch';}
					else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case 'A':
				case 'B':
				case 'C':
				case 'D':
				case 'E':
				case 'F':
				case 'G':
				case 'a':
				case 'b':
				case 'c':
				case 'd':
				case 'e':
				case 'f':
				case 'g':
					if (state === 'startSlur' || state === 'sharp2' || state === 'flat2' || state === 'pitch') {
						el.pitch = pitches[line.charAt(index)];
						transpose.note(multilineVars, el);
						state = 'octave';
						// At this point we have a valid note. The rest is optional. Set the duration in case we don't get one below
						if (canHaveBrokenRhythm && multilineVars.next_note_duration !== 0) {
							el.duration = multilineVars.default_length * multilineVars.next_note_duration;
							multilineVars.next_note_duration = 0;
							durationSetByPreviousNote = true;
						} else
							el.duration = multilineVars.default_length;
						// If the clef is percussion, there is probably some translation of the pitch to a particular drum kit item.
						if ((multilineVars.clef && multilineVars.clef.type === "perc") ||
							(multilineVars.currentVoice && multilineVars.currentVoice.clef === "perc")) {
							var key = line.charAt(index);
							if (el.accidental) {
								var accMap = { 'dblflat': '__', 'flat': '_', 'natural': '=', 'sharp': '^', 'dblsharp': '^^'};
								key = accMap[el.accidental] + key;
							}
							if (tune.formatting && tune.formatting.midi && tune.formatting.midi.drummap)
								el.midipitch = tune.formatting.midi.drummap[key];
						}
					} else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case ',':
					if (state === 'octave') {el.pitch -= 7;}
					else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case '\'':
					if (state === 'octave') {el.pitch += 7;}
					else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case 'x':
				case 'y':
				case 'z':
				case 'Z':
					if (state === 'startSlur') {
						el.rest = { type: rests[line.charAt(index)] };
						// There shouldn't be some of the properties that notes have. If some sneak in due to bad syntax in the abc file,
						// just nix them here.
						delete el.accidental;
						delete el.startSlur;
						delete el.startTie;
						delete el.endSlur;
						delete el.endTie;
						delete el.end_beam;
						delete el.grace_notes;
						// At this point we have a valid note. The rest is optional. Set the duration in case we don't get one below
						if (el.rest.type === 'multimeasure') {
							el.duration = 1;
							state = 'Zduration';
						} else {
							if (canHaveBrokenRhythm && multilineVars.next_note_duration !== 0) {
								el.duration = multilineVars.default_length * multilineVars.next_note_duration;
								multilineVars.next_note_duration = 0;
								durationSetByPreviousNote = true;
							} else
								el.duration = multilineVars.default_length;
							state = 'duration';
						}
					} else if (isComplete(state)) {el.endChar = index;return el;}
					else return null;
					break;
				case '1':
				case '2':
				case '3':
				case '4':
				case '5':
				case '6':
				case '7':
				case '8':
				case '9':
				case '0':
				case '/':
					if (state === 'octave' || state === 'duration') {
						var fraction = tokenizer.getFraction(line, index);
						//if (!durationSetByPreviousNote)
							el.duration = el.duration * fraction.value;
						// TODO-PER: We can test the returned duration here and give a warning if it isn't the one expected.
						el.endChar = fraction.index;
						while (fraction.index < line.length && (tokenizer.isWhiteSpace(line.charAt(fraction.index)) || line.charAt(fraction.index) === '-')) {
							if (line.charAt(fraction.index) === '-')
								el.startTie = {};
							else
								el = addEndBeam(el);
							fraction.index++;
						}
						index = fraction.index-1;
						state = 'broken_rhythm';
					} else if (state === 'sharp2') {
						el.accidental = 'quartersharp';state = 'pitch';
					} else if (state === 'flat2') {
						el.accidental = 'quarterflat';state = 'pitch';
					} else if (state === 'Zduration') {
						var num = tokenizer.getNumber(line, index);
						el.duration = num.num;
						el.endChar = num.index;
						return el;
					} else return null;
					break;
				case '-':
					if (state === 'startSlur') {
						// This is the first character, so it must have been meant for the previous note. Correct that here.
						tune.addTieToLastNote();
						el.endTie = true;
					} else if (state === 'octave' || state === 'duration' || state === 'end_slur') {
						el.startTie = {};
						if (!durationSetByPreviousNote && canHaveBrokenRhythm)
							state = 'broken_rhythm';
						else {
							// Peek ahead to the next character. If it is a space, then we have an end beam.
							if (tokenizer.isWhiteSpace(line.charAt(index + 1)))
								addEndBeam(el);
							el.endChar = index+1;
							return el;
						}
					} else if (state === 'broken_rhythm') {el.endChar = index;return el;}
					else return null;
					break;
				case ' ':
				case '\t':
					if (isComplete(state)) {
						el.end_beam = true;
						// look ahead to see if there is a tie
						do {
							if (line.charAt(index) === '-')
								el.startTie = {};
							index++;
						} while (index < line.length && (tokenizer.isWhiteSpace(line.charAt(index)) || line.charAt(index) === '-'));
						el.endChar = index;
						if (!durationSetByPreviousNote && canHaveBrokenRhythm && (line.charAt(index) === '<' || line.charAt(index) === '>')) {	// TODO-PER: Don't need the test for < and >, but that makes the endChar work out for the regression test.
							index--;
							state = 'broken_rhythm';
						} else
							return el;
					}
					else return null;
					break;
				case '>':
				case '<':
					if (isComplete(state)) {
						if (canHaveBrokenRhythm) {
							var br2 = getBrokenRhythm(line, index);
							index += br2[0] - 1;	// index gets incremented below, so we'll let that happen
							multilineVars.next_note_duration = br2[2];
							el.duration = br2[1]*el.duration;
							state = 'end_slur';
						} else {
							el.endChar = index;
							return el;
						}
					} else
						return null;
					break;
				default:
					if (isComplete(state)) {
						el.endChar = index;
						return el;
					}
					return null;
			}
			index++;
			if (index === line.length) {
				if (isComplete(state)) {el.endChar = index;return el;}
				else return null;
			}
		}
		return null;
	};

	function startNewLine() {
		var params = { startChar: -1, endChar: -1};
		if (multilineVars.partForNextLine.length)
			params.part = multilineVars.partForNextLine;
		params.clef = multilineVars.currentVoice && multilineVars.staves[multilineVars.currentVoice.staffNum].clef !== undefined ? parseCommon.clone(multilineVars.staves[multilineVars.currentVoice.staffNum].clef) : parseCommon.clone(multilineVars.clef);
		var scoreTranspose = multilineVars.currentVoice ? multilineVars.currentVoice.scoreTranspose : 0;
		params.key = parseKeyVoice.standardKey(multilineVars.key.root+multilineVars.key.acc+multilineVars.key.mode, multilineVars.key.root, multilineVars.key.acc, scoreTranspose);
		params.key.mode = multilineVars.key.mode;
		if (multilineVars.key.impliedNaturals)
			params.key.impliedNaturals = multilineVars.key.impliedNaturals;
		if (multilineVars.key.explicitAccidentals) {
			for (var i = 0; i < multilineVars.key.explicitAccidentals.length; i++) {
				var found = false;
				for (var j = 0; j < params.key.accidentals.length; j++) {
					if (params.key.accidentals[j].note === multilineVars.key.explicitAccidentals[i].note) {
						// If the note is already in the list, override it with the new value
						params.key.accidentals[j].acc = multilineVars.key.explicitAccidentals[i].acc;
						found = true;
					}
				}
				if (!found)
					params.key.accidentals.push(multilineVars.key.explicitAccidentals[i]);
			}
		}
		if (params.key.explicitAccidentals)
			delete params.key.explicitAccidentals;
		parseKeyVoice.addPosToKey(params.clef, params.key);
		if (multilineVars.meter !== null) {
			if (multilineVars.currentVoice) {
				parseCommon.each(multilineVars.staves, function(st) {
					st.meter = multilineVars.meter;
				});
				params.meter = multilineVars.staves[multilineVars.currentVoice.staffNum].meter;
				multilineVars.staves[multilineVars.currentVoice.staffNum].meter = null;
			} else
				params.meter = multilineVars.meter;
			multilineVars.meter = null;
		} else if (multilineVars.currentVoice && multilineVars.staves[multilineVars.currentVoice.staffNum].meter) {
			// Make sure that each voice gets the meter marking.
			params.meter = multilineVars.staves[multilineVars.currentVoice.staffNum].meter;
			multilineVars.staves[multilineVars.currentVoice.staffNum].meter = null;
		}
		if (multilineVars.currentVoice && multilineVars.currentVoice.name)
			params.name = multilineVars.currentVoice.name;
		if (multilineVars.vocalfont)
			params.vocalfont = multilineVars.vocalfont;
		if (multilineVars.tripletfont)
			params.tripletfont = multilineVars.tripletfont;
		if (multilineVars.style)
			params.style = multilineVars.style;
		if (multilineVars.currentVoice) {
			var staff = multilineVars.staves[multilineVars.currentVoice.staffNum];
			if (staff.brace) params.brace = staff.brace;
			if (staff.bracket) params.bracket = staff.bracket;
			if (staff.connectBarLines) params.connectBarLines = staff.connectBarLines;
			if (staff.name) params.name = staff.name[multilineVars.currentVoice.index];
			if (staff.subname) params.subname = staff.subname[multilineVars.currentVoice.index];
			if (multilineVars.currentVoice.stem)
				params.stem = multilineVars.currentVoice.stem;
			if (multilineVars.currentVoice.stafflines)
				params.stafflines = multilineVars.currentVoice.stafflines;
			if (multilineVars.currentVoice.staffscale)
				params.staffscale = multilineVars.currentVoice.staffscale;
			if (multilineVars.currentVoice.scale)
				params.scale = multilineVars.currentVoice.scale;
			if (multilineVars.currentVoice.style)
				params.style = multilineVars.currentVoice.style;
			if (multilineVars.currentVoice.transpose)
				params.clef.transpose = multilineVars.currentVoice.transpose;
		}
		var isFirstVoice = multilineVars.currentVoice === undefined || (multilineVars.currentVoice.staffNum ===  0 && multilineVars.currentVoice.index ===  0);
		if (multilineVars.barNumbers === 0 && isFirstVoice && multilineVars.currBarNumber !== 1)
			params.barNumber = multilineVars.currBarNumber;
		tune.startNewLine(params);
		if (multilineVars.key.impliedNaturals)
			delete multilineVars.key.impliedNaturals;

		multilineVars.partForNextLine = "";
	}

	var letter_to_grace =  function(line, i) {
		// Grace notes are an array of: startslur, note, endslur, space; where note is accidental, pitch, duration
		if (line.charAt(i) === '{') {
			// fetch the gracenotes string and consume that into the array
			var gra = tokenizer.getBrackettedSubstring(line, i, 1, '}');
			if (!gra[2])
				warn("Missing the closing '}' while parsing grace note", line, i);
			// If there is a slur after the grace construction, then move it to the last note inside the grace construction
			if (line[i+gra[0]] === ')') {
				gra[0]++;
				gra[1] += ')';
			}

			var gracenotes = [];
			var ii = 0;
			var inTie = false;
			while (ii < gra[1].length) {
				var acciaccatura = false;
				if (gra[1].charAt(ii) === '/') {
					acciaccatura = true;
					ii++;
				}
				var note = getCoreNote(gra[1], ii, {}, false);
				if (note !== null) {
					// The grace note durations should not be affected by the default length: they should be based on 1/16, so if that isn't the default, then multiply here.
					note.duration = note.duration / (multilineVars.default_length * 8);
					if (acciaccatura)
						note.acciaccatura = true;
					gracenotes.push(note);

					if (inTie) {
						note.endTie = true;
						inTie = false;
					}
					if (note.startTie)
						inTie = true;

					ii  = note.endChar;
					delete note.endChar;
				}
				else {
					// We shouldn't get anything but notes or a space here, so report an error
					if (gra[1].charAt(ii) === ' ') {
						if (gracenotes.length > 0)
							gracenotes[gracenotes.length-1].end_beam = true;
					} else
						warn("Unknown character '" + gra[1].charAt(ii) + "' while parsing grace note", line, i);
					ii++;
				}
			}
			if (gracenotes.length)
				return [gra[0], gracenotes];
		}
		return [ 0 ];
	};

	function letter_to_overlay(line, i) {
		if (line.charAt(i) === '&') {
			var start = i;
			while (line.charAt(i) && line.charAt(i) !== ':' && line.charAt(i) !== '|')
				i++;
			return [ i-start, line.substring(start+1, i) ];
		}
		return [ 0 ];
	}

	function durationOfMeasure(multilineVars) {
		// TODO-PER: This could be more complicated if one of the unusual measures is used.
		var meter = multilineVars.origMeter;
		if (!meter || meter.type !== 'specified')
			return 1;
		if (!meter.value || meter.value.length === 0)
			return 1;
		return parseInt(meter.value[0].num, 10) / parseInt(meter.value[0].den, 10);
	}

	//
	// Parse line of music
	//
	// This is a stream of <(bar-marking|header|note-group)...> in any order, with optional spaces between each element
	// core-note is <open-slur, accidental, pitch:required, octave, duration, close-slur&|tie> with no spaces within that
	// chord is <open-bracket:required, core-note:required... close-bracket:required duration> with no spaces within that
	// grace-notes is <open-brace:required, (open-slur|core-note:required|close-slur)..., close-brace:required> spaces are allowed
	// note-group is <grace-notes, chord symbols&|decorations..., grace-notes, slur&|triplet, chord|core-note, end-slur|tie> spaces are allowed between items
	// bar-marking is <ampersand> or <chord symbols&|decorations..., bar:required> spaces allowed
	// header is <open-bracket:required, K|M|L|V:required, colon:required, field:required, close-bracket:required> spaces can occur between the colon, in the field, and before the close bracket
	// header can also be the only thing on a line. This is true even if it is a continuation line. In this case the brackets are not required.
	// a space is a back-tick, a space, or a tab. If it is a back-tick, then there is no end-beam.

	// Line preprocessing: anything after a % is ignored (the double %% should have been taken care of before this)
	// Then, all leading and trailing spaces are ignored.
	// If there was a line continuation, the \n was replaced by a \r and the \ was replaced by a space. This allows the construct
	// of having a header mid-line conceptually, but actually be at the start of the line. This is equivolent to putting the header in [ ].

	// TODO-PER: How to handle ! for line break?
	// TODO-PER: dots before bar, dots before slur
	// TODO-PER: U: redefinable symbols.

	// Ambiguous symbols:
	// "[" can be the start of a chord, the start of a header element or part of a bar line.
	// --- if it is immediately followed by "|", it is a bar line
	// --- if it is immediately followed by K: L: M: V: it is a header (note: there are other headers mentioned in the standard, but I'm not sure how they would be used.)
	// --- otherwise it is the beginning of a chord
	// "(" can be the start of a slur or a triplet
	// --- if it is followed by a number from 2-9, then it is a triplet
	// --- otherwise it is a slur
	// "]"
	// --- if there is a chord open, then this is the close
	// --- if it is after a [|, then it is an invisible bar line
	// --- otherwise, it is par of a bar
	// "." can be a bar modifier or a slur modifier, or a decoration
	// --- if it comes immediately before a bar, it is a bar modifier
	// --- if it comes immediately before a slur, it is a slur modifier
	// --- otherwise it is a decoration for the next note.
	// number:
	// --- if it is after a bar, with no space, it is an ending marker
	// --- if it is after a ( with no space, it is a triplet count
	// --- if it is after a pitch or octave or slash, then it is a duration

	// Unambiguous symbols (except inside quoted strings):
	// vertical-bar, colon: part of a bar
	// ABCDEFGabcdefg: pitch
	// xyzZ: rest
	// comma, prime: octave
	// close-paren: end-slur
	// hyphen: tie
	// tilde, v, u, bang, plus, THLMPSO: decoration
	// carat, underscore, equal: accidental
	// ampersand: time reset
	// open-curly, close-curly: grace notes
	// double-quote: chord symbol
	// less-than, greater-than, slash: duration
	// back-tick, space, tab: space
	var nonDecorations = "ABCDEFGabcdefgxyzZ[]|^_{";	// use this to prescreen so we don't have to look for a decoration at every note.

	var parseRegularMusicLine = function(line) {
		header.resolveTempo();
		//multilineVars.havent_set_length = false;	// To late to set this now.
		multilineVars.is_in_header = false;	// We should have gotten a key header by now, but just in case, this is definitely out of the header.
		var i = 0;
		var startOfLine = multilineVars.iChar;
		// see if there is nothing but a comment on this line. If so, just ignore it. A full line comment is optional white space followed by %
		while (tokenizer.isWhiteSpace(line.charAt(i)) && i < line.length)
			i++;
		if (i === line.length || line.charAt(i) === '%')
			return;

		// Start with the standard staff, clef and key symbols on each line
		var delayStartNewLine = multilineVars.start_new_line;
		if (multilineVars.continueall === undefined)
			multilineVars.start_new_line = true;
		else
			multilineVars.start_new_line = false;
		var tripletNotesLeft = 0;

		// See if the line starts with a header field
		var retHeader = header.letter_to_body_header(line, i);
		if (retHeader[0] > 0) {
			i += retHeader[0];
			if (retHeader[1] === 'V')
				delayStartNewLine = true; // fixes bug on this: c[V:2]d
			// TODO-PER: Handle inline headers
		}
		var el = { };

		while (i < line.length)
		{
			var startI = i;
			if (line.charAt(i) === '%')
				break;

			var retInlineHeader = header.letter_to_inline_header(line, i);
			if (retInlineHeader[0] > 0) {
					i += retInlineHeader[0];
					if (retInlineHeader[1] === 'V')
						delayStartNewLine = true; // fixes bug on this: c[V:2]d
					// TODO-PER: Handle inline headers
					//multilineVars.start_new_line = false;
			} else {
				// Wait until here to actually start the line because we know we're past the inline statements.
				if (delayStartNewLine) {
					startNewLine();
					delayStartNewLine = false;
				}

				// We need to decide if the following characters are a bar-marking or a note-group.
				// Unfortunately, that is ambiguous. Both can contain chord symbols and decorations.
				// If there is a grace note either before or after the chord symbols and decorations, then it is definitely a note-group.
				// If there is a bar marker, it is definitely a bar-marking.
				// If there is either a core-note or chord, it is definitely a note-group.
				// So, loop while we find grace-notes, chords-symbols, or decorations. [It is an error to have more than one grace-note group in a row; the others can be multiple]
				// Then, if there is a grace-note, we know where to go.
				// Else see if we have a chord, core-note, slur, triplet, or bar.

				var ret;
				while (1) {
					ret = tokenizer.eatWhiteSpace(line, i);
					if (ret > 0) {
						i += ret;
					}
					if (i > 0 && line.charAt(i-1) === '\x12') {
						// there is one case where a line continuation isn't the same as being on the same line, and that is if the next character after it is a header.
						ret = header.letter_to_body_header(line, i);
						if (ret[0] > 0) {
							if (ret[1] === 'V')
								startNewLine(); // fixes bug on this: c\\nV:2]\\nd
							// TODO: insert header here
							i = ret[0];
							multilineVars.start_new_line = false;
						}
					}
					// gather all the grace notes, chord symbols and decorations
					ret = letter_to_spacer(line, i);
					if (ret[0] > 0) {
						i += ret[0];
					}

					ret = letter_to_overlay(line, i);
					if (ret[0] > 0) {
						tune.appendElement('overlay', startOfLine, startOfLine+1, {});
						i += 1;
					}

					ret = letter_to_chord(line, i);
					if (ret[0] > 0) {
						// There could be more than one chord here if they have different positions.
						// If two chords have the same position, then connect them with newline.
						if (!el.chord)
							el.chord = [];
						var chordName = tokenizer.translateString(ret[1]);
						chordName = chordName.replace(/;/g, "\n");
						var addedChord = false;
						for (var ci = 0; ci < el.chord.length; ci++) {
							if (el.chord[ci].position === ret[2]) {
								addedChord = true;
								el.chord[ci].name += "\n" + chordName;
							}
						}
						if (addedChord === false) {
							if (ret[2] === null && ret[3])
								el.chord.push({name: chordName, rel_position: ret[3]});
							else
								el.chord.push({name: chordName, position: ret[2]});
						}

						i += ret[0];
						var ii = tokenizer.skipWhiteSpace(line.substring(i));
						if (ii > 0)
							el.force_end_beam_last = true;
						i += ii;
					} else {
						if (nonDecorations.indexOf(line.charAt(i)) === -1)
							ret = letter_to_accent(line, i);
						else ret = [ 0 ];
						if (ret[0] > 0) {
							if (ret[1] === null) {
								if (i + 1 < line.length)
									startNewLine();	// There was a ! in the middle of the line. Start a new line if there is anything after it.
							} else if (ret[1].length > 0) {
								if (ret[1].indexOf("style=") === 0) {
									el.style = ret[1].substr(6);
								} else {
									if (el.decoration === undefined)
										el.decoration = [];
									el.decoration.push(ret[1]);
								}
							}
							i += ret[0];
						} else {
							ret = letter_to_grace(line, i);
							// TODO-PER: Be sure there aren't already grace notes defined. That is an error.
							if (ret[0] > 0) {
								el.gracenotes = ret[1];
								i += ret[0];
							} else
								break;
						}
					}
				}

				ret = letter_to_bar(line, i);
				if (ret[0] > 0) {
					// This is definitely a bar
					if (el.gracenotes !== undefined) {
						// Attach the grace note to an invisible note
						el.rest = { type: 'spacer' };
						el.duration = 0.125; // TODO-PER: I don't think the duration of this matters much, but figure out if it does.
						multilineVars.addFormattingOptions(el, tune.formatting, 'note');
						tune.appendElement('note', startOfLine+i, startOfLine+i+ret[0], el);
						multilineVars.measureNotEmpty = true;
						el = {};
					}
					var bar = {type: ret[1]};
					if (bar.type.length === 0)
						warn("Unknown bar type", line, i);
					else {
						if (multilineVars.inEnding && bar.type !== 'bar_thin') {
							bar.endEnding = true;
							multilineVars.inEnding = false;
						}
						if (ret[2]) {
							bar.startEnding = ret[2];
							if (multilineVars.inEnding)
								bar.endEnding = true;
							multilineVars.inEnding = true;
						}
						if (el.decoration !== undefined)
							bar.decoration = el.decoration;
						if (el.chord !== undefined)
							bar.chord = el.chord;
						if (bar.startEnding && multilineVars.barFirstEndingNum === undefined)
							multilineVars.barFirstEndingNum = multilineVars.currBarNumber;
						else if (bar.startEnding && bar.endEnding && multilineVars.barFirstEndingNum)
							multilineVars.currBarNumber = multilineVars.barFirstEndingNum;
						else if (bar.endEnding)
							multilineVars.barFirstEndingNum = undefined;
						if (bar.type !== 'bar_invisible' && multilineVars.measureNotEmpty) {
							var isFirstVoice = multilineVars.currentVoice === undefined || (multilineVars.currentVoice.staffNum ===  0 && multilineVars.currentVoice.index ===  0);
							if (isFirstVoice) {
								multilineVars.currBarNumber++;
								if (multilineVars.barNumbers && multilineVars.currBarNumber % multilineVars.barNumbers === 0)
									bar.barNumber = multilineVars.currBarNumber;
							}
						}
						multilineVars.addFormattingOptions(el, tune.formatting, 'bar');
						tune.appendElement('bar', startOfLine+i, startOfLine+i+ret[0], bar);
						multilineVars.measureNotEmpty = false;
						el = {};
					}
					i += ret[0];
					var cv = multilineVars.currentVoice ? multilineVars.currentVoice.staffNum + '-' + multilineVars.currentVoice.index : 'ONLY';
					if (multilineVars.lineBreaks) {
						if (!multilineVars.barCounter[cv])
							multilineVars.barCounter[cv] = 0;
						var breakNow = multilineVars.lineBreaks[''+multilineVars.barCounter[cv]];
						multilineVars.barCounter[cv]++;
						if (breakNow)
							startNewLine();
					}
				} else if (line[i] === '&') {	// backtrack to beginning of measure
					warn("Overlay not yet supported", line, i);
					i++;

				} else {
					// This is definitely a note group
					//
					// Look for as many open slurs and triplets as there are. (Note: only the first triplet is valid.)
					ret = letter_to_open_slurs_and_triplets(line, i);
					if (ret.consumed > 0) {
						if (ret.startSlur !== undefined)
							el.startSlur = ret.startSlur;
						if (ret.triplet !== undefined) {
							if (tripletNotesLeft > 0)
								warn("Can't nest triplets", line, i);
							else {
								el.startTriplet = ret.triplet;
								el.tripletMultiplier = ret.tripletQ / ret.triplet;
								tripletNotesLeft = ret.num_notes === undefined ? ret.triplet : ret.num_notes;
							}
						}
						i += ret.consumed;
					}

					// handle chords.
					if (line.charAt(i) === '[') {
						var chordStartChar = i;
						i++;
						var chordDuration = null;
						var rememberEndBeam = false;

						var done = false;
						while (!done) {
							var accent = letter_to_accent(line, i);
							if (accent[0] > 0) {
								i += accent[0];
							}

							var chordNote = getCoreNote(line, i, {}, false);
							if (chordNote !== null) {
								if (accent[0] > 0) { // If we found a decoration above, it modifies the entire chord. "style" is handled below.
									if (accent[1].indexOf("style=") !== 0) {
										if (el.decoration === undefined)
											el.decoration = [];
										el.decoration.push(accent[1]);
									}
								}
								if (chordNote.end_beam) {
									el.end_beam = true;
									delete chordNote.end_beam;
								}
								if (el.pitches === undefined) {
									el.duration = chordNote.duration;
									el.pitches = [ chordNote ];
								} else	// Just ignore the note lengths of all but the first note. The standard isn't clear here, but this seems less confusing.
									el.pitches.push(chordNote);
								delete chordNote.duration;
								if (accent[0] > 0) { // If we found a style above, it modifies the individual pitch, not the entire chord.
									if (accent[1].indexOf("style=") === 0) {
										el.pitches[el.pitches.length-1].style = accent[1].substr(6);
									}
								}

								if (multilineVars.inTieChord[el.pitches.length]) {
									chordNote.endTie = true;
									multilineVars.inTieChord[el.pitches.length] = undefined;
								}
								if (chordNote.startTie)
									multilineVars.inTieChord[el.pitches.length] = true;

								i  = chordNote.endChar;
								delete chordNote.endChar;
							} else if (line.charAt(i) === ' ') {
								// Spaces are not allowed in chords, but we can recover from it by ignoring it.
								warn("Spaces are not allowed in chords", line, i);
								i++;
							} else {
								if (i < line.length && line.charAt(i) === ']') {
									// consume the close bracket
									i++;

									if (multilineVars.next_note_duration !== 0) {
										el.duration = el.duration * multilineVars.next_note_duration;
										multilineVars.next_note_duration = 0;
									}

									if (multilineVars.inTie) {
										parseCommon.each(el.pitches, function(pitch) { pitch.endTie = true; });
										multilineVars.inTie = false;
									}

									if (tripletNotesLeft > 0) {
										tripletNotesLeft--;
										if (tripletNotesLeft === 0) {
											el.endTriplet = true;
										}
									}

									var postChordDone = false;
									while (i < line.length && !postChordDone) {
										switch (line.charAt(i)) {
											case ' ':
											case '\t':
												addEndBeam(el);
												break;
											case ')':
												if (el.endSlur === undefined) el.endSlur = 1; else el.endSlur++;
												break;
											case '-':
												parseCommon.each(el.pitches, function(pitch) { pitch.startTie = {}; });
												multilineVars.inTie = true;
												break;
											case '>':
											case '<':
												var br2 = getBrokenRhythm(line, i);
												i += br2[0] - 1;	// index gets incremented below, so we'll let that happen
												multilineVars.next_note_duration = br2[2];
												if (chordDuration)
													chordDuration = chordDuration * br2[1];
												else
													chordDuration = br2[1];
												break;
											case '1':
											case '2':
											case '3':
											case '4':
											case '5':
											case '6':
											case '7':
											case '8':
											case '9':
											case '/':
												var fraction = tokenizer.getFraction(line, i);
												chordDuration = fraction.value;
												i = fraction.index;
												if (line.charAt(i) === ' ')
													rememberEndBeam = true;
												if (line.charAt(i) === '-' || line.charAt(i) === ')' || line.charAt(i) === ' ' || line.charAt(i) === '<' || line.charAt(i) === '>')
													i--; // Subtracting one because one is automatically added below
												else
													postChordDone = true;
												break;
											default:
												postChordDone = true;
												break;
										}
										if (!postChordDone) {
											i++;
										}
									}
								} else
									warn("Expected ']' to end the chords", line, i);

								if (el.pitches !== undefined) {
									if (chordDuration !== null) {
										el.duration = el.duration * chordDuration;
										if (rememberEndBeam)
											addEndBeam(el);
									}

									multilineVars.addFormattingOptions(el, tune.formatting, 'note');
									tune.appendElement('note', startOfLine+chordStartChar, startOfLine+i, el);
									multilineVars.measureNotEmpty = true;
									el = {};
								}
								done = true;
							}
						}

					} else {
						// Single pitch
						var el2 = {};
						var core = getCoreNote(line, i, el2, true);
						if (el2.endTie !== undefined) multilineVars.inTie = true;
						if (core !== null) {
							if (core.pitch !== undefined) {
								el.pitches = [ { } ];
								// TODO-PER: straighten this out so there is not so much copying: getCoreNote shouldn't change e'
								if (core.accidental !== undefined) el.pitches[0].accidental = core.accidental;
								el.pitches[0].pitch = core.pitch;
								if (core.midipitch)
									el.pitches[0].midipitch = core.midipitch;
								if (core.endSlur !== undefined) el.pitches[0].endSlur = core.endSlur;
								if (core.endTie !== undefined) el.pitches[0].endTie = core.endTie;
								if (core.startSlur !== undefined) el.pitches[0].startSlur = core.startSlur;
								if (el.startSlur !== undefined) el.pitches[0].startSlur = el.startSlur;
								if (core.startTie !== undefined) el.pitches[0].startTie = core.startTie;
								if (el.startTie !== undefined) el.pitches[0].startTie = el.startTie;
							} else {
								el.rest = core.rest;
								if (core.endSlur !== undefined) el.endSlur = core.endSlur;
								if (core.endTie !== undefined) el.rest.endTie = core.endTie;
								if (core.startSlur !== undefined) el.startSlur = core.startSlur;
								if (core.startTie !== undefined) el.rest.startTie = core.startTie;
								if (el.startTie !== undefined) el.rest.startTie = el.startTie;
							}

							if (core.chord !== undefined) el.chord = core.chord;
							if (core.duration !== undefined) el.duration = core.duration;
							if (core.decoration !== undefined) el.decoration = core.decoration;
							if (core.graceNotes !== undefined) el.graceNotes = core.graceNotes;
							delete el.startSlur;
							if (multilineVars.inTie) {
								if (el.pitches !== undefined) {
									el.pitches[0].endTie = true;
									multilineVars.inTie = false;
								} else if (el.rest.type !== 'spacer') {
									el.rest.endTie = true;
									multilineVars.inTie = false;
								}
							}
							if (core.startTie || el.startTie)
								multilineVars.inTie = true;
							i  = core.endChar;

							if (tripletNotesLeft > 0) {
								tripletNotesLeft--;
								if (tripletNotesLeft === 0) {
									el.endTriplet = true;
								}
							}

							if (core.end_beam)
								addEndBeam(el);

							// If there is a whole rest, then it should be the duration of the measure, not it's own duration. We need to special case it.
							if (el.rest && el.rest.type === 'rest' && el.duration === 1) {
								el.rest.type = 'whole';

								el.duration = durationOfMeasure(multilineVars);
							}

							multilineVars.addFormattingOptions(el, tune.formatting, 'note');
							tune.appendElement('note', startOfLine+startI, startOfLine+i, el);
							multilineVars.measureNotEmpty = true;
							el = {};
						}
					}

					if (i === startI) {	// don't know what this is, so ignore it.
						if (line.charAt(i) !== ' ' && line.charAt(i) !== '`')
							warn("Unknown character ignored", line, i);
						i++;
					}
				}
			}
		}
	};

	var parseLine = function(line) {
		var ret = header.parseHeader(line);
		if (ret.regular)
			parseRegularMusicLine(ret.str);
		if (ret.newline && multilineVars.continueall === undefined)
			startNewLine();
		if (ret.words)
			addWords(tune.getCurrentVoice(), line.substring(2));
		if (ret.symbols)
			addSymbols(tune.getCurrentVoice(), line.substring(2));
		if (ret.recurse)
			parseLine(ret.str);
	};

	function appendLastMeasure(voice, nextVoice) {
		voice.push({
			el_type: 'hint'
		});
		for (var i = 0; i < nextVoice.length; i++) {
			var element = nextVoice[i];
			var hint = parseCommon.clone(element);
			voice.push(hint);
			if (element.el_type === 'bar')
					return;
		}
	}

	function addHintMeasure(staff, nextStaff) {
		for (var i = 0; i < staff.length; i++) {
			var stave = staff[i];
			var nextStave = nextStaff[i];
			if (nextStave) { // Be sure there is the same number of staves on the next line.
				for (var j = 0; j < nextStave.voices.length; j++) {
					var nextVoice = nextStave.voices[j];
					var voice = stave.voices[j];
					if (voice) { // Be sure there are the same number of voices on the previous line.
						appendLastMeasure(voice, nextVoice);
					}
				}
			}
		}
	}

	function addHintMeasures() {
		for (var i = 0; i < tune.lines.length; i++) {
			var line = tune.lines[i].staff;
			if (line) {
				var j = i+1;
				while (j < tune.lines.length && tune.lines[j].staff === undefined)
					j++;
				if (j < tune.lines.length) {
					var nextLine = tune.lines[j].staff;
					addHintMeasure(line, nextLine);
				}
			}
		}
	}

	this.parse = function(strTune, switches) {
		// the switches are optional and cause a difference in the way the tune is parsed.
		// switches.header_only : stop parsing when the header is finished
		// switches.stop_on_warning : stop at the first warning encountered.
		// switches.print: format for the page instead of the browser.
		// switches.format: a hash of the desired formatting commands.
		// switches.hint_measures: put the next measure at the end of the current line.
		// switches.transpose: change the key signature, chords, and notes by a number of half-steps.
		if (!switches) switches = {};
		tune.reset();
		if (switches.print)
			tune.media = 'print';
		multilineVars.reset();
		if (switches.visualTranspose) {
			multilineVars.globalTranspose = parseInt(switches.visualTranspose);
			if (multilineVars.globalTranspose === 0)
				multilineVars.globalTranspose = undefined;
		} else
			multilineVars.globalTranspose = undefined;
		if (switches.lineBreaks) {
			// change the format of the the line breaks for easy testing.
			multilineVars.lineBreaks = {};
			multilineVars.continueall = true;
			for (var i = 0; i < switches.lineBreaks.length; i++)
				multilineVars.lineBreaks[''+switches.lineBreaks[i]] = true;
		}
		header.reset(tokenizer, warn, multilineVars, tune);

		// Take care of whatever line endings come our way
		strTune = parseCommon.gsub(strTune, '\r\n', '\n');
		strTune = parseCommon.gsub(strTune, '\r', '\n');
		strTune += '\n';	// Tacked on temporarily to make the last line continuation work
		strTune = strTune.replace(/\n\\.*\n/g, "\n");	// get rid of latex commands.
		var continuationReplacement = function(all, backslash, comment){
			var spaces = "                                                                                                                                                                                                     ";
			var padding = comment ? spaces.substring(0, comment.length) : "";
			return backslash + " \x12" + padding;
		};
		strTune = strTune.replace(/\\([ \t]*)(%.*)*\n/g, continuationReplacement);	// take care of line continuations right away, but keep the same number of characters
		var lines = strTune.split('\n');
		if (parseCommon.last(lines).length === 0)	// remove the blank line we added above.
			lines.pop();
		try {
			if (switches.format) {
				parseDirective.globalFormatting(switches.format);
			}
			parseCommon.each(lines,  function(line) {
				if (switches.header_only && multilineVars.is_in_header === false)
					throw "normal_abort";
				if (switches.stop_on_warning && multilineVars.warnings)
					throw "normal_abort";
				if (multilineVars.is_in_history) {
					if (line.charAt(1) === ':') {
						multilineVars.is_in_history = false;
						parseLine(line);
					} else
						tune.addMetaText("history", tokenizer.translateString(tokenizer.stripComment(line)));
				} else if (multilineVars.inTextBlock) {
					if (parseCommon.startsWith(line, "%%endtext")) {
						//tune.addMetaText("textBlock", multilineVars.textBlock);
						tune.addText(multilineVars.textBlock);
						multilineVars.inTextBlock = false;
					}
					else {
						if (parseCommon.startsWith(line, "%%"))
							multilineVars.textBlock += ' ' + line.substring(2);
						else
							multilineVars.textBlock += ' ' + line;
					}
				} else if (multilineVars.inPsBlock) {
					if (parseCommon.startsWith(line, "%%endps")) {
						// Just ignore postscript
						multilineVars.inPsBlock = false;
					}
					else
						multilineVars.textBlock += ' ' + line;
				} else
					parseLine(line);
				multilineVars.iChar += line.length + 1;
			});
			var ph = 11*72;
			var pl = 8.5*72;
			switch (multilineVars.papersize) {
				//case "letter": ph = 11*72; pl = 8.5*72; break;
				case "legal": ph = 14*72; pl = 8.5*72; break;
				case "A4": ph = 11.7*72; pl = 8.3*72; break;
			}
			if (multilineVars.landscape) {
				var x = ph;
				ph = pl;
				pl = x;
			}
			multilineVars.openSlurs = tune.cleanUp(pl, ph, multilineVars.barsperstaff, multilineVars.staffnonote, multilineVars.openSlurs);
		} catch (err) {
			if (err !== "normal_abort")
				throw err;
		}
		if (switches.hint_measures) {
			addHintMeasures();
		}
	};
};

module.exports = Parse;

},{"../data/abc_tune":7,"./abc_common":9,"./abc_parse_directive":11,"./abc_parse_header":12,"./abc_parse_key_voice":13,"./abc_tokenizer":14,"./abc_transpose":15}],11:[function(require,module,exports){
/*global window */

var parseCommon = require('./abc_common');

var parseDirective = {};

(function() {
	"use strict";
	var tokenizer;
	var warn;
	var multilineVars;
	var tune;
	parseDirective.initialize = function(tokenizer_, warn_, multilineVars_, tune_) {
		tokenizer = tokenizer_;
		warn = warn_;
		multilineVars = multilineVars_;
		tune = tune_;
		initializeFonts();
	};

	function initializeFonts() {
		multilineVars.annotationfont  = { face: "Helvetica", size: 12, weight: "normal", style: "normal", decoration: "none" };
		multilineVars.gchordfont  = { face: "Helvetica", size: 12, weight: "normal", style: "normal", decoration: "none" };
		multilineVars.historyfont  = { face: "\"Times New Roman\"", size: 16, weight: "normal", style: "normal", decoration: "none" };
		multilineVars.infofont  = { face: "\"Times New Roman\"", size: 14, weight: "normal", style: "italic", decoration: "none" };
		multilineVars.measurefont  = { face: "\"Times New Roman\"", size: 14, weight: "normal", style: "italic", decoration: "none" };
		multilineVars.partsfont  = { face: "\"Times New Roman\"", size: 15, weight: "normal", style: "normal", decoration: "none" };
		multilineVars.repeatfont  = { face: "\"Times New Roman\"", size: 13, weight: "normal", style: "normal", decoration: "none" };
		multilineVars.textfont  = { face: "\"Times New Roman\"", size: 16, weight: "normal", style: "normal", decoration: "none" };
		multilineVars.tripletfont = {face: "Times", size: 11, weight: "normal", style: "italic", decoration: "none"};
		multilineVars.vocalfont  = { face: "\"Times New Roman\"", size: 13, weight: "bold", style: "normal", decoration: "none" };
		multilineVars.wordsfont  = { face: "\"Times New Roman\"", size: 16, weight: "normal", style: "normal", decoration: "none" };

		// These fonts are global for the entire tune.
		tune.formatting.composerfont  = { face: "\"Times New Roman\"", size: 14, weight: "normal", style: "italic", decoration: "none" };
		tune.formatting.subtitlefont  = { face: "\"Times New Roman\"", size: 16, weight: "normal", style: "normal", decoration: "none" };
		tune.formatting.tempofont  = { face: "\"Times New Roman\"", size: 15, weight: "bold", style: "normal", decoration: "none" };
		tune.formatting.titlefont  = { face: "\"Times New Roman\"", size: 20, weight: "normal", style: "normal", decoration: "none" };
		tune.formatting.footerfont  = { face: "\"Times New Roman\"", size: 12, weight: "normal", style: "normal", decoration: "none" };
		tune.formatting.headerfont  = { face: "\"Times New Roman\"", size: 12, weight: "normal", style: "normal", decoration: "none" };
		tune.formatting.voicefont  = { face: "\"Times New Roman\"", size: 13, weight: "bold", style: "normal", decoration: "none" };

		// these are the default fonts for these element types. In the printer, these fonts might change as the tune progresses.
		tune.formatting.annotationfont  = multilineVars.annotationfont;
		tune.formatting.gchordfont  = multilineVars.gchordfont;
		tune.formatting.historyfont  = multilineVars.historyfont;
		tune.formatting.infofont  = multilineVars.infofont;
		tune.formatting.measurefont  = multilineVars.measurefont;
		tune.formatting.partsfont  = multilineVars.partsfont;
		tune.formatting.repeatfont  = multilineVars.repeatfont;
		tune.formatting.textfont  = multilineVars.textfont;
		tune.formatting.tripletfont  = multilineVars.tripletfont;
		tune.formatting.vocalfont  = multilineVars.vocalfont;
		tune.formatting.wordsfont  = multilineVars.wordsfont;
	}

	var fontTypeCanHaveBox = { gchordfont: true, measurefont: true, partsfont: true };

	var fontTranslation = function(fontFace) {
		// This translates Postscript fonts for a web alternative.
		// Note that the postscript fonts contain italic and bold info in them, so what is returned is a hash.

		switch (fontFace) {
			case "Arial-Italic":
				return { face: "Arial", weight: "normal", style: "italic", decoration: "none" };
			case "Arial-Bold":
				return { face: "Arial", weight: "bold", style: "normal", decoration: "none" };
			case "Bookman-Demi":
				return { face: "Bookman,serif", weight: "bold", style: "normal", decoration: "none" };
			case "Bookman-DemiItalic":
				return { face: "Bookman,serif", weight: "bold", style: "italic", decoration: "none" };
			case "Bookman-Light":
				return { face: "Bookman,serif", weight: "normal", style: "normal", decoration: "none" };
			case "Bookman-LightItalic":
				return { face: "Bookman,serif", weight: "normal", style: "italic", decoration: "none" };
			case "Courier":
				return { face: "\"Courier New\"", weight: "normal", style: "normal", decoration: "none" };
			case "Courier-Oblique":
				return { face: "\"Courier New\"", weight: "normal", style: "italic", decoration: "none" };
			case "Courier-Bold":
				return { face: "\"Courier New\"", weight: "bold", style: "normal", decoration: "none" };
			case "Courier-BoldOblique":
				return { face: "\"Courier New\"", weight: "bold", style: "italic", decoration: "none" };
			case "AvantGarde-Book":
				return { face: "AvantGarde,Arial", weight: "normal", style: "normal", decoration: "none" };
			case "AvantGarde-BookOblique":
				return { face: "AvantGarde,Arial", weight: "normal", style: "italic", decoration: "none" };
			case "AvantGarde-Demi":
			case "Avant-Garde-Demi":
				return { face: "AvantGarde,Arial", weight: "bold", style: "normal", decoration: "none" };
			case "AvantGarde-DemiOblique":
				return { face: "AvantGarde,Arial", weight: "bold", style: "italic", decoration: "none" };
			case "Helvetica-Oblique":
				return { face: "Helvetica", weight: "normal", style: "italic", decoration: "none" };
			case "Helvetica-Bold":
				return { face: "Helvetica", weight: "bold", style: "normal", decoration: "none" };
			case "Helvetica-BoldOblique":
				return { face: "Helvetica", weight: "bold", style: "italic", decoration: "none" };
			case "Helvetica-Narrow":
				return { face: "\"Helvetica Narrow\",Helvetica", weight: "normal", style: "normal", decoration: "none" };
			case "Helvetica-Narrow-Oblique":
				return { face: "\"Helvetica Narrow\",Helvetica", weight: "normal", style: "italic", decoration: "none" };
			case "Helvetica-Narrow-Bold":
				return { face: "\"Helvetica Narrow\",Helvetica", weight: "bold", style: "normal", decoration: "none" };
			case "Helvetica-Narrow-BoldOblique":
				return { face: "\"Helvetica Narrow\",Helvetica", weight: "bold", style: "italic", decoration: "none" };
			case "Palatino-Roman":
				return { face: "Palatino", weight: "normal", style: "normal", decoration: "none" };
			case "Palatino-Italic":
				return { face: "Palatino", weight: "normal", style: "italic", decoration: "none" };
			case "Palatino-Bold":
				return { face: "Palatino", weight: "bold", style: "normal", decoration: "none" };
			case "Palatino-BoldItalic":
				return { face: "Palatino", weight: "bold", style: "italic", decoration: "none" };
			case "NewCenturySchlbk-Roman":
				return { face: "\"New Century\",serif", weight: "normal", style: "normal", decoration: "none" };
			case "NewCenturySchlbk-Italic":
				return { face: "\"New Century\",serif", weight: "normal", style: "italic", decoration: "none" };
			case "NewCenturySchlbk-Bold":
				return { face: "\"New Century\",serif", weight: "bold", style: "normal", decoration: "none" };
			case "NewCenturySchlbk-BoldItalic":
				return { face: "\"New Century\",serif", weight: "bold", style: "italic", decoration: "none" };
			case "Times":
			case "Times-Roman":
			case "Times-Narrow":
			case "Times-Courier":
			case "Times-New-Roman":
				return { face: "\"Times New Roman\"", weight: "normal", style: "normal", decoration: "none" };
			case "Times-Italic":
			case "Times-Italics":
				return { face: "\"Times New Roman\"", weight: "normal", style: "italic", decoration: "none" };
			case "Times-Bold":
				return { face: "\"Times New Roman\"", weight: "bold", style: "normal", decoration: "none" };
			case "Times-BoldItalic":
				return { face: "\"Times New Roman\"", weight: "bold", style: "italic", decoration: "none" };
			case "ZapfChancery-MediumItalic":
				return { face: "\"Zapf Chancery\",cursive,serif", weight: "normal", style: "normal", decoration: "none" };
			default:
				return null;
		}
	};

	var getFontParameter = function(tokens, currentSetting, str, position, cmd) {
		// Every font parameter has the following format:
		// <face> <utf8> <size> <modifiers> <box>
		// Where:
		// face: either a standard web font name, or a postscript font, enumerated in fontTranslation. This could also be an * or be missing if the face shouldn't change.
		// utf8: This is optional, and specifies utf8. That's all that is supported so the field is just silently ignored.
		// size: The size, in pixels. This may be omitted if the size is not changing.
		// modifiers: zero or more of "bold", "italic", "underline"
		// box: Only applies to the measure numbers, gchords, and the parts. If present, then a box is drawn around the characters.
		// If face is present, then all the modifiers are cleared. If face is absent, then the modifiers are illegal.
		// The face can be a single word, a set of words separated by hyphens, or a quoted string.
		//
		// So, in practicality, there are three types of font definitions: a number only, an asterisk and a number only, or the full definition (with an optional size).
		function processNumberOnly() {
			var size = parseInt(tokens[0].token);
			tokens.shift();
			if (!currentSetting) {
				warn("Can't set just the size of the font since there is no default value.", str, position);
				return { face: "\"Times New Roman\"", weight: "normal", style: "normal", decoration: "none", size: size};
			}
			if (tokens.length === 0) {
				return { face: currentSetting.face, weight: currentSetting.weight, style: currentSetting.style, decoration: currentSetting.decoration, size: size};
			}
			if (tokens.length === 1 && tokens[0].token === "box" && fontTypeCanHaveBox[cmd])
				return { face: currentSetting.face, weight: currentSetting.weight, style: currentSetting.style, decoration: currentSetting.decoration, size: size, box: true};
			warn("Extra parameters in font definition.", str, position);
			return { face: currentSetting.face, weight: currentSetting.weight, style: currentSetting.style, decoration: currentSetting.decoration, size: size};
		}

		// format 1: asterisk and number only
		if (tokens[0].token === '*') {
			tokens.shift();
			if (tokens[0].type === 'number')
				return processNumberOnly();
			else {
				warn("Expected font size number after *.", str, position);
			}
		}

		// format 2: number only
		if (tokens[0].type === 'number') {
			return processNumberOnly();
		}

		// format 3: whole definition
		var face = [];
		var size;
		var weight = "normal";
		var style = "normal";
		var decoration = "none";
		var box = false;
		var state = 'face';
		var hyphenLast = false;
		while (tokens.length) {
			var currToken = tokens.shift();
			var word = currToken.token.toLowerCase();
			switch (state) {
				case 'face':
					if (hyphenLast || (word !== 'utf' && currToken.type !== 'number' && word !== "bold" && word !== "italic" && word !== "underline" && word !== "box")) {
						if (face.length > 0 && currToken.token === '-') {
							hyphenLast = true;
							face[face.length-1] = face[face.length-1] + currToken.token;
						}
						else {
							if (hyphenLast) {
								hyphenLast = false;
								face[face.length-1] = face[face.length-1] + currToken.token;
							} else
								face.push(currToken.token);
						}
					} else {
						if (currToken.type === 'number') {
							if (size) {
								warn("Font size specified twice in font definition.", str, position);
							} else {
								size = currToken.token;
							}
							state = 'modifier';
						} else if (word === "bold")
							weight = "bold";
						else if (word === "italic")
							style = "italic";
						else if (word === "underline")
							decoration = "underline";
						else if (word === "box") {
							if (fontTypeCanHaveBox[cmd])
								box = true;
							else
								warn("This font style doesn't support \"box\"", str, position);
							state = "finished";
						} else if (word === "utf") {
							currToken = tokens.shift(); // this gets rid of the "8" after "utf"
							state = "size";
						} else
							warn("Unknown parameter " + currToken.token + " in font definition.", str, position);
					}
					break;
				case "size":
					if (currToken.type === 'number') {
						if (size) {
							warn("Font size specified twice in font definition.", str, position);
						} else {
							size = currToken.token;
						}
					} else {
						warn("Expected font size in font definition.", str, position);
					}
					state = 'modifier';
					break;
				case "modifier":
					if (word === "bold")
						weight = "bold";
					else if (word === "italic")
						style = "italic";
					else if (word === "underline")
						decoration = "underline";
					else if (word === "box") {
						if (fontTypeCanHaveBox[cmd])
							box = true;
						else
							warn("This font style doesn't support \"box\"", str, position);
						state = "finished";
					} else
						warn("Unknown parameter " + currToken.token + " in font definition.", str, position);
					break;
				case "finished":
					warn("Extra characters found after \"box\" in font definition.", str, position);
					break;
			}
		}

		if (size === undefined) {
			if (!currentSetting) {
				warn("Must specify the size of the font since there is no default value.", str, position);
				size = 12;
			} else
				size = currentSetting.size;
		} else
			size = parseFloat(size);

		face = face.join(' ');
		var psFont = fontTranslation(face);
		var font = {};
		if (psFont) {
			font.face = psFont.face;
			font.weight = psFont.weight;
			font.style = psFont.style;
			font.decoration = psFont.decoration;
			font.size = size;
			if (box)
				font.box = true;
			return font;
		}
		font.face = face;
		font.weight = weight;
		font.style = style;
		font.decoration = decoration;
		font.size = size;
		if (box)
			font.box = true;
		return font;
	};

	var getChangingFont = function(cmd, tokens, str) {
		if (tokens.length === 0)
			return "Directive \"" + cmd + "\" requires a font as a parameter.";
		multilineVars[cmd] = getFontParameter(tokens, multilineVars[cmd], str, 0, cmd);
		if (multilineVars.is_in_header) // If the font appears in the header, then it becomes the default font.
			tune.formatting[cmd] = multilineVars[cmd];
		return null;
	};
	var getGlobalFont = function(cmd, tokens, str) {
		if (tokens.length === 0)
			return "Directive \"" + cmd + "\" requires a font as a parameter.";
		tune.formatting[cmd] = getFontParameter(tokens, tune.formatting[cmd], str, 0, cmd);
		return null;
	};

	var setScale = function(cmd, tokens) {
		var scratch = "";
		parseCommon.each(tokens, function(tok) {
			scratch += tok.token;
		});
		var num = parseFloat(scratch);
		if (isNaN(num) || num === 0)
			return "Directive \"" + cmd + "\" requires a number as a parameter.";
		tune.formatting.scale = num;

	};

	var getRequiredMeasurement = function(cmd, tokens) {
		var points = tokenizer.getMeasurement(tokens);
		if (points.used === 0 || tokens.length !== 0)
			return { error: "Directive \"" + cmd + "\" requires a measurement as a parameter."};
		return points.value;
	};
	var oneParameterMeasurement = function(cmd, tokens) {
		var points = tokenizer.getMeasurement(tokens);
		if (points.used === 0 || tokens.length !== 0)
			return "Directive \"" + cmd + "\" requires a measurement as a parameter.";
		tune.formatting[cmd] = points.value;
		return null;
	};

	var addMultilineVar = function(key, cmd, tokens, min, max) {
		if (tokens.length !== 1 || tokens[0].type !== 'number')
			return "Directive \"" + cmd + "\" requires a number as a parameter.";
		var i = tokens[0].intt;
		if (min !== undefined && i < min)
			return "Directive \"" + cmd + "\" requires a number greater than or equal to " + min + " as a parameter.";
		if (max !== undefined && i > max)
			return "Directive \"" + cmd + "\" requires a number less than or equal to " + max + " as a parameter.";
		multilineVars[key] = i;
		return null;
	};

	var addMultilineVarBool = function(key, cmd, tokens) {
		var str = addMultilineVar(key, cmd, tokens, 0, 1);
		if (str !== null) return str;
		multilineVars[key] = (multilineVars[key] === 1);
		return null;
	};

	var addMultilineVarOneParamChoice = function(key, cmd, tokens, choices) {
		if (tokens.length !== 1)
			return "Directive \"" + cmd + "\" requires one of [ " + choices.join(", ") + " ] as a parameter.";
		var choice = tokens[0].token;
		var found = false;
		for (var i = 0; !found && i < choices.length; i++) {
			if (choices[i] === choice)
				found = true;
		}
		if (!found)
			return "Directive \"" + cmd + "\" requires one of [ " + choices.join(", ") + " ] as a parameter.";
		multilineVars[key] = choice;
		return null;
	};

	var midiCmdParam0 = [
		"nobarlines",
		"barlines",
		"beataccents",
		"nobeataccents",
		"droneon",
		"droneoff",
		"drumon",
		"drumoff",
		"fermatafixed",
		"fermataproportional",
		"gchordon",
		"gchordoff",
		"controlcombo",
		"temperamentnormal",
		"noportamento"
	];
	var midiCmdParam1String = [
		"gchord",
		"ptstress",
		"beatstring"
	];
	var midiCmdParam1Integer = [
		"bassvol",
		"chordvol",
		"c",
		"channel",
		"beatmod",
		"deltaloudness",
		"drumbars",
		"gracedivider",
		"makechordchannels",
		"randomchordattack",
		"chordattack",
		"stressmodel",
		"transpose",
		"rtranspose",
		"volinc"
	];
	var midiCmdParam1Integer1OptionalInteger = [
		"program"
	];
	var midiCmdParam2Integer = [
		"ratio",
		"snt",
		"bendvelocity",
		"pitchbend",
		"control",
		"temperamentlinear"
	];
	var midiCmdParam4Integer = [
		"beat"
	];
	var midiCmdParam5Integer = [
		"drone"
	];
	var midiCmdParam1IntegerOptionalOctave = [
		"bassprog",
		"chordprog"
	];
	var midiCmdParam1String1Integer = [
		"portamento"
	];
	var midiCmdParamFraction = [
		"expand",
		"grace",
		"trim"
	];
	var midiCmdParam1StringVariableIntegers = [
		"drum",
		"chordname"
	];

	var parseMidiCommand = function(midi, tune, restOfString) {
		var midi_cmd = midi.shift().token;
		var midi_params = [];
		if (midiCmdParam0.indexOf(midi_cmd) >= 0) {
			// NO PARAMETERS
			if (midi.length !== 0)
				warn("Unexpected parameter in MIDI " + midi_cmd, restOfString, 0);
		} else if (midiCmdParam1String.indexOf(midi_cmd) >= 0) {
			// ONE STRING PARAMETER
			if (midi.length !== 1)
				warn("Expected one parameter in MIDI " + midi_cmd, restOfString, 0);
			else
				midi_params.push(midi[0].token);
		} else if (midiCmdParam1Integer.indexOf(midi_cmd) >= 0) {
			// ONE INT PARAMETER
			if (midi.length !== 1)
				warn("Expected one parameter in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number")
				warn("Expected one integer parameter in MIDI " + midi_cmd, restOfString, 0);
			else
				midi_params.push(midi[0].intt);
		} else if (midiCmdParam1Integer1OptionalInteger.indexOf(midi_cmd) >= 0) {
			// ONE INT PARAMETER, ONE OPTIONAL PARAMETER
			if (midi.length !== 1 && midi.length !== 2)
				warn("Expected one or two parameters in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number")
				warn("Expected integer parameter in MIDI " + midi_cmd, restOfString, 0);
			else if (midi.length === 2 && midi[1].type !== "number")
				warn("Expected integer parameter in MIDI " + midi_cmd, restOfString, 0);
			else {
				midi_params.push(midi[0].intt);
				if (midi.length === 2)
					midi_params.push(midi[1].intt);
			}
		} else if (midiCmdParam2Integer.indexOf(midi_cmd) >= 0) {
			// TWO INT PARAMETERS
			if (midi.length !== 2)
				warn("Expected two parameters in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number" || midi[1].type !== "number")
				warn("Expected two integer parameters in MIDI " + midi_cmd, restOfString, 0);
			else {
				midi_params.push(midi[0].intt);
				midi_params.push(midi[1].intt);
			}
		} else if (midiCmdParam1String1Integer.indexOf(midi_cmd) >= 0) {
			// ONE STRING PARAMETER, ONE INT PARAMETER
			if (midi.length !== 2)
				warn("Expected two parameters in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "alpha" || midi[1].type !== "number")
				warn("Expected one string and one integer parameters in MIDI " + midi_cmd, restOfString, 0);
			else {
				midi_params.push(midi[0].token);
				midi_params.push(midi[1].intt);
			}
		} else if (midi_cmd === 'drummap') {
			// BUILD AN OBJECT OF ABC NOTE => MIDI NOTE
			if (midi.length === 2 && midi[0].type === 'alpha' && midi[1].type === 'number') {
				if (!tune.formatting) tune.formatting = {};
				if (!tune.formatting.midi) tune.formatting.midi = {};
				if (!tune.formatting.midi.drummap) tune.formatting.midi.drummap = {};
				tune.formatting.midi.drummap[midi[0].token] = midi[1].intt;
				midi_params = tune.formatting.midi.drummap;
			} else if (midi.length === 3 && midi[0].type === 'punct' && midi[1].type === 'alpha' && midi[2].type === 'number') {
				if (!tune.formatting) tune.formatting = {};
				if (!tune.formatting.midi) tune.formatting.midi = {};
				if (!tune.formatting.midi.drummap) tune.formatting.midi.drummap = {};
				tune.formatting.midi.drummap[midi[0].token+midi[1].token] = midi[2].intt;
				midi_params = tune.formatting.midi.drummap;
			} else {
				warn("Expected one note name and one integer parameter in MIDI " + midi_cmd, restOfString, 0);
			}
		} else if (midiCmdParamFraction.indexOf(midi_cmd) >= 0) {
			// ONE FRACTION PARAMETER
			if (midi.length !== 3)
				warn("Expected fraction parameter in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number" || midi[1].token !== "/" || midi[2].type !== "number")
				warn("Expected fraction parameter in MIDI " + midi_cmd, restOfString, 0);
			else {
				midi_params.push(midi[0].intt);
				midi_params.push(midi[2].intt);
			}
		} else if (midiCmdParam4Integer.indexOf(midi_cmd) >= 0) {
			// FOUR INT PARAMETERS
			if (midi.length !== 4)
				warn("Expected four parameters in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number" || midi[1].type !== "number" || midi[2].type !== "number" || midi[3].type !== "number")
				warn("Expected four integer parameters in MIDI " + midi_cmd, restOfString, 0);
			else {
				midi_params.push(midi[0].intt);
				midi_params.push(midi[1].intt);
				midi_params.push(midi[2].intt);
				midi_params.push(midi[3].intt);
			}
		} else if (midiCmdParam5Integer.indexOf(midi_cmd) >= 0) {
			// FIVE INT PARAMETERS
			if (midi.length !== 5)
				warn("Expected five parameters in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number" || midi[1].type !== "number" || midi[2].type !== "number" || midi[3].type !== "number" || midi[4].type !== "number")
				warn("Expected five integer parameters in MIDI " + midi_cmd, restOfString, 0);
			else {
				midi_params.push(midi[0].intt);
				midi_params.push(midi[1].intt);
				midi_params.push(midi[2].intt);
				midi_params.push(midi[3].intt);
				midi_params.push(midi[4].intt);
			}
		} else if (midiCmdParam1Integer1OptionalInteger.indexOf(midi_cmd) >= 0) {
			// ONE INT PARAMETER, ONE OPTIONAL OCTAVE PARAMETER
			if (midi.length !== 1 || midi.length !== 4)
				warn("Expected one or two parameters in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "number")
				warn("Expected integer parameter in MIDI " + midi_cmd, restOfString, 0);
			else if (midi.length === 4) {
				if (midi[1].token !== "octave")
					warn("Expected octave parameter in MIDI " + midi_cmd, restOfString, 0);
				if (midi[2].token !== "=")
					warn("Expected octave parameter in MIDI " + midi_cmd, restOfString, 0);
				if (midi[3].type !== "number")
					warn("Expected integer parameter for octave in MIDI " + midi_cmd, restOfString, 0);
			} else {
				midi_params.push(midi[0].intt);
				if (midi.length === 4)
					midi_params.push(midi[3].intt);
			}
		} else if (midiCmdParam1StringVariableIntegers.indexOf(midi_cmd) >= 0) {
			// ONE STRING, VARIABLE INT PARAMETERS
			if (midi.length < 2)
				warn("Expected string parameter and at least one integer parameter in MIDI " + midi_cmd, restOfString, 0);
			else if (midi[0].type !== "alpha")
				warn("Expected string parameter and at least one integer parameter in MIDI " + midi_cmd, restOfString, 0);
			else {
				var p = midi.shift();
				midi_params.push(p.token);
				while (midi.length > 0) {
					p = midi.shift();
					if (p.type !== "number")
						warn("Expected integer parameter in MIDI " + midi_cmd, restOfString, 0);
					midi_params.push(p.intt);
				}
			}
		}

		if (tune.hasBeginMusic())
			tune.appendElement('midi', -1, -1, { cmd: midi_cmd, params: midi_params });
		else {
			if (tune.formatting['midi'] === undefined)
				tune.formatting['midi'] = {};
			tune.formatting['midi'][midi_cmd] = midi_params;
		}
	};

	parseDirective.parseFontChangeLine = function(textstr) {
		var textParts = textstr.split('$');
		if (textParts.length > 1 && multilineVars.setfont) {
			var textarr = [ { text: textParts[0] }];
			for (var i = 1; i < textParts.length; i++) {
				if (textParts[i].charAt(0) === '0')
					textarr.push({ text: textParts[i].substring(1) });
				else if (textParts[i].charAt(0) === '1' && multilineVars.setfont[1])
					textarr.push({font: multilineVars.setfont[1], text: textParts[i].substring(1) });
				else if (textParts[i].charAt(0) === '2' && multilineVars.setfont[2])
					textarr.push({font: multilineVars.setfont[2], text: textParts[i].substring(1) });
				else if (textParts[i].charAt(0) === '3' && multilineVars.setfont[3])
					textarr.push({font: multilineVars.setfont[3], text: textParts[i].substring(1) });
				else if (textParts[i].charAt(0) === '4' && multilineVars.setfont[4])
					textarr.push({font: multilineVars.setfont[4], text: textParts[i].substring(1) });
				else
					textarr[textarr.length-1].text += '$' + textParts[i];
			}
			if (textarr.length > 1)
				return textarr;
		}
		return textstr;
	};

	var positionChoices = [ 'auto', 'above', 'below', 'hidden' ];
	parseDirective.addDirective = function(str) {
		var tokens = tokenizer.tokenize(str, 0, str.length);	// 3 or more % in a row, or just spaces after %% is just a comment
		if (tokens.length === 0 || tokens[0].type !== 'alpha') return null;
		var restOfString = str.substring(str.indexOf(tokens[0].token)+tokens[0].token.length);
		restOfString = tokenizer.stripComment(restOfString);
		var cmd = tokens.shift().token.toLowerCase();
		var scratch = "";
		switch (cmd)
		{
			// The following directives were added to abc_parser_lint, but haven't been implemented here.
			// Most of them are direct translations from the directives that will be parsed in. See abcm2ps's format.txt for info on each of these.
			//					alignbars: { type: "number", optional: true },
			//					aligncomposer: { type: "string", Enum: [ 'left', 'center','right' ], optional: true },
			//					bstemdown: { type: "boolean", optional: true },
			//					continueall: { type: "boolean", optional: true },
			//					dynalign: { type: "boolean", optional: true },
			//					exprabove: { type: "boolean", optional: true },
			//					exprbelow: { type: "boolean", optional: true },
			//					flatbeams: { type: "boolean", optional: true },
			//					gchordbox: { type: "boolean", optional: true },
			//					graceslurs: { type: "boolean", optional: true },
			//					gracespacebefore: { type: "number", optional: true },
			//					gracespaceinside: { type: "number", optional: true },
			//					gracespaceafter: { type: "number", optional: true },
			//					infospace: { type: "number", optional: true },
			//					lineskipfac: { type: "number", optional: true },
			//					maxshrink: { type: "number", optional: true },
			//					maxstaffsep: { type: "number", optional: true },
			//					maxsysstaffsep: { type: "number", optional: true },
			//					notespacingfactor: { type: "number", optional: true },
			//					parskipfac: { type: "number", optional: true },
			//					slurheight: { type: "number", optional: true },
			//					splittune: { type: "boolean", optional: true },
			//					squarebreve: { type: "boolean", optional: true },
			//					stemheight: { type: "number", optional: true },
			//					straightflags: { type: "boolean", optional: true },
			//					stretchstaff: { type: "boolean", optional: true },
			//					titleformat: { type: "string", optional: true },
			case "bagpipes":tune.formatting.bagpipes = true;break;
			case "landscape":multilineVars.landscape = true;break;
			case "papersize":multilineVars.papersize = restOfString;break;
			case "slurgraces":tune.formatting.slurgraces = true;break;
			case "stretchlast":tune.formatting.stretchlast = true;break;
			case "titlecaps":multilineVars.titlecaps = true;break;
			case "titleleft":tune.formatting.titleleft = true;break;
			case "measurebox":tune.formatting.measurebox = true;break;

			case "vocal": return addMultilineVarOneParamChoice("vocalPosition", cmd, tokens, positionChoices);
			case "dynamic": return addMultilineVarOneParamChoice("dynamicPosition", cmd, tokens, positionChoices);
			case "gchord": return addMultilineVarOneParamChoice("chordPosition", cmd, tokens, positionChoices);
			case "ornament": return addMultilineVarOneParamChoice("ornamentPosition", cmd, tokens, positionChoices);
			case "volume": return addMultilineVarOneParamChoice("volumePosition", cmd, tokens, positionChoices);

			case "botmargin":
			case "botspace":
			case "composerspace":
			case "indent":
			case "leftmargin":
			case "linesep":
			case "musicspace":
			case "partsspace":
			case "pageheight":
			case "pagewidth":
			case "rightmargin":
			case "staffsep":
			case "staffwidth":
			case "subtitlespace":
			case "sysstaffsep":
			case "systemsep":
			case "textspace":
			case "titlespace":
			case "topmargin":
			case "topspace":
			case "vocalspace":
			case "wordsspace":
				return oneParameterMeasurement(cmd, tokens);
			case "vskip":
				var vskip = getRequiredMeasurement(cmd, tokens);
				if (vskip.error)
					return vskip.error;
				tune.addSpacing(vskip);
				return null;
			case "scale":
				setScale(cmd, tokens);
				break;
			case "sep":
				if (tokens.length === 0)
					tune.addSeparator();
				else {
					var points = tokenizer.getMeasurement(tokens);
					if (points.used === 0)
						return "Directive \"" + cmd + "\" requires 3 numbers: space above, space below, length of line";
					var spaceAbove = points.value;

					points = tokenizer.getMeasurement(tokens);
					if (points.used === 0)
						return "Directive \"" + cmd + "\" requires 3 numbers: space above, space below, length of line";
					var spaceBelow = points.value;

					points = tokenizer.getMeasurement(tokens);
					if (points.used === 0 || tokens.length !== 0)
						return "Directive \"" + cmd + "\" requires 3 numbers: space above, space below, length of line";
					var lenLine = points.value;
					tune.addSeparator(spaceAbove, spaceBelow, lenLine);
				}
				break;
			case "barsperstaff":
				scratch = addMultilineVar('barsperstaff', cmd, tokens);
				if (scratch !== null) return scratch;
				break;
			case "staffnonote":
				// The sense of the boolean is opposite here. "0" means true.
				if (tokens.length !== 1)
					return "Directive staffnonote requires one parameter: 0 or 1";
				if (tokens[0].token === '0')
					multilineVars.staffnonote = true;
				else if (tokens[0].token === '1')
					multilineVars.staffnonote = false;
				else
					return "Directive staffnonote requires one parameter: 0 or 1 (received " + tokens[0].token + ')';
				break;
			case "printtempo":
				scratch = addMultilineVarBool('printTempo', cmd, tokens);
				if (scratch !== null) return scratch;
				break;
			case "partsbox":
				scratch = addMultilineVarBool('partsBox', cmd, tokens);
				if (scratch !== null) return scratch;
				multilineVars.partsfont.box = multilineVars.partsBox;
				break;
			case "measurenb":
			case "barnumbers":
				scratch = addMultilineVar('barNumbers', cmd, tokens);
				if (scratch !== null) return scratch;
				break;
			case "begintext":
				multilineVars.inTextBlock = true;
				break;
			case "continueall":
				multilineVars.continueall = true;
				break;
			case "beginps":
				multilineVars.inPsBlock = true;
				warn("Postscript ignored", str, 0);
				break;
			case "deco":
				if (restOfString.length > 0)
					multilineVars.ignoredDecorations.push(restOfString.substring(0, restOfString.indexOf(' ')));
				warn("Decoration redefinition ignored", str, 0);
				break;
			case "text":
				var textstr = tokenizer.translateString(restOfString);
				tune.addText(parseDirective.parseFontChangeLine(textstr));
				break;
			case "center":
				var centerstr = tokenizer.translateString(restOfString);
				tune.addCentered(parseDirective.parseFontChangeLine(centerstr));
				break;
			case "font":
				// don't need to do anything for this; it is a useless directive
				break;
			case "setfont":
				var sfTokens = tokenizer.tokenize(restOfString, 0, restOfString.length);
//				var sfDone = false;
				if (sfTokens.length >= 4) {
					if (sfTokens[0].token === '-' && sfTokens[1].type === 'number') {
						var sfNum = parseInt(sfTokens[1].token);
						if (sfNum >= 1 && sfNum <= 4) {
							if (!multilineVars.setfont)
								multilineVars.setfont = [];
							sfTokens.shift();
							sfTokens.shift();
							multilineVars.setfont[sfNum] = getFontParameter(sfTokens, multilineVars.setfont[sfNum], str, 0, 'setfont');
//							var sfSize = sfTokens.pop();
//							if (sfSize.type === 'number') {
//								sfSize = parseInt(sfSize.token);
//								var sfFontName = '';
//								for (var sfi = 2; sfi < sfTokens.length; sfi++)
//									sfFontName += sfTokens[sfi].token;
//								multilineVars.setfont[sfNum] = { face: sfFontName, size: sfSize };
//								sfDone = true;
//							}
						}
					}
				}
//				if (!sfDone)
//					return "Bad parameters: " + cmd;
				break;
			case "gchordfont":
			case "partsfont":
			case "tripletfont":
			case "vocalfont":
			case "textfont":
			case "annotationfont":
			case "historyfont":
			case "infofont":
			case "measurefont":
			case "repeatfont":
			case "wordsfont":
				return getChangingFont(cmd, tokens, str);
			case "composerfont":
			case "subtitlefont":
			case "tempofont":
			case "titlefont":
			case "voicefont":
			case "footerfont":
			case "headerfont":
				return getGlobalFont(cmd, tokens, str);
			case "barlabelfont":
			case "barnumberfont":
			case "barnumfont":
				return getChangingFont("measurefont", tokens, str);
			case "staves":
			case "score":
				multilineVars.score_is_present = true;
				var addVoice = function(id, newStaff, bracket, brace, continueBar) {
					if (newStaff || multilineVars.staves.length === 0) {
						multilineVars.staves.push({index: multilineVars.staves.length, numVoices: 0});
					}
					var staff = parseCommon.last(multilineVars.staves);
					if (bracket !== undefined) staff.bracket = bracket;
					if (brace !== undefined) staff.brace = brace;
					if (continueBar) staff.connectBarLines = 'end';
					if (multilineVars.voices[id] === undefined) {
						multilineVars.voices[id] = {staffNum: staff.index, index: staff.numVoices};
						staff.numVoices++;
					}
				};

				var openParen = false;
				var openBracket = false;
				var openBrace = false;
				var justOpenParen = false;
				var justOpenBracket = false;
				var justOpenBrace = false;
				var continueBar = false;
				var lastVoice;
				var addContinueBar = function() {
					continueBar = true;
					if (lastVoice) {
						var ty = 'start';
						if (lastVoice.staffNum > 0) {
							if (multilineVars.staves[lastVoice.staffNum-1].connectBarLines === 'start' ||
								multilineVars.staves[lastVoice.staffNum-1].connectBarLines === 'continue')
								ty = 'continue';
						}
						multilineVars.staves[lastVoice.staffNum].connectBarLines = ty;
					}
				};
				while (tokens.length) {
					var t = tokens.shift();
					switch (t.token) {
						case '(':
							if (openParen) warn("Can't nest parenthesis in %%score", str, t.start);
							else {openParen = true;justOpenParen = true;}
							break;
						case ')':
							if (!openParen || justOpenParen) warn("Unexpected close parenthesis in %%score", str, t.start);
							else openParen = false;
							break;
						case '[':
							if (openBracket) warn("Can't nest brackets in %%score", str, t.start);
							else {openBracket = true;justOpenBracket = true;}
							break;
						case ']':
							if (!openBracket || justOpenBracket) warn("Unexpected close bracket in %%score", str, t.start);
							else {openBracket = false;multilineVars.staves[lastVoice.staffNum].bracket = 'end';}
							break;
						case '{':
							if (openBrace ) warn("Can't nest braces in %%score", str, t.start);
							else {openBrace = true;justOpenBrace = true;}
							break;
						case '}':
							if (!openBrace || justOpenBrace) warn("Unexpected close brace in %%score", str, t.start);
							else {openBrace = false;multilineVars.staves[lastVoice.staffNum].brace = 'end';}
							break;
						case '|':
							addContinueBar();
							break;
						default:
							var vc = "";
							while (t.type === 'alpha' || t.type === 'number') {
								vc += t.token;
								if (t.continueId)
									t = tokens.shift();
								else
									break;
							}
							var newStaff = !openParen || justOpenParen;
							var bracket = justOpenBracket ? 'start' : openBracket ? 'continue' : undefined;
							var brace = justOpenBrace ? 'start' : openBrace ? 'continue' : undefined;
							addVoice(vc, newStaff, bracket, brace, continueBar);
							justOpenParen = false;
							justOpenBracket = false;
							justOpenBrace = false;
							continueBar = false;
							lastVoice = multilineVars.voices[vc];
							if (cmd === 'staves')
								addContinueBar();
							break;
					}
				}
				break;

			case "newpage":
				var pgNum = tokenizer.getInt(restOfString);
				tune.addNewPage(pgNum.digits === 0 ? -1 : pgNum.value);
				break;

			case "abc":
				var arr = restOfString.split(' ');
				switch (arr[0]) {
					case "-copyright":
					case "-creator":
					case "-edited-by":
					case "-version":
					case "-charset":
						var subCmd = arr.shift();
						tune.addMetaText(cmd+subCmd, arr.join(' '));
						break;
					default:
						return "Unknown directive: " + cmd+arr[0];
				}
				break;
			case "header":
			case "footer":
				var footerStr = tokenizer.getMeat(restOfString, 0, restOfString.length);
				footerStr = restOfString.substring(footerStr.start, footerStr.end);
				if (footerStr.charAt(0) === '"' && footerStr.charAt(footerStr.length-1) === '"' )
					footerStr = footerStr.substring(1, footerStr.length-1);
				var footerArr = footerStr.split('\t');
				var footer = {};
				if (footerArr.length === 1)
					footer = { left: "", center: footerArr[0], right: "" };
				else if (footerArr.length === 2)
					footer = { left: footerArr[0], center: footerArr[1], right: "" };
				else
					footer = { left: footerArr[0], center: footerArr[1], right: footerArr[2] };
				if (footerArr.length > 3)
					warn("Too many tabs in " + cmd + ": " + footerArr.length + " found.", restOfString, 0);

				tune.addMetaTextObj(cmd, footer);
				break;

			case "midi":
				var midi = tokenizer.tokenize(restOfString, 0, restOfString.length, true);
				if (midi.length > 0 && midi[0].token === '=')
					midi.shift();
				if (midi.length === 0)
					warn("Expected midi command", restOfString, 0);
				else
					parseMidiCommand(midi, tune, restOfString);
				break;

			case "map":
			case "percmap":
			case "playtempo":
			case "auquality":
			case "continuous":
			case "nobarcheck":
				// TODO-PER: Actually handle the parameters of these
				tune.formatting[cmd] = restOfString;
				break;
			default:
				return "Unknown directive: " + cmd;
		}
		return null;
	};
	parseDirective.globalFormatting = function(formatHash) {
		for (var cmd in formatHash) {
			if (formatHash.hasOwnProperty(cmd)) {
				var value = ''+formatHash[cmd];
				var tokens = tokenizer.tokenize(value, 0, value.length);
				var scratch;
				switch (cmd) {
					case "titlefont":
					case "gchordfont":
					case "composerfont":
					case "footerfont":
					case "headerfont":
					case "historyfont":
					case "infofont":
					case "measurefont":
					case "partsfont":
					case "repeatfont":
					case "subtitlefont":
					case "tempofont":
					case "textfont":
					case "voicefont":
					case "tripletfont":
					case "vocalfont":
					case "wordsfont":
					case "annotationfont":
						getChangingFont(cmd, tokens, value);
						break;
					case "scale":
						setScale(cmd, tokens);
						break;
					case "partsbox":
						scratch = addMultilineVarBool('partsBox', cmd, tokens);
						if (scratch !== null) warn(scratch);
						multilineVars.partsfont.box = multilineVars.partsBox;
						break;
					default:
						warn("Formatting directive unrecognized: ", cmd, 0);
				}
			}
		}
	};
})();

module.exports = parseDirective;

},{"./abc_common":9}],12:[function(require,module,exports){
//    abc_parse_header.js: parses a the header fields from a string representing ABC Music Notation into a usable internal structure.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

/*global window */

var parseCommon = require('./abc_common');
var parseDirective = require('./abc_parse_directive');
var parseKeyVoice = require('./abc_parse_key_voice');

var ParseHeader = function(tokenizer, warn, multilineVars, tune) {
	this.reset = function(tokenizer, warn, multilineVars, tune) {
		parseKeyVoice.initialize(tokenizer, warn, multilineVars, tune);
		parseDirective.initialize(tokenizer, warn, multilineVars, tune);
	};
	this.reset(tokenizer, warn, multilineVars, tune);

	this.setTitle = function(title) {
		if (multilineVars.hasMainTitle)
			tune.addSubtitle(tokenizer.translateString(tokenizer.stripComment(title)));	// display secondary title
		else
		{
			var titleStr = tokenizer.translateString(tokenizer.theReverser(tokenizer.stripComment(title)));
			if (multilineVars.titlecaps)
				titleStr = titleStr.toUpperCase();
			tune.addMetaText("title", titleStr);
			multilineVars.hasMainTitle = true;
		}
	};

	this.setMeter = function(line) {
		line = tokenizer.stripComment(line);
		if (line === 'C') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return {type: 'common_time'};
		} else if (line === 'C|') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return {type: 'cut_time'};
		} else if (line === 'o') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return {type: 'tempus_perfectum'};
		} else if (line === 'c') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return {type: 'tempus_imperfectum'};
		} else if (line === 'o.') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return {type: 'tempus_perfectum_prolatio'};
		} else if (line === 'c.') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return {type: 'tempus_imperfectum_prolatio'};
		} else if (line.length === 0 || line.toLowerCase() === 'none') {
			if (multilineVars.havent_set_length === true) {
				multilineVars.default_length = 0.125;
				multilineVars.havent_set_length = false;
			}
			return null;
		}
		else
		{
			var tokens = tokenizer.tokenize(line, 0, line.length);
			// the form is [open_paren] decimal [ plus|dot decimal ]... [close_paren] slash decimal [plus same_as_before]
			try {
				var parseNum = function() {
					// handles this much: [open_paren] decimal [ plus|dot decimal ]... [close_paren]
					var ret = {value: 0, num: ""};

					var tok = tokens.shift();
					if (tok.token === '(')
						tok = tokens.shift();
					while (1) {
						if (tok.type !== 'number') throw "Expected top number of meter";
						ret.value += parseInt(tok.token);
						ret.num += tok.token;
						if (tokens.length === 0 || tokens[0].token === '/') return ret;
						tok = tokens.shift();
						if (tok.token === ')') {
							if (tokens.length === 0 || tokens[0].token === '/') return ret;
							throw "Unexpected paren in meter";
						}
						if (tok.token !== '.' && tok.token !== '+') throw "Expected top number of meter";
						ret.num += tok.token;
						if (tokens.length === 0) throw "Expected top number of meter";
						tok = tokens.shift();
					}
					return ret;	// just to suppress warning
				};

				var parseFraction = function() {
					// handles this much: parseNum slash decimal
					var ret = parseNum();
					if (tokens.length === 0) return ret;
					var tok = tokens.shift();
					if (tok.token !== '/') throw "Expected slash in meter";
					tok = tokens.shift();
					if (tok.type !== 'number') throw "Expected bottom number of meter";
					ret.den = tok.token;
					ret.value = ret.value / parseInt(ret.den);
					return ret;
				};

				if (tokens.length === 0) throw "Expected meter definition in M: line";
				var meter = {type: 'specified', value: [ ]};
				var totalLength = 0;
				while (1) {
					var ret = parseFraction();
					totalLength += ret.value;
					var mv = { num: ret.num };
					if (ret.den !== undefined)
						mv.den = ret.den;
					meter.value.push(mv);
					if (tokens.length === 0) break;
					//var tok = tokens.shift();
					//if (tok.token !== '+') throw "Extra characters in M: line";
				}

				if (multilineVars.havent_set_length === true) {
					multilineVars.default_length = totalLength < 0.75 ? 0.0625 : 0.125;
					multilineVars.havent_set_length = false;
				}
				return meter;
			} catch (e) {
				warn(e, line, 0);
			}
		}
		return null;
	};

	this.calcTempo = function(relTempo) {
		var dur = 1/4;
		if (multilineVars.meter && multilineVars.meter.type === 'specified') {
			dur = 1 / parseInt(multilineVars.meter.value[0].den);
		} else if (multilineVars.origMeter && multilineVars.origMeter.type === 'specified') {
			dur = 1 / parseInt(multilineVars.origMeter.value[0].den);
		}
		//var dur = multilineVars.default_length ? multilineVars.default_length : 1;
		for (var i = 0; i < relTempo.duration; i++)
			relTempo.duration[i] = dur * relTempo.duration[i];
		return relTempo;
	};

	this.resolveTempo = function() {
		if (multilineVars.tempo) {	// If there's a tempo waiting to be resolved
			this.calcTempo(multilineVars.tempo);
			tune.metaText.tempo = multilineVars.tempo;
			delete multilineVars.tempo;
		}
	};

	this.addUserDefinition = function(line, start, end) {
		var equals = line.indexOf('=', start);
		if (equals === -1) {
			warn("Need an = in a macro definition", line, start);
			return;
		}

		var before = parseCommon.strip(line.substring(start, equals));
		var after = parseCommon.strip(line.substring(equals+1));

		if (before.length !== 1) {
			warn("Macro definitions can only be one character", line, start);
			return;
		}
		var legalChars = "HIJKLMNOPQRSTUVWXYhijklmnopqrstuvw~";
		if (legalChars.indexOf(before) === -1) {
			warn("Macro definitions must be H-Y, h-w, or tilde", line, start);
			return;
		}
		if (after.length === 0) {
			warn("Missing macro definition", line, start);
			return;
		}
		if (multilineVars.macros === undefined)
			multilineVars.macros = {};
		multilineVars.macros[before] = after;
	};

	this.setDefaultLength = function(line, start, end) {
		var len = parseCommon.gsub(line.substring(start, end), " ", "");
		var len_arr = len.split('/');
		if (len_arr.length === 2) {
			var n = parseInt(len_arr[0]);
			var d = parseInt(len_arr[1]);
			if (d > 0) {
				multilineVars.default_length = n / d;	// a whole note is 1
				multilineVars.havent_set_length = false;
			}
		} else if (len_arr.length === 1 && len_arr[0] === '1') {
			multilineVars.default_length = 1;
			multilineVars.havent_set_length = false;
		}
	};


	var tempoString = {

		larghissimo: 20,
		adagissimo: 24,
		sostenuto: 28,
		grave: 32,
		largo: 40,
		lento: 50,
		larghetto: 60,
		adagio: 68,
		adagietto: 74,
		andante: 80,
		andantino: 88,
		"marcia moderato": 84,
		"andante moderato": 100,
		moderato: 112,
		allegretto: 116,
		"allegro moderato": 120,
		allegro: 126,
		animato: 132,
		agitato: 140,
		veloce: 148,
		"mosso vivo": 156,
		vivace: 164,
		vivacissimo: 172,
		allegrissimo: 176,
		presto: 184,
		prestissimo: 210,
	};

	this.setTempo = function(line, start, end) {
		//Q - tempo; can be used to specify the notes per minute, e.g. If
		//the meter denominator is a 4 note then Q:120 or Q:C=120
		//is 120 quarter notes per minute. Similarly  Q:C3=40 would be 40
		//dotted half notes per minute. An absolute tempo may also be
		//set, e.g. Q:1/8=120 is 120 eighth notes per minute,
		//irrespective of the meter's denominator.
		//
		// This is either a number, "C=number", "Cnumber=number", or fraction [fraction...]=number
		// It depends on the M: field, which may either not be present, or may appear after this.
		// If M: is not present, an eighth note is used.
		// That means that this field can't be calculated until the end, if it is the first three types, since we don't know if we'll see an M: field.
		// So, if it is the fourth type, set it here, otherwise, save the info in the multilineVars.
		// The temporary variables we keep are the duration and the bpm. In the first two forms, the duration is 1.
		// In addition, a quoted string may both precede and follow. If a quoted string is present, then the duration part is optional.
		try {
			var tokens = tokenizer.tokenize(line, start, end);

			if (tokens.length === 0) throw "Missing parameter in Q: field";

			var tempo = {};
			var delaySet = true;
			var token = tokens.shift();
			if (token.type === 'quote') {
				tempo.preString = token.token;
				token = tokens.shift();
				if (tokens.length === 0) {	// It's ok to just get a string for the tempo
					// If the string is a well-known tempo, put in the bpm
					if (tempoString[tempo.preString.toLowerCase()]) {
						tempo.bpm = tempoString[tempo.preString.toLowerCase()];
						tempo.suppressBpm = true;
					}
					return {type: 'immediate', tempo: tempo};
				}
			}
			if (token.type === 'alpha' && token.token === 'C')	 { // either type 2 or type 3
				if (tokens.length === 0) throw "Missing tempo after C in Q: field";
				token = tokens.shift();
				if (token.type === 'punct' && token.token === '=') {
					// This is a type 2 format. The duration is an implied 1
					if (tokens.length === 0) throw "Missing tempo after = in Q: field";
					token = tokens.shift();
					if (token.type !== 'number') throw "Expected number after = in Q: field";
					tempo.duration = [1];
					tempo.bpm = parseInt(token.token);
				} else if (token.type === 'number') {
					// This is a type 3 format.
					tempo.duration = [parseInt(token.token)];
					if (tokens.length === 0) throw "Missing = after duration in Q: field";
					token = tokens.shift();
					if (token.type !== 'punct' || token.token !== '=') throw "Expected = after duration in Q: field";
					if (tokens.length === 0) throw "Missing tempo after = in Q: field";
					token = tokens.shift();
					if (token.type !== 'number') throw "Expected number after = in Q: field";
					tempo.bpm = parseInt(token.token);
				} else throw "Expected number or equal after C in Q: field";

			} else if (token.type === 'number') {	// either type 1 or type 4
				var num = parseInt(token.token);
				if (tokens.length === 0 || tokens[0].type === 'quote') {
					// This is type 1
					tempo.duration = [1];
					tempo.bpm = num;
				} else {	// This is type 4
					delaySet = false;
					token = tokens.shift();
					if (token.type !== 'punct' && token.token !== '/') throw "Expected fraction in Q: field";
					token = tokens.shift();
					if (token.type !== 'number') throw "Expected fraction in Q: field";
					var den = parseInt(token.token);
					tempo.duration = [num/den];
					// We got the first fraction, keep getting more as long as we find them.
					while (tokens.length > 0  && tokens[0].token !== '=' && tokens[0].type !== 'quote') {
						token = tokens.shift();
						if (token.type !== 'number') throw "Expected fraction in Q: field";
						num = parseInt(token.token);
						token = tokens.shift();
						if (token.type !== 'punct' && token.token !== '/') throw "Expected fraction in Q: field";
						token = tokens.shift();
						if (token.type !== 'number') throw "Expected fraction in Q: field";
						den = parseInt(token.token);
						tempo.duration.push(num/den);
					}
					token = tokens.shift();
					if (token.type !== 'punct' && token.token !== '=') throw "Expected = in Q: field";
					token = tokens.shift();
					if (token.type !== 'number') throw "Expected tempo in Q: field";
					tempo.bpm = parseInt(token.token);
				}
			} else throw "Unknown value in Q: field";
			if (tokens.length !== 0) {
				token = tokens.shift();
				if (token.type === 'quote') {
					tempo.postString = token.token;
					token = tokens.shift();
				}
				if (tokens.length !== 0) throw "Unexpected string at end of Q: field";
			}
			if (multilineVars.printTempo === false)
				tempo.suppress = true;
			return {type: delaySet?'delaySet':'immediate', tempo: tempo};
		} catch (msg) {
			warn(msg, line, start);
			return {type: 'none'};
		}
	};

	this.letter_to_inline_header = function(line, i)
	{
		var ws = tokenizer.eatWhiteSpace(line, i);
		i +=ws;
		if (line.length >= i+5 && line.charAt(i) === '[' && line.charAt(i+2) === ':') {
			var e = line.indexOf(']', i);
			switch(line.substring(i, i+3))
			{
				case "[I:":
					var err = parseDirective.addDirective(line.substring(i+3, e));
					if (err) warn(err, line, i);
					return [ e-i+1+ws ];
				case "[M:":
					var meter = this.setMeter(line.substring(i+3, e));
					if (tune.hasBeginMusic() && meter)
						tune.appendStartingElement('meter', -1, -1, meter);
					else
						multilineVars.meter = meter;
					return [ e-i+1+ws ];
				case "[K:":
					var result = parseKeyVoice.parseKey(line.substring(i+3, e));
					if (result.foundClef && tune.hasBeginMusic())
						tune.appendStartingElement('clef', -1, -1, multilineVars.clef);
					if (result.foundKey && tune.hasBeginMusic())
						tune.appendStartingElement('key', -1, -1, parseKeyVoice.fixKey(multilineVars.clef, multilineVars.key));
					return [ e-i+1+ws ];
				case "[P:":
					if (tune.lines.length <= tune.lineNum)
						multilineVars.partForNextLine = line.substring(i+3, e);
					else
						tune.appendElement('part', -1, -1, {title: line.substring(i+3, e)});
					return [ e-i+1+ws ];
				case "[L:":
					this.setDefaultLength(line, i+3, e);
					return [ e-i+1+ws ];
				case "[Q:":
					if (e > 0) {
						var tempo = this.setTempo(line, i+3, e);
						if (tempo.type === 'delaySet') tune.appendElement('tempo', -1, -1, this.calcTempo(tempo.tempo));
						else if (tempo.type === 'immediate') tune.appendElement('tempo', -1, -1, tempo.tempo);
						return [ e-i+1+ws, line.charAt(i+1), line.substring(i+3, e)];
					}
					break;
				case "[V:":
					if (e > 0) {
						parseKeyVoice.parseVoice(line, i+3, e);
						//startNewLine();
						return [ e-i+1+ws, line.charAt(i+1), line.substring(i+3, e)];
					}
					break;

				default:
					// TODO: complain about unhandled header
			}
		}
		return [ 0 ];
	};

	this.letter_to_body_header = function(line, i)
	{
		if (line.length >= i+3) {
			switch(line.substring(i, i+2))
			{
				case "I:":
					var err = parseDirective.addDirective(line.substring(i+2));
					if (err) warn(err, line, i);
					return [ line.length ];
				case "M:":
					var meter = this.setMeter(line.substring(i+2));
					if (tune.hasBeginMusic() && meter)
						tune.appendStartingElement('meter', -1, -1, meter);
					return [ line.length ];
				case "K:":
					var result = parseKeyVoice.parseKey(line.substring(i+2));
					if (result.foundClef && tune.hasBeginMusic())
						tune.appendStartingElement('clef', -1, -1, multilineVars.clef);
					if (result.foundKey && tune.hasBeginMusic())
						tune.appendStartingElement('key', -1, -1, parseKeyVoice.fixKey(multilineVars.clef, multilineVars.key));
					return [ line.length ];
				case "P:":
					if (tune.hasBeginMusic())
						tune.appendElement('part', -1, -1, {title: line.substring(i+2)});
					return [ line.length ];
				case "L:":
					this.setDefaultLength(line, i+2, line.length);
					return [ line.length ];
				case "Q:":
					var e = line.indexOf('\x12', i+2);
					if (e === -1) e = line.length;
					var tempo = this.setTempo(line, i+2, e);
					if (tempo.type === 'delaySet') tune.appendElement('tempo', -1, -1, this.calcTempo(tempo.tempo));
					else if (tempo.type === 'immediate') tune.appendElement('tempo', -1, -1, tempo.tempo);
				return [ e, line.charAt(i), parseCommon.strip(line.substring(i+2))];
				case "V:":
					parseKeyVoice.parseVoice(line, i+2, line.length);
//						startNewLine();
					return [ line.length, line.charAt(i), parseCommon.strip(line.substring(i+2))];
				default:
					// TODO: complain about unhandled header
			}
		}
		return [ 0 ];
	};

	var metaTextHeaders = {
		A: 'author',
		B: 'book',
		C: 'composer',
		D: 'discography',
		F: 'url',
		G: 'group',
		I: 'instruction',
		N: 'notes',
		O: 'origin',
		R: 'rhythm',
		S: 'source',
		W: 'unalignedWords',
		Z: 'transcription'
	};

	this.parseHeader = function(line) {
		if (parseCommon.startsWith(line, '%%')) {
			var err = parseDirective.addDirective(line.substring(2));
			if (err) warn(err, line, 2);
			return {};
		}
		var i = line.indexOf('%');
		if (i >= 0)
			line = line.substring(0, i);
		line = line.replace(/\s+$/, '');

		if (line.length === 0)
			return {};

		if (line.length >= 2) {
			if (line.charAt(1) === ':') {
				var nextLine = "";
				if (line.indexOf('\x12') >= 0 && line.charAt(0) !== 'w') {	// w: is the only header field that can have a continuation.
					nextLine = line.substring(line.indexOf('\x12')+1);
					line = line.substring(0, line.indexOf('\x12'));	//This handles a continuation mark on a header field
				}
				var field = metaTextHeaders[line.charAt(0)];
				if (field !== undefined) {
					if (field === 'unalignedWords')
						tune.addMetaTextArray(field, parseDirective.parseFontChangeLine(tokenizer.translateString(tokenizer.stripComment(line.substring(2)))));
					else
						tune.addMetaText(field, tokenizer.translateString(tokenizer.stripComment(line.substring(2))));
					return {};
				} else {
					switch(line.charAt(0))
					{
						case  'H':
							tune.addMetaText("history", tokenizer.translateString(tokenizer.stripComment(line.substring(2))));
							multilineVars.is_in_history = true;
							break;
						case  'K':
							// since the key is the last thing that can happen in the header, we can resolve the tempo now
							this.resolveTempo();
							var result = parseKeyVoice.parseKey(line.substring(2));
							if (!multilineVars.is_in_header && tune.hasBeginMusic()) {
								if (result.foundClef)
									tune.appendStartingElement('clef', -1, -1, multilineVars.clef);
								if (result.foundKey)
									tune.appendStartingElement('key', -1, -1, parseKeyVoice.fixKey(multilineVars.clef, multilineVars.key));
							}
							multilineVars.is_in_header = false;	// The first key signifies the end of the header.
							break;
						case  'L':
							this.setDefaultLength(line, 2, line.length);
							break;
						case  'M':
							multilineVars.origMeter = multilineVars.meter = this.setMeter(line.substring(2));
							break;
						case  'P':
							// TODO-PER: There is more to do with parts, but the writer doesn't care.
							if (multilineVars.is_in_header)
								tune.addMetaText("partOrder", tokenizer.translateString(tokenizer.stripComment(line.substring(2))));
							else
								multilineVars.partForNextLine = tokenizer.translateString(tokenizer.stripComment(line.substring(2)));
							break;
						case  'Q':
							var tempo = this.setTempo(line, 2, line.length);
							if (tempo.type === 'delaySet') multilineVars.tempo = tempo.tempo;
							else if (tempo.type === 'immediate') tune.metaText.tempo = tempo.tempo;
							break;
						case  'T':
							this.setTitle(line.substring(2));
							break;
						case 'U':
							this.addUserDefinition(line, 2, line.length);
							break;
						case  'V':
							parseKeyVoice.parseVoice(line, 2, line.length);
							if (!multilineVars.is_in_header)
								return {newline: true};
							break;
						case  's':
							return {symbols: true};
						case  'w':
							return {words: true};
						case 'X':
							break;
						case 'E':
						case 'm':
							warn("Ignored header", line, 0);
							break;
						default:
							// It wasn't a recognized header value, so parse it as music.
							if (nextLine.length)
								nextLine = "\x12" + nextLine;
							//parseRegularMusicLine(line+nextLine);
							//nextLine = "";
							return {regular: true, str: line+nextLine};
					}
				}
				if (nextLine.length > 0)
					return {recurse: true, str: nextLine};
				return {};
			}
		}

		// If we got this far, we have a regular line of mulsic
		return {regular: true, str: line};
	};
};

module.exports = ParseHeader;

},{"./abc_common":9,"./abc_parse_directive":11,"./abc_parse_key_voice":13}],13:[function(require,module,exports){
/*global window */

var parseCommon = require('./abc_common');
var parseDirective = require('./abc_parse_directive');
var transpose = require('./abc_transpose');

var parseKeyVoice = {};

(function() {
	var tokenizer;
	var warn;
	var multilineVars;
	var tune;
	parseKeyVoice.initialize = function(tokenizer_, warn_, multilineVars_, tune_) {
		tokenizer = tokenizer_;
		warn = warn_;
		multilineVars = multilineVars_;
		tune = tune_;
	};

	parseKeyVoice.standardKey = function(keyName, root, acc, localTranspose) {
		var key1sharp = {acc: 'sharp', note: 'f'};
		var key2sharp = {acc: 'sharp', note: 'c'};
		var key3sharp = {acc: 'sharp', note: 'g'};
		var key4sharp = {acc: 'sharp', note: 'd'};
		var key5sharp = {acc: 'sharp', note: 'A'};
		var key6sharp = {acc: 'sharp', note: 'e'};
		var key7sharp = {acc: 'sharp', note: 'B'};
		var key1flat = {acc: 'flat', note: 'B'};
		var key2flat = {acc: 'flat', note: 'e'};
		var key3flat = {acc: 'flat', note: 'A'};
		var key4flat = {acc: 'flat', note: 'd'};
		var key5flat = {acc: 'flat', note: 'G'};
		var key6flat = {acc: 'flat', note: 'c'};
		var key7flat = {acc: 'flat', note: 'F'};

		var keys = {
			'C#': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],
			'A#m': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],
			'G#Mix': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],
			'D#Dor': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],
			'E#Phr': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],
			'F#Lyd': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],
			'B#Loc': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ],

			'F#': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],
			'D#m': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],
			'C#Mix': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],
			'G#Dor': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],
			'A#Phr': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],
			'BLyd': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],
			'E#Loc': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp ],

			'B': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],
			'G#m': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],
			'F#Mix': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],
			'C#Dor': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],
			'D#Phr': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],
			'ELyd': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],
			'A#Loc': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp ],

			'E': [ key1sharp, key2sharp, key3sharp, key4sharp ],
			'C#m': [ key1sharp, key2sharp, key3sharp, key4sharp ],
			'BMix': [ key1sharp, key2sharp, key3sharp, key4sharp ],
			'F#Dor': [ key1sharp, key2sharp, key3sharp, key4sharp ],
			'G#Phr': [ key1sharp, key2sharp, key3sharp, key4sharp ],
			'ALyd': [ key1sharp, key2sharp, key3sharp, key4sharp ],
			'D#Loc': [ key1sharp, key2sharp, key3sharp, key4sharp ],

			'A': [ key1sharp, key2sharp, key3sharp ],
			'F#m': [ key1sharp, key2sharp, key3sharp ],
			'EMix': [ key1sharp, key2sharp, key3sharp ],
			'BDor': [ key1sharp, key2sharp, key3sharp ],
			'C#Phr': [ key1sharp, key2sharp, key3sharp ],
			'DLyd': [ key1sharp, key2sharp, key3sharp ],
			'G#Loc': [ key1sharp, key2sharp, key3sharp ],

			'D': [ key1sharp, key2sharp ],
			'Bm': [ key1sharp, key2sharp ],
			'AMix': [ key1sharp, key2sharp ],
			'EDor': [ key1sharp, key2sharp ],
			'F#Phr': [ key1sharp, key2sharp ],
			'GLyd': [ key1sharp, key2sharp ],
			'C#Loc': [ key1sharp, key2sharp ],

			'G': [ key1sharp ],
			'Em': [ key1sharp ],
			'DMix': [ key1sharp ],
			'ADor': [ key1sharp ],
			'BPhr': [ key1sharp ],
			'CLyd': [ key1sharp ],
			'F#Loc': [ key1sharp ],

			'C': [],
			'Am': [],
			'GMix': [],
			'DDor': [],
			'EPhr': [],
			'FLyd': [],
			'BLoc': [],

			'F': [ key1flat ],
			'Dm': [ key1flat ],
			'CMix': [ key1flat ],
			'GDor': [ key1flat ],
			'APhr': [ key1flat ],
			'BbLyd': [ key1flat ],
			'ELoc': [ key1flat ],

			'Bb': [ key1flat, key2flat ],
			'Gm': [ key1flat, key2flat ],
			'FMix': [ key1flat, key2flat ],
			'CDor': [ key1flat, key2flat ],
			'DPhr': [ key1flat, key2flat ],
			'EbLyd': [ key1flat, key2flat ],
			'ALoc': [ key1flat, key2flat ],

			'Eb': [ key1flat, key2flat, key3flat ],
			'Cm': [ key1flat, key2flat, key3flat ],
			'BbMix': [ key1flat, key2flat, key3flat ],
			'FDor': [ key1flat, key2flat, key3flat ],
			'GPhr': [ key1flat, key2flat, key3flat ],
			'AbLyd': [ key1flat, key2flat, key3flat ],
			'DLoc': [ key1flat, key2flat, key3flat ],

			'Ab': [ key1flat, key2flat, key3flat, key4flat ],
			'Fm': [ key1flat, key2flat, key3flat, key4flat ],
			'EbMix': [ key1flat, key2flat, key3flat, key4flat ],
			'BbDor': [ key1flat, key2flat, key3flat, key4flat ],
			'CPhr': [ key1flat, key2flat, key3flat, key4flat ],
			'DbLyd': [ key1flat, key2flat, key3flat, key4flat ],
			'GLoc': [ key1flat, key2flat, key3flat, key4flat ],

			'Db': [ key1flat, key2flat, key3flat, key4flat, key5flat ],
			'Bbm': [ key1flat, key2flat, key3flat, key4flat, key5flat ],
			'AbMix': [ key1flat, key2flat, key3flat, key4flat, key5flat ],
			'EbDor': [ key1flat, key2flat, key3flat, key4flat, key5flat ],
			'FPhr': [ key1flat, key2flat, key3flat, key4flat, key5flat ],
			'GbLyd': [ key1flat, key2flat, key3flat, key4flat, key5flat ],
			'CLoc': [ key1flat, key2flat, key3flat, key4flat, key5flat ],

			'Gb': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],
			'Ebm': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],
			'DbMix': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],
			'AbDor': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],
			'BbPhr': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],
			'CbLyd': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],
			'FLoc': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat ],

			'Cb': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],
			'Abm': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],
			'GbMix': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],
			'DbDor': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],
			'EbPhr': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],
			'FbLyd': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],
			'BbLoc': [ key1flat, key2flat, key3flat, key4flat, key5flat, key6flat, key7flat ],

			// The following are not in the 2.0 spec, but seem normal enough.
			// TODO-PER: These SOUND the same as what's written, but they aren't right
			'A#': [ key1flat, key2flat ],
			'B#': [],
			'D#': [ key1flat, key2flat, key3flat ],
			'E#': [ key1flat ],
			'G#': [ key1flat, key2flat, key3flat, key4flat ],
			'Gbm': [ key1sharp, key2sharp, key3sharp, key4sharp, key5sharp, key6sharp, key7sharp ]
		};

		return transpose.keySignature(multilineVars, keys, keyName, root, acc, localTranspose);
	};

	var clefLines = {
		'treble': { clef: 'treble', pitch: 4, mid: 0 },
		'treble+8': { clef: 'treble+8', pitch: 4, mid: 0 },
		'treble-8': { clef: 'treble-8', pitch: 4, mid: 0 },
		'treble1': { clef: 'treble', pitch: 2, mid: 2 },
		'treble2': { clef: 'treble', pitch: 4, mid: 0 },
		'treble3': { clef: 'treble', pitch: 6, mid: -2 },
		'treble4': { clef: 'treble', pitch: 8, mid: -4 },
		'treble5': { clef: 'treble', pitch: 10, mid: -6 },
		'perc': { clef: 'perc', pitch: 6, mid: 0 },
		'none': { clef: 'none', mid: 0 },
		'bass': { clef: 'bass', pitch: 8, mid: -12 },
		'bass+8': { clef: 'bass+8', pitch: 8, mid: -12 },
		'bass-8': { clef: 'bass-8', pitch: 8, mid: -12 },
		'bass+16': { clef: 'bass', pitch: 8, mid: -12 },
		'bass-16': { clef: 'bass', pitch: 8, mid: -12 },
		'bass1': { clef: 'bass', pitch: 2, mid: -6 },
		'bass2': { clef: 'bass', pitch: 4, mid: -8 },
		'bass3': { clef: 'bass', pitch: 6, mid: -10 },
		'bass4': { clef: 'bass', pitch: 8, mid: -12 },
		'bass5': { clef: 'bass', pitch: 10, mid: -14 },
		'tenor': { clef: 'alto', pitch: 8, mid: -8 },
		'tenor1': { clef: 'alto', pitch: 2, mid: -2 },
		'tenor2': { clef: 'alto', pitch: 4, mid: -4 },
		'tenor3': { clef: 'alto', pitch: 6, mid: -6 },
		'tenor4': { clef: 'alto', pitch: 8, mid: -8 },
		'tenor5': { clef: 'alto', pitch: 10, mid: -10 },
		'alto': { clef: 'alto', pitch: 6, mid: -6 },
		'alto1': { clef: 'alto', pitch: 2, mid: -2 },
		'alto2': { clef: 'alto', pitch: 4, mid: -4 },
		'alto3': { clef: 'alto', pitch: 6, mid: -6 },
		'alto4': { clef: 'alto', pitch: 8, mid: -8 },
		'alto5': { clef: 'alto', pitch: 10, mid: -10 },
		'alto+8': { clef: 'alto+8', pitch: 6, mid: -6 },
		'alto-8': { clef: 'alto-8', pitch: 6, mid: -6 }
	};

	var calcMiddle = function(clef, oct) {
		var value = clefLines[clef];
		var mid = value ? value.mid : 0;
		return mid+oct;
	};

	parseKeyVoice.fixClef = function(clef) {
		var value = clefLines[clef.type];
		if (value) {
			clef.clefPos = value.pitch;
			clef.type = value.clef;
		}
	};

	parseKeyVoice.deepCopyKey = function(key) {
		var ret = { accidentals: [], root: key.root, acc: key.acc, mode: key.mode };
		parseCommon.each(key.accidentals, function(k) {
		ret.accidentals.push(parseCommon.clone(k));
		});
		return ret;
	};

	var pitches = {A: 5, B: 6, C: 0, D: 1, E: 2, F: 3, G: 4, a: 12, b: 13, c: 7, d: 8, e: 9, f: 10, g: 11};

	parseKeyVoice.addPosToKey = function(clef, key) {
		// Shift the key signature from the treble positions to whatever position is needed for the clef.
		// This may put the key signature unnaturally high or low, so if it does, then shift it.
		var mid = clef.verticalPos;
		parseCommon.each(key.accidentals, function(acc) {
			var pitch = pitches[acc.note];
			pitch = pitch - mid;
			acc.verticalPos = pitch;
		});
		if (key.impliedNaturals)
			parseCommon.each(key.impliedNaturals, function(acc) {
				var pitch = pitches[acc.note];
				pitch = pitch - mid;
				acc.verticalPos = pitch;
			});

		if (mid < -10) {
			parseCommon.each(key.accidentals, function(acc) {
				acc.verticalPos -= 7;
				if (acc.verticalPos >= 11 || (acc.verticalPos === 10 && acc.acc === 'flat'))
					acc.verticalPos -= 7;
				if (acc.note === 'A' && acc.acc === 'sharp' )
					acc.verticalPos -=7;
				if ((acc.note === 'G' || acc.note === 'F') && acc.acc === 'flat' )
					acc.verticalPos -=7;
			});
			if (key.impliedNaturals)
				parseCommon.each(key.impliedNaturals, function(acc) {
					acc.verticalPos -= 7;
					if (acc.verticalPos >= 11 || (acc.verticalPos === 10 && acc.acc === 'flat'))
						acc.verticalPos -= 7;
					if (acc.note === 'A' && acc.acc === 'sharp' )
						acc.verticalPos -=7;
					if ((acc.note === 'G' || acc.note === 'F') && acc.acc === 'flat' )
						acc.verticalPos -=7;
				});
		} else if (mid < -4) {
			parseCommon.each(key.accidentals, function(acc) {
				acc.verticalPos -= 7;
				if (mid === -8 && (acc.note === 'f' || acc.note === 'g') && acc.acc === 'sharp' )
					acc.verticalPos -=7;
			});
			if (key.impliedNaturals)
				parseCommon.each(key.impliedNaturals, function(acc) {
					acc.verticalPos -= 7;
					if (mid === -8 && (acc.note === 'f' || acc.note === 'g') && acc.acc === 'sharp' )
						acc.verticalPos -=7;
				});
		} else if (mid >= 7) {
			parseCommon.each(key.accidentals, function(acc) {
				acc.verticalPos += 7;
			});
			if (key.impliedNaturals)
				parseCommon.each(key.impliedNaturals, function(acc) {
					acc.verticalPos += 7;
				});
		}
	};

	parseKeyVoice.fixKey = function(clef, key) {
		var fixedKey = parseCommon.clone(key);
		parseKeyVoice.addPosToKey(clef, fixedKey);
		return fixedKey;
	};

	var parseMiddle = function(str) {
		var i = 0;
		var p = str.charAt(i++);
		if (p === '^' || p === '_')
			p = str.charAt(i++);
	  var mid = pitches[p];
		if (mid === undefined)
			mid = 6; // If a legal middle note wasn't received, just ignore it.
		for ( ; i < str.length; i++) {
			if (str.charAt(i) === ',') mid -= 7;
			else if (str.charAt(i) === "'") mid += 7;
			else break;
		}
		return { mid: mid - 6, str: str.substring(i) };	// We get the note in the middle of the staff. We want the note that appears as the first ledger line below the staff.
	};

	var normalizeAccidentals = function(accs) {
		for (var i = 0; i < accs.length; i++) {
			if (accs[i].note === 'b')
				accs[i].note = 'B';
			else if (accs[i].note === 'a')
				accs[i].note = 'A';
			else if (accs[i].note === 'F')
				accs[i].note = 'f';
			else if (accs[i].note === 'E')
				accs[i].note = 'e';
			else if (accs[i].note === 'D')
				accs[i].note = 'd';
			else if (accs[i].note === 'C')
				accs[i].note = 'c';
			else if (accs[i].note === 'G' && accs[i].acc === 'sharp')
				accs[i].note = 'g';
			else if (accs[i].note === 'g' && accs[i].acc === 'flat')
				accs[i].note = 'G';
		}
	};

	parseKeyVoice.parseKey = function(str)	// (and clef)
	{
		// returns:
		//		{ foundClef: true, foundKey: true }
		// Side effects:
		//		calls warn() when there is a syntax error
		//		sets these members of multilineVars:
		//			clef
		//			key
		//			style
		//
		// The format is:
		// K: [⟨key⟩] [⟨modifiers⟩*]
		// modifiers are any of the following in any order:
		//  [⟨clef⟩] [middle=⟨pitch⟩] [transpose=[-]⟨number⟩] [stafflines=⟨number⟩] [staffscale=⟨number⟩][style=⟨style⟩]
		// key is none|HP|Hp|⟨specified_key⟩
		// clef is [clef=] [⟨clef type⟩] [⟨line number⟩] [+8|-8]
		// specified_key is ⟨pitch⟩[#|b][mode(first three chars are significant)][accidentals*]
		if (str.length === 0) {
			// an empty K: field is the same as K:none
			str = 'none';
		}
		var tokens = tokenizer.tokenize(str, 0, str.length);
		var ret = {};

		// first the key
		switch (tokens[0].token) {
			case 'HP':
				parseDirective.addDirective("bagpipes");
				multilineVars.key = { root: "HP", accidentals: [], acc: "", mode: "" };
				ret.foundKey = true;
				tokens.shift();
				break;
			case 'Hp':
				parseDirective.addDirective("bagpipes");
				multilineVars.key = { root: "Hp", accidentals: [{acc: 'natural', note: 'g'}, {acc: 'sharp', note: 'f'}, {acc: 'sharp', note: 'c'}], acc: "", mode: "" };
				ret.foundKey = true;
				tokens.shift();
				break;
			case 'none':
				// we got the none key - that's the same as C to us
				multilineVars.key = { root: "none", accidentals: [], acc: "", mode: "" };
				ret.foundKey = true;
				tokens.shift();
				break;
			default:
				var retPitch = tokenizer.getKeyPitch(tokens[0].token);
				if (retPitch.len > 0) {
					ret.foundKey = true;
					var acc = "";
					var mode = "";
					// The accidental and mode might be attached to the pitch, so we might want to just remove the first character.
					if (tokens[0].token.length > 1)
						tokens[0].token = tokens[0].token.substring(1);
					else
						tokens.shift();
					var key = retPitch.token;
					// We got a pitch to start with, so we might also have an accidental and a mode
					if (tokens.length > 0) {
						var retAcc = tokenizer.getSharpFlat(tokens[0].token);
						if (retAcc.len > 0) {
							if (tokens[0].token.length > 1)
								tokens[0].token = tokens[0].token.substring(1);
							else
								tokens.shift();
							key += retAcc.token;
							acc = retAcc.token;
						}
						if (tokens.length > 0) {
							var retMode = tokenizer.getMode(tokens[0].token);
							if (retMode.len > 0) {
								tokens.shift();
								key += retMode.token;
								mode = retMode.token;
							}
						}
						// Be sure that the key specified is in the list: not all keys are physically possible, like Cbmin.
						if (parseKeyVoice.standardKey(key, retPitch.token, acc, 0) === undefined) {
							warn("Unsupported key signature: " + key, str, 0);
							return ret;
						}
					}
					// We need to do a deep copy because we are going to modify it
					var oldKey = parseKeyVoice.deepCopyKey(multilineVars.key);
					//TODO-PER: HACK! To get the local transpose to work, the transposition is done for each line. This caused the global transposition variable to be factored in twice, so, instead of rewriting that right now, I'm just subtracting one of them here.
					var keyCompensate = multilineVars.globalTranspose ? -multilineVars.globalTranspose : 0;
					multilineVars.key = parseKeyVoice.deepCopyKey(parseKeyVoice.standardKey(key, retPitch.token, acc, keyCompensate));
					multilineVars.key.mode = mode;
					if (oldKey) {
						// Add natural in all places that the old key had an accidental.
						var kk;
						for (var k = 0; k < multilineVars.key.accidentals.length; k++) {
							for (kk = 0; kk < oldKey.accidentals.length; kk++) {
								if (oldKey.accidentals[kk].note && multilineVars.key.accidentals[k].note.toLowerCase() === oldKey.accidentals[kk].note.toLowerCase())
									oldKey.accidentals[kk].note = null;
							}
						}
						for (kk = 0; kk < oldKey.accidentals.length; kk++) {
							if (oldKey.accidentals[kk].note) {
								if (!multilineVars.key.impliedNaturals)
									multilineVars.key.impliedNaturals = [];
								multilineVars.key.impliedNaturals.push({ acc: 'natural', note: oldKey.accidentals[kk].note });
							}
						}
					}
				}
				break;
		}

		// There are two special cases of deprecated syntax. Ignore them if they occur
		if (tokens.length === 0) return ret;
		if (tokens[0].token === 'exp') tokens.shift();
		if (tokens.length === 0) return ret;
		if (tokens[0].token === 'oct') tokens.shift();

		// now see if there are extra accidentals
		if (tokens.length === 0) return ret;
		var accs = tokenizer.getKeyAccidentals2(tokens);
		if (accs.warn)
			warn(accs.warn, str, 0);
		// If we have extra accidentals, first replace ones that are of the same pitch before adding them to the end.
		if (accs.accs) {
			if (!ret.foundKey) {		// if there are only extra accidentals, make sure this is set.
				ret.foundKey = true;
				multilineVars.key = { root: "none", acc: "", mode: "", accidentals: [] };
			}
			normalizeAccidentals(accs.accs);
			for (var i = 0; i < accs.accs.length; i++) {
				var found = false;
				for (var j = 0; j < multilineVars.key.accidentals.length && !found; j++) {
					if (multilineVars.key.accidentals[j].note === accs.accs[i].note) {
						found = true;
						if (multilineVars.key.accidentals[j].acc !== accs.accs[i].acc) {
							// If the accidental is different, then replace it. If it is the same, then the declaration was redundant, so just ignore it.
							multilineVars.key.accidentals[j].acc = accs.accs[i].acc;
							if (!multilineVars.key.explicitAccidentals)
								multilineVars.key.explicitAccidentals = [];
							multilineVars.key.explicitAccidentals.push(accs.accs[i]);
						}
					}
				}
				if (!found) {
					if (!multilineVars.key.explicitAccidentals)
						multilineVars.key.explicitAccidentals = [];
					multilineVars.key.explicitAccidentals.push(accs.accs[i]);
					multilineVars.key.accidentals.push(accs.accs[i]);
					if (multilineVars.key.impliedNaturals) {
						for (var kkk = 0; kkk < multilineVars.key.impliedNaturals.length; kkk++) {
							if (multilineVars.key.impliedNaturals[kkk].note === accs.accs[i].note)
								multilineVars.key.impliedNaturals.splice(kkk, 1);
						}
					}
				}
			}
		}

		// Now see if any optional parameters are present. They have the form "key=value", except that "clef=" is optional
		var token;
		while (tokens.length > 0) {
			switch (tokens[0].token) {
				case "m":
				case "middle":
					tokens.shift();
					if (tokens.length === 0) { warn("Expected = after middle", str, 0); return ret; }
					token = tokens.shift();
					if (token.token !== "=") { warn("Expected = after middle", str, token.start); break; }
					if (tokens.length === 0) { warn("Expected parameter after middle=", str, 0); return ret; }
					var pitch = tokenizer.getPitchFromTokens(tokens);
					if (pitch.warn)
						warn(pitch.warn, str, 0);
					if (pitch.position)
						multilineVars.clef.verticalPos = pitch.position - 6;	// we get the position from the middle line, but want to offset it to the first ledger line.
					break;
				case "transpose":
					tokens.shift();
					if (tokens.length === 0) { warn("Expected = after transpose", str, 0); return ret; }
					token = tokens.shift();
					if (token.token !== "=") { warn("Expected = after transpose", str, token.start); break; }
					if (tokens.length === 0) { warn("Expected parameter after transpose=", str, 0); return ret; }
					if (tokens[0].type !== 'number') { warn("Expected number after transpose", str, tokens[0].start); break; }
					multilineVars.clef.transpose = tokens[0].intt;
					tokens.shift();
					break;
				case "stafflines":
					tokens.shift();
					if (tokens.length === 0) { warn("Expected = after stafflines", str, 0); return ret; }
					token = tokens.shift();
					if (token.token !== "=") { warn("Expected = after stafflines", str, token.start); break; }
					if (tokens.length === 0) { warn("Expected parameter after stafflines=", str, 0); return ret; }
					if (tokens[0].type !== 'number') { warn("Expected number after stafflines", str, tokens[0].start); break; }
					multilineVars.clef.stafflines = tokens[0].intt;
					tokens.shift();
					break;
				case "staffscale":
					tokens.shift();
					if (tokens.length === 0) { warn("Expected = after staffscale", str, 0); return ret; }
					token = tokens.shift();
					if (token.token !== "=") { warn("Expected = after staffscale", str, token.start); break; }
					if (tokens.length === 0) { warn("Expected parameter after staffscale=", str, 0); return ret; }
					if (tokens[0].type !== 'number') { warn("Expected number after staffscale", str, tokens[0].start); break; }
					multilineVars.clef.staffscale = tokens[0].floatt;
					tokens.shift();
					break;
				case "style":
					tokens.shift();
					if (tokens.length === 0) { warn("Expected = after style", str, 0); return ret; }
					token = tokens.shift();
					if (token.token !== "=") { warn("Expected = after style", str, token.start); break; }
					if (tokens.length === 0) { warn("Expected parameter after style=", str, 0); return ret; }
					switch (tokens[0].token) {
						case "normal":
						case "harmonic":
						case "rhythm":
						case "x":
							multilineVars.style = tokens[0].token;
							tokens.shift();
							break;
						default:
							warn("error parsing style element: " + tokens[0].token, str, tokens[0].start);
							break;
					}
					break;
				case "clef":
					tokens.shift();
					if (tokens.length === 0) { warn("Expected = after clef", str, 0); return ret; }
					token = tokens.shift();
					if (token.token !== "=") { warn("Expected = after clef", str, token.start); break; }
					if (tokens.length === 0) { warn("Expected parameter after clef=", str, 0); return ret; }
					//break; yes, we want to fall through. That allows "clef=" to be optional.
				case "treble":
				case "bass":
				case "alto":
				case "tenor":
				case "perc":
					// clef is [clef=] [⟨clef type⟩] [⟨line number⟩] [+8|-8]
					var clef = tokens.shift();
					switch (clef.token) {
						case 'treble':
						case 'tenor':
						case 'alto':
						case 'bass':
						case 'perc':
						case 'none':
							break;
						case 'C': clef.token = 'alto'; break;
						case 'F': clef.token = 'bass'; break;
						case 'G': clef.token = 'treble'; break;
						case 'c': clef.token = 'alto'; break;
						case 'f': clef.token = 'bass'; break;
						case 'g': clef.token = 'treble'; break;
						default:
							warn("Expected clef name. Found " + clef.token, str, clef.start);
							break;
					}
					if (tokens.length > 0 && tokens[0].type === 'number') {
						clef.token += tokens[0].token;
						tokens.shift();
					}
					if (tokens.length > 1 && (tokens[0].token === '-' || tokens[0].token === '+') && tokens[1].token === '8') {
						clef.token += tokens[0].token + tokens[1].token;
						tokens.shift();
						tokens.shift();
					}
					multilineVars.clef = {type: clef.token, verticalPos: calcMiddle(clef.token, 0)};
					if (multilineVars.currentVoice && multilineVars.currentVoice.transpose !== undefined)
						multilineVars.clef.transpose = multilineVars.currentVoice.transpose;
					ret.foundClef = true;
					break;
				default:
					warn("Unknown parameter: " + tokens[0].token, str, tokens[0].start);
					tokens.shift();
			}
		}
		return ret;
	};

	var setCurrentVoice = function(id) {
		multilineVars.currentVoice = multilineVars.voices[id];
		tune.setCurrentVoice(multilineVars.currentVoice.staffNum, multilineVars.currentVoice.index);
	};

	parseKeyVoice.parseVoice = function(line, i, e) {
		//First truncate the string to the first non-space character after V: through either the
		//end of the line or a % character. Then remove trailing spaces, too.
		var ret = tokenizer.getMeat(line, i, e);
		var start = ret.start;
		var end = ret.end;
		//The first thing on the line is the ID. It can be any non-space string and terminates at the
		//first space.
		var id = tokenizer.getToken(line, start, end);
		if (id.length === 0) {
			warn("Expected a voice id", line, start);
			return;
		}
		var isNew = false;
		if (multilineVars.voices[id] === undefined) {
			multilineVars.voices[id] = {};
			isNew = true;
			if (multilineVars.score_is_present)
				warn("Can't have an unknown V: id when the %score directive is present", line, start);
		}
		start += id.length;
		start += tokenizer.eatWhiteSpace(line, start);

		var staffInfo = {startStaff: isNew};
		var addNextTokenToStaffInfo = function(name) {
			var attr = tokenizer.getVoiceToken(line, start, end);
			if (attr.warn !== undefined)
				warn("Expected value for " + name + " in voice: " + attr.warn, line, start);
			else if (attr.token.length === 0 && line.charAt(start) !== '"')
				warn("Expected value for " + name + " in voice", line, start);
			else
				staffInfo[name] = attr.token;
			start += attr.len;
		};
		var addNextTokenToVoiceInfo = function(id, name, type) {
			var attr = tokenizer.getVoiceToken(line, start, end);
			if (attr.warn !== undefined)
				warn("Expected value for " + name + " in voice: " + attr.warn, line, start);
			else if (attr.token.length === 0 && line.charAt(start) !== '"')
				warn("Expected value for " + name + " in voice", line, start);
			else {
				if (type === 'number')
					attr.token = parseFloat(attr.token);
				multilineVars.voices[id][name] = attr.token;
			}
			start += attr.len;
		};
		var addNextNoteTokenToVoiceInfo = function(id, name) {
			var noteToTransposition = {
				"_B": 2,
				"_E": 9,
				"_b": -10,
				"_e": -3
			};
			var attr = tokenizer.getVoiceToken(line, start, end);
			if (attr.warn !== undefined)
				warn("Expected one of (_B, _E, _b, _e) for " + name + " in voice: " + attr.warn, line, start);
			else if (attr.token.length === 0 && line.charAt(start) !== '"')
				warn("Expected one of (_B, _E, _b, _e) for " + name + " in voice", line, start);
			else {
				var t = noteToTransposition[attr.token];
				if (!t)
					warn("Expected one of (_B, _E, _b, _e) for " + name + " in voice", line, start);
				else
					multilineVars.voices[id][name] = t;
			}
			start += attr.len;
		};

		//Then the following items can occur in any order:
		while (start < end) {
			var token = tokenizer.getVoiceToken(line, start, end);
			start += token.len;

			if (token.warn) {
				warn("Error parsing voice: " + token.warn, line, start);
			} else {
				var attr = null;
				switch (token.token) {
					case 'clef':
					case 'cl':
						addNextTokenToStaffInfo('clef');
						// TODO-PER: check for a legal clef; do octavizing
						var oct = 0;
	//							for (var ii = 0; ii < staffInfo.clef.length; ii++) {
	//								if (staffInfo.clef[ii] === ',') oct -= 7;
	//								else if (staffInfo.clef[ii] === "'") oct += 7;
	//							}
						if (staffInfo.clef !== undefined) {
						  staffInfo.clef = staffInfo.clef.replace(/[',]/g, ""); //'//comment for emacs formatting of regexp
							if (staffInfo.clef.indexOf('+16') !== -1) {
								oct += 14;
								staffInfo.clef = staffInfo.clef.replace('+16', '');
							}
							staffInfo.verticalPos = calcMiddle(staffInfo.clef, oct);
						}
						break;
					case 'treble':
					case 'bass':
					case 'tenor':
					case 'alto':
					case 'perc':
					case 'none':
					case 'treble\'':
					case 'bass\'':
					case 'tenor\'':
					case 'alto\'':
					case 'none\'':
					case 'treble\'\'':
					case 'bass\'\'':
					case 'tenor\'\'':
					case 'alto\'\'':
					case 'none\'\'':
					case 'treble,':
					case 'bass,':
					case 'tenor,':
					case 'alto,':
					case 'none,':
					case 'treble,,':
					case 'bass,,':
					case 'tenor,,':
					case 'alto,,':
					case 'none,,':
						// TODO-PER: handle the octave indicators on the clef by changing the middle property
						var oct2 = 0;
	//							for (var iii = 0; iii < token.token.length; iii++) {
	//								if (token.token[iii] === ',') oct2 -= 7;
	//								else if (token.token[iii] === "'") oct2 += 7;
	//							}
											  staffInfo.clef = token.token.replace(/[',]/g, ""); //'//comment for emacs formatting of regexp
						staffInfo.verticalPos = calcMiddle(staffInfo.clef, oct2);
						multilineVars.voices[id].clef = token.token;
						break;
					case 'staves':
					case 'stave':
					case 'stv':
						addNextTokenToStaffInfo('staves');
						break;
					case 'brace':
					case 'brc':
						addNextTokenToStaffInfo('brace');
						break;
					case 'bracket':
					case 'brk':
						addNextTokenToStaffInfo('bracket');
						break;
					case 'name':
					case 'nm':
						addNextTokenToStaffInfo('name');
						break;
					case 'subname':
					case 'sname':
					case 'snm':
						addNextTokenToStaffInfo('subname');
						break;
					case 'merge':
						staffInfo.startStaff = false;
						break;
					case 'stem':
					case 'stems':
						attr = tokenizer.getVoiceToken(line, start, end);
						if (attr.warn !== undefined)
							warn("Expected value for stems in voice: " + attr.warn, line, start);
						else if (attr.token === 'up' || attr.token === 'down')
							multilineVars.voices[id].stem = attr.token;
						else
							warn("Expected up or down for voice stem", line, start);
						start += attr.len;
						break;
					case 'up':
					case 'down':
						multilineVars.voices[id].stem = token.token;
						break;
					case 'middle':
					case 'm':
						addNextTokenToStaffInfo('verticalPos');
						staffInfo.verticalPos = parseMiddle(staffInfo.verticalPos).mid;
						break;
					case 'gchords':
					case 'gch':
						multilineVars.voices[id].suppressChords = true;
						// gchords can stand on its own, or it could be gchords=0.
						attr = tokenizer.getVoiceToken(line, start, end);
						if (attr.token === "0")
							start = start + attr.len;
						break;
					case 'space':
					case 'spc':
						addNextTokenToStaffInfo('spacing');
						break;
					case 'scale':
						addNextTokenToVoiceInfo(id, 'scale', 'number');
						break;
					case 'score':
						addNextNoteTokenToVoiceInfo(id, 'scoreTranspose');
						break;
					case 'transpose':
						addNextTokenToVoiceInfo(id, 'transpose', 'number');
						break;
					case 'stafflines':
						addNextTokenToVoiceInfo(id, 'stafflines', 'number');
						break;
					case 'staffscale':
						// TODO-PER: This is passed to the engraver, but the engraver ignores it.
						addNextTokenToVoiceInfo(id, 'staffscale', 'number');
						break;
					case 'octave':
						// TODO-PER: This is accepted, but not implemented, yet.
						addNextTokenToVoiceInfo(id, 'octave', 'number');
						break;
					case 'volume':
						// TODO-PER: This is accepted, but not implemented, yet.
						addNextTokenToVoiceInfo(id, 'volume', 'number');
						break;
					case "style":
						attr = tokenizer.getVoiceToken(line, start, end);
						if (attr.warn !== undefined)
							warn("Expected value for style in voice: " + attr.warn, line, start);
						else if (attr.token === 'normal' || attr.token === 'harmonic' || attr.token === 'rhythm' || attr.token === 'x')
							multilineVars.voices[id].style = attr.token;
						else
							warn("Expected one of [normal, harmonic, rhythm, x] for voice style", line, start);
						start += attr.len;
						break;
					// default:
					// Use this to find V: usages that aren't handled.
					// 	console.log("parse voice", token, tune.metaText.title);
				}
			}
			start += tokenizer.eatWhiteSpace(line, start);
		}

		// now we've filled up staffInfo, figure out what to do with this voice
		// TODO-PER: It is unclear from the standard and the examples what to do with brace, bracket, and staves, so they are ignored for now.
		if (staffInfo.startStaff || multilineVars.staves.length === 0) {
			multilineVars.staves.push({index: multilineVars.staves.length, meter: multilineVars.origMeter});
			if (!multilineVars.score_is_present)
				multilineVars.staves[multilineVars.staves.length-1].numVoices = 0;
		}
		if (multilineVars.voices[id].staffNum === undefined) {
			// store where to write this for quick access later.
			multilineVars.voices[id].staffNum = multilineVars.staves.length-1;
			var vi = 0;
			for(var v in multilineVars.voices) {
				if(multilineVars.voices.hasOwnProperty(v)) {
					if (multilineVars.voices[v].staffNum === multilineVars.voices[id].staffNum)
						vi++;
				}
			}
			multilineVars.voices[id].index = vi-1;
		}
		var s = multilineVars.staves[multilineVars.voices[id].staffNum];
		if (!multilineVars.score_is_present)
			s.numVoices++;
		if (staffInfo.clef) s.clef = {type: staffInfo.clef, verticalPos: staffInfo.verticalPos};
		if (staffInfo.spacing) s.spacing_below_offset = staffInfo.spacing;
		if (staffInfo.verticalPos) s.verticalPos = staffInfo.verticalPos;

		if (staffInfo.name) {if (s.name) s.name.push(staffInfo.name); else s.name = [ staffInfo.name ];}
		if (staffInfo.subname) {if (s.subname) s.subname.push(staffInfo.subname); else s.subname = [ staffInfo.subname ];}

		setCurrentVoice(id);
	};

})();

module.exports = parseKeyVoice;

},{"./abc_common":9,"./abc_parse_directive":11,"./abc_transpose":15}],14:[function(require,module,exports){
//    abc_tokenizer.js: tokenizes an ABC Music Notation string to support abc_parse.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var parseCommon = require('./abc_common');

// this is a series of functions that get a particular element out of the passed stream.
// the return is the number of characters consumed, so 0 means that the element wasn't found.
// also returned is the element found. This may be a different length because spaces may be consumed that aren't part of the string.
// The return structure for most calls is { len: num_chars_consumed, token: str }
var Tokenizer = function() {
	this.skipWhiteSpace = function(str) {
		for (var i = 0; i < str.length; i++) {
		  if (!this.isWhiteSpace(str.charAt(i)))
				return i;
		}
		return str.length;	// It must have been all white space
	};
	var finished = function(str, i) {
		return i >= str.length;
	};
	this.eatWhiteSpace = function(line, index) {
		for (var i = index; i < line.length; i++) {
		  if (!this.isWhiteSpace(line.charAt(i)))
				return i-index;
		}
		return i-index;
	};

	// This just gets the basic pitch letter, ignoring leading spaces, and normalizing it to a capital
	this.getKeyPitch = function(str) {
		var i = this.skipWhiteSpace(str);
		if (finished(str, i))
			return {len: 0};
		switch (str.charAt(i)) {
			case 'A':return {len: i+1, token: 'A'};
			case 'B':return {len: i+1, token: 'B'};
			case 'C':return {len: i+1, token: 'C'};
			case 'D':return {len: i+1, token: 'D'};
			case 'E':return {len: i+1, token: 'E'};
			case 'F':return {len: i+1, token: 'F'};
			case 'G':return {len: i+1, token: 'G'};
//			case 'a':return {len: i+1, token: 'A'};
//			case 'b':return {len: i+1, token: 'B'};
//			case 'c':return {len: i+1, token: 'C'};
//			case 'd':return {len: i+1, token: 'D'};
//			case 'e':return {len: i+1, token: 'E'};
//			case 'f':return {len: i+1, token: 'F'};
//			case 'g':return {len: i+1, token: 'G'};
		}
		return {len: 0};
	};

	// This just gets the basic accidental, ignoring leading spaces, and only the ones that appear in a key
	this.getSharpFlat = function(str) {
		if (str === 'bass')
			return {len: 0};
		switch (str.charAt(0)) {
			case '#':return {len: 1, token: '#'};
			case 'b':return {len: 1, token: 'b'};
		}
		return {len: 0};
	};

	this.getMode = function(str) {
		var skipAlpha = function(str, start) {
			// This returns the index of the next non-alphabetic char, or the entire length of the string if not found.
		  while (start < str.length && ((str.charAt(start) >= 'a' && str.charAt(start) <= 'z') || (str.charAt(start) >= 'A' && str.charAt(start) <= 'Z')))
				start++;
			return start;
		};

		var i = this.skipWhiteSpace(str);
		if (finished(str, i))
			return {len: 0};
		var firstThree = str.substring(i,i+3).toLowerCase();
		if (firstThree.length > 1 && firstThree.charAt(1) === ' ' || firstThree.charAt(1) === '^' || firstThree.charAt(1) === '_' || firstThree.charAt(1) === '=') firstThree = firstThree.charAt(0);	// This will handle the case of 'm'
		switch (firstThree) {
			case 'mix':return {len: skipAlpha(str, i), token: 'Mix'};
			case 'dor':return {len: skipAlpha(str, i), token: 'Dor'};
			case 'phr':return {len: skipAlpha(str, i), token: 'Phr'};
			case 'lyd':return {len: skipAlpha(str, i), token: 'Lyd'};
			case 'loc':return {len: skipAlpha(str, i), token: 'Loc'};
			case 'aeo':return {len: skipAlpha(str, i), token: 'm'};
			case 'maj':return {len: skipAlpha(str, i), token: ''};
			case 'ion':return {len: skipAlpha(str, i), token: ''};
			case 'min':return {len: skipAlpha(str, i), token: 'm'};
			case 'm':return {len: skipAlpha(str, i), token: 'm'};
		}
		return {len: 0};
	};

	this.getClef = function(str, bExplicitOnly) {
		var strOrig = str;
		var i = this.skipWhiteSpace(str);
		if (finished(str, i))
			return {len: 0};
		// The word 'clef' is optional, but if it appears, a clef MUST appear
		var needsClef = false;
		var strClef = str.substring(i);
		if (parseCommon.startsWith(strClef, 'clef=')) {
			needsClef = true;
			strClef = strClef.substring(5);
			i += 5;
		}
		if (strClef.length === 0 && needsClef)
			return {len: i+5, warn: "No clef specified: " + strOrig};

		var j = this.skipWhiteSpace(strClef);
		if (finished(strClef, j))
			return {len: 0};
		if (j > 0) {
			i += j;
			strClef = strClef.substring(j);
		}
		var name = null;
		if (parseCommon.startsWith(strClef, 'treble'))
			name = 'treble';
		else if (parseCommon.startsWith(strClef, 'bass3'))
			name = 'bass3';
		else if (parseCommon.startsWith(strClef, 'bass'))
			name = 'bass';
		else if (parseCommon.startsWith(strClef, 'tenor'))
			name = 'tenor';
		else if (parseCommon.startsWith(strClef, 'alto2'))
			name = 'alto2';
		else if (parseCommon.startsWith(strClef, 'alto1'))
			name = 'alto1';
		else if (parseCommon.startsWith(strClef, 'alto'))
			name = 'alto';
		else if (!bExplicitOnly && (needsClef && parseCommon.startsWith(strClef, 'none')))
			name = 'none';
		else if (parseCommon.startsWith(strClef, 'perc'))
			name = 'perc';
		else if (!bExplicitOnly && (needsClef && parseCommon.startsWith(strClef, 'C')))
			name = 'tenor';
		else if (!bExplicitOnly && (needsClef && parseCommon.startsWith(strClef, 'F')))
			name = 'bass';
		else if (!bExplicitOnly && (needsClef && parseCommon.startsWith(strClef, 'G')))
			name = 'treble';
		else
			return {len: i+5, warn: "Unknown clef specified: " + strOrig};

		strClef = strClef.substring(name.length);
		j = this.isMatch(strClef, '+8');
		if (j > 0)
			name += "+8";
		else {
			j = this.isMatch(strClef, '-8');
			if (j > 0)
				name += "-8";
		}
		return {len: i+name.length, token: name, explicit: needsClef};
	};

	// This returns one of the legal bar lines
	// This is called alot and there is no obvious tokenable items, so this is broken apart.
	this.getBarLine = function(line, i) {
		switch (line.charAt(i)) {
			case ']':
				++i;
				switch (line.charAt(i)) {
					case '|': return {len: 2, token: "bar_thick_thin"};
					case '[':
						++i;
						if ((line.charAt(i) >= '1' && line.charAt(i) <= '9') || line.charAt(i) === '"')
							return {len: 2, token: "bar_invisible"};
						return {len: 1, warn: "Unknown bar symbol"};
					default:
						return {len: 1, token: "bar_invisible"};
				}
				break;
			case ':':
				++i;
				switch (line.charAt(i)) {
					case ':': return {len: 2, token: "bar_dbl_repeat"};
					case '|':	// :|
						++i;
						switch (line.charAt(i)) {
							case ']':	// :|]
								++i;
								switch (line.charAt(i)) {
									case '|':	// :|]|
										++i;
										if (line.charAt(i) === ':')  return {len: 5, token: "bar_dbl_repeat"};
										return {len: 3, token: "bar_right_repeat"};
									default:
										return {len: 3, token: "bar_right_repeat"};
								}
								break;
							case '|':	// :||
								++i;
								if (line.charAt(i) === ':')  return {len: 4, token: "bar_dbl_repeat"};
								return {len: 3, token: "bar_right_repeat"};
							default:
								return {len: 2, token: "bar_right_repeat"};
						}
						break;
					default:
						return {len: 1, warn: "Unknown bar symbol"};
				}
				break;
			case '[':	// [
				++i;
				if (line.charAt(i) === '|') {	// [|
					++i;
					switch (line.charAt(i)) {
						case ':': return {len: 3, token: "bar_left_repeat"};
						case ']': return {len: 3, token: "bar_invisible"};
						default: return {len: 2, token: "bar_thick_thin"};
					}
				} else {
					if ((line.charAt(i) >= '1' && line.charAt(i) <= '9') || line.charAt(i) === '"')
						return {len: 1, token: "bar_invisible"};
					return {len: 0};
				}
				break;
			case '|':	// |
				++i;
				switch (line.charAt(i)) {
					case ']': return {len: 2, token: "bar_thin_thick"};
					case '|': // ||
						++i;
						if (line.charAt(i) === ':') return {len: 3, token: "bar_left_repeat"};
						return {len: 2, token: "bar_thin_thin"};
					case ':':	// |:
						var colons = 0;
						while (line.charAt(i+colons) === ':') colons++;
						return { len: 1+colons, token: "bar_left_repeat"};
					default: return {len: 1, token: "bar_thin"};
				}
				break;
		}
		return {len: 0};
	};

	// this returns all the characters in the string that match one of the characters in the legalChars string
	this.getTokenOf = function(str, legalChars) {
		for (var i = 0; i < str.length; i++) {
			if (legalChars.indexOf(str.charAt(i)) < 0)
				return {len: i, token: str.substring(0, i)};
		}
		return {len: i, token: str};
	};

	this.getToken = function(str, start, end) {
		// This returns the next set of chars that doesn't contain spaces
		var i = start;
		while (i < end && !this.isWhiteSpace(str.charAt(i)))
			i++;
		return str.substring(start, i);
	};

	// This just sees if the next token is the word passed in, with possible leading spaces
	this.isMatch = function(str, match) {
		var i = this.skipWhiteSpace(str);
		if (finished(str, i))
			return 0;
		if (parseCommon.startsWith(str.substring(i), match))
			return i+match.length;
		return 0;
	};

	this.getPitchFromTokens = function(tokens) {
		var ret = { };
		var pitches = {A: 5, B: 6, C: 0, D: 1, E: 2, F: 3, G: 4, a: 12, b: 13, c: 7, d: 8, e: 9, f: 10, g: 11};
		ret.position = pitches[tokens[0].token];
		if (ret.position === undefined)
			return { warn: "Pitch expected. Found: " + tokens[0].token };
		tokens.shift();
		while (tokens.length) {
			switch (tokens[0].token) {
				case ',': ret.position -= 7; tokens.shift(); break;
				case '\'': ret.position += 7; tokens.shift(); break;
				default: return ret;
			}
		}
		return ret;
	};

	this.getKeyAccidentals2 = function(tokens) {
		var accs;
		// find and strip off all accidentals in the token list
		while (tokens.length > 0) {
			var acc;
			if (tokens[0].token === '^') {
				acc = 'sharp';
				tokens.shift();
				if (tokens.length === 0) return {accs: accs, warn: 'Expected note name after ' + acc};
				switch (tokens[0].token) {
					case '^': acc = 'dblsharp'; tokens.shift(); break;
					case '/': acc = 'quartersharp'; tokens.shift(); break;
				}
			} else if (tokens[0].token === '=') {
				acc = 'natural';
				tokens.shift();
			} else if (tokens[0].token === '_') {
				acc = 'flat';
				tokens.shift();
				if (tokens.length === 0) return {accs: accs, warn: 'Expected note name after ' + acc};
				switch (tokens[0].token) {
					case '_': acc = 'dblflat'; tokens.shift(); break;
					case '/': acc = 'quarterflat'; tokens.shift(); break;
				}
			} else {
				// Not an accidental, we'll assume that a later parse will recognize it.
				return { accs: accs };
			}
			if (tokens.length === 0) return {accs: accs, warn: 'Expected note name after ' + acc};
			switch (tokens[0].token.charAt(0))
			{
				case 'a':
				case 'b':
				case 'c':
				case 'd':
				case 'e':
				case 'f':
				case 'g':
				case 'A':
				case 'B':
				case 'C':
				case 'D':
				case 'E':
				case 'F':
				case 'G':
					if (accs === undefined)
						accs = [];
					accs.push({ acc: acc, note: tokens[0].token.charAt(0) });
					if (tokens[0].token.length === 1)
						tokens.shift();
					else
						tokens[0].token = tokens[0].token.substring(1);
					break;
				default:
					return {accs: accs, warn: 'Expected note name after ' + acc + ' Found: ' + tokens[0].token };
			}
		}
		return { accs: accs };
	};

	// This gets an accidental marking for the key signature. It has the accidental then the pitch letter.
	this.getKeyAccidental = function(str) {
		var accTranslation = {
			'^': 'sharp',
			'^^': 'dblsharp',
			'=': 'natural',
			'_': 'flat',
			'__': 'dblflat',
			'_/': 'quarterflat',
			'^/': 'quartersharp'
		};
		var i = this.skipWhiteSpace(str);
		if (finished(str, i))
			return {len: 0};
		var acc = null;
		switch (str.charAt(i))
		{
			case '^':
			case '_':
			case '=':
				acc = str.charAt(i);
				break;
			default:return {len: 0};
		}
		i++;
		if (finished(str, i))
			return {len: 1, warn: 'Expected note name after accidental'};
		switch (str.charAt(i))
		{
			case 'a':
			case 'b':
			case 'c':
			case 'd':
			case 'e':
			case 'f':
			case 'g':
			case 'A':
			case 'B':
			case 'C':
			case 'D':
			case 'E':
			case 'F':
			case 'G':
				return {len: i+1, token: {acc: accTranslation[acc], note: str.charAt(i)}};
			case '^':
			case '_':
			case '/':
				acc += str.charAt(i);
				i++;
				if (finished(str, i))
					return {len: 2, warn: 'Expected note name after accidental'};
				switch (str.charAt(i))
				{
					case 'a':
					case 'b':
					case 'c':
					case 'd':
					case 'e':
					case 'f':
					case 'g':
					case 'A':
					case 'B':
					case 'C':
					case 'D':
					case 'E':
					case 'F':
					case 'G':
						return {len: i+1, token: {acc: accTranslation[acc], note: str.charAt(i)}};
					default:
						return {len: 2, warn: 'Expected note name after accidental'};
				}
				break;
			default:
				return {len: 1, warn: 'Expected note name after accidental'};
		}
	};

	this.isWhiteSpace = function(ch) {
		return ch === ' ' || ch === '\t' || ch === '\x12';
	};

	this.getMeat = function(line, start, end) {
		// This removes any comments starting with '%' and trims the ends of the string so that there are no leading or trailing spaces.
		// it returns just the start and end characters that contain the meat.
		var comment = line.indexOf('%', start);
		if (comment >= 0 && comment < end)
			end = comment;
		while (start < end && (line.charAt(start) === ' ' || line.charAt(start) === '\t' || line.charAt(start) === '\x12'))
			start++;
		while (start < end && (line.charAt(end-1) === ' ' || line.charAt(end-1) === '\t' || line.charAt(end-1) === '\x12'))
			end--;
		return {start: start, end: end};
	};

	var isLetter = function(ch) {
		return (ch >= 'A' && ch <= 'Z') || (ch >= 'a' && ch <= 'z');
	};

	var isNumber = function(ch) {
		return (ch >= '0' && ch <= '9');
	};

	this.tokenize = function(line, start, end, alphaUntilWhiteSpace) {
		// this returns all the tokens inside the passed string. A token is a punctuation mark, a string of digits, a string of letters.
		//  Quoted strings are one token.
		//  If there is a minus sign next to a number, then it is included in the number.
		// If there is a period immediately after a number, with a number immediately following, then a float is returned.
		// The type of token is returned: quote, alpha, number, punct
		// If alphaUntilWhiteSpace is true, then the behavior of the alpha token changes.

		var ret = this.getMeat(line, start, end);
		start = ret.start;
		end = ret.end;
		var tokens = [];
		var i;
		while (start < end) {
			if (line.charAt(start) === '"') {
				i = start+1;
				while (i < end && line.charAt(i) !== '"') i++;
				tokens.push({ type: 'quote', token: line.substring(start+1, i), start: start+1, end: i});
				i++;
			} else if (isLetter(line.charAt(start))) {
				i = start+1;
				if (alphaUntilWhiteSpace)
					while (i < end && !this.isWhiteSpace(line.charAt(i))) i++;
				else
					while (i < end && isLetter(line.charAt(i))) i++;
				tokens.push({ type: 'alpha', token: line.substring(start, i), continueId: isNumber(line.charAt(i)), start: start, end: i});
				start = i + 1;
			} else if (line.charAt(start) === '.' && isNumber(line.charAt(i+1))) {
				i = start+1;
				var int2 = null;
				var float2 = null;
				while (i < end && isNumber(line.charAt(i))) i++;

				float2 = parseFloat(line.substring(start, i));
				tokens.push({ type: 'number', token: line.substring(start, i), intt: int2, floatt: float2, continueId: isLetter(line.charAt(i)), start: start, end: i});
				start = i + 1;
			} else if (isNumber(line.charAt(start)) || (line.charAt(start) === '-' && isNumber(line.charAt(i+1)))) {
				i = start+1;
				var intt = null;
				var floatt = null;
				while (i < end && isNumber(line.charAt(i))) i++;
				if (line.charAt(i) === '.' && isNumber(line.charAt(i+1))) {
					i++;
					while (i < end && isNumber(line.charAt(i))) i++;
				} else
					intt = parseInt(line.substring(start, i));

				floatt = parseFloat(line.substring(start, i));
				tokens.push({ type: 'number', token: line.substring(start, i), intt: intt, floatt: floatt, continueId: isLetter(line.charAt(i)), start: start, end: i});
				start = i + 1;
			} else if (line.charAt(start) === ' ' || line.charAt(start) === '\t') {
				i = start+1;
			} else {
				tokens.push({ type: 'punct', token: line.charAt(start), start: start, end: start+1});
				i = start+1;
			}
			start = i;
		}
		return tokens;
	};

	this.getVoiceToken = function(line, start, end) {
		// This finds the next token. A token is delimited by a space or an equal sign. If it starts with a quote, then the portion between the quotes is returned.
		var i = start;
		while (i < end && this.isWhiteSpace(line.charAt(i)) || line.charAt(i) === '=')
			i++;

		if (line.charAt(i) === '"') {
			var close = line.indexOf('"', i+1);
			if (close === -1 || close >= end)
				return {len: 1, err: "Missing close quote"};
			return {len: close-start+1, token: this.translateString(line.substring(i+1, close))};
		} else {
			var ii = i;
			while (ii < end && !this.isWhiteSpace(line.charAt(ii)) && line.charAt(ii) !== '=')
				ii++;
			return {len: ii-start+1, token: line.substring(i, ii)};
		}
	};

	var charMap = {
		"`a": 'à', "'a": "á", "^a": "â", "~a": "ã", "\"a": "ä", "oa": "å", "aa": "å", "=a": "ā", "ua": "ă", ";a": "ą",
		"`e": 'è', "'e": "é", "^e": "ê", "\"e": "ë", "=e": "ē", "ue": "ĕ", ";e": "ę", ".e": "ė",
		"`i": 'ì', "'i": "í", "^i": "î", "\"i": "ï", "=i": "ī", "ui": "ĭ", ";i": "į",
		"`o": 'ò', "'o": "ó", "^o": "ô", "~o": "õ", "\"o": "ö", "=o": "ō", "uo": "ŏ", "/o": "ø",
		"`u": 'ù', "'u": "ú", "^u": "û", "~u": "ũ", "\"u": "ü", "ou": "ů", "=u": "ū", "uu": "ŭ", ";u": "ų",
		"`A": 'À', "'A": "Á", "^A": "Â", "~A": "Ã", "\"A": "Ä", "oA": "Å", "AA": "Å", "=A": "Ā", "uA": "Ă", ";A": "Ą",
		"`E": 'È', "'E": "É", "^E": "Ê", "\"E": "Ë", "=E": "Ē", "uE": "Ĕ", ";E": "Ę", ".E": "Ė",
		"`I": 'Ì', "'I": "Í", "^I": "Î", "~I": "Ĩ", "\"I": "Ï", "=I": "Ī", "uI": "Ĭ", ";I": "Į", ".I": "İ",
		"`O": 'Ò', "'O": "Ó", "^O": "Ô", "~O": "Õ", "\"O": "Ö", "=O": "Ō", "uO": "Ŏ", "/O": "Ø",
		"`U": 'Ù', "'U": "Ú", "^U": "Û", "~U": "Ũ", "\"U": "Ü", "oU": "Ů", "=U": "Ū", "uU": "Ŭ", ";U": "Ų",
		"ae": "æ", "AE": "Æ", "oe": "œ", "OE": "Œ", "ss": "ß",
		"'c": "ć", "^c": "ĉ", "uc": "č", "cc": "ç", ".c": "ċ", "cC": "Ç", "'C": "Ć", "^C": "Ĉ", "uC": "Č", ".C": "Ċ",
		"~N": "Ñ", "~n": "ñ",
		"=s": "š", "vs": "š",
		"DH": "Ð", "dh": "ð",
		"HO": "Ő", "Ho": "ő", "HU": "Ű", "Hu": "ű",
		"'Y": "Ý", "'y": "ý", "^Y": "Ŷ", "^y": "ŷ", "\"Y": "Ÿ", "\"y": "ÿ",
		"vS": "Š", "vZ": "Ž", "vz": 'ž'

// More chars: Ĳ ĳ Ď ď Đ đ Ĝ ĝ Ğ ğ Ġ ġ Ģ ģ Ĥ ĥ Ħ ħ Ĵ ĵ Ķ ķ ĸ Ĺ ĺ Ļ ļ Ľ ľ Ŀ ŀ Ł ł Ń ń Ņ ņ Ň ň ŉ Ŋ ŋ Ŕ ŕ Ŗ ŗ Ř ř Ś ś Ŝ ŝ Ş ş Š Ţ ţ Ť ť Ŧ ŧ Ŵ ŵ Ź ź Ż ż Ž
	};
	var charMap1 = {
		"#": "♯",
		"b": "♭",
		"=": "♮"
	};
	var charMap2 = {
		"201": "♯",
		"202": "♭",
		"203": "♮",
		"241": "¡",
		"242": "¢", "252": "a", "262": "2", "272": "o", "302": "Â", "312": "Ê", "322": "Ò", "332": "Ú", "342": "â", "352": "ê", "362": "ò", "372": "ú",
		"243": "£", "253": "«", "263": "3", "273": "»", "303": "Ã", "313": "Ë", "323": "Ó", "333": "Û", "343": "ã", "353": "ë", "363": "ó", "373": "û",
		"244": "¤", "254": "¬", "264": "  ́", "274": "1⁄4", "304": "Ä", "314": "Ì", "324": "Ô", "334": "Ü", "344": "ä", "354": "ì", "364": "ô", "374": "ü",
		"245": "¥", "255": "-", "265": "μ", "275": "1⁄2", "305": "Å", "315": "Í", "325": "Õ", "335": "Ý",  "345": "å", "355": "í", "365": "õ", "375": "ý",
		"246": "¦", "256": "®", "266": "¶", "276": "3⁄4", "306": "Æ", "316": "Î", "326": "Ö", "336": "Þ", "346": "æ", "356": "î", "366": "ö", "376": "þ",
		"247": "§", "257": " ̄", "267": "·", "277": "¿", "307": "Ç", "317": "Ï", "327": "×", "337": "ß", "347": "ç", "357": "ï", "367": "÷", "377": "ÿ",
		"250": " ̈", "260": "°", "270": " ̧", "300": "À", "310": "È", "320": "Ð", "330": "Ø", "340": "à", "350": "è", "360": "ð", "370": "ø",
		"251": "©", "261": "±", "271": "1", "301": "Á", "311": "É", "321": "Ñ", "331": "Ù", "341": "á", "351": "é", "361": "ñ", "371": "ù" };
	this.translateString = function(str) {
		var arr = str.split('\\');
		if (arr.length === 1) return str;
		var out = null;
		parseCommon.each(arr, function(s) {
			if (out === null)
				out = s;
			else {
				var c = charMap[s.substring(0, 2)];
				if (c !== undefined)
					out += c + s.substring(2);
				else {
					c = charMap2[s.substring(0, 3)];
					if (c !== undefined)
						out += c + s.substring(3);
					else {
						c = charMap1[s.substring(0, 1)];
						if (c !== undefined)
							out += c + s.substring(1);
						else
							out += "\\" + s;
					}
				}
			}
		});
		return out;
	};
	this.getNumber = function(line, index) {
		var num = 0;
		while (index < line.length) {
			switch (line.charAt(index)) {
				case '0':num = num*10;index++;break;
				case '1':num = num*10+1;index++;break;
				case '2':num = num*10+2;index++;break;
				case '3':num = num*10+3;index++;break;
				case '4':num = num*10+4;index++;break;
				case '5':num = num*10+5;index++;break;
				case '6':num = num*10+6;index++;break;
				case '7':num = num*10+7;index++;break;
				case '8':num = num*10+8;index++;break;
				case '9':num = num*10+9;index++;break;
				default:
					return {num: num, index: index};
			}
		}
		return {num: num, index: index};
	};

	this.getFraction = function(line, index) {
		var num = 1;
		var den = 1;
		if (line.charAt(index) !== '/') {
			var ret = this.getNumber(line, index);
			num = ret.num;
			index = ret.index;
		}
		if (line.charAt(index) === '/') {
			index++;
			if (line.charAt(index) === '/') {
				var div = 0.5;
				while (line.charAt(index++) === '/')
					div = div /2;
				return {value: num * div, index: index-1};
			} else {
				var iSave = index;
				var ret2 = this.getNumber(line, index);
				if (ret2.num === 0 && iSave === index)	// If we didn't use any characters, it is an implied 2
					ret2.num = 2;
				if (ret2.num !== 0)
					den = ret2.num;
				index = ret2.index;
			}
		}

		return {value: num/den, index: index};
	};

	this.theReverser = function(str) {
		if (parseCommon.endsWith(str, ", The"))
			return "The " + str.substring(0, str.length-5);
		if (parseCommon.endsWith(str, ", A"))
			return "A " + str.substring(0, str.length-3);
		return str;
	};

	this.stripComment = function(str) {
		var i = str.indexOf('%');
		if (i >= 0)
			return parseCommon.strip(str.substring(0, i));
		return parseCommon.strip(str);
	};

	this.getInt = function(str) {
		// This parses the beginning of the string for a number and returns { value: num, digits: num }
		// If digits is 0, then the string didn't point to a number.
		var x = parseInt(str);
		if (isNaN(x))
			return {digits: 0};
		var s = "" + x;
		var i = str.indexOf(s);	// This is to account for leading spaces
		return {value: x, digits: i+s.length};
	};

	this.getFloat = function(str) {
		// This parses the beginning of the string for a number and returns { value: num, digits: num }
		// If digits is 0, then the string didn't point to a number.
		var x = parseFloat(str);
		if (isNaN(x))
			return {digits: 0};
		var s = "" + x;
		var i = str.indexOf(s);	// This is to account for leading spaces
		return {value: x, digits: i+s.length};
	};

	this.getMeasurement = function(tokens) {
		if (tokens.length === 0) return { used: 0 };
		var used = 1;
		var num = '';
		if (tokens[0].token === '-') {
			tokens.shift();
			num = '-';
			used++;
		}
		else if (tokens[0].type !== 'number') return { used: 0 };
		num += tokens.shift().token;
		if (tokens.length === 0) return { used: 1, value: parseInt(num) };
		var x = tokens.shift();
		if (x.token === '.') {
			used++;
			if (tokens.length === 0) return { used: used, value: parseInt(num) };
			if (tokens[0].type === 'number') {
				x = tokens.shift();
				num = num + '.' + x.token;
				used++;
				if (tokens.length === 0) return { used: used, value: parseFloat(num) };
			}
			x = tokens.shift();
		}
		switch (x.token) {
			case 'pt': return { used: used+1, value: parseFloat(num) };
			case 'cm': return { used: used+1, value: parseFloat(num)/2.54*72 };
			case 'in': return { used: used+1, value: parseFloat(num)*72 };
			default: tokens.unshift(x); return { used: used, value: parseFloat(num) };
		}
		return { used: 0 };
	};
	var substInChord = function(str)
	{
		while ( str.indexOf("\\n") !== -1)
		{
			str = str.replace("\\n", "\n");
		}
		return str;
	};
	this.getBrackettedSubstring = function(line, i, maxErrorChars, _matchChar)
	{
		// This extracts the sub string by looking at the first character and searching for that
		// character later in the line (or search for the optional _matchChar).
		// For instance, if the first character is a quote it will look for
		// the end quote. If the end of the line is reached, then only up to the default number
		// of characters are returned, so that a missing end quote won't eat up the entire line.
		// It returns the substring and the number of characters consumed.
		// The number of characters consumed is normally two more than the size of the substring,
		// but in the error case it might not be.
		var matchChar = _matchChar || line.charAt(i);
		var pos = i+1;
		while ((pos < line.length) && (line.charAt(pos) !== matchChar))
			++pos;
		if (line.charAt(pos) === matchChar)
			return [pos-i+1,substInChord(line.substring(i+1, pos)), true];
		else	// we hit the end of line, so we'll just pick an arbitrary num of chars so the line doesn't disappear.
		{
			pos = i+maxErrorChars;
			if (pos > line.length-1)
				pos = line.length-1;
			return [pos-i+1, substInChord(line.substring(i+1, pos)), false];
		}
	};
};

module.exports = Tokenizer;

},{"./abc_common":9}],15:[function(require,module,exports){
//    abc_transpose.js: Handles the automatic transposition of key signatures, chord symbols, and notes.
//    Copyright (C) 2010-2018 Paul Rosen (paul at paulrosen dot net)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var transpose = {};

var keyIndex = {
	'C': 0,
	'C#': 1,
	'Db': 1,
	'D': 2,
	'D#': 3,
	'Eb': 3,
	'E': 4,
	'F': 5,
	'F#': 6,
	'Gb': 6,
	'G': 7,
	'G#': 8,
	'Ab': 8,
	'A': 9,
	'A#': 10,
	'Bb': 10,
	'B': 11
};
var newKey = ['C', 'Db', 'D', 'Eb', 'E', 'F', 'F#', 'G', 'Ab', 'A', 'Bb', 'B'];
var newKeyMinor = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'Bb', 'B'];

transpose.keySignature = function(multilineVars, keys, keyName, root, acc, localTranspose) {
	if (!localTranspose) localTranspose = 0;
	multilineVars.localTransposeVerticalMovement = 0;
	multilineVars.localTransposePreferFlats = false;
	var k = keys[keyName];
	if (!k) return multilineVars.key; // If the key isn't in the list, it is non-standard. We won't attempt to transpose it.
	multilineVars.localTranspose = (multilineVars.globalTranspose ? multilineVars.globalTranspose : 0) + localTranspose;

	if (!multilineVars.localTranspose)
		return { accidentals: k, root: root, acc: acc };
	multilineVars.globalTransposeOrigKeySig = k;
	if (multilineVars.localTranspose % 12 === 0) {
		multilineVars.localTransposeVerticalMovement = (multilineVars.localTranspose / 12) * 7;
		return { accidentals: k, root: root, acc: acc };
	}

	var baseKey = keyName[0];
	if (keyName[1] === 'b' || keyName[1] === '#') {
		baseKey += keyName[1];
		keyName = keyName.substr(2);
	} else
		keyName = keyName.substr(1);
	var index = keyIndex[baseKey] + multilineVars.localTranspose;
	while (index < 0) index += 12;
	if (index > 11) index = index % 12;
	var newKeyName = (keyName[0] === 'm' ? newKeyMinor[index] : newKey[index]);
	var transposedKey = newKeyName + keyName;
	var newKeySig = keys[transposedKey];
	if (newKeySig.length > 0 && newKeySig[0].acc === 'flat')
		multilineVars.localTransposePreferFlats = true;
	var distance = transposedKey.charCodeAt(0) - baseKey.charCodeAt(0);
	if (multilineVars.localTranspose > 0) {
		if (distance < 0)
			distance += 7;
		else if (distance === 0) {
			// There's a funny thing that happens when the key changes only an accidental's distance, for instance, from Ab to A.
			// If the distance is positive (we are raising pitch), and the change is higher (that is, Ab -> A), then raise an octave.
			// This test is easier because we know the keys are not equal (or we wouldn't get this far), so if the base key is a flat key, then
			// the transposed key must be higher. Likewise, if the transposed key is sharp, then the base key must be lower. And one
			// of those two things must be true because they are not both natural.
			if (baseKey[1] === '#' ||  transposedKey[1] === 'b')
				distance += 7;
		}
	} else if (multilineVars.localTranspose < 0) {
		if (distance > 0)
			distance -= 7;
		else if (distance === 0) {
			// There's a funny thing that happens when the key changes only an accidental's distance, for instance, from Ab to A.
			// If the distance is negative (we are dropping pitch), and the change is lower (that is, A -> Ab), then drop an octave.
			if (baseKey[1] === 'b' ||  transposedKey[1] === '#')
				distance -= 7;
		}
	}

	if (multilineVars.localTranspose > 0)
		multilineVars.localTransposeVerticalMovement = distance + Math.floor(multilineVars.localTranspose / 12) * 7;
	else
		multilineVars.localTransposeVerticalMovement = distance + Math.ceil(multilineVars.localTranspose / 12) * 7;
	return { accidentals: newKeySig, root: newKeyName[0], acc: newKeyName.length > 1 ? newKeyName[1] : "" };
};

var sharpChords = [ 'C', 'C♯', 'D', "D♯", 'E', 'F', "F♯", 'G', 'G♯', 'A', 'A♯', 'B'];
var flatChords = [ 'C', 'D♭', 'D', 'E♭', 'E', 'F', 'G♭', 'G', 'A♭', 'A', 'B♭', 'B'];

transpose.chordName = function(multilineVars, chord) {
	if (multilineVars.localTranspose && (multilineVars.localTranspose % 12 !== 0)) { // The chords are the same if it is an exact octave change.
		var transposeFactor = multilineVars.localTranspose;
		while (transposeFactor < 0) transposeFactor += 12;
		if (transposeFactor > 11) transposeFactor = transposeFactor % 12;
		chord = chord.replace(/C♭/g, "`~11`");
		chord = chord.replace(/D♭/g, "`~1`");
		chord = chord.replace(/E♭/g, "`~3`");
		chord = chord.replace(/F♭/g, "`~4`");
		chord = chord.replace(/G♭/g, "`~6`");
		chord = chord.replace(/A♭/g, "`~8`");
		chord = chord.replace(/B♭/g, "`~10`");
		chord = chord.replace(/C♯/g, "`~1`");
		chord = chord.replace(/D♯/g, "`~3`");
		chord = chord.replace(/E♯/g, "`~5`");
		chord = chord.replace(/F♯/g, "`~6`");
		chord = chord.replace(/G♯/g, "`~8`");
		chord = chord.replace(/A♯/g, "`~10`");
		chord = chord.replace(/B♯/g, "`~0`");
		chord = chord.replace(/C/g, "`~0`");
		chord = chord.replace(/D/g, "`~2`");
		chord = chord.replace(/E/g, "`~4`");
		chord = chord.replace(/F/g, "`~5`");
		chord = chord.replace(/G/g, "`~7`");
		chord = chord.replace(/A/g, "`~9`");
		chord = chord.replace(/B/g, "`~11`");
		var arr = chord.split("`");
		for (var i = 0; i < arr.length; i++) {
			if (arr[i][0] === '~') {
				var chordNum = parseInt(arr[i].substr(1),10);
				chordNum += transposeFactor;
				if (chordNum > 11) chordNum -= 12;
				arr[i] = multilineVars.localTransposePreferFlats ? flatChords[chordNum] : sharpChords[chordNum];
			}
		}
		chord = arr.join("");
	}
	return chord;
};

var pitchToLetter = [ 'c', 'd', 'e', 'f', 'g', 'a', 'b' ];
function accidentalChange(origPitch, newPitch, accidental, origKeySig, newKeySig) {
	var origPitchLetter = pitchToLetter[(origPitch + 49) % 7]; // Make sure it is a positive pitch before normalizing.
	var origAccidental = 0;
	for (var i = 0; i < origKeySig.length; i++) {
		if (origKeySig[i].note.toLowerCase() === origPitchLetter)
			origAccidental = accidentals[origKeySig[i].acc];
	}

	var currentAccidental = accidentals[accidental];
	var delta = currentAccidental - origAccidental;

	var newPitchLetter = pitchToLetter[(newPitch + 49) % 7]; // Make sure it is a positive pitch before normalizing.
	var newAccidental = 0;
	for (var j = 0; j < newKeySig.accidentals.length; j++) {
		if (newKeySig.accidentals[j].note.toLowerCase() === newPitchLetter)
			newAccidental = accidentals[newKeySig.accidentals[j].acc];
	}
	var calcAccidental = delta + newAccidental;
	if (calcAccidental < -2) {
		newPitch--;
		calcAccidental += (newPitchLetter === 'c' || newPitchLetter === 'f') ? 1 : 2;
	}
	if (calcAccidental > 2) {
		newPitch++;
		calcAccidental -= (newPitchLetter === 'b' || newPitchLetter === 'e') ? 1 : 2;
	}
	return [newPitch, calcAccidental];
}

var accidentals = {
	dblflat: -2,
	flat: -1,
	natural: 0,
	sharp: 1,
	dblsharp: 2
};
var accidentals2 = {
	"-2": "dblflat",
	"-1": "flat",
	"0": "natural",
	"1": "sharp",
	"2": "dblsharp",
};
transpose.note = function(multilineVars, el) {
	// the "el" that is passed in has el.accidental, and el.pitch. "pitch" is the vertical position (0=middle C)
	// localTranspose is the number of half steps
	// localTransposeVerticalMovement is the vertical distance to move.
	if (!multilineVars.localTranspose)
		return;
	var origPitch = el.pitch;
	el.pitch = el.pitch + multilineVars.localTransposeVerticalMovement;

	if (el.accidental) {
		var ret = accidentalChange(origPitch, el.pitch, el.accidental, multilineVars.globalTransposeOrigKeySig, multilineVars.key);
		el.pitch = ret[0];
		el.accidental = accidentals2[ret[1]];
	}

};

module.exports = transpose;

},{}],16:[function(require,module,exports){
//    abc2abc_write.js: Prints an abc file in text format parsed by abc_parse.js
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var TextPrinter = function(elem, reposition) {
    this.elem = elem;
    this.text = "";
    this.l = 1/8;
    this.reposition = reposition || false;
}

TextPrinter.prototype.printString = function(str, elem) {
    if (this.reposition && elem) elem.startChar = this.text.length;
    this.text += str;
    if (this.reposition && elem) elem.endChar = this.text.length;
};

TextPrinter.prototype.printNewLine = function () {
    this.text += "\n";
};

TextPrinter.prototype.printSpace = function () {
    if (this.text[this.text.length-1].match(/\s/)) return; //TODO match whitespace
    this.text += " ";
};

TextPrinter.prototype.printABC = function(abctune) {
    this.text = "";
    this.abctune = abctune;
    //TODO formatting
    this.printHeader();
    this.printBody();
    this.elem.value=this.text;
};

TextPrinter.prototype.printHeader = function() {
    // much of this info is duplicated in metaTextHEaders in abc_parse_header.js
    this.printHeaderLine("x","X","1");
    this.printHeaderLine("title","T");
    this.printHeaderLine("composer","C");
    this.printHeaderLine("history","H");
    this.printHeaderLine("author","A");
    this.printHeaderLine("book","B");  
    this.printHeaderLine("discography","D");  
    this.printHeaderLine("url","F");
    this.printHeaderLine("group","G");
    this.printHeaderLine("instruction","I");
    this.printHeaderLine("notes","N");
    this.printHeaderLine("origin","O");
    this.printHeaderLine("rhythm","R");
    this.printHeaderLine("source","S");
    this.printHeaderLine("unalignedwords","W");
    this.printHeaderLine("transcription","Z");
    //TODO part order
    //TODO Q tempo
    //TODO textBlock
    this.printHeaderLine("NULL","L","1/8"); //TODO L

    this.printHeaderLine("NULL","M",this.getMeterString(this.abctune.lines[0].staff[0].meter));
    this.printHeaderLine("NULL","K",this.getKeyString(this.abctune.lines[0].staff[0].key));//TODO K
};

TextPrinter.prototype.getKeyString = function(key) {
    return key.root+key.acc+key.mode;
};

TextPrinter.prototype.getMeterString = function(meter) {
    switch (meter.type) {
    case "cut_time": return "C|";
    case "common_time": return "C";
    case "specified":
      if (meter.value[0].den)
		return meter.value[0].num+"/"+meter.value[0].den;
      else
	    return meter.value[0].num;
    }
    return "";
};

TextPrinter.prototype.printHeaderLine = function(fieldname, abcfield, defaut) {
    var val = this.abctune.metaText[fieldname] || defaut;
    if (val !== undefined) {
	var valarray = val.split("\n");
	for (var i=0; i<valarray.length; i++) {
	    this.printString(abcfield+": "+valarray[i]);
	    this.printNewLine();
	} 
    }
};

TextPrinter.prototype.getElem = function() {
    if (this.abcline.length <= this.pos)
	return null;
    return this.abcline[this.pos];
};

TextPrinter.prototype.getNextElem = function() {
    if (this.abcline.length <= this.pos+1)
	return null;
    return this.abcline[this.pos+1];
};

TextPrinter.prototype.printBody = function() {
    for(var line=0; line<this.abctune.lines.length; line++) {
	var abcline = this.abctune.lines[line];
	if (abcline.staff) {
	    this.printABCLine(abcline.staff);
	} else if (abcline.subtitle && line!==0) {
	    //TODO
	} else if (abcline.text) {
	    //TODO
	}
    }
};

TextPrinter.prototype.printABCLine = function(staffs) {
    for (this.s = 0; this.s < staffs.length; this.s++) {
	this.printABCStaff(staffs[this.s]);
    }
};

TextPrinter.prototype.printABCStaff = function(abcstaff) {
    
    // TODO if (abcstaff.bracket) header += "bracket "+abcstaff.bracket+" ";
    // TODO if (abcstaff.brace) header += "brace "+abcstaff.brace+" ";
    
    
    for (this.v = 0; this.v < abcstaff.voices.length; this.v++) {
	// TODO stuff about voices
	
	// TODO this is where key sig is this.voice.addChild(this.printClef(abcstaff.clef));
	// this.voice.addChild(this.printKeySignature(abcstaff.key));
	// if (abcstaff.meter) this.voice.addChild(this.printTimeSignature(abcstaff.meter));
	this.printABCVoice(abcstaff.voices[this.v]);
    }
    
};

TextPrinter.prototype.printABCVoice = function(abcline) {
    this.abcline = abcline;
    for (this.pos=0; this.pos<this.abcline.length; this.pos++) {
	this.printABCElement();
    }
    this.printNewLine();
};

TextPrinter.prototype.printABCElement = function() {
    var elem = this.getElem();
    switch (elem.el_type) {
    case "note":
	this.printBeam();
	break;
    case "bar":
	this.printBarLine(elem);
	break;
    case "meter":
	//TODO this.printTimeSignature(elem);
	break;
    case "clef":
	//TODO this.printClef(elem);
	break;
    case "key":
	//TODO this.printKeySignature(elem);
    case "stem":
	//TODO do nothing?
	break;
    case "part":
	//TODO print part
	break;
    default:
	//TODO show we're missing something
    }
};

TextPrinter.prototype.printBeam = function() {
    this.printSpace();
    if (this.getElem().startBeam && !this.getElem().endBeam) {
	while (this.getElem()) {
	    this.printNote(this.getElem());
	    if (this.getElem().endBeam) {
		break;
	    }
	    this.pos++;
	}
    } else {
	this.printNote(this.getElem());
    }
    this.printSpace();
};

TextPrinter.prototype.printNote = function(elem) {
    var str = "";
	var i;
    if (elem.chord !== undefined) {
	for (i=0; i<elem.chord.length; i++) {
	    str+= '"'+elem.chord[i].name+'"';
	}
    }
    
    //TODO unify map between names and symbols (to be used with abcparse?)
    var decorations = {
	"staccato" : ".",
	"upbow" : "u",
	"downbow" : "v",
	"roll" : "~",
	"fermata" : "H",
	"slide" : "J",
	"accent" : "L",
	"mordent" : "M",
	"pralltriller" : "P",
	"trill" : "T",
	"lower" : "."
    };

    if (elem.decoration !== undefined) {
	for (i=0; i<elem.decoration.length; i++) {
	    var dec = elem.decoration[i];
	    if (decorations[dec]) {
		str+=decorations[dec];
	    } else {
		str+="!"; //TODO hardcoded
		str+=dec;
		str+="!"; //TODO hardcoded
	    }
	}
    }

    if (elem.gracenotes !== undefined) {
	str+="{";
	for (i=0; i<elem.gracenotes.length; i++) {
	    str+=this.getNoteString(elem.gracenotes[i]);
	}
	str+="}";
    }

    var ignoreslur = false;
    if (elem.pitches.length === 1 && elem.pitches[0].startSlur) {
	ignoreslur = true;
	str+=this.multiplyString("(",elem.pitches[0].startSlur.length);
    }

    if (elem.startSlur) {
	str+=this.multiplyString("(",elem.startSlur.length);
    }

    if ((elem.pitches.length === 1 && elem.pitches[0].endSlur) || elem.endSlur) {
	ignoreslur = true;
    }

    if (elem.startTriplet) {
	str+="(3";
    }

    if (elem.pitches) {
	if (elem.pitches.length > 1) str+="[";
	for (i=0; i<elem.pitches.length; i++) {
	    elem.pitches[i].duration = elem.duration;
	    str+=this.getNoteString(elem.pitches[i], ignoreslur);
	}
	if (elem.pitches.length > 1) str+="]";
    } 

    if (elem.pitches.length === 1 && elem.pitches[0].endSlur) {
	str+=this.multiplyString(")",elem.pitches[0].endSlur.length);
    }

    if (elem.endSlur) {
	str+=this.multiplyString(")",elem.endSlur.length);
    }

    this.printString(str,elem);

};

// accidentals, ties and sometimes slurs, sometimes duration
TextPrinter.prototype.getNoteString = function(pitchelem, ignoreslur) {
    var str = "";
    if (!ignoreslur && pitchelem.startSlur) {
	str+="(";
    }

    var symb = "";
    switch (pitchelem.accidental) {
    case "quartersharp":
	symb = "^/";
	break;
    case "dblsharp":
	symb = "^^";
	break;
    case "sharp":
	symb = "^";
	break;
    case "quarterflat":
	symb = "_/";
	break;
    case "flat":
	symb = "_";
	break;
    case "dblflat":
	symb = "__";
	break;
    case "natural":
	symb = "=";
    }
    str+=symb;

    var pitches = ["C","D","E","F","G","A","B"];
    var pitchstr = pitches[this.extractNote(pitchelem.pitch)];
    var octave = this.extractOctave(pitchelem.pitch);
    if (octave>0) {
	pitchstr = pitchstr.toLowerCase();
	octave--;
	while (octave>0) {
	    pitchstr+="'";
	    octave--;
	}
    } else {
	while (octave<0) {
	    pitchstr+=",";
	    octave++;
	}
    }
    
    str+=pitchstr;
    
    if (pitchelem.duration) {
	str+=this.getDurationString(pitchelem.duration);
    }

    if (!ignoreslur && pitchelem.endSlur) {
	str+=")";
    }

    if (pitchelem.startTie) {
	str+="-";
    }

    return str;
};

TextPrinter.prototype.getDurationString = function(duration) {
    //TODO detect crooked rhythm
    if (duration/this.l > 1) {
	return duration/this.l;
    } 
    var ret = "";
    if (this.l/duration>1) {
	ret+="/";
	if (this.l/duration>2) {
	    ret+=this.l/duration;
	}   
    }
    return ret;
};

TextPrinter.prototype.extractNote = function(pitch) {
    var pitch2 = pitch%7;
    if (pitch2<0) pitch2+=7;
    return pitch2;
};

TextPrinter.prototype.extractOctave = function(pitch) {
    return Math.floor(pitch/7);
};

TextPrinter.prototype.printBarLine = function(elem) {
    var barstr = "";
    switch (elem.type) {
    case "bar_thin": barstr+="|"; break;
    case "bar_thin_thick": barstr+="|]"; break;
    case "bar_thin_thin": barstr+="||"; break;
    case "bar_thick_thin": barstr+="[|"; break;
    case "bar_dbl_repeat": barstr+=":||:"; break;
    case "bar_left_repeat": barstr+="|:"; break;
    case "bar_right_repeat": barstr+=":|"; break;
    case "bar_invisible": barstr+=""; break;
    }
    this.printString(barstr,elem);
};

TextPrinter.prototype.multiplyString = function (s, n) {
    var ret = "";
    for (;n>0;n--) ret+=s;
    return ret;
};

module.exports = TextPrinter;

},{}],17:[function(require,module,exports){
//    abc_absolute_element.js: Definition of the AbsoluteElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var spacing = require('./abc_spacing');

// duration - actual musical duration - different from notehead duration in triplets. refer to abcelem to get the notehead duration
// minspacing - spacing which must be taken on top of the width defined by the duration
// type is a meta-type for the element. It is not necessary for drawing, but it is useful to make semantic sense of the element. For instance, it can be used in the element's class name.
var AbsoluteElement = function AbsoluteElement(abcelem, duration, minspacing, type, tuneNumber, options) {
	//console.log("Absolute:",abcelem, type);
	if (!options)
		options = {};
	this.tuneNumber = tuneNumber;
	this.abcelem = abcelem;
	this.duration = duration;
	this.durationClass = options.durationClassOveride ? options.durationClassOveride : this.duration;
	this.minspacing = minspacing || 0;
	this.x = 0;
	this.children = [];
	this.heads = [];
	this.extra = [];
	this.extraw = 0;
	//this.decs = [];
	this.w = 0;
	this.right = [];
	this.invisible = false;
	this.bottom = undefined;
	this.top = undefined;
	this.type = type;
	// these are the heights of all of the vertical elements that can't be placed until the end of the line.
	// the vertical order of elements that are above is: tempo, part, volume/dynamic, ending/chord, lyric
	// the vertical order of elements that are below is: lyric, chord, volume/dynamic
	this.specialY = {
		tempoHeightAbove: 0,
		partHeightAbove: 0,
		volumeHeightAbove: 0,
		dynamicHeightAbove: 0,
		endingHeightAbove: 0,
		chordHeightAbove: 0,
		lyricHeightAbove: 0,

		lyricHeightBelow: 0,
		chordHeightBelow: 0,
		volumeHeightBelow: 0,
		dynamicHeightBelow: 0
	};
};

// For each of the relative elements that can't be placed in advance (because their vertical placement depends on everything
// else on the line), this iterates through them and sets their pitch. By the time this is called, specialYResolved contains a
// hash with the vertical placement (in pitch units) for each type.
// TODO-PER: I think this needs to be separated by "above" and "below". How do we know that for dynamics at the point where they are being defined, though? We need a pass through all the relative elements to set "above" and "below".
AbsoluteElement.prototype.setUpperAndLowerElements = function(specialYResolved) {
	// specialYResolved contains the actual pitch for each of the classes of elements.
	for (var i = 0; i < this.children.length; i++) {
		var child = this.children[i];
		for (var key in this.specialY) { // for each class of element that needs to be placed vertically
			if (this.specialY.hasOwnProperty(key)) {
				if (child[key]) { // If this relative element has defined a height for this class of element
					child.pitch = specialYResolved[key];
					if (child.top === undefined) { // TODO-PER: HACK! Not sure this is the right place to do this.
						child.setUpperAndLowerElements(specialYResolved);
						this.pushTop(child.top);
						this.pushBottom(child.bottom);
					}
				}
			}
		}
	}
};

AbsoluteElement.prototype.getMinWidth = function () { // absolute space taken to the right of the note
	return this.w;
};

AbsoluteElement.prototype.getExtraWidth = function () { // space needed to the left of the note
	return -this.extraw;
};

AbsoluteElement.prototype.addExtra = function (extra) {
	if (extra.dx<this.extraw) this.extraw = extra.dx;
	this.extra[this.extra.length] = extra;
	this.addChild(extra);
};

AbsoluteElement.prototype.addHead = function (head) {
	if (head.dx<this.extraw) this.extraw = head.dx;
	this.heads[this.heads.length] = head;
	this.addRight(head);
};

AbsoluteElement.prototype.addRight = function (right) {
	if (right.dx+right.w>this.w) this.w = right.dx+right.w;
	this.right[this.right.length] = right;
	this.addChild(right);
};

AbsoluteElement.prototype.addCentered = function (elem) {
	var half = elem.w/2;
	if (-half<this.extraw) this.extraw = -half;
	this.extra[this.extra.length] = elem;
	if (elem.dx+half>this.w) this.w = elem.dx+half;
	this.right[this.right.length] = elem;
	this.addChild(elem);
};

AbsoluteElement.prototype.setLimit = function(member, child) {
	if (!child[member]) return;
	if (!this.specialY[member])
		this.specialY[member] = child[member];
	else
		this.specialY[member] = Math.max(this.specialY[member], child[member]);
};

AbsoluteElement.prototype.addChild = function (child) {
	//console.log("Relative:",child);
	child.parent = this;
	this.children[this.children.length] = child;
	this.pushTop(child.top);
	this.pushBottom(child.bottom);
	this.setLimit('tempoHeightAbove', child);
	this.setLimit('partHeightAbove', child);
	this.setLimit('volumeHeightAbove', child);
	this.setLimit('dynamicHeightAbove', child);
	this.setLimit('endingHeightAbove', child);
	this.setLimit('chordHeightAbove', child);
	this.setLimit('lyricHeightAbove', child);
	this.setLimit('lyricHeightBelow', child);
	this.setLimit('chordHeightBelow', child);
	this.setLimit('volumeHeightBelow', child);
	this.setLimit('dynamicHeightBelow', child);
};

AbsoluteElement.prototype.pushTop = function (top) {
	if (top !== undefined) {
		if (this.top === undefined)
			this.top = top;
		else
			this.top = Math.max(top, this.top);
	}
};

AbsoluteElement.prototype.pushBottom = function (bottom) {
	if (bottom !== undefined) {
		if (this.bottom === undefined)
			this.bottom = bottom;
		else
			this.bottom = Math.min(bottom, this.bottom);
	}
};

AbsoluteElement.prototype.setX = function (x) {
	this.x = x;
	for (var i=0; i<this.children.length; i++)
		this.children[i].setX(x);
};

AbsoluteElement.prototype.setHint = function () {
	this.hint = true;
};

AbsoluteElement.prototype.draw = function (renderer, bartop) {
	if (this.invisible) return;
	this.elemset = [];
	renderer.beginGroup();
	for (var i=0; i<this.children.length; i++) {
		if (/*ABCJS.write.debugPlacement*/false) {
			if (this.children[i].klass === 'ornament')
				renderer.printShadedBox(this.x, renderer.calcY(this.children[i].top), this.w, renderer.calcY(this.children[i].bottom)-renderer.calcY(this.children[i].top), "rgb(0,0,200)", 0.3);
		}
		var el = this.children[i].draw(renderer,bartop);
		if (el)
			this.elemset.push(el);
	}
	var klass = this.type;
	if (this.type === 'note' || this.type === 'rest') {
		klass += ' d' + this.durationClass;
		klass = klass.replace(/\./g, '-');
		if (this.abcelem.pitches) {
			for (var j = 0; j < this.abcelem.pitches.length; j++) {
				klass += ' p' + this.abcelem.pitches[j].pitch;
			}
		}
	}
	var g = renderer.endGroup(klass);
	if (g)
		this.elemset.push(g);
	if (this.klass)
		this.setClass("mark", "", "#00ff00");
	if (this.hint)
		this.setClass("abcjs-hint", "", null);
	var opacity = /*ABCJS.write.debugPlacement*/false ? 0.3 : 0; // Create transparent box that encompasses the element, and not so transparent to debug it.
	var target = renderer.printShadedBox(this.x, renderer.calcY(this.top), this.w, renderer.calcY(this.bottom)-renderer.calcY(this.top), "#000000", opacity);
	var self = this;
	var controller = renderer.controller;
	target.addEventListener('mouseup', function () {
		var classes = [];
		if (self.elemset) {
			for (var j = 0; j < self.elemset.length; j++) {
				var es = self.elemset[j];
				if (es)
					classes.push(es.getAttribute("class"));
			}
		}
		controller.notifySelect(self, self.tuneNumber, classes);
	});
	this.abcelem.abselem = this;

	var step = spacing.STEP;
};

AbsoluteElement.prototype.isIE=/*@cc_on!@*/false;//IE detector

AbsoluteElement.prototype.setClass = function (addClass, removeClass, color) {
	for (var i = 0; i < this.elemset.length; i++) {
		var el = this.elemset[i];
		el.setAttribute("fill", color);
		var kls = el.getAttribute("class");
		if (!kls) kls = "";
		kls = kls.replace(removeClass, "");
		kls = kls.replace(addClass, "");
		if (addClass.length > 0) {
			if (kls.length > 0 && kls.charAt(kls.length - 1) !== ' ') kls += " ";
			kls += addClass;
		}
		el.setAttribute("class", kls);
	}
};

AbsoluteElement.prototype.highlight = function (klass, color) {
	if (klass === undefined)
		klass = "abcjs-note_selected";
	if (color === undefined)
		color = "#ff0000";
	this.setClass(klass, "", color);
};

AbsoluteElement.prototype.unhighlight = function (klass, color) {
	if (klass === undefined)
		klass = "abcjs-note_selected";
	if (color === undefined)
		color = "#000000";
	this.setClass("", klass, color);
};

module.exports = AbsoluteElement;

},{"./abc_spacing":32}],18:[function(require,module,exports){
// abc_abstract_engraver.js: Creates a data structure suitable for printing a line of abc
// Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var AbsoluteElement = require('./abc_absolute_element');
var BeamElem = require('./abc_beam_element');
var BraceElem = require('./abc_brace_element');
var createClef = require('./abc_create_clef');
var createKeySignature = require('./abc_create_key_signature');
var createTimeSignature = require('./abc_create_time_signature');
var Decoration = require('./abc_decoration');
var EndingElem = require('./abc_ending_element');
var glyphs = require('./abc_glyphs');
var RelativeElement = require('./abc_relative_element');
var spacing = require('./abc_spacing');
var StaffGroupElement = require('./abc_staff_group_element');
var TempoElement = require('./abc_tempo_element');
var TieElem = require('./abc_tie_element');
var TripletElem = require('./abc_triplet_element');
var VoiceElement = require('./abc_voice_element');

var parseCommon = require('../parse/abc_common');

var AbstractEngraver;

(function() {
	"use strict";

var getDuration = function(elem) {
  var d = 0;
  if (elem.duration) {
    d = elem.duration;
  }
  return d;
};

var hint = false;

	var chartable = {
		rest:{0:"rests.whole", 1:"rests.half", 2:"rests.quarter", 3:"rests.8th", 4: "rests.16th",5: "rests.32nd", 6: "rests.64th", 7: "rests.128th", "multi": "rests.multimeasure"},
		note:{"-1": "noteheads.dbl", 0:"noteheads.whole", 1:"noteheads.half", 2:"noteheads.quarter", 3:"noteheads.quarter", 4:"noteheads.quarter", 5:"noteheads.quarter", 6:"noteheads.quarter", 7:"noteheads.quarter", 'nostem':"noteheads.quarter"},
		rhythm:{"-1": "noteheads.slash.whole", 0:"noteheads.slash.whole", 1:"noteheads.slash.whole", 2:"noteheads.slash.quarter", 3:"noteheads.slash.quarter", 4:"noteheads.slash.quarter", 5:"noteheads.slash.quarter", 6:"noteheads.slash.quarter", 7:"noteheads.slash.quarter", nostem: "noteheads.slash.nostem"},
		x:{"-1": "noteheads.indeterminate", 0:"noteheads.indeterminate", 1:"noteheads.indeterminate", 2:"noteheads.indeterminate", 3:"noteheads.indeterminate", 4:"noteheads.indeterminate", 5:"noteheads.indeterminate", 6:"noteheads.indeterminate", 7:"noteheads.indeterminate", nostem: "noteheads.indeterminate"},
		harmonic:{"-1": "noteheads.harmonic.quarter", 0:"noteheads.harmonic.quarter", 1:"noteheads.harmonic.quarter", 2:"noteheads.harmonic.quarter", 3:"noteheads.harmonic.quarter", 4:"noteheads.harmonic.quarter", 5:"noteheads.harmonic.quarter", 6:"noteheads.harmonic.quarter", 7:"noteheads.harmonic.quarter", nostem: "noteheads.harmonic.quarter"},
		uflags:{3:"flags.u8th", 4:"flags.u16th", 5:"flags.u32nd", 6:"flags.u64th"},
		dflags:{3:"flags.d8th", 4:"flags.d16th", 5:"flags.d32nd", 6:"flags.d64th"}
	};

AbstractEngraver = function(bagpipes, renderer, tuneNumber) {
	this.decoration = new Decoration();
	this.renderer = renderer;
	this.tuneNumber = tuneNumber;
  this.isBagpipes = bagpipes;
	this.reset();
};

AbstractEngraver.prototype.reset = function() {
	this.slurs = {};
	this.ties = [];
	this.slursbyvoice = {};
	this.tiesbyvoice = {};
	this.endingsbyvoice = {};
	this.tripletmultiplier = 1;

	this.abcline = undefined;
	this.accidentalSlot = undefined;
	this.accidentalshiftx = undefined;
	this.dotshiftx = undefined;
	this.hasVocals = false;
	this.minY = undefined;
	this.partstartelem = undefined;
	this.startlimitelem = undefined;
	this.stemdir = undefined;
};

AbstractEngraver.prototype.setStemHeight = function(heightInPixels) {
	this.stemHeight = heightInPixels / spacing.STEP;
};

AbstractEngraver.prototype.getCurrentVoiceId = function(s,v) {
  return "s"+s+"v"+v;
};

AbstractEngraver.prototype.pushCrossLineElems = function(s,v) {
  this.slursbyvoice[this.getCurrentVoiceId(s,v)] = this.slurs;
  this.tiesbyvoice[this.getCurrentVoiceId(s,v)] = this.ties;
  this.endingsbyvoice[this.getCurrentVoiceId(s,v)] = this.partstartelem;
};

AbstractEngraver.prototype.popCrossLineElems = function(s,v) {
  this.slurs = this.slursbyvoice[this.getCurrentVoiceId(s,v)] || {};
  this.ties = this.tiesbyvoice[this.getCurrentVoiceId(s,v)] || [];
  this.partstartelem = this.endingsbyvoice[this.getCurrentVoiceId(s,v)];
};

	AbstractEngraver.prototype.containsLyrics = function(staves) {
		for (var i = 0; i < staves.length; i++) {
			for (var j = 0; j < staves[i].voices.length; j++) {
				for (var k = 0; k < staves[i].voices[j].length; k++) {
					var el = staves[i].voices[j][k];
					if (el.lyric) {
						// We just want to see if there are vocals below the music to know where to put the dynamics.
						if (!el.positioning || el.positioning.vocalPosition === 'below')
							this.hasVocals = true;
						return;
					}
				}
			}
		}
	};

AbstractEngraver.prototype.createABCLine = function(staffs, tempo) {
    this.minY = 2; // PER: This will be the lowest that any note reaches. It will be used to set the dynamics row.
	// See if there are any lyrics on this line.
	this.containsLyrics(staffs);
  var staffgroup = new StaffGroupElement();
	this.tempoSet = false;
  for (var s = 0; s < staffs.length; s++) {
	  if (hint)
		  this.restoreState();
	  hint = false;
    this.createABCStaff(staffgroup, staffs[s], tempo, s);
  }
  return staffgroup;
};

AbstractEngraver.prototype.createABCStaff = function(staffgroup, abcstaff, tempo, s) {
// If the tempo is passed in, then the first element should get the tempo attached to it.
  for (var v = 0; v < abcstaff.voices.length; v++) {
    var voice = new VoiceElement(v,abcstaff.voices.length);
    if (v===0) {
	    voice.barfrom = (abcstaff.connectBarLines==="start" || abcstaff.connectBarLines==="continue");
	    voice.barto = (abcstaff.connectBarLines==="continue" || abcstaff.connectBarLines==="end");
    } else {
	    voice.duplicate = true; // bar lines and other duplicate info need not be created
    }
    if (abcstaff.title && abcstaff.title[v]) voice.header=abcstaff.title[v];
	  var clef = createClef(abcstaff.clef, this.tuneNumber);
	  if (clef) {
		  if (v ===0 && abcstaff.barNumber) {
			  this.addMeasureNumber(abcstaff.barNumber, clef);
		  }
		  voice.addChild(clef);
	  }
	  var keySig = createKeySignature(abcstaff.key, this.tuneNumber);
	  if (keySig) {
		  voice.addChild(keySig);
		  this.startlimitelem = keySig; // limit ties here
	  }
    if (abcstaff.meter) {
		var ts = createTimeSignature(abcstaff.meter, this.tuneNumber);
	    voice.addChild(ts);
		this.startlimitelem = ts; // limit ties here
	}
	  if (voice.duplicate)
		  voice.children = []; // we shouldn't reprint the above if we're reusing the same staff. We just created them to get the right spacing.
    var staffLines = abcstaff.clef.stafflines || abcstaff.clef.stafflines === 0 ? abcstaff.clef.stafflines : 5;
    staffgroup.addVoice(voice,s,staffLines);
	  var isSingleLineStaff = staffLines === 1;
	  this.createABCVoice(abcstaff.voices[v],tempo, s, v, isSingleLineStaff, voice);
	  staffgroup.setStaffLimits(voice);
            //Tony: Here I am following what staves need to be surrounded by the brace, by incrementing the length of the brace class.
            //So basically this keeps incrementing the number of staff surrounded by the brace until it sees "end".
            //This then gets processed in abc_staff_group_element.js, so that it will have the correct top and bottom coordinates for the brace.
			if(abcstaff.brace === "start"){
				staffgroup.brace = new BraceElem(1, true);
			}
			else if(abcstaff.brace === "end" && staffgroup.brace) {
				staffgroup.brace.increaseStavesIncluded();
			}
			else if(abcstaff.brace === "continue" && staffgroup.brace){
				staffgroup.brace.increaseStavesIncluded();
			}
  }
};

function getBeamGroup(abcline, pos) {
	// If there are notes beamed together, they are handled as a group, so find all of them here.
	var elem = abcline[pos];
	if (elem.el_type !== 'note' || !elem.startBeam || elem.endBeam)
		return { count: 1, elem: elem };

	var group = [];
	while (pos < abcline.length && abcline[pos].el_type === 'note') {
		group.push(abcline[pos]);
		if (abcline[pos].endBeam)
			break;
		pos++;
	}
	return { count: group.length, elem: group };
}

AbstractEngraver.prototype.createABCVoice = function(abcline, tempo, s, v, isSingleLineStaff, voice) {
  this.popCrossLineElems(s,v);
  this.stemdir = (this.isBagpipes)?"down":null;
  this.abcline = abcline;
  if (this.partstartelem) {
    this.partstartelem = new EndingElem("", null, null);
	  voice.addOther(this.partstartelem);
  }
  for (var slur in this.slurs) {
    if (this.slurs.hasOwnProperty(slur)) {
      this.slurs[slur]= new TieElem(null, null, this.slurs[slur].above, this.slurs[slur].force, false);
		if (hint) this.slurs[slur].setHint();
	    voice.addOther(this.slurs[slur]);
    }
  }
  for (var i=0; i<this.ties.length; i++) {
    this.ties[i]=new TieElem(null, null, this.ties[i].above, this.ties[i].force, true);
	  if (hint) this.ties[i].setHint();
	  voice.addOther(this.ties[i]);
  }

  for (var j = 0; j < this.abcline.length; j++) {
	  setAveragePitch(this.abcline[j]);
	  this.minY = Math.min(this.abcline[j].minpitch, this.minY);
  }

	var isFirstStaff = (s === 0);
	var pos = 0;
	while (pos < this.abcline.length) {
		var ret = getBeamGroup(this.abcline, pos);
		var abselems = this.createABCElement(isFirstStaff, isSingleLineStaff, voice, ret.elem);
		if (abselems) {
			for (i = 0; i < abselems.length; i++) {
				if (!this.tempoSet && tempo && !tempo.suppress) {
					this.tempoSet = true;
					abselems[i].addChild(new TempoElement(tempo, this.tuneNumber, createNoteHead));
				}
				voice.addChild(abselems[i]);
			}
		}
		pos += ret.count;
	}
	this.pushCrossLineElems(s, v);
};

	AbstractEngraver.prototype.saveState = function() {
		this.tiesSave = parseCommon.cloneArray(this.ties);
		this.slursSave = parseCommon.cloneHashOfHash(this.slurs);
		this.slursbyvoiceSave = parseCommon.cloneHashOfHash(this.slursbyvoice);
		this.tiesbyvoiceSave = parseCommon.cloneHashOfArrayOfHash(this.tiesbyvoice);
	};

	AbstractEngraver.prototype.restoreState = function() {
		this.ties = parseCommon.cloneArray(this.tiesSave);
		this.slurs = parseCommon.cloneHashOfHash(this.slursSave);
		this.slursbyvoice = parseCommon.cloneHashOfHash(this.slursbyvoiceSave);
		this.tiesbyvoice = parseCommon.cloneHashOfArrayOfHash(this.tiesbyvoiceSave);
	};

	// function writeMeasureWidth(voice) {
	// 	var width = 0;
	// 	for (var i = voice.children.length-1; i >= 0; i--) {
	// 		var elem = voice.children[i];
	// 		if (elem.abcelem.el_type === 'bar')
	// 			break;
	// 		width += elem.w;
	// 	}
	// 	return new RelativeElement(width.toFixed(2), -70, 0, undefined, {type:"debug"});
	// }

	// return an array of AbsoluteElement
AbstractEngraver.prototype.createABCElement = function(isFirstStaff, isSingleLineStaff, voice, elem) {
  var elemset = [];
  switch (elem.el_type) {
	  case undefined:
	  	// it is undefined if we were passed an array in - an array means a set of notes that should be beamed together.
		  elemset = this.createBeam(isSingleLineStaff, voice, elem);
	  	break;
  case "note":
	  elemset[0] = this.createNote(elem, false, isSingleLineStaff, voice);
	  if (this.triplet && this.triplet.isClosed()) {
		  voice.addOther(this.triplet);
		  this.triplet = null;
		  this.tripletmultiplier = 1;
	  }
    break;
  case "bar":
    elemset[0] = this.createBarLine(voice, elem, isFirstStaff);
    if (voice.duplicate && elemset.length > 0) elemset[0].invisible = true;
//	  elemset[0].addChild(writeMeasureWidth(voice));
    break;
  case "meter":
    elemset[0] = createTimeSignature(elem, this.tuneNumber);
	  this.startlimitelem = elemset[0]; // limit ties here
    if (voice.duplicate && elemset.length > 0) elemset[0].invisible = true;
    break;
  case "clef":
    elemset[0] = createClef(elem, this.tuneNumber);
	  if (!elemset[0]) return null;
    if (voice.duplicate && elemset.length > 0) elemset[0].invisible = true;
    break;
  case "key":
	  var absKey = createKeySignature(elem, this.tuneNumber);
	  if (absKey) {
		  elemset[0] = absKey;
		  this.startlimitelem = elemset[0]; // limit ties here
	  }
    if (voice.duplicate && elemset.length > 0) elemset[0].invisible = true;
    break;
  case "stem":
    this.stemdir=elem.direction;
    break;
  case "part":
    var abselem = new AbsoluteElement(elem,0,0, 'part', this.tuneNumber);
	  var dim = this.renderer.getTextSize(elem.title, 'partsfont', "part");
    abselem.addChild(new RelativeElement(elem.title, 0, 0, undefined, {type:"part", height: dim.height/spacing.STEP}));
    elemset[0] = abselem;
    break;
  case "tempo":
    var abselem3 = new AbsoluteElement(elem,0,0, 'tempo', this.tuneNumber);
    abselem3.addChild(new TempoElement(elem, this.tuneNumber, createNoteHead));
    elemset[0] = abselem3;
    break;
	  case "style":
		  if (elem.head === "normal")
			  delete this.style;
		  else
			  this.style = elem.head;
		  break;
	  case "hint":
		  hint = true;
		  this.saveState();
		  break;
	  case "midi":
		// This has no effect on the visible music, so just skip it.
		break;

  default:
    var abselem2 = new AbsoluteElement(elem,0,0, 'unsupported', this.tuneNumber);
    abselem2.addChild(new RelativeElement("element type "+elem.el_type, 0, 0, undefined, {type:"debug"}));
    elemset[0] = abselem2;
  }

  return elemset;
};

	function setAveragePitch(elem) {
		if (elem.pitches) {
			sortPitch(elem);
			var sum = 0;
			for (var p = 0; p < elem.pitches.length; p++) {
				sum += elem.pitches[p].verticalPos;
			}
			elem.averagepitch = sum / elem.pitches.length;
			elem.minpitch = elem.pitches[0].verticalPos;
			elem.maxpitch = elem.pitches[elem.pitches.length - 1].verticalPos;
		}
	}

	AbstractEngraver.prototype.calcBeamDir = function (isSingleLineStaff, voice, elems) {
		if (this.stemdir) // If the user or voice is forcing the stem direction, we already know the answer.
			return this.stemdir;
		var beamelem = new BeamElem(this.stemHeight, this.stemdir);
		for (var i = 0; i < elems.length; i++) {
			beamelem.add({abcelem: elems[i]}); // This is a hack to call beam elem with just a minimum of processing: for our purposes, we don't need to construct the whole note.
		}

		var dir = beamelem.calcDir();
		return dir ? "up" : "down";
	};

	AbstractEngraver.prototype.createBeam = function (isSingleLineStaff, voice, elems) {
		var abselemset = [];

		var dir = this.calcBeamDir(isSingleLineStaff, voice, elems);
		var beamelem = new BeamElem(this.stemHeight, dir);
		if (hint) beamelem.setHint();
		var oldDir = this.stemdir;
		this.stemdir = dir;
		for (var i = 0; i < elems.length; i++) {
			var elem = elems[i];
			var abselem = this.createNote(elem, true, isSingleLineStaff, voice);
			abselemset.push(abselem);
			beamelem.add(abselem);
			if (this.triplet && this.triplet.isClosed()) {
				voice.addOther(this.triplet);
				this.triplet = null;
				this.tripletmultiplier = 1;
			}
		}
		this.stemdir = oldDir;
		voice.addBeam(beamelem);
		return abselemset;
	};

var sortPitch = function(elem) {
  var sorted;
  do {
    sorted = true;
    for (var p = 0; p<elem.pitches.length-1; p++) {
      if (elem.pitches[p].pitch>elem.pitches[p+1].pitch) {
        sorted = false;
        var tmp = elem.pitches[p];
        elem.pitches[p] = elem.pitches[p+1];
        elem.pitches[p+1] = tmp;
      }
    }
  } while (!sorted);
};

var ledgerLines = function(abselem, minPitch, maxPitch, isRest, symbolWidth, additionalLedgers, dir, dx, scale) {
	for (var i=maxPitch; i>11; i--) {
		if (i%2===0 && !isRest) {
			abselem.addChild(new RelativeElement(null, dx, (symbolWidth+4)*scale, i, {type:"ledger"}));
		}
	}

	for (i=minPitch; i<1; i++) {
		if (i%2===0 && !isRest) {
			abselem.addChild(new RelativeElement(null, dx, (symbolWidth+4)*scale, i, {type:"ledger"}));
		}
	}

	for (i = 0; i < additionalLedgers.length; i++) { // PER: draw additional ledgers
		var ofs = symbolWidth;
		if (dir === 'down') ofs = -ofs;
		abselem.addChild(new RelativeElement(null, ofs+dx, (symbolWidth+4)*scale, additionalLedgers[i], {type:"ledger"}));
	}
};

	AbstractEngraver.prototype.addGraceNotes = function (elem, voice, abselem, notehead, stemHeight, isBagpipes, roomtaken) {
		var gracescale = 3 / 5;
		var graceScaleStem = 3.5 / 5; // TODO-PER: empirically found constant.
		var gracebeam = null;
		var flag;

		if (elem.gracenotes.length > 1) {
			gracebeam = new BeamElem(stemHeight * graceScaleStem, "grace", isBagpipes);
			if (hint) gracebeam.setHint();
			gracebeam.mainNote = abselem;	// this gives us a reference back to the note this is attached to so that the stems can be attached somewhere.
		}

		var graceoffsets = [];
		for (i = elem.gracenotes.length - 1; i >= 0; i--) { // figure out where to place each gracenote
			roomtaken += 10;
			graceoffsets[i] = roomtaken;
			if (elem.gracenotes[i].accidental) {
				roomtaken += 7;
			}
		}

		var i;
		for (i = 0; i < elem.gracenotes.length; i++) {
			var gracepitch = elem.gracenotes[i].verticalPos;

			flag = (gracebeam) ? null : chartable.uflags[(isBagpipes) ? 5 : 3];
			var accidentalSlot = [];
			var ret = createNoteHead(abselem, "noteheads.quarter", elem.gracenotes[i], "up", -graceoffsets[i], -graceoffsets[i], flag, 0, 0, gracescale, accidentalSlot);
			var grace = ret.notehead;
			this.addSlursAndTies(abselem, elem.gracenotes[i], grace, voice, "up");

			abselem.addExtra(grace);
			// PER: added acciaccatura slash
			if (elem.gracenotes[i].acciaccatura) {
				var pos = elem.gracenotes[i].verticalPos + 7 * gracescale;        // the same formula that determines the flag position.
				var dAcciaccatura = gracebeam ? 5 : 6;        // just an offset to make it line up correctly.
				abselem.addRight(new RelativeElement("flags.ugrace", -graceoffsets[i] + dAcciaccatura, 0, pos, {scalex: gracescale, scaley: gracescale}));
			}
			if (gracebeam) { // give the beam the necessary info
				var graceDuration = elem.gracenotes[i].duration / 2;
				if (isBagpipes) graceDuration /= 2;
				var pseudoabselem = {
					heads: [grace],
					abcelem: {averagepitch: gracepitch, minpitch: gracepitch, maxpitch: gracepitch, duration: graceDuration}
				};
				gracebeam.add(pseudoabselem);
			} else { // draw the stem
				var p1 = gracepitch + 1 / 3 * gracescale;
				var p2 = gracepitch + 7 * gracescale;
				var dx = grace.dx + grace.w;
				var width = -0.6;
				abselem.addExtra(new RelativeElement(null, dx, 0, p1, {"type": "stem", "pitch2": p2, linewidth: width}));
			}
			ledgerLines(abselem, gracepitch, gracepitch, false, glyphs.getSymbolWidth("noteheads.quarter"), [], true, grace.dx - 1, 0.6);

			if (i === 0 && !isBagpipes && !(elem.rest && (elem.rest.type === "spacer" || elem.rest.type === "invisible"))) {
				var isTie = (elem.gracenotes.length === 1 && grace.pitch === notehead.pitch);
				voice.addOther(new TieElem(grace, notehead, false, true, isTie));
			}
		}

		if (gracebeam) {
			voice.addBeam(gracebeam);
		}
		return roomtaken;
	};

	function addRestToAbsElement(abselem, elem, duration, dot, isMultiVoice, stemdir, isSingleLineStaff, durlog) {
		var c;
		var restpitch = 7;
		var noteHead;
		var roomTaken;
		var roomTakenRight;

		if (isMultiVoice) {
			if (stemdir === "down") restpitch = 3;
			if (stemdir === "up") restpitch = 11;
		}
		// There is special placement for the percussion staff. If there is one staff line, then move the rest position.
		if (isSingleLineStaff) {
			// The half and whole rests are attached to different lines normally, so we need to tweak their position to get them to both be attached to the same one.
			if (duration < 0.5)
				restpitch = 7;
			else if (duration < 1)
				restpitch = 7;	// half rest
			else
				restpitch = 5; // whole rest
		}
		switch (elem.rest.type) {
			case "whole":
				c = chartable.rest[0];
				elem.averagepitch = restpitch;
				elem.minpitch = restpitch;
				elem.maxpitch = restpitch;
				dot = 0;
				break;
			case "rest":
				if (elem.style === "rhythm") // special case for rhythm: rests are a handy way to express the rhythm.
					c = chartable.rhythm[-durlog];
				else
					c = chartable.rest[-durlog];
				elem.averagepitch = restpitch;
				elem.minpitch = restpitch;
				elem.maxpitch = restpitch;
				break;
			case "invisible":
			case "spacer":
				c = "";
				elem.averagepitch = restpitch;
				elem.minpitch = restpitch;
				elem.maxpitch = restpitch;
				break;
			case "multimeasure":
				c = chartable.rest['multi'];
				elem.averagepitch = restpitch;
				elem.minpitch = restpitch;
				elem.maxpitch = restpitch;
				dot = 0;
				var mmWidth = glyphs.getSymbolWidth(c);
				abselem.addHead(new RelativeElement(c, -mmWidth, mmWidth * 2, 7));
				var numMeasures = new RelativeElement("" + elem.duration, 0, mmWidth, 16, {type: "multimeasure-text"});
				abselem.addExtra(numMeasures);
		}
		if (elem.rest.type !== "multimeasure") {
			var ret = createNoteHead(abselem, c, {verticalPos: restpitch}, null, 0, 0, null, dot, 0, 1, []);
			noteHead = ret.notehead;
			if (noteHead) {
				abselem.addHead(noteHead);
				roomTaken = ret.accidentalshiftx;
				roomTakenRight = ret.dotshiftx;
			}
		}
		return { noteHead: noteHead, roomTaken: roomTaken, roomTakenRight: roomTakenRight };
	}

	AbstractEngraver.prototype.addNoteToAbcElement = function(abselem, elem, dot, stemdir, style, zeroDuration, durlog, nostem, voice) {
		var dotshiftx = 0; // room taken by chords with displaced noteheads which cause dots to shift
		var noteHead;
		var roomTaken = 0;
		var roomTakenRight = 0;
		var min;
		var i;
		var additionalLedgers = [];
		// The accidentalSlot will hold a list of all the accidentals on this chord. Each element is a vertical place,
		// and contains a pitch, which is the last pitch that contains an accidental in that slot. The slots are numbered
		// from closest to the note to farther left. We only need to know the last accidental we placed because
		// we know that the pitches are sorted by now.
		var accidentalSlot = [];
		var symbolWidth = 0;

		var dir = (elem.averagepitch>=6) ? "down": "up";
		if (stemdir) dir=stemdir;

		style = elem.style ? elem.style : style; // get the style of note head.
		if (!style || style === "normal") style = "note";
		var noteSymbol;
		if (zeroDuration)
			noteSymbol = chartable[style].nostem;
		else
			noteSymbol = chartable[style][-durlog];
		if (!noteSymbol)
			console.log("noteSymbol:", style, durlog, zeroDuration);

		// determine elements of chords which should be shifted
		var p;
		for (p=(dir==="down")?elem.pitches.length-2:1; (dir==="down")?p>=0:p<elem.pitches.length; p=(dir==="down")?p-1:p+1) {
			var prev = elem.pitches[(dir==="down")?p+1:p-1];
			var curr = elem.pitches[p];
			var delta = (dir==="down")?prev.pitch-curr.pitch:curr.pitch-prev.pitch;
			if (delta<=1 && !prev.printer_shift) {
				curr.printer_shift=(delta)?"different":"same";
				if (curr.verticalPos > 11 || curr.verticalPos < 1) {        // PER: add extra ledger line
					additionalLedgers.push(curr.verticalPos - (curr.verticalPos%2));
				}
				if (dir==="down") {
					roomTaken = glyphs.getSymbolWidth(noteSymbol)+2;
				} else {
					dotshiftx = glyphs.getSymbolWidth(noteSymbol)+2;
				}
			}
		}

		var pp = elem.pitches.length;
		for (p=0; p<elem.pitches.length; p++) {

			if (!nostem) {
				var flag;
				if ((dir==="down" && p!==0) || (dir==="up" && p!==pp-1)) { // not the stemmed elem of the chord
					flag = null;
				} else {
					flag = chartable[(dir==="down")?"dflags":"uflags"][-durlog];
				}
			}
			var c;
			if (elem.pitches[p].style) { // There is a style for the whole group of pitches, but there could also be an override for a particular pitch.
				c = chartable[elem.pitches[p].style][-durlog];
			} else
				c = noteSymbol;
			// The highest position for the sake of placing slurs is itself if the slur is internal. It is the highest position possible if the slur is for the whole chord.
			// If the note is the only one in the chord, then any slur it has counts as if it were on the whole chord.
			elem.pitches[p].highestVert = elem.pitches[p].verticalPos;
			var isTopWhenStemIsDown = (stemdir==="up" || dir==="up") && p===0;
			var isBottomWhenStemIsUp = (stemdir==="down" || dir==="down") && p===pp-1;
			if (isTopWhenStemIsDown || isBottomWhenStemIsUp) { // place to put slurs if not already on pitches

				if (elem.startSlur || pp === 1) {
					elem.pitches[p].highestVert = elem.pitches[pp-1].verticalPos;
					if (stemdir==="up" || dir==="up")
						elem.pitches[p].highestVert += 6;        // If the stem is up, then compensate for the length of the stem
				}
				if (elem.startSlur) {
					if (!elem.pitches[p].startSlur) elem.pitches[p].startSlur = []; //TODO possibly redundant, provided array is not optional
					for (i=0; i<elem.startSlur.length; i++) {
						elem.pitches[p].startSlur.push(elem.startSlur[i]);
					}
				}

				if (elem.endSlur) {
					elem.pitches[p].highestVert = elem.pitches[pp-1].verticalPos;
					if (stemdir==="up" || dir==="up")
						elem.pitches[p].highestVert += 6;        // If the stem is up, then compensate for the length of the stem
					if (!elem.pitches[p].endSlur) elem.pitches[p].endSlur = []; //TODO possibly redundant, provided array is not optional
					for (i=0; i<elem.endSlur.length; i++) {
						elem.pitches[p].endSlur.push(elem.endSlur[i]);
					}
				}
			}

			var hasStem = !nostem && durlog<=-1;
			var ret = createNoteHead(abselem, c, elem.pitches[p], hasStem ? dir : null, 0, -roomTaken, flag, dot, dotshiftx, 1, accidentalSlot);
			symbolWidth = Math.max(glyphs.getSymbolWidth(c), symbolWidth);
			abselem.extraw -= ret.extraLeft;
			noteHead = ret.notehead;
			if (noteHead) {
				this.addSlursAndTies(abselem, elem.pitches[p], noteHead, voice, hasStem ? dir : null);

				if (elem.gracenotes && elem.gracenotes.length > 0)
					noteHead.bottom = noteHead.bottom - 1;	 // If there is a tie to the grace notes, leave a little more room for the note to avoid collisions.
				abselem.addHead(noteHead);
			}
			roomTaken += ret.accidentalshiftx;
			roomTakenRight = Math.max(roomTakenRight,ret.dotshiftx);
		}

		// draw stem from the furthest note to a pitch above/below the stemmed note
		if (hasStem) {
			var p1 = (dir==="down") ? elem.minpitch-7 : elem.minpitch+1/3;
			// PER added stemdir test to make the line meet the note.
			if (p1>6 && !stemdir) p1=6;
			var p2 = (dir==="down") ? elem.maxpitch-1/3 : elem.maxpitch+7;
			// PER added stemdir test to make the line meet the note.
			if (p2<6 && !stemdir) p2=6;
			var dx = (dir==="down" || abselem.heads.length === 0)?0:abselem.heads[0].w;
			var width = (dir==="down")?1:-1;
			// TODO-PER-HACK: One type of note head has a different placement of the stem. This should be more generically calculated:
			if (noteHead.c === 'noteheads.slash.quarter') {
				if (dir === 'down')
					p2 -= 1;
				else
					p1 += 1;
			}
			abselem.addExtra(new RelativeElement(null, dx, 0, p1, {"type": "stem", "pitch2":p2, linewidth: width}));
			min = Math.min(p1, p2);
		}
		return { noteHead: noteHead, roomTaken: roomTaken, roomTakenRight: roomTakenRight, min: min, additionalLedgers: additionalLedgers, dir: dir, symbolWidth: symbolWidth };
	};

	AbstractEngraver.prototype.addLyric = function(abselem, elem) {
		var lyricStr = "";
		parseCommon.each(elem.lyric, function(ly) {
			var div = ly.divider === ' ' ? "" : ly.divider;
			lyricStr += ly.syllable + div + "\n";
		});
		var lyricDim = this.renderer.getTextSize(lyricStr, 'vocalfont', "lyric");
		var position = elem.positioning ? elem.positioning.vocalPosition : 'below';
		abselem.addCentered(new RelativeElement(lyricStr, 0, lyricDim.width, undefined, {type:"lyric", position: position, height: lyricDim.height / spacing.STEP }));
	};

	AbstractEngraver.prototype.addChord = function(abselem, elem, roomTaken, roomTakenRight) {
		var chordMargin = 8; // If there are chords next to each other, this is how close they can get.
		for (var i = 0; i < elem.chord.length; i++) {
			var x = 0;
			var y;
			var dim = this.renderer.getTextSize(elem.chord[i].name, 'annotationfont', "annotation");
			var chordWidth = dim.width;
			var chordHeight = dim.height / spacing.STEP;
			switch (elem.chord[i].position) {
				case "left":
					roomTaken+=chordWidth+7;
					x = -roomTaken;        // TODO-PER: This is just a guess from trial and error
					y = elem.averagepitch;
					abselem.addExtra(new RelativeElement(elem.chord[i].name, x, chordWidth+4, y, {type:"text", height: chordHeight}));
					break;
				case "right":
					roomTakenRight+=4;
					x = roomTakenRight;// TODO-PER: This is just a guess from trial and error
					y = elem.averagepitch;
					abselem.addRight(new RelativeElement(elem.chord[i].name, x, chordWidth+4, y, {type:"text", height: chordHeight}));
					break;
				case "below":
					// setting the y-coordinate to undefined for now: it will be overwritten later on, after we figure out what the highest element on the line is.
					abselem.addRight(new RelativeElement(elem.chord[i].name, 0, chordWidth+chordMargin, undefined, {type: "text", position: "below", height: chordHeight}));
					break;
				case "above":
					// setting the y-coordinate to undefined for now: it will be overwritten later on, after we figure out what the highest element on the line is.
					abselem.addRight(new RelativeElement(elem.chord[i].name, 0, chordWidth+chordMargin, undefined, {type: "text", height: chordHeight}));
					break;
				default:
					if (elem.chord[i].rel_position) {
						var relPositionY = elem.chord[i].rel_position.y + 3*spacing.STEP; // TODO-PER: this is a fudge factor to make it line up with abcm2ps
						abselem.addChild(new RelativeElement(elem.chord[i].name, x + elem.chord[i].rel_position.x, 0, elem.minpitch + relPositionY / spacing.STEP, {type: "text", height: chordHeight}));
					} else {
						// setting the y-coordinate to undefined for now: it will be overwritten later on, after we figure out what the highest element on the line is.
						var pos2 = 'above';
						if (elem.positioning && elem.positioning.chordPosition)
							pos2 = elem.positioning.chordPosition;

						dim = this.renderer.getTextSize(elem.chord[i].name, 'gchordfont', "chord");
						chordHeight = dim.height / spacing.STEP;
						chordWidth = dim.width; // Since the chord is centered, we only use half the width.
						abselem.addCentered(new RelativeElement(elem.chord[i].name, x, chordWidth, undefined, {type: "chord", position: pos2, height: chordHeight }));
					}
			}
		}
		return { roomTaken: roomTaken, roomTakenRight: roomTakenRight };
	};

AbstractEngraver.prototype.createNote = function(elem, nostem, isSingleLineStaff, voice) { //stem presence: true for drawing stemless notehead
  var notehead = null;
  var roomtaken = 0; // room needed to the left of the note
  var roomtakenright = 0; // room needed to the right of the note
  var symbolWidth = 0;
  var additionalLedgers = []; // PER: handle the case of [bc'], where the b doesn't have a ledger line

  var i;
  var dir;

	var duration = getDuration(elem);
	var zeroDuration = false;
  if (duration === 0) { zeroDuration = true; duration = 0.25; nostem = true; }        //PER: zero duration will draw a quarter note head.
  var durlog = Math.floor(Math.log(duration)/Math.log(2)); //TODO use getDurlog
  var dot=0;

  for (var tot = Math.pow(2,durlog), inc=tot/2; tot<duration; dot++,tot+=inc,inc/=2);


	if (elem.startTriplet) {
		this.tripletmultiplier = elem.tripletMultiplier;
	}

  var durationForSpacing = duration * this.tripletmultiplier;
  if (elem.rest && elem.rest.type === 'multimeasure')
  	durationForSpacing = 1;
  var absType = elem.rest ? "rest" : "note";
  var abselem = new AbsoluteElement(elem, durationForSpacing, 1, absType, this.tuneNumber, { durationClassOveride: elem.duration * this.tripletmultiplier});
  if (hint) abselem.setHint();

  if (elem.rest) {
	  var ret1 = addRestToAbsElement(abselem, elem, duration, dot, voice.voicetotal > 1, this.stemdir, isSingleLineStaff, durlog);
	  notehead = ret1.noteHead;
	  roomtaken = ret1.roomTaken;
	  roomtakenright = ret1.roomTakenRight;
  } else {
	  var ret2 = this.addNoteToAbcElement(abselem, elem, dot, this.stemdir, this.style, zeroDuration, durlog, nostem, voice);
	  if (ret2.min !== undefined)
		  this.minY = Math.min(ret2.min, this.minY);
	  notehead = ret2.noteHead;
	  roomtaken = ret2.roomTaken;
	  roomtakenright = ret2.roomTakenRight;
	  additionalLedgers = ret2.additionalLedgers;
	  dir = ret2.dir;
	  symbolWidth = ret2.symbolWidth;
  }

  if (elem.lyric !== undefined) {
  	this.addLyric(abselem, elem);
  }

  if (elem.gracenotes !== undefined) {
	roomtaken += this.addGraceNotes(elem, voice, abselem, notehead, this.stemHeight, this.isBagpipes, roomtaken);
  }

  if (elem.decoration) {
	  this.decoration.createDecoration(voice, elem.decoration, abselem.top, (notehead)?notehead.w:0, abselem, roomtaken, dir, abselem.bottom, elem.positioning, this.hasVocals);
  }

  if (elem.barNumber) {
    abselem.addChild(new RelativeElement(elem.barNumber, -10, 0, 0, {type:"barNumber"}));
  }

  // ledger lines
	ledgerLines(abselem, elem.minpitch, elem.maxpitch, elem.rest, symbolWidth, additionalLedgers, dir, -2, 1);

  if (elem.chord !== undefined) {
  	var ret3 = this.addChord(abselem, elem, roomtaken, roomtakenright);
	  roomtaken = ret3.roomTaken;
	  roomtakenright = ret3.roomTakenRight;
  }


  if (elem.startTriplet) {
    this.triplet = new TripletElem(elem.startTriplet, notehead); // above is opposite from case of slurs
  }

  if (elem.endTriplet && this.triplet) {
    this.triplet.setCloseAnchor(notehead);
  }

  return abselem;
};




var createNoteHead = function(abselem, c, pitchelem, dir, headx, extrax, flag, dot, dotshiftx, scale, accidentalSlot) {

  // TODO scale the dot as well
  var pitch = pitchelem.verticalPos;
  var notehead;
  var i;
  var accidentalshiftx = 0;
  var newDotShiftX = 0;
  var extraLeft = 0;
  if (c === undefined)
    abselem.addChild(new RelativeElement("pitch is undefined", 0, 0, 0, {type:"debug"}));
  else if (c==="") {
    notehead = new RelativeElement(null, 0, 0, pitch);
  } else {
    var shiftheadx = headx;
    if (pitchelem.printer_shift) {
      var adjust = (pitchelem.printer_shift==="same")?1:0;
      shiftheadx = (dir==="down")?-glyphs.getSymbolWidth(c)*scale+adjust:glyphs.getSymbolWidth(c)*scale-adjust;
    }
	  var opts = {scalex:scale, scaley: scale, thickness: glyphs.symbolHeightInPitches(c)*scale };
    notehead = new RelativeElement(c, shiftheadx, glyphs.getSymbolWidth(c)*scale, pitch, opts);
    if (flag) {
      var pos = pitch+((dir==="down")?-7:7)*scale;
      if (scale===1 && (dir==="down")?(pos>6):(pos<6)) pos=6;
      var xdelta = (dir==="down")?headx:headx+notehead.w-0.6;
      abselem.addRight(new RelativeElement(flag, xdelta, glyphs.getSymbolWidth(flag)*scale, pos, {scalex:scale, scaley: scale}));
    }
	  newDotShiftX = notehead.w+dotshiftx-2+5*dot;
    for (;dot>0;dot--) {
      var dotadjusty = (1-Math.abs(pitch)%2); //PER: take abs value of the pitch. And the shift still happens on ledger lines.
      abselem.addRight(new RelativeElement("dots.dot", notehead.w+dotshiftx-2+5*dot, glyphs.getSymbolWidth("dots.dot"), pitch+dotadjusty));
    }
  }
        if (notehead)
                notehead.highestVert = pitchelem.highestVert;

  if (pitchelem.accidental) {
    var symb;
    switch (pitchelem.accidental) {
    case "quartersharp":
      symb = "accidentals.halfsharp";
        break;
    case "dblsharp":
      symb = "accidentals.dblsharp";
      break;
    case "sharp":
      symb = "accidentals.sharp";
      break;
    case "quarterflat":
      symb = "accidentals.halfflat";
      break;
    case "flat":
      symb = "accidentals.flat";
      break;
    case "dblflat":
      symb = "accidentals.dblflat";
      break;
    case "natural":
      symb = "accidentals.nat";
    }
         // if a note is at least a sixth away, it can share a slot with another accidental
         var accSlotFound = false;
         var accPlace = extrax;
         for (var j = 0; j < accidentalSlot.length; j++) {
                 if (pitch - accidentalSlot[j][0] >= 6) {
                         accidentalSlot[j][0] = pitch;
                         accPlace = accidentalSlot[j][1];
                         accSlotFound = true;
                         break;
                 }
         }
         if (accSlotFound === false) {
                 accPlace -= (glyphs.getSymbolWidth(symb)*scale+2);
                 accidentalSlot.push([pitch,accPlace]);
                 accidentalshiftx = (glyphs.getSymbolWidth(symb)*scale+2);
         }
    abselem.addExtra(new RelativeElement(symb, accPlace, glyphs.getSymbolWidth(symb), pitch, {scalex:scale, scaley: scale}));
	  extraLeft = glyphs.getSymbolWidth(symb) / 2; // TODO-PER: We need a little extra width if there is an accidental, but I'm not sure why it isn't the full width of the accidental.
  }

  return { notehead: notehead, accidentalshiftx: accidentalshiftx, dotshiftx: newDotShiftX, extraLeft: extraLeft };

};

	AbstractEngraver.prototype.addSlursAndTies = function(abselem, pitchelem, notehead, voice, dir) {
		if (pitchelem.endTie) {
			if (this.ties[0]) {
				this.ties[0].setEndAnchor(notehead);
				this.ties = this.ties.slice(1,this.ties.length);
			}
		}

		if (pitchelem.startTie) {
			//PER: bug fix: var tie = new TieElem(notehead, null, (this.stemdir=="up" || dir=="down") && this.stemdir!="down",(this.stemdir=="down" || this.stemdir=="up"));
			var tie = new TieElem(notehead, null, (this.stemdir==="down" || dir==="down") && this.stemdir!=="up",(this.stemdir==="down" || this.stemdir==="up"), true);
			if (hint) tie.setHint();

			this.ties[this.ties.length]=tie;
			voice.addOther(tie);
			// HACK-PER: For the animation, we need to know if a note is tied to the next one, so here's a flag.
			// Unfortunately, only some of the notes in the current event might be tied, but this will consider it
			// tied if any one of them is. That will work for most cases.
			abselem.startTie = true;
		}

		if (pitchelem.endSlur) {
			for (var i=0; i<pitchelem.endSlur.length; i++) {
				var slurid = pitchelem.endSlur[i];
				var slur;
				if (this.slurs[slurid]) {
					slur = this.slurs[slurid];
					slur.setEndAnchor(notehead);
					delete this.slurs[slurid];
				} else {
					slur = new TieElem(null, notehead, dir==="down",(this.stemdir==="up" || dir==="down") && this.stemdir!=="down", false);
					if (hint) slur.setHint();
					voice.addOther(slur);
				}
				if (this.startlimitelem) {
					slur.setStartX(this.startlimitelem);
				}
			}
		}

		if (pitchelem.startSlur) {
			for (i=0; i<pitchelem.startSlur.length; i++) {
				var slurid = pitchelem.startSlur[i].label;
				//PER: bug fix: var slur = new TieElem(notehead, null, (this.stemdir=="up" || dir=="down") && this.stemdir!="down", this.stemdir);
				var slur = new TieElem(notehead, null, (this.stemdir==="down" || dir==="down") && this.stemdir!=="up", false, false);
				if (hint) slur.setHint();
				this.slurs[slurid]=slur;
				voice.addOther(slur);
			}
		}
	};

AbstractEngraver.prototype.addMeasureNumber = function (number, abselem) {
	var measureNumHeight = this.renderer.getTextSize(number, "measurefont", 'bar-number');
	abselem.addChild(new RelativeElement(number, 0, 0, 11+measureNumHeight.height / spacing.STEP, {type:"barNumber"}));
};

AbstractEngraver.prototype.createBarLine = function (voice, elem, isFirstStaff) {
// bar_thin, bar_thin_thick, bar_thin_thin, bar_thick_thin, bar_right_repeat, bar_left_repeat, bar_double_repeat

  var abselem = new AbsoluteElement(elem, 0, 10, 'bar', this.tuneNumber);
  var anchor = null; // place to attach part lines
  var dx = 0;

	if (elem.barNumber) {
		this.addMeasureNumber(elem.barNumber, abselem);
	}


  var firstdots = (elem.type==="bar_right_repeat" || elem.type==="bar_dbl_repeat");
  var firstthin = (elem.type!=="bar_left_repeat" && elem.type!=="bar_thick_thin" && elem.type!=="bar_invisible");
  var thick = (elem.type==="bar_right_repeat" || elem.type==="bar_dbl_repeat" || elem.type==="bar_left_repeat" ||
         elem.type==="bar_thin_thick" || elem.type==="bar_thick_thin");
  var secondthin = (elem.type==="bar_left_repeat" || elem.type==="bar_thick_thin" || elem.type==="bar_thin_thin" || elem.type==="bar_dbl_repeat");
  var seconddots = (elem.type==="bar_left_repeat" || elem.type==="bar_dbl_repeat");

  // limit positioning of slurs
  if (firstdots || seconddots) {
    for (var slur in this.slurs) {
      if (this.slurs.hasOwnProperty(slur)) {
        this.slurs[slur].setEndX(abselem);
      }
    }
    this.startlimitelem = abselem;
  }

  if (firstdots) {
    abselem.addRight(new RelativeElement("dots.dot", dx, 1, 7));
    abselem.addRight(new RelativeElement("dots.dot", dx, 1, 5));
    dx+=6; //2 hardcoded, twice;
  }

  if (firstthin) {
    anchor = new RelativeElement(null, dx, 1, 2, {"type": "bar", "pitch2":10, linewidth:0.6});
    abselem.addRight(anchor);
  }

  if (elem.type==="bar_invisible") {
    anchor = new RelativeElement(null, dx, 1, 2, {"type": "none", "pitch2":10, linewidth:0.6});
    abselem.addRight(anchor);
  }

  if (elem.decoration) {
    this.decoration.createDecoration(voice, elem.decoration, 12, (thick)?3:1, abselem, 0, "down", 2, elem.positioning, this.hasVocals);
  }

  if (thick) {
    dx+=4; //3 hardcoded;
    anchor = new RelativeElement(null, dx, 4, 2, {"type": "bar", "pitch2":10, linewidth:4});
    abselem.addRight(anchor);
    dx+=5;
  }

// if (this.partstartelem && (thick || (firstthin && secondthin))) { // means end of nth part
// this.partstartelem.anchor2=anchor;
// this.partstartelem = null;
// }

  if (this.partstartelem && elem.endEnding) {
    this.partstartelem.anchor2=anchor;
    this.partstartelem = null;
  }

  if (secondthin) {
    dx+=3; //3 hardcoded;
    anchor = new RelativeElement(null, dx, 1, 2, {"type": "bar", "pitch2":10, linewidth:0.6});
    abselem.addRight(anchor); // 3 is hardcoded
  }

  if (seconddots) {
    dx+=3; //3 hardcoded;
    abselem.addRight(new RelativeElement("dots.dot", dx, 1, 7));
    abselem.addRight(new RelativeElement("dots.dot", dx, 1, 5));
  } // 2 is hardcoded

  if (elem.startEnding && isFirstStaff) { // only put the first & second ending marks on the first staff
	  var textWidth = this.renderer.getTextSize(elem.startEnding, "repeatfont", '').width;
	  abselem.minspacing += textWidth + 10; // Give plenty of room for the ending number.
    this.partstartelem = new EndingElem(elem.startEnding, anchor, null);
	  voice.addOther(this.partstartelem);
  }

  // Add a little space to the left of the bar line so that nothing can crowd it.
	abselem.extraw -= 5;

	return abselem;

};


})();

module.exports = AbstractEngraver;

},{"../parse/abc_common":9,"./abc_absolute_element":17,"./abc_beam_element":19,"./abc_brace_element":20,"./abc_create_clef":21,"./abc_create_key_signature":22,"./abc_create_time_signature":23,"./abc_decoration":25,"./abc_ending_element":27,"./abc_glyphs":29,"./abc_relative_element":30,"./abc_spacing":32,"./abc_staff_group_element":33,"./abc_tempo_element":34,"./abc_tie_element":35,"./abc_triplet_element":36,"./abc_voice_element":37}],19:[function(require,module,exports){
//    abc_beam_element.js: Definition of the BeamElem class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var AbsoluteElement = require('./abc_absolute_element');
var RelativeElement = require('./abc_relative_element');
var spacing = require('./abc_spacing');

var getDurlog = function(duration) {
        // TODO-PER: This is a hack to prevent a Chrome lockup. Duration should have been defined already,
        // but there's definitely a case where it isn't. [Probably something to do with triplets.]
        if (duration === undefined) {
                return 0;
        }
//        console.log("getDurlog: " + duration);
  return Math.floor(Math.log(duration)/Math.log(2));
};


// Most elements on the page are related to a particular absolute element -- notes, rests, bars, etc. Beams, however, span multiple elements.
// This means that beams can't be laid out until the absolute elements are placed. There is the further complication that the stems for beamed
// notes can't be laid out until the beams are because we don't know how long they will be until we know the slope of the beam and the horizontal
// spacing of the absolute elements.
//
// So, when a beam is detected, a BeamElem is created, then all notes belonging to that beam are added to it. These notes are not given stems at that time.
// Then, after the horizontal layout is complete, all of the BeamElem are iterated to set the beam position, then all of the notes that are beamed are given
// stems. After that, we are ready for the drawing step.

// There are three phases: the setup phase, when new elements are being discovered, the layout phase, when everything is calculated, and the drawing phase,
// when the object is not changed, but is used to put the elements on the page.

var BeamElem;

(function() {
	"use strict";

	//
	// Setup phase
	//
	BeamElem = function BeamElem(stemHeight, type, flat) {
		// type is "grace", "up", "down", or undefined. flat is used to force flat beams, as it commonly found in the grace notes of bagpipe music.
		this.isflat = flat;
		this.isgrace = (type && type === "grace");
		this.forceup = this.isgrace || (type && type === "up");
		this.forcedown = (type && type === "down");
		this.elems = []; // all the AbsoluteElements that this beam touches. It may include embedded rests.
		this.total = 0;
		this.allrests = true;
		this.stemHeight = stemHeight;
		this.beams = []; // During the layout phase, this will become a list of the beams that need to be drawn.
	};

	BeamElem.prototype.setHint = function () {
		this.hint = true;
	};

	BeamElem.prototype.add = function(abselem) {
		var pitch = abselem.abcelem.averagepitch;
		if (pitch === undefined) return; // don't include elements like spacers in beams
		this.allrests = this.allrests && abselem.abcelem.rest;
		abselem.beam = this;
		this.elems.push(abselem);
		//var pitch = abselem.abcelem.averagepitch;
		this.total += pitch; // TODO CHORD (get pitches from abselem.heads)
		if (!this.min || abselem.abcelem.minpitch < this.min) {
			this.min = abselem.abcelem.minpitch;
		}
		if (!this.max || abselem.abcelem.maxpitch > this.max) {
			this.max = abselem.abcelem.maxpitch;
		}
	};

	var middleLine = 6;	// hardcoded 6 is B

	BeamElem.prototype.calcDir = function() {
		if (this.forceup) return true;
		if (this.forcedown) return false;
		var average = calcAverage(this.total, this.elems.length);
		return average < middleLine;
	};

	//
	// layout phase
	//
	BeamElem.prototype.layout = function() {
		if (this.elems.length === 0 || this.allrests) return;

		this.stemsUp = this.calcDir(); // True means the stems are facing up.
		var dy = calcDy(this.stemsUp, this.isgrace); // This is the width of the beam line.

		// create the main beam
		var firstElement = this.elems[0];
		var lastElement = this.elems[this.elems.length - 1];
		var minStemHeight = 0; // The following is to leave space for "!///!" marks.
		var referencePitch = this.stemsUp ? firstElement.abcelem.maxpitch : firstElement.abcelem.minpitch;
		minStemHeight = minStem(firstElement, this.stemsUp, referencePitch, minStemHeight);
		minStemHeight = minStem(lastElement, this.stemsUp, referencePitch, minStemHeight);
		minStemHeight = Math.max(this.stemHeight, minStemHeight + 3); // TODO-PER: The 3 is the width of a 16th beam. The actual height of the beam should be used instead.
		var yPos = calcYPos(this.total, this.elems.length, minStemHeight, this.stemsUp, firstElement.abcelem.averagepitch, lastElement.abcelem.averagepitch, this.isflat, this.min, this.max, this.isgrace);
		var xPos = calcXPos(this.stemsUp, firstElement, lastElement);
		this.beams.push({ startX: xPos[0], endX: xPos[1], startY: yPos[0], endY: yPos[1], dy: dy });

		// create the rest of the beams (in the case of 1/16th notes, etc.
		var beams = createAdditionalBeams(this.elems, this.stemsUp, this.beams[0], this.isgrace, dy);
		for (var i = 0; i < beams.length; i++)
			this.beams.push(beams[i]);

		// Now that the main beam is defined, we know how tall the stems should be, so create them and attach them to the original notes.
		createStems(this.elems, this.stemsUp, this.beams[0], dy, this.mainNote);
	};

	BeamElem.prototype.isAbove = function() {
		return this.stemsUp;
	};

	// We can't just use the entire beam for the calculation. The range has to be passed in, because the beam might extend into some unrelated notes. for instance, (3_a'f'e'f'2 when L:16
	BeamElem.prototype.heightAtMidpoint = function(startX, endX) {
		if (this.beams.length === 0)
			return 0;
		var beam = this.beams[0];
		var midPoint = startX + (endX - startX) / 2;
		return getBarYAt(beam.startX, beam.startY, beam.endX, beam.endY, midPoint);
	};

	BeamElem.prototype.yAtNote = function(element) {
		var beam = this.beams[0];
		return getBarYAt(beam.startX, beam.startY, beam.endX, beam.endY, element.x);
	};

	BeamElem.prototype.xAtMidpoint = function(startX, endX) {
		return startX + (endX - startX)/2;
	};

	//
	// Drawing phase
	//
	BeamElem.prototype.draw = function(renderer) {
		if (this.beams.length === 0) return;

		renderer.beginGroup();
		for (var i = 0; i < this.beams.length; i++) {
			var beam = this.beams[i];
			drawBeam(renderer, beam.startX, beam.startY, beam.endX, beam.endY, beam.dy, this.hint);
		}
		renderer.endGroup('beam-elem');
	};

	//
	// private functions
	//
	function minStem(element, stemsUp, referencePitch, minStemHeight) {
		if (!element.children)
			return minStemHeight;
		for (var i = 0; i < element.children.length; i++) {
			var elem = element.children[i];
			if (stemsUp && elem.top !== undefined && elem.c === "flags.ugrace")
				minStemHeight = Math.max(minStemHeight, elem.top - referencePitch);
			else if (!stemsUp && elem.bottom !== undefined && elem.c === "flags.ugrace")
				minStemHeight = Math.max(minStemHeight, referencePitch - elem.bottom + 7); // The extra 7 is because we are measuring the slash from the top.
		}
		return minStemHeight;
	}

	function calcSlant(leftAveragePitch, rightAveragePitch, numStems, isFlat) {
		if (isFlat)
			return 0;
		var slant = leftAveragePitch - rightAveragePitch;
		var maxSlant = numStems / 2;

		if (slant > maxSlant) slant = maxSlant;
		if (slant < -maxSlant) slant = -maxSlant;
		return slant;
	}

	function calcAverage(total, numElements) {
		if (!numElements)
			return 0;
		return total / numElements;
	}

	function getBarYAt(startx, starty, endx, endy, x) {
		return starty + (endy - starty) / (endx - startx) * (x - startx);
	}

	function calcDy(asc, isGrace) {
		var dy = (asc) ? spacing.STEP : -spacing.STEP;
		if (isGrace) dy = dy * 0.4;
		return dy;
	}

	function drawBeam(renderer, startX, startY, endX, endY, dy, isHint) {
		var klass = 'beam-elem';
		if (isHint)
			klass += " abcjs-hint";

		// the X coordinates are actual coordinates, but the Y coordinates are in pitches.
		startY = renderer.calcY(startY);
		endY = renderer.calcY(endY);
		var pathString = "M" + startX + " " + startY + " L" + endX + " " + endY +
			"L" + endX + " " + (endY + dy) + " L" + startX + " " + (startY + dy) + "z";
		renderer.printPath({
			path: pathString,
			stroke: "none",
			fill: "#000000",
			'class': renderer.addClasses(klass)
		});
	}

	function calcXPos(asc, firstElement, lastElement) {
		var starthead = firstElement.heads[asc ? 0 : firstElement.heads.length - 1];
		var endhead = lastElement.heads[asc ? 0 : lastElement.heads.length - 1];
		var startX = starthead.x;
		if (asc) startX += starthead.w - 0.6;
		var endX = endhead.x;
		if (asc) endX += endhead.w;
		return [ startX, endX ];
	}

	function calcYPos(total, numElements, stemHeight, asc, firstAveragePitch, lastAveragePitch, isFlat, minPitch, maxPitch, isGrace) {
		var average = calcAverage(total, numElements); // This is the average pitch for the all the notes that will be beamed.
		var barpos = stemHeight - 2; // (isGrace)? 5:7;
		var barminpos = stemHeight - 2;
		var pos = Math.round(asc ? Math.max(average + barpos, maxPitch + barminpos) : Math.min(average - barpos, minPitch - barminpos));

		var slant = calcSlant(firstAveragePitch, lastAveragePitch, numElements, isFlat);
		var startY = pos + Math.floor(slant / 2);
		var endY = pos + Math.floor(-slant / 2);

		// If the notes are too high or too low, make the beam go down to the middle
		if (!isGrace) {
			if (asc && pos < 6) {
				startY = 6;
				endY = 6;
			} else if (!asc && pos > 6) {
				startY = 6;
				endY = 6;
			}
		}

		return [ startY, endY];
	}

	function createStems(elems, asc, beam, dy, mainNote) {
		for (var i = 0; i < elems.length; i++) {
			var elem = elems[i];
			if (elem.abcelem.rest)
				continue;
			// TODO-PER: This is odd. If it is a regular beam then elems is an array of AbsoluteElements, if it is a grace beam then it is an array of objects , so we directly attach the element to the parent. We tell it if is a grace note because they are passed in as a generic object instead of an AbsoluteElement.
			var isGrace = elem.addExtra ? false : true;
			var parent = isGrace ? mainNote : elem;
			var furthestHead = elem.heads[(asc) ? 0 : elem.heads.length - 1];
			var ovalDelta = 1 / 5;//(isGrace)?1/3:1/5;
			var pitch = furthestHead.pitch + ((asc) ? ovalDelta : -ovalDelta);
			var dx = asc ? furthestHead.w : 0; // down-pointing stems start on the left side of the note, up-pointing stems start on the right side, so we offset by the note width.
			var x = furthestHead.x + dx; // this is now the actual x location in pixels.
			var bary = getBarYAt(beam.startX, beam.startY, beam.endX, beam.endY, x);
			var lineWidth = (asc) ? -0.6 : 0.6;
			if (!asc)
				bary -= (dy / 2) / spacing.STEP;	// TODO-PER: This is just a fudge factor so the down-pointing stems don't overlap.
			if (isGrace)
				dx += elem.heads[0].dx;
			// TODO-PER-HACK: One type of note head has a different placement of the stem. This should be more generically calculated:
			if (furthestHead.c === 'noteheads.slash.quarter') {
				if (asc)
					pitch += 1;
				else
					pitch -= 1;
			}
			var stem = new RelativeElement(null, dx, 0, pitch, {
				"type": "stem",
				"pitch2": bary,
				linewidth: lineWidth
			});
			stem.setX(parent.x); // This is after the x coordinates were set, so we have to set it directly.
			parent.addExtra(stem);
		}

	}

	function createAdditionalBeams(elems, asc, beam, isGrace, dy) {
		var beams = [];
		var auxBeams = [];  // auxbeam will be {x, y, durlog, single} auxbeam[0] should match with durlog=-4 (16th) (j=-4-durlog)
		for (var i = 0; i < elems.length; i++) {
			var elem = elems[i];
			if (elem.abcelem.rest)
				continue;
			var furthestHead = elem.heads[(asc) ? 0 : elem.heads.length - 1];
			var x = furthestHead.x + ((asc) ? furthestHead.w : 0);
			var bary = getBarYAt(beam.startX, beam.startY, beam.endX, beam.endY, x);

			var sy = (asc) ? -1.5 : 1.5;
			if (isGrace) sy = sy * 2 / 3; // This makes the second beam on grace notes closer to the first one.
			var duration = elem.abcelem.duration; // get the duration via abcelem because of triplets
			if (duration === 0) duration = 0.25; // if this is stemless, then we use quarter note as the duration.
			for (var durlog = getDurlog(duration); durlog < -3; durlog++) {
				if (auxBeams[-4 - durlog]) {
					auxBeams[-4 - durlog].single = false;
				} else {
					auxBeams[-4 - durlog] = {
						x: x + ((asc) ? -0.6 : 0), y: bary + sy * (-4 - durlog + 1),
						durlog: durlog, single: true
					};
				}
			}

			for (var j = auxBeams.length - 1; j >= 0; j--) {
				if (i === elems.length - 1 || getDurlog(elems[i + 1].abcelem.duration) > (-j - 4)) {

					var auxBeamEndX = x;
					var auxBeamEndY = bary + sy * (j + 1);


					if (auxBeams[j].single) {
						auxBeamEndX = (i === 0) ? x + 5 : x - 5;
						auxBeamEndY = getBarYAt(beam.startX, beam.startY, beam.endX, beam.endY, auxBeamEndX) + sy * (j + 1);
					}
					beams.push({ startX: auxBeams[j].x, endX: auxBeamEndX, startY: auxBeams[j].y, endY: auxBeamEndY, dy: dy });
					auxBeams = auxBeams.slice(0, j);
				}
			}
		}
		return beams;
	}
})();

module.exports = BeamElem;

},{"./abc_absolute_element":17,"./abc_relative_element":30,"./abc_spacing":32}],20:[function(require,module,exports){
//    abc_brace_element.js: Definition of the BraceElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var BraceElem = function BraceElem() {
    this.length = 1;
};

BraceElem.prototype.increaseStavesIncluded = function() {
    this.length++;
};

BraceElem.prototype.setLocation = function(x) {
	this.x = x;
};

BraceElem.prototype.getWidth = function() {
	return 10; // TODO-PER: right now the drawing function doesn't vary the width at all. If it does in the future then this will change.
};

BraceElem.prototype.layout = function (renderer, top, bottom) {
    this.startY = top;
    this.endY = bottom;
};

BraceElem.prototype.draw = function (renderer, top, bottom) {
    this.layout(renderer, top, bottom);
    renderer.drawBrace(this.x,this.startY, this.endY);

};

module.exports = BraceElem;

},{}],21:[function(require,module,exports){
//    abc_create_clef.js
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var AbsoluteElement = require('./abc_absolute_element');
var glyphs = require('./abc_glyphs');
var RelativeElement = require('./abc_relative_element');

var createClef;

(function() {
	"use strict";

	createClef = function(elem, tuneNumber) {
		var clef;
		var octave = 0;
		var abselem = new AbsoluteElement(elem,0,10, 'staff-extra', tuneNumber);
		abselem.isClef = true;
		switch (elem.type) {
			case "treble": clef = "clefs.G"; break;
			case "tenor": clef="clefs.C"; break;
			case "alto": clef="clefs.C"; break;
			case "bass": clef="clefs.F"; break;
			case 'treble+8': clef = "clefs.G"; octave = 1; break;
			case 'tenor+8':clef="clefs.C"; octave = 1; break;
			case 'bass+8': clef="clefs.F"; octave = 1; break;
			case 'alto+8': clef="clefs.C"; octave = 1; break;
			case 'treble-8': clef = "clefs.G"; octave = -1; break;
			case 'tenor-8':clef="clefs.C"; octave = -1; break;
			case 'bass-8': clef="clefs.F"; octave = -1; break;
			case 'alto-8': clef="clefs.C"; octave = -1; break;
			case 'none': return null;
			case 'perc': clef="clefs.perc"; break;
			default: abselem.addChild(new RelativeElement("clef="+elem.type, 0, 0, undefined, {type:"debug"}));
		}
		// if (elem.verticalPos) {
		// pitch = elem.verticalPos;
		// }
		var dx =5;
		if (clef) {
			abselem.addRight(new RelativeElement(clef, dx, glyphs.getSymbolWidth(clef), elem.clefPos));

			if (clef === 'clefs.G') {
				abselem.top = 13;
				abselem.bottom = -1;
			} else {
				abselem.top = 10;
				abselem.bottom = 2;
			}
			if (octave !== 0) {
				var scale = 2 / 3;
				var adjustspacing = (glyphs.getSymbolWidth(clef) - glyphs.getSymbolWidth("8") * scale) / 2;
				abselem.addRight(new RelativeElement("8", dx + adjustspacing, glyphs.getSymbolWidth("8") * scale, (octave > 0) ? abselem.top + 3 : abselem.bottom - 1, {
					scalex: scale,
					scaley: scale
				}));
				abselem.top += 2;
			}
		}
		return abselem;
	};

})();

module.exports = createClef;

},{"./abc_absolute_element":17,"./abc_glyphs":29,"./abc_relative_element":30}],22:[function(require,module,exports){
//    abc_create_key_signature.js
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var AbsoluteElement = require('./abc_absolute_element');
var glyphs = require('./abc_glyphs');
var RelativeElement = require('./abc_relative_element');

var parseCommon = require('../parse/abc_common');

var createKeySignature;

(function() {
	"use strict";

	createKeySignature = function(elem, tuneNumber) {
		if (!elem.accidentals || elem.accidentals.length === 0)
			return null;
		var abselem = new AbsoluteElement(elem, 0, 10, 'staff-extra', tuneNumber);
		abselem.isKeySig = true;
		var dx = 0;
		parseCommon.each(elem.accidentals, function(acc) {
			var symbol = (acc.acc === "sharp") ? "accidentals.sharp" : (acc.acc === "natural") ? "accidentals.nat" : "accidentals.flat";
			//var notes = { 'A': 5, 'B': 6, 'C': 0, 'D': 1, 'E': 2, 'F': 3, 'G':4, 'a': 12, 'b': 13, 'c': 7, 'd': 8, 'e': 9, 'f': 10, 'g':11 };
			abselem.addRight(new RelativeElement(symbol, dx, glyphs.getSymbolWidth(symbol), acc.verticalPos, {thickness: glyphs.symbolHeightInPitches(symbol)}));
			dx += glyphs.getSymbolWidth(symbol) + 2;
		}, this);
		return abselem;
	};
})();

module.exports = createKeySignature;

},{"../parse/abc_common":9,"./abc_absolute_element":17,"./abc_glyphs":29,"./abc_relative_element":30}],23:[function(require,module,exports){
//    abc_create_time_signature.js
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var AbsoluteElement = require('./abc_absolute_element');
var glyphs = require('./abc_glyphs');
var RelativeElement = require('./abc_relative_element');

var createTimeSignature;

(function() {
	"use strict";

	createTimeSignature = function(elem, tuneNumber) {
		var abselem = new AbsoluteElement(elem,0,10, 'staff-extra', tuneNumber);
		if (elem.type === "specified") {
			var x = 0;
			for (var i = 0; i < elem.value.length; i++) {
				if (i !== 0) {
					abselem.addRight(new RelativeElement('+', x+1, glyphs.getSymbolWidth("+"), 6, {thickness: glyphs.symbolHeightInPitches("+")}));
					x += glyphs.getSymbolWidth("+")+2;
				}
				if (elem.value[i].den) {
					var numWidth = 0;
					for (var i2 = 0; i2 < elem.value[i].num.length; i2++)
						numWidth += glyphs.getSymbolWidth(elem.value[i].num.charAt(i2));
					var denWidth = 0;
					for (i2 = 0; i2 < elem.value[i].num.length; i2++)
						denWidth += glyphs.getSymbolWidth(elem.value[i].den.charAt(i2));
					var maxWidth = Math.max(numWidth, denWidth);
					abselem.addRight(new RelativeElement(elem.value[i].num, x+(maxWidth-numWidth)/2, numWidth, 8, { thickness: glyphs.symbolHeightInPitches(elem.value[i].num.charAt(0)) }));
					abselem.addRight(new RelativeElement(elem.value[i].den, x+(maxWidth-denWidth)/2, denWidth, 4, { thickness: glyphs.symbolHeightInPitches(elem.value[i].den.charAt(0)) }));
					x += maxWidth
				} else {
					var thisWidth = 0;
					for (var i3 = 0; i3 < elem.value[i].num.length; i3++)
						thisWidth += glyphs.getSymbolWidth(elem.value[i].num.charAt(i3));
					abselem.addRight(new RelativeElement(elem.value[i].num, x, thisWidth, 6, { thickness: glyphs.symbolHeightInPitches(elem.value[i].num.charAt(0)) }));
					x += thisWidth;
				}
			}
		} else if (elem.type === "common_time") {
			abselem.addRight(new RelativeElement("timesig.common", 0, glyphs.getSymbolWidth("timesig.common"), 6, { thickness: glyphs.symbolHeightInPitches("timesig.common") }));

		} else if (elem.type === "cut_time") {
			abselem.addRight(new RelativeElement("timesig.cut", 0, glyphs.getSymbolWidth("timesig.cut"), 6, { thickness: glyphs.symbolHeightInPitches("timesig.cut") }));
		} else if (elem.type === "tempus_imperfectum") {
			abselem.addRight(new RelativeElement("timesig.imperfectum", 0, glyphs.getSymbolWidth("timesig.imperfectum"), 6, { thickness: glyphs.symbolHeightInPitches("timesig.imperfectum") }));
		} else if (elem.type === "tempus_imperfectum_prolatio") {
			abselem.addRight(new RelativeElement("timesig.imperfectum2", 0, glyphs.getSymbolWidth("timesig.imperfectum2"), 6, { thickness: glyphs.symbolHeightInPitches("timesig.imperfectum2") }));
		} else if (elem.type === "tempus_perfectum") {
			abselem.addRight(new RelativeElement("timesig.perfectum", 0, glyphs.getSymbolWidth("timesig.perfectum"), 6, { thickness: glyphs.symbolHeightInPitches("timesig.perfectum") }));
		} else if (elem.type === "tempus_perfectum_prolatio") {
			abselem.addRight(new RelativeElement("timesig.perfectum2", 0, glyphs.getSymbolWidth("timesig.perfectum2"), 6, { thickness: glyphs.symbolHeightInPitches("timesig.perfectum2") }));
		} else {
			console.log("time signature:",elem);
		}
		return abselem;
	};
})();

module.exports = createTimeSignature;

},{"./abc_absolute_element":17,"./abc_glyphs":29,"./abc_relative_element":30}],24:[function(require,module,exports){
//    abc_crescendo_element.js: Definition of the CrescendoElem class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var sprintf = require('./sprintf');

var CrescendoElem = function CrescendoElem(anchor1, anchor2, dir, positioning) {
	this.anchor1 = anchor1; // must have a .x and a .parent property or be null (means starts at the "beginning" of the line - after keysig)
	this.anchor2 = anchor2; // must have a .x property or be null (means ends at the end of the line)
	this.dir = dir; // either "<" or ">"
	if (positioning === 'above')
		this.dynamicHeightAbove = 4;
	else
		this.dynamicHeightBelow = 4;
	this.pitch = undefined; // This will be set later
};

CrescendoElem.prototype.setUpperAndLowerElements = function(positionY) {
	if (this.dynamicHeightAbove)
		this.pitch = positionY.dynamicHeightAbove;
	else
		this.pitch = positionY.dynamicHeightBelow;
};

CrescendoElem.prototype.draw = function (renderer) {
	if (this.pitch === undefined)
		window.console.error("Crescendo Element y-coordinate not set.");
	var y = renderer.calcY(this.pitch) + 4; // This is the top pixel to use (it is offset a little so that it looks good with the volume marks.)
	var height = 8;
	if (this.dir === "<") {
		this.drawLine(renderer, y+height/2, y);
		this.drawLine(renderer, y+height/2, y+height);
	} else {
		this.drawLine(renderer, y, y+height/2);
		this.drawLine(renderer, y+height, y+height/2);
	}
};

CrescendoElem.prototype.drawLine = function (renderer, y1, y2) {
	// TODO-PER: This is just a quick hack to make the dynamic marks not crash if they are mismatched. See the slur treatment for the way to get the beginning and end.
	var left = this.anchor1 ? this.anchor1.x : 0;
	var right = this.anchor2 ? this.anchor2.x : 800;
	var pathString = sprintf("M %f %f L %f %f",
		left, y1, right, y2);
	renderer.printPath({path:pathString, stroke:"#000000", 'class': renderer.addClasses('decoration')});
};

module.exports = CrescendoElem;

},{"./sprintf":38}],25:[function(require,module,exports){
// abc_decoration.js: Creates a data structure suitable for printing a line of abc
// Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) & Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

/*global window */

var DynamicDecoration = require('./abc_dynamic_decoration');
var CrescendoElem = require('./abc_crescendo_element');
var glyphs = require('./abc_glyphs');
var RelativeElement = require('./abc_relative_element');
var TieElem = require('./abc_tie_element');

var Decoration;

(function() {
	"use strict";

	Decoration = function Decoration() {
		this.startDiminuendoX = undefined;
		this.startCrescendoX = undefined;
		this.minTop = 12;	// TODO-PER: this is assuming a 5-line staff. Pass that info in.
		this.minBottom = 0;
	};

	var closeDecoration = function(voice, decoration, pitch, width, abselem, roomtaken, dir, minPitch) {
		var yPos;
		for (var i=0;i<decoration.length; i++) {
			if (decoration[i]==="staccato" || decoration[i]==="tenuto" || decoration[i] === "accent") {
				var symbol = "scripts." + decoration[i];
				if (decoration[i] === "accent") symbol = "scripts.sforzato";
				if (yPos === undefined)
					yPos = (dir==="down") ? pitch+2:minPitch-2;
				else
					yPos = (dir==="down") ? yPos+2:yPos-2;
				if (decoration[i] === "accent") {
					// Always place the accent three pitches away, no matter whether that is a line or space.
					if (dir === "up") yPos--;
					else yPos++;
				} else {
					// don't place on a stave line. The stave lines are 2,4,6,8,10
					switch (yPos) {
						case 2:
						case 4:
						case 6:
						case 8:
						case 10:
							if (dir === "up") yPos--;
							else yPos++;
							break;
					}
				}
				if (pitch>9) yPos++; // take up some room of those that are above
				var deltaX = width/2;
				if (glyphs.getSymbolAlign(symbol)!=="center") {
					deltaX -= (glyphs.getSymbolWidth(symbol)/2);
				}
				abselem.addChild(new RelativeElement(symbol, deltaX, glyphs.getSymbolWidth(symbol), yPos));
			}
			if (decoration[i]==="slide" && abselem.heads[0]) {
				var yPos2 = abselem.heads[0].pitch;
				yPos2 -= 2; // TODO-PER: not sure what this fudge factor is.
				var blank1 = new RelativeElement("", -roomtaken-15, 0, yPos2-1);
				var blank2 = new RelativeElement("", -roomtaken-5, 0, yPos2+1);
				abselem.addChild(blank1);
				abselem.addChild(blank2);
				voice.addOther(new TieElem(blank1, blank2, false, false, false));
			}
		}
		if (yPos === undefined)
			yPos = pitch;

		return { above: yPos, below: abselem.bottom };
	};

	var volumeDecoration = function(voice, decoration, abselem, positioning) {
		for (var i=0;i<decoration.length; i++) {
			switch(decoration[i]) {
				case "p":
				case "mp":
				case "pp":
				case "ppp":
				case "pppp":
				case "f":
				case "ff":
				case "fff":
				case "ffff":
				case "sfz":
				case "mf":
					var elem = new DynamicDecoration(abselem, decoration[i], positioning);
					voice.addOther(elem);
			}
		}
	};

	var compoundDecoration = function(decoration, pitch, width, abselem, dir) {
		function highestPitch() {
			if (abselem.heads.length === 0)
				return 10;	// TODO-PER: I don't know if this can happen, but we'll return the top of the staff if so.
			var pitch = abselem.heads[0].pitch;
			for (var i = 1; i < abselem.heads.length; i++)
				pitch = Math.max(pitch, abselem.heads[i].pitch);
			return pitch;
		}
		function lowestPitch() {
			if (abselem.heads.length === 0)
				return 2;	// TODO-PER: I don't know if this can happen, but we'll return the bottom of the staff if so.
			var pitch = abselem.heads[0].pitch;
			for (var i = 1; i < abselem.heads.length; i++)
				pitch = Math.min(pitch, abselem.heads[i].pitch);
			return pitch;
		}
		function compoundDecoration(symbol, count) {
			var placement = (dir === 'down') ? lowestPitch()+1:highestPitch()+9;
			if (dir !== 'down' && count === 1)
				placement--;
			var deltaX = width/2;
			deltaX += (dir === 'down') ? -5 : 3;
			for (var i = 0; i < count; i++) {
				placement -= 1;
				abselem.addChild(new RelativeElement(symbol, deltaX, glyphs.getSymbolWidth(symbol), placement));
			}
		}

		for (var i=0;i<decoration.length; i++) {
			switch(decoration[i]) {
				case "/": compoundDecoration("flags.ugrace", 1); break;
				case "//": compoundDecoration("flags.ugrace", 2); break;
				case "///": compoundDecoration("flags.ugrace", 3); break;
				case "////": compoundDecoration("flags.ugrace", 4); break;
			}
		}
	};

	var stackedDecoration = function(decoration, width, abselem, yPos, positioning, minTop, minBottom) {
		function incrementPlacement(placement, height) {
			if (placement === 'above')
				yPos.above += height;
			else
				yPos.below -= height;
		}
		function getPlacement(placement) {
			var y;
			if (placement === 'above') {
				y = yPos.above;
				if (y < minTop)
					y = minTop;
			} else {
				y = yPos.below;
				if (y > minBottom)
					y = minBottom;
			}
			return y;
		}
		function textDecoration(text, placement) {
			var y = getPlacement(placement);
			var textFudge = 2;
			var textHeight = 5;
			// TODO-PER: Get the height of the current font and use that for the thickness.
			abselem.addChild(new RelativeElement(text, width/2, 0, y+textFudge, {type:"decoration", klass: 'ornament', thickness: 3}));

			incrementPlacement(placement, textHeight);
		}
		function symbolDecoration(symbol, placement) {
			var deltaX = width/2;
			if (glyphs.getSymbolAlign(symbol) !== "center") {
				deltaX -= (glyphs.getSymbolWidth(symbol) / 2);
			}
			var height = glyphs.symbolHeightInPitches(symbol) + 1; // adding a little padding so nothing touches.
			var y = getPlacement(placement);
			y = (placement === 'above') ? y + height/2 : y - height/2;// Center the element vertically.
			abselem.addChild(new RelativeElement(symbol, deltaX, glyphs.getSymbolWidth(symbol), y, { klass: 'ornament', thickness: glyphs.symbolHeightInPitches(symbol) }));

			incrementPlacement(placement, height);
		}

		var symbolList = {
			"+": "scripts.stopped",
			"open": "scripts.open",
			"snap": "scripts.snap",
			"wedge": "scripts.wedge",
			"thumb": "scripts.thumb",
			"shortphrase": "scripts.shortphrase",
			"mediumphrase": "scripts.mediumphrase",
			"longphrase": "scripts.longphrase",
			"trill": "scripts.trill",
			"roll": "scripts.roll",
			"irishroll": "scripts.roll",
			"marcato": "scripts.umarcato",
			"dmarcato": "scripts.dmarcato",
			"umarcato": "scripts.umarcato",
			"turn": "scripts.turn",
			"uppermordent": "scripts.prall",
			"pralltriller": "scripts.prall",
			"mordent": "scripts.mordent",
			"lowermordent": "scripts.mordent",
			"downbow": "scripts.downbow",
			"upbow": "scripts.upbow",
			"fermata": "scripts.ufermata",
			"invertedfermata": "scripts.dfermata",
			"breath": ",",
			"coda": "scripts.coda",
			"segno": "scripts.segno"
		};

		var hasOne = false;
		for (var i=0;i<decoration.length; i++) {
			switch(decoration[i]) {
				case "0":
				case "1":
				case "2":
				case "3":
				case "4":
				case "5":
				case "D.C.":
				case "D.S.":
					textDecoration(decoration[i], positioning);
					hasOne = true;
					break;
				case "fine":
					textDecoration("FINE", positioning);
					hasOne = true;
					break;
				case "+":
				case "open":
				case "snap":
				case "wedge":
				case "thumb":
				case "shortphrase":
				case "mediumphrase":
				case "longphrase":
				case "trill":
				case "roll":
				case "irishroll":
				case "marcato":
				case "dmarcato":
				case "turn":
				case "uppermordent":
				case "pralltriller":
				case "mordent":
				case "lowermordent":
				case "downbow":
				case "upbow":
				case "fermata":
				case "breath":
				case "umarcato":
				case "coda":
				case "segno":
					symbolDecoration(symbolList[decoration[i]], positioning);
					hasOne = true;
					break;
				case "invertedfermata":
					symbolDecoration(symbolList[decoration[i]], 'below');
					hasOne = true;
					break;
				case "mark":
					abselem.klass = "mark";
					break;
			}
		}
		return hasOne;
	};

	Decoration.prototype.dynamicDecoration = function(voice, decoration, abselem, positioning) {
		var diminuendo;
		var crescendo;
		for (var i=0;i<decoration.length; i++) {
			switch(decoration[i]) {
				case "diminuendo(":
					this.startDiminuendoX = abselem;
					diminuendo = undefined;
					break;
				case "diminuendo)":
					diminuendo = { start: this.startDiminuendoX, stop: abselem};
					this.startDiminuendoX = undefined;
					break;
				case "crescendo(":
					this.startCrescendoX = abselem;
					crescendo = undefined;
					break;
				case "crescendo)":
					crescendo = { start: this.startCrescendoX, stop: abselem};
					this.startCrescendoX = undefined;
					break;
			}
		}
		if (diminuendo) {
			voice.addOther(new CrescendoElem(diminuendo.start, diminuendo.stop, ">", positioning));
		}
		if (crescendo) {
			voice.addOther(new CrescendoElem(crescendo.start, crescendo.stop, "<", positioning));
		}
	};

	Decoration.prototype.createDecoration = function(voice, decoration, pitch, width, abselem, roomtaken, dir, minPitch, positioning, hasVocals) {
		if (!positioning)
			positioning = { ornamentPosition: 'above', volumePosition: hasVocals ? 'above' :'below', dynamicPosition: hasVocals ? 'above' : 'below' };
		// These decorations don't affect the placement of other decorations
		volumeDecoration(voice, decoration, abselem, positioning.volumePosition);
		this.dynamicDecoration(voice, decoration, abselem, positioning.dynamicPosition);
		compoundDecoration(decoration, pitch, width, abselem, dir);

		// treat staccato, accent, and tenuto first (may need to shift other markers)
		var yPos = closeDecoration(voice, decoration, pitch, width, abselem, roomtaken, dir, minPitch);
		// yPos is an object containing 'above' and 'below'. That is the placement of the next symbol on either side.

		yPos.above = Math.max(yPos.above, this.minTop);
		var hasOne = stackedDecoration(decoration, width, abselem, yPos, positioning.ornamentPosition, this.minTop, this.minBottom);
		if (hasOne) {
//			abselem.top = Math.max(yPos.above + 3, abselem.top); // TODO-PER: Not sure why we need this fudge factor.
		}
	};

})();

module.exports = Decoration;

},{"./abc_crescendo_element":24,"./abc_dynamic_decoration":26,"./abc_glyphs":29,"./abc_relative_element":30,"./abc_tie_element":35}],26:[function(require,module,exports){
//    abc_dynamic_decoration.js: Definition of the DynamicDecoration class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var spacing = require('./abc_spacing');

var DynamicDecoration = function DynamicDecoration(anchor, dec, position) {
	this.anchor = anchor;
	this.dec = dec;
	if (position === 'below')
		this.volumeHeightBelow = 5;
	else
		this.volumeHeightAbove = 5;
	this.pitch = undefined; // This will be set later
};

DynamicDecoration.prototype.setUpperAndLowerElements = function(positionY) {
	if (this.volumeHeightAbove)
		this.pitch = positionY.volumeHeightAbove;
	else
		this.pitch = positionY.volumeHeightBelow;
};

DynamicDecoration.prototype.draw = function(renderer, linestartx, lineendx) {
	if (this.pitch === undefined)
		window.console.error("Dynamic Element y-coordinate not set.");
	var scalex = 1;
	var scaley = 1;
	renderer.printSymbol(this.anchor.x, this.pitch, this.dec, scalex, scaley, renderer.addClasses('decoration'));
};

module.exports = DynamicDecoration;

},{"./abc_spacing":32}],27:[function(require,module,exports){
//    abc_ending_element.js: Definition of the EndingElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var sprintf = require('./sprintf');

var EndingElem = function EndingElem(text, anchor1, anchor2) {
	this.text = text; // text to be displayed top left
	this.anchor1 = anchor1; // must have a .x property or be null (means starts at the "beginning" of the line - after keysig)
	this.anchor2 = anchor2; // must have a .x property or be null (means ends at the end of the line)
	this.endingHeightAbove = 5;
	this.pitch = undefined; // This will be set later
};

EndingElem.prototype.setUpperAndLowerElements = function(positionY) {
	this.pitch = positionY.endingHeightAbove - 2;
};

EndingElem.prototype.draw = function (renderer, linestartx, lineendx) {
	if (this.pitch === undefined)
		window.console.error("Ending Element y-coordinate not set.");
	var y = renderer.calcY(this.pitch);
	var height = 20;
	var pathString;
	if (this.anchor1) {
		linestartx = this.anchor1.x+this.anchor1.w;
		pathString = sprintf("M %f %f L %f %f",
			linestartx, y, linestartx, y+height);
		renderer.printPath({path:pathString, stroke:"#000000", fill:"#000000", 'class': renderer.addClasses('ending')});
		renderer.renderText(linestartx+5, renderer.calcY(this.pitch-0.5), this.text, 'repeatfont', 'ending',"start");
	}

	if (this.anchor2) {
		lineendx = this.anchor2.x;
		pathString = sprintf("M %f %f L %f %f",
			lineendx, y, lineendx, y+height);
		renderer.printPath({path:pathString, stroke:"#000000", fill:"#000000", 'class': renderer.addClasses('ending')});
	}


	pathString = sprintf("M %f %f L %f %f",
		linestartx, y, lineendx, y);
	renderer.printPath({path:pathString, stroke:"#000000", fill:"#000000", 'class': renderer.addClasses('ending')});
};

module.exports = EndingElem;

},{"./sprintf":38}],28:[function(require,module,exports){
//    abc_engraver_controller.js: Controls the engraving process of an ABCJS abstract syntax tree as produced by ABCJS/parse
//    Copyright (C) 2014-2018 Gregory Dyke (gregdyke at gmail dot com)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


/*global Math */

var spacing = require('./abc_spacing');
var AbstractEngraver = require('./abc_abstract_engraver');
var Renderer = require('./abc_renderer');

/**
 * @class
 * Controls the engraving process, from ABCJS Abstract Syntax Tree (ABCJS AST) to rendered score sheet
 *
 * Call engraveABC to run the process. This creates a graphelems ABCJS Abstract Engraving Structure (ABCJS AES) that can be accessed through this.staffgroups
 * this data structure is first laid out (giving the graphelems x and y coordinates) and then drawn onto the renderer
 * each ABCJS AES represents a single staffgroup - all elements that are not in a staffgroup are rendered directly by the controller
 *
 * elements in ABCJS AES know their "source data" in the ABCJS AST, and their "target shape" 
 * in the renderer for highlighting purposes
 *
 * @param {Object} paper div element that will wrap the SVG
 * @param {Object} params all the params -- documented on github //TODO-GD move some of that documentation here
 */
var EngraverController = function(paper, params) {
  params = params || {};
  this.responsive = params.responsive;
  this.space = 3*spacing.SPACE;
  this.scale = params.scale ? parseFloat(params.scale) : 0;
  if (!(this.scale > 0.1))
  	this.scale = undefined;

	if (params.staffwidth) {
		// Note: Normally all measurements to the engraver are in POINTS. However, if a person is formatting for the
		// screen and directly inputting the width, then it is more logical to have the measurement in pixels.
		this.staffwidthScreen = params.staffwidth;
		this.staffwidthPrint = params.staffwidth;
	} else {
		this.staffwidthScreen = 740; // TODO-PER: Not sure where this number comes from, but this is how it's always been.
		this.staffwidthPrint = 680; // The number of pixels in 8.5", after 1cm of margin has been removed.
	}
  this.editable = params.editable || false;
	this.listeners = [];
	if (params.clickListener)
		this.addSelectListener(params.clickListener);

  this.renderer=new Renderer(paper, params.regression, params.add_classes);
	this.renderer.setPaddingOverride(params);
  this.renderer.controller = this; // TODO-GD needed for highlighting

	this.reset();
};

EngraverController.prototype.reset = function() {
	this.selected = [];
	this.ingroup = false;
	this.staffgroups = [];
	this.lastStaffGroupIndex = -1;
	if (this.engraver)
		this.engraver.reset();
	this.engraver = null;
	this.renderer.reset();
};

/**
 * run the engraving process
 * @param {ABCJS.Tune|ABCJS.Tune[]} abctunes 
 */
EngraverController.prototype.engraveABC = function(abctunes, tuneNumber) {
  if (abctunes[0]===undefined) {
    abctunes = [abctunes];
  }
	this.reset();

  for (var i = 0; i < abctunes.length; i++) {
  	if (tuneNumber === undefined)
  		tuneNumber = i;
    this.engraveTune(abctunes[i], tuneNumber);
  }
	if (this.renderer.doRegression)
		return this.renderer.regressionLines.join("\n");
};

/**
 * Some of the items on the page are not scaled, so adjust them in the opposite direction of scaling to cancel out the scaling.
 * @param {float} scale
 */
EngraverController.prototype.adjustNonScaledItems = function (scale) {
	this.width /= scale;
	this.renderer.adjustNonScaledItems(scale);
};

EngraverController.prototype.getMeasureWidths = function(abcTune) {
	this.reset();

	this.renderer.lineNumber = null;

	this.renderer.newTune(abcTune);
	this.engraver = new AbstractEngraver(abcTune.formatting.bagpipes,this.renderer, 0);
	this.engraver.setStemHeight(this.renderer.spacing.stemHeight);
	if (abcTune.formatting.staffwidth) {
		this.width = abcTune.formatting.staffwidth * 1.33; // The width is expressed in pt; convert to px.
	} else {
		this.width = this.renderer.isPrint ? this.staffwidthPrint : this.staffwidthScreen;
	}

	var scale = abcTune.formatting.scale ? abcTune.formatting.scale : this.scale;
	if (this.responsive === "resize") // The resizing will mess with the scaling, so just don't do it explicitly.
		scale = undefined;
	if (scale === undefined) scale = this.renderer.isPrint ? 0.75 : 1;
	this.adjustNonScaledItems(scale);

	var ret = { left: 0, measureWidths: [] };
	var debug = false;
	var hasPrintedTempo = false;
	for(var i=0; i<abcTune.lines.length; i++) {
		var abcLine = abcTune.lines[i];
		if (abcLine.staff) {
			abcLine.staffGroup = this.engraver.createABCLine(abcLine.staff, !hasPrintedTempo ? abcTune.metaText.tempo: null);

			abcLine.staffGroup.layout(0, this.renderer, debug);
			// At this point, the voices are laid out so that the bar lines are even with each other. So we just need to get the placement of the first voice.
			if (abcLine.staffGroup.voices.length > 0) {
				var voice = abcLine.staffGroup.voices[0];
				var foundNotStaffExtra = false;
				var lastXPosition = 0;
				for (var k = 0; k < voice.children.length; k++) {
					var child = voice.children[k];
					if (!foundNotStaffExtra && !child.isClef && !child.isKeySig) {
						foundNotStaffExtra = true;
						ret.left = child.x;
						lastXPosition = child.x;
					}
					if (child.type === 'bar') {
						ret.measureWidths.push(child.x - lastXPosition);
						lastXPosition = child.x;
					}
				}
			}
			hasPrintedTempo = true;
		}
	}
	return ret;
};

/**
 * Run the engraving process on a single tune
 * @param {ABCJS.Tune} abctune
 */
EngraverController.prototype.engraveTune = function (abctune, tuneNumber) {
	this.renderer.lineNumber = null;

	this.renderer.newTune(abctune);
	this.engraver = new AbstractEngraver(abctune.formatting.bagpipes,this.renderer, tuneNumber);
	this.engraver.setStemHeight(this.renderer.spacing.stemHeight);
	if (abctune.formatting.staffwidth) {
		this.width = abctune.formatting.staffwidth * 1.33; // The width is expressed in pt; convert to px.
	} else {
		this.width = this.renderer.isPrint ? this.staffwidthPrint : this.staffwidthScreen;
	}

	var scale = abctune.formatting.scale ? abctune.formatting.scale : this.scale;
	if (this.responsive === "resize") // The resizing will mess with the scaling, so just don't do it explicitly.
		scale = undefined;
	if (scale === undefined) scale = this.renderer.isPrint ? 0.75 : 1;
	this.adjustNonScaledItems(scale);

	// Generate the raw staff line data
	var i;
	var abcLine;
	var hasPrintedTempo = false;
	for(i=0; i<abctune.lines.length; i++) {
		abcLine = abctune.lines[i];
		if (abcLine.staff) {
			abcLine.staffGroup = this.engraver.createABCLine(abcLine.staff, !hasPrintedTempo ? abctune.metaText.tempo: null);
			hasPrintedTempo = true;
		}
	}

	// Adjust the x-coordinates to their absolute positions
	var maxWidth = this.width;
	for(i=0; i<abctune.lines.length; i++) {
		abcLine = abctune.lines[i];
		if (abcLine.staff) {
			this.setXSpacing(abcLine.staffGroup, abctune.formatting, i === abctune.lines.length - 1, false);
			if (abcLine.staffGroup.w > maxWidth) maxWidth = abcLine.staffGroup.w;
		}
	}

	// Layout the beams and add the stems to the beamed notes.
	for(i=0; i<abctune.lines.length; i++) {
		abcLine = abctune.lines[i];
		if (abcLine.staffGroup && abcLine.staffGroup.voices) {
			for (var j = 0; j < abcLine.staffGroup.voices.length; j++)
				abcLine.staffGroup.voices[j].layoutBeams();
			abcLine.staffGroup.setUpperAndLowerElements(this.renderer);
		}
	}

	// Set the staff spacing
	// TODO-PER: we should have been able to do this by the time we called setUpperAndLowerElements, but for some reason the "bottom" element seems to be set as a side effect of setting the X spacing.
	for(i=0; i<abctune.lines.length; i++) {
		abcLine = abctune.lines[i];
		if (abcLine.staffGroup) {
			abcLine.staffGroup.height = abcLine.staffGroup.calcHeight();
		}
	}

	// Do all the writing to output
	this.renderer.topMargin(abctune);
	//this.renderer.printHorizontalLine(this.width + this.renderer.padding.left + this.renderer.padding.right);
	this.renderer.engraveTopText(this.width, abctune);
	this.renderer.addMusicPadding();

	this.staffgroups = [];
	this.lastStaffGroupIndex = -1;
	for (var line = 0; line < abctune.lines.length; line++) {
		this.renderer.lineNumber = line;
		abcLine = abctune.lines[line];
		if (abcLine.staff) {
			this.engraveStaffLine(abcLine.staffGroup);
		} else if (abcLine.subtitle && line !== 0) {
			this.renderer.outputSubtitle(this.width, abcLine.subtitle);
		} else if (abcLine.text !== undefined) {
			this.renderer.outputFreeText(abcLine.text);
		}
	}

	this.renderer.moveY(24); // TODO-PER: Empirically discovered. What variable should this be?
	this.renderer.engraveExtraText(this.width, abctune);
	this.renderer.setPaperSize(maxWidth, scale, this.responsive);
};

function calcHorizontalSpacing(isLastLine, stretchLast, targetWidth, lineWidth, spacing, spacingUnits, minSpace) {
	// TODO-PER: This used to stretch the first line when it is the only line, but I'm not sure why. abcm2ps doesn't do that
	if (isLastLine && lineWidth / targetWidth < 0.66 && !stretchLast) return null; // don't stretch last line too much
	if (Math.abs(targetWidth-lineWidth) < 2) return null; // if we are already near the target width, we're done.
	var relSpace = spacingUnits * spacing;
	var constSpace = lineWidth - relSpace;
	if (spacingUnits > 0) {
		spacing = (targetWidth - constSpace) / spacingUnits;
		if (spacing * minSpace > 50) {
			spacing = 50 / minSpace;
		}
		return spacing;
	}
	return null;
}

/**
 * Do the x-axis positioning for a single line (a group of related staffs)
 * @param {ABCJS.Tune} abctune an ABCJS AST
 * @param {Object} staffGroup an staffGroup
 * @param {Object} formatting an formatting
 * @param {boolean} isLastLine is this the last line to be printed?
 * @private
 */
EngraverController.prototype.setXSpacing = function (staffGroup, formatting, isLastLine, debug) {
   var newspace = this.space;
  for (var it = 0; it < 8; it++) { // TODO-PER: shouldn't need multiple passes, but each pass gets it closer to the right spacing. (Only affects long lines: normal lines break out of this loop quickly.)
	  var ret = staffGroup.layout(newspace, this.renderer, debug);
	  var stretchLast = formatting.stretchlast ? formatting.stretchlast : false;
		newspace = calcHorizontalSpacing(isLastLine, stretchLast, this.width+this.renderer.padding.left, staffGroup.w, newspace, ret.spacingUnits, ret.minSpace);
		if (debug)
			console.log("setXSpace", it, staffGroup.w, newspace, staffGroup.minspace);
		if (newspace === null) break;
  }
	centerWholeRests(staffGroup.voices);
	//this.renderer.printHorizontalLine(this.width);
};

/**
 * Engrave a single line (a group of related staffs)
 * @param {ABCJS.Tune} abctune an ABCJS AST
 * @param {Object} staffGroup an staffGroup
 * @private
 */
EngraverController.prototype.engraveStaffLine = function (staffGroup) {
	if (this.lastStaffGroupIndex > -1)
		this.renderer.addStaffPadding(this.staffgroups[this.lastStaffGroupIndex], staffGroup);
	this.renderer.voiceNumber = null;
	staffGroup.draw(this.renderer);
	var height = staffGroup.height * spacing.STEP;
	//this.renderer.printVerticalLine(this.width+this.renderer.padding.left, this.renderer.y, this.renderer.y+height);
  this.staffgroups[this.staffgroups.length] = staffGroup;
	this.lastStaffGroupIndex = this.staffgroups.length-1;
	this.renderer.y += height;
};

/**
 * Called by the Abstract Engraving Structure or any other (e.g. midi playback) to say it was selected (notehead clicked on)
 * @protected
 */
EngraverController.prototype.notifySelect = function (abselem, tuneNumber, classes) {
  this.clearSelection();
  if (abselem.highlight) {
    this.selected = [abselem];
    abselem.highlight();
  }
  var abcelem = abselem.abcelem || {};
  for (var i=0; i<this.listeners.length;i++) {
	  this.listeners[i](abcelem, tuneNumber, classes);
  }
};

/**
 * Called by the Abstract Engraving Structure to say it was modified (e.g. notehead dragged)
 * @protected
 */
// EngraverController.prototype.notifyChange = function (/*abselem*/) {
//   for (var i=0; i<this.listeners.length;i++) {
//     if (this.listeners[i].modelChanged)
//       this.listeners[i].modelChanged();
//   }
// };

/**
 *
 * @private
 */
EngraverController.prototype.clearSelection = function () {
  for (var i=0;i<this.selected.length;i++) {
    this.selected[i].unhighlight();
  }
  this.selected = [];
};

/**
 * @param {Object} listener
 * @param {Function} listener.modelChanged the model the listener passed to this controller has changed
 * @param {Function} listener.highlight the abcelem of the model the listener passed to this controller should be highlighted
 */
EngraverController.prototype.addSelectListener = function (clickListener) {
  this.listeners[this.listeners.length] = clickListener;
};

/**
 * Tell the controller to highlight some noteheads of its engraved score
 * @param {number} start the character in the source abc where highlighting should start
 * @param {number} end the character in the source abc where highlighting should end
 */
EngraverController.prototype.rangeHighlight = function(start,end)
{
    this.clearSelection();
    for (var line=0;line<this.staffgroups.length; line++) {
	var voices = this.staffgroups[line].voices;
	for (var voice=0;voice<voices.length;voice++) {
	    var elems = voices[voice].children;
	    for (var elem=0; elem<elems.length; elem++) {
		// Since the user can highlight more than an element, or part of an element, a hit is if any of the endpoints
		// is inside the other range.
		var elStart = elems[elem].abcelem.startChar;
		var elEnd = elems[elem].abcelem.endChar;
		if ((end>elStart && start<elEnd) || ((end===start) && end===elEnd)) {
		    //		if (elems[elem].abcelem.startChar>=start && elems[elem].abcelem.endChar<=end) {
		    this.selected[this.selected.length]=elems[elem];
		    elems[elem].highlight();
		}
	    }
	}
    }
};


function centerWholeRests(voices) {
	// whole rests are a special case: if they are by themselves in a measure, then they should be centered.
	// (If they are not by themselves, that is probably a user error, but we'll just center it between the two items to either side of it.)
	for (var i = 0; i < voices.length; i++) {
		var voice = voices[i];
		// Look through all of the elements except for the first and last. If the whole note appears there then there isn't anything to center it between anyway.
		for (var j = 1; j < voice.children.length-1; j++) {
			var absElem = voice.children[j];
			if (absElem.abcelem.rest && (absElem.abcelem.rest.type === 'whole' || absElem.abcelem.rest.type === 'multimeasure')) {
				var before = voice.children[j-1];
				var after = voice.children[j+1];
				var midpoint = (after.x - before.x) / 2 + before.x;
				absElem.x = midpoint - absElem.w / 2;
				for (var k = 0; k < absElem.children.length; k++)
					absElem.children[k].x = absElem.x;
			}
		}
	}
}

module.exports = EngraverController;

},{"./abc_abstract_engraver":18,"./abc_renderer":31,"./abc_spacing":32}],29:[function(require,module,exports){
var spacing = require('./abc_spacing');

/**
 * Glyphs and some methods to adjust for their x and y baseline
 */
var Glyphs = function() {
	"use strict";
	var glyphs =
	{'0':{d:[['M',4.83,-14.97],['c',0.33,-0.03,1.11,0.00,1.47,0.06],['c',1.68,0.36,2.97,1.59,3.78,3.60],['c',1.20,2.97,0.81,6.96,-0.90,9.27],['c',-0.78,1.08,-1.71,1.71,-2.91,1.95],['c',-0.45,0.09,-1.32,0.09,-1.77,0.00],['c',-0.81,-0.18,-1.47,-0.51,-2.07,-1.02],['c',-2.34,-2.07,-3.15,-6.72,-1.74,-10.20],['c',0.87,-2.16,2.28,-3.42,4.14,-3.66],['z'],['m',1.11,0.87],['c',-0.21,-0.06,-0.69,-0.09,-0.87,-0.06],['c',-0.54,0.12,-0.87,0.42,-1.17,0.99],['c',-0.36,0.66,-0.51,1.56,-0.60,3.00],['c',-0.03,0.75,-0.03,4.59,0.00,5.31],['c',0.09,1.50,0.27,2.40,0.60,3.06],['c',0.24,0.48,0.57,0.78,0.96,0.90],['c',0.27,0.09,0.78,0.09,1.05,0.00],['c',0.39,-0.12,0.72,-0.42,0.96,-0.90],['c',0.33,-0.66,0.51,-1.56,0.60,-3.06],['c',0.03,-0.72,0.03,-4.56,0.00,-5.31],['c',-0.09,-1.47,-0.27,-2.37,-0.60,-3.03],['c',-0.24,-0.48,-0.54,-0.78,-0.93,-0.90],['z']],w:10.78,h:14.959},
		'1':{d:[['M',3.30,-15.06],['c',0.06,-0.06,0.21,-0.03,0.66,0.15],['c',0.81,0.39,1.08,0.39,1.83,0.03],['c',0.21,-0.09,0.39,-0.15,0.42,-0.15],['c',0.12,0.00,0.21,0.09,0.27,0.21],['c',0.06,0.12,0.06,0.33,0.06,5.94],['c',0.00,3.93,0.00,5.85,0.03,6.03],['c',0.06,0.36,0.15,0.69,0.27,0.96],['c',0.36,0.75,0.93,1.17,1.68,1.26],['c',0.30,0.03,0.39,0.09,0.39,0.30],['c',0.00,0.15,-0.03,0.18,-0.09,0.24],['c',-0.06,0.06,-0.09,0.06,-0.48,0.06],['c',-0.42,0.00,-0.69,-0.03,-2.10,-0.24],['c',-0.90,-0.15,-1.77,-0.15,-2.67,0.00],['c',-1.41,0.21,-1.68,0.24,-2.10,0.24],['c',-0.39,0.00,-0.42,0.00,-0.48,-0.06],['c',-0.06,-0.06,-0.06,-0.09,-0.06,-0.24],['c',0.00,-0.21,0.06,-0.27,0.36,-0.30],['c',0.75,-0.09,1.32,-0.51,1.68,-1.26],['c',0.12,-0.27,0.21,-0.60,0.27,-0.96],['c',0.03,-0.18,0.03,-1.59,0.03,-4.29],['c',0.00,-3.87,0.00,-4.05,-0.06,-4.14],['c',-0.09,-0.15,-0.18,-0.24,-0.39,-0.24],['c',-0.12,0.00,-0.15,0.03,-0.21,0.06],['c',-0.03,0.06,-0.45,0.99,-0.96,2.13],['c',-0.48,1.14,-0.90,2.10,-0.93,2.16],['c',-0.06,0.15,-0.21,0.24,-0.33,0.24],['c',-0.24,0.00,-0.42,-0.18,-0.42,-0.39],['c',0.00,-0.06,3.27,-7.62,3.33,-7.74],['z']],w:8.94,h:15.058},
		'2':{d:[['M',4.23,-14.97],['c',0.57,-0.06,1.68,0.00,2.34,0.18],['c',0.69,0.18,1.50,0.54,2.01,0.90],['c',1.35,0.96,1.95,2.25,1.77,3.81],['c',-0.15,1.35,-0.66,2.34,-1.68,3.15],['c',-0.60,0.48,-1.44,0.93,-3.12,1.65],['c',-1.32,0.57,-1.80,0.81,-2.37,1.14],['c',-0.57,0.33,-0.57,0.33,-0.24,0.27],['c',0.39,-0.09,1.26,-0.09,1.68,0.00],['c',0.72,0.15,1.41,0.45,2.10,0.90],['c',0.99,0.63,1.86,0.87,2.55,0.75],['c',0.24,-0.06,0.42,-0.15,0.57,-0.30],['c',0.12,-0.09,0.30,-0.42,0.30,-0.51],['c',0.00,-0.09,0.12,-0.21,0.24,-0.24],['c',0.18,-0.03,0.39,0.12,0.39,0.30],['c',0.00,0.12,-0.15,0.57,-0.30,0.87],['c',-0.54,1.02,-1.56,1.74,-2.79,2.01],['c',-0.42,0.09,-1.23,0.09,-1.62,0.03],['c',-0.81,-0.18,-1.32,-0.45,-2.01,-1.11],['c',-0.45,-0.45,-0.63,-0.57,-0.96,-0.69],['c',-0.84,-0.27,-1.89,0.12,-2.25,0.90],['c',-0.12,0.21,-0.21,0.54,-0.21,0.72],['c',0.00,0.12,-0.12,0.21,-0.27,0.24],['c',-0.15,0.00,-0.27,-0.03,-0.33,-0.15],['c',-0.09,-0.21,0.09,-1.08,0.33,-1.71],['c',0.24,-0.66,0.66,-1.26,1.29,-1.89],['c',0.45,-0.45,0.90,-0.81,1.92,-1.56],['c',1.29,-0.93,1.89,-1.44,2.34,-1.98],['c',0.87,-1.05,1.26,-2.19,1.20,-3.63],['c',-0.06,-1.29,-0.39,-2.31,-0.96,-2.91],['c',-0.36,-0.33,-0.72,-0.51,-1.17,-0.54],['c',-0.84,-0.03,-1.53,0.42,-1.59,1.05],['c',-0.03,0.33,0.12,0.60,0.57,1.14],['c',0.45,0.54,0.54,0.87,0.42,1.41],['c',-0.15,0.63,-0.54,1.11,-1.08,1.38],['c',-0.63,0.33,-1.20,0.33,-1.83,0.00],['c',-0.24,-0.12,-0.33,-0.18,-0.54,-0.39],['c',-0.18,-0.18,-0.27,-0.30,-0.36,-0.51],['c',-0.24,-0.45,-0.27,-0.84,-0.21,-1.38],['c',0.12,-0.75,0.45,-1.41,1.02,-1.98],['c',0.72,-0.72,1.74,-1.17,2.85,-1.32],['z']],w:10.764,h:14.97},
		'3':{d:[['M',3.78,-14.97],['c',0.30,-0.03,1.41,0.00,1.83,0.06],['c',2.22,0.30,3.51,1.32,3.72,2.91],['c',0.03,0.33,0.03,1.26,-0.03,1.65],['c',-0.12,0.84,-0.48,1.47,-1.05,1.77],['c',-0.27,0.15,-0.36,0.24,-0.45,0.39],['c',-0.09,0.21,-0.09,0.36,0.00,0.57],['c',0.09,0.15,0.18,0.24,0.51,0.39],['c',0.75,0.42,1.23,1.14,1.41,2.13],['c',0.06,0.42,0.06,1.35,0.00,1.71],['c',-0.18,0.81,-0.48,1.38,-1.02,1.95],['c',-0.75,0.72,-1.80,1.20,-3.18,1.38],['c',-0.42,0.06,-1.56,0.06,-1.95,0.00],['c',-1.89,-0.33,-3.18,-1.29,-3.51,-2.64],['c',-0.03,-0.12,-0.03,-0.33,-0.03,-0.60],['c',0.00,-0.36,0.00,-0.42,0.06,-0.63],['c',0.12,-0.30,0.27,-0.51,0.51,-0.75],['c',0.24,-0.24,0.45,-0.39,0.75,-0.51],['c',0.21,-0.06,0.27,-0.06,0.60,-0.06],['c',0.33,0.00,0.39,0.00,0.60,0.06],['c',0.30,0.12,0.51,0.27,0.75,0.51],['c',0.36,0.33,0.57,0.75,0.60,1.20],['c',0.00,0.21,0.00,0.27,-0.06,0.42],['c',-0.09,0.18,-0.12,0.24,-0.54,0.54],['c',-0.51,0.36,-0.63,0.54,-0.60,0.87],['c',0.06,0.54,0.54,0.90,1.38,0.99],['c',0.36,0.06,0.72,0.03,0.96,-0.06],['c',0.81,-0.27,1.29,-1.23,1.44,-2.79],['c',0.03,-0.45,0.03,-1.95,-0.03,-2.37],['c',-0.09,-0.75,-0.33,-1.23,-0.75,-1.44],['c',-0.33,-0.18,-0.45,-0.18,-1.98,-0.18],['c',-1.35,0.00,-1.41,0.00,-1.50,-0.06],['c',-0.18,-0.12,-0.24,-0.39,-0.12,-0.60],['c',0.12,-0.15,0.15,-0.15,1.68,-0.15],['c',1.50,0.00,1.62,0.00,1.89,-0.15],['c',0.18,-0.09,0.42,-0.36,0.54,-0.57],['c',0.18,-0.42,0.27,-0.90,0.30,-1.95],['c',0.03,-1.20,-0.06,-1.80,-0.36,-2.37],['c',-0.24,-0.48,-0.63,-0.81,-1.14,-0.96],['c',-0.30,-0.06,-1.08,-0.06,-1.38,0.03],['c',-0.60,0.15,-0.90,0.42,-0.96,0.84],['c',-0.03,0.30,0.06,0.45,0.63,0.84],['c',0.33,0.24,0.42,0.39,0.45,0.63],['c',0.03,0.72,-0.57,1.50,-1.32,1.65],['c',-1.05,0.27,-2.10,-0.57,-2.10,-1.65],['c',0.00,-0.45,0.15,-0.96,0.39,-1.38],['c',0.12,-0.21,0.54,-0.63,0.81,-0.81],['c',0.57,-0.42,1.38,-0.69,2.25,-0.81],['z']],w:9.735,h:14.967},
		'4':{d:[['M',8.64,-14.94],['c',0.27,-0.09,0.42,-0.12,0.54,-0.03],['c',0.09,0.06,0.15,0.21,0.15,0.30],['c',-0.03,0.06,-1.92,2.31,-4.23,5.04],['c',-2.31,2.73,-4.23,4.98,-4.26,5.01],['c',-0.03,0.06,0.12,0.06,2.55,0.06],['l',2.61,0.00],['l',0.00,-2.37],['c',0.00,-2.19,0.03,-2.37,0.06,-2.46],['c',0.03,-0.06,0.21,-0.18,0.57,-0.42],['c',1.08,-0.72,1.38,-1.08,1.86,-2.16],['c',0.12,-0.30,0.24,-0.54,0.27,-0.57],['c',0.12,-0.12,0.39,-0.06,0.45,0.12],['c',0.06,0.09,0.06,0.57,0.06,3.96],['l',0.00,3.90],['l',1.08,0.00],['c',1.05,0.00,1.11,0.00,1.20,0.06],['c',0.24,0.15,0.24,0.54,0.00,0.69],['c',-0.09,0.06,-0.15,0.06,-1.20,0.06],['l',-1.08,0.00],['l',0.00,0.33],['c',0.00,0.57,0.09,1.11,0.30,1.53],['c',0.36,0.75,0.93,1.17,1.68,1.26],['c',0.30,0.03,0.39,0.09,0.39,0.30],['c',0.00,0.15,-0.03,0.18,-0.09,0.24],['c',-0.06,0.06,-0.09,0.06,-0.48,0.06],['c',-0.42,0.00,-0.69,-0.03,-2.10,-0.24],['c',-0.90,-0.15,-1.77,-0.15,-2.67,0.00],['c',-1.41,0.21,-1.68,0.24,-2.10,0.24],['c',-0.39,0.00,-0.42,0.00,-0.48,-0.06],['c',-0.06,-0.06,-0.06,-0.09,-0.06,-0.24],['c',0.00,-0.21,0.06,-0.27,0.36,-0.30],['c',0.75,-0.09,1.32,-0.51,1.68,-1.26],['c',0.21,-0.42,0.30,-0.96,0.30,-1.53],['l',0.00,-0.33],['l',-2.70,0.00],['c',-2.91,0.00,-2.85,0.00,-3.09,-0.15],['c',-0.18,-0.12,-0.30,-0.39,-0.27,-0.54],['c',0.03,-0.06,0.18,-0.24,0.33,-0.45],['c',0.75,-0.90,1.59,-2.07,2.13,-3.03],['c',0.33,-0.54,0.84,-1.62,1.05,-2.16],['c',0.57,-1.41,0.84,-2.64,0.90,-4.05],['c',0.03,-0.63,0.06,-0.72,0.24,-0.81],['l',0.12,-0.06],['l',0.45,0.12],['c',0.66,0.18,1.02,0.24,1.47,0.27],['c',0.60,0.03,1.23,-0.09,2.01,-0.33],['z']],w:11.795,h:14.994},
		'5':{d:[['M',1.02,-14.94],['c',0.12,-0.09,0.03,-0.09,1.08,0.06],['c',2.49,0.36,4.35,0.36,6.96,-0.06],['c',0.57,-0.09,0.66,-0.06,0.81,0.06],['c',0.15,0.18,0.12,0.24,-0.15,0.51],['c',-1.29,1.26,-3.24,2.04,-5.58,2.31],['c',-0.60,0.09,-1.20,0.12,-1.71,0.12],['c',-0.39,0.00,-0.45,0.00,-0.57,0.06],['c',-0.09,0.06,-0.15,0.12,-0.21,0.21],['l',-0.06,0.12],['l',0.00,1.65],['l',0.00,1.65],['l',0.21,-0.21],['c',0.66,-0.57,1.41,-0.96,2.19,-1.14],['c',0.33,-0.06,1.41,-0.06,1.95,0.00],['c',2.61,0.36,4.02,1.74,4.26,4.14],['c',0.03,0.45,0.03,1.08,-0.03,1.44],['c',-0.18,1.02,-0.78,2.01,-1.59,2.70],['c',-0.72,0.57,-1.62,1.02,-2.49,1.20],['c',-1.38,0.27,-3.03,0.06,-4.20,-0.54],['c',-1.08,-0.54,-1.71,-1.32,-1.86,-2.28],['c',-0.09,-0.69,0.09,-1.29,0.57,-1.74],['c',0.24,-0.24,0.45,-0.39,0.75,-0.51],['c',0.21,-0.06,0.27,-0.06,0.60,-0.06],['c',0.33,0.00,0.39,0.00,0.60,0.06],['c',0.30,0.12,0.51,0.27,0.75,0.51],['c',0.36,0.33,0.57,0.75,0.60,1.20],['c',0.00,0.21,0.00,0.27,-0.06,0.42],['c',-0.09,0.18,-0.12,0.24,-0.54,0.54],['c',-0.18,0.12,-0.36,0.30,-0.42,0.33],['c',-0.36,0.42,-0.18,0.99,0.36,1.26],['c',0.51,0.27,1.47,0.36,2.01,0.27],['c',0.93,-0.21,1.47,-1.17,1.65,-2.91],['c',0.06,-0.45,0.06,-1.89,0.00,-2.31],['c',-0.15,-1.20,-0.51,-2.10,-1.05,-2.55],['c',-0.21,-0.18,-0.54,-0.36,-0.81,-0.39],['c',-0.30,-0.06,-0.84,-0.03,-1.26,0.06],['c',-0.93,0.18,-1.65,0.60,-2.16,1.20],['c',-0.15,0.21,-0.27,0.30,-0.39,0.30],['c',-0.15,0.00,-0.30,-0.09,-0.36,-0.18],['c',-0.06,-0.09,-0.06,-0.15,-0.06,-3.66],['c',0.00,-3.39,0.00,-3.57,0.06,-3.66],['c',0.03,-0.06,0.09,-0.15,0.15,-0.18],['z']],w:10.212,h:14.997},
		'6':{d:[['M',4.98,-14.97],['c',0.36,-0.03,1.20,0.00,1.59,0.06],['c',0.90,0.15,1.68,0.51,2.25,1.05],['c',0.57,0.51,0.87,1.23,0.84,1.98],['c',-0.03,0.51,-0.21,0.90,-0.60,1.26],['c',-0.24,0.24,-0.45,0.39,-0.75,0.51],['c',-0.21,0.06,-0.27,0.06,-0.60,0.06],['c',-0.33,0.00,-0.39,0.00,-0.60,-0.06],['c',-0.30,-0.12,-0.51,-0.27,-0.75,-0.51],['c',-0.39,-0.36,-0.57,-0.78,-0.57,-1.26],['c',0.00,-0.27,0.00,-0.30,0.09,-0.42],['c',0.03,-0.09,0.18,-0.21,0.30,-0.30],['c',0.12,-0.09,0.30,-0.21,0.39,-0.27],['c',0.09,-0.06,0.21,-0.18,0.27,-0.24],['c',0.06,-0.12,0.09,-0.15,0.09,-0.33],['c',0.00,-0.18,-0.03,-0.24,-0.09,-0.36],['c',-0.24,-0.39,-0.75,-0.60,-1.38,-0.57],['c',-0.54,0.03,-0.90,0.18,-1.23,0.48],['c',-0.81,0.72,-1.08,2.16,-0.96,5.37],['l',0.00,0.63],['l',0.30,-0.12],['c',0.78,-0.27,1.29,-0.33,2.10,-0.27],['c',1.47,0.12,2.49,0.54,3.27,1.29],['c',0.48,0.51,0.81,1.11,0.96,1.89],['c',0.06,0.27,0.06,0.42,0.06,0.93],['c',0.00,0.54,0.00,0.69,-0.06,0.96],['c',-0.15,0.78,-0.48,1.38,-0.96,1.89],['c',-0.54,0.51,-1.17,0.87,-1.98,1.08],['c',-1.14,0.30,-2.40,0.33,-3.24,0.03],['c',-1.50,-0.48,-2.64,-1.89,-3.27,-4.02],['c',-0.36,-1.23,-0.51,-2.82,-0.42,-4.08],['c',0.30,-3.66,2.28,-6.30,4.95,-6.66],['z'],['m',0.66,7.41],['c',-0.27,-0.09,-0.81,-0.12,-1.08,-0.06],['c',-0.72,0.18,-1.08,0.69,-1.23,1.71],['c',-0.06,0.54,-0.06,3.00,0.00,3.54],['c',0.18,1.26,0.72,1.77,1.80,1.74],['c',0.39,-0.03,0.63,-0.09,0.90,-0.27],['c',0.66,-0.42,0.90,-1.32,0.90,-3.24],['c',0.00,-2.22,-0.36,-3.12,-1.29,-3.42],['z']],w:9.956,h:14.982},
		'7':{d:[['M',0.21,-14.97],['c',0.21,-0.06,0.45,0.00,0.54,0.15],['c',0.06,0.09,0.06,0.15,0.06,0.39],['c',0.00,0.24,0.00,0.33,0.06,0.42],['c',0.06,0.12,0.21,0.24,0.27,0.24],['c',0.03,0.00,0.12,-0.12,0.24,-0.21],['c',0.96,-1.20,2.58,-1.35,3.99,-0.42],['c',0.15,0.12,0.42,0.30,0.54,0.45],['c',0.48,0.39,0.81,0.57,1.29,0.60],['c',0.69,0.03,1.50,-0.30,2.13,-0.87],['c',0.09,-0.09,0.27,-0.30,0.39,-0.45],['c',0.12,-0.15,0.24,-0.27,0.30,-0.30],['c',0.18,-0.06,0.39,0.03,0.51,0.21],['c',0.06,0.18,0.06,0.24,-0.27,0.72],['c',-0.18,0.24,-0.54,0.78,-0.78,1.17],['c',-2.37,3.54,-3.54,6.27,-3.87,9.00],['c',-0.03,0.33,-0.03,0.66,-0.03,1.26],['c',0.00,0.90,0.00,1.08,0.15,1.89],['c',0.06,0.45,0.06,0.48,0.03,0.60],['c',-0.06,0.09,-0.21,0.21,-0.30,0.21],['c',-0.03,0.00,-0.27,-0.06,-0.54,-0.15],['c',-0.84,-0.27,-1.11,-0.30,-1.65,-0.30],['c',-0.57,0.00,-0.84,0.03,-1.56,0.27],['c',-0.60,0.18,-0.69,0.21,-0.81,0.15],['c',-0.12,-0.06,-0.21,-0.18,-0.21,-0.30],['c',0.00,-0.15,0.60,-1.44,1.20,-2.61],['c',1.14,-2.22,2.73,-4.68,5.10,-8.01],['c',0.21,-0.27,0.36,-0.48,0.33,-0.48],['c',0.00,0.00,-0.12,0.06,-0.27,0.12],['c',-0.54,0.30,-0.99,0.39,-1.56,0.39],['c',-0.75,0.03,-1.20,-0.18,-1.83,-0.75],['c',-0.99,-0.90,-1.83,-1.17,-2.31,-0.72],['c',-0.18,0.15,-0.36,0.51,-0.45,0.84],['c',-0.06,0.24,-0.06,0.33,-0.09,1.98],['c',0.00,1.62,-0.03,1.74,-0.06,1.80],['c',-0.15,0.24,-0.54,0.24,-0.69,0.00],['c',-0.06,-0.09,-0.06,-0.15,-0.06,-3.57],['c',0.00,-3.42,0.00,-3.48,0.06,-3.57],['c',0.03,-0.06,0.09,-0.12,0.15,-0.15],['z']],w:10.561,h:15.093},
		'8':{d:[['M',4.98,-14.97],['c',0.33,-0.03,1.02,-0.03,1.32,0.00],['c',1.32,0.12,2.49,0.60,3.21,1.32],['c',0.39,0.39,0.66,0.81,0.78,1.29],['c',0.09,0.36,0.09,1.08,0.00,1.44],['c',-0.21,0.84,-0.66,1.59,-1.59,2.55],['l',-0.30,0.30],['l',0.27,0.18],['c',1.47,0.93,2.31,2.31,2.25,3.75],['c',-0.03,0.75,-0.24,1.35,-0.63,1.95],['c',-0.45,0.66,-1.02,1.14,-1.83,1.53],['c',-1.80,0.87,-4.20,0.87,-6.00,0.03],['c',-1.62,-0.78,-2.52,-2.16,-2.46,-3.66],['c',0.06,-0.99,0.54,-1.77,1.80,-2.97],['c',0.54,-0.51,0.54,-0.54,0.48,-0.57],['c',-0.39,-0.27,-0.96,-0.78,-1.20,-1.14],['c',-0.75,-1.11,-0.87,-2.40,-0.30,-3.60],['c',0.69,-1.35,2.25,-2.25,4.20,-2.40],['z'],['m',1.53,0.69],['c',-0.42,-0.09,-1.11,-0.12,-1.38,-0.06],['c',-0.30,0.06,-0.60,0.18,-0.81,0.30],['c',-0.21,0.12,-0.60,0.51,-0.72,0.72],['c',-0.51,0.87,-0.42,1.89,0.21,2.52],['c',0.21,0.21,0.36,0.30,1.95,1.23],['c',0.96,0.54,1.74,0.99,1.77,1.02],['c',0.09,0.00,0.63,-0.60,0.99,-1.11],['c',0.21,-0.36,0.48,-0.87,0.57,-1.23],['c',0.06,-0.24,0.06,-0.36,0.06,-0.72],['c',0.00,-0.45,-0.03,-0.66,-0.15,-0.99],['c',-0.39,-0.81,-1.29,-1.44,-2.49,-1.68],['z'],['m',-1.44,8.07],['l',-1.89,-1.08],['c',-0.03,0.00,-0.18,0.15,-0.39,0.33],['c',-1.20,1.08,-1.65,1.95,-1.59,3.00],['c',0.09,1.59,1.35,2.85,3.21,3.24],['c',0.33,0.06,0.45,0.06,0.93,0.06],['c',0.63,0.00,0.81,-0.03,1.29,-0.27],['c',0.90,-0.42,1.47,-1.41,1.41,-2.40],['c',-0.06,-0.66,-0.39,-1.29,-0.90,-1.65],['c',-0.12,-0.09,-1.05,-0.63,-2.07,-1.23],['z']],w:10.926,h:14.989},
		'9':{d:[['M',4.23,-14.97],['c',0.42,-0.03,1.29,0.00,1.62,0.06],['c',0.51,0.12,0.93,0.30,1.38,0.57],['c',1.53,1.02,2.52,3.24,2.73,5.94],['c',0.18,2.55,-0.48,4.98,-1.83,6.57],['c',-1.05,1.26,-2.40,1.89,-3.93,1.83],['c',-1.23,-0.06,-2.31,-0.45,-3.03,-1.14],['c',-0.57,-0.51,-0.87,-1.23,-0.84,-1.98],['c',0.03,-0.51,0.21,-0.90,0.60,-1.26],['c',0.24,-0.24,0.45,-0.39,0.75,-0.51],['c',0.21,-0.06,0.27,-0.06,0.60,-0.06],['c',0.33,0.00,0.39,0.00,0.60,0.06],['c',0.30,0.12,0.51,0.27,0.75,0.51],['c',0.39,0.36,0.57,0.78,0.57,1.26],['c',0.00,0.27,0.00,0.30,-0.09,0.42],['c',-0.03,0.09,-0.18,0.21,-0.30,0.30],['c',-0.12,0.09,-0.30,0.21,-0.39,0.27],['c',-0.09,0.06,-0.21,0.18,-0.27,0.24],['c',-0.06,0.12,-0.06,0.15,-0.06,0.33],['c',0.00,0.18,0.00,0.24,0.06,0.36],['c',0.24,0.39,0.75,0.60,1.38,0.57],['c',0.54,-0.03,0.90,-0.18,1.23,-0.48],['c',0.81,-0.72,1.08,-2.16,0.96,-5.37],['l',0.00,-0.63],['l',-0.30,0.12],['c',-0.78,0.27,-1.29,0.33,-2.10,0.27],['c',-1.47,-0.12,-2.49,-0.54,-3.27,-1.29],['c',-0.48,-0.51,-0.81,-1.11,-0.96,-1.89],['c',-0.06,-0.27,-0.06,-0.42,-0.06,-0.96],['c',0.00,-0.51,0.00,-0.66,0.06,-0.93],['c',0.15,-0.78,0.48,-1.38,0.96,-1.89],['c',0.15,-0.12,0.33,-0.27,0.42,-0.36],['c',0.69,-0.51,1.62,-0.81,2.76,-0.93],['z'],['m',1.17,0.66],['c',-0.21,-0.06,-0.57,-0.06,-0.81,-0.03],['c',-0.78,0.12,-1.26,0.69,-1.41,1.74],['c',-0.12,0.63,-0.15,1.95,-0.09,2.79],['c',0.12,1.71,0.63,2.40,1.77,2.46],['c',1.08,0.03,1.62,-0.48,1.80,-1.74],['c',0.06,-0.54,0.06,-3.00,0.00,-3.54],['c',-0.15,-1.05,-0.51,-1.53,-1.26,-1.68],['z']],w:9.959,h:14.986},
		'rests.multimeasure':{d:[['M',0,-4],['l',0,16],['l',1,0],['l',0,-5],['l',40,0],['l',0,5],['l',1,0],['l',0,-16],['l',-1,0],['l',0,5],['l',-40,0],['l',0,-5],['z']],w:42,h:18},
		'rests.whole':{d:[['M',0.06,0.03],['l',0.09,-0.06],['l',5.46,0.00],['l',5.49,0.00],['l',0.09,0.06],['l',0.06,0.09],['l',0.00,2.19],['l',0.00,2.19],['l',-0.06,0.09],['l',-0.09,0.06],['l',-5.49,0.00],['l',-5.46,0.00],['l',-0.09,-0.06],['l',-0.06,-0.09],['l',0.00,-2.19],['l',0.00,-2.19],['z']],w:11.25,h:4.68},
		'rests.half':{d:[['M',0.06,-4.62],['l',0.09,-0.06],['l',5.46,0.00],['l',5.49,0.00],['l',0.09,0.06],['l',0.06,0.09],['l',0.00,2.19],['l',0.00,2.19],['l',-0.06,0.09],['l',-0.09,0.06],['l',-5.49,0.00],['l',-5.46,0.00],['l',-0.09,-0.06],['l',-0.06,-0.09],['l',0.00,-2.19],['l',0.00,-2.19],['z']],w:11.25,h:4.68},
		'rests.quarter':{d:[['M',1.89,-11.82],['c',0.12,-0.06,0.24,-0.06,0.36,-0.03],['c',0.09,0.06,4.74,5.58,4.86,5.82],['c',0.21,0.39,0.15,0.78,-0.15,1.26],['c',-0.24,0.33,-0.72,0.81,-1.62,1.56],['c',-0.45,0.36,-0.87,0.75,-0.96,0.84],['c',-0.93,0.99,-1.14,2.49,-0.60,3.63],['c',0.18,0.39,0.27,0.48,1.32,1.68],['c',1.92,2.25,1.83,2.16,1.83,2.34],['c',0.00,0.18,-0.18,0.36,-0.36,0.39],['c',-0.15,0.00,-0.27,-0.06,-0.48,-0.27],['c',-0.75,-0.75,-2.46,-1.29,-3.39,-1.08],['c',-0.45,0.09,-0.69,0.27,-0.90,0.69],['c',-0.12,0.30,-0.21,0.66,-0.24,1.14],['c',-0.03,0.66,0.09,1.35,0.30,2.01],['c',0.15,0.42,0.24,0.66,0.45,0.96],['c',0.18,0.24,0.18,0.33,0.03,0.42],['c',-0.12,0.06,-0.18,0.03,-0.45,-0.30],['c',-1.08,-1.38,-2.07,-3.36,-2.40,-4.83],['c',-0.27,-1.05,-0.15,-1.77,0.27,-2.07],['c',0.21,-0.12,0.42,-0.15,0.87,-0.15],['c',0.87,0.06,2.10,0.39,3.30,0.90],['l',0.39,0.18],['l',-1.65,-1.95],['c',-2.52,-2.97,-2.61,-3.09,-2.70,-3.27],['c',-0.09,-0.24,-0.12,-0.48,-0.03,-0.75],['c',0.15,-0.48,0.57,-0.96,1.83,-2.01],['c',0.45,-0.36,0.84,-0.72,0.93,-0.78],['c',0.69,-0.75,1.02,-1.80,0.90,-2.79],['c',-0.06,-0.33,-0.21,-0.84,-0.39,-1.11],['c',-0.09,-0.15,-0.45,-0.60,-0.81,-1.05],['c',-0.36,-0.42,-0.69,-0.81,-0.72,-0.87],['c',-0.09,-0.18,0.00,-0.42,0.21,-0.51],['z']],w:7.888,h:21.435},
		'rests.8th':{d:[['M',1.68,-6.12],['c',0.66,-0.09,1.23,0.09,1.68,0.51],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.12,0.27,0.33,0.45,0.60,0.48],['c',0.12,0.00,0.18,0.00,0.33,-0.09],['c',0.39,-0.18,1.32,-1.29,1.68,-1.98],['c',0.09,-0.21,0.24,-0.30,0.39,-0.30],['c',0.12,0.00,0.27,0.09,0.33,0.18],['c',0.03,0.06,-0.27,1.11,-1.86,6.42],['c',-1.02,3.48,-1.89,6.39,-1.92,6.42],['c',0.00,0.03,-0.12,0.12,-0.24,0.15],['c',-0.18,0.09,-0.21,0.09,-0.45,0.09],['c',-0.24,0.00,-0.30,0.00,-0.48,-0.06],['c',-0.09,-0.06,-0.21,-0.12,-0.21,-0.15],['c',-0.06,-0.03,0.15,-0.57,1.68,-4.92],['c',0.96,-2.67,1.74,-4.89,1.71,-4.89],['l',-0.51,0.15],['c',-1.08,0.36,-1.74,0.48,-2.55,0.48],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.33,-0.45,0.84,-0.81,1.38,-0.90],['z']],w:7.534,h:13.883},
		'rests.16th':{d:[['M',3.33,-6.12],['c',0.66,-0.09,1.23,0.09,1.68,0.51],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.15,0.39,0.57,0.57,0.87,0.42],['c',0.39,-0.18,1.20,-1.23,1.62,-2.07],['c',0.06,-0.15,0.24,-0.24,0.36,-0.24],['c',0.12,0.00,0.27,0.09,0.33,0.18],['c',0.03,0.06,-0.45,1.86,-2.67,10.17],['c',-1.50,5.55,-2.73,10.14,-2.76,10.17],['c',-0.03,0.03,-0.12,0.12,-0.24,0.15],['c',-0.18,0.09,-0.21,0.09,-0.45,0.09],['c',-0.24,0.00,-0.30,0.00,-0.48,-0.06],['c',-0.09,-0.06,-0.21,-0.12,-0.21,-0.15],['c',-0.06,-0.03,0.12,-0.57,1.44,-4.92],['c',0.81,-2.67,1.47,-4.86,1.47,-4.89],['c',-0.03,0.00,-0.27,0.06,-0.54,0.15],['c',-1.08,0.36,-1.77,0.48,-2.58,0.48],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.72,-1.05,2.22,-1.23,3.06,-0.42],['c',0.30,0.33,0.42,0.60,0.60,1.38],['c',0.09,0.45,0.21,0.78,0.33,0.90],['c',0.09,0.09,0.27,0.18,0.45,0.21],['c',0.12,0.00,0.18,0.00,0.33,-0.09],['c',0.33,-0.15,1.02,-0.93,1.41,-1.59],['c',0.12,-0.21,0.18,-0.39,0.39,-1.08],['c',0.66,-2.10,1.17,-3.84,1.17,-3.87],['c',0.00,0.00,-0.21,0.06,-0.42,0.15],['c',-0.51,0.15,-1.20,0.33,-1.68,0.42],['c',-0.33,0.06,-0.51,0.06,-0.96,0.06],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.33,-0.45,0.84,-0.81,1.38,-0.90],['z']],w:9.724,h:21.383},
		'rests.32nd':{d:[['M',4.23,-13.62],['c',0.66,-0.09,1.23,0.09,1.68,0.51],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.12,0.27,0.33,0.45,0.60,0.48],['c',0.12,0.00,0.18,0.00,0.27,-0.06],['c',0.33,-0.21,0.99,-1.11,1.44,-1.98],['c',0.09,-0.24,0.21,-0.33,0.39,-0.33],['c',0.12,0.00,0.27,0.09,0.33,0.18],['c',0.03,0.06,-0.57,2.67,-3.21,13.89],['c',-1.80,7.62,-3.30,13.89,-3.30,13.92],['c',-0.03,0.06,-0.12,0.12,-0.24,0.18],['c',-0.21,0.09,-0.24,0.09,-0.48,0.09],['c',-0.24,0.00,-0.30,0.00,-0.48,-0.06],['c',-0.09,-0.06,-0.21,-0.12,-0.21,-0.15],['c',-0.06,-0.03,0.09,-0.57,1.23,-4.92],['c',0.69,-2.67,1.26,-4.86,1.29,-4.89],['c',0.00,-0.03,-0.12,-0.03,-0.48,0.12],['c',-1.17,0.39,-2.22,0.57,-3.00,0.54],['c',-0.42,-0.03,-0.75,-0.12,-1.11,-0.30],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.72,-1.05,2.22,-1.23,3.06,-0.42],['c',0.30,0.33,0.42,0.60,0.60,1.38],['c',0.09,0.45,0.21,0.78,0.33,0.90],['c',0.12,0.09,0.30,0.18,0.48,0.21],['c',0.12,0.00,0.18,0.00,0.30,-0.09],['c',0.42,-0.21,1.29,-1.29,1.56,-1.89],['c',0.03,-0.12,1.23,-4.59,1.23,-4.65],['c',0.00,-0.03,-0.18,0.03,-0.39,0.12],['c',-0.63,0.18,-1.20,0.36,-1.74,0.45],['c',-0.39,0.06,-0.54,0.06,-1.02,0.06],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.72,-1.05,2.22,-1.23,3.06,-0.42],['c',0.30,0.33,0.42,0.60,0.60,1.38],['c',0.09,0.45,0.21,0.78,0.33,0.90],['c',0.18,0.18,0.51,0.27,0.72,0.15],['c',0.30,-0.12,0.69,-0.57,1.08,-1.17],['c',0.42,-0.60,0.39,-0.51,1.05,-3.03],['c',0.33,-1.26,0.60,-2.31,0.60,-2.34],['c',0.00,0.00,-0.21,0.03,-0.45,0.12],['c',-0.57,0.18,-1.14,0.33,-1.62,0.42],['c',-0.33,0.06,-0.51,0.06,-0.96,0.06],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.33,-0.45,0.84,-0.81,1.38,-0.90],['z']],w:11.373,h:28.883},
		'rests.64th':{d:[['M',5.13,-13.62],['c',0.66,-0.09,1.23,0.09,1.68,0.51],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.15,0.63,0.21,0.81,0.33,0.96],['c',0.18,0.21,0.54,0.30,0.75,0.18],['c',0.24,-0.12,0.63,-0.66,1.08,-1.56],['c',0.33,-0.66,0.39,-0.72,0.60,-0.72],['c',0.12,0.00,0.27,0.09,0.33,0.18],['c',0.03,0.06,-0.69,3.66,-3.54,17.64],['c',-1.95,9.66,-3.57,17.61,-3.57,17.64],['c',-0.03,0.06,-0.12,0.12,-0.24,0.18],['c',-0.21,0.09,-0.24,0.09,-0.48,0.09],['c',-0.24,0.00,-0.30,0.00,-0.48,-0.06],['c',-0.09,-0.06,-0.21,-0.12,-0.21,-0.15],['c',-0.06,-0.03,0.06,-0.57,1.05,-4.95],['c',0.60,-2.70,1.08,-4.89,1.08,-4.92],['c',0.00,0.00,-0.24,0.06,-0.51,0.15],['c',-0.66,0.24,-1.20,0.36,-1.77,0.48],['c',-0.42,0.06,-0.57,0.06,-1.05,0.06],['c',-0.69,0.00,-0.87,-0.03,-1.35,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.72,-1.05,2.22,-1.23,3.06,-0.42],['c',0.30,0.33,0.42,0.60,0.60,1.38],['c',0.09,0.45,0.21,0.78,0.33,0.90],['c',0.09,0.09,0.27,0.18,0.45,0.21],['c',0.21,0.03,0.39,-0.09,0.72,-0.42],['c',0.45,-0.45,1.02,-1.26,1.17,-1.65],['c',0.03,-0.09,0.27,-1.14,0.54,-2.34],['c',0.27,-1.20,0.48,-2.19,0.51,-2.22],['c',0.00,-0.03,-0.09,-0.03,-0.48,0.12],['c',-1.17,0.39,-2.22,0.57,-3.00,0.54],['c',-0.42,-0.03,-0.75,-0.12,-1.11,-0.30],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.36,-0.54,0.96,-0.87,1.65,-0.93],['c',0.54,-0.03,1.02,0.15,1.41,0.54],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.15,0.39,0.57,0.57,0.90,0.42],['c',0.36,-0.18,1.20,-1.26,1.47,-1.89],['c',0.03,-0.09,0.30,-1.20,0.57,-2.43],['l',0.51,-2.28],['l',-0.54,0.18],['c',-1.11,0.36,-1.80,0.48,-2.61,0.48],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.36,-0.54,0.96,-0.87,1.65,-0.93],['c',0.54,-0.03,1.02,0.15,1.41,0.54],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.15,0.63,0.21,0.81,0.33,0.96],['c',0.21,0.21,0.54,0.30,0.75,0.18],['c',0.36,-0.18,0.93,-0.93,1.29,-1.68],['c',0.12,-0.24,0.18,-0.48,0.63,-2.55],['l',0.51,-2.31],['c',0.00,-0.03,-0.18,0.03,-0.39,0.12],['c',-1.14,0.36,-2.10,0.54,-2.82,0.51],['c',-0.42,-0.03,-0.75,-0.12,-1.11,-0.30],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.33,-0.45,0.84,-0.81,1.38,-0.90],['z']],w:12.453,h:36.383},
		'rests.128th':{d:[['M',6.03,-21.12],['c',0.66,-0.09,1.23,0.09,1.68,0.51],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.12,0.27,0.33,0.45,0.60,0.48],['c',0.21,0.00,0.33,-0.06,0.54,-0.36],['c',0.15,-0.21,0.54,-0.93,0.78,-1.47],['c',0.15,-0.33,0.18,-0.39,0.30,-0.48],['c',0.18,-0.09,0.45,0.00,0.51,0.15],['c',0.03,0.09,-7.11,42.75,-7.17,42.84],['c',-0.03,0.03,-0.15,0.09,-0.24,0.15],['c',-0.18,0.06,-0.24,0.06,-0.45,0.06],['c',-0.24,0.00,-0.30,0.00,-0.48,-0.06],['c',-0.09,-0.06,-0.21,-0.12,-0.21,-0.15],['c',-0.06,-0.03,0.03,-0.57,0.84,-4.98],['c',0.51,-2.70,0.93,-4.92,0.90,-4.92],['c',0.00,0.00,-0.15,0.06,-0.36,0.12],['c',-0.78,0.27,-1.62,0.48,-2.31,0.57],['c',-0.15,0.03,-0.54,0.03,-0.81,0.03],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.36,-0.54,0.96,-0.87,1.65,-0.93],['c',0.54,-0.03,1.02,0.15,1.41,0.54],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.12,0.27,0.33,0.45,0.63,0.48],['c',0.12,0.00,0.18,0.00,0.30,-0.09],['c',0.42,-0.21,1.14,-1.11,1.50,-1.83],['c',0.12,-0.27,0.12,-0.27,0.54,-2.52],['c',0.24,-1.23,0.42,-2.25,0.39,-2.25],['c',0.00,0.00,-0.24,0.06,-0.51,0.18],['c',-1.26,0.39,-2.25,0.57,-3.06,0.54],['c',-0.42,-0.03,-0.75,-0.12,-1.11,-0.30],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.36,-0.54,0.96,-0.87,1.65,-0.93],['c',0.54,-0.03,1.02,0.15,1.41,0.54],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.15,0.63,0.21,0.81,0.33,0.96],['c',0.18,0.21,0.51,0.30,0.75,0.18],['c',0.36,-0.15,1.05,-0.99,1.41,-1.77],['l',0.15,-0.30],['l',0.42,-2.25],['c',0.21,-1.26,0.42,-2.28,0.39,-2.28],['l',-0.51,0.15],['c',-1.11,0.39,-1.89,0.51,-2.70,0.51],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.36,-0.54,0.96,-0.87,1.65,-0.93],['c',0.54,-0.03,1.02,0.15,1.41,0.54],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.15,0.63,0.21,0.81,0.33,0.96],['c',0.18,0.18,0.48,0.27,0.72,0.21],['c',0.33,-0.12,1.14,-1.26,1.41,-1.95],['c',0.00,-0.09,0.21,-1.11,0.45,-2.34],['c',0.21,-1.20,0.39,-2.22,0.39,-2.28],['c',0.03,-0.03,0.00,-0.03,-0.45,0.12],['c',-0.57,0.18,-1.20,0.33,-1.71,0.42],['c',-0.30,0.06,-0.51,0.06,-0.93,0.06],['c',-0.66,0.00,-0.84,-0.03,-1.32,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.36,-0.54,0.96,-0.87,1.65,-0.93],['c',0.54,-0.03,1.02,0.15,1.41,0.54],['c',0.27,0.30,0.39,0.54,0.57,1.26],['c',0.09,0.33,0.18,0.66,0.21,0.72],['c',0.12,0.27,0.33,0.45,0.60,0.48],['c',0.18,0.00,0.36,-0.09,0.57,-0.33],['c',0.33,-0.36,0.78,-1.14,0.93,-1.56],['c',0.03,-0.12,0.24,-1.20,0.45,-2.40],['c',0.24,-1.20,0.42,-2.22,0.42,-2.28],['c',0.03,-0.03,0.00,-0.03,-0.39,0.09],['c',-1.05,0.36,-1.80,0.48,-2.58,0.48],['c',-0.63,0.00,-0.84,-0.03,-1.29,-0.27],['c',-1.32,-0.63,-1.77,-2.16,-1.02,-3.30],['c',0.33,-0.45,0.84,-0.81,1.38,-0.90],['z']],w:12.992,h:43.883},
		'accidentals.sharp':{d:[['M',5.73,-11.19],['c',0.21,-0.12,0.54,-0.03,0.66,0.24],['c',0.06,0.12,0.06,0.21,0.06,2.31],['c',0.00,1.23,0.00,2.22,0.03,2.22],['c',0.00,0.00,0.27,-0.12,0.60,-0.24],['c',0.69,-0.27,0.78,-0.30,0.96,-0.15],['c',0.21,0.15,0.21,0.18,0.21,1.38],['c',0.00,1.02,0.00,1.11,-0.06,1.20],['c',-0.03,0.06,-0.09,0.12,-0.12,0.15],['c',-0.06,0.03,-0.42,0.21,-0.84,0.36],['l',-0.75,0.33],['l',-0.03,2.43],['c',0.00,1.32,0.00,2.43,0.03,2.43],['c',0.00,0.00,0.27,-0.12,0.60,-0.24],['c',0.69,-0.27,0.78,-0.30,0.96,-0.15],['c',0.21,0.15,0.21,0.18,0.21,1.38],['c',0.00,1.02,0.00,1.11,-0.06,1.20],['c',-0.03,0.06,-0.09,0.12,-0.12,0.15],['c',-0.06,0.03,-0.42,0.21,-0.84,0.36],['l',-0.75,0.33],['l',-0.03,2.52],['c',0.00,2.28,-0.03,2.55,-0.06,2.64],['c',-0.21,0.36,-0.72,0.36,-0.93,0.00],['c',-0.03,-0.09,-0.06,-0.33,-0.06,-2.43],['l',0.00,-2.31],['l',-1.29,0.51],['l',-1.26,0.51],['l',0.00,2.43],['c',0.00,2.58,0.00,2.52,-0.15,2.67],['c',-0.06,0.09,-0.27,0.18,-0.36,0.18],['c',-0.12,0.00,-0.33,-0.09,-0.39,-0.18],['c',-0.15,-0.15,-0.15,-0.09,-0.15,-2.43],['c',0.00,-1.23,0.00,-2.22,-0.03,-2.22],['c',0.00,0.00,-0.27,0.12,-0.60,0.24],['c',-0.69,0.27,-0.78,0.30,-0.96,0.15],['c',-0.21,-0.15,-0.21,-0.18,-0.21,-1.38],['c',0.00,-1.02,0.00,-1.11,0.06,-1.20],['c',0.03,-0.06,0.09,-0.12,0.12,-0.15],['c',0.06,-0.03,0.42,-0.21,0.84,-0.36],['l',0.78,-0.33],['l',0.00,-2.43],['c',0.00,-1.32,0.00,-2.43,-0.03,-2.43],['c',0.00,0.00,-0.27,0.12,-0.60,0.24],['c',-0.69,0.27,-0.78,0.30,-0.96,0.15],['c',-0.21,-0.15,-0.21,-0.18,-0.21,-1.38],['c',0.00,-1.02,0.00,-1.11,0.06,-1.20],['c',0.03,-0.06,0.09,-0.12,0.12,-0.15],['c',0.06,-0.03,0.42,-0.21,0.84,-0.36],['l',0.78,-0.33],['l',0.00,-2.52],['c',0.00,-2.28,0.03,-2.55,0.06,-2.64],['c',0.21,-0.36,0.72,-0.36,0.93,0.00],['c',0.03,0.09,0.06,0.33,0.06,2.43],['l',0.03,2.31],['l',1.26,-0.51],['l',1.26,-0.51],['l',0.00,-2.43],['c',0.00,-2.28,0.00,-2.43,0.06,-2.55],['c',0.06,-0.12,0.12,-0.18,0.27,-0.24],['z'],['m',-0.33,10.65],['l',0.00,-2.43],['l',-1.29,0.51],['l',-1.26,0.51],['l',0.00,2.46],['l',0.00,2.43],['l',0.09,-0.03],['c',0.06,-0.03,0.63,-0.27,1.29,-0.51],['l',1.17,-0.48],['l',0.00,-2.46],['z']],w:8.25,h:22.462},
		'accidentals.halfsharp':{d:[['M',2.43,-10.05],['c',0.21,-0.12,0.54,-0.03,0.66,0.24],['c',0.06,0.12,0.06,0.21,0.06,2.01],['c',0.00,1.05,0.00,1.89,0.03,1.89],['l',0.72,-0.48],['c',0.69,-0.48,0.69,-0.51,0.87,-0.51],['c',0.15,0.00,0.18,0.03,0.27,0.09],['c',0.21,0.15,0.21,0.18,0.21,1.41],['c',0.00,1.11,-0.03,1.14,-0.09,1.23],['c',-0.03,0.03,-0.48,0.39,-1.02,0.75],['l',-0.99,0.66],['l',0.00,2.37],['c',0.00,1.32,0.00,2.37,0.03,2.37],['l',0.72,-0.48],['c',0.69,-0.48,0.69,-0.51,0.87,-0.51],['c',0.15,0.00,0.18,0.03,0.27,0.09],['c',0.21,0.15,0.21,0.18,0.21,1.41],['c',0.00,1.11,-0.03,1.14,-0.09,1.23],['c',-0.03,0.03,-0.48,0.39,-1.02,0.75],['l',-0.99,0.66],['l',0.00,2.25],['c',0.00,1.95,0.00,2.28,-0.06,2.37],['c',-0.06,0.12,-0.12,0.21,-0.24,0.27],['c',-0.27,0.12,-0.54,0.03,-0.69,-0.24],['c',-0.06,-0.12,-0.06,-0.21,-0.06,-2.01],['c',0.00,-1.05,0.00,-1.89,-0.03,-1.89],['l',-0.72,0.48],['c',-0.69,0.48,-0.69,0.48,-0.87,0.48],['c',-0.15,0.00,-0.18,0.00,-0.27,-0.06],['c',-0.21,-0.15,-0.21,-0.18,-0.21,-1.41],['c',0.00,-1.11,0.03,-1.14,0.09,-1.23],['c',0.03,-0.03,0.48,-0.39,1.02,-0.75],['l',0.99,-0.66],['l',0.00,-2.37],['c',0.00,-1.32,0.00,-2.37,-0.03,-2.37],['l',-0.72,0.48],['c',-0.69,0.48,-0.69,0.48,-0.87,0.48],['c',-0.15,0.00,-0.18,0.00,-0.27,-0.06],['c',-0.21,-0.15,-0.21,-0.18,-0.21,-1.41],['c',0.00,-1.11,0.03,-1.14,0.09,-1.23],['c',0.03,-0.03,0.48,-0.39,1.02,-0.75],['l',0.99,-0.66],['l',0.00,-2.25],['c',0.00,-2.13,0.00,-2.28,0.06,-2.40],['c',0.06,-0.12,0.12,-0.18,0.27,-0.24],['z']],w:5.25,h:20.174},
		'accidentals.nat':{d:[['M',0.21,-11.40],['c',0.24,-0.06,0.78,0.00,0.99,0.15],['c',0.03,0.03,0.03,0.48,0.00,2.61],['c',-0.03,1.44,-0.03,2.61,-0.03,2.61],['c',0.00,0.03,0.75,-0.09,1.68,-0.24],['c',0.96,-0.18,1.71,-0.27,1.74,-0.27],['c',0.15,0.03,0.27,0.15,0.36,0.30],['l',0.06,0.12],['l',0.09,8.67],['c',0.09,6.96,0.12,8.67,0.09,8.67],['c',-0.03,0.03,-0.12,0.06,-0.21,0.09],['c',-0.24,0.09,-0.72,0.09,-0.96,0.00],['c',-0.09,-0.03,-0.18,-0.06,-0.21,-0.09],['c',-0.03,-0.03,-0.03,-0.48,0.00,-2.61],['c',0.03,-1.44,0.03,-2.61,0.03,-2.61],['c',0.00,-0.03,-0.75,0.09,-1.68,0.24],['c',-0.96,0.18,-1.71,0.27,-1.74,0.27],['c',-0.15,-0.03,-0.27,-0.15,-0.36,-0.30],['l',-0.06,-0.15],['l',-0.09,-7.53],['c',-0.06,-4.14,-0.09,-8.04,-0.12,-8.67],['l',0.00,-1.11],['l',0.15,-0.06],['c',0.09,-0.03,0.21,-0.06,0.27,-0.09],['z'],['m',3.75,8.40],['c',0.00,-0.33,0.00,-0.42,-0.03,-0.42],['c',-0.12,0.00,-2.79,0.45,-2.79,0.48],['c',-0.03,0.00,-0.09,6.30,-0.09,6.33],['c',0.03,0.00,2.79,-0.45,2.82,-0.48],['c',0.00,0.00,0.09,-4.53,0.09,-5.91],['z']],w:5.4,h:22.8},
		'accidentals.flat':{d:[['M',-0.36,-14.07],['c',0.33,-0.06,0.87,0.00,1.08,0.15],['c',0.06,0.03,0.06,0.36,-0.03,5.25],['c',-0.06,2.85,-0.09,5.19,-0.09,5.19],['c',0.00,0.03,0.12,-0.03,0.24,-0.12],['c',0.63,-0.42,1.41,-0.66,2.19,-0.72],['c',0.81,-0.03,1.47,0.21,2.04,0.78],['c',0.57,0.54,0.87,1.26,0.93,2.04],['c',0.03,0.57,-0.09,1.08,-0.36,1.62],['c',-0.42,0.81,-1.02,1.38,-2.82,2.61],['c',-1.14,0.78,-1.44,1.02,-1.80,1.44],['c',-0.18,0.18,-0.39,0.39,-0.45,0.42],['c',-0.27,0.18,-0.57,0.15,-0.81,-0.06],['c',-0.06,-0.09,-0.12,-0.18,-0.15,-0.27],['c',-0.03,-0.06,-0.09,-3.27,-0.18,-8.34],['c',-0.09,-4.53,-0.15,-8.58,-0.18,-9.03],['l',0.00,-0.78],['l',0.12,-0.06],['c',0.06,-0.03,0.18,-0.09,0.27,-0.12],['z'],['m',3.18,11.01],['c',-0.21,-0.12,-0.54,-0.15,-0.81,-0.06],['c',-0.54,0.15,-0.99,0.63,-1.17,1.26],['c',-0.06,0.30,-0.12,2.88,-0.06,3.87],['c',0.03,0.42,0.03,0.81,0.06,0.90],['l',0.03,0.12],['l',0.45,-0.39],['c',0.63,-0.54,1.26,-1.17,1.56,-1.59],['c',0.30,-0.42,0.60,-0.99,0.72,-1.41],['c',0.18,-0.69,0.09,-1.47,-0.18,-2.07],['c',-0.15,-0.30,-0.33,-0.51,-0.60,-0.63],['z']],w:6.75,h:18.801},
		'accidentals.halfflat':{d:[['M',4.83,-14.07],['c',0.33,-0.06,0.87,0.00,1.08,0.15],['c',0.06,0.03,0.06,0.60,-0.12,9.06],['c',-0.09,5.55,-0.15,9.06,-0.18,9.12],['c',-0.03,0.09,-0.09,0.18,-0.15,0.27],['c',-0.24,0.21,-0.54,0.24,-0.81,0.06],['c',-0.06,-0.03,-0.27,-0.24,-0.45,-0.42],['c',-0.36,-0.42,-0.66,-0.66,-1.80,-1.44],['c',-1.23,-0.84,-1.83,-1.32,-2.25,-1.77],['c',-0.66,-0.78,-0.96,-1.56,-0.93,-2.46],['c',0.09,-1.41,1.11,-2.58,2.40,-2.79],['c',0.30,-0.06,0.84,-0.03,1.23,0.06],['c',0.54,0.12,1.08,0.33,1.53,0.63],['c',0.12,0.09,0.24,0.15,0.24,0.12],['c',0.00,0.00,-0.12,-8.37,-0.18,-9.75],['l',0.00,-0.66],['l',0.12,-0.06],['c',0.06,-0.03,0.18,-0.09,0.27,-0.12],['z'],['m',-1.65,10.95],['c',-0.60,-0.18,-1.08,0.09,-1.38,0.69],['c',-0.27,0.60,-0.36,1.38,-0.18,2.07],['c',0.12,0.42,0.42,0.99,0.72,1.41],['c',0.30,0.42,0.93,1.05,1.56,1.59],['l',0.48,0.39],['l',0.00,-0.12],['c',0.03,-0.09,0.03,-0.48,0.06,-0.90],['c',0.03,-0.57,0.03,-1.08,0.00,-2.22],['c',-0.03,-1.62,-0.03,-1.62,-0.24,-2.07],['c',-0.21,-0.42,-0.60,-0.75,-1.02,-0.84],['z']],w:6.728,h:18.801},
		'accidentals.dblflat':{d:[['M',-0.36,-14.07],['c',0.33,-0.06,0.87,0.00,1.08,0.15],['c',0.06,0.03,0.06,0.33,-0.03,4.89],['c',-0.06,2.67,-0.09,5.01,-0.09,5.22],['l',0.00,0.36],['l',0.15,-0.15],['c',0.36,-0.30,0.75,-0.51,1.20,-0.63],['c',0.33,-0.09,0.96,-0.09,1.26,-0.03],['c',0.27,0.09,0.63,0.27,0.87,0.45],['l',0.21,0.15],['l',0.00,-0.27],['c',0.00,-0.15,-0.03,-2.43,-0.09,-5.10],['c',-0.09,-4.56,-0.09,-4.86,-0.03,-4.89],['c',0.15,-0.12,0.39,-0.15,0.72,-0.15],['c',0.30,0.00,0.54,0.03,0.69,0.15],['c',0.06,0.03,0.06,0.33,-0.03,4.95],['c',-0.06,2.70,-0.09,5.04,-0.09,5.22],['l',0.03,0.30],['l',0.21,-0.15],['c',0.69,-0.48,1.44,-0.69,2.28,-0.69],['c',0.51,0.00,0.78,0.03,1.20,0.21],['c',1.32,0.63,2.01,2.28,1.53,3.69],['c',-0.21,0.57,-0.51,1.02,-1.05,1.56],['c',-0.42,0.42,-0.81,0.72,-1.92,1.50],['c',-1.26,0.87,-1.50,1.08,-1.86,1.50],['c',-0.39,0.45,-0.54,0.54,-0.81,0.51],['c',-0.18,0.00,-0.21,0.00,-0.33,-0.06],['l',-0.21,-0.21],['l',-0.06,-0.12],['l',-0.03,-0.99],['c',-0.03,-0.54,-0.03,-1.29,-0.06,-1.68],['l',0.00,-0.69],['l',-0.21,0.24],['c',-0.36,0.42,-0.75,0.75,-1.80,1.62],['c',-1.02,0.84,-1.20,0.99,-1.44,1.38],['c',-0.36,0.51,-0.54,0.60,-0.90,0.51],['c',-0.15,-0.03,-0.39,-0.27,-0.42,-0.42],['c',-0.03,-0.06,-0.09,-3.27,-0.18,-8.34],['c',-0.09,-4.53,-0.15,-8.58,-0.18,-9.03],['l',0.00,-0.78],['l',0.12,-0.06],['c',0.06,-0.03,0.18,-0.09,0.27,-0.12],['z'],['m',2.52,10.98],['c',-0.18,-0.09,-0.48,-0.12,-0.66,-0.06],['c',-0.39,0.15,-0.69,0.54,-0.84,1.14],['c',-0.06,0.24,-0.06,0.39,-0.09,1.74],['c',-0.03,1.44,0.00,2.73,0.06,3.18],['l',0.03,0.15],['l',0.27,-0.27],['c',0.93,-0.96,1.50,-1.95,1.74,-3.06],['c',0.06,-0.27,0.06,-0.39,0.06,-0.96],['c',0.00,-0.54,0.00,-0.69,-0.06,-0.93],['c',-0.09,-0.51,-0.27,-0.81,-0.51,-0.93],['z'],['m',5.43,0.00],['c',-0.18,-0.09,-0.51,-0.12,-0.72,-0.06],['c',-0.54,0.12,-0.96,0.63,-1.17,1.26],['c',-0.06,0.30,-0.12,2.88,-0.06,3.90],['c',0.03,0.42,0.03,0.81,0.06,0.90],['l',0.03,0.12],['l',0.36,-0.30],['c',0.42,-0.36,1.02,-0.96,1.29,-1.29],['c',0.36,-0.45,0.66,-0.99,0.81,-1.41],['c',0.42,-1.23,0.15,-2.76,-0.60,-3.12],['z']],w:11.613,h:18.804},
		'accidentals.dblsharp':{d:[['M',-0.18,-3.96],['c',0.06,-0.03,0.12,-0.06,0.15,-0.06],['c',0.09,0.00,2.76,0.27,2.79,0.30],['c',0.12,0.03,0.15,0.12,0.15,0.51],['c',0.06,0.96,0.24,1.59,0.57,2.10],['c',0.06,0.09,0.15,0.21,0.18,0.24],['l',0.09,0.06],['l',0.09,-0.06],['c',0.03,-0.03,0.12,-0.15,0.18,-0.24],['c',0.33,-0.51,0.51,-1.14,0.57,-2.10],['c',0.00,-0.39,0.03,-0.45,0.12,-0.51],['c',0.03,0.00,0.66,-0.09,1.44,-0.15],['c',1.47,-0.15,1.50,-0.15,1.56,-0.03],['c',0.03,0.06,0.00,0.42,-0.09,1.44],['c',-0.09,0.72,-0.15,1.35,-0.15,1.38],['c',0.00,0.03,-0.03,0.09,-0.06,0.12],['c',-0.06,0.06,-0.12,0.09,-0.51,0.09],['c',-1.08,0.06,-1.80,0.30,-2.28,0.75],['l',-0.12,0.09],['l',0.09,0.09],['c',0.12,0.15,0.39,0.33,0.63,0.45],['c',0.42,0.18,0.96,0.27,1.68,0.33],['c',0.39,0.00,0.45,0.03,0.51,0.09],['c',0.03,0.03,0.06,0.09,0.06,0.12],['c',0.00,0.03,0.06,0.66,0.15,1.38],['c',0.09,1.02,0.12,1.38,0.09,1.44],['c',-0.06,0.12,-0.09,0.12,-1.56,-0.03],['c',-0.78,-0.06,-1.41,-0.15,-1.44,-0.15],['c',-0.09,-0.06,-0.12,-0.12,-0.12,-0.54],['c',-0.06,-0.93,-0.24,-1.56,-0.57,-2.07],['c',-0.06,-0.09,-0.15,-0.21,-0.18,-0.24],['l',-0.09,-0.06],['l',-0.09,0.06],['c',-0.03,0.03,-0.12,0.15,-0.18,0.24],['c',-0.33,0.51,-0.51,1.14,-0.57,2.07],['c',0.00,0.42,-0.03,0.48,-0.12,0.54],['c',-0.03,0.00,-0.66,0.09,-1.44,0.15],['c',-1.47,0.15,-1.50,0.15,-1.56,0.03],['c',-0.03,-0.06,0.00,-0.42,0.09,-1.44],['c',0.09,-0.72,0.15,-1.35,0.15,-1.38],['c',0.00,-0.03,0.03,-0.09,0.06,-0.12],['c',0.06,-0.06,0.12,-0.09,0.51,-0.09],['c',0.72,-0.06,1.26,-0.15,1.68,-0.33],['c',0.24,-0.12,0.51,-0.30,0.63,-0.45],['l',0.09,-0.09],['l',-0.12,-0.09],['c',-0.48,-0.45,-1.20,-0.69,-2.28,-0.75],['c',-0.39,0.00,-0.45,-0.03,-0.51,-0.09],['c',-0.03,-0.03,-0.06,-0.09,-0.06,-0.12],['c',0.00,-0.03,-0.06,-0.63,-0.12,-1.38],['c',-0.09,-0.72,-0.15,-1.35,-0.15,-1.38],['z']],w:7.95,h:7.977},
		'dots.dot':{d:[['M',1.32,-1.68],['c',0.09,-0.03,0.27,-0.06,0.39,-0.06],['c',0.96,0.00,1.74,0.78,1.74,1.71],['c',0.00,0.96,-0.78,1.74,-1.71,1.74],['c',-0.96,0.00,-1.74,-0.78,-1.74,-1.71],['c',0.00,-0.78,0.54,-1.50,1.32,-1.68],['z']],w:3.45,h:3.45},
		'noteheads.dbl':{d:[['M',-0.69,-4.02],['c',0.18,-0.09,0.36,-0.09,0.54,0.00],['c',0.18,0.09,0.24,0.15,0.33,0.30],['c',0.06,0.15,0.06,0.18,0.06,1.41],['l',0.00,1.23],['l',0.12,-0.18],['c',0.72,-1.26,2.64,-2.31,4.86,-2.64],['c',0.81,-0.15,1.11,-0.15,2.13,-0.15],['c',0.99,0.00,1.29,0.00,2.10,0.15],['c',0.75,0.12,1.38,0.27,2.04,0.54],['c',1.35,0.51,2.34,1.26,2.82,2.10],['l',0.12,0.18],['l',0.00,-1.23],['c',0.00,-1.20,0.00,-1.26,0.06,-1.38],['c',0.09,-0.18,0.15,-0.24,0.33,-0.33],['c',0.18,-0.09,0.36,-0.09,0.54,0.00],['c',0.18,0.09,0.24,0.15,0.33,0.30],['l',0.06,0.15],['l',0.00,3.54],['l',0.00,3.54],['l',-0.06,0.15],['c',-0.09,0.18,-0.15,0.24,-0.33,0.33],['c',-0.18,0.09,-0.36,0.09,-0.54,0.00],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['c',-0.06,-0.12,-0.06,-0.18,-0.06,-1.38],['l',0.00,-1.23],['l',-0.12,0.18],['c',-0.48,0.84,-1.47,1.59,-2.82,2.10],['c',-0.84,0.33,-1.71,0.54,-2.85,0.66],['c',-0.45,0.06,-2.16,0.06,-2.61,0.00],['c',-1.14,-0.12,-2.01,-0.33,-2.85,-0.66],['c',-1.35,-0.51,-2.34,-1.26,-2.82,-2.10],['l',-0.12,-0.18],['l',0.00,1.23],['c',0.00,1.23,0.00,1.26,-0.06,1.38],['c',-0.09,0.18,-0.15,0.24,-0.33,0.33],['c',-0.18,0.09,-0.36,0.09,-0.54,0.00],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['l',-0.06,-0.15],['l',0.00,-3.54],['c',0.00,-3.48,0.00,-3.54,0.06,-3.66],['c',0.09,-0.18,0.15,-0.24,0.33,-0.33],['z'],['m',7.71,0.63],['c',-0.36,-0.06,-0.90,-0.06,-1.14,0.00],['c',-0.30,0.03,-0.66,0.24,-0.87,0.42],['c',-0.60,0.54,-0.90,1.62,-0.75,2.82],['c',0.12,0.93,0.51,1.68,1.11,2.31],['c',0.75,0.72,1.83,1.20,2.85,1.26],['c',1.05,0.06,1.83,-0.54,2.10,-1.65],['c',0.21,-0.90,0.12,-1.95,-0.24,-2.82],['c',-0.36,-0.81,-1.08,-1.53,-1.95,-1.95],['c',-0.30,-0.15,-0.78,-0.30,-1.11,-0.39],['z']],w:16.83,h:8.145},
		'noteheads.whole':{d:[['M',6.51,-4.05],['c',0.51,-0.03,2.01,0.00,2.52,0.03],['c',1.41,0.18,2.64,0.51,3.72,1.08],['c',1.20,0.63,1.95,1.41,2.19,2.31],['c',0.09,0.33,0.09,0.90,0.00,1.23],['c',-0.24,0.90,-0.99,1.68,-2.19,2.31],['c',-1.08,0.57,-2.28,0.90,-3.75,1.08],['c',-0.66,0.06,-2.31,0.06,-2.97,0.00],['c',-1.47,-0.18,-2.67,-0.51,-3.75,-1.08],['c',-1.20,-0.63,-1.95,-1.41,-2.19,-2.31],['c',-0.09,-0.33,-0.09,-0.90,0.00,-1.23],['c',0.24,-0.90,0.99,-1.68,2.19,-2.31],['c',1.20,-0.63,2.61,-0.99,4.23,-1.11],['z'],['m',0.57,0.66],['c',-0.87,-0.15,-1.53,0.00,-2.04,0.51],['c',-0.15,0.15,-0.24,0.27,-0.33,0.48],['c',-0.24,0.51,-0.36,1.08,-0.33,1.77],['c',0.03,0.69,0.18,1.26,0.42,1.77],['c',0.60,1.17,1.74,1.98,3.18,2.22],['c',1.11,0.21,1.95,-0.15,2.34,-0.99],['c',0.24,-0.51,0.36,-1.08,0.33,-1.80],['c',-0.06,-1.11,-0.45,-2.04,-1.17,-2.76],['c',-0.63,-0.63,-1.47,-1.05,-2.40,-1.20],['z']],w:14.985,h:8.097},
		'noteheads.half':{d:[['M',7.44,-4.05],['c',0.06,-0.03,0.27,-0.03,0.48,-0.03],['c',1.05,0.00,1.71,0.24,2.10,0.81],['c',0.42,0.60,0.45,1.35,0.18,2.40],['c',-0.42,1.59,-1.14,2.73,-2.16,3.39],['c',-1.41,0.93,-3.18,1.44,-5.40,1.53],['c',-1.17,0.03,-1.89,-0.21,-2.28,-0.81],['c',-0.42,-0.60,-0.45,-1.35,-0.18,-2.40],['c',0.42,-1.59,1.14,-2.73,2.16,-3.39],['c',0.63,-0.42,1.23,-0.72,1.98,-0.96],['c',0.90,-0.30,1.65,-0.42,3.12,-0.54],['z'],['m',1.29,0.87],['c',-0.27,-0.09,-0.63,-0.12,-0.90,-0.03],['c',-0.72,0.24,-1.53,0.69,-3.27,1.80],['c',-2.34,1.50,-3.30,2.25,-3.57,2.79],['c',-0.36,0.72,-0.06,1.50,0.66,1.77],['c',0.24,0.12,0.69,0.09,0.99,0.00],['c',0.84,-0.30,1.92,-0.93,4.14,-2.37],['c',1.62,-1.08,2.37,-1.71,2.61,-2.19],['c',0.36,-0.72,0.06,-1.50,-0.66,-1.77],['z']],w:10.37,h:8.132},
		'noteheads.quarter':{d:[['M',6.09,-4.05],['c',0.36,-0.03,1.20,0.00,1.53,0.06],['c',1.17,0.24,1.89,0.84,2.16,1.83],['c',0.06,0.18,0.06,0.30,0.06,0.66],['c',0.00,0.45,0.00,0.63,-0.15,1.08],['c',-0.66,2.04,-3.06,3.93,-5.52,4.38],['c',-0.54,0.09,-1.44,0.09,-1.83,0.03],['c',-1.23,-0.27,-1.98,-0.87,-2.25,-1.86],['c',-0.06,-0.18,-0.06,-0.30,-0.06,-0.66],['c',0.00,-0.45,0.00,-0.63,0.15,-1.08],['c',0.24,-0.78,0.75,-1.53,1.44,-2.22],['c',1.20,-1.20,2.85,-2.01,4.47,-2.22],['z']],w:9.81,h:8.094},
		'noteheads.slash.nostem':{d:[['M',9.30,-7.77],['c',0.06,-0.06,0.18,-0.06,1.71,-0.06],['l',1.65,0.00],['l',0.09,0.09],['c',0.06,0.06,0.06,0.09,0.06,0.15],['c',-0.03,0.12,-9.21,15.24,-9.30,15.33],['c',-0.06,0.06,-0.18,0.06,-1.71,0.06],['l',-1.65,0.00],['l',-0.09,-0.09],['c',-0.06,-0.06,-0.06,-0.09,-0.06,-0.15],['c',0.03,-0.12,9.21,-15.24,9.30,-15.33],['z']],w:12.81,h:15.63},
		'noteheads.indeterminate':{d:[['M',0.78,-4.05],['c',0.12,-0.03,0.24,-0.03,0.36,0.03],['c',0.03,0.03,0.93,0.72,1.95,1.56],['l',1.86,1.50],['l',1.86,-1.50],['c',1.02,-0.84,1.92,-1.53,1.95,-1.56],['c',0.21,-0.12,0.33,-0.09,0.75,0.24],['c',0.30,0.27,0.36,0.36,0.36,0.54],['c',0.00,0.03,-0.03,0.12,-0.06,0.18],['c',-0.03,0.06,-0.90,0.75,-1.89,1.56],['l',-1.80,1.47],['c',0.00,0.03,0.81,0.69,1.80,1.50],['c',0.99,0.81,1.86,1.50,1.89,1.56],['c',0.03,0.06,0.06,0.15,0.06,0.18],['c',0.00,0.18,-0.06,0.27,-0.36,0.54],['c',-0.42,0.33,-0.54,0.36,-0.75,0.24],['c',-0.03,-0.03,-0.93,-0.72,-1.95,-1.56],['l',-1.86,-1.50],['l',-1.86,1.50],['c',-1.02,0.84,-1.92,1.53,-1.95,1.56],['c',-0.21,0.12,-0.33,0.09,-0.75,-0.24],['c',-0.30,-0.27,-0.36,-0.36,-0.36,-0.54],['c',0.00,-0.03,0.03,-0.12,0.06,-0.18],['c',0.03,-0.06,0.90,-0.75,1.89,-1.56],['l',1.80,-1.47],['c',0.00,-0.03,-0.81,-0.69,-1.80,-1.50],['c',-0.99,-0.81,-1.86,-1.50,-1.89,-1.56],['c',-0.06,-0.12,-0.09,-0.21,-0.03,-0.36],['c',0.03,-0.09,0.57,-0.57,0.72,-0.63],['z']],w:9.843,h:8.139},
		'scripts.ufermata':{d:[['M',-0.75,-10.77],['c',0.12,0.00,0.45,-0.03,0.69,-0.03],['c',2.91,-0.03,5.55,1.53,7.41,4.35],['c',1.17,1.71,1.95,3.72,2.43,6.03],['c',0.12,0.51,0.12,0.57,0.03,0.69],['c',-0.12,0.21,-0.48,0.27,-0.69,0.12],['c',-0.12,-0.09,-0.18,-0.24,-0.27,-0.69],['c',-0.78,-3.63,-3.42,-6.54,-6.78,-7.38],['c',-0.78,-0.21,-1.20,-0.24,-2.07,-0.24],['c',-0.63,0.00,-0.84,0.00,-1.20,0.06],['c',-1.83,0.27,-3.42,1.08,-4.80,2.37],['c',-1.41,1.35,-2.40,3.21,-2.85,5.19],['c',-0.09,0.45,-0.15,0.60,-0.27,0.69],['c',-0.21,0.15,-0.57,0.09,-0.69,-0.12],['c',-0.09,-0.12,-0.09,-0.18,0.03,-0.69],['c',0.33,-1.62,0.78,-3.00,1.47,-4.38],['c',1.77,-3.54,4.44,-5.67,7.56,-5.97],['z'],['m',0.33,7.47],['c',1.38,-0.30,2.58,0.90,2.31,2.25],['c',-0.15,0.72,-0.78,1.35,-1.47,1.50],['c',-1.38,0.27,-2.58,-0.93,-2.31,-2.31],['c',0.15,-0.69,0.78,-1.29,1.47,-1.44],['z']],w:19.748,h:11.289},
		'scripts.dfermata':{d:[['M',-9.63,-0.42],['c',0.15,-0.09,0.36,-0.06,0.51,0.03],['c',0.12,0.09,0.18,0.24,0.27,0.66],['c',0.78,3.66,3.42,6.57,6.78,7.41],['c',0.78,0.21,1.20,0.24,2.07,0.24],['c',0.63,0.00,0.84,0.00,1.20,-0.06],['c',1.83,-0.27,3.42,-1.08,4.80,-2.37],['c',1.41,-1.35,2.40,-3.21,2.85,-5.22],['c',0.09,-0.42,0.15,-0.57,0.27,-0.66],['c',0.21,-0.15,0.57,-0.09,0.69,0.12],['c',0.09,0.12,0.09,0.18,-0.03,0.69],['c',-0.33,1.62,-0.78,3.00,-1.47,4.38],['c',-1.92,3.84,-4.89,6.00,-8.31,6.00],['c',-3.42,0.00,-6.39,-2.16,-8.31,-6.00],['c',-0.48,-0.96,-0.84,-1.92,-1.14,-2.97],['c',-0.18,-0.69,-0.42,-1.74,-0.42,-1.92],['c',0.00,-0.12,0.09,-0.27,0.24,-0.33],['z'],['m',9.21,0.00],['c',1.20,-0.27,2.34,0.63,2.34,1.86],['c',0.00,0.90,-0.66,1.68,-1.50,1.89],['c',-1.38,0.27,-2.58,-0.93,-2.31,-2.31],['c',0.15,-0.69,0.78,-1.29,1.47,-1.44],['z']],w:19.744,h:11.274},
		'scripts.sforzato':{d:[['M',-6.45,-3.69],['c',0.06,-0.03,0.15,-0.06,0.18,-0.06],['c',0.06,0.00,2.85,0.72,6.24,1.59],['l',6.33,1.65],['c',0.33,0.06,0.45,0.21,0.45,0.51],['c',0.00,0.30,-0.12,0.45,-0.45,0.51],['l',-6.33,1.65],['c',-3.39,0.87,-6.18,1.59,-6.21,1.59],['c',-0.21,0.00,-0.48,-0.24,-0.51,-0.45],['c',0.00,-0.15,0.06,-0.36,0.18,-0.45],['c',0.09,-0.06,0.87,-0.27,3.84,-1.05],['c',2.04,-0.54,3.84,-0.99,4.02,-1.02],['c',0.15,-0.06,1.14,-0.24,2.22,-0.42],['c',1.05,-0.18,1.92,-0.36,1.92,-0.36],['c',0.00,0.00,-0.87,-0.18,-1.92,-0.36],['c',-1.08,-0.18,-2.07,-0.36,-2.22,-0.42],['c',-0.18,-0.03,-1.98,-0.48,-4.02,-1.02],['c',-2.97,-0.78,-3.75,-0.99,-3.84,-1.05],['c',-0.12,-0.09,-0.18,-0.30,-0.18,-0.45],['c',0.03,-0.15,0.15,-0.30,0.30,-0.39],['z']],w:13.5,h:7.5},
		'scripts.staccato':{d:[['M',-0.36,-1.47],['c',0.93,-0.21,1.86,0.51,1.86,1.47],['c',0.00,0.93,-0.87,1.65,-1.80,1.47],['c',-0.54,-0.12,-1.02,-0.57,-1.14,-1.08],['c',-0.21,-0.81,0.27,-1.65,1.08,-1.86],['z']],w:2.989,h:3.004},
		'scripts.tenuto':{d:[['M',-4.20,-0.48],['l',0.12,-0.06],['l',4.08,0.00],['l',4.08,0.00],['l',0.12,0.06],['c',0.39,0.21,0.39,0.75,0.00,0.96],['l',-0.12,0.06],['l',-4.08,0.00],['l',-4.08,0.00],['l',-0.12,-0.06],['c',-0.39,-0.21,-0.39,-0.75,0.00,-0.96],['z']],w:8.985,h:1.08},
		'scripts.umarcato':{d:[['M',-0.15,-8.19],['c',0.15,-0.12,0.36,-0.03,0.45,0.15],['c',0.21,0.42,3.45,7.65,3.45,7.71],['c',0.00,0.12,-0.12,0.27,-0.21,0.30],['c',-0.03,0.03,-0.51,0.03,-1.14,0.03],['c',-1.05,0.00,-1.08,0.00,-1.17,-0.06],['c',-0.09,-0.06,-0.24,-0.36,-1.17,-2.40],['c',-0.57,-1.29,-1.05,-2.34,-1.08,-2.34],['c',0.00,-0.03,-0.51,1.02,-1.08,2.34],['c',-0.93,2.07,-1.08,2.34,-1.14,2.40],['c',-0.06,0.03,-0.15,0.06,-0.18,0.06],['c',-0.15,0.00,-0.33,-0.18,-0.33,-0.33],['c',0.00,-0.06,3.24,-7.32,3.45,-7.71],['c',0.03,-0.06,0.09,-0.15,0.15,-0.15],['z']],w:7.5,h:8.245},
		'scripts.dmarcato':{d:[['M',-3.57,0.03],['c',0.03,0.00,0.57,-0.03,1.17,-0.03],['c',1.05,0.00,1.08,0.00,1.17,0.06],['c',0.09,0.06,0.24,0.36,1.17,2.40],['c',0.57,1.29,1.05,2.34,1.08,2.34],['c',0.00,0.03,0.51,-1.02,1.08,-2.34],['c',0.93,-2.07,1.08,-2.34,1.14,-2.40],['c',0.06,-0.03,0.15,-0.06,0.18,-0.06],['c',0.15,0.00,0.33,0.18,0.33,0.33],['c',0.00,0.09,-3.45,7.74,-3.54,7.83],['c',-0.12,0.12,-0.30,0.12,-0.42,0.00],['c',-0.09,-0.09,-3.54,-7.74,-3.54,-7.83],['c',0.00,-0.09,0.12,-0.27,0.18,-0.30],['z']],w:7.5,h:8.25},
		'scripts.stopped':{d:[['M',-0.27,-4.08],['c',0.18,-0.09,0.36,-0.09,0.54,0.00],['c',0.18,0.09,0.24,0.15,0.33,0.30],['l',0.06,0.15],['l',0.00,1.50],['l',0.00,1.47],['l',1.47,0.00],['l',1.50,0.00],['l',0.15,0.06],['c',0.15,0.09,0.21,0.15,0.30,0.33],['c',0.09,0.18,0.09,0.36,0.00,0.54],['c',-0.09,0.18,-0.15,0.24,-0.33,0.33],['c',-0.12,0.06,-0.18,0.06,-1.62,0.06],['l',-1.47,0.00],['l',0.00,1.47],['l',0.00,1.47],['l',-0.06,0.15],['c',-0.09,0.18,-0.15,0.24,-0.33,0.33],['c',-0.18,0.09,-0.36,0.09,-0.54,0.00],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['l',-0.06,-0.15],['l',0.00,-1.47],['l',0.00,-1.47],['l',-1.47,0.00],['c',-1.44,0.00,-1.50,0.00,-1.62,-0.06],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['c',-0.09,-0.18,-0.09,-0.36,0.00,-0.54],['c',0.09,-0.18,0.15,-0.24,0.33,-0.33],['l',0.15,-0.06],['l',1.47,0.00],['l',1.47,0.00],['l',0.00,-1.47],['c',0.00,-1.44,0.00,-1.50,0.06,-1.62],['c',0.09,-0.18,0.15,-0.24,0.33,-0.33],['z']],w:8.295,h:8.295},
		'scripts.upbow':{d:[['M',-4.65,-15.54],['c',0.12,-0.09,0.36,-0.06,0.48,0.03],['c',0.03,0.03,0.09,0.09,0.12,0.15],['c',0.03,0.06,0.66,2.13,1.41,4.62],['c',1.35,4.41,1.38,4.56,2.01,6.96],['l',0.63,2.46],['l',0.63,-2.46],['c',0.63,-2.40,0.66,-2.55,2.01,-6.96],['c',0.75,-2.49,1.38,-4.56,1.41,-4.62],['c',0.06,-0.15,0.18,-0.21,0.36,-0.24],['c',0.15,0.00,0.30,0.06,0.39,0.18],['c',0.15,0.21,0.24,-0.18,-2.10,7.56],['c',-1.20,3.96,-2.22,7.32,-2.25,7.41],['c',0.00,0.12,-0.06,0.27,-0.09,0.30],['c',-0.12,0.21,-0.60,0.21,-0.72,0.00],['c',-0.03,-0.03,-0.09,-0.18,-0.09,-0.30],['c',-0.03,-0.09,-1.05,-3.45,-2.25,-7.41],['c',-2.34,-7.74,-2.25,-7.35,-2.10,-7.56],['c',0.03,-0.03,0.09,-0.09,0.15,-0.12],['z']],w:9.73,h:15.608},
		'scripts.downbow':{d:[['M',-5.55,-9.93],['l',0.09,-0.06],['l',5.46,0.00],['l',5.46,0.00],['l',0.09,0.06],['l',0.06,0.09],['l',0.00,4.77],['c',0.00,5.28,0.00,4.89,-0.18,5.01],['c',-0.18,0.12,-0.42,0.06,-0.54,-0.12],['c',-0.06,-0.09,-0.06,-0.18,-0.06,-2.97],['l',0.00,-2.85],['l',-4.83,0.00],['l',-4.83,0.00],['l',0.00,2.85],['c',0.00,2.79,0.00,2.88,-0.06,2.97],['c',-0.15,0.24,-0.51,0.24,-0.66,0.00],['c',-0.06,-0.09,-0.06,-0.21,-0.06,-4.89],['l',0.00,-4.77],['z']],w:11.22,h:9.992},
		'scripts.turn':{d:[['M',-4.77,-3.90],['c',0.36,-0.06,1.05,-0.06,1.44,0.03],['c',0.78,0.15,1.50,0.51,2.34,1.14],['c',0.60,0.45,1.05,0.87,2.22,2.01],['c',1.11,1.08,1.62,1.50,2.22,1.86],['c',0.60,0.36,1.32,0.57,1.92,0.57],['c',0.90,0.00,1.71,-0.57,1.89,-1.35],['c',0.24,-0.93,-0.39,-1.89,-1.35,-2.10],['l',-0.15,-0.06],['l',-0.09,0.15],['c',-0.03,0.09,-0.15,0.24,-0.24,0.33],['c',-0.72,0.72,-2.04,0.54,-2.49,-0.36],['c',-0.48,-0.93,0.03,-1.86,1.17,-2.19],['c',0.30,-0.09,1.02,-0.09,1.35,0.00],['c',0.99,0.27,1.74,0.87,2.25,1.83],['c',0.69,1.41,0.63,3.00,-0.21,4.26],['c',-0.21,0.30,-0.69,0.81,-0.99,1.02],['c',-0.30,0.21,-0.84,0.45,-1.17,0.54],['c',-1.23,0.36,-2.49,0.15,-3.72,-0.60],['c',-0.75,-0.48,-1.41,-1.02,-2.85,-2.46],['c',-1.11,-1.08,-1.62,-1.50,-2.22,-1.86],['c',-0.60,-0.36,-1.32,-0.57,-1.92,-0.57],['c',-0.90,0.00,-1.71,0.57,-1.89,1.35],['c',-0.24,0.93,0.39,1.89,1.35,2.10],['l',0.15,0.06],['l',0.09,-0.15],['c',0.03,-0.09,0.15,-0.24,0.24,-0.33],['c',0.72,-0.72,2.04,-0.54,2.49,0.36],['c',0.48,0.93,-0.03,1.86,-1.17,2.19],['c',-0.30,0.09,-1.02,0.09,-1.35,0.00],['c',-0.99,-0.27,-1.74,-0.87,-2.25,-1.83],['c',-0.69,-1.41,-0.63,-3.00,0.21,-4.26],['c',0.21,-0.30,0.69,-0.81,0.99,-1.02],['c',0.48,-0.33,1.11,-0.57,1.74,-0.66],['z']],w:16.366,h:7.893},
		'scripts.trill':{d:[['M',-0.51,-16.02],['c',0.12,-0.09,0.21,-0.18,0.21,-0.18],['l',-0.81,4.02],['l',-0.81,4.02],['c',0.03,0.00,0.51,-0.27,1.08,-0.60],['c',0.60,-0.30,1.14,-0.63,1.26,-0.66],['c',1.14,-0.54,2.31,-0.60,3.09,-0.18],['c',0.27,0.15,0.54,0.36,0.60,0.51],['l',0.06,0.12],['l',0.21,-0.21],['c',0.90,-0.81,2.22,-0.99,3.12,-0.42],['c',0.60,0.42,0.90,1.14,0.78,2.07],['c',-0.15,1.29,-1.05,2.31,-1.95,2.25],['c',-0.48,-0.03,-0.78,-0.30,-0.96,-0.81],['c',-0.09,-0.27,-0.09,-0.90,-0.03,-1.20],['c',0.21,-0.75,0.81,-1.23,1.59,-1.32],['l',0.24,-0.03],['l',-0.09,-0.12],['c',-0.51,-0.66,-1.62,-0.63,-2.31,0.03],['c',-0.39,0.42,-0.30,0.09,-1.23,4.77],['l',-0.81,4.14],['c',-0.03,0.00,-0.12,-0.03,-0.21,-0.09],['c',-0.33,-0.15,-0.54,-0.18,-0.99,-0.18],['c',-0.42,0.00,-0.66,0.03,-1.05,0.18],['c',-0.12,0.06,-0.21,0.09,-0.21,0.09],['c',0.00,-0.03,0.36,-1.86,0.81,-4.11],['c',0.90,-4.47,0.87,-4.26,0.69,-4.53],['c',-0.21,-0.36,-0.66,-0.51,-1.17,-0.36],['c',-0.15,0.06,-2.22,1.14,-2.58,1.38],['c',-0.12,0.09,-0.12,0.09,-0.21,0.60],['l',-0.09,0.51],['l',0.21,0.24],['c',0.63,0.75,1.02,1.47,1.20,2.19],['c',0.06,0.27,0.06,0.36,0.06,0.81],['c',0.00,0.42,0.00,0.54,-0.06,0.78],['c',-0.15,0.54,-0.33,0.93,-0.63,1.35],['c',-0.18,0.24,-0.57,0.63,-0.81,0.78],['c',-0.24,0.15,-0.63,0.36,-0.84,0.42],['c',-0.27,0.06,-0.66,0.06,-0.87,0.03],['c',-0.81,-0.18,-1.32,-1.05,-1.38,-2.46],['c',-0.03,-0.60,0.03,-0.99,0.33,-2.46],['c',0.21,-1.08,0.24,-1.32,0.21,-1.29],['c',-1.20,0.48,-2.40,0.75,-3.21,0.72],['c',-0.69,-0.06,-1.17,-0.30,-1.41,-0.72],['c',-0.39,-0.75,-0.12,-1.80,0.66,-2.46],['c',0.24,-0.18,0.69,-0.42,1.02,-0.51],['c',0.69,-0.18,1.53,-0.15,2.31,0.09],['c',0.30,0.09,0.75,0.30,0.99,0.45],['c',0.12,0.09,0.15,0.09,0.15,0.03],['c',0.03,-0.03,0.33,-1.59,0.72,-3.45],['c',0.36,-1.86,0.66,-3.42,0.69,-3.45],['c',0.00,-0.03,0.03,-0.03,0.21,0.03],['c',0.21,0.06,0.27,0.06,0.48,0.06],['c',0.42,-0.03,0.78,-0.18,1.26,-0.48],['c',0.15,-0.12,0.36,-0.27,0.48,-0.39],['z'],['m',-5.73,7.68],['c',-0.27,-0.03,-0.96,-0.06,-1.20,-0.03],['c',-0.81,0.12,-1.35,0.57,-1.50,1.20],['c',-0.18,0.66,0.12,1.14,0.75,1.29],['c',0.66,0.12,1.92,-0.12,3.18,-0.66],['l',0.33,-0.15],['l',0.09,-0.39],['c',0.06,-0.21,0.09,-0.42,0.09,-0.45],['c',0.00,-0.03,-0.45,-0.30,-0.75,-0.45],['c',-0.27,-0.15,-0.66,-0.27,-0.99,-0.36],['z'],['m',4.29,3.63],['c',-0.24,-0.39,-0.51,-0.75,-0.51,-0.69],['c',-0.06,0.12,-0.39,1.92,-0.45,2.28],['c',-0.09,0.54,-0.12,1.14,-0.06,1.38],['c',0.06,0.42,0.21,0.60,0.51,0.57],['c',0.39,-0.06,0.75,-0.48,0.93,-1.14],['c',0.09,-0.33,0.09,-1.05,0.00,-1.38],['c',-0.09,-0.39,-0.24,-0.69,-0.42,-1.02],['z']],w:17.963,h:16.49},
		'scripts.segno':{d:[['M',-3.72,-11.22],['c',0.78,-0.09,1.59,0.03,2.31,0.42],['c',1.20,0.60,2.01,1.71,2.31,3.09],['c',0.09,0.42,0.09,1.20,0.03,1.50],['c',-0.15,0.45,-0.39,0.81,-0.66,0.93],['c',-0.33,0.18,-0.84,0.21,-1.23,0.15],['c',-0.81,-0.18,-1.32,-0.93,-1.26,-1.89],['c',0.03,-0.36,0.09,-0.57,0.24,-0.90],['c',0.15,-0.33,0.45,-0.60,0.72,-0.75],['c',0.12,-0.06,0.18,-0.09,0.18,-0.12],['c',0.00,-0.03,-0.03,-0.15,-0.09,-0.24],['c',-0.18,-0.45,-0.54,-0.87,-0.96,-1.08],['c',-1.11,-0.57,-2.34,-0.18,-2.88,0.90],['c',-0.24,0.51,-0.33,1.11,-0.24,1.83],['c',0.27,1.92,1.50,3.54,3.93,5.13],['c',0.48,0.33,1.26,0.78,1.29,0.78],['c',0.03,0.00,1.35,-2.19,2.94,-4.89],['l',2.88,-4.89],['l',0.84,0.00],['l',0.87,0.00],['l',-0.03,0.06],['c',-0.15,0.21,-6.15,10.41,-6.15,10.44],['c',0.00,0.00,0.21,0.15,0.48,0.27],['c',2.61,1.47,4.35,3.03,5.13,4.65],['c',1.14,2.34,0.51,5.07,-1.44,6.39],['c',-0.66,0.42,-1.32,0.63,-2.13,0.69],['c',-2.01,0.09,-3.81,-1.41,-4.26,-3.54],['c',-0.09,-0.42,-0.09,-1.20,-0.03,-1.50],['c',0.15,-0.45,0.39,-0.81,0.66,-0.93],['c',0.33,-0.18,0.84,-0.21,1.23,-0.15],['c',0.81,0.18,1.32,0.93,1.26,1.89],['c',-0.03,0.36,-0.09,0.57,-0.24,0.90],['c',-0.15,0.33,-0.45,0.60,-0.72,0.75],['c',-0.12,0.06,-0.18,0.09,-0.18,0.12],['c',0.00,0.03,0.03,0.15,0.09,0.24],['c',0.18,0.45,0.54,0.87,0.96,1.08],['c',1.11,0.57,2.34,0.18,2.88,-0.90],['c',0.24,-0.51,0.33,-1.11,0.24,-1.83],['c',-0.27,-1.92,-1.50,-3.54,-3.93,-5.13],['c',-0.48,-0.33,-1.26,-0.78,-1.29,-0.78],['c',-0.03,0.00,-1.35,2.19,-2.91,4.89],['l',-2.88,4.89],['l',-0.87,0.00],['l',-0.87,0.00],['l',0.03,-0.06],['c',0.15,-0.21,6.15,-10.41,6.15,-10.44],['c',0.00,0.00,-0.21,-0.15,-0.48,-0.30],['c',-2.61,-1.44,-4.35,-3.00,-5.13,-4.62],['c',-0.90,-1.89,-0.72,-4.02,0.48,-5.52],['c',0.69,-0.84,1.68,-1.41,2.73,-1.53],['z'],['m',8.76,9.09],['c',0.03,-0.03,0.15,-0.03,0.27,-0.03],['c',0.33,0.03,0.57,0.18,0.72,0.48],['c',0.09,0.18,0.09,0.57,0.00,0.75],['c',-0.09,0.18,-0.21,0.30,-0.36,0.39],['c',-0.15,0.06,-0.21,0.06,-0.39,0.06],['c',-0.21,0.00,-0.27,0.00,-0.39,-0.06],['c',-0.30,-0.15,-0.48,-0.45,-0.48,-0.75],['c',0.00,-0.39,0.24,-0.72,0.63,-0.84],['z'],['m',-10.53,2.61],['c',0.03,-0.03,0.15,-0.03,0.27,-0.03],['c',0.33,0.03,0.57,0.18,0.72,0.48],['c',0.09,0.18,0.09,0.57,0.00,0.75],['c',-0.09,0.18,-0.21,0.30,-0.36,0.39],['c',-0.15,0.06,-0.21,0.06,-0.39,0.06],['c',-0.21,0.00,-0.27,0.00,-0.39,-0.06],['c',-0.30,-0.15,-0.48,-0.45,-0.48,-0.75],['c',0.00,-0.39,0.24,-0.72,0.63,-0.84],['z']],w:15,h:22.504},
		'scripts.coda':{d:[['M',-0.21,-10.47],['c',0.18,-0.12,0.42,-0.06,0.54,0.12],['c',0.06,0.09,0.06,0.18,0.06,1.50],['l',0.00,1.38],['l',0.18,0.00],['c',0.39,0.06,0.96,0.24,1.38,0.48],['c',1.68,0.93,2.82,3.24,3.03,6.12],['c',0.03,0.24,0.03,0.45,0.03,0.45],['c',0.00,0.03,0.60,0.03,1.35,0.03],['c',1.50,0.00,1.47,0.00,1.59,0.18],['c',0.09,0.12,0.09,0.30,0.00,0.42],['c',-0.12,0.18,-0.09,0.18,-1.59,0.18],['c',-0.75,0.00,-1.35,0.00,-1.35,0.03],['c',0.00,0.00,0.00,0.21,-0.03,0.42],['c',-0.24,3.15,-1.53,5.58,-3.45,6.36],['c',-0.27,0.12,-0.72,0.24,-0.96,0.27],['l',-0.18,0.00],['l',0.00,1.38],['c',0.00,1.32,0.00,1.41,-0.06,1.50],['c',-0.15,0.24,-0.51,0.24,-0.66,0.00],['c',-0.06,-0.09,-0.06,-0.18,-0.06,-1.50],['l',0.00,-1.38],['l',-0.18,0.00],['c',-0.39,-0.06,-0.96,-0.24,-1.38,-0.48],['c',-1.68,-0.93,-2.82,-3.24,-3.03,-6.15],['c',-0.03,-0.21,-0.03,-0.42,-0.03,-0.42],['c',0.00,-0.03,-0.60,-0.03,-1.35,-0.03],['c',-1.50,0.00,-1.47,0.00,-1.59,-0.18],['c',-0.09,-0.12,-0.09,-0.30,0.00,-0.42],['c',0.12,-0.18,0.09,-0.18,1.59,-0.18],['c',0.75,0.00,1.35,0.00,1.35,-0.03],['c',0.00,0.00,0.00,-0.21,0.03,-0.45],['c',0.24,-3.12,1.53,-5.55,3.45,-6.33],['c',0.27,-0.12,0.72,-0.24,0.96,-0.27],['l',0.18,0.00],['l',0.00,-1.38],['c',0.00,-1.53,0.00,-1.50,0.18,-1.62],['z'],['m',-0.18,6.93],['c',0.00,-2.97,0.00,-3.15,-0.06,-3.15],['c',-0.09,0.00,-0.51,0.15,-0.66,0.21],['c',-0.87,0.51,-1.38,1.62,-1.56,3.51],['c',-0.06,0.54,-0.12,1.59,-0.12,2.16],['l',0.00,0.42],['l',1.20,0.00],['l',1.20,0.00],['l',0.00,-3.15],['z'],['m',1.17,-3.06],['c',-0.09,-0.03,-0.21,-0.06,-0.27,-0.09],['l',-0.12,0.00],['l',0.00,3.15],['l',0.00,3.15],['l',1.20,0.00],['l',1.20,0.00],['l',0.00,-0.81],['c',-0.06,-2.40,-0.33,-3.69,-0.93,-4.59],['c',-0.27,-0.39,-0.66,-0.69,-1.08,-0.81],['z'],['m',-1.17,10.14],['l',0.00,-3.15],['l',-1.20,0.00],['l',-1.20,0.00],['l',0.00,0.81],['c',0.03,0.96,0.06,1.47,0.15,2.13],['c',0.24,2.04,0.96,3.12,2.13,3.36],['l',0.12,0.00],['l',0.00,-3.15],['z'],['m',3.18,-2.34],['l',0.00,-0.81],['l',-1.20,0.00],['l',-1.20,0.00],['l',0.00,3.15],['l',0.00,3.15],['l',0.12,0.00],['c',1.17,-0.24,1.89,-1.32,2.13,-3.36],['c',0.09,-0.66,0.12,-1.17,0.15,-2.13],['z']],w:16.035,h:21.062},
		'scripts.comma':{d:[['M',1.14,-4.62],['c',0.30,-0.12,0.69,-0.03,0.93,0.15],['c',0.12,0.12,0.36,0.45,0.51,0.78],['c',0.90,1.77,0.54,4.05,-1.08,6.75],['c',-0.36,0.63,-0.87,1.38,-0.96,1.44],['c',-0.18,0.12,-0.42,0.06,-0.54,-0.12],['c',-0.09,-0.18,-0.09,-0.30,0.12,-0.60],['c',0.96,-1.44,1.44,-2.97,1.38,-4.35],['c',-0.06,-0.93,-0.30,-1.68,-0.78,-2.46],['c',-0.27,-0.39,-0.33,-0.63,-0.24,-0.96],['c',0.09,-0.27,0.36,-0.54,0.66,-0.63],['z']],w:3.042,h:9.237},
		'scripts.roll':{d:[['M',1.95,-6.00],['c',0.21,-0.09,0.36,-0.09,0.57,0.00],['c',0.39,0.15,0.63,0.39,1.47,1.35],['c',0.66,0.75,0.78,0.87,1.08,1.05],['c',0.75,0.45,1.65,0.42,2.40,-0.06],['c',0.12,-0.09,0.27,-0.27,0.54,-0.60],['c',0.42,-0.54,0.51,-0.63,0.69,-0.63],['c',0.09,0.00,0.30,0.12,0.36,0.21],['c',0.09,0.12,0.12,0.30,0.03,0.42],['c',-0.06,0.12,-3.15,3.90,-3.30,4.08],['c',-0.06,0.06,-0.18,0.12,-0.27,0.18],['c',-0.27,0.12,-0.60,0.06,-0.99,-0.27],['c',-0.27,-0.21,-0.42,-0.39,-1.08,-1.14],['c',-0.63,-0.72,-0.81,-0.90,-1.17,-1.08],['c',-0.36,-0.18,-0.57,-0.21,-0.99,-0.21],['c',-0.39,0.00,-0.63,0.03,-0.93,0.18],['c',-0.36,0.15,-0.51,0.27,-0.90,0.81],['c',-0.24,0.27,-0.45,0.51,-0.48,0.54],['c',-0.12,0.09,-0.27,0.06,-0.39,0.00],['c',-0.24,-0.15,-0.33,-0.39,-0.21,-0.60],['c',0.09,-0.12,3.18,-3.87,3.33,-4.02],['c',0.06,-0.06,0.18,-0.15,0.24,-0.21],['z']],w:10.817,h:6.125},
		'scripts.prall':{d:[['M',-4.38,-3.69],['c',0.06,-0.03,0.18,-0.06,0.24,-0.06],['c',0.30,0.00,0.27,-0.03,1.89,1.95],['l',1.53,1.83],['c',0.03,0.00,0.57,-0.84,1.23,-1.83],['c',1.14,-1.68,1.23,-1.83,1.35,-1.89],['c',0.06,-0.03,0.18,-0.06,0.24,-0.06],['c',0.30,0.00,0.27,-0.03,1.89,1.95],['l',1.53,1.83],['l',0.48,-0.69],['c',0.51,-0.78,0.54,-0.84,0.69,-0.90],['c',0.42,-0.18,0.87,0.15,0.81,0.60],['c',-0.03,0.12,-0.30,0.51,-1.50,2.37],['c',-1.38,2.07,-1.50,2.22,-1.62,2.28],['c',-0.06,0.03,-0.18,0.06,-0.24,0.06],['c',-0.30,0.00,-0.27,0.03,-1.89,-1.95],['l',-1.53,-1.83],['c',-0.03,0.00,-0.57,0.84,-1.23,1.83],['c',-1.14,1.68,-1.23,1.83,-1.35,1.89],['c',-0.06,0.03,-0.18,0.06,-0.24,0.06],['c',-0.30,0.00,-0.27,0.03,-1.89,-1.95],['l',-1.53,-1.83],['l',-0.48,0.69],['c',-0.51,0.78,-0.54,0.84,-0.69,0.90],['c',-0.42,0.18,-0.87,-0.15,-0.81,-0.60],['c',0.03,-0.12,0.30,-0.51,1.50,-2.37],['c',1.38,-2.07,1.50,-2.22,1.62,-2.28],['z']],w:15.011,h:7.5},
		'scripts.mordent':{d:[['M',-0.21,-4.95],['c',0.27,-0.15,0.63,0.00,0.75,0.27],['c',0.06,0.12,0.06,0.24,0.06,1.44],['l',0.00,1.29],['l',0.57,-0.84],['c',0.51,-0.75,0.57,-0.84,0.69,-0.90],['c',0.06,-0.03,0.18,-0.06,0.24,-0.06],['c',0.30,0.00,0.27,-0.03,1.89,1.95],['l',1.53,1.83],['l',0.48,-0.69],['c',0.51,-0.78,0.54,-0.84,0.69,-0.90],['c',0.42,-0.18,0.87,0.15,0.81,0.60],['c',-0.03,0.12,-0.30,0.51,-1.50,2.37],['c',-1.38,2.07,-1.50,2.22,-1.62,2.28],['c',-0.06,0.03,-0.18,0.06,-0.24,0.06],['c',-0.30,0.00,-0.27,0.03,-1.83,-1.89],['c',-0.81,-0.99,-1.50,-1.80,-1.53,-1.86],['c',-0.06,-0.03,-0.06,-0.03,-0.12,0.03],['c',-0.06,0.06,-0.06,0.15,-0.06,2.28],['c',0.00,1.95,0.00,2.25,-0.06,2.34],['c',-0.18,0.45,-0.81,0.48,-1.05,0.03],['c',-0.03,-0.06,-0.06,-0.24,-0.06,-1.41],['l',0.00,-1.35],['l',-0.57,0.84],['c',-0.54,0.78,-0.60,0.87,-0.72,0.93],['c',-0.06,0.03,-0.18,0.06,-0.24,0.06],['c',-0.30,0.00,-0.27,0.03,-1.89,-1.95],['l',-1.53,-1.83],['l',-0.48,0.69],['c',-0.51,0.78,-0.54,0.84,-0.69,0.90],['c',-0.42,0.18,-0.87,-0.15,-0.81,-0.60],['c',0.03,-0.12,0.30,-0.51,1.50,-2.37],['c',1.38,-2.07,1.50,-2.22,1.62,-2.28],['c',0.06,-0.03,0.18,-0.06,0.24,-0.06],['c',0.30,0.00,0.27,-0.03,1.89,1.95],['l',1.53,1.83],['c',0.03,0.00,0.06,-0.06,0.09,-0.09],['c',0.06,-0.12,0.06,-0.15,0.06,-2.28],['c',0.00,-1.92,0.00,-2.22,0.06,-2.31],['c',0.06,-0.15,0.15,-0.24,0.30,-0.30],['z']],w:15.011,h:10.012},
		'flags.u8th':{d:[['M',-0.42,3.75],['l',0.00,-3.75],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,0.18],['c',0.00,0.30,0.06,0.84,0.12,1.23],['c',0.24,1.53,0.90,3.12,2.13,5.16],['l',0.99,1.59],['c',0.87,1.44,1.38,2.34,1.77,3.09],['c',0.81,1.68,1.20,3.06,1.26,4.53],['c',0.03,1.53,-0.21,3.27,-0.75,5.01],['c',-0.21,0.69,-0.51,1.50,-0.60,1.59],['c',-0.09,0.12,-0.27,0.21,-0.42,0.21],['c',-0.15,0.00,-0.42,-0.12,-0.51,-0.21],['c',-0.15,-0.18,-0.18,-0.42,-0.09,-0.66],['c',0.15,-0.33,0.45,-1.20,0.57,-1.62],['c',0.42,-1.38,0.60,-2.58,0.60,-3.90],['c',0.00,-0.66,0.00,-0.81,-0.06,-1.11],['c',-0.39,-2.07,-1.80,-4.26,-4.59,-7.14],['l',-0.42,-0.45],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-3.75],['z']],w:6.692,h:22.59},
		'flags.u16th':{d:[['M',-0.42,7.50],['l',0.00,-7.50],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,0.39],['c',0.06,1.08,0.39,2.19,0.99,3.39],['c',0.45,0.90,0.87,1.59,1.95,3.12],['c',1.29,1.86,1.77,2.64,2.22,3.57],['c',0.45,0.93,0.72,1.80,0.87,2.64],['c',0.06,0.51,0.06,1.50,0.00,1.92],['c',-0.12,0.60,-0.30,1.20,-0.54,1.71],['l',-0.09,0.24],['l',0.18,0.45],['c',0.51,1.20,0.72,2.22,0.69,3.42],['c',-0.06,1.53,-0.39,3.03,-0.99,4.53],['c',-0.30,0.75,-0.36,0.81,-0.57,0.90],['c',-0.15,0.09,-0.33,0.06,-0.48,0.00],['c',-0.18,-0.09,-0.27,-0.18,-0.33,-0.33],['c',-0.09,-0.18,-0.06,-0.30,0.12,-0.75],['c',0.66,-1.41,1.02,-2.88,1.08,-4.32],['c',0.00,-0.60,-0.03,-1.05,-0.18,-1.59],['c',-0.30,-1.20,-0.99,-2.40,-2.25,-3.87],['c',-0.42,-0.48,-1.53,-1.62,-2.19,-2.22],['l',-0.45,-0.42],['l',-0.03,1.11],['l',0.00,1.11],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-7.50],['z'],['m',1.65,0.09],['c',-0.30,-0.30,-0.69,-0.72,-0.90,-0.87],['l',-0.33,-0.33],['l',0.00,0.15],['c',0.00,0.30,0.06,0.81,0.15,1.26],['c',0.27,1.29,0.87,2.61,2.04,4.29],['c',0.15,0.24,0.60,0.87,0.96,1.38],['l',1.08,1.53],['l',0.42,0.63],['c',0.03,0.00,0.12,-0.36,0.21,-0.72],['c',0.06,-0.33,0.06,-1.20,0.00,-1.62],['c',-0.33,-1.71,-1.44,-3.48,-3.63,-5.70],['z']],w:6.693,h:26.337},
		'flags.u32nd':{d:[['M',-0.42,11.25],['l',0.00,-11.25],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,0.36],['c',0.09,1.68,0.69,3.27,2.07,5.46],['l',0.87,1.35],['c',1.02,1.62,1.47,2.37,1.86,3.18],['c',0.48,1.02,0.78,1.92,0.93,2.88],['c',0.06,0.48,0.06,1.50,0.00,1.89],['c',-0.09,0.42,-0.21,0.87,-0.36,1.26],['l',-0.12,0.30],['l',0.15,0.39],['c',0.69,1.56,0.84,2.88,0.54,4.38],['c',-0.09,0.45,-0.27,1.08,-0.45,1.47],['l',-0.12,0.24],['l',0.18,0.36],['c',0.33,0.72,0.57,1.56,0.69,2.34],['c',0.12,1.02,-0.06,2.52,-0.42,3.84],['c',-0.27,0.93,-0.75,2.13,-0.93,2.31],['c',-0.18,0.15,-0.45,0.18,-0.66,0.09],['c',-0.18,-0.09,-0.27,-0.18,-0.33,-0.33],['c',-0.09,-0.18,-0.06,-0.30,0.06,-0.60],['c',0.21,-0.36,0.42,-0.90,0.57,-1.38],['c',0.51,-1.41,0.69,-3.06,0.48,-4.08],['c',-0.15,-0.81,-0.57,-1.68,-1.20,-2.55],['c',-0.72,-0.99,-1.83,-2.13,-3.30,-3.33],['l',-0.48,-0.42],['l',-0.03,1.53],['l',0.00,1.56],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-11.25],['z'],['m',1.26,-3.96],['c',-0.27,-0.30,-0.54,-0.60,-0.66,-0.72],['l',-0.18,-0.21],['l',0.00,0.42],['c',0.06,0.87,0.24,1.74,0.66,2.67],['c',0.36,0.87,0.96,1.86,1.92,3.18],['c',0.21,0.33,0.63,0.87,0.87,1.23],['c',0.27,0.39,0.60,0.84,0.75,1.08],['l',0.27,0.39],['l',0.03,-0.12],['c',0.12,-0.45,0.15,-1.05,0.09,-1.59],['c',-0.27,-1.86,-1.38,-3.78,-3.75,-6.33],['z'],['m',-0.27,6.09],['c',-0.27,-0.21,-0.48,-0.42,-0.51,-0.45],['c',-0.06,-0.03,-0.06,-0.03,-0.06,0.21],['c',0.00,0.90,0.30,2.04,0.81,3.09],['c',0.48,1.02,0.96,1.77,2.37,3.63],['c',0.60,0.78,1.05,1.44,1.29,1.77],['c',0.06,0.12,0.15,0.21,0.15,0.18],['c',0.03,-0.03,0.18,-0.57,0.24,-0.87],['c',0.06,-0.45,0.06,-1.32,-0.03,-1.74],['c',-0.09,-0.48,-0.24,-0.90,-0.51,-1.44],['c',-0.66,-1.35,-1.83,-2.70,-3.75,-4.38],['z']],w:6.697,h:32.145},
		'flags.u64th':{d:[['M',-0.42,15.00],['l',0.00,-15.00],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,0.36],['c',0.06,1.20,0.39,2.37,1.02,3.66],['c',0.39,0.81,0.84,1.56,1.80,3.09],['c',0.81,1.26,1.05,1.68,1.35,2.22],['c',0.87,1.50,1.35,2.79,1.56,4.08],['c',0.06,0.54,0.06,1.56,-0.03,2.04],['c',-0.09,0.48,-0.21,0.99,-0.36,1.35],['l',-0.12,0.27],['l',0.12,0.27],['c',0.09,0.15,0.21,0.45,0.27,0.66],['c',0.69,1.89,0.63,3.66,-0.18,5.46],['l',-0.18,0.39],['l',0.15,0.33],['c',0.30,0.66,0.51,1.44,0.63,2.10],['c',0.06,0.48,0.06,1.35,0.00,1.71],['c',-0.15,0.57,-0.42,1.20,-0.78,1.68],['l',-0.21,0.27],['l',0.18,0.33],['c',0.57,1.05,0.93,2.13,1.02,3.18],['c',0.06,0.72,0.00,1.83,-0.21,2.79],['c',-0.18,1.02,-0.63,2.34,-1.02,3.09],['c',-0.15,0.33,-0.48,0.45,-0.78,0.30],['c',-0.18,-0.09,-0.27,-0.18,-0.33,-0.33],['c',-0.09,-0.18,-0.06,-0.30,0.03,-0.54],['c',0.75,-1.50,1.23,-3.45,1.17,-4.89],['c',-0.06,-1.02,-0.42,-2.01,-1.17,-3.15],['c',-0.48,-0.72,-1.02,-1.35,-1.89,-2.22],['c',-0.57,-0.57,-1.56,-1.50,-1.92,-1.77],['l',-0.12,-0.09],['l',0.00,1.68],['l',0.00,1.68],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-15.00],['z'],['m',0.93,-8.07],['c',-0.27,-0.30,-0.48,-0.54,-0.51,-0.54],['c',0.00,0.00,0.00,0.69,0.03,1.02],['c',0.15,1.47,0.75,2.94,2.04,4.83],['l',1.08,1.53],['c',0.39,0.57,0.84,1.20,0.99,1.44],['c',0.15,0.24,0.30,0.45,0.30,0.45],['c',0.00,0.00,0.03,-0.09,0.06,-0.21],['c',0.36,-1.59,-0.15,-3.33,-1.47,-5.40],['c',-0.63,-0.93,-1.35,-1.83,-2.52,-3.12],['z'],['m',0.06,6.72],['c',-0.24,-0.21,-0.48,-0.42,-0.51,-0.45],['l',-0.06,-0.06],['l',0.00,0.33],['c',0.00,1.20,0.30,2.34,0.93,3.60],['c',0.45,0.90,0.96,1.68,2.25,3.51],['c',0.39,0.54,0.84,1.17,1.02,1.44],['c',0.21,0.33,0.33,0.51,0.33,0.48],['c',0.06,-0.09,0.21,-0.63,0.30,-0.99],['c',0.06,-0.33,0.06,-0.45,0.06,-0.96],['c',0.00,-0.60,-0.03,-0.84,-0.18,-1.35],['c',-0.30,-1.08,-1.02,-2.28,-2.13,-3.57],['c',-0.39,-0.45,-1.44,-1.47,-2.01,-1.98],['z'],['m',0.00,6.72],['c',-0.24,-0.21,-0.48,-0.39,-0.51,-0.42],['l',-0.06,-0.06],['l',0.00,0.33],['c',0.00,1.41,0.45,2.82,1.38,4.35],['c',0.42,0.72,0.72,1.14,1.86,2.73],['c',0.36,0.45,0.75,0.99,0.87,1.20],['c',0.15,0.21,0.30,0.36,0.30,0.36],['c',0.06,0.00,0.30,-0.48,0.39,-0.75],['c',0.09,-0.36,0.12,-0.63,0.12,-1.05],['c',-0.06,-1.05,-0.45,-2.04,-1.20,-3.18],['c',-0.57,-0.87,-1.11,-1.53,-2.07,-2.49],['c',-0.36,-0.33,-0.84,-0.78,-1.08,-1.02],['z']],w:6.682,h:39.694},
		'flags.d8th':{d:[['M',5.67,-21.63],['c',0.24,-0.12,0.54,-0.06,0.69,0.15],['c',0.06,0.06,0.21,0.36,0.39,0.66],['c',0.84,1.77,1.26,3.36,1.32,5.10],['c',0.03,1.29,-0.21,2.37,-0.81,3.63],['c',-0.60,1.23,-1.26,2.13,-3.21,4.38],['c',-1.35,1.53,-1.86,2.19,-2.40,2.97],['c',-0.63,0.93,-1.11,1.92,-1.38,2.79],['c',-0.15,0.54,-0.27,1.35,-0.27,1.80],['l',0.00,0.15],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-3.75],['l',0.00,-3.75],['l',0.21,0.00],['l',0.21,0.00],['l',0.48,-0.30],['c',1.83,-1.11,3.12,-2.10,4.17,-3.12],['c',0.78,-0.81,1.32,-1.53,1.71,-2.31],['c',0.45,-0.93,0.60,-1.74,0.51,-2.88],['c',-0.12,-1.56,-0.63,-3.18,-1.47,-4.68],['c',-0.12,-0.21,-0.15,-0.33,-0.06,-0.51],['c',0.06,-0.15,0.15,-0.24,0.33,-0.33],['z']],w:8.492,h:21.691},
		'flags.ugrace':{d:[['M',6.03,6.93],['c',0.15,-0.09,0.33,-0.06,0.51,0.00],['c',0.15,0.09,0.21,0.15,0.30,0.33],['c',0.09,0.18,0.06,0.39,-0.03,0.54],['c',-0.06,0.15,-10.89,8.88,-11.07,8.97],['c',-0.15,0.09,-0.33,0.06,-0.48,0.00],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['c',-0.09,-0.18,-0.06,-0.39,0.03,-0.54],['c',0.06,-0.15,10.89,-8.88,11.07,-8.97],['z']],w:12.019,h:9.954},
		'flags.dgrace':{d:[['M',-6.06,-15.93],['c',0.18,-0.09,0.33,-0.12,0.48,-0.06],['c',0.18,0.09,14.01,8.04,14.10,8.10],['c',0.12,0.12,0.18,0.33,0.18,0.51],['c',-0.03,0.21,-0.15,0.39,-0.36,0.48],['c',-0.18,0.09,-0.33,0.12,-0.48,0.06],['c',-0.18,-0.09,-14.01,-8.04,-14.10,-8.10],['c',-0.12,-0.12,-0.18,-0.33,-0.18,-0.51],['c',0.03,-0.21,0.15,-0.39,0.36,-0.48],['z']],w:15.12,h:9.212},
		'flags.d16th':{d:[['M',6.84,-22.53],['c',0.27,-0.12,0.57,-0.06,0.72,0.15],['c',0.15,0.15,0.33,0.87,0.45,1.56],['c',0.06,0.33,0.06,1.35,0.00,1.65],['c',-0.06,0.33,-0.15,0.78,-0.27,1.11],['c',-0.12,0.33,-0.45,0.96,-0.66,1.32],['l',-0.18,0.27],['l',0.09,0.18],['c',0.48,1.02,0.72,2.25,0.69,3.30],['c',-0.06,1.23,-0.42,2.28,-1.26,3.45],['c',-0.57,0.87,-0.99,1.32,-3.00,3.39],['c',-1.56,1.56,-2.22,2.40,-2.76,3.45],['c',-0.42,0.84,-0.66,1.80,-0.66,2.55],['l',0.00,0.15],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-7.50],['l',0.00,-7.50],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,1.14],['l',0.00,1.11],['l',0.27,-0.15],['c',1.11,-0.57,1.77,-0.99,2.52,-1.47],['c',2.37,-1.56,3.69,-3.15,4.05,-4.83],['c',0.03,-0.18,0.03,-0.39,0.03,-0.78],['c',0.00,-0.60,-0.03,-0.93,-0.24,-1.50],['c',-0.06,-0.18,-0.12,-0.39,-0.15,-0.45],['c',-0.03,-0.24,0.12,-0.48,0.36,-0.60],['z'],['m',-0.63,7.50],['c',-0.06,-0.18,-0.15,-0.36,-0.15,-0.36],['c',-0.03,0.00,-0.03,0.03,-0.06,0.06],['c',-0.06,0.12,-0.96,1.02,-1.95,1.98],['c',-0.63,0.57,-1.26,1.17,-1.44,1.35],['c',-1.53,1.62,-2.28,2.85,-2.55,4.32],['c',-0.03,0.18,-0.03,0.54,-0.06,0.99],['l',0.00,0.69],['l',0.18,-0.09],['c',0.93,-0.54,2.10,-1.29,2.82,-1.83],['c',0.69,-0.51,1.02,-0.81,1.53,-1.29],['c',1.86,-1.89,2.37,-3.66,1.68,-5.82],['z']],w:8.475,h:22.591},
		'flags.d32nd':{d:[['M',6.84,-29.13],['c',0.27,-0.12,0.57,-0.06,0.72,0.15],['c',0.12,0.12,0.27,0.63,0.36,1.11],['c',0.33,1.59,0.06,3.06,-0.81,4.47],['l',-0.18,0.27],['l',0.09,0.15],['c',0.12,0.24,0.33,0.69,0.45,1.05],['c',0.63,1.83,0.45,3.57,-0.57,5.22],['l',-0.18,0.30],['l',0.15,0.27],['c',0.42,0.87,0.60,1.71,0.57,2.61],['c',-0.06,1.29,-0.48,2.46,-1.35,3.78],['c',-0.54,0.81,-0.93,1.29,-2.46,3.00],['c',-0.51,0.54,-1.05,1.17,-1.26,1.41],['c',-1.56,1.86,-2.25,3.36,-2.37,5.01],['l',0.00,0.33],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-11.25],['l',0.00,-11.25],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,1.35],['l',0.03,1.35],['l',0.78,-0.39],['c',1.38,-0.69,2.34,-1.26,3.24,-1.92],['c',1.38,-1.02,2.28,-2.13,2.64,-3.21],['c',0.15,-0.48,0.18,-0.72,0.18,-1.29],['c',0.00,-0.57,-0.06,-0.90,-0.24,-1.47],['c',-0.06,-0.18,-0.12,-0.39,-0.15,-0.45],['c',-0.03,-0.24,0.12,-0.48,0.36,-0.60],['z'],['m',-0.63,7.20],['c',-0.09,-0.18,-0.12,-0.21,-0.12,-0.15],['c',-0.03,0.09,-1.02,1.08,-2.04,2.04],['c',-1.17,1.08,-1.65,1.56,-2.07,2.04],['c',-0.84,0.96,-1.38,1.86,-1.68,2.76],['c',-0.21,0.57,-0.27,0.99,-0.30,1.65],['l',0.00,0.54],['l',0.66,-0.33],['c',3.57,-1.86,5.49,-3.69,5.94,-5.70],['c',0.06,-0.39,0.06,-1.20,-0.03,-1.65],['c',-0.06,-0.39,-0.24,-0.90,-0.36,-1.20],['z'],['m',-0.06,7.20],['c',-0.06,-0.15,-0.12,-0.33,-0.15,-0.45],['l',-0.06,-0.18],['l',-0.18,0.21],['l',-1.83,1.83],['c',-0.87,0.90,-1.77,1.80,-1.95,2.01],['c',-1.08,1.29,-1.62,2.31,-1.89,3.51],['c',-0.06,0.30,-0.06,0.51,-0.09,0.93],['l',0.00,0.57],['l',0.09,-0.06],['c',0.75,-0.45,1.89,-1.26,2.52,-1.74],['c',0.81,-0.66,1.74,-1.53,2.22,-2.16],['c',1.26,-1.53,1.68,-3.06,1.32,-4.47],['z']],w:8.385,h:29.191},
		'flags.d64th':{d:[['M',7.08,-32.88],['c',0.30,-0.12,0.66,-0.03,0.78,0.24],['c',0.18,0.33,0.27,2.10,0.15,2.64],['c',-0.09,0.39,-0.21,0.78,-0.39,1.08],['l',-0.15,0.30],['l',0.09,0.27],['c',0.03,0.12,0.09,0.45,0.12,0.69],['c',0.27,1.44,0.18,2.55,-0.30,3.60],['l',-0.12,0.33],['l',0.06,0.42],['c',0.27,1.35,0.33,2.82,0.21,3.63],['c',-0.12,0.60,-0.30,1.23,-0.57,1.80],['l',-0.15,0.27],['l',0.03,0.42],['c',0.06,1.02,0.06,2.70,0.03,3.06],['c',-0.15,1.47,-0.66,2.76,-1.74,4.41],['c',-0.45,0.69,-0.75,1.11,-1.74,2.37],['c',-1.05,1.38,-1.50,1.98,-1.95,2.73],['c',-0.93,1.50,-1.38,2.82,-1.44,4.20],['l',0.00,0.42],['l',-0.21,0.00],['l',-0.21,0.00],['l',0.00,-15.00],['l',0.00,-15.00],['l',0.21,0.00],['l',0.21,0.00],['l',0.00,1.86],['l',0.00,1.89],['c',0.00,0.00,0.21,-0.03,0.45,-0.09],['c',2.22,-0.39,4.08,-1.11,5.19,-2.01],['c',0.63,-0.54,1.02,-1.14,1.20,-1.80],['c',0.06,-0.30,0.06,-1.14,-0.03,-1.65],['c',-0.03,-0.18,-0.06,-0.39,-0.09,-0.48],['c',-0.03,-0.24,0.12,-0.48,0.36,-0.60],['z'],['m',-0.45,6.15],['c',-0.03,-0.18,-0.06,-0.42,-0.06,-0.54],['l',-0.03,-0.18],['l',-0.33,0.30],['c',-0.42,0.36,-0.87,0.72,-1.68,1.29],['c',-1.98,1.38,-2.25,1.59,-2.85,2.16],['c',-0.75,0.69,-1.23,1.44,-1.47,2.19],['c',-0.15,0.45,-0.18,0.63,-0.21,1.35],['l',0.00,0.66],['l',0.39,-0.18],['c',1.83,-0.90,3.45,-1.95,4.47,-2.91],['c',0.93,-0.90,1.53,-1.83,1.74,-2.82],['c',0.06,-0.33,0.06,-0.87,0.03,-1.32],['z'],['m',-0.27,4.86],['c',-0.03,-0.21,-0.06,-0.36,-0.06,-0.36],['c',0.00,-0.03,-0.12,0.09,-0.24,0.24],['c',-0.39,0.48,-0.99,1.08,-2.16,2.19],['c',-1.47,1.38,-1.92,1.83,-2.46,2.49],['c',-0.66,0.87,-1.08,1.74,-1.29,2.58],['c',-0.09,0.42,-0.15,0.87,-0.15,1.44],['l',0.00,0.54],['l',0.48,-0.33],['c',1.50,-1.02,2.58,-1.89,3.51,-2.82],['c',1.47,-1.47,2.25,-2.85,2.40,-4.26],['c',0.03,-0.39,0.03,-1.17,-0.03,-1.71],['z'],['m',-0.66,7.68],['c',0.03,-0.15,0.03,-0.60,0.03,-0.99],['l',0.00,-0.72],['l',-0.27,0.33],['l',-1.74,1.98],['c',-1.77,1.92,-2.43,2.76,-2.97,3.90],['c',-0.51,1.02,-0.72,1.77,-0.75,2.91],['c',0.00,0.63,0.00,0.63,0.06,0.60],['c',0.03,-0.03,0.30,-0.27,0.63,-0.54],['c',0.66,-0.60,1.86,-1.80,2.31,-2.31],['c',1.65,-1.89,2.52,-3.54,2.70,-5.16],['z']],w:8.485,h:32.932},
		'clefs.C':{d:[['M',0.06,-14.94],['l',0.09,-0.06],['l',1.92,0.00],['l',1.92,0.00],['l',0.09,0.06],['l',0.06,0.09],['l',0.00,14.85],['l',0.00,14.82],['l',-0.06,0.09],['l',-0.09,0.06],['l',-1.92,0.00],['l',-1.92,0.00],['l',-0.09,-0.06],['l',-0.06,-0.09],['l',0.00,-14.82],['l',0.00,-14.85],['z'],['m',5.37,0.00],['c',0.09,-0.06,0.09,-0.06,0.57,-0.06],['c',0.45,0.00,0.45,0.00,0.54,0.06],['l',0.06,0.09],['l',0.00,7.14],['l',0.00,7.11],['l',0.09,-0.06],['c',0.18,-0.18,0.72,-0.84,0.96,-1.20],['c',0.30,-0.45,0.66,-1.17,0.84,-1.65],['c',0.36,-0.90,0.57,-1.83,0.60,-2.79],['c',0.03,-0.48,0.03,-0.54,0.09,-0.63],['c',0.12,-0.18,0.36,-0.21,0.54,-0.12],['c',0.18,0.09,0.21,0.15,0.24,0.66],['c',0.06,0.87,0.21,1.56,0.57,2.22],['c',0.51,1.02,1.26,1.68,2.22,1.92],['c',0.21,0.06,0.33,0.06,0.78,0.06],['c',0.45,0.00,0.57,0.00,0.84,-0.06],['c',0.45,-0.12,0.81,-0.33,1.08,-0.60],['c',0.57,-0.57,0.87,-1.41,0.99,-2.88],['c',0.06,-0.54,0.06,-3.00,0.00,-3.57],['c',-0.21,-2.58,-0.84,-3.87,-2.16,-4.50],['c',-0.48,-0.21,-1.17,-0.36,-1.77,-0.36],['c',-0.69,0.00,-1.29,0.27,-1.50,0.72],['c',-0.06,0.15,-0.06,0.21,-0.06,0.42],['c',0.00,0.24,0.00,0.30,0.06,0.45],['c',0.12,0.24,0.24,0.39,0.63,0.66],['c',0.42,0.30,0.57,0.48,0.69,0.72],['c',0.06,0.15,0.06,0.21,0.06,0.48],['c',0.00,0.39,-0.03,0.63,-0.21,0.96],['c',-0.30,0.60,-0.87,1.08,-1.50,1.26],['c',-0.27,0.06,-0.87,0.06,-1.14,0.00],['c',-0.78,-0.24,-1.44,-0.87,-1.65,-1.68],['c',-0.12,-0.42,-0.09,-1.17,0.09,-1.71],['c',0.51,-1.65,1.98,-2.82,3.81,-3.09],['c',0.84,-0.09,2.46,0.03,3.51,0.27],['c',2.22,0.57,3.69,1.80,4.44,3.75],['c',0.36,0.93,0.57,2.13,0.57,3.36],['c',0.00,1.44,-0.48,2.73,-1.38,3.81],['c',-1.26,1.50,-3.27,2.43,-5.28,2.43],['c',-0.48,0.00,-0.51,0.00,-0.75,-0.09],['c',-0.15,-0.03,-0.48,-0.21,-0.78,-0.36],['c',-0.69,-0.36,-0.87,-0.42,-1.26,-0.42],['c',-0.27,0.00,-0.30,0.00,-0.51,0.09],['c',-0.57,0.30,-0.81,0.90,-0.81,2.10],['c',0.00,1.23,0.24,1.83,0.81,2.13],['c',0.21,0.09,0.24,0.09,0.51,0.09],['c',0.39,0.00,0.57,-0.06,1.26,-0.42],['c',0.30,-0.15,0.63,-0.33,0.78,-0.36],['c',0.24,-0.09,0.27,-0.09,0.75,-0.09],['c',2.01,0.00,4.02,0.93,5.28,2.40],['c',0.90,1.11,1.38,2.40,1.38,3.84],['c',0.00,1.50,-0.30,2.88,-0.84,3.96],['c',-0.78,1.59,-2.19,2.64,-4.17,3.15],['c',-1.05,0.24,-2.67,0.36,-3.51,0.27],['c',-1.83,-0.27,-3.30,-1.44,-3.81,-3.09],['c',-0.18,-0.54,-0.21,-1.29,-0.09,-1.74],['c',0.15,-0.60,0.63,-1.20,1.23,-1.47],['c',0.36,-0.18,0.57,-0.21,0.99,-0.21],['c',0.42,0.00,0.63,0.03,1.02,0.21],['c',0.42,0.21,0.84,0.63,1.05,1.05],['c',0.18,0.36,0.21,0.60,0.21,0.96],['c',0.00,0.30,0.00,0.36,-0.06,0.51],['c',-0.12,0.24,-0.27,0.42,-0.69,0.72],['c',-0.57,0.42,-0.69,0.63,-0.69,1.08],['c',0.00,0.24,0.00,0.30,0.06,0.45],['c',0.12,0.21,0.30,0.39,0.57,0.54],['c',0.42,0.18,0.87,0.21,1.53,0.15],['c',1.08,-0.15,1.80,-0.57,2.34,-1.32],['c',0.54,-0.75,0.84,-1.83,0.99,-3.51],['c',0.06,-0.57,0.06,-3.03,0.00,-3.57],['c',-0.12,-1.47,-0.42,-2.31,-0.99,-2.88],['c',-0.27,-0.27,-0.63,-0.48,-1.08,-0.60],['c',-0.27,-0.06,-0.39,-0.06,-0.84,-0.06],['c',-0.45,0.00,-0.57,0.00,-0.78,0.06],['c',-1.14,0.27,-2.01,1.17,-2.46,2.49],['c',-0.21,0.57,-0.30,0.99,-0.33,1.65],['c',-0.03,0.51,-0.06,0.57,-0.24,0.66],['c',-0.12,0.06,-0.27,0.06,-0.39,0.00],['c',-0.21,-0.09,-0.21,-0.15,-0.24,-0.75],['c',-0.09,-1.92,-0.78,-3.72,-2.01,-5.19],['c',-0.18,-0.21,-0.36,-0.42,-0.39,-0.45],['l',-0.09,-0.06],['l',0.00,7.11],['l',0.00,7.14],['l',-0.06,0.09],['c',-0.09,0.06,-0.09,0.06,-0.54,0.06],['c',-0.48,0.00,-0.48,0.00,-0.57,-0.06],['l',-0.06,-0.09],['l',0.00,-14.82],['l',0.00,-14.85],['z']],w:20.31,h:29.97},
		'clefs.F':{d:[['M',6.30,-7.80],['c',0.36,-0.03,1.65,0.00,2.13,0.03],['c',3.60,0.42,6.03,2.10,6.93,4.86],['c',0.27,0.84,0.36,1.50,0.36,2.58],['c',0.00,0.90,-0.03,1.35,-0.18,2.16],['c',-0.78,3.78,-3.54,7.08,-8.37,9.96],['c',-1.74,1.05,-3.87,2.13,-6.18,3.12],['c',-0.39,0.18,-0.75,0.33,-0.81,0.36],['c',-0.06,0.03,-0.15,0.06,-0.18,0.06],['c',-0.15,0.00,-0.33,-0.18,-0.33,-0.33],['c',0.00,-0.15,0.06,-0.21,0.51,-0.48],['c',3.00,-1.77,5.13,-3.21,6.84,-4.74],['c',0.51,-0.45,1.59,-1.50,1.95,-1.95],['c',1.89,-2.19,2.88,-4.32,3.15,-6.78],['c',0.06,-0.42,0.06,-1.77,0.00,-2.19],['c',-0.24,-2.01,-0.93,-3.63,-2.04,-4.71],['c',-0.63,-0.63,-1.29,-1.02,-2.07,-1.20],['c',-1.62,-0.39,-3.36,0.15,-4.56,1.44],['c',-0.54,0.60,-1.05,1.47,-1.32,2.22],['l',-0.09,0.21],['l',0.24,-0.12],['c',0.39,-0.21,0.63,-0.24,1.11,-0.24],['c',0.30,0.00,0.45,0.00,0.66,0.06],['c',1.92,0.48,2.85,2.55,1.95,4.38],['c',-0.45,0.99,-1.41,1.62,-2.46,1.71],['c',-1.47,0.09,-2.91,-0.87,-3.39,-2.25],['c',-0.18,-0.57,-0.21,-1.32,-0.03,-2.28],['c',0.39,-2.25,1.83,-4.20,3.81,-5.19],['c',0.69,-0.36,1.59,-0.60,2.37,-0.69],['z'],['m',11.58,2.52],['c',0.84,-0.21,1.71,0.30,1.89,1.14],['c',0.30,1.17,-0.72,2.19,-1.89,1.89],['c',-0.99,-0.21,-1.50,-1.32,-1.02,-2.25],['c',0.18,-0.39,0.60,-0.69,1.02,-0.78],['z'],['m',0.00,7.50],['c',0.84,-0.21,1.71,0.30,1.89,1.14],['c',0.21,0.87,-0.30,1.71,-1.14,1.89],['c',-0.87,0.21,-1.71,-0.30,-1.89,-1.14],['c',-0.21,-0.84,0.30,-1.71,1.14,-1.89],['z']],w:20.153,h:23.142},
		'clefs.G':{d:[['M',9.69,-37.41],['c',0.09,-0.09,0.24,-0.06,0.36,0.00],['c',0.12,0.09,0.57,0.60,0.96,1.11],['c',1.77,2.34,3.21,5.85,3.57,8.73],['c',0.21,1.56,0.03,3.27,-0.45,4.86],['c',-0.69,2.31,-1.92,4.47,-4.23,7.44],['c',-0.30,0.39,-0.57,0.72,-0.60,0.75],['c',-0.03,0.06,0.00,0.15,0.18,0.78],['c',0.54,1.68,1.38,4.44,1.68,5.49],['l',0.09,0.42],['l',0.39,0.00],['c',1.47,0.09,2.76,0.51,3.96,1.29],['c',1.83,1.23,3.06,3.21,3.39,5.52],['c',0.09,0.45,0.12,1.29,0.06,1.74],['c',-0.09,1.02,-0.33,1.83,-0.75,2.73],['c',-0.84,1.71,-2.28,3.06,-4.02,3.72],['l',-0.33,0.12],['l',0.03,1.26],['c',0.00,1.74,-0.06,3.63,-0.21,4.62],['c',-0.45,3.06,-2.19,5.49,-4.47,6.21],['c',-0.57,0.18,-0.90,0.21,-1.59,0.21],['c',-0.69,0.00,-1.02,-0.03,-1.65,-0.21],['c',-1.14,-0.27,-2.13,-0.84,-2.94,-1.65],['c',-0.99,-0.99,-1.56,-2.16,-1.71,-3.54],['c',-0.09,-0.81,0.06,-1.53,0.45,-2.13],['c',0.63,-0.99,1.83,-1.56,3.00,-1.53],['c',1.50,0.09,2.64,1.32,2.73,2.94],['c',0.06,1.47,-0.93,2.70,-2.37,2.97],['c',-0.45,0.06,-0.84,0.03,-1.29,-0.09],['l',-0.21,-0.09],['l',0.09,0.12],['c',0.39,0.54,0.78,0.93,1.32,1.26],['c',1.35,0.87,3.06,1.02,4.35,0.36],['c',1.44,-0.72,2.52,-2.28,2.97,-4.35],['c',0.15,-0.66,0.24,-1.50,0.30,-3.03],['c',0.03,-0.84,0.03,-2.94,0.00,-3.00],['c',-0.03,0.00,-0.18,0.00,-0.36,0.03],['c',-0.66,0.12,-0.99,0.12,-1.83,0.12],['c',-1.05,0.00,-1.71,-0.06,-2.61,-0.30],['c',-4.02,-0.99,-7.11,-4.35,-7.80,-8.46],['c',-0.12,-0.66,-0.12,-0.99,-0.12,-1.83],['c',0.00,-0.84,0.00,-1.14,0.15,-1.92],['c',0.36,-2.28,1.41,-4.62,3.30,-7.29],['l',2.79,-3.60],['c',0.54,-0.66,0.96,-1.20,0.96,-1.23],['c',0.00,-0.03,-0.09,-0.33,-0.18,-0.69],['c',-0.96,-3.21,-1.41,-5.28,-1.59,-7.68],['c',-0.12,-1.38,-0.15,-3.09,-0.06,-3.96],['c',0.33,-2.67,1.38,-5.07,3.12,-7.08],['c',0.36,-0.42,0.99,-1.05,1.17,-1.14],['z'],['m',2.01,4.71],['c',-0.15,-0.30,-0.30,-0.54,-0.30,-0.54],['c',-0.03,0.00,-0.18,0.09,-0.30,0.21],['c',-2.40,1.74,-3.87,4.20,-4.26,7.11],['c',-0.06,0.54,-0.06,1.41,-0.03,1.89],['c',0.09,1.29,0.48,3.12,1.08,5.22],['c',0.15,0.42,0.24,0.78,0.24,0.81],['c',0.00,0.03,0.84,-1.11,1.23,-1.68],['c',1.89,-2.73,2.88,-5.07,3.15,-7.53],['c',0.09,-0.57,0.12,-1.74,0.06,-2.37],['c',-0.09,-1.23,-0.27,-1.92,-0.87,-3.12],['z'],['m',-2.94,20.70],['c',-0.21,-0.72,-0.39,-1.32,-0.42,-1.32],['c',0.00,0.00,-1.20,1.47,-1.86,2.37],['c',-2.79,3.63,-4.02,6.30,-4.35,9.30],['c',-0.03,0.21,-0.03,0.69,-0.03,1.08],['c',0.00,0.69,0.00,0.75,0.06,1.11],['c',0.12,0.54,0.27,0.99,0.51,1.47],['c',0.69,1.38,1.83,2.55,3.42,3.42],['c',0.96,0.54,2.07,0.90,3.21,1.08],['c',0.78,0.12,2.04,0.12,2.94,-0.03],['c',0.51,-0.06,0.45,-0.03,0.42,-0.30],['c',-0.24,-3.33,-0.72,-6.33,-1.62,-10.08],['c',-0.09,-0.39,-0.18,-0.75,-0.18,-0.78],['c',-0.03,-0.03,-0.42,0.00,-0.81,0.09],['c',-0.90,0.18,-1.65,0.57,-2.22,1.14],['c',-0.72,0.72,-1.08,1.65,-1.05,2.64],['c',0.06,0.96,0.48,1.83,1.23,2.58],['c',0.36,0.36,0.72,0.63,1.17,0.90],['c',0.33,0.18,0.36,0.21,0.42,0.33],['c',0.18,0.42,-0.18,0.90,-0.60,0.87],['c',-0.18,-0.03,-0.84,-0.36,-1.26,-0.63],['c',-0.78,-0.51,-1.38,-1.11,-1.86,-1.83],['c',-1.77,-2.70,-0.99,-6.42,1.71,-8.19],['c',0.30,-0.21,0.81,-0.48,1.17,-0.63],['c',0.30,-0.09,1.02,-0.30,1.14,-0.30],['c',0.06,0.00,0.09,0.00,0.09,-0.03],['c',0.03,-0.03,-0.51,-1.92,-1.23,-4.26],['z'],['m',3.78,7.41],['c',-0.18,-0.03,-0.36,-0.06,-0.39,-0.06],['c',-0.03,0.00,0.00,0.21,0.18,1.02],['c',0.75,3.18,1.26,6.30,1.50,9.09],['c',0.06,0.72,0.00,0.69,0.51,0.42],['c',0.78,-0.36,1.44,-0.96,1.98,-1.77],['c',1.08,-1.62,1.20,-3.69,0.30,-5.55],['c',-0.81,-1.62,-2.31,-2.79,-4.08,-3.15],['z']],w:19.051,h:57.057},
		'clefs.perc':{d:[['M',5.07,-7.44],['l',0.09,-0.06],['l',1.53,0.00],['l',1.53,0.00],['l',0.09,0.06],['l',0.06,0.09],['l',0.00,7.35],['l',0.00,7.32],['l',-0.06,0.09],['l',-0.09,0.06],['l',-1.53,0.00],['l',-1.53,0.00],['l',-0.09,-0.06],['l',-0.06,-0.09],['l',0.00,-7.32],['l',0.00,-7.35],['z'],['m',6.63,0.00],['l',0.09,-0.06],['l',1.53,0.00],['l',1.53,0.00],['l',0.09,0.06],['l',0.06,0.09],['l',0.00,7.35],['l',0.00,7.32],['l',-0.06,0.09],['l',-0.09,0.06],['l',-1.53,0.00],['l',-1.53,0.00],['l',-0.09,-0.06],['l',-0.06,-0.09],['l',0.00,-7.32],['l',0.00,-7.35],['z']],w:9.99,h:14.97},
		'timesig.common':{d:[['M',6.66,-7.83],['c',0.72,-0.06,1.41,-0.03,1.98,0.09],['c',1.20,0.27,2.34,0.96,3.09,1.92],['c',0.63,0.81,1.08,1.86,1.14,2.73],['c',0.06,1.02,-0.51,1.92,-1.44,2.22],['c',-0.24,0.09,-0.30,0.09,-0.63,0.09],['c',-0.33,0.00,-0.42,0.00,-0.63,-0.06],['c',-0.66,-0.24,-1.14,-0.63,-1.41,-1.20],['c',-0.15,-0.30,-0.21,-0.51,-0.24,-0.90],['c',-0.06,-1.08,0.57,-2.04,1.56,-2.37],['c',0.18,-0.06,0.27,-0.06,0.63,-0.06],['l',0.45,0.00],['c',0.06,0.03,0.09,0.03,0.09,0.00],['c',0.00,0.00,-0.09,-0.12,-0.24,-0.27],['c',-1.02,-1.11,-2.55,-1.68,-4.08,-1.50],['c',-1.29,0.15,-2.04,0.69,-2.40,1.74],['c',-0.36,0.93,-0.42,1.89,-0.42,5.37],['c',0.00,2.97,0.06,3.96,0.24,4.77],['c',0.24,1.08,0.63,1.68,1.41,2.07],['c',0.81,0.39,2.16,0.45,3.18,0.09],['c',1.29,-0.45,2.37,-1.53,3.03,-2.97],['c',0.15,-0.33,0.33,-0.87,0.39,-1.17],['c',0.09,-0.24,0.15,-0.36,0.30,-0.39],['c',0.21,-0.03,0.42,0.15,0.39,0.36],['c',-0.06,0.39,-0.42,1.38,-0.69,1.89],['c',-0.96,1.80,-2.49,2.94,-4.23,3.18],['c',-0.99,0.12,-2.58,-0.06,-3.63,-0.45],['c',-0.96,-0.36,-1.71,-0.84,-2.40,-1.50],['c',-1.11,-1.11,-1.80,-2.61,-2.04,-4.56],['c',-0.06,-0.60,-0.06,-2.01,0.00,-2.61],['c',0.24,-1.95,0.90,-3.45,2.01,-4.56],['c',0.69,-0.66,1.44,-1.11,2.37,-1.47],['c',0.63,-0.24,1.47,-0.42,2.22,-0.48],['z']],w:13.038,h:15.689},
		'timesig.cut':{d:[['M',6.24,-10.44],['c',0.09,-0.06,0.09,-0.06,0.48,-0.06],['c',0.36,0.00,0.36,0.00,0.45,0.06],['l',0.06,0.09],['l',0.00,1.23],['l',0.00,1.26],['l',0.27,0.00],['c',1.26,0.00,2.49,0.45,3.48,1.29],['c',1.05,0.87,1.80,2.28,1.89,3.48],['c',0.06,1.02,-0.51,1.92,-1.44,2.22],['c',-0.24,0.09,-0.30,0.09,-0.63,0.09],['c',-0.33,0.00,-0.42,0.00,-0.63,-0.06],['c',-0.66,-0.24,-1.14,-0.63,-1.41,-1.20],['c',-0.15,-0.30,-0.21,-0.51,-0.24,-0.90],['c',-0.06,-1.08,0.57,-2.04,1.56,-2.37],['c',0.18,-0.06,0.27,-0.06,0.63,-0.06],['l',0.45,0.00],['c',0.06,0.03,0.09,0.03,0.09,0.00],['c',0.00,-0.03,-0.45,-0.51,-0.66,-0.69],['c',-0.87,-0.69,-1.83,-1.05,-2.94,-1.11],['l',-0.42,0.00],['l',0.00,7.17],['l',0.00,7.14],['l',0.42,0.00],['c',0.69,-0.03,1.23,-0.18,1.86,-0.51],['c',1.05,-0.51,1.89,-1.47,2.46,-2.70],['c',0.15,-0.33,0.33,-0.87,0.39,-1.17],['c',0.09,-0.24,0.15,-0.36,0.30,-0.39],['c',0.21,-0.03,0.42,0.15,0.39,0.36],['c',-0.03,0.24,-0.21,0.78,-0.39,1.20],['c',-0.96,2.37,-2.94,3.90,-5.13,3.90],['l',-0.30,0.00],['l',0.00,1.26],['l',0.00,1.23],['l',-0.06,0.09],['c',-0.09,0.06,-0.09,0.06,-0.45,0.06],['c',-0.39,0.00,-0.39,0.00,-0.48,-0.06],['l',-0.06,-0.09],['l',0.00,-1.29],['l',0.00,-1.29],['l',-0.21,-0.03],['c',-1.23,-0.21,-2.31,-0.63,-3.21,-1.29],['c',-0.15,-0.09,-0.45,-0.36,-0.66,-0.57],['c',-1.11,-1.11,-1.80,-2.61,-2.04,-4.56],['c',-0.06,-0.60,-0.06,-2.01,0.00,-2.61],['c',0.24,-1.95,0.93,-3.45,2.04,-4.59],['c',0.42,-0.39,0.78,-0.66,1.26,-0.93],['c',0.75,-0.45,1.65,-0.75,2.61,-0.90],['l',0.21,-0.03],['l',0.00,-1.29],['l',0.00,-1.29],['z'],['m',-0.06,10.44],['c',0.00,-5.58,0.00,-6.99,-0.03,-6.99],['c',-0.15,0.00,-0.63,0.27,-0.87,0.45],['c',-0.45,0.36,-0.75,0.93,-0.93,1.77],['c',-0.18,0.81,-0.24,1.80,-0.24,4.74],['c',0.00,2.97,0.06,3.96,0.24,4.77],['c',0.24,1.08,0.66,1.68,1.41,2.07],['c',0.12,0.06,0.30,0.12,0.33,0.15],['l',0.09,0.00],['l',0.00,-6.96],['z']],w:13.038,h:20.97},
		'timesig.imperfectum':{d:[['M',13,-5],['a',8,8,0,1,0,0,10]],w:13.038,h:20.97},
		'timesig.imperfectum2':{d:[['M',13,-5],['a',8,8,0,1,0,0,10]],w:13.038,h:20.97},
		'timesig.perfectum':{d:[['M',13,-5],['a',8,8,0,1,0,0,10]],w:13.038,h:20.97},
		'timesig.perfectum2':{d:[['M',13,-5],['a',8,8,0,1,0,0,10]],w:13.038,h:20.97},
		'f':{d:[['M',9.93,-14.28],['c',1.53,-0.18,2.88,0.45,3.12,1.50],['c',0.12,0.51,0.00,1.32,-0.27,1.86],['c',-0.15,0.30,-0.42,0.57,-0.63,0.69],['c',-0.69,0.36,-1.56,0.03,-1.83,-0.69],['c',-0.09,-0.24,-0.09,-0.69,0.00,-0.87],['c',0.06,-0.12,0.21,-0.24,0.45,-0.42],['c',0.42,-0.24,0.57,-0.45,0.60,-0.72],['c',0.03,-0.33,-0.09,-0.39,-0.63,-0.42],['c',-0.30,0.00,-0.45,0.00,-0.60,0.03],['c',-0.81,0.21,-1.35,0.93,-1.74,2.46],['c',-0.06,0.27,-0.48,2.25,-0.48,2.31],['c',0.00,0.03,0.39,0.03,0.90,0.03],['c',0.72,0.00,0.90,0.00,0.99,0.06],['c',0.42,0.15,0.45,0.72,0.03,0.90],['c',-0.12,0.06,-0.24,0.06,-1.17,0.06],['l',-1.05,0.00],['l',-0.78,2.55],['c',-0.45,1.41,-0.87,2.79,-0.96,3.06],['c',-0.87,2.37,-2.37,4.74,-3.78,5.91],['c',-1.05,0.90,-2.04,1.23,-3.09,1.08],['c',-1.11,-0.18,-1.89,-0.78,-2.04,-1.59],['c',-0.12,-0.66,0.15,-1.71,0.54,-2.19],['c',0.69,-0.75,1.86,-0.54,2.22,0.39],['c',0.06,0.15,0.09,0.27,0.09,0.48],['c',0.00,0.24,-0.03,0.27,-0.12,0.42],['c',-0.03,0.09,-0.15,0.18,-0.27,0.27],['c',-0.09,0.06,-0.27,0.21,-0.36,0.27],['c',-0.24,0.18,-0.36,0.36,-0.39,0.60],['c',-0.03,0.33,0.09,0.39,0.63,0.42],['c',0.42,0.00,0.63,-0.03,0.90,-0.15],['c',0.60,-0.30,0.96,-0.96,1.38,-2.64],['c',0.09,-0.42,0.63,-2.55,1.17,-4.77],['l',1.02,-4.08],['c',0.00,-0.03,-0.36,-0.03,-0.81,-0.03],['c',-0.72,0.00,-0.81,0.00,-0.93,-0.06],['c',-0.42,-0.18,-0.39,-0.75,0.03,-0.90],['c',0.09,-0.06,0.27,-0.06,1.05,-0.06],['l',0.96,0.00],['l',0.00,-0.09],['c',0.06,-0.18,0.30,-0.72,0.51,-1.17],['c',1.20,-2.46,3.30,-4.23,5.34,-4.50],['z']],w:16.155,h:19.445},
		'm':{d:[['M',2.79,-8.91],['c',0.09,0.00,0.30,-0.03,0.45,-0.03],['c',0.24,0.03,0.30,0.03,0.45,0.12],['c',0.36,0.15,0.63,0.54,0.75,1.02],['l',0.03,0.21],['l',0.33,-0.30],['c',0.69,-0.69,1.38,-1.02,2.07,-1.02],['c',0.27,0.00,0.33,0.00,0.48,0.06],['c',0.21,0.09,0.48,0.36,0.63,0.60],['c',0.03,0.09,0.12,0.27,0.18,0.42],['c',0.03,0.15,0.09,0.27,0.12,0.27],['c',0.00,0.00,0.09,-0.09,0.18,-0.21],['c',0.33,-0.39,0.87,-0.81,1.29,-0.99],['c',0.78,-0.33,1.47,-0.21,2.01,0.33],['c',0.30,0.33,0.48,0.69,0.60,1.14],['c',0.09,0.42,0.06,0.54,-0.54,3.06],['c',-0.33,1.29,-0.57,2.40,-0.57,2.43],['c',0.00,0.12,0.09,0.21,0.21,0.21],['c',0.24,0.00,0.75,-0.30,1.20,-0.72],['c',0.45,-0.39,0.60,-0.45,0.78,-0.27],['c',0.18,0.18,0.09,0.36,-0.45,0.87],['c',-1.05,0.96,-1.83,1.47,-2.58,1.71],['c',-0.93,0.33,-1.53,0.21,-1.80,-0.33],['c',-0.06,-0.15,-0.06,-0.21,-0.06,-0.45],['c',0.00,-0.24,0.03,-0.48,0.60,-2.82],['c',0.42,-1.71,0.60,-2.64,0.63,-2.79],['c',0.03,-0.57,-0.30,-0.75,-0.84,-0.48],['c',-0.24,0.12,-0.54,0.39,-0.66,0.63],['c',-0.03,0.09,-0.42,1.38,-0.90,3.00],['c',-0.90,3.15,-0.84,3.00,-1.14,3.15],['l',-0.15,0.09],['l',-0.78,0.00],['c',-0.60,0.00,-0.78,0.00,-0.84,-0.06],['c',-0.09,-0.03,-0.18,-0.18,-0.18,-0.27],['c',0.00,-0.03,0.36,-1.38,0.84,-2.97],['c',0.57,-2.04,0.81,-2.97,0.84,-3.12],['c',0.03,-0.54,-0.30,-0.72,-0.84,-0.45],['c',-0.24,0.12,-0.57,0.42,-0.66,0.63],['c',-0.06,0.09,-0.51,1.44,-1.05,2.97],['c',-0.51,1.56,-0.99,2.85,-0.99,2.91],['c',-0.06,0.12,-0.21,0.24,-0.36,0.30],['c',-0.12,0.06,-0.21,0.06,-0.90,0.06],['c',-0.60,0.00,-0.78,0.00,-0.84,-0.06],['c',-0.09,-0.03,-0.18,-0.18,-0.18,-0.27],['c',0.00,-0.03,0.45,-1.38,0.99,-2.97],['c',1.05,-3.18,1.05,-3.18,0.93,-3.45],['c',-0.12,-0.27,-0.39,-0.30,-0.72,-0.15],['c',-0.54,0.27,-1.14,1.17,-1.56,2.40],['c',-0.06,0.15,-0.15,0.30,-0.18,0.36],['c',-0.21,0.21,-0.57,0.27,-0.72,0.09],['c',-0.09,-0.09,-0.06,-0.21,0.06,-0.63],['c',0.48,-1.26,1.26,-2.46,2.01,-3.21],['c',0.57,-0.54,1.20,-0.87,1.83,-1.02],['z']],w:14.687,h:9.126},
		'p':{d:[['M',1.92,-8.70],['c',0.27,-0.09,0.81,-0.06,1.11,0.03],['c',0.54,0.18,0.93,0.51,1.17,0.99],['c',0.09,0.15,0.15,0.33,0.18,0.36],['l',0.00,0.12],['l',0.30,-0.27],['c',0.66,-0.60,1.35,-1.02,2.13,-1.20],['c',0.21,-0.06,0.33,-0.06,0.78,-0.06],['c',0.45,0.00,0.51,0.00,0.84,0.09],['c',1.29,0.33,2.07,1.32,2.25,2.79],['c',0.09,0.81,-0.09,2.01,-0.45,2.79],['c',-0.54,1.26,-1.86,2.55,-3.18,3.03],['c',-0.45,0.18,-0.81,0.24,-1.29,0.24],['c',-0.69,-0.03,-1.35,-0.18,-1.86,-0.45],['c',-0.30,-0.15,-0.51,-0.18,-0.69,-0.09],['c',-0.09,0.03,-0.18,0.09,-0.18,0.12],['c',-0.09,0.12,-1.05,2.94,-1.05,3.06],['c',0.00,0.24,0.18,0.48,0.51,0.63],['c',0.18,0.06,0.54,0.15,0.75,0.15],['c',0.21,0.00,0.36,0.06,0.42,0.18],['c',0.12,0.18,0.06,0.42,-0.12,0.54],['c',-0.09,0.03,-0.15,0.03,-0.78,0.00],['c',-1.98,-0.15,-3.81,-0.15,-5.79,0.00],['c',-0.63,0.03,-0.69,0.03,-0.78,0.00],['c',-0.24,-0.15,-0.24,-0.57,0.03,-0.66],['c',0.06,-0.03,0.48,-0.09,0.99,-0.12],['c',0.87,-0.06,1.11,-0.09,1.35,-0.21],['c',0.18,-0.06,0.33,-0.18,0.39,-0.30],['c',0.06,-0.12,3.24,-9.42,3.27,-9.60],['c',0.06,-0.33,0.03,-0.57,-0.15,-0.69],['c',-0.09,-0.06,-0.12,-0.06,-0.30,-0.06],['c',-0.69,0.06,-1.53,1.02,-2.28,2.61],['c',-0.09,0.21,-0.21,0.45,-0.27,0.51],['c',-0.09,0.12,-0.33,0.24,-0.48,0.24],['c',-0.18,0.00,-0.36,-0.15,-0.36,-0.30],['c',0.00,-0.24,0.78,-1.83,1.26,-2.55],['c',0.72,-1.11,1.47,-1.74,2.28,-1.92],['z'],['m',5.37,1.47],['c',-0.27,-0.12,-0.75,-0.03,-1.14,0.21],['c',-0.75,0.48,-1.47,1.68,-1.89,3.15],['c',-0.45,1.47,-0.42,2.34,0.00,2.70],['c',0.45,0.39,1.26,0.21,1.83,-0.36],['c',0.51,-0.51,0.99,-1.68,1.38,-3.27],['c',0.30,-1.17,0.33,-1.74,0.15,-2.13],['c',-0.09,-0.15,-0.15,-0.21,-0.33,-0.30],['z']],w:14.689,h:13.127},
		'r':{d:[['M',6.33,-9.12],['c',0.27,-0.03,0.93,0.00,1.20,0.06],['c',0.84,0.21,1.23,0.81,1.02,1.53],['c',-0.24,0.75,-0.90,1.17,-1.56,0.96],['c',-0.33,-0.09,-0.51,-0.30,-0.66,-0.75],['c',-0.03,-0.12,-0.09,-0.24,-0.12,-0.30],['c',-0.09,-0.15,-0.30,-0.24,-0.48,-0.24],['c',-0.57,0.00,-1.38,0.54,-1.65,1.08],['c',-0.06,0.15,-0.33,1.17,-0.90,3.27],['c',-0.57,2.31,-0.81,3.12,-0.87,3.21],['c',-0.03,0.06,-0.12,0.15,-0.18,0.21],['l',-0.12,0.06],['l',-0.81,0.03],['c',-0.69,0.00,-0.81,0.00,-0.90,-0.03],['c',-0.09,-0.06,-0.18,-0.21,-0.18,-0.30],['c',0.00,-0.06,0.39,-1.62,0.90,-3.51],['c',0.84,-3.24,0.87,-3.45,0.87,-3.72],['c',0.00,-0.21,0.00,-0.27,-0.03,-0.36],['c',-0.12,-0.15,-0.21,-0.24,-0.42,-0.24],['c',-0.24,0.00,-0.45,0.15,-0.78,0.42],['c',-0.33,0.36,-0.45,0.54,-0.72,1.14],['c',-0.03,0.12,-0.21,0.24,-0.36,0.27],['c',-0.12,0.00,-0.15,0.00,-0.24,-0.06],['c',-0.18,-0.12,-0.18,-0.21,-0.06,-0.54],['c',0.21,-0.57,0.42,-0.93,0.78,-1.32],['c',0.54,-0.51,1.20,-0.81,1.95,-0.87],['c',0.81,-0.03,1.53,0.30,1.92,0.87],['l',0.12,0.18],['l',0.09,-0.09],['c',0.57,-0.45,1.41,-0.84,2.19,-0.96],['z']],w:9.41,h:9.132},
		's':{d:[['M',4.47,-8.73],['c',0.09,0.00,0.36,-0.03,0.57,-0.03],['c',0.75,0.03,1.29,0.24,1.71,0.63],['c',0.51,0.54,0.66,1.26,0.36,1.83],['c',-0.24,0.42,-0.63,0.57,-1.11,0.42],['c',-0.33,-0.09,-0.60,-0.36,-0.60,-0.57],['c',0.00,-0.03,0.06,-0.21,0.15,-0.39],['c',0.12,-0.21,0.15,-0.33,0.18,-0.48],['c',0.00,-0.24,-0.06,-0.48,-0.15,-0.60],['c',-0.15,-0.21,-0.42,-0.24,-0.75,-0.15],['c',-0.27,0.06,-0.48,0.18,-0.69,0.36],['c',-0.39,0.39,-0.51,0.96,-0.33,1.38],['c',0.09,0.21,0.42,0.51,0.78,0.72],['c',1.11,0.69,1.59,1.11,1.89,1.68],['c',0.21,0.39,0.24,0.78,0.15,1.29],['c',-0.18,1.20,-1.17,2.16,-2.52,2.52],['c',-1.02,0.24,-1.95,0.12,-2.70,-0.42],['c',-0.72,-0.51,-0.99,-1.47,-0.60,-2.19],['c',0.24,-0.48,0.72,-0.63,1.17,-0.42],['c',0.33,0.18,0.54,0.45,0.57,0.81],['c',0.00,0.21,-0.03,0.30,-0.33,0.51],['c',-0.33,0.24,-0.39,0.42,-0.27,0.69],['c',0.06,0.15,0.21,0.27,0.45,0.33],['c',0.30,0.09,0.87,0.09,1.20,0.00],['c',0.75,-0.21,1.23,-0.72,1.29,-1.35],['c',0.03,-0.42,-0.15,-0.81,-0.54,-1.20],['c',-0.24,-0.24,-0.48,-0.42,-1.41,-1.02],['c',-0.69,-0.42,-1.05,-0.93,-1.05,-1.47],['c',0.00,-0.39,0.12,-0.87,0.30,-1.23],['c',0.27,-0.57,0.78,-1.05,1.38,-1.35],['c',0.24,-0.12,0.63,-0.27,0.90,-0.30],['z']],w:6.632,h:8.758},
		'z':{d:[['M',2.64,-7.95],['c',0.36,-0.09,0.81,-0.03,1.71,0.27],['c',0.78,0.21,0.96,0.27,1.74,0.30],['c',0.87,0.06,1.02,0.03,1.38,-0.21],['c',0.21,-0.15,0.33,-0.15,0.48,-0.06],['c',0.15,0.09,0.21,0.30,0.15,0.45],['c',-0.03,0.06,-1.26,1.26,-2.76,2.67],['l',-2.73,2.55],['l',0.54,0.03],['c',0.54,0.03,0.72,0.03,2.01,0.15],['c',0.36,0.03,0.90,0.06,1.20,0.09],['c',0.66,0.00,0.81,-0.03,1.02,-0.24],['c',0.30,-0.30,0.39,-0.72,0.27,-1.23],['c',-0.06,-0.27,-0.06,-0.27,-0.03,-0.39],['c',0.15,-0.30,0.54,-0.27,0.69,0.03],['c',0.15,0.33,0.27,1.02,0.27,1.50],['c',0.00,1.47,-1.11,2.70,-2.52,2.79],['c',-0.57,0.03,-1.02,-0.09,-2.01,-0.51],['c',-1.02,-0.42,-1.23,-0.48,-2.13,-0.54],['c',-0.81,-0.06,-0.96,-0.03,-1.26,0.18],['c',-0.12,0.06,-0.24,0.12,-0.27,0.12],['c',-0.27,0.00,-0.45,-0.30,-0.36,-0.51],['c',0.03,-0.06,1.32,-1.32,2.91,-2.79],['l',2.88,-2.73],['c',-0.03,0.00,-0.21,0.03,-0.42,0.06],['c',-0.21,0.03,-0.78,0.09,-1.23,0.12],['c',-1.11,0.12,-1.23,0.15,-1.95,0.27],['c',-0.72,0.15,-1.17,0.18,-1.29,0.09],['c',-0.27,-0.18,-0.21,-0.75,0.12,-1.26],['c',0.39,-0.60,0.93,-1.02,1.59,-1.20],['z']],w:8.573,h:8.743},
		'+':{d:[['M',3.48,-9.3],['c',0.18,-0.09,0.36,-0.09,0.54,0.00],['c',0.18,0.09,0.24,0.15,0.33,0.30],['l',0.06,0.15],['l',0.00,1.29],['l',0.00,1.29],['l',1.29,0.00],['c',1.23,0.00,1.29,0.00,1.41,0.06],['c',0.06,0.03,0.15,0.09,0.18,0.12],['c',0.12,0.09,0.21,0.33,0.21,0.48],['c',0.00,0.15,-0.09,0.39,-0.21,0.48],['c',-0.03,0.03,-0.12,0.09,-0.18,0.12],['c',-0.12,0.06,-0.18,0.06,-1.41,0.06],['l',-1.29,0.00],['l',0.00,1.29],['c',0.00,1.23,0.00,1.29,-0.06,1.41],['c',-0.09,0.18,-0.15,0.24,-0.30,0.33],['c',-0.21,0.09,-0.39,0.09,-0.57,0.00],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['c',-0.06,-0.12,-0.06,-0.18,-0.06,-1.41],['l',0.00,-1.29],['l',-1.29,0.00],['c',-1.23,0.00,-1.29,0.00,-1.41,-0.06],['c',-0.18,-0.09,-0.24,-0.15,-0.33,-0.33],['c',-0.09,-0.18,-0.09,-0.36,0.00,-0.54],['c',0.09,-0.18,0.15,-0.24,0.33,-0.33],['l',0.15,-0.06],['l',1.26,0.00],['l',1.29,0.00],['l',0.00,-1.29],['c',0.00,-1.23,0.00,-1.29,0.06,-1.41],['c',0.09,-0.18,0.15,-0.24,0.33,-0.33],['z']],w:7.507,h:7.515},
		',':{d:[['M',1.32,-3.36],['c',0.57,-0.15,1.17,0.03,1.59,0.45],['c',0.45,0.45,0.60,0.96,0.51,1.89],['c',-0.09,1.23,-0.42,2.46,-0.99,3.93],['c',-0.30,0.72,-0.72,1.62,-0.78,1.68],['c',-0.18,0.21,-0.51,0.18,-0.66,-0.06],['c',-0.03,-0.06,-0.06,-0.15,-0.06,-0.18],['c',0.00,-0.06,0.12,-0.33,0.24,-0.63],['c',0.84,-1.80,1.02,-2.61,0.69,-3.24],['c',-0.12,-0.24,-0.27,-0.36,-0.75,-0.60],['c',-0.36,-0.15,-0.42,-0.21,-0.60,-0.39],['c',-0.69,-0.69,-0.69,-1.71,0.00,-2.40],['c',0.21,-0.21,0.51,-0.39,0.81,-0.45],['z']],w:3.452,h:8.143},
		'-':{d:[['M',0.18,-5.34],['c',0.09,-0.06,0.15,-0.06,2.31,-0.06],['c',2.46,0.00,2.37,0.00,2.46,0.21],['c',0.12,0.21,0.03,0.42,-0.15,0.54],['c',-0.09,0.06,-0.15,0.06,-2.28,0.06],['c',-2.16,0.00,-2.22,0.00,-2.31,-0.06],['c',-0.27,-0.15,-0.27,-0.54,-0.03,-0.69],['z']],w:5.001,h:0.81},
		'.':{d:[['M',1.32,-3.36],['c',1.05,-0.27,2.10,0.57,2.10,1.65],['c',0.00,1.08,-1.05,1.92,-2.10,1.65],['c',-0.90,-0.21,-1.50,-1.14,-1.26,-2.04],['c',0.12,-0.63,0.63,-1.11,1.26,-1.26],['z']],w:3.413,h:3.402},
		'scripts.wedge':{d:[['M',-3.66,-7.44],['c',0.06,-0.09,0.00,-0.09,0.81,0.03],['c',1.86,0.30,3.84,0.30,5.73,0.00],['c',0.78,-0.12,0.72,-0.12,0.78,-0.03],['c',0.15,0.15,0.12,0.24,-0.24,0.60],['c',-0.93,0.93,-1.98,2.76,-2.67,4.62],['c',-0.30,0.78,-0.51,1.71,-0.51,2.13],['c',0.00,0.15,0.00,0.18,-0.06,0.27],['c',-0.12,0.09,-0.24,0.09,-0.36,0.00],['c',-0.06,-0.09,-0.06,-0.12,-0.06,-0.27],['c',0.00,-0.42,-0.21,-1.35,-0.51,-2.13],['c',-0.69,-1.86,-1.74,-3.69,-2.67,-4.62],['c',-0.36,-0.36,-0.39,-0.45,-0.24,-0.60],['z']],w:7.49,h:7.752},
		'scripts.thumb':{d:[['M',-0.54,-3.69],['c',0.15,-0.03,0.36,-0.06,0.51,-0.06],['c',1.44,0.00,2.58,1.11,2.94,2.85],['c',0.09,0.48,0.09,1.32,0.00,1.80],['c',-0.27,1.41,-1.08,2.43,-2.16,2.73],['l',-0.18,0.06],['l',0.00,0.12],['c',0.03,0.06,0.06,0.45,0.09,0.87],['c',0.03,0.57,0.03,0.78,0.00,0.84],['c',-0.09,0.27,-0.39,0.48,-0.66,0.48],['c',-0.27,0.00,-0.57,-0.21,-0.66,-0.48],['c',-0.03,-0.06,-0.03,-0.27,0.00,-0.84],['c',0.03,-0.42,0.06,-0.81,0.09,-0.87],['l',0.00,-0.12],['l',-0.18,-0.06],['c',-1.08,-0.30,-1.89,-1.32,-2.16,-2.73],['c',-0.09,-0.48,-0.09,-1.32,0.00,-1.80],['c',0.15,-0.84,0.51,-1.53,1.02,-2.04],['c',0.39,-0.39,0.84,-0.63,1.35,-0.75],['z'],['m',1.05,0.90],['c',-0.15,-0.09,-0.21,-0.09,-0.45,-0.12],['c',-0.15,0.00,-0.30,0.03,-0.39,0.03],['c',-0.57,0.18,-0.90,0.72,-1.08,1.74],['c',-0.06,0.48,-0.06,1.80,0.00,2.28],['c',0.15,0.90,0.42,1.44,0.90,1.65],['c',0.18,0.09,0.21,0.09,0.51,0.09],['c',0.30,0.00,0.33,0.00,0.51,-0.09],['c',0.48,-0.21,0.75,-0.75,0.90,-1.65],['c',0.03,-0.27,0.03,-0.54,0.03,-1.14],['c',0.00,-0.60,0.00,-0.87,-0.03,-1.14],['c',-0.15,-0.90,-0.45,-1.44,-0.90,-1.65],['z']],w:5.955,h:9.75},
		'scripts.open':{d:[['M',-0.54,-3.69],['c',0.15,-0.03,0.36,-0.06,0.51,-0.06],['c',1.44,0.00,2.58,1.11,2.94,2.85],['c',0.09,0.48,0.09,1.32,0.00,1.80],['c',-0.33,1.74,-1.47,2.85,-2.91,2.85],['c',-1.44,0.00,-2.58,-1.11,-2.91,-2.85],['c',-0.09,-0.48,-0.09,-1.32,0.00,-1.80],['c',0.15,-0.84,0.51,-1.53,1.02,-2.04],['c',0.39,-0.39,0.84,-0.63,1.35,-0.75],['z'],['m',1.11,0.90],['c',-0.21,-0.09,-0.27,-0.09,-0.51,-0.12],['c',-0.30,0.00,-0.42,0.03,-0.66,0.15],['c',-0.24,0.12,-0.51,0.39,-0.66,0.63],['c',-0.54,0.93,-0.63,2.64,-0.21,3.81],['c',0.21,0.54,0.51,0.90,0.93,1.11],['c',0.21,0.09,0.24,0.09,0.54,0.09],['c',0.30,0.00,0.33,0.00,0.54,-0.09],['c',0.42,-0.21,0.72,-0.57,0.93,-1.11],['c',0.36,-0.99,0.36,-2.37,0.00,-3.36],['c',-0.21,-0.54,-0.51,-0.90,-0.90,-1.11],['z']],w:5.955,h:7.5},
		'scripts.longphrase':{d:[['M',1.47,-15.09],['c',0.36,-0.09,0.66,-0.18,0.69,-0.18],['c',0.06,0.00,0.06,0.54,0.06,11.25],['l',0.00,11.25],['l',-0.63,0.15],['c',-0.66,0.18,-1.44,0.39,-1.50,0.39],['c',-0.03,0.00,-0.03,-3.39,-0.03,-11.25],['l',0.00,-11.25],['l',0.36,-0.09],['c',0.21,-0.06,0.66,-0.18,1.05,-0.27],['z']],w:2.16,h:23.04},
		'scripts.mediumphrase':{d:[['M',1.47,-7.59],['c',0.36,-0.09,0.66,-0.18,0.69,-0.18],['c',0.06,0.00,0.06,0.39,0.06,7.50],['l',0.00,7.50],['l',-0.63,0.15],['c',-0.66,0.18,-1.44,0.39,-1.50,0.39],['c',-0.03,0.00,-0.03,-2.28,-0.03,-7.50],['l',0.00,-7.50],['l',0.36,-0.09],['c',0.21,-0.06,0.66,-0.18,1.05,-0.27],['z']],w:2.16,h:15.54},
		'scripts.shortphrase':{d:[['M',1.47,-7.59],['c',0.36,-0.09,0.66,-0.18,0.69,-0.18],['c',0.06,0.00,0.06,0.21,0.06,3.75],['l',0.00,3.75],['l',-0.42,0.09],['c',-0.57,0.18,-1.65,0.45,-1.71,0.45],['c',-0.03,0.00,-0.03,-0.72,-0.03,-3.75],['l',0.00,-3.75],['l',0.36,-0.09],['c',0.21,-0.06,0.66,-0.18,1.05,-0.27],['z']],w:2.16,h:8.04},
		'scripts.snap':{d:[['M',4.50,-3.39],['c',0.36,-0.03,0.96,-0.03,1.35,0.00],['c',1.56,0.15,3.15,0.90,4.20,2.01],['c',0.24,0.27,0.33,0.42,0.33,0.60],['c',0.00,0.27,0.03,0.24,-2.46,2.22],['c',-1.29,1.02,-2.40,1.86,-2.49,1.92],['c',-0.18,0.09,-0.30,0.09,-0.48,0.00],['c',-0.09,-0.06,-1.20,-0.90,-2.49,-1.92],['c',-2.49,-1.98,-2.46,-1.95,-2.46,-2.22],['c',0.00,-0.18,0.09,-0.33,0.33,-0.60],['c',1.05,-1.08,2.64,-1.86,4.17,-2.01],['z'],['m',1.29,1.17],['c',-1.47,-0.15,-2.97,0.30,-4.14,1.20],['l',-0.18,0.15],['l',0.06,0.09],['c',0.15,0.12,3.63,2.85,3.66,2.85],['c',0.03,0.00,3.51,-2.73,3.66,-2.85],['l',0.06,-0.09],['l',-0.18,-0.15],['c',-0.84,-0.66,-1.89,-1.08,-2.94,-1.20],['z']],w:10.38,h:6.84}};

	// Custom characters that weren't generated from the font:
	glyphs['noteheads.slash.whole'] = {d:[['M',5,-5],['l',1,1],['l',-5,5],['l',-1,-1],['z'],['m',4,6],['l',-5,-5],['l',2,-2],['l',5,5],['z'],['m',0,-2],['l',1,1],['l',-5,5],['l',-1,-1],['z'],['m',-4,6],['l',-5,-5],['l',2,-2],['l',5,5],['z']],w:10.81,h:15.63};

	glyphs['noteheads.slash.quarter'] = {d:[['M',9,-6],['l',0,4],['l',-9,9],['l',0,-4],['z']],w:9,h:9};

	glyphs['noteheads.harmonic.quarter'] = {d:[['M',3.63,-4.02],['c',0.09,-0.06,0.18,-0.09,0.24,-0.03],['c',0.03,0.03,0.87,0.93,1.83,2.01],['c',1.50,1.65,1.80,1.98,1.80,2.04],['c',0.00,0.06,-0.30,0.39,-1.80,2.04],['c',-0.96,1.08,-1.80,1.98,-1.83,2.01],['c',-0.06,0.06,-0.15,0.03,-0.24,-0.03],['c',-0.12,-0.09,-3.54,-3.84,-3.60,-3.93],['c',-0.03,-0.03,-0.03,-0.09,-0.03,-0.15],['c',0.03,-0.06,3.45,-3.84,3.63,-3.96],['z']],w:7.5,h:8.165};


  this.printSymbol = function (x,y,symb,paper, klass) {
    if (!glyphs[symb]) return null;
    var pathArray = this.pathClone(glyphs[symb].d);
    pathArray[0][1] +=x;
    pathArray[0][2] +=y;
    var path = "";
    for (var i = 0; i < pathArray.length; i++)
    	path += pathArray[i].join(" ");
    return paper.path({path:path, stroke:"none", fill:"#000000", 'class': klass });
   };
  
  this.getPathForSymbol = function (x,y,symb,scalex, scaley) {
    scalex = scalex || 1;
    scaley = scaley || 1;
    if (!glyphs[symb]) return null;
    var pathArray = this.pathClone(glyphs[symb].d);
    if (scalex!==1 || scaley!==1) this.pathScale(pathArray,scalex,scaley);
    pathArray[0][1] +=x;
    pathArray[0][2] +=y;

    return pathArray;
  };
  
  this.getSymbolWidth = function (symbol) {
    if (glyphs[symbol]) return glyphs[symbol].w;
    return 0;
  };
  
  this.getSymbolHeight = function (symbol) {
    if (glyphs[symbol]) return glyphs[symbol].h;
    return 0;
  };

	this.symbolHeightInPitches = function(symbol) {
		return this.getSymbolHeight(symbol) / spacing.STEP;
	};

  this.getSymbolAlign = function (symbol) {
    if (symbol.substring(0,7)==="scripts" && 
	symbol!=="scripts.roll") {
      return "center";
    }
    return "left";
  };

  this.pathClone = function (pathArray) {
    var res = [];
    for (var i = 0, ii = pathArray.length; i < ii; i++) {
      res[i] = [];
      for (var j = 0, jj = pathArray[i].length; j < jj; j++) {
	res[i][j] = pathArray[i][j];
      }
    }
    return res;
  };

  this.pathScale = function (pathArray, kx, ky) {
    for (var i = 0, ii = pathArray.length; i < ii; i++) {
      var p = pathArray[i];
      var j, jj;
      for (j = 1, jj = p.length; j < jj; j++) {
	p[j] *= (j % 2) ? kx : ky;
      }
    }
  };
   
  this.getYCorr = function (symbol) {
    switch(symbol) {
    case "0":
    case "1":
    case "2":
    case "3":
    case "4":
    case "5":
    case "6":
    case "7":
    case "8":
    case "9":
    case "+": return -2;
    case "timesig.common":
    case "timesig.cut": return 0;
    case "flags.d32nd": return -1;
    case "flags.d64th": return -2;
    case "flags.u32nd": return 1;
    case "flags.u64th": return 3;
    case "rests.whole": return 1;
    case "rests.half": return -1;
    case "rests.8th": return -1;
    case "rests.quarter": return -1;
    case "rests.16th": return -1;
    case "rests.32nd": return -1;
    case "rests.64th": return -1;
		case "f":
		case "m":
		case "p":
		case "s":
		case "z":
			return -4;
		case "scripts.trill":
		case "scripts.upbow":
		case "scripts.downbow":
			return -2;
		case "scripts.ufermata":
		case "scripts.wedge":
		case "scripts.roll":
		case "scripts.shortphrase":
		case "scripts.longphrase":
			return -1;
		case "scripts.dfermata":
			return 1;
    default: return 0;
    }
  };
};
module.exports = new Glyphs(); // we need the glyphs for layout information

},{"./abc_spacing":32}],30:[function(require,module,exports){
//    abc_relative_element.js: Definition of the RelativeElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var glyphs = require('./abc_glyphs');

var RelativeElement = function RelativeElement(c, dx, w, pitch, opt) {
	opt = opt || {};
	this.x = 0;
	this.c = c;      // character or path or string
	this.dx = dx;    // relative x position
	this.w = w;      // minimum width taken up by this element (can include gratuitous space)
	this.pitch = pitch; // relative y position by pitch
	this.scalex = opt.scalex || 1; // should the character/path be scaled?
	this.scaley = opt.scaley || 1; // should the character/path be scaled?
	this.type = opt.type || "symbol"; // cheap types.
	this.pitch2 = opt.pitch2;
	this.linewidth = opt.linewidth;
	this.klass = opt.klass;
	this.top = pitch;
	if (this.pitch2 !== undefined && this.pitch2 > this.top) this.top = this.pitch2;
	this.bottom = pitch;
	if (this.pitch2 !== undefined && this.pitch2 < this.bottom) this.bottom = this.pitch2;
	if (opt.thickness) {
		this.top += opt.thickness/2;
		this.bottom -= opt.thickness/2;
	}
	if (opt.stemHeight) {
		if (opt.stemHeight > 0)
			this.top += opt.stemHeight;
		else
			this.bottom += opt.stemHeight;
	}
	//if (this.type === "symbol") {
	//	var offset = glyphs.getYCorr(this.c);
	//	this.top += offset;
	//	this.bottom += offset;
	//}
	this.height = opt.height ? opt.height : 4; // The +1 is to give a little bit of padding.
	this.centerVertically = false;
	switch (this.type) {
		case "debug":
			this.chordHeightAbove = this.height;
			break;
		case "lyric":
			if (opt.position && opt.position === 'below')
				this.lyricHeightBelow = this.height;
			else
				this.lyricHeightAbove = this.height;
			break;
		case "chord":
			if (opt.position && opt.position === 'below')
				this.chordHeightBelow = this.height;
			else
				this.chordHeightAbove = this.height;
			break;
		case "text":
			if (this.pitch === undefined) {
				if (opt.position && opt.position === 'below')
					this.chordHeightBelow = this.height;
				else
					this.chordHeightAbove = this.height;
			} else
				this.centerVertically = true;
			break;
		case "part": this.partHeightAbove = this.height; break;
	}
};

RelativeElement.prototype.setX = function (x) {
	this.x = x+this.dx;
};

RelativeElement.prototype.setUpperAndLowerElements = function(positionY) {
	switch(this.type) {
		case "part":
			this.top = positionY.partHeightAbove + this.height;
			this.bottom = positionY.partHeightAbove;
			break;
		case "text":
		case "chord":
			if (this.chordHeightAbove) {
				this.top = positionY.chordHeightAbove;
				this.bottom = positionY.chordHeightAbove;
			} else {
				this.top = positionY.chordHeightBelow;
				this.bottom = positionY.chordHeightBelow;
			}
			break;
		case "lyric":
			if (this.lyricHeightAbove) {
				this.top = positionY.lyricHeightAbove;
				this.bottom = positionY.lyricHeightAbove;
			} else {
				this.top = positionY.lyricHeightBelow;
				this.bottom = positionY.lyricHeightBelow;
			}
			break;
		case "debug":
			this.top = positionY.chordHeightAbove;
			this.bottom = positionY.chordHeightAbove;
			break;
	}
	if (this.pitch === undefined || this.top === undefined)
		window.console.error("RelativeElement position not set.", this.type, this.pitch, this.top, positionY);
};

RelativeElement.prototype.draw = function (renderer, bartop) {
	if (this.pitch === undefined)
		window.console.error(this.type + " Relative Element y-coordinate not set.");
	var y = renderer.calcY(this.pitch);
	switch(this.type) {
		case "symbol":
			if (this.c===null) return null;
			var klass = "symbol";
			if (this.klass) klass += " " + this.klass;
			this.graphelem = renderer.printSymbol(this.x, this.pitch, this.c, this.scalex, this.scaley, renderer.addClasses(klass)); break;
		case "debug":
			this.graphelem = renderer.renderText(this.x, renderer.calcY(15), ""+this.c, "debugfont", 'debug-msg', 'start'); break;
		case "barNumber":
			this.graphelem = renderer.renderText(this.x, y, ""+this.c, "measurefont", 'bar-number', "middle");
			break;
		case "lyric":
			this.graphelem = renderer.renderText(this.x, y, this.c, "vocalfont", 'lyric', "middle");
			break;
		case "chord":
			this.graphelem = renderer.renderText(this.x, y, this.c, 'gchordfont', "chord", "middle");
			break;
		case "decoration":
			this.graphelem = renderer.renderText(this.x, y, this.c, 'annotationfont', "annotation", "middle", true);
			break;
		case "text":
			this.graphelem = renderer.renderText(this.x, y, this.c, 'annotationfont', "annotation", "start", this.centerVertically);
			break;
		case "multimeasure-text":
			this.graphelem = renderer.renderText(this.x+this.w/2, y, this.c, 'tempofont', "rest", "middle", false);
			break;
		case "part":
			this.graphelem = renderer.renderText(this.x, y, this.c, 'partsfont', "part", "start");
			break;
		case "bar":
			this.graphelem = renderer.printStem(this.x, this.linewidth, y, (bartop)?bartop:renderer.calcY(this.pitch2)); break; // bartop can't be 0
		case "stem":
			this.graphelem = renderer.printStem(this.x, this.linewidth, y, renderer.calcY(this.pitch2)); break;
		case "ledger":
			this.graphelem = renderer.printStaveLine(this.x, this.x+this.w, this.pitch); break;
	}
	if (this.scalex!==1 && this.graphelem) {
		renderer.scaleExistingElem(this.graphelem, this.scalex, this.scaley, this.x, y);
	}
	return this.graphelem;
};

module.exports = RelativeElement;

},{"./abc_glyphs":29}],31:[function(require,module,exports){
//    abc_renderer.js: API to render to SVG/Raphael/whatever rendering engine
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


/*global Math, console */

var glyphs = require('./abc_glyphs');
var spacing = require('./abc_spacing');
var sprintf = require('./sprintf');
var Svg = require('./svg');

/**
 * Implements the API for rendering ABCJS Abstract Rendering Structure to a canvas/paper (e.g. SVG, Raphael, etc)
 * @param {Object} paper
 * @param {bool} doRegression
 */
var Renderer = function(paper, doRegression, shouldAddClasses) {
  this.paper = new Svg(paper);
  this.controller = null; //TODO-GD only used when drawing the ABCJS ARS to connect the controller with the elements for highlighting

	this.space = 3*spacing.SPACE;
  this.padding = {}; // renderer's padding is managed by the controller
  this.doRegression = doRegression;
  this.shouldAddClasses = shouldAddClasses;
  if (this.doRegression)
    this.regressionLines = [];
	this.reset();
};

Renderer.prototype.reset = function() {

	this.paper.clear();
	this.y = 0;
	this.abctune = null;
	this.lastM = null;
	this.ingroup = false;
	this.path = null;
	this.isPrint = false;
	this.initVerticalSpace();
	if (this.doRegression)
		this.regressionLines = [];
	// HACK-PER: There was a problem in Raphael where every path string that was sent to it was cached.
	// That was causing the browser's memory to steadily grow until the browser went slower and slower until
	// it crashed. The fix to that was a patch to Raphael, so it is only patched on the versions of this library that
	// bundle Raphael with it. Also, if Raphael gets an update, then that patch will be lost. On version 2.1.2 of Raphael,
	// the patch is on line 1542 and 1545 and it is:
	//             p[ps].sleep = 1;
};

Renderer.prototype.newTune = function(abcTune) {
	this.abctune = abcTune; // TODO-PER: this is just to get the font info.
	this.setVerticalSpace(abcTune.formatting);
	this.measureNumber = null;
	this.noteNumber = null;
	this.setPrintMode(abcTune.media === 'print');
	this.setPadding(abcTune);
};

Renderer.prototype.createElemSet = function() {
	return this.paper.openGroup();
};

Renderer.prototype.closeElemSet = function() {
	return this.paper.closeGroup();
};

/**
 * Set whether we are formatting this for the screen, or as a preview for creating a PDF version.
 * @param {bool} isPrint
 */
Renderer.prototype.setPrintMode = function (isPrint) {
	this.isPrint = isPrint;
};

/**
 * Set the size of the canvas.
 * @param {object} maxwidth
 * @param {object} scale
 */
Renderer.prototype.setPaperSize = function (maxwidth, scale, responsive) {
	var w = (maxwidth+this.padding.right)*scale;
	var h = (this.y+this.padding.bottom)*scale;
	if (this.isPrint)
		h = Math.max(h, 1056); // 11in x 72pt/in x 1.33px/pt
	// TODO-PER: We are letting the page get as long as it needs now, but eventually that should go to a second page.
	if (this.doRegression)
		this.regressionLines.push("PAPER SIZE: ("+w+","+h+")");

	// for accessibility
	var text = "Sheet Music";
	if (this.abctune && this.abctune.metaText && this.abctune.metaText.title)
		text += " for \"" + this.abctune.metaText.title + '"';
	this.paper.setTitle(text);

	var parentStyles = { overflow: "hidden" };
	if (responsive === 'resize') {
		this.paper.setResponsiveWidth(w, h);
	} else {
		parentStyles.width = "";
		parentStyles.height = h + "px";
		if (scale < 1) {
			parentStyles.width = w + "px";
			this.paper.setSize(w / scale, h / scale);
		} else
			this.paper.setSize(w, h);
	}
	this.paper.setScale(scale);
	this.paper.setParentStyles(parentStyles);
};

/**
 * Set the padding
 * @param {object} params
 */
Renderer.prototype.setPaddingOverride = function(params) {
	this.paddingOverride = { top: params.paddingtop, bottom: params.paddingbottom,
		right: params.paddingright, left: params.paddingleft };
};

/**
 * Set the padding
 * @param {object} params
 */
Renderer.prototype.setPadding = function(abctune) {
	// If the padding is set in the tune, then use that.
	// Otherwise, if the padding is set in the override, use that.
	// Otherwise, use the defaults (there are a different set of defaults for screen and print.)
	function setPaddingVariable(self, paddingKey, formattingKey, printDefault, screenDefault) {
		if (abctune.formatting[formattingKey] !== undefined)
			self.padding[paddingKey] = abctune.formatting[formattingKey];
		else if (self.paddingOverride[paddingKey] !== undefined)
			self.padding[paddingKey] = self.paddingOverride[paddingKey];
		else if (self.isPrint)
			self.padding[paddingKey] = printDefault;
		else
			self.padding[paddingKey] = screenDefault;
	}
	// 1cm x 0.393701in/cm x 72pt/in x 1.33px/pt = 38px
	// 1.8cm x 0.393701in/cm x 72pt/in x 1.33px/pt = 68px
	setPaddingVariable(this, 'top', 'topmargin', 38, 15);
	setPaddingVariable(this, 'bottom', 'botmargin', 38, 15);
	setPaddingVariable(this, 'left', 'leftmargin', 68, 15);
	setPaddingVariable(this, 'right', 'rightmargin', 68, 15);
};

/**
 * Some of the items on the page are not scaled, so adjust them in the opposite direction of scaling to cancel out the scaling.
 * @param {float} scale
 */
Renderer.prototype.adjustNonScaledItems = function (scale) {
	this.padding.top /= scale;
	this.padding.bottom /= scale;
	this.padding.left /= scale;
	this.padding.right /= scale;
	this.abctune.formatting.headerfont.size /= scale;
	this.abctune.formatting.footerfont.size /= scale;
};

/**
 * Set the the values for all the configurable vertical space options.
 */
Renderer.prototype.initVerticalSpace = function() {
	// conversion: 37.7953 = conversion factor for cm to px.
	// All of the following values are in px.
	this.spacing = {
		composer: 7.56, // Set the vertical space above the composer.
		graceBefore: 8.67, // Define the space before, inside and after the grace notes.
		graceInside: 10.67,
		graceAfter: 16,
		info: 0, // Set the vertical space above the infoline.
		lineSkipFactor: 1.1, // Set the factor for spacing between lines of text. (multiply this by the font size)
		music: 7.56, // Set the vertical space above the first staff.
		paragraphSkipFactor: 0.4, // Set the factor for spacing between text paragraphs. (multiply this by the font size)
		parts: 11.33, // Set the vertical space above a new part.
		slurHeight: 1.0, // Set the slur height factor.
		staffSeparation: 61.33, // Do not put a staff system closer than <unit> from the previous system.
		stemHeight: 26.67+10, // Set the stem height.
		subtitle: 3.78, // Set the vertical space above the subtitle.
		systemStaffSeparation: 48, // Do not place the staves closer than <unit> inside a system. * This values applies to all staves when in the tune header. Otherwise, it applies to the next staff
		text: 18.9, // Set the vertical space above the history.
		title: 7.56, // Set the vertical space above the title.
		top: 30.24, //Set the vertical space above the tunes and on the top of the continuation pages.
		vocal: 30.67, // Set the vertical space above the lyrics under the staves.
		words: 0 // Set the vertical space above the lyrics at the end of the tune.
	};
	/*
	TODO-PER: Handle the x-coordinate spacing items, too.
maxshrink <float>Default: 0.65
Set how much to compress horizontally when music line breaks
are automatic.
<float> must be between 0 (natural spacing)
and 1 (max shrinking).

// This next value is used to compute the natural spacing of
// the notes. The base spacing of the crotchet is always
// 40 pts. When the duration of a note type is twice the
// duration of an other note type, its spacing is multiplied
// by this factor.
// The default value causes the note spacing to be multiplied
// by 2 when its duration is multiplied by 4, i.e. the
// space of the semibreve is 80 pts and the space of the
// semiquaver is 20 pts.
// Setting this value to 1 sets all note spacing to 40 pts.
noteSpacingFactor: 1.414, // Set the note spacing factor to <float> (range 1..2).

scale <float> Default: 0.75 Set the page scale factor. Note that the header and footer are not scaled.

stretchlast <float>Default: 0.8
Stretch the last music line of a tune when it exceeds
the <float> fraction of the page width.
<float> range is 0.0 to 1.0.
	 */
};

Renderer.prototype.setVerticalSpace = function(formatting) {
	// conversion from pts to px 4/3
	if (formatting.staffsep !== undefined)
		this.spacing.staffSeparation = formatting.staffsep *4/3;
	if (formatting.composerspace !== undefined)
		this.spacing.composer = formatting.composerspace *4/3;
	if (formatting.partsspace !== undefined)
		this.spacing.parts = formatting.partsspace *4/3;
	if (formatting.textspace !== undefined)
		this.spacing.text = formatting.textspace *4/3;
	if (formatting.musicspace !== undefined)
		this.spacing.music = formatting.musicspace *4/3;
	if (formatting.titlespace !== undefined)
		this.spacing.title = formatting.titlespace *4/3;
	if (formatting.sysstaffsep !== undefined)
		this.spacing.systemStaffSeparation = formatting.sysstaffsep *4/3;
	if (formatting.subtitlespace !== undefined)
		this.spacing.subtitle = formatting.subtitlespace *4/3;
	if (formatting.topspace !== undefined)
		this.spacing.top = formatting.topspace *4/3;
	if (formatting.vocalspace !== undefined)
		this.spacing.vocal = formatting.vocalspace *4/3;
	if (formatting.wordsspace !== undefined)
		this.spacing.words = formatting.wordsspace *4/3;
};

/**
 * Leave space at the top of the paper
 * @param {object} abctune
 */
Renderer.prototype.topMargin = function(abctune) {
		this.moveY(this.padding.top);
};

/**
 * Leave space before printing the music
 */
Renderer.prototype.addMusicPadding = function() {
		this.moveY(this.spacing.music);
};

/**
 * Leave space before printing a staff system
 */
Renderer.prototype.addStaffPadding = function(lastStaffGroup, thisStaffGroup) {
	var lastStaff = lastStaffGroup.staffs[lastStaffGroup.staffs.length-1];
	var lastBottomLine = -(lastStaff.bottom - 2); // The 2 is because the scale goes to 2 below the last line.
	var nextTopLine = thisStaffGroup.staffs[0].top - 10; // Because 10 represents the top line.
	var naturalSeparation = nextTopLine + lastBottomLine; // This is how far apart they'd be without extra spacing
	var separationInPixels = naturalSeparation * spacing.STEP;
	if (separationInPixels < this.spacing.staffSeparation)
		this.moveY(this.spacing.staffSeparation-separationInPixels);
};

/**
 * Text that goes above the score
 * @param {number} width
 * @param {object} abctune
 */
Renderer.prototype.engraveTopText = function(width, abctune) {
	if (abctune.metaText.header && this.isPrint) {
		// Note: whether there is a header or not doesn't change any other positioning, so this doesn't change the Y-coordinate.
		// This text goes above the margin, so we'll temporarily move up.
		var headerTextHeight = this.getTextSize("XXXX", "headerfont", 'abcjs-header abcjs-meta-top').height;
		this.y -=headerTextHeight;
		this.outputTextIf(this.padding.left, abctune.metaText.header.left, 'headerfont', 'header meta-top', 0, null, 'start');
		this.outputTextIf(this.padding.left + width / 2, abctune.metaText.header.center, 'headerfont', 'header meta-top', 0, null, 'middle');
		this.outputTextIf(this.padding.left + width, abctune.metaText.header.right, 'headerfont', 'header meta-top', 0, null, 'end');
		this.y += headerTextHeight;
	}
	if (this.isPrint)
		this.moveY(this.spacing.top);
	this.outputTextIf(this.padding.left + width / 2, abctune.metaText.title, 'titlefont', 'title meta-top', this.spacing.title, 0, 'middle');
	if (abctune.lines[0])
		this.outputTextIf(this.padding.left + width / 2, abctune.lines[0].subtitle, 'subtitlefont', 'text meta-top', this.spacing.subtitle, 0, 'middle');

	if (abctune.metaText.rhythm || abctune.metaText.origin || abctune.metaText.composer) {
		this.moveY(this.spacing.composer);
		var rSpace = this.outputTextIf(this.padding.left, abctune.metaText.rhythm, 'infofont', 'meta-top', 0, null, "start");

		var composerLine = "";
		if (abctune.metaText.composer) composerLine += abctune.metaText.composer;
		if (abctune.metaText.origin) composerLine += ' (' + abctune.metaText.origin + ')';
		if (composerLine.length > 0) {
			var space = this.outputTextIf(this.padding.left + width, composerLine, 'composerfont', 'meta-top', 0, null, "end");
			this.moveY(space[1]);
		} else {
			this.moveY(rSpace[1]);
		}
		// TODO-PER: The following is a hack to make the elements line up with abcm2ps. Don't know where the extra space is coming from.
		this.moveY(-6);
	//} else if (this.isPrint) {
	//	// abcm2ps adds this space whether there is anything to write or not.
	//	this.moveY(this.spacing.composer);
	//	var space2 = this.getTextSize("M", 'composerfont', 'meta-top');
	//	this.moveY(space2.height);
	}

	this.outputTextIf(this.padding.left + width, abctune.metaText.author, 'composerfont', 'meta-top', 0, 0, "end");
	//this.skipSpaceY();

	this.outputTextIf(this.padding.left, abctune.metaText.partOrder, 'partsfont', 'meta-bottom', 0, 0, "start");
};

/**
 * Text that goes below the score
 * @param {number} width
 * @param {object} abctune
 */
Renderer.prototype.engraveExtraText = function(width, abctune) {
	this.lineNumber = null;
	this.measureNumber = null;
	this.noteNumber = null;
	this.voiceNumber = null;

	var extraText;
	if (abctune.metaText.unalignedWords) {
		extraText = "";
		for (var j = 0; j < abctune.metaText.unalignedWords.length; j++) {
			if (typeof abctune.metaText.unalignedWords[j] === 'string')
				extraText += abctune.metaText.unalignedWords[j] + "\n";
			else {
				for (var k = 0; k < abctune.metaText.unalignedWords[j].length; k++) {
					extraText += " FONT " + abctune.metaText.unalignedWords[j][k].text;
				}
				extraText += "\n";
			}
		}
		this.outputTextIf(this.padding.left + spacing.INDENT, extraText, 'wordsfont', 'meta-bottom', this.spacing.words, 2, "start");
	}

	extraText = "";
	if (abctune.metaText.book) extraText += "Book: " + abctune.metaText.book + "\n";
	if (abctune.metaText.source) extraText += "Source: " + abctune.metaText.source + "\n";
	if (abctune.metaText.discography) extraText += "Discography: " + abctune.metaText.discography + "\n";
	if (abctune.metaText.notes) extraText += "Notes: " + abctune.metaText.notes + "\n";
	if (abctune.metaText.transcription) extraText += "Transcription: " + abctune.metaText.transcription + "\n";
	if (abctune.metaText.history) extraText += "History: " + abctune.metaText.history + "\n";
	if (abctune.metaText['abc-copyright']) extraText += "Copyright: " + abctune.metaText['abc-copyright'] + "\n";
	if (abctune.metaText['abc-creator']) extraText += "Creator: " + abctune.metaText['abc-creator'] + "\n";
	if (abctune.metaText['abc-edited-by']) extraText += "Edited By: " + abctune.metaText['abc-edited-by'] + "\n";
	this.outputTextIf(this.padding.left, extraText, 'historyfont', 'meta-bottom', this.spacing.info, 0, "start");

	if (abctune.metaText.footer && this.isPrint) {
		// Note: whether there is a footer or not doesn't change any other positioning, so this doesn't change the Y-coordinate.
		this.outputTextIf(this.padding.left, abctune.metaText.footer.left, 'footerfont', 'header meta-bottom', 0, null, 'start');
		this.outputTextIf(this.padding.left + width / 2, abctune.metaText.footer.center, 'footerfont', 'header meta-bottom', 0, null, 'middle');
		this.outputTextIf(this.padding.left + width, abctune.metaText.footer.right, 'footerfont', 'header meta-bottom', 0, null, 'end');
	}
};

/**
 * Output text defined with %%text.
 * @param {array or string} text
 */
Renderer.prototype.outputFreeText = function (text) {
	if (text === "") {	// we do want to print out blank lines if they have been specified.
		var hash = this.getFontAndAttr('textfont', 'defined-text');
		this.moveY(hash.attr['font-size'] * 2); // move the distance of the line, plus the distance of the margin, which is also one line.
	} else if (typeof text === 'string')
		this.outputTextIf(this.padding.left, text, 'textfont', 'defined-text', 0, 1, "start");
	else {
		var str = "";
		var isCentered = false; // The structure is wrong here: it requires an array to do centering, but it shouldn't have.
		for (var i = 0; i < text.length; i++) {
			if (text[i].font)
				str += "FONT(" + text[i].font + ")";
			str += text[i].text;
			if (text[i].center)
				isCentered = true;
		}
		var alignment = isCentered ? 'middle' : 'start';
		var x = isCentered ? this.controller.width / 2 : this.padding.left;
		this.outputTextIf(x, str, 'textfont', 'defined-text', 0, 1, alignment);
	}
};

/**
 * Output an extra subtitle that is defined later in the tune.
 */
Renderer.prototype.outputSubtitle = function (width, subtitle) {
	this.outputTextIf(this.padding.left + width / 2, subtitle, 'subtitlefont', 'text meta-top', this.spacing.subtitle, 0, 'middle');
};

/**
 * Begin a group of glyphs that will always be moved, scaled and highlighted together
 */
Renderer.prototype.beginGroup = function () {
  this.path = [];
  this.lastM = [0,0];
  this.ingroup = true;
};

/**
 * Add a path to the current group
 * @param {Array} path
 * @private
 */
Renderer.prototype.addPath = function (path) {
  path = path || [];
  if (path.length===0) return;
  path[0][0]="m";
  path[0][1]-=this.lastM[0];
  path[0][2]-=this.lastM[1];
  this.lastM[0]+=path[0][1];
  this.lastM[1]+=path[0][2];
  this.path.push(path[0]);
  for (var i=1,ii=path.length;i<ii;i++) {
    if (path[i][0]==="m") {
      this.lastM[0]+=path[i][1];
      this.lastM[1]+=path[i][2];
    }
    this.path.push(path[i]);
  }
};

/**
 * End a group of glyphs that will always be moved, scaled and highlighted together
 */
Renderer.prototype.endGroup = function (klass) {
  this.ingroup = false;
  if (this.path.length===0) return null;
  var path = "";
	for (var i = 0; i < this.path.length; i++)
		path += this.path[i].join(" ");
	var ret = this.paper.path({path: path, stroke:"none", fill:"#000000", 'class': this.addClasses(klass)});
	this.path = [];
  if (this.doRegression) this.addToRegression(ret);

  return ret;
};

/**
 * gets scaled
 * @param {number} x1 start x
 * @param {number} x2 end x
 * @param {number} pitch pitch the stave line is drawn at
 */
Renderer.prototype.printStaveLine = function (x1,x2, pitch, klass) {
	var extraClass = "staff";
	if (klass !== undefined)
		extraClass += " " + klass;
  var isIE=/*@cc_on!@*/false;//IE detector
  var dy = 0.35;
  var fill = "#000000";
  if (isIE) {
    dy = 1;
    fill = "#666666";
  }
  var y = this.calcY(pitch);
  var pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", x1, y-dy, x2, y-dy,
     x2, y+dy, x1, y+dy);
  var ret = this.paper.pathToBack({path:pathString, stroke:"none", fill:fill, 'class': this.addClasses(extraClass)});
  if (this.doRegression) this.addToRegression(ret);

  return ret;
};

/**
 * gets scaled if not in a group
 * @param {number} x x coordinate of the stem
 * @param {number} dx stem width
 * @param {number} y1 y coordinate of the stem bottom
 * @param {number} y2 y coordinate of the stem top
 */
Renderer.prototype.printStem = function (x, dx, y1, y2) {
  if (dx<0) { // correct path "handedness" for intersection with other elements
    var tmp = y2;
    y2 = y1;
    y1 = tmp;
  }
  var isIE=/*@cc_on!@*/false;//IE detector
  var fill = "#000000";
  if (isIE && dx<1) {
    dx = 1;
    fill = "#666666";
  }
  if (~~x === x) x+=0.05; // raphael does weird rounding (for VML)
  var pathArray = [["M",x,y1],["L", x, y2],["L", x+dx, y2],["L",x+dx,y1],["z"]];
  if (!isIE && this.ingroup) {
    this.addPath(pathArray);
  } else {
  	var path = "";
  	for (var i = 0; i < pathArray.length; i++)
  		path += pathArray[i].join(" ");
    var ret = this.paper.pathToBack({path:path, stroke:"none", fill:fill, 'class': this.addClasses('stem')});
    if (this.doRegression) this.addToRegression(ret);

    return ret;
  }
};

function kernSymbols(lastSymbol, thisSymbol, lastSymbolWidth) {
	// This is just some adjustments to make it look better.
	var width = lastSymbolWidth;
	if (lastSymbol === 'f' && thisSymbol === 'f')
		width = width*2/3;
	if (lastSymbol === 'p' && thisSymbol === 'p')
		width = width*5/6;
	if (lastSymbol === 'f' && thisSymbol === 'z')
		width = width*5/8;
	return width;
}

/**
 * assumes this.y is set appropriately
 * if symbol is a multichar string without a . (as in scripts.staccato) 1 symbol per char is assumed
 * not scaled if not in printgroup
 */
Renderer.prototype.printSymbol = function (x, offset, symbol, scalex, scaley, klass) {
	var el;
	var ycorr;
	if (!symbol) return null;
	if (symbol.length > 1 && symbol.indexOf(".") < 0) {
		this.paper.openGroup();
		var dx = 0;
		for (var i = 0; i < symbol.length; i++) {
			var s = symbol.charAt(i);
			ycorr = glyphs.getYCorr(s);
			el = glyphs.printSymbol(x + dx, this.calcY(offset + ycorr), s, this.paper, klass);
			if (el) {
				if (this.doRegression) this.addToRegression(el);
				//elemset.push(el);
				if (i < symbol.length - 1)
					dx += kernSymbols(s, symbol.charAt(i + 1), glyphs.getSymbolWidth(s));
			} else {
				this.renderText(x, this.y, "no symbol:" + symbol, "debugfont", 'debug-msg', 'start');
			}
		}
		return this.paper.closeGroup();
	} else {
		ycorr = glyphs.getYCorr(symbol);
		if (this.ingroup) {
			this.addPath(glyphs.getPathForSymbol(x, this.calcY(offset + ycorr), symbol, scalex, scaley));
		} else {
			el = glyphs.printSymbol(x, this.calcY(offset + ycorr), symbol, this.paper, klass);
			if (el) {
				if (this.doRegression) this.addToRegression(el);
				return el;
			} else
				this.renderText(x, this.y, "no symbol:" + symbol, "debugfont", 'debug-msg', 'start');
		}
		return null;
	}
};

Renderer.prototype.scaleExistingElem = function (elem, scaleX, scaleY, x, y) {
	this.paper.setAttributeOnElement(elem, { style: "transform:scale("+scaleX+","+scaleY + ");transform-origin:" + x + "px " + y + "px;"});
};

Renderer.prototype.printPath = function (attrs) {
  var ret = this.paper.path(attrs);
  if (this.doRegression) this.addToRegression(ret);
  return ret;
};

Renderer.prototype.drawBrace = function(xLeft, yTop, yBottom) {//Tony
	var yHeight = yBottom - yTop;

	var xCurve = [7.5, -8, 21, 0, 18.5, -10.5, 7.5];
	var yCurve = [0, yHeight/5.5, yHeight/3.14, yHeight/2, yHeight/2.93, yHeight/4.88, 0];

	var pathString = sprintf("M %f %f C %f %f %f %f %f %f C %f %f %f %f %f %f z",
		xLeft+xCurve[0], yTop+yCurve[0],
		xLeft+xCurve[1], yTop+yCurve[1],
		xLeft+xCurve[2], yTop+yCurve[2],
		xLeft+xCurve[3], yTop+yCurve[3],
		xLeft+xCurve[4], yTop+yCurve[4],
		xLeft+xCurve[5], yTop+yCurve[5],
		xLeft+xCurve[6], yTop+yCurve[6]);
	var ret1 = this.paper.path({path:pathString, stroke:"#000000", fill:"#000000", 'class': this.addClasses('brace')});

	xCurve = [0, 17.5, -7.5, 6.6, -5, 20, 0];
	yCurve = [yHeight/2, yHeight/1.46, yHeight/1.22, yHeight, yHeight/1.19, yHeight/1.42, yHeight/2];

	pathString = sprintf("M %f %f C %f %f %f %f %f %f C %f %f %f %f %f %f z",
		xLeft+xCurve[ 0], yTop+yCurve[0],
		xLeft+xCurve[1], yTop+yCurve[1],
		xLeft+xCurve[2], yTop+yCurve[2],
		xLeft+xCurve[3], yTop+yCurve[3],
		xLeft+xCurve[4], yTop+yCurve[4],
		xLeft+xCurve[5], yTop+yCurve[5],
		xLeft+xCurve[6], yTop+yCurve[6]);
	var ret2 = this.paper.path({path:pathString, stroke:"#000000", fill:"#000000", 'class': this.addClasses('brace')});

	if (this.doRegression){
		this.addToRegression(ret1);
		this.addToRegression(ret2);
	}
	return ret1 + ret2;
};

Renderer.prototype.drawArc = function(x1, x2, pitch1, pitch2, above, klass, isTie) {
	// If it is a tie vs. a slur, draw it shallower.
	var spacing = isTie ? 1.2 : 1.5;

  x1 = x1 + 6;
  x2 = x2 + 4;
  pitch1 = pitch1 + ((above)?spacing:-spacing);
  pitch2 = pitch2 + ((above)?spacing:-spacing);
  var y1 = this.calcY(pitch1);
  var y2 = this.calcY(pitch2);

  //unit direction vector
  var dx = x2-x1;
  var dy = y2-y1;
  var norm= Math.sqrt(dx*dx+dy*dy);
  var ux = dx/norm;
  var uy = dy/norm;

  var flatten = norm/3.5;
  var maxFlatten = isTie ? 10 : 25;  // If it is a tie vs. a slur, draw it shallower.
  var curve = ((above)?-1:1)*Math.min(maxFlatten, Math.max(4, flatten));

  var controlx1 = x1+flatten*ux-curve*uy;
  var controly1 = y1+flatten*uy+curve*ux;
  var controlx2 = x2-flatten*ux-curve*uy;
  var controly2 = y2-flatten*uy+curve*ux;
  var thickness = 2;
  var pathString = sprintf("M %f %f C %f %f %f %f %f %f C %f %f %f %f %f %f z", x1, y1,
     controlx1, controly1, controlx2, controly2, x2, y2,
     controlx2-thickness*uy, controly2+thickness*ux, controlx1-thickness*uy, controly1+thickness*ux, x1, y1);
	if (klass)
		klass += ' slur';
	else
		klass = 'slur';
  var ret = this.paper.path({path:pathString, stroke:"none", fill:"#000000", 'class': this.addClasses(klass)});
  if (this.doRegression) this.addToRegression(ret);

  return ret;
};
/**
 * Calculates the y for a given pitch value (relative to the stave the renderer is currently printing)
 * @param {number} ofs pitch value (bottom C on a G clef = 0, D=1, etc.)
 */
Renderer.prototype.calcY = function(ofs) {
  return this.y - ofs*spacing.STEP;
};

/**
 * Print @param {number} numLines. If there is 1 line it is the B line. Otherwise the bottom line is the E line.
 */
Renderer.prototype.printStave = function (startx, endx, numLines) {
	var klass = "top-line";
	this.paper.openGroup({ prepend: true });
	// If there is one line, it is the B line. Otherwise, the bottom line is the E line.
	if (numLines === 1) {
		this.printStaveLine(startx,endx,6, klass);
		return;
	}
	for (var i = numLines-1; i >= 0; i--) {
		this.printStaveLine(startx,endx,(i+1)*2, klass);
		klass = undefined;
	}
	this.paper.closeGroup();
};

/**
 *
 * @private
 */
Renderer.prototype.addClasses = function (c, isNote) {
	if (!this.shouldAddClasses)
		return "";
	var ret = [];
	if (c.length > 0) ret.push(c);
	if (this.lineNumber !== null && this.lineNumber !== undefined) ret.push("l"+this.lineNumber);
	if (this.measureNumber !== null && this.measureNumber !== undefined) ret.push("m"+this.measureNumber);
	if (this.voiceNumber !== null && this.voiceNumber !== undefined) ret.push("v"+this.voiceNumber);
	if ((c.indexOf('note') >= 0 || c.indexOf('rest') >= 0) && this.noteNumber !== null && this.noteNumber !== undefined) ret.push("n"+this.noteNumber);
	// add a prefix to all classes that abcjs adds.
	if (ret.length > 0) {
		ret = ret.join(' '); // Some strings are compound classes - that is, specify more than one class in a string.
		ret = ret.split(' ');
		for (var i = 0; i < ret.length; i++) {
			if (ret[i].indexOf('abcjs-') !== 0 && ret[i].length > 0) // if the prefix doesn't already exist and the class is not blank.
				ret[i] = 'abcjs-' + ret[i];
		}
	}
	return ret.join(' ');
};

Renderer.prototype.getFontAndAttr = function(type, klass) {
	var font = this.abctune.formatting[type];
	// Raphael deliberately changes the font units to pixels for some reason, so we need to change points to pixels here.
	if (font)
		font = { face: font.face, size: font.size*4/3, decoration: font.decoration, style: font.style, weight: font.weight, box: font.box };
	else
		font = { face: "Arial", size: 12*4/3, decoration: "underline", style: "normal", weight: "normal" };

	var attr = {"font-size": font.size, 'font-style': font.style,
		"font-family": font.face, 'font-weight': font.weight, 'text-decoration': font.decoration,
		'class': this.addClasses(klass) };
	attr.font = "";	// There is a spurious font definition that is put on all text elements. This overwrites it.
	return { font: font, attr: attr };
};

Renderer.prototype.getTextSize = function(text, type, klass) {
	var hash = this.getFontAndAttr(type, klass);
	var size = this.paper.getTextSize(text, hash.attr);
	if (hash.font.box) {
		size.height += 8;
		// TODO-PER: Shouldn't the width also be increased here?
	}
	return size;
};

Renderer.prototype.renderText = function(x, y, text, type, klass, anchor, centerVertically) {
	var hash = this.getFontAndAttr(type, klass);
	if (anchor)
		hash.attr["text-anchor"] = anchor;
	hash.attr.x = x;
	hash.attr.y = y + 7; // TODO-PER: Not sure why the text appears to be 7 pixels off.
	if (!centerVertically)
		hash.attr.dy = "0.5em";
	if (type === 'debugfont') {
		console.log("Debug msg: " + text);
		hash.attr.stroke = "#ff0000";
	}

	text = text.replace(/\n\n/g, "\n \n");
	text = text.replace(/^\n/, "\xA0\n");

	var el = this.paper.text(text, hash.attr);

	if (hash.font.box) {
		var size = el.getBBox();
		var padding = 2;
		var margin = 2;
		this.paper.rect({ x: size.x - padding, y: size.y + padding, width: size.width + padding*2, height: size.height + padding*2 - margin,  stroke: "#888888", fill: "transparent"});
		//size.height += 8;
	}
	if (this.doRegression) this.addToRegression(el);
	return el;
};

Renderer.prototype.moveY = function (em, numLines) {
	if (numLines === undefined) numLines = 1;
	this.y += em*numLines;
};

Renderer.prototype.skipSpaceY = function () {
	this.y += this.space;
};

// Call with 'kind' being the font type to use,
// if marginBottom === null then don't increment the Y after printing, otherwise that is the extra number of em's to leave below the line.
// and alignment being "start", "middle", or "end".
Renderer.prototype.outputTextIf = function(x, str, kind, klass, marginTop, marginBottom, alignment) {
	if (str) {
		if (marginTop)
			this.moveY(marginTop);
		var el = this.renderText(x, this.y, str, kind, klass, alignment);
		var bb = el.getBBox(); // This can return NaN if the element isn't visible.
		var width = isNaN(bb.width) ? 0 : bb.width;
		var height = isNaN(bb.height) ? 0 : bb.height;
		if (marginBottom !== null) {
			var numLines = str.split("\n").length;
			if (!isNaN(bb.height))
				this.moveY(height/numLines, (numLines + marginBottom));
		}
		return [width, height];
	}
	return [0,0];
};

Renderer.prototype.addInvisibleMarker = function (className) {
	var dy = 0.35;
	var fill = "rgba(0,0,0,0)";
	var y = this.y;
	y = Math.round(y);
	var x1 = 0;
	var x2 = 100;
	var pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", x1, y-dy, x1+x2, y-dy,
		x2, y+dy, x1, y+dy);
	this.paper.pathToBack({path:pathString, stroke:"none", fill:fill, "fill-opacity": 0, 'class': this.addClasses(className), 'data-vertical': y });
};

// For debugging, it is sometimes useful to know where you are vertically.
Renderer.prototype.printHorizontalLine = function (width, vertical, comment) {
	var dy = 0.35;
	var fill = "rgba(0,0,255,.4)";
	var y = this.y;
	if (vertical) y = vertical;
	y = Math.round(y);
	this.paper.text(""+Math.round(y), {x: 10, y: y, "text-anchor": "start", "font-size":"18px", fill: fill, stroke: fill });
	var x1 = 50;
	var x2 = width;
	var pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", x1, y-dy, x1+x2, y-dy,
		x2, y+dy, x1, y+dy);
	this.paper.pathToBack({path:pathString, stroke:"none", fill:fill, 'class': this.addClasses('staff')});
	for (var i = 1; i < width/100; i++) {
		pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", i*100-dy, y-5, i*100-dy, y+5,
			i*100+dy, y-5, i*100+dy, y+5);
		this.paper.pathToBack({path:pathString, stroke:"none", fill:fill, 'class': this.addClasses('staff')});
	}
	if (comment)
		this.paper.text(comment, {x: width+70, y: y, "text-anchor": "start", "font-size":"18px", fill: fill, stroke: fill });
};

Renderer.prototype.printShadedBox = function (x, y, width, height, color, opacity, comment) {
	var box = this.paper.rect({ x: x, y: y, width: width, height: height, fill: color, stroke: color, "fill-opacity": opacity, "stroke-opacity": opacity });
	if (comment)
		this.paper.text(comment, {x: 0, y: y+7, "text-anchor": "start", "font-size":"14px", fill: "rgba(0,0,255,.4)", stroke: "rgba(0,0,255,.4)" });
	return box;
};

Renderer.prototype.printVerticalLine = function (x, y1, y2) {
	var dy = 0.35;
	var fill = "#00aaaa";
	var pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", x - dy, y1, x - dy, y2,
			x + dy, y1, x + dy, y2);
	this.paper.pathToBack({path: pathString, stroke: "none", fill: fill, 'class': this.addClasses('staff')});
	pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", x - 20, y1, x - 20, y1+3,
		x, y1, x, y1+3);
	this.paper.pathToBack({path: pathString, stroke: "none", fill: fill, 'class': this.addClasses('staff')});
	pathString = sprintf("M %f %f L %f %f L %f %f L %f %f z", x + 20, y2, x + 20, y2+3,
		x, y2, x, y2+3);
	this.paper.pathToBack({path: pathString, stroke: "none", fill: fill, 'class': this.addClasses('staff')});

};

/**
 * @private
 */
Renderer.prototype.addToRegression = function (el) {
	var box = el.getBBox();
	//var str = "("+box.x+","+box.y+")["+box.width+","+box.height+"] "
	var str = el.type + ' ' + box.toString() + ' ';
	var attrs = [];
	for (var key in el.attrs) {
		if (el.attrs.hasOwnProperty(key)) {
			if (key === 'class')
				str = el.attrs[key] + " " + str;
			else
				attrs.push(key+": "+el.attrs[key]);
		}
	}
	attrs.sort();
	str += "{ " +attrs.join(" ") + " }";
	this.regressionLines.push(str);
};

module.exports = Renderer;

},{"./abc_glyphs":29,"./abc_spacing":32,"./sprintf":38,"./svg":39}],32:[function(require,module,exports){
//    Copyright (C) 2014-2018 Gregory Dyke (gregdyke at gmail dot com)
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var spacing = {};

spacing.FONTEM = 360;
spacing.FONTSIZE = 30;
spacing.STEP = spacing.FONTSIZE*93/720;
spacing.SPACE = 10;
spacing.TOPNOTE = 15;
spacing.STAVEHEIGHT = 100;
spacing.INDENT = 50;

module.exports = spacing;

},{}],33:[function(require,module,exports){
//    abc_staff_group_element.js: Definition of the StaffGroupElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

/*globals console */

var spacing = require('./abc_spacing');

// StaffGroupElement contains all the elements that go together to make one line of music.
// That might be multiple staves that are tied together, and it might be multiple voices on one staff.
//
// Methods:
// constructor: some basic initialization
// addVoice(): Called once for each voice. May add a new staff if needed.
// finished(): Called only internally by layout()
// layout(): This does all the layout. It sets the following: spacingunits, startx, minspace, w, and the x-coordinate of each element in each voice.
// draw(): Calls the underlying methods on the voice objects to do the drawing. Sets y and height.
//
// Members:
// staffs: an array of all the staves in this group. Each staff contains the following elements:
//    { top, bottom, highest, lowest, y }
// voices: array of VoiceElement objects. This is mostly passed in, but the VoiceElement objects are modified here.
//
// spacingunits: number of relative x-units in the line. Used by the calling function to pass back in as the "spacing" input parameter.
// TODO-PER: This should actually be passed back as a return value.
// minspace: smallest space between two notes. Used by the calling function to pass back in as the "spacing" input parameter.
// TODO-PER: This should actually be passed back as a return value.
// startx: The left edge, taking the margin and the optional voice name. Used by the draw() method.
// w: The width of the line. Used by calling function to pass back in as the "spacing" input parameter, and the draw() method.
// TODO-PER: This should actually be passed back as a return value.  (TODO-PER: in pixels or spacing units?)
// y: The top of the staff group, in pixels. This is set in the draw method.
// TODO-PER: Where is that used? It looks like it might not be needed.
// height: Set in the draw() method to the height actually used. Used by the calling function to know where to start the next staff group.
// TODO-PER: This should actually be set in the layout method and passed back as a return value.

var StaffGroupElement = function() {
	this.voices = [];
	this.staffs = [];
	this.brace = undefined; //tony
};

StaffGroupElement.prototype.setLimit = function(member, voice) {
	if (!voice.specialY[member]) return;
	if (!voice.staff.specialY[member])
		voice.staff.specialY[member] = voice.specialY[member];
	else
		voice.staff.specialY[member] = Math.max(voice.staff.specialY[member], voice.specialY[member]);
};

StaffGroupElement.prototype.addVoice = function (voice, staffnumber, stafflines) {
	var voiceNum = this.voices.length;
	this.voices[voiceNum] = voice;
	if (this.staffs[staffnumber])
		this.staffs[staffnumber].voices.push(voiceNum);
	else {
		// TODO-PER: how does the min/max change when stafflines is not 5?
		this.staffs[this.staffs.length] = {
			top: 10,
			bottom: 2,
			lines: stafflines,
			voices: [voiceNum],
			specialY: {
				tempoHeightAbove: 0,
				partHeightAbove: 0,
				volumeHeightAbove: 0,
				dynamicHeightAbove: 0,
				endingHeightAbove: 0,
				chordHeightAbove: 0,
				lyricHeightAbove: 0,

				lyricHeightBelow: 0,
				chordHeightBelow: 0,
				volumeHeightBelow: 0,
				dynamicHeightBelow: 0
			}
		};
	}
	voice.staff = this.staffs[staffnumber];
};

StaffGroupElement.prototype.setStaffLimits = function (voice) {
	voice.staff.top = Math.max(voice.staff.top, voice.top);
	voice.staff.bottom = Math.min(voice.staff.bottom, voice.bottom);
	this.setLimit('tempoHeightAbove', voice);
	this.setLimit('partHeightAbove', voice);
	this.setLimit('volumeHeightAbove', voice);
	this.setLimit('dynamicHeightAbove', voice);
	this.setLimit('endingHeightAbove', voice);
	this.setLimit('chordHeightAbove', voice);
	this.setLimit('lyricHeightAbove', voice);
	this.setLimit('lyricHeightBelow', voice);
	this.setLimit('chordHeightBelow', voice);
	this.setLimit('volumeHeightBelow', voice);
	this.setLimit('dynamicHeightBelow', voice);
};

StaffGroupElement.prototype.setUpperAndLowerElements = function(renderer) {
	// Each staff already has the top and bottom set, now we see if there are elements that are always on top and bottom, and resolve their pitch.
	// Also, get the overall height of all the staves in this group.
	var lastStaffBottom;
	for (var i = 0; i < this.staffs.length; i++) {
		var staff = this.staffs[i];
		// the vertical order of elements that are above is: tempo, part, volume/dynamic, ending/chord, lyric
		// the vertical order of elements that are below is: lyric, chord, volume/dynamic
		var positionY = {
			tempoHeightAbove: 0,
			partHeightAbove: 0,
			volumeHeightAbove: 0,
			dynamicHeightAbove: 0,
			endingHeightAbove: 0,
			chordHeightAbove: 0,
			lyricHeightAbove: 0,

			lyricHeightBelow: 0,
			chordHeightBelow: 0,
			volumeHeightBelow: 0,
			dynamicHeightBelow: 0
		};

		if (/*ABCJS.write.debugPlacement*/false) {
			staff.originalTop = staff.top; // This is just being stored for debugging purposes.
			staff.originalBottom = staff.bottom; // This is just being stored for debugging purposes.
		}

		if (staff.specialY.lyricHeightAbove) { staff.top += staff.specialY.lyricHeightAbove; positionY.lyricHeightAbove = staff.top; }
		if (staff.specialY.chordHeightAbove) { staff.top += staff.specialY.chordHeightAbove; positionY.chordHeightAbove = staff.top; }
		if (staff.specialY.endingHeightAbove) {
			if (staff.specialY.chordHeightAbove)
				staff.top += 2;
			else
				staff.top += staff.specialY.endingHeightAbove;
			positionY.endingHeightAbove = staff.top;
		}
		if (staff.specialY.dynamicHeightAbove && staff.specialY.volumeHeightAbove) {
			staff.top += Math.max(staff.specialY.dynamicHeightAbove, staff.specialY.volumeHeightAbove);
			positionY.dynamicHeightAbove = staff.top;
			positionY.volumeHeightAbove = staff.top;
		} else if (staff.specialY.dynamicHeightAbove) {
			staff.top += staff.specialY.dynamicHeightAbove; positionY.dynamicHeightAbove = staff.top;
		} else if (staff.specialY.volumeHeightAbove) { staff.top += staff.specialY.volumeHeightAbove; positionY.volumeHeightAbove = staff.top; }
		if (staff.specialY.partHeightAbove) { staff.top += staff.specialY.partHeightAbove; positionY.partHeightAbove = staff.top; }
		if (staff.specialY.tempoHeightAbove) { staff.top += staff.specialY.tempoHeightAbove; positionY.tempoHeightAbove = staff.top; }

		if (staff.specialY.lyricHeightBelow) { positionY.lyricHeightBelow = staff.bottom; staff.bottom -= staff.specialY.lyricHeightBelow; }
		if (staff.specialY.chordHeightBelow) { positionY.chordHeightBelow = staff.bottom; staff.bottom -= staff.specialY.chordHeightBelow; }
		if (staff.specialY.volumeHeightBelow && staff.specialY.dynamicHeightBelow) {
			positionY.volumeHeightBelow = staff.bottom;
			positionY.dynamicHeightBelow = staff.bottom;
			staff.bottom -= Math.max(staff.specialY.volumeHeightBelow, staff.specialY.dynamicHeightBelow);
		} else if (staff.specialY.volumeHeightBelow) {
			positionY.volumeHeightBelow = staff.bottom; staff.bottom -= staff.specialY.volumeHeightBelow;
		} else if (staff.specialY.dynamicHeightBelow) {
			positionY.dynamicHeightBelow = staff.bottom; staff.bottom -= staff.specialY.dynamicHeightBelow;
		}

		if (/*ABCJS.write.debugPlacement*/false)
			staff.positionY = positionY; // This is just being stored for debugging purposes.

		for (var j = 0; j < staff.voices.length; j++) {
			var voice = this.voices[staff.voices[j]];
			voice.setUpperAndLowerElements(positionY);
		}
		// We might need a little space in between staves if the staves haven't been pushed far enough apart by notes or extra vertical stuff.
		// Only try to put in extra space if this isn't the top staff.
		if (lastStaffBottom !== undefined) {
			var thisStaffTop = staff.top - 10;
			var forcedSpacingBetween = lastStaffBottom + thisStaffTop;
			var minSpacingInPitches = renderer.spacing.systemStaffSeparation/spacing.STEP;
			var addedSpace = minSpacingInPitches - forcedSpacingBetween;
			if (addedSpace > 0)
				staff.top += addedSpace;
		}
		lastStaffBottom = 2 - staff.bottom; // the staff starts at position 2 and the bottom variable is negative. Therefore to find out how large the bottom is, we reverse the sign of the bottom, and add the 2 in.

		// Now we need a little margin on the top, so we'll just throw that in.
		//staff.top += 4;
		//console.log("Staff Y: ",i,heightInPitches,staff.top,staff.bottom);
	}
	//console.log("Staff Height: ",heightInPitches,this.height);
};

StaffGroupElement.prototype.finished = function() {
	for (var i=0;i<this.voices.length;i++) {
		if (!this.voices[i].layoutEnded()) return false;
	}
	return true;
};

function getLeftEdgeOfStaff(renderer, voices, brace) {
	var x = renderer.padding.left;

	// find out how much space will be taken up by voice headers
	var voiceheaderw = 0;
	for (var i=0;i<voices.length;i++) {
		if(voices[i].header) {
			var size = renderer.getTextSize(voices[i].header, 'voicefont', '');
			voiceheaderw = Math.max(voiceheaderw,size.width);
		}
	}
	if (voiceheaderw) {
		// Give enough spacing to the right - we use the width of an A for the amount of spacing.
		var sizeW = renderer.getTextSize("A", 'voicefont', '');
		voiceheaderw += sizeW.width;
	}
	x += voiceheaderw;

	if (brace) {
		brace.setLocation(x);
		x += brace.getWidth();
	}
	return x;
}

StaffGroupElement.prototype.layout = function(spacing, renderer, debug) {
	var epsilon = 0.0000001; // Fudging for inexactness of floating point math.
	var spacingunits = 0; // number of times we will have ended up using the spacing distance (as opposed to fixed width distances)
	var minspace = 1000; // a big number to start off with - used to find out what the smallest space between two notes is -- GD 2014.1.7

	var x = getLeftEdgeOfStaff(renderer, this.voices, this.brace);
	this.startx=x;
	var i;

	var currentduration = 0;
	if (debug) console.log("init layout", spacing);
	for (i=0;i<this.voices.length;i++) {
		this.voices[i].beginLayout(x);
	}

	var spacingunit = 0; // number of spacingunits coming from the previously laid out element to this one
	while (!this.finished()) {
		// find first duration level to be laid out among candidates across voices
		currentduration= null; // candidate smallest duration level
		for (i=0;i<this.voices.length;i++) {
			if (!this.voices[i].layoutEnded() && (!currentduration || this.voices[i].getDurationIndex()<currentduration))
				currentduration=this.voices[i].getDurationIndex();
		}


		// isolate voices at current duration level
		var currentvoices = [];
		var othervoices = [];
		for (i=0;i<this.voices.length;i++) {
			var durationIndex = this.voices[i].getDurationIndex();
			// PER: Because of the inexactness of JS floating point math, we just get close.
			if (durationIndex - currentduration > epsilon) {
				othervoices.push(this.voices[i]);
				//console.log("out: voice ",i);
			} else {
				currentvoices.push(this.voices[i]);
				//if (debug) console.log("in: voice ",i);
			}
		}

		// among the current duration level find the one which needs starting furthest right
		spacingunit = 0; // number of spacingunits coming from the previously laid out element to this one
		var spacingduration = 0;
		for (i=0;i<currentvoices.length;i++) {
			//console.log("greatest spacing unit", x, currentvoices[i].getNextX(), currentvoices[i].getSpacingUnits(), currentvoices[i].spacingduration);
			if (currentvoices[i].getNextX()>x) {
				x=currentvoices[i].getNextX();
				spacingunit=currentvoices[i].getSpacingUnits();
				spacingduration = currentvoices[i].spacingduration;
			}
		}
		spacingunits+=spacingunit;
		minspace = Math.min(minspace,spacingunit);
		if (debug) console.log("currentduration: ",currentduration, spacingunits, minspace);

		for (i=0;i<currentvoices.length;i++) {
			var voicechildx = currentvoices[i].layoutOneItem(x,spacing);
			var dx = voicechildx-x;
			if (dx>0) {
				x = voicechildx; //update x
				for (var j=0;j<i;j++) { // shift over all previously laid out elements
					currentvoices[j].shiftRight(dx);
				}
			}
		}

		// remove the value of already counted spacing units in other voices (e.g. if a voice had planned to use up 5 spacing units but is not in line to be laid out at this duration level - where we've used 2 spacing units - then we must use up 3 spacing units, not 5)
		for (i=0;i<othervoices.length;i++) {
			othervoices[i].spacingduration-=spacingduration;
			othervoices[i].updateNextX(x,spacing); // adjust other voices expectations
		}

		// update indexes of currently laid out elems
		for (i=0;i<currentvoices.length;i++) {
			var voice = currentvoices[i];
			voice.updateIndices();
		}
	} // finished laying out


	// find the greatest remaining x as a base for the width
	for (i=0;i<this.voices.length;i++) {
		if (this.voices[i].getNextX()>x) {
			x=this.voices[i].getNextX();
			spacingunit=this.voices[i].getSpacingUnits();
		}
	}
	//console.log("greatest remaining",spacingunit,x);
	spacingunits+=spacingunit;
	this.w = x;

	for (i=0;i<this.voices.length;i++) {
		this.voices[i].w=this.w;
	}
	return { spacingUnits: spacingunits, minSpace: minspace };
};

StaffGroupElement.prototype.calcHeight = function () {
	// the height is calculated here in a parallel way to the drawing below in hopes that both of these functions will be modified together.
	// TODO-PER: also add the space between staves. (That's systemStaffSeparation, which is the minimum distance between the staff LINES.)
	var height = 0;
	for (var i=0;i<this.voices.length;i++) {
		var staff = this.voices[i].staff;
		if (!this.voices[i].duplicate) {
			height += staff.top;
			if (staff.bottom < 0)
				height += -staff.bottom;
		}
	}
	return height;
};

StaffGroupElement.prototype.draw = function (renderer) {
	// We enter this method with renderer.y pointing to the topmost coordinate that we're allowed to draw.
	// All of the children that will be drawn have a relative "pitch" set, where zero is the first ledger line below the staff.
	// renderer.y will be offset at the beginning of each staff by the amount required to make the relative pitch work.
	// If there are multiple staves, then renderer.y will be incremented for each new staff.

	var debugPrint;
	var colorIndex;
	if (/*ABCJS.write.debugPlacement*/false) {
		var colors = [ "rgb(207,27,36)", "rgb(168,214,80)", "rgb(110,161,224)", "rgb(191,119,218)", "rgb(195,30,151)",
			"rgb(31,170,177)", "rgb(220,166,142)" ];
		debugPrint = function(staff, key) {
			if (staff.positionY[key]) {
				//renderer.printHorizontalLine(50, renderer.calcY(staff.positionY[key]), key.substr(0, 4) + " " + Math.round(staff.positionY[key]));
				var height = staff.specialY[key] * spacing.STEP;
				renderer.printShadedBox(renderer.padding.left, renderer.calcY(staff.positionY[key]), renderer.controller.width, height,colors[colorIndex], 0.4, key.substr(0, 4));
				colorIndex += 1; if (colorIndex > 6) colorIndex = 0;
			}
		};
	}

	// An invisible marker is useful to be able to find where each system starts.
	renderer.addInvisibleMarker("abcjs-top-of-system");

	var startY = renderer.y; // So that it can be restored after we're done.
	// Set the absolute Y position for each staff here, so the voice drawing below can just use if.
	for (var j = 0; j < this.staffs.length; j++) {
		var staff1 = this.staffs[j];
		//renderer.printHorizontalLine(50, renderer.y, "start");
		renderer.moveY(spacing.STEP, staff1.top);
		staff1.absoluteY = renderer.y;
		if (/*ABCJS.write.debugPlacement*/false) {
			colorIndex = 0;
			renderer.printShadedBox(renderer.padding.left, renderer.calcY(staff1.originalTop), renderer.controller.width, renderer.calcY(staff1.originalBottom)-renderer.calcY(staff1.originalTop), "#000000", 0.1);
			debugPrint(staff1, 'chordHeightAbove');
			debugPrint(staff1, 'chordHeightBelow');
			debugPrint(staff1, 'dynamicHeightAbove');
			debugPrint(staff1, 'dynamicHeightBelow');
			debugPrint(staff1, 'endingHeightAbove');
			debugPrint(staff1, 'lyricHeightAbove');
			debugPrint(staff1, 'lyricHeightBelow');
			debugPrint(staff1, 'partHeightAbove');
			debugPrint(staff1, 'tempoHeightAbove');
			debugPrint(staff1, 'volumeHeightAbove');
			debugPrint(staff1, 'volumeHeightBelow');
		}
		if (staff1.bottom < 0)
			renderer.moveY(spacing.STEP, -staff1.bottom);
	}
	var topLine; // these are to connect multiple staves. We need to remember where they are.
	var bottomLine;

	var bartop = 0;
	renderer.measureNumber = null;
	renderer.noteNumber = null;
	for (var i=0;i<this.voices.length;i++) {
		var staff = this.voices[i].staff;
		renderer.y = staff.absoluteY;
		renderer.voiceNumber = i;
		//renderer.y = staff.y;
		// offset for starting the counting at middle C
		if (!this.voices[i].duplicate) {
//			renderer.moveY(spacing.STEP, staff.top);
			if (!topLine) topLine  = renderer.calcY(10);
			bottomLine  = renderer.calcY(2);
			if (staff.lines !== 0) {
				renderer.measureNumber = null;
				renderer.noteNumber = null;
				renderer.printStave(this.startx, this.w, staff.lines);
			}
		}
		this.voices[i].draw(renderer, bartop);
		renderer.measureNumber = null;
		renderer.noteNumber = null;
		if (!this.voices[i].duplicate) {
			bartop = renderer.calcY(2); // This connects the bar lines between two different staves.
//			if (staff.bottom < 0)
//				renderer.moveY(spacing.STEP, -staff.bottom);
		}
		if(this.brace) {//Tony
			if (i === this.brace.length - 1) {
				if (this.brace) {
					this.brace.draw(renderer, topLine, bottomLine); //tony
				}
			}
		}
	}
	renderer.measureNumber = null;
	renderer.noteNumber = null;

	// connect all the staves together with a vertical line
	if (this.staffs.length>1) {
		renderer.printStem(this.startx, 0.6, topLine, bottomLine);
	}
	renderer.y = startY;
};

module.exports = StaffGroupElement;

},{"./abc_spacing":32}],34:[function(require,module,exports){
//    abc_tempo_element.js: Definition of the TempoElement class.
//    Copyright (C) 2014-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var AbsoluteElement = require('./abc_absolute_element');
var RelativeElement = require('./abc_relative_element');

var TempoElement;
(function() {
	"use strict";
	var totalHeightInPitches = 5;

	TempoElement = function TempoElement(tempo, tuneNumber, createNoteHead) {
		this.tempo = tempo;
		this.tuneNumber = tuneNumber;
		this.tempoHeightAbove = totalHeightInPitches;
		this.pitch = undefined; // This will be set later
		if (this.tempo.duration && !this.tempo.suppressBpm) {
			this.note = this.createNote(createNoteHead, tempo, tuneNumber);
		}
	};

	TempoElement.prototype.setUpperAndLowerElements = function(positionY) { // TODO-PER: This might not be called.
		this.pitch = positionY.tempoHeightAbove;
		this.top = positionY.tempoHeightAbove;
		this.bottom = positionY.tempoHeightAbove;
		if (this.note) {
			var tempoPitch = this.pitch - totalHeightInPitches + 1; // The pitch we receive is the top of the allotted area: change that to practically the bottom.
			this.note.top = tempoPitch;
			this.note.bottom = tempoPitch;
			for (var i = 0; i < this.note.children.length; i++) {
				var child = this.note.children[i];
				child.top += tempoPitch;
				child.bottom += tempoPitch;
				child.pitch += tempoPitch;
				if (child.pitch2 !== undefined)
					child.pitch2 += tempoPitch;
			}
		}
	};

	TempoElement.prototype.setX = function (x) {
		this.x = x;
	};

	TempoElement.prototype.createNote = function(createNoteHead, tempo, tuneNumber) {
		var temposcale = 0.75;
		var duration = tempo.duration[0]; // TODO when multiple durations
		var absElem = new AbsoluteElement(tempo, duration, 1, 'tempo', tuneNumber);
		// There aren't an infinite number of note values, but we are passed a float, so just in case something is off upstream,
		// merge all of the in between points.
		var dot;
		var flag;
		var note;
		if (duration <= 1/32) { note = "noteheads.quarter"; flag = "flags.u32nd"; dot = 0; }
		else if (duration <= 1/16) { note = "noteheads.quarter"; flag = "flags.u16th"; dot = 0; }
		else if (duration <= 3/32) { note = "noteheads.quarter"; flag = "flags.u16nd"; dot = 1; }
		else if (duration <= 1/8) { note = "noteheads.quarter"; flag = "flags.u8th"; dot = 0; }
		else if (duration <= 3/16) { note = "noteheads.quarter"; flag = "flags.u8th"; dot = 1; }
		else if (duration <= 1/4) { note = "noteheads.quarter"; dot = 0; }
		else if (duration <= 3/8) { note = "noteheads.quarter"; dot = 1; }
		else if (duration <= 1/2) { note = "noteheads.half"; dot = 0; }
		else if (duration <= 3/4) { note = "noteheads.half"; dot = 1; }
		else if (duration <= 1) { note = "noteheads.whole"; dot = 0; }
		else if (duration <= 1.5) { note = "noteheads.whole"; dot = 1; }
		else if (duration <= 2) { note = "noteheads.dbl"; dot = 0; }
		else { note = "noteheads.dbl"; dot = 1; }

		var ret = createNoteHead(absElem,
			note,
			{ verticalPos: 0}, // This is just temporary: we'll offset the vertical positioning when we get the actual vertical spot.
			"up",
			0,
			0,
			flag,
			dot,
			0,
			temposcale
		);
		var tempoNote = ret.notehead;
		absElem.addHead(tempoNote);
		var stem;
		if (note !== "noteheads.whole" && note !== "noteheads.dbl") {
			var p1 = 1 / 3 * temposcale;
			var p2 = 7 * temposcale;
			var dx = tempoNote.dx + tempoNote.w;
			var width = -0.6;
			stem = new RelativeElement(null, dx, 0, p1, {"type": "stem", "pitch2": p2, linewidth: width});
			absElem.addExtra(stem);
		}
		return absElem;
	};

	TempoElement.prototype.draw = function(renderer) {
		var x = this.x;
		if (this.pitch === undefined)
			window.console.error("Tempo Element y-coordinate not set.");

		var y = renderer.calcY(this.pitch);
		var text;
		if (this.tempo.preString) {
			text = renderer.renderText(x, y, this.tempo.preString, 'tempofont', 'tempo', "start");
			var preWidth = text.getBBox().width;
			var charWidth = preWidth / this.tempo.preString.length; // Just get some average number to increase the spacing.
			x += preWidth + charWidth;
		}
		if (this.note) {
			if (this.note)
				this.note.setX(x);
			for (var i = 0; i < this.note.children.length; i++)
				this.note.children[i].draw(renderer, x);
			x += (this.note.w + 5);
			var str = "= " + this.tempo.bpm;
			text = renderer.renderText(x, y, str, 'tempofont', 'tempo', "start");
			var postWidth = text.getBBox().width;
			var charWidth2 = postWidth / str.length; // Just get some average number to increase the spacing.
			x += postWidth + charWidth2;
		}
		if (this.tempo.postString) {
			renderer.renderText(x, y, this.tempo.postString, 'tempofont', 'tempo', "start");
		}
	};
})();

module.exports = TempoElement;

},{"./abc_absolute_element":17,"./abc_relative_element":30}],35:[function(require,module,exports){
//    abc_tie_element.js: Definition of the TieElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var TieElem = function TieElem(anchor1, anchor2, above, forceandshift, isTie) {
	this.anchor1 = anchor1; // must have a .x and a .pitch, and a .parent property or be null (means starts at the "beginning" of the line - after keysig)
	this.anchor2 = anchor2; // must have a .x and a .pitch property or be null (means ends at the end of the line)
	this.above = above; // true if the arc curves above
	this.force = forceandshift; // force the arc curve, regardless of beaming if true
	this.isTie = isTie;
};

TieElem.prototype.setEndAnchor = function(anchor2) {
	this.anchor2 = anchor2; // must have a .x and a .pitch property or be null (means ends at the end of the line)
	if (this.isTie) {
		if (this.anchor1) // this can happen if the tie comes from the previous line.
			this.anchor1.isTie = true;
		if (this.anchor2) // this can happen if the tie goes to the next line.
			this.anchor2.isTie = true;
	}
};

// If we encounter a repeat sign, then we don't want to extend either a tie or a slur past it, so these are called to be a limit.
TieElem.prototype.setStartX = function(startLimitElem) {
	this.startLimitX = startLimitElem;
};

TieElem.prototype.setEndX = function(endLimitElem) {
	this.endLimitX = endLimitElem;
};

TieElem.prototype.setHint = function () {
	this.hint = true;
};

TieElem.prototype.setUpperAndLowerElements = function(positionY) {
	// Doesn't depend on the highest and lowest, so there's nothing to do here.
};

TieElem.prototype.layout = function (lineStartX, lineEndX) {
	function getPitch(anchor, isAbove, isTie) {
		if (isTie) {
			// Always go to the note
			return anchor.pitch;
		}
		if (isAbove && anchor.highestVert !== undefined)
			return anchor.highestVert;
		return anchor.pitch;
	}
	// We now have all of the input variables set, so we can figure out the start and ending x,y coordinates, and finalize the direction of the arc.

	// PER: We might have to override the natural slur direction if the first and last notes are not in the
	// same direction. We always put the slur up in this case. The one case that works out wrong is that we always
	// want the slur to be up when the last note is stem down. We can tell the stem direction if the top is
	// equal to the pitch: if so, there is no stem above it.
	if (!this.force && this.anchor2 && this.anchor2.pitch === this.anchor2.highestVert) // TODO-PER: this is a fragile way to detect that there is no stem going up on this note.
		this.above = true;

	// There is an exception in the slur direction if there is also a tie on the starting or ending note.
	if (this.isTie) {
		if (this.anchor1) // this can happen if the tie comes from the previous line.
			this.anchor1.tieAbove = this.above;
		if (this.anchor2) // this can happen if the tie goes to the next line.
			this.anchor2.tieAbove = this.above;
	} else {
		if (this.anchor2 && this.anchor2.isTie)
			this.above = this.anchor2.tieAbove;
		else if (this.anchor1 && this.anchor1.isTie)
			this.above = this.anchor1.tieAbove;
	}
	if (this.anchor1) {
		this.startX = this.anchor1.x; // The normal case where there is a starting element to attach to.
		if (this.anchor1.scalex < 1) // this is a grace note - don't offset the tie as much.
			this.startX -= 3;
	} else if (this.startLimitX)
		this.startX = this.startLimitX.x+this.startLimitX.w; // if there is no start element, but there is a repeat mark before the start of the line.
	else
		this.startX = lineStartX; // There is no element and no repeat mark: extend to the beginning of the line.

	if (this.anchor2)
		this.endX = this.anchor2.x; // The normal case where there is a starting element to attach to.
	else if (this.endLimitX)
		this.endX = this.endLimitX.x; // if there is no start element, but there is a repeat mark before the start of the line.
	else
		this.endX = lineEndX; // There is no element and no repeat mark: extend to the beginning of the line.

	// For the pitches, if one of the anchors is present, both of the pitches are that anchor. If both are present, then we use both. If neither is present, we use the top of the staff.
	if (this.anchor1 && this.anchor2) {
		this.startY = getPitch(this.anchor1, this.above, this.isTie);
		this.endY = getPitch(this.anchor2, this.above, this.isTie);
	} else if (this.anchor1) {
		this.startY = getPitch(this.anchor1, this.above, this.isTie);
		this.endY = getPitch(this.anchor1, this.above, this.isTie);
	} else if (this.anchor2) {
		this.startY = getPitch(this.anchor2, this.above, this.isTie);
		this.endY = getPitch(this.anchor2, this.above, this.isTie);
	} else {
		// This is the case where the slur covers the entire line.
		// TODO-PER: figure out where the real top and bottom of the line are.
		this.startY = this.above ? 14 : 0;
		this.endY = this.above ? 14 : 0;
	}
};

TieElem.prototype.draw = function (renderer, linestartx, lineendx) {
	this.layout(linestartx, lineendx);

	var klass;
	if (this.hint)
			klass = "abcjs-hint";
	renderer.drawArc(this.startX, this.endX, this.startY, this.endY,  this.above, klass, this.isTie);

};

module.exports = TieElem;

},{}],36:[function(require,module,exports){
//    abc_triplet_element.js: Definition of the TripletElem class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var sprintf = require('./sprintf');

var TripletElem;

(function() {
	"use strict";

	TripletElem = function TripletElem(number, anchor1) {
		this.anchor1 = anchor1; // must have a .x and a .parent property or be null (means starts at the "beginning" of the line - after key signature)
		this.number = number;
		this.duration = (''+anchor1.parent.durationClass).replace(/\./, '-');
	};

	TripletElem.prototype.isClosed = function() {
		return this.anchor2;
	};

	TripletElem.prototype.setCloseAnchor = function(anchor2) {
		this.anchor2 = anchor2;
		// TODO-PER: Unfortunately, I don't know if there is a beam above until after the vertical positioning is done,
		// so I don't know whether to leave room for the number above. Therefore, If there is a beam on the first note, I'll leave room just in case.
		if (this.anchor1.parent.beam)
			this.endingHeightAbove = 4;
	};

	TripletElem.prototype.setUpperAndLowerElements = function(/*positionY*/) {
	};

	TripletElem.prototype.layout = function() {
		// TODO end and beginning of line (PER: P.S. I'm not sure this can happen: I think the parser will always specify both the start and end points.)
		if (this.anchor1 && this.anchor2) {
			this.hasBeam = this.anchor1.parent.beam && this.anchor1.parent.beam === this.anchor2.parent.beam;

			if (this.hasBeam) {
				// If there is a beam then we don't need to draw anything except the text. The beam could either be above or below.
				var beam = this.anchor1.parent.beam;
				var left = beam.isAbove() ? this.anchor1.x + this.anchor1.w : this.anchor1.x;
				this.yTextPos = beam.heightAtMidpoint(left,  this.anchor2.x);
				this.yTextPos += beam.isAbove() ? 4 : -4; // This creates some space between the beam and the number.
				if (beam.isAbove())
					this.endingHeightAbove = 4;
			} else {
				// If there isn't a beam, then we need to draw the bracket and the text. The bracket is always above.
				// The bracket is never lower than the 'a' line, but is 4 pitches above the first and last notes. If there is
				// a tall note in the middle, the bracket is horizontal and above the highest note.
				this.startNote = Math.max(this.anchor1.parent.top, 9) + 4;
				this.endNote = Math.max(this.anchor2.parent.top, 9) + 4;
				// TODO-PER: Do the case where the middle note is really high.
				this.yTextPos = this.startNote + (this.endNote - this.startNote) / 2;
			}

		}
	};

	TripletElem.prototype.draw = function(renderer) {
		var xTextPos;
		if (this.hasBeam) {
			var left = this.anchor1.parent.beam.isAbove() ? this.anchor1.x + this.anchor1.w : this.anchor1.x;
			xTextPos = this.anchor1.parent.beam.xAtMidpoint(left, this.anchor2.x);
		} else {
			xTextPos = this.anchor1.x + (this.anchor2.x + this.anchor2.w - this.anchor1.x) / 2;
			drawBracket(renderer, this.anchor1.x, this.startNote, this.anchor2.x + this.anchor2.w, this.endNote, this.duration);
		}
		renderer.renderText(xTextPos, renderer.calcY(this.yTextPos), "" + this.number, 'tripletfont', renderer.addClasses('triplet d'+this.duration), "middle", true);
	};

	function drawLine(renderer, l, t, r, b, duration) {
		var pathString = sprintf("M %f %f L %f %f",
			l, t, r, b);
		renderer.printPath({path: pathString, stroke: "#000000", 'class': renderer.addClasses('triplet d'+duration)});
	}

	function drawBracket(renderer, x1, y1, x2, y2, duration) {
		y1 = renderer.calcY(y1);
		y2 = renderer.calcY(y2);
		var bracketHeight = 5;

		// Draw vertical lines at the beginning and end
		drawLine(renderer, x1, y1, x1, y1 + bracketHeight, duration);
		drawLine(renderer, x2, y2, x2, y2 + bracketHeight, duration);

		// figure out midpoints to draw the broken line.
		var midX = x1 + (x2-x1)/2;
		//var midY = y1 + (y2-y1)/2;
		var gapWidth = 8;
		var slope = (y2 - y1) / (x2 - x1);
		var leftEndX = midX - gapWidth;
		var leftEndY = y1 + (leftEndX - x1) * slope;
		drawLine(renderer, x1, y1, leftEndX, leftEndY, duration);
		var rightStartX = midX + gapWidth;
		var rightStartY = y1 + (rightStartX - x1) * slope;
		drawLine(renderer, rightStartX, rightStartY, x2, y2, duration);
	}
})();

module.exports = TripletElem;

},{"./sprintf":38}],37:[function(require,module,exports){
//    abc_voice_element.js: Definition of the VoiceElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

var parseCommon = require('../parse/abc_common');

var VoiceElement = function VoiceElement(voicenumber, voicetotal) {
	this.children = [];
	this.beams = [];
	this.otherchildren = []; // ties, slurs, triplets
	this.w = 0;
	this.duplicate = false;
	this.voicenumber = voicenumber; //number of the voice on a given stave (not staffgroup)
	this.voicetotal = voicetotal;
	this.bottom = 7;
	this.top = 7;
	this.specialY = {
		tempoHeightAbove: 0,
		partHeightAbove: 0,
		volumeHeightAbove: 0,
		dynamicHeightAbove: 0,
		endingHeightAbove: 0,
		chordHeightAbove: 0,
		lyricHeightAbove: 0,

		lyricHeightBelow: 0,
		chordHeightBelow: 0,
		volumeHeightBelow: 0,
		dynamicHeightBelow: 0
	};
};

VoiceElement.prototype.addChild = function (child) {
	if (child.type === 'bar') {
		var firstItem = true;
		for (var i = 0; firstItem && i < this.children.length; i++) {
			if (this.children[i].type !== "staff-extra")
				firstItem = false;
		}
		if (!firstItem) {
			this.beams.push("bar");
			this.otherchildren.push("bar");
		}
	}
	this.children[this.children.length] = child;
	this.setRange(child);
};

VoiceElement.prototype.setLimit = function(member, child) {
	// Sometimes we get an absolute element in here and sometimes we get some type of relative element.
	// If there is a "specialY" element, then assume it is an absolute element. If that doesn't exist, look for the
	// same members at the top level, because that's where they are in relative elements.
	var specialY = child.specialY;
	if (!specialY) specialY = child;
	if (!specialY[member]) return;
	if (!this.specialY[member])
		this.specialY[member] = specialY[member];
	else
		this.specialY[member] = Math.max(this.specialY[member], specialY[member]);
};

VoiceElement.prototype.moveDecorations = function(beam) {
	var padding = 1.5; // This is the vertical padding between elements, in pitches.
	for (var ch = 0; ch < beam.elems.length; ch++) {
		var child = beam.elems[ch];
		if (child.top) {
			// We now know where the ornaments should have been placed, so move them if they would overlap.
			var top = beam.yAtNote(child);
			for (var i = 0; i < child.children.length; i++) {
				var el = child.children[i];
				if (el.klass === 'ornament') {
					if (el.bottom - padding < top) {
						var distance = top - el.bottom + padding; // Find the distance that it needs to move and add a little margin so the element doesn't touch the beam.
						el.bottom += distance;
						el.top += distance;
						el.pitch += distance;
						top = child.top = el.top;
					}
				}
			}
		}
	}
};

VoiceElement.prototype.adjustRange = function(child) {
	if (child.bottom !== undefined)
		this.bottom = Math.min(this.bottom, child.bottom);
	if (child.top !== undefined)
		this.top = Math.max(this.top, child.top);
};

VoiceElement.prototype.setRange = function(child) {
	this.adjustRange(child);
	this.setLimit('tempoHeightAbove', child);
	this.setLimit('partHeightAbove', child);
	this.setLimit('volumeHeightAbove', child);
	this.setLimit('dynamicHeightAbove', child);
	this.setLimit('endingHeightAbove', child);
	this.setLimit('chordHeightAbove', child);
	this.setLimit('lyricHeightAbove', child);
	this.setLimit('lyricHeightBelow', child);
	this.setLimit('chordHeightBelow', child);
	this.setLimit('volumeHeightBelow', child);
	this.setLimit('dynamicHeightBelow', child);
};

VoiceElement.prototype.setUpperAndLowerElements = function(positionY) {
	var i;
	for (i = 0; i < this.children.length; i++) {
		var abselem = this.children[i];
		abselem.setUpperAndLowerElements(positionY);
	}
	for (i = 0; i < this.otherchildren.length; i++) {
		var abselem = this.otherchildren[i];
		if (typeof abselem !== 'string')
			abselem.setUpperAndLowerElements(positionY);
	}
};

VoiceElement.prototype.addOther = function (child) {
	this.otherchildren.push(child);
	this.setRange(child);
};

VoiceElement.prototype.addBeam = function (child) {
	this.beams.push(child);
};

VoiceElement.prototype.updateIndices = function () {
	if (!this.layoutEnded()) {
		this.durationindex += this.children[this.i].duration;
		if (this.children[this.i].duration===0) this.durationindex = Math.round(this.durationindex*64)/64; // everytime we meet a barline, do rounding to nearest 64th
		this.i++;
	}
};

VoiceElement.prototype.layoutEnded = function () {
	return (this.i>=this.children.length);
};

VoiceElement.prototype.getDurationIndex = function () {
	return this.durationindex - (this.children[this.i] && (this.children[this.i].duration>0)?0:0.0000005); // if the ith element doesn't have a duration (is not a note), its duration index is fractionally before. This enables CLEF KEYSIG TIMESIG PART, etc. to be laid out before we get to the first note of other voices
};

// number of spacing units expected for next positioning
VoiceElement.prototype.getSpacingUnits = function () {
	return Math.sqrt(this.spacingduration*8);
	// TODO-PER: On short lines, this would never trigger, so the spacing was wrong. I just changed this line empirically, though, so I don't know if there are other ramifications.
	//return (this.minx<this.nextx) ? Math.sqrt(this.spacingduration*8) : 0; // we haven't used any spacing units if we end up using minx
};

//
VoiceElement.prototype.getNextX = function () {
	return Math.max(this.minx, this.nextx);
};

VoiceElement.prototype.beginLayout = function (startx) {
	this.i=0;
	this.durationindex=0;
	//this.ii=this.children.length;
	this.startx=startx;
	this.minx=startx; // furthest left to where negatively positioned elements are allowed to go
	this.nextx=startx; // x position where the next element of this voice should be placed assuming no other voices and no fixed width constraints
	this.spacingduration=0; // duration left to be laid out in current iteration (omitting additional spacing due to other aspects, such as bars, dots, sharps and flats)
};

// Try to layout the element at index this.i
// x - position to try to layout the element at
// spacing - base spacing
// can't call this function more than once per iteration
VoiceElement.prototype.layoutOneItem = function (x, spacing) {
	var child = this.children[this.i];
	if (!child) return 0;
	var er = x - this.minx; // available extrawidth to the left
	if (er<child.getExtraWidth()) { // shift right by needed amount
		x+=child.getExtraWidth()-er;
	}
	child.setX(x);

	this.spacingduration = child.duration;
	//update minx
	this.minx = x+child.getMinWidth(); // add necessary layout space
	if (this.i!==this.children.length-1) this.minx+=child.minspacing; // add minimumspacing except on last elem

	this.updateNextX(x, spacing);

	// contribute to staff y position
	//this.staff.top = Math.max(child.top,this.staff.top);
	//this.staff.bottom = Math.min(child.bottom,this.staff.bottom);

	return x; // where we end up having placed the child
};

// call when spacingduration has been updated
VoiceElement.prototype.updateNextX = function (x, spacing) {
	this.nextx= x + (spacing*Math.sqrt(this.spacingduration*8));
};

VoiceElement.prototype.shiftRight = function (dx) {
	var child = this.children[this.i];
	if (!child) return;
	child.setX(child.x+dx);
	this.minx+=dx;
	this.nextx+=dx;
};

function isNonSpacerRest(elem) {
	if (elem.type !== 'rest')
		return false;
	if (elem.abcelem && elem.abcelem.rest && elem.abcelem.rest.type !== 'spacer')
		return true;
	return false;
}
VoiceElement.prototype.draw = function (renderer, bartop) {
	var width = this.w-1;
	renderer.staffbottom = this.staff.bottom;
	//this.barbottom = renderer.calcY(2);

	renderer.measureNumber = null;
	renderer.noteNumber = null;
	if (this.header) { // print voice name
		var textpitch = 14 - (this.voicenumber+1)*(12/(this.voicetotal+1));
		renderer.renderText(renderer.padding.left, renderer.calcY(textpitch), this.header, 'voicefont', 'staff-extra voice-name', 'start');
	}

	for (var i=0, ii=this.children.length; i<ii; i++) {
		var child = this.children[i];
		var justInitializedMeasureNumber = false;
		if (child.type !== 'staff-extra' && renderer.measureNumber === null) {
			renderer.measureNumber = 0;
			renderer.noteNumber = 0;
			justInitializedMeasureNumber = true;
		}
		child.draw(renderer, (this.barto || i===ii-1)?bartop:0);
		if (child.type === 'note' || isNonSpacerRest(child))
			renderer.noteNumber++;
		if (child.type === 'bar' && !justInitializedMeasureNumber) {
			renderer.measureNumber++;
			renderer.noteNumber = 0;
		}
	}

	renderer.measureNumber = 0;
	renderer.noteNumber = 0;
	parseCommon.each(this.beams, function(beam) {
		if (beam === 'bar') {
			renderer.measureNumber++;
			renderer.noteNumber = 0;
		} else
			beam.draw(renderer); // beams must be drawn first for proper printing of triplets, slurs and ties.
	});

	renderer.measureNumber = 0;
	renderer.noteNumber = 0;
	var self = this;
	parseCommon.each(this.otherchildren, function(child) {
		if (child === 'bar') {
			renderer.measureNumber++;
			renderer.noteNumber = 0;
		} else
			child.draw(renderer,self.startx+10,width);
	});

};

VoiceElement.prototype.layoutBeams = function() {
	for (var i = 0; i < this.beams.length; i++) {
		if (this.beams[i].layout) {
			this.beams[i].layout();
			this.moveDecorations(this.beams[i]);
			// The above will change the top and bottom of the abselem children, so see if we need to expand our range.
			for (var j = 0; j < this.beams[i].elems.length; j++) {
				this.adjustRange(this.beams[i].elems[j]);
			}
		}
	}
	// Now we can layout the triplets
	for (i = 0; i < this.otherchildren.length; i++) {
		var child = this.otherchildren[i];
		if (child.layout)
			child.layout();
	}
	this.staff.top = Math.max(this.staff.top, this.top);
	this.staff.bottom = Math.min(this.staff.bottom, this.bottom);
};

module.exports = VoiceElement;

},{"../parse/abc_common":9}],38:[function(require,module,exports){
/**
 * sprintf() for JavaScript v.0.4
 *
 Copyright (c) 2007-present, Alexandru Mărășteanu <hello@alexei.ro>
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are met:
 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above copyright
 notice, this list of conditions and the following disclaimer in the
 documentation and/or other materials provided with the distribution.
 * Neither the name of this software nor the names of its contributors may be
 used to endorse or promote products derived from this software without
 specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 DISCLAIMED. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR
 ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

//function str_repeat(i, m) { for (var o = []; m > 0; o[--m] = i); return(o.join('')); }

var sprintf = function() {
  var i = 0, a, f = arguments[i++], o = [], m, p, c, x;
  while (f) {
    if (m = /^[^\x25]+/.exec(f)) o.push(m[0]);
    else if (m = /^\x25{2}/.exec(f)) o.push('%');
    else if (m = /^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(f)) {
      if (((a = arguments[m[1] || i++]) == null) || (a == undefined)) throw("Too few arguments.");
      if (/[^s]/.test(m[7]) && (typeof(a) != 'number'))
        throw("Expecting number but found " + typeof(a));
      switch (m[7]) {
        case 'b': a = a.toString(2); break;
        case 'c': a = String.fromCharCode(a); break;
        case 'd': a = parseInt(a); break;
        case 'e': a = m[6] ? a.toExponential(m[6]) : a.toExponential(); break;
        case 'f': a = m[6] ? parseFloat(a).toFixed(m[6]) : parseFloat(a); break;
        case 'o': a = a.toString(8); break;
        case 's': a = ((a = String(a)) && m[6] ? a.substring(0, m[6]) : a); break;
        case 'u': a = Math.abs(a); break;
        case 'x': a = a.toString(16); break;
        case 'X': a = a.toString(16).toUpperCase(); break;
      }
      a = (/[def]/.test(m[7]) && m[2] && a > 0 ? '+' + a : a);
      c = m[3] ? m[3] == '0' ? '0' : m[3].charAt(1) : ' ';
      x = m[5] - String(a).length;
      p = m[5] ? str_repeat(c, x) : '';
      o.push(m[4] ? a + p : p + a);
    }
    else throw ("Huh ?!");
    f = f.substring(m[0].length);
  }
  return o.join('');
};

module.exports = sprintf;

},{}],39:[function(require,module,exports){
//    abc_voice_element.js: Definition of the VoiceElement class.
//    Copyright (C) 2010-2018 Gregory Dyke (gregdyke at gmail dot com) and Paul Rosen
//
//    Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
//    documentation files (the "Software"), to deal in the Software without restriction, including without limitation
//    the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
//    to permit persons to whom the Software is furnished to do so, subject to the following conditions:
//
//    The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
//
//    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING
//    BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
//    NON-INFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
//    DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
//    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

/*global module */

var svgNS = "http://www.w3.org/2000/svg";

function Svg(wrapper) {
	this.svg = createSvg();
	wrapper.appendChild(this.svg);
}

Svg.prototype.clear = function() {
	if (this.svg) {
		var wrapper = this.svg.parentNode;
		this.svg = createSvg();
		if (wrapper) {
			// TODO-PER: If the wrapper is not present, then the underlying div was pulled out from under this instance. It's possible that is still useful (for creating the music off page?)
			wrapper.innerHTML = "";
			wrapper.appendChild(this.svg);
		}
	}
};

Svg.prototype.setTitle = function(title) {
	var titleEl = document.createElement("title");
	var titleNode = document.createTextNode(title);
	titleEl.appendChild(titleNode);
	this.svg.insertBefore(titleEl, this.svg.firstChild);
};

Svg.prototype.setResponsiveWidth = function(w, h) {
	// this technique is from: http://thenewcode.com/744/Make-SVG-Responsive, thx to https://github.com/iantresman
	this.svg.setAttribute("viewBox", "0 0 " + w + " " + h);
	this.svg.setAttribute("preserveAspectRatio", "xMinYMin meet");
	this.svg.removeAttribute("height");
	this.svg.removeAttribute("width");
	this.svg.style['display'] = "inline-block";
	this.svg.style['position'] = "absolute";
	this.svg.style['top'] = "0";
	this.svg.style['left'] = "0";

	if (this.svg.parentNode) {
		var cls = this.svg.parentNode.getAttribute("class");
		if (!cls)
			this.svg.parentNode.setAttribute("class", "abcjs-container");
		else if (cls.indexOf("abcjs-container") < 0)
			this.svg.parentNode.setAttribute("class", cls + " abcjs-container");
		this.svg.parentNode.style['display'] = "inline-block";
		this.svg.parentNode.style['position'] = "relative";
		this.svg.parentNode.style['width'] = "100%";
		// PER: I changed the padding from 100% to this through trial and error.
		// The example was using a square image, but this music might be either wider or taller.
		var padding = h / w * 100;
		this.svg.parentNode.style['padding-bottom'] = padding + "%";
		this.svg.parentNode.style['vertical-align'] = "middle";
		this.svg.parentNode.style['overflow'] = "hidden";
	}
};

Svg.prototype.setSize = function(w, h) {
	this.svg.setAttribute('width', w);
	this.svg.setAttribute('height', h);
	// TODO-PER: Is this hack still needed?
	// Correct for IE problem in calculating height
	// var isIE = /*@cc_on!@*/false;//IE detector
	// if (isIE) {
	// 	this.paper.canvas.parentNode.style.width = w + "px";
	// 	this.paper.canvas.parentNode.style.height = "" + h + "px";
	// } else
	// 	this.paper.canvas.parentNode.setAttribute("style", "width:" + w + "px");
};

Svg.prototype.setScale = function(scale) {
	if (scale !== 1) {
		this.svg.style.transform = "scale("+scale+","+scale+")";
		this.svg.style['-ms-transform'] = "scale("+scale+","+scale+")";
		this.svg.style['-webkit-transform'] = "scale("+scale+","+scale+")";
		this.svg.style['transform-origin'] = "0 0";
		this.svg.style['-ms-transform-origin-x'] = "0";
		this.svg.style['-ms-transform-origin-y'] = "0";
		this.svg.style['-webkit-transform-origin-x'] = "0";
		this.svg.style['-webkit-transform-origin-y'] = "0";
	} else {
		this.svg.style.transform = "";
		this.svg.style['-ms-transform'] = "";
		this.svg.style['-webkit-transform'] = "";
	}
};

Svg.prototype.setParentStyles = function(attr) {
	// This is needed to get the size right when there is scaling involved.
	for (var key in attr) {
		if (attr.hasOwnProperty(key)) {
			if (this.svg.parentNode)
				this.svg.parentNode.style[key] = attr[key];
		}
	}
};

Svg.prototype.rect = function(attr) {
	var el = document.createElementNS(svgNS, "rect");
	for (var key in attr) {
		if (attr.hasOwnProperty(key)) {
			var tmp = "" + attr[key];
			if (tmp.indexOf("NaN") >= 0)
				debugger;
			el.setAttributeNS(null, key, attr[key]);
		}
	}
	this.append(el);
	return el;
};

Svg.prototype.text = function(text, attr) {
	var el = document.createElementNS(svgNS, 'text');
	for (var key in attr) {
		if (attr.hasOwnProperty(key)) {
			el.setAttribute(key, attr[key]);
		}
	}
	var lines = (""+text).split("\n");
	for (var i = 0; i < lines.length; i++) {
		var line = document.createElementNS(svgNS, 'tspan');
		line.textContent = lines[i];
		line.setAttribute("x", attr.x ? attr.x : 0);
		if (i !== 0)
			line.setAttribute("dy", "1.2em");
		el.appendChild(line);
	}
	this.append(el);
	return el;
};

Svg.prototype.getTextSize = function(text, attr) {
	var el = this.text(text, attr);
	var size = el.getBBox();
	if (isNaN(size.height)) // This can happen if the element isn't visible.
		size = { width: 0, height: 0};
	else
		size = { width: size.width, height: size.height };
	// TODO-PER: can the size be gotten without inserting and deleting the element?
	if (this.currentGroup)
		this.currentGroup.removeChild(el);
	else
		this.svg.removeChild(el);
	return size;
};

Svg.prototype.openGroup = function(options) {
	options = options ? options : {};
	var el = document.createElementNS(svgNS, "g");
	if (options.prepend)
		this.svg.insertBefore(el, this.svg.firstChild);
	else
		this.svg.appendChild(el);
	this.currentGroup = el;
	return el;
};

Svg.prototype.closeGroup = function() {
	var g = this.currentGroup;
	this.currentGroup = null;
	return g;
};

Svg.prototype.path = function(attr) {
	var el = document.createElementNS(svgNS, "path");
	for (var key in attr) {
		if (attr.hasOwnProperty(key)) {
			if (key === 'path')
				el.setAttributeNS(null, 'd', attr.path);
			else
				el.setAttributeNS(null, key, attr[key]);
		}
	}
	this.append(el);
	return el;
};

Svg.prototype.pathToBack = function(attr) {
	var el = document.createElementNS(svgNS, "path");
	for (var key in attr) {
		if (attr.hasOwnProperty(key)) {
			if (key === 'path')
				el.setAttributeNS(null, 'd', attr.path);
			else
				el.setAttributeNS(null, key, attr[key]);
		}
	}
	this.prepend(el);
	return el;
};

Svg.prototype.append = function(el) {
	if (this.currentGroup)
		this.currentGroup.appendChild(el);
	else
		this.svg.appendChild(el);
};

Svg.prototype.prepend = function(el) {
	// The entire group is prepended, so don't prepend the individual elements.
	if (this.currentGroup)
		this.currentGroup.appendChild(el);
	else
		this.svg.insertBefore(el, this.svg.firstChild);
};

Svg.prototype.setAttributeOnElement = function(el, attr) {
	for (var key in attr) {
		if (attr.hasOwnProperty(key)) {
			el.setAttributeNS(null, key, attr[key]);
		}
	}
};

function createSvg() {
	var svg = document.createElementNS(svgNS, "svg");
	svg.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xlink", "http://www.w3.org/1999/xlink");
	svg.setAttribute('role', 'img');    // for accessibility
	return svg;
}


module.exports = Svg;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJkaXN0L2NsaWVudC9hcHAuanMiLCJub2RlX21vZHVsZXMvYWJjanMvaW5kZXguanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL2FwaS9hYmNfYW5pbWF0aW9uLmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy9hcGkvYWJjX3RpbWluZ19jYWxsYmFja3MuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL2FwaS9hYmNfdHVuZWJvb2suanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL2FwaS9hYmNfdHVuZWJvb2tfc3ZnLmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy9kYXRhL2FiY190dW5lLmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy9lZGl0L2FiY19lZGl0b3IuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3BhcnNlL2FiY19jb21tb24uanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3BhcnNlL2FiY19wYXJzZS5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvcGFyc2UvYWJjX3BhcnNlX2RpcmVjdGl2ZS5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvcGFyc2UvYWJjX3BhcnNlX2hlYWRlci5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvcGFyc2UvYWJjX3BhcnNlX2tleV92b2ljZS5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvcGFyc2UvYWJjX3Rva2VuaXplci5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvcGFyc2UvYWJjX3RyYW5zcG9zZS5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvdHJhbnNmb3JtL2FiYzJhYmNfd3JpdGUuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3dyaXRlL2FiY19hYnNvbHV0ZV9lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfYWJzdHJhY3RfZW5ncmF2ZXIuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3dyaXRlL2FiY19iZWFtX2VsZW1lbnQuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3dyaXRlL2FiY19icmFjZV9lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfY3JlYXRlX2NsZWYuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3dyaXRlL2FiY19jcmVhdGVfa2V5X3NpZ25hdHVyZS5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX2NyZWF0ZV90aW1lX3NpZ25hdHVyZS5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX2NyZXNjZW5kb19lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfZGVjb3JhdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX2R5bmFtaWNfZGVjb3JhdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX2VuZGluZ19lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfZW5ncmF2ZXJfY29udHJvbGxlci5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX2dseXBocy5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX3JlbGF0aXZlX2VsZW1lbnQuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3dyaXRlL2FiY19yZW5kZXJlci5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX3NwYWNpbmcuanMiLCJub2RlX21vZHVsZXMvYWJjanMvc3JjL3dyaXRlL2FiY19zdGFmZl9ncm91cF9lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfdGVtcG9fZWxlbWVudC5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvYWJjX3RpZV9lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfdHJpcGxldF9lbGVtZW50LmpzIiwibm9kZV9tb2R1bGVzL2FiY2pzL3NyYy93cml0ZS9hYmNfdm9pY2VfZWxlbWVudC5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvc3ByaW50Zi5qcyIsIm5vZGVfbW9kdWxlcy9hYmNqcy9zcmMvd3JpdGUvc3ZnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FDQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdEJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsU0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwckNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsZUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hwREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDamhDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM2tCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDajNCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbnZCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU1BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9ZQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25RQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbFZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5WUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1TkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0S0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2MkJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbmJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNTQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uKCl7ZnVuY3Rpb24gcihlLG4sdCl7ZnVuY3Rpb24gbyhpLGYpe2lmKCFuW2ldKXtpZighZVtpXSl7dmFyIGM9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZTtpZighZiYmYylyZXR1cm4gYyhpLCEwKTtpZih1KXJldHVybiB1KGksITApO3ZhciBhPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIraStcIidcIik7dGhyb3cgYS5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGF9dmFyIHA9bltpXT17ZXhwb3J0czp7fX07ZVtpXVswXS5jYWxsKHAuZXhwb3J0cyxmdW5jdGlvbihyKXt2YXIgbj1lW2ldWzFdW3JdO3JldHVybiBvKG58fHIpfSxwLHAuZXhwb3J0cyxyLGUsbix0KX1yZXR1cm4gbltpXS5leHBvcnRzfWZvcih2YXIgdT1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLGk9MDtpPHQubGVuZ3RoO2krKylvKHRbaV0pO3JldHVybiBvfXJldHVybiByfSkoKSIsIlwidXNlIHN0cmljdFwiO1xuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xudmFyIGFiY2pzID0gcmVxdWlyZShcImFiY2pzXCIpO1xudmFyIFNDUkFQQk9YVVJMID0gXCJodHRwczovL3NjcmFwYm94LmlvL3N0ay1zdHVkeS1tdXNpYy10aGVvcnkvXCI7XG52YXIgaW5wdXRFbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWJjaW5wdXRcIik7XG52YXIgcGFyc2VMaW5rID0gZnVuY3Rpb24gKGFiYykge1xuICAgIHZhciBwYXJzZWRMaW5rcyA9IFtdO1xuICAgIHZhciBsaW5rTWFjaGVkID0gYWJjLm1hdGNoKC8lTGlua3M6LiovKTtcbiAgICBjb25zb2xlLmxvZyhcInBhcnNlTGlua1wiLCBcImxpbmtNYXRjaGVkXCIsIGxpbmtNYWNoZWQpO1xuICAgIGlmICghbGlua01hY2hlZCkge1xuICAgICAgICByZXR1cm4gW107XG4gICAgfVxuICAgIHZhciBsaW5rU3RyID0gbGlua01hY2hlZFswXS5yZXBsYWNlKC8lTGlua3M6LywgXCJcIik7XG4gICAgdmFyIGxpbmtzID0gbGlua1N0ci5zcGxpdChcIixcIik7XG4gICAgY29uc29sZS5sb2coXCJwYXJzZUxpbmtcIiwgXCJsaW5rc1wiLCBsaW5rcyk7XG4gICAgaWYgKGxpbmtzLmxlbmd0aCA8IDEpIHtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH1cbiAgICBmb3IgKHZhciBfaSA9IDAsIGxpbmtzXzEgPSBsaW5rczsgX2kgPCBsaW5rc18xLmxlbmd0aDsgX2krKykge1xuICAgICAgICB2YXIgbGluayA9IGxpbmtzXzFbX2ldO1xuICAgICAgICB2YXIgYXJyID0gbGluay5zcGxpdChcIiBcIik7XG4gICAgICAgIGlmIChhcnIubGVuZ3RoIDwgMilcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICBwYXJzZWRMaW5rcy5wdXNoKHsgc3RhcnRDaGFyOiBOdW1iZXIoYXJyWzBdKSwgcGFnZVRpdGxlOiBhcnJbMV0gfSk7XG4gICAgfVxuICAgIGNvbnNvbGUubG9nKFwicGFyc2VMaW5rXCIsIFwicGFyc2VkTGlua3NcIiwgcGFyc2VkTGlua3MpO1xuICAgIHJldHVybiBwYXJzZWRMaW5rcztcbn07XG52YXIgZ2VuZXJhdGVDbGlja0xpc3RlbmVyID0gZnVuY3Rpb24gKGxpbmtzKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIChhYmNFbGVtLCB0dW5lTnVtYmVyLCBjbGFzc2VzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiYWJjQ2xpY2tMaXN0ZW5lclwiLCBhYmNFbGVtLCB0dW5lTnVtYmVyLCBjbGFzc2VzKTtcbiAgICAgICAgaWYgKCFhYmNFbGVtLmVsX3R5cGUgfHwgIWxpbmtzLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGZvciAodmFyIF9pID0gMCwgbGlua3NfMiA9IGxpbmtzOyBfaSA8IGxpbmtzXzIubGVuZ3RoOyBfaSsrKSB7XG4gICAgICAgICAgICB2YXIgbGluayA9IGxpbmtzXzJbX2ldO1xuICAgICAgICAgICAgaWYgKGxpbmsuc3RhcnRDaGFyID09PSBhYmNFbGVtLnN0YXJ0Q2hhcikge1xuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiYWJjQ2xpY2tMaXN0ZW5lclwiLCBcIkxpbmtlZCBub3RlIGlzIGNsaWNrZWQuXCIsIFwic3RhcnRDaGFyOlwiLCBsaW5rLnN0YXJ0Q2hhcik7XG4gICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oU0NSQVBCT1hVUkwgKyBsaW5rLnBhZ2VUaXRsZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufTtcbnZhciByZW5kZXIgPSBmdW5jdGlvbiAoYWJjLCBsaW5rcykge1xuICAgIHZhciBvcHRpb25zID0ge1xuICAgICAgICBjbGlja0xpc3RlbmVyOiBnZW5lcmF0ZUNsaWNrTGlzdGVuZXIobGlua3MpLFxuICAgICAgICBhZGRfY2xhc3NlczogdHJ1ZVxuICAgIH07XG4gICAgYWJjanMucmVuZGVyQWJjKFwic3Znb3V0cHV0XCIsIGFiYywgb3B0aW9ucyk7XG59O1xuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICB2YXIgQUJDID0gZS50YXJnZXQudmFsdWU7XG4gICAgcmVuZGVyKEFCQywgcGFyc2VMaW5rKEFCQykpO1xufSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAuanMubWFwIiwidmFyIGFuaW1hdGlvbiA9IHJlcXVpcmUoJy4vc3JjL2FwaS9hYmNfYW5pbWF0aW9uJyk7XG52YXIgdHVuZUJvb2sgPSByZXF1aXJlKCcuL3NyYy9hcGkvYWJjX3R1bmVib29rJyk7XG5cbnZhciBhYmNqcyA9IHt9O1xuXG5hYmNqcy5zaWduYXR1cmUgPSBcImFiY2pzLWJhc2ljIHY1LjMuMlwiO1xuXG5PYmplY3Qua2V5cyhhbmltYXRpb24pLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuXHRhYmNqc1trZXldID0gYW5pbWF0aW9uW2tleV07XG59KTtcblxuT2JqZWN0LmtleXModHVuZUJvb2spLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuXHRhYmNqc1trZXldID0gdHVuZUJvb2tba2V5XTtcbn0pO1xuXG5hYmNqcy5yZW5kZXJBYmMgPSByZXF1aXJlKCcuL3NyYy9hcGkvYWJjX3R1bmVib29rX3N2ZycpO1xuYWJjanMuVGltaW5nQ2FsbGJhY2tzID0gcmVxdWlyZSgnLi9zcmMvYXBpL2FiY190aW1pbmdfY2FsbGJhY2tzJyk7XG5cbnZhciBlZGl0b3IgPSByZXF1aXJlKCcuL3NyYy9lZGl0L2FiY19lZGl0b3InKTtcbmFiY2pzWydFZGl0b3InXSA9IGVkaXRvcjtcblxubW9kdWxlLmV4cG9ydHMgPSBhYmNqcztcbiIsIi8vICAgIGFiY19hbmltYXRpb24uanM6IGhhbmRsZXMgYW5pbWF0aW5nIHRoZSBtdXNpYyBpbiByZWFsIHRpbWUuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTQtMjAxOCBQYXVsIFJvc2VuIChwYXVsIGF0IHBhdWxyb3NlbiBkb3QgbmV0KVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgc3BhY2luZyA9IHJlcXVpcmUoJy4uL3dyaXRlL2FiY19zcGFjaW5nJyk7XG52YXIgcGFyc2VDb21tb24gPSByZXF1aXJlKCcuLi9wYXJzZS9hYmNfY29tbW9uJyk7XG52YXIgVGltaW5nQ2FsbGJhY2tzID0gcmVxdWlyZSgnLi9hYmNfdGltaW5nX2NhbGxiYWNrcycpO1xuXG52YXIgYW5pbWF0aW9uID0ge307XG5cbihmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0dmFyIHRpbWVyO1xuXHR2YXIgY3Vyc29yO1xuXHRhbmltYXRpb24uc3RhcnRBbmltYXRpb24gPSBmdW5jdGlvbihwYXBlciwgdHVuZSwgb3B0aW9ucykge1xuXHRcdC8vb3B0aW9ucy5icG1cblx0XHQvL29wdGlvbnMuc2hvd0N1cnNvclxuXHRcdC8vb3B0aW9ucy5oaWRlQ3VycmVudE1lYXN1cmVcblx0XHQvL29wdGlvbnMuaGlkZUZpbmlzaGVkTWVhc3VyZXNcblx0XHRpZiAodGltZXIpIHtcblx0XHRcdHRpbWVyLnN0b3AoKTtcblx0XHRcdHRpbWVyID0gdW5kZWZpbmVkO1xuXHRcdH1cblxuXHRcdGlmIChvcHRpb25zLnNob3dDdXJzb3IgJiYgIXBhcGVyLnF1ZXJ5U2VsZWN0b3IoJy5hYmNqcy1jdXJzb3InKSkge1xuXHRcdFx0Y3Vyc29yID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnRElWJyk7XG5cdFx0XHRjdXJzb3IuY2xhc3NOYW1lID0gJ2FiY2pzLWN1cnNvciBjdXJzb3InO1xuXHRcdFx0Y3Vyc29yLnN0eWxlLnBvc2l0aW9uID0gJ2Fic29sdXRlJztcblxuXHRcdFx0cGFwZXIuYXBwZW5kQ2hpbGQoY3Vyc29yKTtcblx0XHRcdHBhcGVyLnN0eWxlLnBvc2l0aW9uID0gJ3JlbGF0aXZlJztcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBoaWRlTWVhc3VyZXMoZWxlbWVudHMpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIGVsZW1lbnQgPSBlbGVtZW50c1tpXTtcblx0XHRcdFx0aWYgKCFlbGVtZW50LmNsYXNzTGlzdC5jb250YWlucygnYWJjanMtYmFyJykpXG5cdFx0XHRcdFx0ZWxlbWVudC5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dmFyIGxhc3RNZWFzdXJlO1xuXHRcdGZ1bmN0aW9uIGRpc2FwcGVhck1lYXN1cmVzQWZ0ZXIoc2VsZWN0b3IpIHtcblx0XHRcdGlmIChsYXN0TWVhc3VyZSkge1xuXHRcdFx0XHR2YXIgZWxlbWVudHMgPSBwYXBlci5xdWVyeVNlbGVjdG9yQWxsKGxhc3RNZWFzdXJlKTtcblx0XHRcdFx0aGlkZU1lYXN1cmVzKGVsZW1lbnRzKTtcblx0XHRcdH1cblx0XHRcdGxhc3RNZWFzdXJlID0gc2VsZWN0b3I7XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZGlzYXBwZWFyTWVhc3VyZXNCZWZvcmUoc2VsZWN0b3IpIHtcblx0XHRcdHZhciBlbGVtZW50cyA9IHBhcGVyLnF1ZXJ5U2VsZWN0b3JBbGwoc2VsZWN0b3IpO1xuXHRcdFx0aGlkZU1lYXN1cmVzKGVsZW1lbnRzKTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBtZWFzdXJlQ2FsbGJhY2soc2VsZWN0b3IpIHtcblx0XHRcdGlmIChvcHRpb25zLmhpZGVDdXJyZW50TWVhc3VyZSkge1xuXHRcdFx0XHRkaXNhcHBlYXJNZWFzdXJlc0JlZm9yZShzZWxlY3Rvcik7XG5cdFx0XHR9IGVsc2UgaWYgKG9wdGlvbnMuaGlkZUZpbmlzaGVkTWVhc3VyZXMpIHtcblx0XHRcdFx0ZGlzYXBwZWFyTWVhc3VyZXNBZnRlcihzZWxlY3Rvcik7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gZ2V0TGluZUFuZE1lYXN1cmUoZWxlbWVudCkge1xuXHRcdFx0cmV0dXJuICcuYWJjanMtbCcgKyBlbGVtZW50LmxpbmUgKyAnLmFiY2pzLW0nICsgZWxlbWVudC5tZWFzdXJlTnVtYmVyO1xuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHNldEN1cnNvcihyYW5nZSkge1xuXHRcdFx0aWYgKHJhbmdlKSB7XG5cdFx0XHRcdGlmIChyYW5nZS5tZWFzdXJlU3RhcnQpIHtcblx0XHRcdFx0XHR2YXIgc2VsZWN0b3IgPSBnZXRMaW5lQW5kTWVhc3VyZShyYW5nZSk7XG5cdFx0XHRcdFx0aWYgKHNlbGVjdG9yKVxuXHRcdFx0XHRcdFx0bWVhc3VyZUNhbGxiYWNrKHNlbGVjdG9yKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRjdXJzb3Iuc3R5bGUubGVmdCA9IHJhbmdlLmxlZnQgKyBcInB4XCI7XG5cdFx0XHRcdGN1cnNvci5zdHlsZS50b3AgPSByYW5nZS50b3AgKyBcInB4XCI7XG5cdFx0XHRcdGN1cnNvci5zdHlsZS53aWR0aCA9IHJhbmdlLndpZHRoICsgXCJweFwiO1xuXHRcdFx0XHRjdXJzb3Iuc3R5bGUuaGVpZ2h0ID0gcmFuZ2UuaGVpZ2h0ICsgXCJweFwiO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGltZXIuc3RvcCgpO1xuXHRcdFx0XHR0aW1lciA9IHVuZGVmaW5lZDtcblx0XHRcdH1cblx0XHR9XG5cblx0XHR0aW1lciA9IG5ldyBUaW1pbmdDYWxsYmFja3ModHVuZSwge1xuXHRcdFx0cXBtOiBvcHRpb25zLmJwbSxcblx0XHRcdGV2ZW50Q2FsbGJhY2s6IHNldEN1cnNvclxuXHRcdH0pO1xuXHRcdHRpbWVyLnN0YXJ0KCk7XG5cdH07XG5cblx0YW5pbWF0aW9uLnBhdXNlQW5pbWF0aW9uID0gZnVuY3Rpb24ocGF1c2UpIHtcblx0XHRpZiAocGF1c2UpXG5cdFx0XHR0aW1lci5wYXVzZSgpO1xuXHRcdGVsc2Vcblx0XHRcdHRpbWVyLnN0YXJ0KCk7XG5cdH07XG5cblx0YW5pbWF0aW9uLnN0b3BBbmltYXRpb24gPSBmdW5jdGlvbigpIHtcblx0XHR0aW1lci5zdG9wKCk7XG5cdFx0dGltZXIgPSB1bmRlZmluZWQ7XG5cdH07XG5cbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gYW5pbWF0aW9uO1xuIiwiXG52YXIgVGltaW5nQ2FsbGJhY2tzID0gZnVuY3Rpb24odGFyZ2V0LCBwYXJhbXMpIHtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXHRpZiAoIXBhcmFtcykgcGFyYW1zID0ge307XG5cdHNlbGYucXBtID0gcGFyYW1zLnFwbTtcblx0aWYgKCFzZWxmLnFwbSkge1xuXHRcdHZhciB0ZW1wbyA9IHRhcmdldC5tZXRhVGV4dCA/IHRhcmdldC5tZXRhVGV4dC50ZW1wbyA6IG51bGw7XG5cdFx0c2VsZi5xcG0gPSB0YXJnZXQuZ2V0QnBtKHRlbXBvKTtcblx0fVxuXHRzZWxmLmV4dHJhTWVhc3VyZXNBdEJlZ2lubmluZyA9IHBhcmFtcy5leHRyYU1lYXN1cmVzQXRCZWdpbm5pbmcgPyBwYXJhbXMuZXh0cmFNZWFzdXJlc0F0QmVnaW5uaW5nIDogMDtcblx0c2VsZi5iZWF0Q2FsbGJhY2sgPSBwYXJhbXMuYmVhdENhbGxiYWNrOyAvLyBUaGlzIGlzIGNhbGxlZCBmb3IgZWFjaCBiZWF0LlxuXHRzZWxmLmV2ZW50Q2FsbGJhY2sgPSBwYXJhbXMuZXZlbnRDYWxsYmFjazsgICAvLyBUaGlzIGlzIGNhbGxlZCBmb3IgZWFjaCBub3RlIG9yIHJlc3QgZW5jb3VudGVyZWQuXG5cdHNlbGYubGluZUVuZENhbGxiYWNrID0gcGFyYW1zLmxpbmVFbmRDYWxsYmFjazsgICAvLyBUaGlzIGlzIGNhbGxlZCB3aGVuIHRoZSBlbmQgb2YgYSBsaW5lIGlzIGFwcHJvYWNoaW5nLlxuXHRzZWxmLmxpbmVFbmRBbnRpY2lwYXRpb24gPSBwYXJhbXMubGluZUVuZEFudGljaXBhdGlvbiA/IHBhcmFtcy5saW5lRW5kQW50aWNpcGF0aW9uIDogMDsgICAvLyBIb3cgbWFueSBtaWxsaXNlY29uZHMgYmVmb3JlIHRoZSBlbmQgc2hvdWxkIHRoZSBjYWxsIGhhcHBlbi5cblxuXHRzZWxmLnJlcGxhY2VUYXJnZXQgPSBmdW5jdGlvbihuZXdUYXJnZXQpIHtcblx0XHRuZXdUYXJnZXQuc2V0VGltaW5nKHNlbGYucXBtLCBzZWxmLmV4dHJhTWVhc3VyZXNBdEJlZ2lubmluZyk7XG5cdFx0aWYgKG5ld1RhcmdldC5ub3RlVGltaW5ncy5sZW5ndGggPT09IDApXG5cdFx0XHRyZXR1cm47XG5cdFx0aWYgKHNlbGYubGluZUVuZENhbGxiYWNrKSB7XG5cdFx0XHRzZWxmLmxpbmVFbmRUaW1pbmdzID0gZ2V0TGluZUVuZFRpbWluZ3MobmV3VGFyZ2V0Lm5vdGVUaW1pbmdzLCBzZWxmLmxpbmVFbmRBbnRpY2lwYXRpb24pO1xuXHRcdH1cblx0XHRzZWxmLm5vdGVUaW1pbmdzID0gbmV3VGFyZ2V0Lm5vdGVUaW1pbmdzO1xuXHR9O1xuXG5cdHNlbGYucmVwbGFjZVRhcmdldCh0YXJnZXQpO1xuXHRpZiAoc2VsZi5ub3RlVGltaW5ncy5sZW5ndGggPT09IDApXG5cdFx0cmV0dXJuO1xuXG5cdC8vIG5vdGVUaW1pbmdzIGNvbnRhaW5zIGFuIGFycmF5IG9mIGV2ZW50cyBzb3J0ZWQgYnkgdGltZS4gRXZlbnRzIHRoYXQgaGFwcGVuIGF0IHRoZSBzYW1lIHRpbWUgYXJlIGluIHRoZSBzYW1lIGVsZW1lbnQgb2YgdGhlIGFycmF5LlxuXHRzZWxmLm5vdGVUaW1pbmdzID0gdGFyZ2V0Lm5vdGVUaW1pbmdzO1xuXHRzZWxmLm1pbGxpc2Vjb25kc1BlckJlYXQgPSAxMDAwIC8gKHNlbGYucXBtIC8gNjApO1xuXHRzZWxmLmxhc3RNb21lbnQgPSBzZWxmLm5vdGVUaW1pbmdzW3NlbGYubm90ZVRpbWluZ3MubGVuZ3RoLTFdLm1pbGxpc2Vjb25kcztcblxuXHRzZWxmLnN0YXJ0VGltZSA9IG51bGw7XG5cdHNlbGYuY3VycmVudEJlYXQgPSAwO1xuXHRzZWxmLmN1cnJlbnRFdmVudCA9IDA7XG5cdHNlbGYuaXNQYXVzZWQgPSBmYWxzZTtcblx0c2VsZi5wYXVzZWRUaW1lID0gbnVsbDtcblx0c2VsZi5qdXN0VW5wYXVzZWQgPSBmYWxzZTtcblxuXHRzZWxmLmRvVGltaW5nID0gZnVuY3Rpb24odGltZXN0YW1wKSB7XG5cdFx0aWYgKCFzZWxmLnN0YXJ0VGltZSkge1xuXHRcdFx0c2VsZi5zdGFydFRpbWUgPSB0aW1lc3RhbXA7XG5cdFx0fSBlbHNlIGlmIChzZWxmLmp1c3RVbnBhdXNlZCkge1xuXHRcdFx0Ly8gQWRkIHRoZSBhbW91bnQgd2UgcGF1c2VkIHRvIHRoZSBzdGFydCB0aW1lIHRvIGdldCB0aGUgcmlnaHQgcGxhY2UuXG5cdFx0XHR2YXIgdGltZVBhdXNlZCA9ICh0aW1lc3RhbXAgLSBzZWxmLnBhdXNlZFRpbWUpO1xuXHRcdFx0c2VsZi5zdGFydFRpbWUgKz0gdGltZVBhdXNlZDtcblx0XHR9XG5cdFx0c2VsZi5qdXN0VW5wYXVzZWQgPSBmYWxzZTtcblxuXHRcdGlmIChzZWxmLmlzUGF1c2VkKSB7XG5cdFx0XHRzZWxmLnBhdXNlZFRpbWUgPSB0aW1lc3RhbXA7XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBjdXJyZW50VGltZSA9IHRpbWVzdGFtcCAtIHNlbGYuc3RhcnRUaW1lO1xuXHRcdFx0Y3VycmVudFRpbWUgKz0gNTA7IC8vIEFkZCBhIGxpdHRsZSBzbG9wIGJlY2F1c2UgdGhpcyBmdW5jdGlvbiBpc24ndCBjYWxsZWQgZXhhY3RseS5cblx0XHRcdGlmIChjdXJyZW50VGltZSA8IHNlbGYubGFzdE1vbWVudClcblx0XHRcdFx0cmVxdWVzdEFuaW1hdGlvbkZyYW1lKHNlbGYuZG9UaW1pbmcpO1xuXG5cdFx0XHRpZiAoc2VsZi5jdXJyZW50QmVhdCAqIHNlbGYubWlsbGlzZWNvbmRzUGVyQmVhdCA8IGN1cnJlbnRUaW1lKSB7XG5cdFx0XHRcdGlmIChzZWxmLmJlYXRDYWxsYmFjaylcblx0XHRcdFx0XHRzZWxmLmJlYXRDYWxsYmFjayhzZWxmLmN1cnJlbnRCZWF0KTtcblx0XHRcdFx0c2VsZi5jdXJyZW50QmVhdCsrO1xuXHRcdFx0fVxuXG5cdFx0XHR3aGlsZSAoc2VsZi5ub3RlVGltaW5ncy5sZW5ndGggPiBzZWxmLmN1cnJlbnRFdmVudCAmJiBzZWxmLm5vdGVUaW1pbmdzW3NlbGYuY3VycmVudEV2ZW50XS5taWxsaXNlY29uZHMgPCBjdXJyZW50VGltZSkge1xuXHRcdFx0XHRpZiAoc2VsZi5ldmVudENhbGxiYWNrKVxuXHRcdFx0XHRcdHNlbGYuZXZlbnRDYWxsYmFjayhzZWxmLm5vdGVUaW1pbmdzW3NlbGYuY3VycmVudEV2ZW50XSk7XG5cdFx0XHRcdHNlbGYuY3VycmVudEV2ZW50Kys7XG5cdFx0XHR9XG5cblx0XHRcdGlmIChzZWxmLmxpbmVFbmRDYWxsYmFjayAmJiBzZWxmLmxpbmVFbmRUaW1pbmdzLmxlbmd0aCAmJiBzZWxmLmxpbmVFbmRUaW1pbmdzWzBdLm1pbGxpc2Vjb25kcyA8PSBjdXJyZW50VGltZSkge1xuXHRcdFx0XHRzZWxmLmxpbmVFbmRDYWxsYmFjayhzZWxmLmxpbmVFbmRUaW1pbmdzWzBdKTtcblx0XHRcdFx0c2VsZi5saW5lRW5kVGltaW5ncy5zaGlmdCgpO1xuXHRcdFx0fVxuXG5cdFx0XHRpZiAoY3VycmVudFRpbWUgPj0gc2VsZi5sYXN0TW9tZW50ICYmc2VsZi5ldmVudENhbGxiYWNrKVxuXHRcdFx0XHRzZWxmLmV2ZW50Q2FsbGJhY2sobnVsbCk7XG5cdFx0XHR9XG5cdH07XG5cblx0c2VsZi5zdGFydCA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmIChzZWxmLmlzUGF1c2VkKSB7XG5cdFx0XHRzZWxmLmlzUGF1c2VkID0gZmFsc2U7XG5cdFx0XHRzZWxmLmp1c3RVbnBhdXNlZCA9IHRydWU7XG5cdFx0fVxuXHRcdHJlcXVlc3RBbmltYXRpb25GcmFtZShzZWxmLmRvVGltaW5nKTtcblx0fTtcblx0c2VsZi5wYXVzZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHNlbGYuaXNQYXVzZWQgPSB0cnVlO1xuXHR9O1xuXHRzZWxmLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0c2VsZi5jdXJyZW50QmVhdCA9IDA7XG5cdFx0c2VsZi5jdXJyZW50RXZlbnQgPSAwO1xuXHRcdHNlbGYuc3RhcnRUaW1lID0gbnVsbDtcblx0XHRzZWxmLnBhdXNlZFRpbWUgPSBudWxsO1xuXHRcdGlmIChzZWxmLmxpbmVFbmRDYWxsYmFjaykge1xuXHRcdFx0c2VsZi5saW5lRW5kVGltaW5ncyA9IGdldExpbmVFbmRUaW1pbmdzKHNlbGYubm90ZVRpbWluZ3MsIHNlbGYubGluZUVuZEFudGljaXBhdGlvbik7XG5cdFx0fVxuXHR9O1xuXHRzZWxmLnN0b3AgPSBmdW5jdGlvbigpIHtcblx0XHRzZWxmLnBhdXNlKCk7XG5cdFx0c2VsZi5yZXNldCgpO1xuXHR9O1xufTtcblxuZnVuY3Rpb24gZ2V0TGluZUVuZFRpbWluZ3ModGltaW5ncywgYW50aWNpcGF0aW9uKSB7XG5cdC8vIFJldHVybnMgYW4gYXJyYXkgb2YgbWlsbGlzZWNvbmRzIHRvIGNhbGwgdGhlIGxpbmVFbmRDYWxsYmFjay5cblx0Ly8gVGhpcyBmaWd1cmVzIG91dCB0aGUgdGltaW5nIG9mIHRoZSBiZWdpbm5pbmcgb2YgZWFjaCBsaW5lIGFuZCBzdWJ0cmFjdHMgdGhlIGFudGljaXBhdGlvbiBmcm9tIGl0LlxuXHR2YXIgY2FsbGJhY2tUaW1lcyA9IFtdO1xuXHR2YXIgbGFzdFRvcCA9IG51bGw7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgdGltaW5ncy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciB0aW1pbmcgPSB0aW1pbmdzW2ldO1xuXHRcdGlmICh0aW1pbmcudG9wICE9PSBsYXN0VG9wKSB7XG5cdFx0XHRjYWxsYmFja1RpbWVzLnB1c2goeyBtaWxsaXNlY29uZHM6IHRpbWluZy5taWxsaXNlY29uZHMgLSBhbnRpY2lwYXRpb24sIHRvcDogdGltaW5nLnRvcCwgYm90dG9tOiB0aW1pbmcudG9wK3RpbWluZy5oZWlnaHQgfSk7XG5cdFx0XHRsYXN0VG9wID0gdGltaW5nLnRvcDtcblx0XHR9XG5cdH1cblx0cmV0dXJuIGNhbGxiYWNrVGltZXM7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gVGltaW5nQ2FsbGJhY2tzO1xuXG4iLCIvLyAgICBhYmNfdHVuZWJvb2suanM6IHNwbGl0cyBhIHN0cmluZyByZXByZXNlbnRpbmcgQUJDIE11c2ljIE5vdGF0aW9uIGludG8gaW5kaXZpZHVhbCB0dW5lcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IFBhdWwgUm9zZW4gKHBhdWwgYXQgcGF1bHJvc2VuIGRvdCBuZXQpXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbi8qZ2xvYmFsIGRvY3VtZW50ICovXG4vKmdsb2JhbCB3aW5kb3csIEFCQ0pTLCBjb25zb2xlICovXG5cbnZhciBwYXJzZUNvbW1vbiA9IHJlcXVpcmUoJy4uL3BhcnNlL2FiY19jb21tb24nKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJy4uL3BhcnNlL2FiY19wYXJzZScpO1xuXG52YXIgdHVuZWJvb2sgPSB7fTtcblxuKGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblxuXHR0dW5lYm9vay5udW1iZXJPZlR1bmVzID0gZnVuY3Rpb24oYWJjKSB7XG5cdFx0dmFyIHR1bmVzID0gYWJjLnNwbGl0KFwiXFxuWDpcIik7XG5cdFx0dmFyIG51bSA9IHR1bmVzLmxlbmd0aDtcblx0XHRpZiAobnVtID09PSAwKSBudW0gPSAxO1xuXHRcdHJldHVybiBudW07XG5cdH07XG5cblx0dmFyIFR1bmVCb29rID0gdHVuZWJvb2suVHVuZUJvb2sgPSBmdW5jdGlvbihib29rKSB7XG5cdFx0dmFyIFRoaXMgPSB0aGlzO1xuXHRcdHZhciBkaXJlY3RpdmVzID0gXCJcIjtcblx0XHRib29rID0gcGFyc2VDb21tb24uc3RyaXAoYm9vayk7XG5cdFx0dmFyIHR1bmVzID0gYm9vay5zcGxpdChcIlxcblg6XCIpO1xuXHRcdGZvciAodmFyIGkgPSAxOyBpIDwgdHVuZXMubGVuZ3RoOyBpKyspXHQvLyBQdXQgYmFjayB0aGUgWDogdGhhdCB3ZSBsb3N0IHdoZW4gc3BsaXR0aW5nIHRoZSB0dW5lcy5cblx0XHRcdHR1bmVzW2ldID0gXCJYOlwiICsgdHVuZXNbaV07XG5cdFx0Ly8gS2VlcCB0cmFjayBvZiB0aGUgY2hhcmFjdGVyIHBvc2l0aW9uIGVhY2ggdHVuZSBzdGFydHMgd2l0aC5cblx0XHR2YXIgcG9zID0gMDtcblx0XHRUaGlzLnR1bmVzID0gW107XG5cdFx0cGFyc2VDb21tb24uZWFjaCh0dW5lcywgZnVuY3Rpb24odHVuZSkge1xuXHRcdFx0VGhpcy50dW5lcy5wdXNoKHsgYWJjOiB0dW5lLCBzdGFydFBvczogcG9zfSk7XG5cdFx0XHRwb3MgKz0gdHVuZS5sZW5ndGggKyAxOyAvLyBXZSBhbHNvIGxvc3QgYSBuZXdsaW5lIHdoZW4gc3BsaXR0aW5nLCBzbyBjb3VudCB0aGF0LlxuXHRcdH0pO1xuXHRcdGlmIChUaGlzLnR1bmVzLmxlbmd0aCA+IDEgJiYgIXBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgoVGhpcy50dW5lc1swXS5hYmMsICdYOicpKSB7XHQvLyBJZiB0aGVyZSBpcyBvbmx5IG9uZSB0dW5lLCB0aGUgWDogbWlnaHQgYmUgbWlzc2luZywgb3RoZXJ3aXNlIGFzc3VtZSB0aGUgdG9wIG9mIHRoZSBmaWxlIGlzIFwiaW50ZXJ0dW5lXCJcblx0XHRcdC8vIFRoZXJlIGNvdWxkIGJlIGZpbGUtd2lkZSBkaXJlY3RpdmVzIGluIHRoaXMsIGlmIHNvLCB3ZSBuZWVkIHRvIGluc2VydCBpdCBpbnRvIGVhY2ggdHVuZS4gV2UgY2FuIHByb2JhYmx5IGdldCBhd2F5IHdpdGhcblx0XHRcdC8vIGp1c3QgbG9va2luZyBmb3IgZmlsZS13aWRlIGRpcmVjdGl2ZXMgaGVyZSAoYmVmb3JlIHRoZSBmaXJzdCB0dW5lKSBhbmQgaW5zZXJ0aW5nIHRoZW0gYXQgdGhlIGJvdHRvbSBvZiBlYWNoIHR1bmUsIHNpbmNlXG5cdFx0XHQvLyB0aGUgdHVuZSBpcyBwYXJzZWQgYWxsIGF0IG9uY2UuIFRoZSBkaXJlY3RpdmVzIHdpbGwgYmUgc2VlbiBiZWZvcmUgdGhlIGVuZ3JhdmVyIGJlZ2lucyBwcm9jZXNzaW5nLlxuXHRcdFx0dmFyIGRpciA9IFRoaXMudHVuZXMuc2hpZnQoKTtcblx0XHRcdHZhciBhcnJEaXIgPSBkaXIuYWJjLnNwbGl0KCdcXG4nKTtcblx0XHRcdHBhcnNlQ29tbW9uLmVhY2goYXJyRGlyLCBmdW5jdGlvbihsaW5lKSB7XG5cdFx0XHRcdGlmIChwYXJzZUNvbW1vbi5zdGFydHNXaXRoKGxpbmUsICclJScpKVxuXHRcdFx0XHRcdGRpcmVjdGl2ZXMgKz0gbGluZSArICdcXG4nO1xuXHRcdFx0fSk7XG5cdFx0fVxuXHRcdFRoaXMuaGVhZGVyID0gZGlyZWN0aXZlcztcblxuXHRcdC8vIE5vdywgdGhlIHR1bmUgZW5kcyBhdCBhIGJsYW5rIGxpbmUsIHNvIHRydW5jYXRlIGl0IGlmIG5lZWRlZC4gVGhlcmUgbWF5IGJlIFwiaW50ZXJ0dW5lXCIgc3R1ZmYuXG5cdFx0cGFyc2VDb21tb24uZWFjaChUaGlzLnR1bmVzLCBmdW5jdGlvbih0dW5lKSB7XG5cdFx0XHR2YXIgZW5kID0gdHVuZS5hYmMuaW5kZXhPZignXFxuXFxuJyk7XG5cdFx0XHRpZiAoZW5kID4gMClcblx0XHRcdFx0dHVuZS5hYmMgPSB0dW5lLmFiYy5zdWJzdHJpbmcoMCwgZW5kKTtcblx0XHRcdHR1bmUucHVyZSA9IHR1bmUuYWJjO1xuXHRcdFx0dHVuZS5hYmMgPSBkaXJlY3RpdmVzICsgdHVuZS5hYmM7XG5cblx0XHRcdC8vIGZvciB0aGUgdXNlcidzIGNvbnZlbmllbmNlLCBwYXJzZSBhbmQgc3RvcmUgdGhlIHRpdGxlIHNlcGFyYXRlbHkuIFRoZSB0aXRsZSBpcyBiZXR3ZWVuIHRoZSBmaXJzdCBUOiBhbmQgdGhlIG5leHQgXFxuXG5cdFx0XHR2YXIgdGl0bGUgPSB0dW5lLnB1cmUuc3BsaXQoXCJUOlwiKTtcblx0XHRcdGlmICh0aXRsZS5sZW5ndGggPiAxKSB7XG5cdFx0XHRcdHRpdGxlID0gdGl0bGVbMV0uc3BsaXQoXCJcXG5cIik7XG5cdFx0XHRcdHR1bmUudGl0bGUgPSB0aXRsZVswXS5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG5cdFx0XHR9IGVsc2Vcblx0XHRcdFx0dHVuZS50aXRsZSA9IFwiXCI7XG5cblx0XHRcdC8vIGZvciB0aGUgdXNlcidzIGNvbnZlbmllbmNlLCBwYXJzZSBhbmQgc3RvcmUgdGhlIGlkIHNlcGFyYXRlbHkuIFRoZSBpZCBpcyBiZXR3ZWVuIHRoZSBmaXJzdCBYOiBhbmQgdGhlIG5leHQgXFxuXG5cdFx0XHR2YXIgaWQgPSB0dW5lLnB1cmUuc3Vic3RyaW5nKDIsIHR1bmUucHVyZS5pbmRleE9mKFwiXFxuXCIpKTtcblx0XHRcdHR1bmUuaWQgPSBpZC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCAnJyk7XG5cdFx0fSk7XG5cdH07XG5cblx0VHVuZUJvb2sucHJvdG90eXBlLmdldFR1bmVCeUlkID0gZnVuY3Rpb24oaWQpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMudHVuZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmICh0aGlzLnR1bmVzW2ldLmlkID09PSBpZClcblx0XHRcdFx0cmV0dXJuIHRoaXMudHVuZXNbaV07XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cdFR1bmVCb29rLnByb3RvdHlwZS5nZXRUdW5lQnlUaXRsZSA9IGZ1bmN0aW9uKHRpdGxlKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnR1bmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodGhpcy50dW5lc1tpXS50aXRsZSA9PT0gdGl0bGUpXG5cdFx0XHRcdHJldHVybiB0aGlzLnR1bmVzW2ldO1xuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblxuXHR0dW5lYm9vay5wYXJzZU9ubHkgPSBmdW5jdGlvbihhYmMsIHBhcmFtcykge1xuXHRcdHZhciB0dW5lcyA9IFtdO1xuXHRcdHZhciBudW1UdW5lcyA9IHR1bmVib29rLm51bWJlck9mVHVuZXMoYWJjKTtcblxuXHRcdC8vIHRoaXMganVzdCBuZWVkcyB0byBiZSBwYXNzZWQgaW4gYmVjYXVzZSB0aGlzIHRlbGxzIHRoZSBlbmdpbmUgaG93IG1hbnkgdHVuZXMgdG8gcHJvY2Vzcy5cblx0XHR2YXIgb3V0cHV0ID0gW107XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBudW1UdW5lczsgaSsrKSB7XG5cdFx0XHRvdXRwdXQucHVzaCgxKTtcblx0XHR9XG5cdFx0ZnVuY3Rpb24gY2FsbGJhY2soKSB7XG5cdFx0XHQvLyBEb24ndCBuZWVkIHRvIGRvIGFueXRoaW5nIHdpdGggdGhlIHBhcnNlZCB0dW5lcy5cblx0XHR9XG5cdFx0cmV0dXJuIHR1bmVib29rLnJlbmRlckVuZ2luZShjYWxsYmFjaywgb3V0cHV0LCBhYmMsIHBhcmFtcyk7XG5cdH07XG5cblx0dHVuZWJvb2sucmVuZGVyRW5naW5lID0gZnVuY3Rpb24gKGNhbGxiYWNrLCBvdXRwdXQsIGFiYywgcGFyYW1zKSB7XG5cdFx0dmFyIHJldCA9IFtdO1xuXHRcdHZhciBpc0FycmF5ID0gZnVuY3Rpb24odGVzdE9iamVjdCkge1xuXHRcdFx0cmV0dXJuIHRlc3RPYmplY3QgJiYgISh0ZXN0T2JqZWN0LnByb3BlcnR5SXNFbnVtZXJhYmxlKCdsZW5ndGgnKSkgJiYgdHlwZW9mIHRlc3RPYmplY3QgPT09ICdvYmplY3QnICYmIHR5cGVvZiB0ZXN0T2JqZWN0Lmxlbmd0aCA9PT0gJ251bWJlcic7XG5cdFx0fTtcblxuXHRcdC8vIGNoZWNrIGFuZCBub3JtYWxpemUgaW5wdXQgcGFyYW1ldGVyc1xuXHRcdGlmIChvdXRwdXQgPT09IHVuZGVmaW5lZCB8fCBhYmMgPT09IHVuZGVmaW5lZClcblx0XHRcdHJldHVybjtcblx0XHRpZiAoIWlzQXJyYXkob3V0cHV0KSlcblx0XHRcdG91dHB1dCA9IFsgb3V0cHV0IF07XG5cdFx0aWYgKHBhcmFtcyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0cGFyYW1zID0ge307XG5cdFx0dmFyIGN1cnJlbnRUdW5lID0gcGFyYW1zLnN0YXJ0aW5nVHVuZSA/IHBhcnNlSW50KHBhcmFtcy5zdGFydGluZ1R1bmUsIDEwKSA6IDA7XG5cblx0XHQvLyBwYXJzZSB0aGUgYWJjIHN0cmluZ1xuXHRcdHZhciBib29rID0gbmV3IFR1bmVCb29rKGFiYyk7XG5cdFx0dmFyIGFiY1BhcnNlciA9IG5ldyBQYXJzZSgpO1xuXG5cdFx0Ly8gb3V0cHV0IGVhY2ggdHVuZSwgaWYgaXQgZXhpc3RzLiBPdGhlcndpc2UgY2xlYXIgdGhlIGRpdi5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG91dHB1dC5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGRpdiA9IG91dHB1dFtpXTtcblx0XHRcdGlmICh0eXBlb2YoZGl2KSA9PT0gXCJzdHJpbmdcIilcblx0XHRcdFx0ZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoZGl2KTtcblx0XHRcdGlmIChkaXYpIHtcblx0XHRcdFx0aWYgKGN1cnJlbnRUdW5lID49IDAgJiYgY3VycmVudFR1bmUgPCBib29rLnR1bmVzLmxlbmd0aCkge1xuXHRcdFx0XHRcdGFiY1BhcnNlci5wYXJzZShib29rLnR1bmVzW2N1cnJlbnRUdW5lXS5hYmMsIHBhcmFtcyk7XG5cdFx0XHRcdFx0dmFyIHR1bmUgPSBhYmNQYXJzZXIuZ2V0VHVuZSgpO1xuXHRcdFx0XHRcdHZhciBvdmVycmlkZSA9IGNhbGxiYWNrKGRpdiwgdHVuZSwgaSwgYm9vay50dW5lc1tjdXJyZW50VHVuZV0uYWJjKTtcblx0XHRcdFx0XHRyZXQucHVzaChvdmVycmlkZSA/IG92ZXJyaWRlIDogdHVuZSk7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKGRpdi5oYXNPd25Qcm9wZXJ0eSgnaW5uZXJIVE1MJykpXG5cdFx0XHRcdFx0XHRkaXYuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0Y3VycmVudFR1bmUrKztcblx0XHR9XG5cdFx0cmV0dXJuIHJldDtcblx0fTtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSB0dW5lYm9vaztcbiIsInZhciB0dW5lYm9vayA9IHJlcXVpcmUoJy4vYWJjX3R1bmVib29rJyk7XG5cbnZhciBFbmdyYXZlckNvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi93cml0ZS9hYmNfZW5ncmF2ZXJfY29udHJvbGxlcicpO1xudmFyIFBhcnNlID0gcmVxdWlyZSgnLi4vcGFyc2UvYWJjX3BhcnNlJyk7XG5cbnZhciByZXNpemVEaXZzID0ge307XG5mdW5jdGlvbiByZXNpemVPdXRlcigpIHtcbiAgICB2YXIgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcbiAgICBmb3IgKHZhciBpZCBpbiByZXNpemVEaXZzKSB7XG4gICAgICAgIGlmIChyZXNpemVEaXZzLmhhc093blByb3BlcnR5KGlkKSkge1xuICAgICAgICAgICAgdmFyIG91dGVyID0gcmVzaXplRGl2c1tpZF07XG4gICAgICAgICAgICB2YXIgb2ZzID0gb3V0ZXIub2Zmc2V0TGVmdDtcbiAgICAgICAgICAgIHdpZHRoIC09IG9mcyAqIDI7XG4gICAgICAgICAgICBvdXRlci5zdHlsZS53aWR0aCA9IHdpZHRoICsgXCJweFwiO1xuICAgICAgICB9XG4gICAgfVxufVxuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCByZXNpemVPdXRlcik7XG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcIm9yaWVudGF0aW9uQ2hhbmdlXCIsIHJlc2l6ZU91dGVyKTtcblxuZnVuY3Rpb24gcmVuZGVyT25lKGRpdiwgdHVuZSwgcGFyYW1zLCB0dW5lTnVtYmVyKSB7XG4gICAgdmFyIHdpZHRoID0gcGFyYW1zLndpZHRoID8gcGFyYW1zLndpZHRoIDogODAwO1xuICAgIGlmIChwYXJhbXMudmlld3BvcnRIb3Jpem9udGFsKSB7XG4gICAgICAgIC8vIENyZWF0ZSBhbiBpbm5lciBkaXYgdGhhdCBob2xkcyB0aGUgbXVzaWMsIHNvIHRoYXQgdGhlIHBhc3NlZCBpbiBkaXYgd2lsbCBiZSB0aGUgdmlld3BvcnQuXG4gICAgICAgIGRpdi5pbm5lckhUTUwgPSAnPGRpdiBjbGFzcz1cImFiY2pzLWlubmVyXCI+PC9kaXY+JztcbiAgICAgICAgaWYgKHBhcmFtcy5zY3JvbGxIb3Jpem9udGFsKSB7XG4gICAgICAgICAgICBkaXYuc3R5bGUub3ZlcmZsb3dYID0gXCJhdXRvXCI7XG4gICAgICAgICAgICBkaXYuc3R5bGUub3ZlcmZsb3dZID0gXCJoaWRkZW5cIjtcbiAgICAgICAgfSBlbHNlXG4gICAgICAgICAgICBkaXYuc3R5bGUub3ZlcmZsb3cgPSBcImhpZGRlblwiO1xuICAgICAgICByZXNpemVEaXZzW2Rpdi5pZF0gPSBkaXY7IC8vIFdlIHVzZSBhIGhhc2ggb24gdGhlIGVsZW1lbnQncyBpZCBzbyB0aGF0IG11bHRpcGxlIGNhbGxzIHdvbid0IGtlZXAgYWRkaW5nIHRvIHRoZSBsaXN0LlxuICAgICAgICBkaXYgPSBkaXYuY2hpbGRyZW5bMF07IC8vIFRoZSBtdXNpYyBzaG91bGQgYmUgcmVuZGVyZWQgaW4gdGhlIGlubmVyIGRpdi5cbiAgICB9XG4gICAgZWxzZSBpZiAocGFyYW1zLnZpZXdwb3J0VmVydGljYWwpIHtcbiAgICAgICAgLy8gQ3JlYXRlIGFuIGlubmVyIGRpdiB0aGF0IGhvbGRzIHRoZSBtdXNpYywgc28gdGhhdCB0aGUgcGFzc2VkIGluIGRpdiB3aWxsIGJlIHRoZSB2aWV3cG9ydC5cbiAgICAgICAgZGl2LmlubmVySFRNTCA9ICc8ZGl2IGNsYXNzPVwiYWJjanMtaW5uZXIgc2Nyb2xsLWFtb3VudFwiPjwvZGl2Pic7XG4gICAgICAgIGRpdi5zdHlsZS5vdmVyZmxvd1ggPSBcImhpZGRlblwiO1xuICAgICAgICBkaXYuc3R5bGUub3ZlcmZsb3dZID0gXCJhdXRvXCI7XG4gICAgICAgIGRpdiA9IGRpdi5jaGlsZHJlblswXTsgLy8gVGhlIG11c2ljIHNob3VsZCBiZSByZW5kZXJlZCBpbiB0aGUgaW5uZXIgZGl2LlxuICAgIH1cbiAgICBlbHNlXG5cdCAgICBkaXYuaW5uZXJIVE1MID0gXCJcIjtcbiAgICB2YXIgZW5ncmF2ZXJfY29udHJvbGxlciA9IG5ldyBFbmdyYXZlckNvbnRyb2xsZXIoZGl2LCBwYXJhbXMpO1xuICAgIGVuZ3JhdmVyX2NvbnRyb2xsZXIuZW5ncmF2ZUFCQyh0dW5lLCB0dW5lTnVtYmVyKTtcbiAgICB0dW5lLmVuZ3JhdmVyID0gZW5ncmF2ZXJfY29udHJvbGxlcjtcbiAgICBpZiAocGFyYW1zLnZpZXdwb3J0VmVydGljYWwgfHwgcGFyYW1zLnZpZXdwb3J0SG9yaXpvbnRhbCkge1xuICAgICAgICAvLyBJZiB3ZSBhZGRlZCBhIHdyYXBwZXIgYXJvdW5kIHRoZSBkaXYsIHRoZW4gd2UgbmVlZCB0byBzaXplIHRoZSB3cmFwcGVyLCB0b28uXG4gICAgICAgIHZhciBwYXJlbnQgPSBkaXYucGFyZW50Tm9kZTtcbiAgICAgICAgcGFyZW50LnN0eWxlLndpZHRoID0gZGl2LnN0eWxlLndpZHRoO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gcmVuZGVyRWFjaExpbmVTZXBhcmF0ZWx5KGRpdiwgdHVuZSwgcGFyYW1zLCB0dW5lTnVtYmVyKSB7XG4gICAgZnVuY3Rpb24gaW5pdGlhbGl6ZVR1bmVMaW5lKHR1bmUpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGZvcm1hdHRpbmc6IHR1bmUuZm9ybWF0dGluZyxcbiAgICAgICAgICAgIG1lZGlhOiB0dW5lLm1lZGlhLFxuICAgICAgICAgICAgdmVyc2lvbjogdHVuZS52ZXJzaW9uLFxuICAgICAgICAgICAgbWV0YVRleHQ6IHt9LFxuICAgICAgICAgICAgbGluZXM6IFtdXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgLy8gQmVmb3JlIHJlbmRlcmluZywgY2hvcCB1cCB0aGUgcmV0dXJuZWQgdHVuZSBpbnRvIGFuIGFycmF5IHdoZXJlIGVhY2ggZWxlbWVudCBpcyBhIGxpbmUuXG4gICAgLy8gVGhlIGZpcnN0IGVsZW1lbnQgb2YgdGhlIGFycmF5IGdldHMgdGhlIHRpdGxlIGFuZCBvdGhlciBpdGVtcyB0aGF0IGdvIG9uIHRvcCwgdGhlIGxhc3QgZWxlbWVudFxuICAgIC8vIG9mIHRoZSBhcnJheSBnZXRzIHRoZSBleHRyYSB0ZXh0IHRoYXQgZ29lcyBvbiBib3R0b20uIEVhY2ggZWxlbWVudCBnZXRzIGFueSBub24tbXVzaWMgaW5mbyB0aGF0IGNvbWVzIGJlZm9yZSBpdC5cbiAgICB2YXIgdHVuZXMgPSBbXTtcbiAgICB2YXIgdHVuZUxpbmU7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0dW5lLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHZhciBsaW5lID0gdHVuZS5saW5lc1tpXTtcbiAgICAgICAgaWYgKCF0dW5lTGluZSlcbiAgICAgICAgICAgIHR1bmVMaW5lID0gaW5pdGlhbGl6ZVR1bmVMaW5lKHR1bmUpO1xuXG4gICAgICAgIGlmIChpID09PSAwKSB7XG4gICAgICAgICAgICAvLyBUaGVzZSBpdGVtcyBnbyBvbiB0b3Agb2YgdGhlIG11c2ljXG4gICAgICAgICAgICB0dW5lTGluZS5tZXRhVGV4dC50ZW1wbyA9IHR1bmUubWV0YVRleHQudGVtcG87XG4gICAgICAgICAgICB0dW5lTGluZS5tZXRhVGV4dC50aXRsZSA9IHR1bmUubWV0YVRleHQudGl0bGU7XG4gICAgICAgICAgICB0dW5lTGluZS5tZXRhVGV4dC5oZWFkZXIgPSB0dW5lLm1ldGFUZXh0LmhlYWRlcjtcbiAgICAgICAgICAgIHR1bmVMaW5lLm1ldGFUZXh0LnJoeXRobSA9IHR1bmUubWV0YVRleHQucmh5dGhtO1xuICAgICAgICAgICAgdHVuZUxpbmUubWV0YVRleHQub3JpZ2luID0gdHVuZS5tZXRhVGV4dC5vcmlnaW47XG4gICAgICAgICAgICB0dW5lTGluZS5tZXRhVGV4dC5jb21wb3NlciA9IHR1bmUubWV0YVRleHQuY29tcG9zZXI7XG4gICAgICAgICAgICB0dW5lTGluZS5tZXRhVGV4dC5hdXRob3IgPSB0dW5lLm1ldGFUZXh0LmF1dGhvcjtcbiAgICAgICAgICAgIHR1bmVMaW5lLm1ldGFUZXh0LnBhcnRPcmRlciA9IHR1bmUubWV0YVRleHQucGFydE9yZGVyO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gcHVzaCB0aGUgbGluZXMgdW50aWwgd2UgZ2V0IHRvIGEgbXVzaWMgbGluZVxuICAgICAgICB0dW5lTGluZS5saW5lcy5wdXNoKGxpbmUpO1xuICAgICAgICBpZiAobGluZS5zdGFmZikge1xuICAgICAgICAgICAgdHVuZXMucHVzaCh0dW5lTGluZSk7XG4gICAgICAgICAgICB0dW5lTGluZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgIH1cbiAgICAvLyBBZGQgYW55IGV4dHJhIHN0dWZmIHRvIHRoZSBsYXN0IGxpbmUuXG4gICAgaWYgKHR1bmVMaW5lKSB7XG4gICAgICAgIHZhciBsYXN0TGluZSA9IHR1bmVzW3R1bmVzLmxlbmd0aC0xXTtcbiAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCB0dW5lTGluZS5saW5lcy5sZW5ndGg7IGorKylcbiAgICAgICAgICAgIGxhc3RMaW5lLmxpbmVzLnB1c2godHVuZUxpbmUubGluZXNbal0pO1xuICAgIH1cblxuICAgIC8vIFRoZXNlIGl0ZW1zIGdvIGJlbG93IHRoZSBtdXNpY1xuICAgIHR1bmVMaW5lID0gdHVuZXNbdHVuZXMubGVuZ3RoLTFdO1xuICAgIHR1bmVMaW5lLm1ldGFUZXh0LnVuYWxpZ25lZFdvcmRzID0gdHVuZS5tZXRhVGV4dC51bmFsaWduZWRXb3JkcztcbiAgICB0dW5lTGluZS5tZXRhVGV4dC5ib29rID0gdHVuZS5tZXRhVGV4dC5ib29rO1xuICAgIHR1bmVMaW5lLm1ldGFUZXh0LnNvdXJjZSA9IHR1bmUubWV0YVRleHQuc291cmNlO1xuICAgIHR1bmVMaW5lLm1ldGFUZXh0LmRpc2NvZ3JhcGh5ID0gdHVuZS5tZXRhVGV4dC5kaXNjb2dyYXBoeTtcbiAgICB0dW5lTGluZS5tZXRhVGV4dC5ub3RlcyA9IHR1bmUubWV0YVRleHQubm90ZXM7XG4gICAgdHVuZUxpbmUubWV0YVRleHQudHJhbnNjcmlwdGlvbiA9IHR1bmUubWV0YVRleHQudHJhbnNjcmlwdGlvbjtcbiAgICB0dW5lTGluZS5tZXRhVGV4dC5oaXN0b3J5ID0gdHVuZS5tZXRhVGV4dC5oaXN0b3J5O1xuICAgIHR1bmVMaW5lLm1ldGFUZXh0WydhYmMtY29weXJpZ2h0J10gPSB0dW5lLm1ldGFUZXh0WydhYmMtY29weXJpZ2h0J107XG4gICAgdHVuZUxpbmUubWV0YVRleHRbJ2FiYy1jcmVhdG9yJ10gPSB0dW5lLm1ldGFUZXh0WydhYmMtY3JlYXRvciddO1xuICAgIHR1bmVMaW5lLm1ldGFUZXh0WydhYmMtZWRpdGVkLWJ5J10gPSB0dW5lLm1ldGFUZXh0WydhYmMtZWRpdGVkLWJ5J107XG4gICAgdHVuZUxpbmUubWV0YVRleHQuZm9vdGVyID0gdHVuZS5tZXRhVGV4dC5mb290ZXI7XG5cbiAgICAvLyBOb3cgY3JlYXRlIHN1Yi1kaXZzIGFuZCByZW5kZXIgZWFjaCBsaW5lLiBOZWVkIHRvIGNvcHkgdGhlIHBhcmFtcyB0byBjaGFuZ2UgdGhlIHBhZGRpbmcgZm9yIHRoZSBpbnRlcmlvciBzbGljZXMuXG4gICAgdmFyIGVwID0ge307XG4gICAgZm9yICh2YXIga2V5IGluIHBhcmFtcykge1xuICAgICAgICBpZiAocGFyYW1zLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgICAgIGVwW2tleV0gPSBwYXJhbXNba2V5XTtcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgb3JpZ1BhZGRpbmdUb3AgPSBlcC5wYWRkaW5ndG9wO1xuICAgIHZhciBvcmlnUGFkZGluZ0JvdHRvbSA9IGVwLnBhZGRpbmdib3R0b207XG4gICAgZGl2LmlubmVySFRNTCA9IFwiXCI7XG4gICAgZm9yICh2YXIgayA9IDA7IGsgPCB0dW5lcy5sZW5ndGg7IGsrKykge1xuICAgICAgICB2YXIgbGluZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgZGl2LmFwcGVuZENoaWxkKGxpbmVFbCk7XG5cbiAgICAgICAgaWYgKGsgPT09IDApIHtcblx0ICAgICAgICBlcC5wYWRkaW5ndG9wID0gb3JpZ1BhZGRpbmdUb3A7XG5cdCAgICAgICAgZXAucGFkZGluZ2JvdHRvbSA9IC0yMDtcbiAgICAgICAgfSBlbHNlIGlmIChrID09PSB0dW5lcy5sZW5ndGgtMSkge1xuXHQgICAgICAgIGVwLnBhZGRpbmd0b3AgPSAxMDtcblx0ICAgICAgICBlcC5wYWRkaW5nYm90dG9tID0gb3JpZ1BhZGRpbmdCb3R0b207XG4gICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgZXAucGFkZGluZ3RvcCA9IDEwO1xuXHQgICAgICAgIGVwLnBhZGRpbmdib3R0b20gPSAtMjA7XG4gICAgICAgIH1cbiAgICAgICAgcmVuZGVyT25lKGxpbmVFbCwgdHVuZXNba10sIGVwLCB0dW5lTnVtYmVyKTtcbiAgICB9XG59XG5cbi8vIEEgcXVpY2sgd2F5IHRvIHJlbmRlciBhIHR1bmUgZnJvbSBqYXZhc2NyaXB0IHdoZW4gaW50ZXJhY3Rpdml0eSBpcyBub3QgcmVxdWlyZWQuXG4vLyBUaGlzIGlzIHVzZWQgd2hlbiBhIGphdmFzY3JpcHQgcm91dGluZSBoYXMgc29tZSBhYmMgdGV4dCB0aGF0IGl0IHdhbnRzIHRvIHJlbmRlclxuLy8gaW4gYSBkaXYgb3IgY29sbGVjdGlvbiBvZiBkaXZzLiBPbmUgdHVuZSBvciBtYW55IGNhbiBiZSByZW5kZXJlZC5cbi8vXG4vLyBwYXJhbWV0ZXJzOlxuLy8gICAgICBvdXRwdXQ6IGFuIGFycmF5IG9mIGRpdnMgdGhhdCB0aGUgaW5kaXZpZHVhbCB0dW5lcyBhcmUgcmVuZGVyZWQgdG8uXG4vLyAgICAgICAgICBJZiB0aGUgbnVtYmVyIG9mIHR1bmVzIGV4Y2VlZHMgdGhlIG51bWJlciBvZiBkaXZzIGluIHRoZSBhcnJheSwgdGhlblxuLy8gICAgICAgICAgb25seSB0aGUgZmlyc3QgdHVuZXMgYXJlIHJlbmRlcmVkLiBJZiB0aGUgbnVtYmVyIG9mIGRpdnMgZXhjZWVkcyB0aGUgbnVtYmVyXG4vLyAgICAgICAgICBvZiB0dW5lcywgdGhlbiB0aGUgdW51c2VkIGRpdnMgYXJlIGNsZWFyZWQuIFRoZSBkaXZzIGNhbiBiZSBwYXNzZWQgYXMgZWl0aGVyXG4vLyAgICAgICAgICBlbGVtZW50cyBvciBzdHJpbmdzIG9mIGlkcy4gSWYgaWRzIGFyZSBwYXNzZWQsIHRoZW4gdGhlIGRpdiBNVVNUIGV4aXN0IGFscmVhZHkuXG4vLyAgICAgICAgICAoaWYgYSBzaW5nbGUgZWxlbWVudCBpcyBwYXNzZWQsIHRoZW4gaXQgaXMgYW4gaW1wbGllZCBhcnJheSBvZiBsZW5ndGggb25lLilcbi8vICAgICAgICAgIChpZiBhIG51bGwgaXMgcGFzc2VkIGZvciBhbiBlbGVtZW50LCBvciB0aGUgZWxlbWVudCBkb2Vzbid0IGV4aXN0LCB0aGVuIHRoYXQgdHVuZSBpcyBza2lwcGVkLilcbi8vICAgICAgYWJjOiB0ZXh0IHJlcHJlc2VudGluZyBhIHR1bmUgb3IgYW4gZW50aXJlIHR1bmUgYm9vayBpbiBBQkMgbm90YXRpb24uXG4vLyAgICAgIHJlbmRlclBhcmFtczogaGFzaCBvZjpcbi8vICAgICAgICAgIHN0YXJ0aW5nVHVuZTogYW4gaW5kZXgsIHN0YXJ0aW5nIGF0IHplcm8sIHJlcHJlc2VudGluZyB3aGljaCB0dW5lIHRvIHN0YXJ0IHJlbmRlcmluZyBhdC5cbi8vICAgICAgICAgICAgICAoSWYgdGhpcyBlbGVtZW50IGlzIG5vdCBwcmVzZW50LCB0aGVuIHJlbmRlcmluZyBzdGFydHMgYXQgemVyby4pXG4vLyAgICAgICAgICB3aWR0aDogODAwIGJ5IGRlZmF1bHQuIFRoZSB3aWR0aCBpbiBwaXhlbHMgb2YgdGhlIG91dHB1dCBwYXBlclxudmFyIHJlbmRlckFiYyA9IGZ1bmN0aW9uKG91dHB1dCwgYWJjLCBwYXJzZXJQYXJhbXMsIGVuZ3JhdmVyUGFyYW1zLCByZW5kZXJQYXJhbXMpIHtcbiAgICAvLyBOb3RlOiBhbGwgcGFyYW1ldGVycyBoYXZlIGJlZW4gY29uZGVuc2VkIGludG8gdGhlIGZpcnN0IG9uZXMuIEl0IGRvZXNuJ3QgaHVydCBhbnl0aGluZyB0byBhbGxvdyB0aGUgb2xkIGZvcm1hdCwgc28ganVzdCBjb3B5IHRoZW0gaGVyZS5cbiAgICB2YXIgcGFyYW1zID0ge307XG4gICAgdmFyIGtleTtcbiAgICBpZiAocGFyc2VyUGFyYW1zKSB7XG4gICAgICAgIGZvciAoa2V5IGluIHBhcnNlclBhcmFtcykge1xuICAgICAgICAgICAgaWYgKHBhcnNlclBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgICAgICAgICAgcGFyYW1zW2tleV0gPSBwYXJzZXJQYXJhbXNba2V5XTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoZW5ncmF2ZXJQYXJhbXMpIHtcbiAgICAgICAgZm9yIChrZXkgaW4gZW5ncmF2ZXJQYXJhbXMpIHtcbiAgICAgICAgICAgIGlmIChlbmdyYXZlclBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdCAgICAgICAgICAgIC8vIFRoZXJlIGlzIGEgY29uZmxpY3Qgd2l0aCB0aGUgbmFtZSBvZiB0aGUgcGFyYW1ldGVyIFwibGlzdGVuZXJcIi4gSWYgaXQgaXMgaW4gdGhlIHNlY29uZCBwYXJhbWV0ZXIsIHRoZW4gaXQgaXMgZm9yIGNsaWNrLlxuXHQgICAgICAgICAgICBpZiAoa2V5ID09PSBcImxpc3RlbmVyXCIpIHtcblx0ICAgICAgICAgICAgXHRpZiAoZW5ncmF2ZXJQYXJhbXNba2V5XS5oaWdobGlnaHQpXG5cdFx0ICAgICAgICAgICAgICAgIHBhcmFtcy5jbGlja0xpc3RlbmVyID0gZW5ncmF2ZXJQYXJhbXNba2V5XS5oaWdobGlnaHQ7XG5cdCAgICAgICAgICAgIH0gZWxzZVxuICAgICAgICAgICAgICAgICAgICBwYXJhbXNba2V5XSA9IGVuZ3JhdmVyUGFyYW1zW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKHJlbmRlclBhcmFtcykge1xuICAgICAgICBmb3IgKGtleSBpbiByZW5kZXJQYXJhbXMpIHtcbiAgICAgICAgICAgIGlmIChyZW5kZXJQYXJhbXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICAgICAgICAgIHBhcmFtc1trZXldID0gcmVuZGVyUGFyYW1zW2tleV07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBjYWxsYmFjayhkaXYsIHR1bmUsIHR1bmVOdW1iZXIsIGFiY1N0cmluZykge1xuICAgICAgICBpZiAocGFyYW1zLndyYXAgJiYgcGFyYW1zLnN0YWZmd2lkdGgpIHtcblx0ICAgICAgICB0dW5lID0gZG9MaW5lV3JhcHBpbmcoZGl2LCB0dW5lLCB0dW5lTnVtYmVyLCBhYmNTdHJpbmcsIHBhcmFtcyk7XG5cdCAgICAgICAgcmV0dXJuIHR1bmU7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAoIXBhcmFtcy5vbmVTdmdQZXJMaW5lIHx8IHR1bmUubGluZXMubGVuZ3RoIDwgMilcbiAgICAgICAgICAgIHJlbmRlck9uZShkaXYsIHR1bmUsIHBhcmFtcywgdHVuZU51bWJlcik7XG4gICAgICAgIGVsc2VcbiAgICAgICAgICAgIHJlbmRlckVhY2hMaW5lU2VwYXJhdGVseShkaXYsIHR1bmUsIHBhcmFtcywgdHVuZU51bWJlcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cblxuICAgIHJldHVybiB0dW5lYm9vay5yZW5kZXJFbmdpbmUoY2FsbGJhY2ssIG91dHB1dCwgYWJjLCBwYXJhbXMpO1xufTtcblxuZnVuY3Rpb24gY2FsY0xpbmVCcmVha3Mod2lkdGhzLCBsaW5lQnJlYWtQb2ludCkge1xuXHR2YXIgbGluZUJyZWFrcyA9IFtdO1xuXHR2YXIgdG90YWxUaGlzTGluZSA9IDA7XG5cdC8vIHJ1biB0aHJvdWdoIGVhY2ggbWVhc3VyZSBhbmQgc2VlIGlmIHRoZSBhY2N1bXVsYXRpb24gaXMgbGVzcyB0aGFuIHRoZSBpZGVhbC5cblx0Ly8gaWYgaXQgcGFzc2VzIHRoZSBpZGVhbCwgdGhlbiBzZWUgd2hldGhlciB0aGUgbGFzdCBvciB0aGlzIG9uZSBpcyBjbG9zZXIgdG8gdGhlIGlkZWFsLlxuXHRmb3IgKHZhciBpID0gMDsgaSA8IHdpZHRocy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciB3aWR0aCA9IHdpZHRoc1tpXTtcblx0XHR2YXIgYXR0ZW1wdGVkV2lkdGggPSB0b3RhbFRoaXNMaW5lICsgd2lkdGg7XG5cdFx0aWYgKGF0dGVtcHRlZFdpZHRoIDwgbGluZUJyZWFrUG9pbnQpXG5cdFx0XHR0b3RhbFRoaXNMaW5lID0gYXR0ZW1wdGVkV2lkdGg7XG5cdFx0ZWxzZSB7XG5cdFx0XHQvLyBUaGlzIGp1c3QgcGFzc2VkIHRoZSBpZGVhbCwgc28gc2VlIHdoZXRoZXIgdGhlIHByZXZpb3VzIG9yIHRoZSBjdXJyZW50IG51bWJlciBvZiBtZWFzdXJlcyBpcyBjbG9zZXIuXG5cdFx0XHR2YXIgb2xkRGlzdGFuY2UgPSBsaW5lQnJlYWtQb2ludCAtIHRvdGFsVGhpc0xpbmU7XG5cdFx0XHR2YXIgbmV3RGlzdGFuY2UgPSBhdHRlbXB0ZWRXaWR0aCAtIGxpbmVCcmVha1BvaW50O1xuXHRcdFx0aWYgKG9sZERpc3RhbmNlIDwgbmV3RGlzdGFuY2UgJiYgdG90YWxUaGlzTGluZSA+IDApIHtcblx0XHRcdFx0bGluZUJyZWFrcy5wdXNoKGkgLSAxKTtcblx0XHRcdFx0dG90YWxUaGlzTGluZSA9IHdpZHRoO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bGluZUJyZWFrcy5wdXNoKGkpO1xuXHRcdFx0XHR0b3RhbFRoaXNMaW5lID0gMDtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0cmV0dXJuIHsgbGluZUJyZWFrczogbGluZUJyZWFrcywgdG90YWxUaGlzTGluZTogdG90YWxUaGlzTGluZSB9O1xufVxuXG5mdW5jdGlvbiBkb0xpbmVXcmFwcGluZyhkaXYsIHR1bmUsIHR1bmVOdW1iZXIsIGFiY1N0cmluZywgcGFyYW1zKSB7XG5cdHZhciBlbmdyYXZlcl9jb250cm9sbGVyID0gbmV3IEVuZ3JhdmVyQ29udHJvbGxlcihkaXYsIHBhcmFtcyk7XG5cdHZhciB3aWR0aHMgPSBlbmdyYXZlcl9jb250cm9sbGVyLmdldE1lYXN1cmVXaWR0aHModHVuZSk7XG4gICAgLy8gRm9yIGNhbGN1bGF0aW5nIGhvdyBtdWNoIGNhbiBnbyBvbiB0aGUgbGluZSwgaXQgZGVwZW5kcyBvbiB0aGUgd2lkdGggb2YgdGhlIGxpbmUuIEl0IGlzIGEgY29udmVuaWVuY2UgdG8ganVzdCBkaXZpZGUgaXQgaGVyZVxuICAgIC8vIGJ5IHRoZSBtaW5pbXVtIHNwYWNpbmcgaW5zdGVhZCBvZiBtdWx0aXBseWluZyB0aGUgbWluIHNwYWNpbmcgbGF0ZXIuXG4gICAgLy8gVGhlIHNjYWxpbmcgd29ya3MgZGlmZmVyZW50bHk6IHRoaXMgaXMgZG9uZSBieSBjaGFuZ2luZyB0aGUgc2NhbGluZyBvZiB0aGUgb3V0ZXIgU1ZHLCBzbyB0aGUgc2NhbGluZyBuZWVkcyB0byBiZSBjb21wZW5zYXRlZFxuICAgIC8vIGZvciBoZXJlLCBiZWNhdXNlIHRoZSBhY3R1YWwgd2lkdGggd2lsbCBiZSBkaWZmZXJlbnQgZnJvbSB0aGUgY2FsY3VsYXRlZCBudW1iZXJzLlxuXHR2YXIgc2NhbGUgPSBwYXJhbXMuc2NhbGUgPyBNYXRoLm1heChwYXJhbXMuc2NhbGUsIDAuMSkgOiAxO1xuXHR2YXIgbWluU3BhY2luZyA9IHBhcmFtcy53cmFwLm1pblNwYWNpbmcgPyBNYXRoLm1heChwYXJzZUZsb2F0KHBhcmFtcy53cmFwLm1pblNwYWNpbmcpLCAxKSA6IDE7XG5cdHZhciBvbmx5TGluZUxpbWl0ID0gcGFyYW1zLndyYXAub25seUxpbmVMaW1pdCA/IE1hdGgubWF4KHBhcnNlRmxvYXQocGFyYW1zLndyYXAub25seUxpbmVMaW1pdCksIDEpIDogNTtcblx0dmFyIGxhc3RMaW5lTGltaXQgPSBwYXJhbXMud3JhcC5sYXN0TGluZUxpbWl0ID8gTWF0aC5tYXgocGFyc2VGbG9hdChwYXJhbXMud3JhcC5sYXN0TGluZUxpbWl0KSwgMSkgOiA1O1xuXHR2YXIgbGluZUJyZWFrUG9pbnQgPSAocGFyYW1zLnN0YWZmd2lkdGggLSB3aWR0aHMubGVmdCkgLyBtaW5TcGFjaW5nIC8gc2NhbGU7XG5cdHZhciBtaW5MaW5lU2l6ZSA9IChwYXJhbXMuc3RhZmZ3aWR0aCAtIHdpZHRocy5sZWZ0KSAvIG9ubHlMaW5lTGltaXQgLyBzY2FsZTtcblx0dmFyIG1pbkxhc3RMaW5lU2l6ZSA9IChwYXJhbXMuc3RhZmZ3aWR0aCAtIHdpZHRocy5sZWZ0KSAvIGxhc3RMaW5lTGltaXQgLyBzY2FsZTtcblxuXHR2YXIgcmV0ID0gY2FsY0xpbmVCcmVha3Mod2lkdGhzLm1lYXN1cmVXaWR0aHMsIGxpbmVCcmVha1BvaW50KTtcblxuICAgIHZhciBzdGFmZldpZHRoID0gcGFyYW1zLnN0YWZmd2lkdGg7XG4gICAgaWYgKHJldC5saW5lQnJlYWtzLmxlbmd0aCA9PT0gMCkge1xuXHRcdC8vIEV2ZXJ5dGhpbmcgZml0cyBvbiBvbmUgbGluZSwgc28gc2VlIGlmIHRoZXJlIGlzIFRPTyBtdWNoIHNwYWNlIGFuZCB0aGUgc3RhZmYgd2lkdGggbmVlZHMgdG8gYmUgc2hvcnRlbmVkLlxuXHQgICAgaWYgKG1pbkxpbmVTaXplID4gMCAmJiByZXQudG90YWxUaGlzTGluZSA+IDApXG5cdFx0ICAgIHN0YWZmV2lkdGggPSBzdGFmZldpZHRoIC8gKG1pbkxpbmVTaXplIC8gcmV0LnRvdGFsVGhpc0xpbmUpO1xuICAgIH0gZWxzZSBpZiAocmV0LnRvdGFsVGhpc0xpbmUgPCBtaW5MYXN0TGluZVNpemUpIHtcbiAgICBcdC8vIHRoZSBsYXN0IGxpbmUgaXMgdG9vIHNob3J0LCBzbyBhdHRlbXB0IHRvIHJlZGlzdHJpYnV0ZSBieSBjaGFuZ2luZyB0aGUgbWluLlxuXHQgICAgLy8gV2Ugd2lsbCB0cnkgbW9yZSBhbmQgbGVzcyBzcGFjZSBhbHRlcm5hdGl2ZWx5LiBUaGUgc3BhY2UgY2FuJ3QgYmUgbGVzcyB0aGFuIDEuMCwgYW5kIHdlJ2xsIHRyeSBpbiAwLjEgaW5jcmVtZW50cy5cblx0ICAgIHZhciBtaW5UcnlzID0gW107XG5cdCAgICBpZiAobWluU3BhY2luZyA+IDEuMSlcblx0ICAgIFx0bWluVHJ5cy5wdXNoKG1pblNwYWNpbmcgLSAwLjEpO1xuXHQgICAgbWluVHJ5cy5wdXNoKG1pblNwYWNpbmcgKyAwLjEpO1xuXHQgICAgaWYgKG1pblNwYWNpbmcgPiAxLjIpXG5cdCAgICBcdG1pblRyeXMucHVzaChtaW5TcGFjaW5nIC0gMC4yKTtcblx0ICAgIG1pblRyeXMucHVzaChtaW5TcGFjaW5nICsgMC4yKTtcblx0ICAgIGlmIChtaW5TcGFjaW5nID4gMS4zKVxuXHQgICAgXHRtaW5UcnlzLnB1c2gobWluU3BhY2luZyAtIDAuMyk7XG5cdCAgICBtaW5UcnlzLnB1c2gobWluU3BhY2luZyArIDAuMyk7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1pblRyeXMubGVuZ3RoICYmIHJldC50b3RhbFRoaXNMaW5lIDwgbWluTGFzdExpbmVTaXplOyBpKyspIHtcblx0XHQgICAgbGluZUJyZWFrUG9pbnQgPSAocGFyYW1zLnN0YWZmd2lkdGggLSB3aWR0aHMubGVmdCkgLyBtaW5UcnlzW2ldIC8gc2NhbGU7XG5cdFx0ICAgIHJldCA9IGNhbGNMaW5lQnJlYWtzKHdpZHRocy5tZWFzdXJlV2lkdGhzLCBsaW5lQnJlYWtQb2ludCk7XG5cdCAgICB9XG4gICAgfVxuXG5cdHZhciBhYmNQYXJzZXIgPSBuZXcgUGFyc2UoKTtcblx0dmFyIHJldmlzZWRQYXJhbXMgPSB7XG5cdCAgICBsaW5lQnJlYWtzOiByZXQubGluZUJyZWFrcyxcblx0XHRzdGFmZndpZHRoOiBzdGFmZldpZHRoXG4gICAgfTtcblx0Zm9yICh2YXIga2V5IGluIHBhcmFtcykge1xuXHRcdGlmIChwYXJhbXMuaGFzT3duUHJvcGVydHkoa2V5KSAmJiBrZXkgIT09ICd3cmFwJyAmJiBrZXkgIT09ICdzdGFmZndpZHRoJykge1xuXHRcdFx0cmV2aXNlZFBhcmFtc1trZXldID0gcGFyYW1zW2tleV07XG5cdFx0fVxuXHR9XG5cblx0YWJjUGFyc2VyLnBhcnNlKGFiY1N0cmluZywgcmV2aXNlZFBhcmFtcyk7XG5cdHR1bmUgPSBhYmNQYXJzZXIuZ2V0VHVuZSgpO1xuXHRyZW5kZXJPbmUoZGl2LCB0dW5lLCByZXZpc2VkUGFyYW1zLCB0dW5lTnVtYmVyKTtcblx0cmV0dXJuIHR1bmU7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmVuZGVyQWJjO1xuIiwiLy8gICAgYWJjX3R1bmUuanM6IGEgY29tcHV0ZXIgdXNhYmxlIGludGVybmFsIHN0cnVjdHVyZSByZXByZXNlbnRpbmcgb25lIHR1bmUuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBQYXVsIFJvc2VuIChwYXVsIGF0IHBhdWxyb3NlbiBkb3QgbmV0KVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgcGFyc2VDb21tb24gPSByZXF1aXJlKCcuLi9wYXJzZS9hYmNfY29tbW9uJyk7XG52YXIgcGFyc2VLZXlWb2ljZSA9IHJlcXVpcmUoJy4uL3BhcnNlL2FiY19wYXJzZV9rZXlfdm9pY2UnKTtcbnZhciBzcGFjaW5nID0gcmVxdWlyZSgnLi4vd3JpdGUvYWJjX3NwYWNpbmcnKTtcblxuLyoqXG4gKiBUaGlzIGlzIHRoZSBkYXRhIGZvciBhIHNpbmdsZSBBQkMgdHVuZS4gSXQgaXMgY3JlYXRlZCBhbmQgcG9wdWxhdGVkIGJ5IHRoZSB3aW5kb3cuQUJDSlMucGFyc2UuUGFyc2UgY2xhc3MuXG4gKiBBbHNvIGtub3duIGFzIHRoZSBBQkNKUyBBYnN0cmFjdCBTeW50YXggVHJlZVxuICogQGFsdGVybmF0ZUNsYXNzTmFtZSBBQkNKUy5UdW5lXG4gKi9cbnZhciBUdW5lID0gZnVuY3Rpb24oKSB7XG5cdC8vIFRoZSBzdHJ1Y3R1cmUgY29uc2lzdHMgb2YgYSBoYXNoIHdpdGggdGhlIGZvbGxvd2luZyB0d28gaXRlbXM6XG5cdC8vIG1ldGFUZXh0OiBhIGhhc2ggb2Yge2tleSwgdmFsdWV9LCB3aGVyZSBrZXkgaXMgb25lIG9mOiB0aXRsZSwgYXV0aG9yLCByaHl0aG0sIHNvdXJjZSwgdHJhbnNjcmlwdGlvbiwgdW5hbGlnbmVkV29yZHMsIGV0Yy4uLlxuXHQvLyB0ZW1wbzogeyBub3RlTGVuZ3RoOiBudW1iZXIgKGUuZy4gLjEyNSksIGJwbTogbnVtYmVyIH1cblx0Ly8gbGluZXM6IGFuIGFycmF5IG9mIGVsZW1lbnRzLCBvciBvbmUgb2YgdGhlIGZvbGxvd2luZzpcblx0Ly9cblx0Ly8gU1RBRkY6IGFycmF5IG9mIGVsZW1lbnRzXG5cdC8vIFNVQlRJVExFOiBzdHJpbmdcblx0Ly9cblx0Ly8gVE9ETzogYWN0dWFsbHksIHRoZSBzdGFydCBhbmQgZW5kIGNoYXIgc2hvdWxkIG1vZGlmeSBlYWNoIHBhcnQgb2YgdGhlIG5vdGUgdHlwZVxuXHQvLyBUaGUgZWxlbWVudHMgYWxsIGhhdmUgYSB0eXBlIGZpZWxkIGFuZCBhIHN0YXJ0IGFuZCBlbmQgY2hhclxuXHQvLyBmaWVsZC4gVGhlIHJlc3Qgb2YgdGhlIGZpZWxkcyBkZXBlbmQgb24gdGhlIHR5cGUgYW5kIGFyZSBsaXN0ZWQgYmVsb3c6XG5cdC8vIFJFU1Q6IGR1cmF0aW9uPTEsMiw0LDg7IGNob3JkOiBzdHJpbmdcblx0Ly8gTk9URTogYWNjaWRlbnRhbD1ub25lLGRibF9mbGF0LGZsYXQsbmF0dXJhbCxzaGFycCxkYmxfc2hhcnBcblx0Ly9cdFx0cGl0Y2g6IFwiQ1wiIGlzIDAuIFRoZSBudW1iZXJzIHJlZmVyIHRvIHRoZSBwaXRjaCBsZXR0ZXIuXG5cdC8vXHRcdGR1cmF0aW9uOiAuNSAoc2l4dGVlbnRoKSwgLjc1IChkb3R0ZWQgc2l4dGVlbnRoKSwgMSAoZWlnaHRoKSwgMS41IChkb3R0ZWQgZWlnaHRoKVxuXHQvL1x0XHRcdDIgKHF1YXJ0ZXIpLCAzIChkb3R0ZWQgcXVhcnRlciksIDQgKGhhbGYpLCA2IChkb3R0ZWQgaGFsZikgOCAod2hvbGUpXG5cdC8vXHRcdGNob3JkOiB7IG5hbWU6Y2hvcmQsIHBvc2l0aW9uOiBvbmUgb2YgJ2RlZmF1bHQnLCAnYWJvdmUnLCAnYmVsb3cnIH1cblx0Ly9cdFx0ZW5kX2JlYW0gPSB0cnVlIG9yIHVuZGVmaW5lZCBpZiB0aGlzIGlzIHRoZSBsYXN0IG5vdGUgaW4gYSBiZWFtLlxuXHQvL1x0XHRseXJpYzogYXJyYXkgb2YgeyBzeWxsYWJsZTogeHh4LCBkaXZpZGVyOiBvbmUgb2YgXCIgLV9cIiB9XG5cdC8vXHRcdHN0YXJ0VGllID0gdHJ1ZXx1bmRlZmluZWRcblx0Ly9cdFx0ZW5kVGllID0gdHJ1ZXx1bmRlZmluZWRcblx0Ly9cdFx0c3RhcnRUcmlwbGV0ID0gbnVtIDwtIHRoYXQgaXMgdGhlIG51bWJlciB0byBwcmludFxuXHQvL1x0XHRlbmRUcmlwbGV0ID0gdHJ1ZXx1bmRlZmluZWQgKHRoZSBsYXN0IG5vdGUgb2YgdGhlIHRyaXBsZXQpXG5cdC8vIFRPRE86IGFjdHVhbGx5LCBkZWNvcmF0aW9uIHNob3VsZCBiZSBhbiBhcnJheS5cblx0Ly9cdFx0ZGVjb3JhdGlvbjogdXBib3csIGRvd25ib3csIGFjY2VudFxuXHQvLyBCQVI6IHR5cGU9YmFyX3RoaW4sIGJhcl90aGluX3RoaWNrLCBiYXJfdGhpbl90aGluLCBiYXJfdGhpY2tfdGhpbiwgYmFyX3JpZ2h0X3JlcGVhdCwgYmFyX2xlZnRfcmVwZWF0LCBiYXJfZG91YmxlX3JlcGVhdFxuXHQvL1x0bnVtYmVyOiAxIG9yIDI6IGlmIGl0IGlzIHRoZSBzdGFydCBvZiBhIGZpcnN0IG9yIHNlY29uZCBlbmRpbmdcblx0Ly8gQ0xFRjogdHlwZT10cmVibGUsYmFzc1xuXHQvLyBLRVktU0lHOlxuXHQvL1x0XHRhY2NpZGVudGFsc1tdOiB7IGFjYzpzaGFycHxkYmxzaGFycHxuYXR1cmFsfGZsYXR8ZGJsZmxhdCwgIG5vdGU6YXxifGN8ZHxlfGZ8ZyB9XG5cdC8vIE1FVEVSOiB0eXBlOiBjb21tb25fdGltZSxjdXRfdGltZSxzcGVjaWZpZWRcblx0Ly9cdFx0aWYgc3BlY2lmaWVkLCB7IG51bTogOTksIGRlbjogOTkgfVxuXG5cdHRoaXMuZ2V0QmVhdExlbmd0aCA9IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKHRoaXMubGluZXNbaV0uc3RhZmYpIHtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLmxpbmVzW2ldLnN0YWZmLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0aWYgKHRoaXMubGluZXNbaV0uc3RhZmZbal0ubWV0ZXIpIHtcblx0XHRcdFx0XHRcdHZhciBtZXRlciA9IHRoaXMubGluZXNbaV0uc3RhZmZbal0ubWV0ZXI7XG5cdFx0XHRcdFx0XHRpZiAobWV0ZXIudHlwZSA9PT0gXCJzcGVjaWZpZWRcIikge1xuXHRcdFx0XHRcdFx0XHRpZiAobWV0ZXIudmFsdWUubGVuZ3RoID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBudW0gPSBwYXJzZUludChtZXRlci52YWx1ZVswXS5udW0sIDEwKTtcblx0XHRcdFx0XHRcdFx0XHR2YXIgZGVuID0gcGFyc2VJbnQobWV0ZXIudmFsdWVbMF0uZGVuLCAxMCk7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG51bSA9PT0gMyAmJiBkZW4gPT09IDgpIHJldHVybiAzLzg7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG51bSA9PT0gNiAmJiBkZW4gPT09IDgpIHJldHVybiAzLzg7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG51bSA9PT0gOSAmJiBkZW4gPT09IDgpIHJldHVybiAzLzg7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG51bSA9PT0gMTIgJiYgZGVuID09PSA4KSByZXR1cm4gMy84O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiAxL2Rlbjtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIDEvNDsgLy8gTm8gbWV0ZXIgd2FzIHNwZWNpZmllZCwgc28gdXNlIHRoaXMgZGVmYXVsdFxuXHRcdFx0XHRcdFx0fSBlbHNlIGlmIChtZXRlci50eXBlID09PSAnY3V0X3RpbWUnKSB7XG5cdFx0XHRcdFx0XHRcdHJldHVybiAxLzI7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRyZXR1cm4gMS80OyAvLyBUT0RPLVBFUjogdGhpcyB3b3JrcyBmb3IgY29tbW9uIHRpbWUsIGJ1dCBub3QgZm9yIHRoZSBhbmNpZW50IG1ldGVycy5cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIDEvNDsgLy8gTm8gbWV0ZXIgd2FzIHNwZWNpZmllZCwgc28gdXNlIHRoaXMgZGVmYXVsdFxuXHR9O1xuXG5cdHRoaXMuZ2V0UGlja3VwTGVuZ3RoID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIHBpY2t1cExlbmd0aCA9IDA7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodGhpcy5saW5lc1tpXS5zdGFmZikge1xuXHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMubGluZXNbaV0uc3RhZmYubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHRmb3IgKHZhciB2ID0gMDsgdiA8IHRoaXMubGluZXNbaV0uc3RhZmZbal0udm9pY2VzLmxlbmd0aDsgdisrKSB7XG5cdFx0XHRcdFx0XHR2YXIgdm9pY2UgPSB0aGlzLmxpbmVzW2ldLnN0YWZmW2pdLnZvaWNlc1t2XTtcblx0XHRcdFx0XHRcdHZhciBoYXNOb3RlID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBlbCA9IDA7IGVsIDwgdm9pY2UubGVuZ3RoOyBlbCsrKSB7XG5cdFx0XHRcdFx0XHRcdGlmICh2b2ljZVtlbF0uZHVyYXRpb24pXG5cdFx0XHRcdFx0XHRcdFx0cGlja3VwTGVuZ3RoICs9IHZvaWNlW2VsXS5kdXJhdGlvbjtcblx0XHRcdFx0XHRcdFx0aWYgKHBpY2t1cExlbmd0aCA+PSB0aGlzLmdldEJhckxlbmd0aCgpKVxuXHRcdFx0XHRcdFx0XHRcdHBpY2t1cExlbmd0aCAtPSB0aGlzLmdldEJhckxlbmd0aCgpO1xuXHRcdFx0XHRcdFx0XHRpZiAodm9pY2VbZWxdLmVsX3R5cGUgPT09ICdiYXInKVxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiBwaWNrdXBMZW5ndGg7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBwaWNrdXBMZW5ndGg7XG5cdH07XG5cblx0dGhpcy5nZXRCYXJMZW5ndGggPSBmdW5jdGlvbigpIHtcblx0XHR2YXIgbWV0ZXIgPSB0aGlzLmdldE1ldGVyRnJhY3Rpb24oKTtcblx0XHRyZXR1cm4gbWV0ZXIubnVtIC8gbWV0ZXIuZGVuO1xuXHR9O1xuXG5cdHRoaXMubWlsbGlzZWNvbmRzUGVyTWVhc3VyZSA9IGZ1bmN0aW9uKGJwbU92ZXJyaWRlKSB7XG5cdFx0dmFyIGJwbTtcblx0XHRpZiAoYnBtT3ZlcnJpZGUpIHtcblx0XHRcdGJwbSA9IGJwbU92ZXJyaWRlO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHR2YXIgdGVtcG8gPSB0aGlzLm1ldGFUZXh0ID8gdGhpcy5tZXRhVGV4dC50ZW1wbyA6IG51bGw7XG5cdFx0XHRicG0gPSB0aGlzLmdldEJwbSh0ZW1wbyk7XG5cdFx0fVxuXHRcdGlmIChicG0gPD0gMClcblx0XHRcdGJwbSA9IDE7IC8vIEkgZG9uJ3QgdGhpbmsgdGhpcyBjYW4gaGFwcGVuLCBidXQgd2UgZG9uJ3Qgd2FudCBhIHBvc3NpYmlsaXR5IG9mIGRpdmlkaW5nIGJ5IHplcm8uXG5cblx0XHR2YXIgYmVhdHNQZXJNZWFzdXJlO1xuXHRcdHZhciBtZXRlciA9IHRoaXMuZ2V0TWV0ZXJGcmFjdGlvbigpO1xuXHRcdGlmIChtZXRlci5kZW4gPT09IDgpIHtcblx0XHRcdGJlYXRzUGVyTWVhc3VyZSA9IG1ldGVyLm51bSAvIDM7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGJlYXRzUGVyTWVhc3VyZSA9IG1ldGVyLm51bTtcblx0XHR9XG5cdFx0aWYgKGJlYXRzUGVyTWVhc3VyZSA8PSAwKSAvLyBUaGlzIHByb2JhYmx5IHdvbid0IGhhcHBlbiBpbiBhbnkgbm9ybWFsIGNhc2UgLSBidXQgaXQgaXMgcG9zc2libGUgdGhhdCB0aGUgbWV0ZXIgY291bGQgYmUgc2V0IHRvIHNvbWV0aGluZyBub25zZW5zaWNhbC5cblx0XHRcdGJlYXRzUGVyTWVhc3VyZSA9IDE7XG5cblx0XHR2YXIgbWludXRlc1Blck1lYXN1cmUgPSBiZWF0c1Blck1lYXN1cmUgLyBicG07XG5cdFx0cmV0dXJuIG1pbnV0ZXNQZXJNZWFzdXJlICogNjAwMDA7XG5cdH07XG5cblx0dGhpcy5yZXNldCA9IGZ1bmN0aW9uICgpIHtcblx0XHR0aGlzLnZlcnNpb24gPSBcIjEuMC4xXCI7XG5cdFx0dGhpcy5tZWRpYSA9IFwic2NyZWVuXCI7XG5cdFx0dGhpcy5tZXRhVGV4dCA9IHt9O1xuXHRcdHRoaXMuZm9ybWF0dGluZyA9IHt9O1xuXHRcdHRoaXMubGluZXMgPSBbXTtcblx0XHR0aGlzLnN0YWZmTnVtID0gMDtcblx0XHR0aGlzLnZvaWNlTnVtID0gMDtcblx0XHR0aGlzLmxpbmVOdW0gPSAwO1xuXHR9O1xuXG5cdHRoaXMucmVzb2x2ZU92ZXJsYXlzID0gZnVuY3Rpb24oKSB7XG5cdFx0dmFyIG1hZGVDaGFuZ2VzID0gZmFsc2U7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgbGluZSA9IHRoaXMubGluZXNbaV07XG5cdFx0XHRpZiAobGluZS5zdGFmZikge1xuXHRcdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IGxpbmUuc3RhZmYubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0XHR2YXIgc3RhZmYgPSBsaW5lLnN0YWZmW2pdO1xuXHRcdFx0XHRcdHZhciBvdmVybGF5Vm9pY2UgPSBbXTtcblx0XHRcdFx0XHRmb3IgKHZhciBrID0gMDsgayA8IHN0YWZmLnZvaWNlcy5sZW5ndGg7IGsrKykge1xuXHRcdFx0XHRcdFx0dmFyIHZvaWNlID0gc3RhZmYudm9pY2VzW2tdO1xuXHRcdFx0XHRcdFx0b3ZlcmxheVZvaWNlLnB1c2goeyBoYXNPdmVybGF5OiBmYWxzZSwgdm9pY2U6IFtdLCBzbmlwOiBbXX0pO1xuXHRcdFx0XHRcdFx0dmFyIGR1cmF0aW9uVGhpc0JhciA9IDA7XG5cdFx0XHRcdFx0XHR2YXIgaW5PdmVybGF5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR2YXIgc25pcFN0YXJ0ID0gLTE7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBrayA9IDA7IGtrIDwgdm9pY2UubGVuZ3RoOyBraysrKSB7XG5cdFx0XHRcdFx0XHRcdHZhciBldmVudCA9IHZvaWNlW2trXTtcblx0XHRcdFx0XHRcdFx0aWYgKGV2ZW50LmVsX3R5cGUgPT09IFwib3ZlcmxheVwiICYmICFpbk92ZXJsYXkpIHtcblx0XHRcdFx0XHRcdFx0XHRtYWRlQ2hhbmdlcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0aW5PdmVybGF5ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRzbmlwU3RhcnQgPSBraztcblx0XHRcdFx0XHRcdFx0XHRvdmVybGF5Vm9pY2Vba10uaGFzT3ZlcmxheSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuZWxfdHlwZSA9PT0gXCJiYXJcIikge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChpbk92ZXJsYXkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdC8vIGRlbGV0ZSB0aGUgb3ZlcmxheSBldmVudHMgZnJvbSB0aGlzIGFycmF5IHdpdGhvdXQgbWVzc2luZyB1cCB0aGlzIGxvb3AuXG5cdFx0XHRcdFx0XHRcdFx0XHRpbk92ZXJsYXkgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHRcdG92ZXJsYXlWb2ljZVtrXS5zbmlwLnB1c2goeyBzdGFydDogc25pcFN0YXJ0LCBsZW46IGtrIC0gc25pcFN0YXJ0fSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRvdmVybGF5Vm9pY2Vba10udm9pY2UucHVzaChldmVudCk7IC8vIEFsc28gZW5kIHRoZSBvdmVybGF5IHdpdGggdGhlIGJhcmxpbmUuXG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdG92ZXJsYXlWb2ljZVtrXS52b2ljZS5wdXNoKHsgZWxfdHlwZTogXCJub3RlXCIsIGR1cmF0aW9uOiBkdXJhdGlvblRoaXNCYXIsIHJlc3Q6IHt0eXBlOiBcImludmlzaWJsZVwifSwgc3RhcnRDaGFyOiBldmVudC5zdGFydENoYXIsIGVuZENoYXI6IGV2ZW50LmVuZENoYXIgfSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRvdmVybGF5Vm9pY2Vba10udm9pY2UucHVzaChldmVudCk7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdGR1cmF0aW9uVGhpc0JhciA9IDA7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuZWxfdHlwZSA9PT0gXCJub3RlXCIpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoaW5PdmVybGF5KSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRvdmVybGF5Vm9pY2Vba10udm9pY2UucHVzaChldmVudCk7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGR1cmF0aW9uVGhpc0JhciArPSBldmVudC5kdXJhdGlvbjtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoZXZlbnQuZWxfdHlwZSA9PT0gXCJzY2FsZVwiIHx8IGV2ZW50LmVsX3R5cGUgPT09IFwic3RlbVwiIHx8IGV2ZW50LmVsX3R5cGUgPT09IFwib3ZlcmxheVwiIHx8IGV2ZW50LmVsX3R5cGUgPT09IFwic3R5bGVcIiB8fCBldmVudC5lbF90eXBlID09PSBcInRyYW5zcG9zZVwiKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gVGhlc2UgdHlwZXMgb2YgZXZlbnRzIGFyZSBkdXBsaWNhdGVkIG9uIHRoZSBvdmVybGF5IGxheWVyLlxuXHRcdFx0XHRcdFx0XHRcdG92ZXJsYXlWb2ljZVtrXS52b2ljZS5wdXNoKGV2ZW50KTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKG92ZXJsYXlWb2ljZVtrXS5oYXNPdmVybGF5ICYmIG92ZXJsYXlWb2ljZVtrXS5zbmlwLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHQvLyB0aGVyZSB3YXMgbm8gY2xvc2luZyBiYXIsIHNvIHdlIGRpZG4ndCBzZXQgdGhlIHNuaXAgYW1vdW50LlxuXHRcdFx0XHRcdFx0XHRvdmVybGF5Vm9pY2Vba10uc25pcC5wdXNoKHsgc3RhcnQ6IHNuaXBTdGFydCwgbGVuOiB2b2ljZS5sZW5ndGggLSBzbmlwU3RhcnR9KTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0Zm9yIChrID0gMDsgayA8IG92ZXJsYXlWb2ljZS5sZW5ndGg7IGsrKykge1xuXHRcdFx0XHRcdFx0dmFyIG92ID0gb3ZlcmxheVZvaWNlW2tdO1xuXHRcdFx0XHRcdFx0aWYgKG92Lmhhc092ZXJsYXkpIHtcblx0XHRcdFx0XHRcdFx0c3RhZmYudm9pY2VzLnB1c2gob3Yudm9pY2UpO1xuXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBra2sgPSBvdi5zbmlwLmxlbmd0aC0xOyBra2sgPj0gMDsga2trLS0pIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgc25pcCA9IG92LnNuaXBba2trXTtcblx0XHRcdFx0XHRcdFx0XHRzdGFmZi52b2ljZXNba10uc3BsaWNlKHNuaXAuc3RhcnQsIHNuaXAubGVuKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbWFkZUNoYW5nZXM7XG5cdH07XG5cblx0dGhpcy5jbGVhblVwID0gZnVuY3Rpb24oZGVmV2lkdGgsIGRlZkxlbmd0aCwgYmFyc3BlcnN0YWZmLCBzdGFmZm5vbm90ZSwgY3VyclNsdXIpIHtcblx0XHR0aGlzLmNsb3NlTGluZSgpO1x0Ly8gQ2xvc2UgdGhlIGxhc3QgbGluZS5cblxuXHRcdC8vIElmIHRoZSB0ZW1wbyB3YXMgY3JlYXRlZCB3aXRoIGEgc3RyaW5nIGxpa2UgXCJBbGxlZ3JvXCIsIHRoZW4gdGhlIGR1cmF0aW9uIG9mIGEgYmVhdCBuZWVkcyB0byBiZSBzZXQgYXQgdGhlIGxhc3QgbW9tZW50LCB3aGVuIGl0IGlzIG1vc3QgbGlrZWx5IGtub3duLlxuXHRcdGlmICh0aGlzLm1ldGFUZXh0LnRlbXBvICYmIHRoaXMubWV0YVRleHQudGVtcG8uYnBtICYmICF0aGlzLm1ldGFUZXh0LnRlbXBvLmR1cmF0aW9uKVxuXHRcdFx0dGhpcy5tZXRhVGV4dC50ZW1wby5kdXJhdGlvbiA9IFsgdGhpcy5nZXRCZWF0TGVuZ3RoKCkgXTtcblxuXHRcdC8vIFJlbW92ZSBhbnkgYmxhbmsgbGluZXNcblx0XHR2YXIgYW55RGVsZXRlZCA9IGZhbHNlO1xuXHRcdHZhciBpLCBzLCB2O1xuXHRcdGZvciAoaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodGhpcy5saW5lc1tpXS5zdGFmZiAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdHZhciBoYXNBbnkgPSBmYWxzZTtcblx0XHRcdFx0Zm9yIChzID0gMDsgcyA8IHRoaXMubGluZXNbaV0uc3RhZmYubGVuZ3RoOyBzKyspIHtcblx0XHRcdFx0XHRpZiAodGhpcy5saW5lc1tpXS5zdGFmZltzXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRhbnlEZWxldGVkID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHRoaXMubGluZXNbaV0uc3RhZmZbc10gPSBudWxsO1xuXHRcdFx0XHRcdFx0Ly90aGlzLmxpbmVzW2ldLnN0YWZmW3NdID0geyB2b2ljZXM6IFtdfTtcdC8vIFRPRE8tUEVSOiBUaGVyZSB3YXMgYSBwYXJ0IG1pc3NpbmcgaW4gdGhlIGFiYyBtdXNpYy4gSG93IHNob3VsZCB3ZSByZWNvdmVyP1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRmb3IgKHYgPSAwOyB2IDwgdGhpcy5saW5lc1tpXS5zdGFmZltzXS52b2ljZXMubGVuZ3RoOyB2KyspIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMubGluZXNbaV0uc3RhZmZbc10udm9pY2VzW3ZdID09PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRcdFx0dGhpcy5saW5lc1tpXS5zdGFmZltzXS52b2ljZXNbdl0gPSBbXTtcdC8vIFRPRE8tUEVSOiBUaGVyZSB3YXMgYSBwYXJ0IG1pc3NpbmcgaW4gdGhlIGFiYyBtdXNpYy4gSG93IHNob3VsZCB3ZSByZWNvdmVyP1xuXHRcdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuY29udGFpbnNOb3Rlcyh0aGlzLmxpbmVzW2ldLnN0YWZmW3NdLnZvaWNlc1t2XSkpIGhhc0FueSA9IHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghaGFzQW55KSB7XG5cdFx0XHRcdFx0dGhpcy5saW5lc1tpXSA9IG51bGw7XG5cdFx0XHRcdFx0YW55RGVsZXRlZCA9IHRydWU7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKGFueURlbGV0ZWQpIHtcblx0XHRcdHRoaXMubGluZXMgPSBwYXJzZUNvbW1vbi5jb21wYWN0KHRoaXMubGluZXMpO1xuXHRcdFx0cGFyc2VDb21tb24uZWFjaCh0aGlzLmxpbmVzLCBmdW5jdGlvbihsaW5lKSB7XG5cdFx0XHRcdGlmIChsaW5lLnN0YWZmKVxuXHRcdFx0XHRcdGxpbmUuc3RhZmYgPSBwYXJzZUNvbW1vbi5jb21wYWN0KGxpbmUuc3RhZmYpO1xuXHRcdFx0fSk7XG5cdFx0fVxuXG5cdFx0Ly8gaWYgd2UgZXhjZWVkZWQgdGhlIG51bWJlciBvZiBiYXJzIGFsbG93ZWQgb24gYSBsaW5lLCB0aGVuIGZvcmNlIGEgbmV3IGxpbmVcblx0XHRpZiAoYmFyc3BlcnN0YWZmKSB7XG5cdFx0XHR3aGlsZSAod3JhcE11c2ljTGluZXModGhpcy5saW5lcywgYmFyc3BlcnN0YWZmKSkge1xuXHRcdFx0XHQvLyBUaGlzIHdpbGwga2VlcCB3cmFwcGluZyB1bnRpbCB0aGUgZW5kIG9mIHRoZSBwaWVjZS5cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBJZiB3ZSB3ZXJlIHBhc3NlZCBzdGFmZm5vbm90ZSwgdGhlbiB3ZSB3YW50IHRvIGdldCByaWQgb2YgYWxsIHN0YWZmcyB0aGF0IGNvbnRhaW4gb25seSByZXN0cy5cblx0XHRpZiAoc3RhZmZub25vdGUpIHtcblx0XHRcdGFueURlbGV0ZWQgPSBmYWxzZTtcblx0XHRcdGZvciAoaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICh0aGlzLmxpbmVzW2ldLnN0YWZmICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRmb3IgKHMgPSAwOyBzIDwgdGhpcy5saW5lc1tpXS5zdGFmZi5sZW5ndGg7IHMrKykge1xuXHRcdFx0XHRcdFx0dmFyIGtlZXBUaGlzID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRmb3IgKHYgPSAwOyB2IDwgdGhpcy5saW5lc1tpXS5zdGFmZltzXS52b2ljZXMubGVuZ3RoOyB2KyspIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRoaXMuY29udGFpbnNOb3Rlc1N0cmljdCh0aGlzLmxpbmVzW2ldLnN0YWZmW3NdLnZvaWNlc1t2XSkpIHtcblx0XHRcdFx0XHRcdFx0XHRrZWVwVGhpcyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmICgha2VlcFRoaXMpIHtcblx0XHRcdFx0XHRcdFx0YW55RGVsZXRlZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdHRoaXMubGluZXNbaV0uc3RhZmZbc10gPSBudWxsO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0aWYgKGFueURlbGV0ZWQpIHtcblx0XHRcdFx0cGFyc2VDb21tb24uZWFjaCh0aGlzLmxpbmVzLCBmdW5jdGlvbihsaW5lKSB7XG5cdFx0XHRcdFx0aWYgKGxpbmUuc3RhZmYpXG5cdFx0XHRcdFx0XHRsaW5lLnN0YWZmID0gcGFyc2VDb21tb24uY29tcGFjdChsaW5lLnN0YWZmKTtcblx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0Ly8gUmVtb3ZlIHRoZSB0ZW1wb3Jhcnkgd29ya2luZyB2YXJpYWJsZXNcblx0XHRmb3IgKGkgPSAwOyBpIDwgdGhpcy5saW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKHRoaXMubGluZXNbaV0uc3RhZmYpIHtcblx0XHRcdFx0Zm9yIChzID0gMDsgcyA8IHRoaXMubGluZXNbaV0uc3RhZmYubGVuZ3RoOyBzKyspXG5cdFx0XHRcdFx0XHRkZWxldGUgdGhpcy5saW5lc1tpXS5zdGFmZltzXS53b3JraW5nQ2xlZjtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBJZiB0aGVyZSBhcmUgb3ZlcmxheXMsIGNyZWF0ZSBuZXcgdm9pY2VzIGZvciB0aGVtLlxuXHRcdHdoaWxlICh0aGlzLnJlc29sdmVPdmVybGF5cygpKSB7XG5cdFx0XHQvLyBrZWVwIHJlc29sdmluZyBvdmVybGF5cyBhcyBsb25nIGFzIGFueSBhcmUgZm91bmQuXG5cdFx0fVxuXG5cdFx0ZnVuY3Rpb24gY2xlYW5VcFNsdXJzSW5MaW5lKGxpbmUpIHtcblx0XHRcdHZhciB4O1xuLy9cdFx0XHR2YXIgbHlyID0gbnVsbDtcdC8vIFRPRE8tUEVSOiBkZWJ1Z2dpbmcuXG5cblx0XHRcdHZhciBhZGRFbmRTbHVyID0gZnVuY3Rpb24ob2JqLCBudW0sIGNob3JkUG9zKSB7XG5cdFx0XHRcdGlmIChjdXJyU2x1cltjaG9yZFBvc10gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdC8vIFRoZXJlIGlzbid0IGFuIGV4YWN0IG1hdGNoIGZvciBub3RlIHBvc2l0aW9uLCBidXQgd2UnbGwgdGFrZSBhbnkgb3RoZXIgb3BlbiBzbHVyLlxuXHRcdFx0XHRcdGZvciAoeCA9IDA7IHggPCBjdXJyU2x1ci5sZW5ndGg7IHgrKykge1xuXHRcdFx0XHRcdFx0aWYgKGN1cnJTbHVyW3hdICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFx0Y2hvcmRQb3MgPSB4O1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKGN1cnJTbHVyW2Nob3JkUG9zXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHR2YXIgb2ZmTnVtID0gY2hvcmRQb3MqMTAwKzE7XG5cdFx0XHRcdFx0XHRwYXJzZUNvbW1vbi5lYWNoKG9iai5lbmRTbHVyLCBmdW5jdGlvbih4KSB7IGlmIChvZmZOdW0gPT09IHgpIC0tb2ZmTnVtOyB9KTtcblx0XHRcdFx0XHRcdGN1cnJTbHVyW2Nob3JkUG9zXSA9IFtvZmZOdW1dO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgc2x1ck51bTtcblx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBudW07IGkrKykge1xuXHRcdFx0XHRcdHNsdXJOdW0gPSBjdXJyU2x1cltjaG9yZFBvc10ucG9wKCk7XG5cdFx0XHRcdFx0b2JqLmVuZFNsdXIucHVzaChzbHVyTnVtKTtcbi8vXHRcdFx0XHRcdGx5ci5zeWxsYWJsZSArPSAnPCcgKyBzbHVyTnVtO1x0Ly8gVE9ETy1QRVI6IGRlYnVnZ2luZ1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChjdXJyU2x1cltjaG9yZFBvc10ubGVuZ3RoID09PSAwKVxuXHRcdFx0XHRcdGRlbGV0ZSBjdXJyU2x1cltjaG9yZFBvc107XG5cdFx0XHRcdHJldHVybiBzbHVyTnVtO1xuXHRcdFx0fTtcblxuXHRcdFx0dmFyIGFkZFN0YXJ0U2x1ciA9IGZ1bmN0aW9uKG9iaiwgbnVtLCBjaG9yZFBvcywgdXNlZE51bXMpIHtcblx0XHRcdFx0b2JqLnN0YXJ0U2x1ciA9IFtdO1xuXHRcdFx0XHRpZiAoY3VyclNsdXJbY2hvcmRQb3NdID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRjdXJyU2x1cltjaG9yZFBvc10gPSBbXTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgbmV4dE51bSA9IGNob3JkUG9zKjEwMCsxO1xuXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG51bTsgaSsrKSB7XG5cdFx0XHRcdFx0aWYgKHVzZWROdW1zKSB7XG5cdFx0XHRcdFx0XHRwYXJzZUNvbW1vbi5lYWNoKHVzZWROdW1zLCBmdW5jdGlvbih4KSB7IGlmIChuZXh0TnVtID09PSB4KSArK25leHROdW07IH0pO1xuXHRcdFx0XHRcdFx0cGFyc2VDb21tb24uZWFjaCh1c2VkTnVtcywgZnVuY3Rpb24oeCkgeyBpZiAobmV4dE51bSA9PT0geCkgKytuZXh0TnVtOyB9KTtcblx0XHRcdFx0XHRcdHBhcnNlQ29tbW9uLmVhY2godXNlZE51bXMsIGZ1bmN0aW9uKHgpIHsgaWYgKG5leHROdW0gPT09IHgpICsrbmV4dE51bTsgfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHBhcnNlQ29tbW9uLmVhY2goY3VyclNsdXJbY2hvcmRQb3NdLCBmdW5jdGlvbih4KSB7IGlmIChuZXh0TnVtID09PSB4KSArK25leHROdW07IH0pO1xuXHRcdFx0XHRcdHBhcnNlQ29tbW9uLmVhY2goY3VyclNsdXJbY2hvcmRQb3NdLCBmdW5jdGlvbih4KSB7IGlmIChuZXh0TnVtID09PSB4KSArK25leHROdW07IH0pO1xuXG5cdFx0XHRcdFx0Y3VyclNsdXJbY2hvcmRQb3NdLnB1c2gobmV4dE51bSk7XG5cdFx0XHRcdFx0b2JqLnN0YXJ0U2x1ci5wdXNoKHsgbGFiZWw6IG5leHROdW0gfSk7XG4vL1x0XHRcdFx0XHRseXIuc3lsbGFibGUgKz0gJyAnICsgbmV4dE51bSArICc+JztcdC8vIFRPRE8tUEVSOmRlYnVnZ2luZ1xuXHRcdFx0XHRcdG5leHROdW0rKztcblx0XHRcdFx0fVxuXHRcdFx0fTtcblxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBlbCA9IGxpbmVbaV07XG4vL1x0XHRcdFx0aWYgKGVsLmx5cmljID09PSB1bmRlZmluZWQpXHQvLyBUT0RPLVBFUjogZGVidWdnaW5nXG4vL1x0XHRcdFx0XHRlbC5seXJpYyA9IFt7IGRpdmlkZXI6ICctJyB9XTtcdC8vIFRPRE8tUEVSOiBkZWJ1Z2dpbmdcbi8vXHRcdFx0XHRseXIgPSBlbC5seXJpY1swXTtcdC8vIFRPRE8tUEVSOiBkZWJ1Z2dpbmdcbi8vXHRcdFx0XHRseXIuc3lsbGFibGUgPSAnJztcdC8vIFRPRE8tUEVSOiBkZWJ1Z2dpbmdcblx0XHRcdFx0aWYgKGVsLmVsX3R5cGUgPT09ICdub3RlJykge1xuXHRcdFx0XHRcdGlmIChlbC5ncmFjZW5vdGVzKSB7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBnID0gMDsgZyA8IGVsLmdyYWNlbm90ZXMubGVuZ3RoOyBnKyspIHtcblx0XHRcdFx0XHRcdFx0aWYgKGVsLmdyYWNlbm90ZXNbZ10uZW5kU2x1cikge1xuXHRcdFx0XHRcdFx0XHRcdHZhciBnZyA9IGVsLmdyYWNlbm90ZXNbZ10uZW5kU2x1cjtcblx0XHRcdFx0XHRcdFx0XHRlbC5ncmFjZW5vdGVzW2ddLmVuZFNsdXIgPSBbXTtcblx0XHRcdFx0XHRcdFx0XHRmb3IgKHZhciBnZ2cgPSAwOyBnZ2cgPCBnZzsgZ2dnKyspXG5cdFx0XHRcdFx0XHRcdFx0XHRhZGRFbmRTbHVyKGVsLmdyYWNlbm90ZXNbZ10sIDEsIDIwKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpZiAoZWwuZ3JhY2Vub3Rlc1tnXS5zdGFydFNsdXIpIHtcblx0XHRcdFx0XHRcdFx0XHR4ID0gZWwuZ3JhY2Vub3Rlc1tnXS5zdGFydFNsdXI7XG5cdFx0XHRcdFx0XHRcdFx0YWRkU3RhcnRTbHVyKGVsLmdyYWNlbm90ZXNbZ10sIHgsIDIwKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZWwuZW5kU2x1cikge1xuXHRcdFx0XHRcdFx0eCA9IGVsLmVuZFNsdXI7XG5cdFx0XHRcdFx0XHRlbC5lbmRTbHVyID0gW107XG5cdFx0XHRcdFx0XHRhZGRFbmRTbHVyKGVsLCB4LCAwKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKGVsLnN0YXJ0U2x1cikge1xuXHRcdFx0XHRcdFx0eCA9IGVsLnN0YXJ0U2x1cjtcblx0XHRcdFx0XHRcdGFkZFN0YXJ0U2x1cihlbCwgeCwgMCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGlmIChlbC5waXRjaGVzKSB7XG5cdFx0XHRcdFx0XHR2YXIgdXNlZE51bXMgPSBbXTtcblx0XHRcdFx0XHRcdGZvciAodmFyIHAgPSAwOyBwIDwgZWwucGl0Y2hlcy5sZW5ndGg7IHArKykge1xuXHRcdFx0XHRcdFx0XHRpZiAoZWwucGl0Y2hlc1twXS5lbmRTbHVyKSB7XG5cdFx0XHRcdFx0XHRcdFx0dmFyIGsgPSBlbC5waXRjaGVzW3BdLmVuZFNsdXI7XG5cdFx0XHRcdFx0XHRcdFx0ZWwucGl0Y2hlc1twXS5lbmRTbHVyID0gW107XG5cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBrOyBqKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdHZhciBzbHVyTnVtID0gYWRkRW5kU2x1cihlbC5waXRjaGVzW3BdLCAxLCBwKzEpO1xuXHRcdFx0XHRcdFx0XHRcdFx0dXNlZE51bXMucHVzaChzbHVyTnVtKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGZvciAocCA9IDA7IHAgPCBlbC5waXRjaGVzLmxlbmd0aDsgcCsrKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChlbC5waXRjaGVzW3BdLnN0YXJ0U2x1cikge1xuXHRcdFx0XHRcdFx0XHRcdHggPSBlbC5waXRjaGVzW3BdLnN0YXJ0U2x1cjtcblx0XHRcdFx0XHRcdFx0XHRhZGRTdGFydFNsdXIoZWwucGl0Y2hlc1twXSwgeCwgcCsxLCB1c2VkTnVtcyk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdC8vIENvcnJlY3QgZm9yIHRoZSB3ZWlyZCBncmFjZW5vdGUgY2FzZSB3aGVyZSAoe2d9YSkgc2hvdWxkIG1hdGNoLlxuXHRcdFx0XHRcdFx0Ly8gVGhlIGVuZCBzbHVyIHdhcyBhbHJlYWR5IGFzc2lnbmVkIHRvIHRoZSBub3RlLCBhbmQgbmVlZHMgdG8gYmUgbW92ZWQgdG8gdGhlIGZpcnN0IG5vdGUgb2YgdGhlIGdyYWNlcy5cblx0XHRcdFx0XHRcdGlmIChlbC5ncmFjZW5vdGVzICYmIGVsLnBpdGNoZXNbMF0uZW5kU2x1ciAmJiBlbC5waXRjaGVzWzBdLmVuZFNsdXJbMF0gPT09IDEwMCAmJiBlbC5waXRjaGVzWzBdLnN0YXJ0U2x1cikge1xuXHRcdFx0XHRcdFx0XHRpZiAoZWwuZ3JhY2Vub3Rlc1swXS5lbmRTbHVyKVxuXHRcdFx0XHRcdFx0XHRcdGVsLmdyYWNlbm90ZXNbMF0uZW5kU2x1ci5wdXNoKGVsLnBpdGNoZXNbMF0uc3RhcnRTbHVyWzBdLmxhYmVsKTtcblx0XHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHRcdGVsLmdyYWNlbm90ZXNbMF0uZW5kU2x1ciA9IFtlbC5waXRjaGVzWzBdLnN0YXJ0U2x1clswXS5sYWJlbF07XG5cdFx0XHRcdFx0XHRcdGlmIChlbC5waXRjaGVzWzBdLmVuZFNsdXIubGVuZ3RoID09PSAxKVxuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBlbC5waXRjaGVzWzBdLmVuZFNsdXI7XG5cdFx0XHRcdFx0XHRcdGVsc2UgaWYgKGVsLnBpdGNoZXNbMF0uZW5kU2x1clswXSA9PT0gMTAwKVxuXHRcdFx0XHRcdFx0XHRcdGVsLnBpdGNoZXNbMF0uZW5kU2x1ci5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0XHRlbHNlIGlmIChlbC5waXRjaGVzWzBdLmVuZFNsdXJbZWwucGl0Y2hlc1swXS5lbmRTbHVyLmxlbmd0aC0xXSA9PT0gMTAwKVxuXHRcdFx0XHRcdFx0XHRcdGVsLnBpdGNoZXNbMF0uZW5kU2x1ci5wb3AoKTtcblx0XHRcdFx0XHRcdFx0aWYgKGN1cnJTbHVyWzFdLmxlbmd0aCA9PT0gMSlcblx0XHRcdFx0XHRcdFx0XHRkZWxldGUgY3VyclNsdXJbMV07XG5cdFx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0XHRjdXJyU2x1clsxXS5wb3AoKTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBUT0RPLVBFUjogVGhpcyBjb3VsZCBiZSBkb25lIGZhc3RlciBhcyB3ZSBnbyBpbnN0ZWFkIG9mIGFzIHRoZSBsYXN0IHN0ZXAuXG5cdFx0ZnVuY3Rpb24gZml4Q2xlZlBsYWNlbWVudChlbCkge1xuXHRcdFx0cGFyc2VLZXlWb2ljZS5maXhDbGVmKGVsKTtcblx0XHRcdC8vaWYgKGVsLmVsX3R5cGUgPT09ICdjbGVmJykge1xuLy9cdFx0XHRcdHZhciBtaW4gPSAtMjtcbi8vXHRcdFx0XHR2YXIgbWF4ID0gNTtcbi8vXHRcdFx0XHRzd2l0Y2goZWwudHlwZSkge1xuLy9cdFx0XHRcdFx0Y2FzZSAndHJlYmxlKzgnOlxuLy9cdFx0XHRcdFx0Y2FzZSAndHJlYmxlLTgnOlxuLy9cdFx0XHRcdFx0XHRicmVhaztcbi8vXHRcdFx0XHRcdGNhc2UgJ2Jhc3MnOlxuLy9cdFx0XHRcdFx0Y2FzZSAnYmFzcys4Jzpcbi8vXHRcdFx0XHRcdGNhc2UgJ2Jhc3MtOCc6XG4vL1x0XHRcdFx0XHRcdGVsLnZlcnRpY2FsUG9zID0gMjAgKyBlbC52ZXJ0aWNhbFBvczsgbWluICs9IDY7IG1heCArPSA2O1xuLy9cdFx0XHRcdFx0XHRicmVhaztcbi8vXHRcdFx0XHRcdGNhc2UgJ3Rlbm9yJzpcbi8vXHRcdFx0XHRcdGNhc2UgJ3Rlbm9yKzgnOlxuLy9cdFx0XHRcdFx0Y2FzZSAndGVub3ItOCc6XG4vL1x0XHRcdFx0XHRcdGVsLnZlcnRpY2FsUG9zID0gLSBlbC52ZXJ0aWNhbFBvczsgbWluID0gLTQwOyBtYXggPSA0MDtcbi8vLy9cdFx0XHRcdFx0XHRlbC52ZXJ0aWNhbFBvcys9MjsgbWluICs9IDY7IG1heCArPSA2O1xuLy9cdFx0XHRcdFx0XHRicmVhaztcbi8vXHRcdFx0XHRcdGNhc2UgJ2FsdG8nOlxuLy9cdFx0XHRcdFx0Y2FzZSAnYWx0bys4Jzpcbi8vXHRcdFx0XHRcdGNhc2UgJ2FsdG8tOCc6XG4vL1x0XHRcdFx0XHRcdGVsLnZlcnRpY2FsUG9zID0gLSBlbC52ZXJ0aWNhbFBvczsgbWluID0gLTQwOyBtYXggPSA0MDtcbi8vLy9cdFx0XHRcdFx0XHRlbC52ZXJ0aWNhbFBvcy09MjsgbWluICs9IDQ7IG1heCArPSA0O1xuLy9cdFx0XHRcdFx0XHRicmVhaztcbi8vXHRcdFx0XHR9XG4vL1x0XHRcdFx0aWYgKGVsLnZlcnRpY2FsUG9zIDwgbWluKSB7XG4vL1x0XHRcdFx0XHR3aGlsZSAoZWwudmVydGljYWxQb3MgPCBtaW4pXG4vL1x0XHRcdFx0XHRcdGVsLnZlcnRpY2FsUG9zICs9IDc7XG4vL1x0XHRcdFx0fSBlbHNlIGlmIChlbC52ZXJ0aWNhbFBvcyA+IG1heCkge1xuLy9cdFx0XHRcdFx0d2hpbGUgKGVsLnZlcnRpY2FsUG9zID4gbWF4KVxuLy9cdFx0XHRcdFx0XHRlbC52ZXJ0aWNhbFBvcyAtPSA3O1xuLy9cdFx0XHRcdH1cblx0XHRcdC8vfVxuXHRcdH1cblxuXHRcdGZ1bmN0aW9uIHdyYXBNdXNpY0xpbmVzKGxpbmVzLCBiYXJzcGVyc3RhZmYpIHtcblx0XHRcdGZvciAoaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAobGluZXNbaV0uc3RhZmYgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdGZvciAocyA9IDA7IHMgPCBsaW5lc1tpXS5zdGFmZi5sZW5ndGg7IHMrKykge1xuXHRcdFx0XHRcdFx0dmFyIHBlcm1hbmVudEl0ZW1zID0gW107XG5cdFx0XHRcdFx0XHRmb3IgKHYgPSAwOyB2IDwgbGluZXNbaV0uc3RhZmZbc10udm9pY2VzLmxlbmd0aDsgdisrKSB7XG5cdFx0XHRcdFx0XHRcdHZhciB2b2ljZSA9IGxpbmVzW2ldLnN0YWZmW3NdLnZvaWNlc1t2XTtcblx0XHRcdFx0XHRcdFx0dmFyIGJhck51bVRoaXNMaW5lID0gMDtcblx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgbiA9IDA7IG4gPCB2b2ljZS5sZW5ndGg7IG4rKykge1xuXHRcdFx0XHRcdFx0XHRcdGlmICh2b2ljZVtuXS5lbF90eXBlID09PSAnYmFyJykge1xuXHRcdFx0XHRcdFx0XHRcdFx0YmFyTnVtVGhpc0xpbmUrKztcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChiYXJOdW1UaGlzTGluZSA+PSBiYXJzcGVyc3RhZmYpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gcHVzaCBldmVyeXRoaW5nIGVsc2UgdG8gdGhlIG5leHQgbGluZSwgaWYgdGhlcmUgaXMgYW55dGhpbmcgZWxzZSxcblx0XHRcdFx0XHRcdFx0XHRcdFx0Ly8gYW5kIHRoZXJlIGlzIGEgbmV4dCBsaW5lLiBJZiB0aGVyZSBpc24ndCBhIG5leHQgbGluZSwgY3JlYXRlIG9uZS5cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKG4gPCB2b2ljZS5sZW5ndGggLSAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIG5leHRMaW5lID0gZ2V0TmV4dE11c2ljTGluZShsaW5lcywgaSk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFuZXh0TGluZSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGNwID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShsaW5lc1tpXSkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bGluZXMucHVzaChwYXJzZUNvbW1vbi5jbG9uZShjcCkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0bmV4dExpbmUgPSBsaW5lc1tsaW5lcy5sZW5ndGggLSAxXTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGZvciAodmFyIHNzID0gMDsgc3MgPCBuZXh0TGluZS5zdGFmZi5sZW5ndGg7IHNzKyspIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgdnYgPSAwOyB2diA8IG5leHRMaW5lLnN0YWZmW3NzXS52b2ljZXMubGVuZ3RoOyB2disrKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdG5leHRMaW5lLnN0YWZmW3NzXS52b2ljZXNbdnZdID0gW107XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdHZhciBzdGFydEVsZW1lbnQgPSBuICsgMTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgc2VjdGlvbiA9IGxpbmVzW2ldLnN0YWZmW3NdLnZvaWNlc1t2XS5zbGljZShzdGFydEVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGxpbmVzW2ldLnN0YWZmW3NdLnZvaWNlc1t2XSA9IGxpbmVzW2ldLnN0YWZmW3NdLnZvaWNlc1t2XS5zbGljZSgwLCBzdGFydEVsZW1lbnQpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdG5leHRMaW5lLnN0YWZmW3NdLnZvaWNlc1t2XSA9IHBlcm1hbmVudEl0ZW1zLmNvbmNhdChzZWN0aW9uLmNvbmNhdChuZXh0TGluZS5zdGFmZltzXS52b2ljZXNbdl0pKTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZSBpZiAoIXZvaWNlW25dLmR1cmF0aW9uKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRwZXJtYW5lbnRJdGVtcy5wdXNoKHZvaWNlW25dKTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRmdW5jdGlvbiBnZXROZXh0TXVzaWNMaW5lKGxpbmVzLCBjdXJyZW50TGluZSkge1xuXHRcdFx0Y3VycmVudExpbmUrKztcblx0XHRcdHdoaWxlIChsaW5lcy5sZW5ndGggPiBjdXJyZW50TGluZSkge1xuXHRcdFx0XHRpZiAobGluZXNbY3VycmVudExpbmVdLnN0YWZmKVxuXHRcdFx0XHRcdHJldHVybiBsaW5lc1tjdXJyZW50TGluZV07XG5cdFx0XHRcdGN1cnJlbnRMaW5lKys7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gbnVsbDtcblx0XHR9XG5cblx0XHRmb3IgKHRoaXMubGluZU51bSA9IDA7IHRoaXMubGluZU51bSA8IHRoaXMubGluZXMubGVuZ3RoOyB0aGlzLmxpbmVOdW0rKykge1xuXHRcdFx0dmFyIHN0YWZmID0gdGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmO1xuXHRcdFx0aWYgKHN0YWZmKSB7XG5cdFx0XHRcdGZvciAodGhpcy5zdGFmZk51bSA9IDA7IHRoaXMuc3RhZmZOdW0gPCBzdGFmZi5sZW5ndGg7IHRoaXMuc3RhZmZOdW0rKykge1xuXHRcdFx0XHRcdGlmIChzdGFmZlt0aGlzLnN0YWZmTnVtXS5jbGVmKVxuXHRcdFx0XHRcdFx0Zml4Q2xlZlBsYWNlbWVudChzdGFmZlt0aGlzLnN0YWZmTnVtXS5jbGVmKTtcblx0XHRcdFx0XHRmb3IgKHRoaXMudm9pY2VOdW0gPSAwOyB0aGlzLnZvaWNlTnVtIDwgc3RhZmZbdGhpcy5zdGFmZk51bV0udm9pY2VzLmxlbmd0aDsgdGhpcy52b2ljZU51bSsrKSB7XG5cdFx0XHRcdFx0XHR2YXIgdm9pY2UgPSBzdGFmZlt0aGlzLnN0YWZmTnVtXS52b2ljZXNbdGhpcy52b2ljZU51bV07XG5cdFx0XHRcdFx0XHRjbGVhblVwU2x1cnNJbkxpbmUodm9pY2UpO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCB2b2ljZS5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRcdFx0XHRpZiAodm9pY2Vbal0uZWxfdHlwZSA9PT0gJ2NsZWYnKVxuXHRcdFx0XHRcdFx0XHRcdGZpeENsZWZQbGFjZW1lbnQodm9pY2Vbal0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKHZvaWNlLmxlbmd0aCA+IDAgJiYgdm9pY2Vbdm9pY2UubGVuZ3RoLTFdLmJhck51bWJlcikge1xuXHRcdFx0XHRcdFx0XHQvLyBEb24ndCBoYW5nIGEgYmFyIG51bWJlciBvbiB0aGUgbGFzdCBiYXIgbGluZTogaXQgc2hvdWxkIGdvIG9uIHRoZSBuZXh0IGxpbmUuXG5cdFx0XHRcdFx0XHRcdHZhciBuZXh0TGluZSA9IGdldE5leHRNdXNpY0xpbmUodGhpcy5saW5lcywgdGhpcy5saW5lTnVtKTtcblx0XHRcdFx0XHRcdFx0aWYgKG5leHRMaW5lKVxuXHRcdFx0XHRcdFx0XHRcdG5leHRMaW5lLnN0YWZmWzBdLmJhck51bWJlciA9IHZvaWNlW3ZvaWNlLmxlbmd0aC0xXS5iYXJOdW1iZXI7XG5cdFx0XHRcdFx0XHRcdGRlbGV0ZSB2b2ljZVt2b2ljZS5sZW5ndGgtMV0uYmFyTnVtYmVyO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmICghdGhpcy5mb3JtYXR0aW5nLnBhZ2V3aWR0aClcblx0XHRcdHRoaXMuZm9ybWF0dGluZy5wYWdld2lkdGggPSBkZWZXaWR0aDtcblx0XHRpZiAoIXRoaXMuZm9ybWF0dGluZy5wYWdlaGVpZ2h0KVxuXHRcdFx0dGhpcy5mb3JtYXR0aW5nLnBhZ2VoZWlnaHQgPSBkZWZMZW5ndGg7XG5cblx0XHQvLyBSZW1vdmUgdGVtcG9yYXJ5IHZhcmlhYmxlcyB0aGF0IHRoZSBvdXRzaWRlIGRvZXNuJ3QgbmVlZCB0byBrbm93IGFib3V0XG5cdFx0ZGVsZXRlIHRoaXMuc3RhZmZOdW07XG5cdFx0ZGVsZXRlIHRoaXMudm9pY2VOdW07XG5cdFx0ZGVsZXRlIHRoaXMubGluZU51bTtcblx0XHRkZWxldGUgdGhpcy5wb3RlbnRpYWxTdGFydEJlYW07XG5cdFx0ZGVsZXRlIHRoaXMucG90ZW50aWFsRW5kQmVhbTtcblx0XHRkZWxldGUgdGhpcy52c2tpcFBlbmRpbmc7XG5cblx0XHRyZXR1cm4gY3VyclNsdXI7XG5cdH07XG5cblx0dGhpcy5yZXNldCgpO1xuXG5cdHRoaXMuZ2V0TGFzdE5vdGUgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dICYmIHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZiAmJiB0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmZbdGhpcy5zdGFmZk51bV0gJiZcblx0XHRcdHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXS52b2ljZXNbdGhpcy52b2ljZU51bV0pIHtcblx0XHRcdGZvciAodmFyIGkgPSB0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmZbdGhpcy5zdGFmZk51bV0udm9pY2VzW3RoaXMudm9pY2VOdW1dLmxlbmd0aC0xOyBpID49IDA7IGktLSkge1xuXHRcdFx0XHR2YXIgZWwgPSB0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmZbdGhpcy5zdGFmZk51bV0udm9pY2VzW3RoaXMudm9pY2VOdW1dW2ldO1xuXHRcdFx0XHRpZiAoZWwuZWxfdHlwZSA9PT0gJ25vdGUnKSB7XG5cdFx0XHRcdFx0cmV0dXJuIGVsO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cdHRoaXMuYWRkVGllVG9MYXN0Tm90ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdC8vIFRPRE8tUEVSOiBpZiB0aGlzIGlzIGEgY2hvcmQsIHdoaWNoIG5vdGU/XG5cdFx0dmFyIGVsID0gdGhpcy5nZXRMYXN0Tm90ZSgpO1xuXHRcdGlmIChlbCAmJiBlbC5waXRjaGVzICYmIGVsLnBpdGNoZXMubGVuZ3RoID4gMCkge1xuXHRcdFx0ZWwucGl0Y2hlc1swXS5zdGFydFRpZSA9IHt9O1xuXHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXHR0aGlzLmdldER1cmF0aW9uID0gZnVuY3Rpb24oZWwpIHtcblx0XHRpZiAoZWwuZHVyYXRpb24pIHJldHVybiBlbC5kdXJhdGlvbjtcblx0XHQvL2lmIChlbC5waXRjaGVzICYmIGVsLnBpdGNoZXMubGVuZ3RoID4gMCkgcmV0dXJuIGVsLnBpdGNoZXNbMF0uZHVyYXRpb247XG5cdFx0cmV0dXJuIDA7XG5cdH07XG5cblx0dGhpcy5jbG9zZUxpbmUgPSBmdW5jdGlvbigpIHtcblx0XHRpZiAodGhpcy5wb3RlbnRpYWxTdGFydEJlYW0gJiYgdGhpcy5wb3RlbnRpYWxFbmRCZWFtKSB7XG5cdFx0XHR0aGlzLnBvdGVudGlhbFN0YXJ0QmVhbS5zdGFydEJlYW0gPSB0cnVlO1xuXHRcdFx0dGhpcy5wb3RlbnRpYWxFbmRCZWFtLmVuZEJlYW0gPSB0cnVlO1xuXHRcdH1cblx0XHRkZWxldGUgdGhpcy5wb3RlbnRpYWxTdGFydEJlYW07XG5cdFx0ZGVsZXRlIHRoaXMucG90ZW50aWFsRW5kQmVhbTtcblx0fTtcblxuXHR0aGlzLmFwcGVuZEVsZW1lbnQgPSBmdW5jdGlvbih0eXBlLCBzdGFydENoYXIsIGVuZENoYXIsIGhhc2hQYXJhbXMpXG5cdHtcblx0XHR2YXIgVGhpcyA9IHRoaXM7XG5cdFx0dmFyIHB1c2hOb3RlID0gZnVuY3Rpb24oaHApIHtcblx0XHRcdGlmIChocC5waXRjaGVzICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0dmFyIG1pZCA9IFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS53b3JraW5nQ2xlZi52ZXJ0aWNhbFBvcztcblx0XHRcdFx0cGFyc2VDb21tb24uZWFjaChocC5waXRjaGVzLCBmdW5jdGlvbihwKSB7IHAudmVydGljYWxQb3MgPSBwLnBpdGNoIC0gbWlkOyB9KTtcblx0XHRcdH1cblx0XHRcdGlmIChocC5ncmFjZW5vdGVzICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0dmFyIG1pZDIgPSBUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0ud29ya2luZ0NsZWYudmVydGljYWxQb3M7XG5cdFx0XHRcdHBhcnNlQ29tbW9uLmVhY2goaHAuZ3JhY2Vub3RlcywgZnVuY3Rpb24ocCkgeyBwLnZlcnRpY2FsUG9zID0gcC5waXRjaCAtIG1pZDI7IH0pO1xuXHRcdFx0fVxuXHRcdFx0VGhpcy5saW5lc1tUaGlzLmxpbmVOdW1dLnN0YWZmW1RoaXMuc3RhZmZOdW1dLnZvaWNlc1tUaGlzLnZvaWNlTnVtXS5wdXNoKGhwKTtcblx0XHR9O1xuXHRcdGhhc2hQYXJhbXMuZWxfdHlwZSA9IHR5cGU7XG5cdFx0aWYgKHN0YXJ0Q2hhciAhPT0gbnVsbClcblx0XHRcdGhhc2hQYXJhbXMuc3RhcnRDaGFyID0gc3RhcnRDaGFyO1xuXHRcdGlmIChlbmRDaGFyICE9PSBudWxsKVxuXHRcdFx0aGFzaFBhcmFtcy5lbmRDaGFyID0gZW5kQ2hhcjtcblx0XHR2YXIgZW5kQmVhbUhlcmUgPSBmdW5jdGlvbigpIHtcblx0XHRcdFRoaXMucG90ZW50aWFsU3RhcnRCZWFtLnN0YXJ0QmVhbSA9IHRydWU7XG5cdFx0XHRoYXNoUGFyYW1zLmVuZEJlYW0gPSB0cnVlO1xuXHRcdFx0ZGVsZXRlIFRoaXMucG90ZW50aWFsU3RhcnRCZWFtO1xuXHRcdFx0ZGVsZXRlIFRoaXMucG90ZW50aWFsRW5kQmVhbTtcblx0XHR9O1xuXHRcdHZhciBlbmRCZWFtTGFzdCA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0aWYgKFRoaXMucG90ZW50aWFsU3RhcnRCZWFtICE9PSB1bmRlZmluZWQgJiYgVGhpcy5wb3RlbnRpYWxFbmRCZWFtICE9PSB1bmRlZmluZWQpIHtcdC8vIERvIHdlIGhhdmUgYSBzZXQgb2Ygbm90ZXMgdG8gYmVhbT9cblx0XHRcdFx0VGhpcy5wb3RlbnRpYWxTdGFydEJlYW0uc3RhcnRCZWFtID0gdHJ1ZTtcblx0XHRcdFx0VGhpcy5wb3RlbnRpYWxFbmRCZWFtLmVuZEJlYW0gPSB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0ZGVsZXRlIFRoaXMucG90ZW50aWFsU3RhcnRCZWFtO1xuXHRcdFx0ZGVsZXRlIFRoaXMucG90ZW50aWFsRW5kQmVhbTtcblx0XHR9O1xuXHRcdGlmICh0eXBlID09PSAnbm90ZScpIHsgLy8gJiYgKGhhc2hQYXJhbXMucmVzdCAhPT0gdW5kZWZpbmVkIHx8IGhhc2hQYXJhbXMuZW5kX2JlYW0gPT09IHVuZGVmaW5lZCkpIHtcblx0XHRcdC8vIE5vdywgYWRkIHRoZSBzdGFydEJlYW0gYW5kIGVuZEJlYW0gd2hlcmUgaXQgaXMgbmVlZGVkLlxuXHRcdFx0Ly8gZW5kX2JlYW0gaXMgYWxyZWFkeSBzZXQgb24gdGhlIHBsYWNlcyB3aGVyZSB0aGVyZSBpcyBhIGZvcmNlZCBlbmRfYmVhbS4gV2UnbGwgcmVtb3ZlIHRoYXQgaGVyZSBhZnRlciB1c2luZyB0aGF0IGluZm8uXG5cdFx0XHQvLyB0aGlzLnBvdGVudGlhbFN0YXJ0QmVhbSBlaXRoZXIgcG9pbnRzIHRvIG51bGwgb3IgdGhlIHN0YXJ0IGJlYW0uXG5cdFx0XHQvLyB0aGlzLnBvdGVudGlhbEVuZEJlYW0gZWl0aGVyIHBvaW50cyB0byBudWxsIG9yIHRoZSBzdGFydCBiZWFtLlxuXHRcdFx0Ly8gSWYgd2UgaGF2ZSBhIGJlYW0gYnJlYWsgKG5vdGUgaXMgbG9uZ2VyIHRoYW4gYSBxdWFydGVyLCBvciBhbiBlbmRfYmVhbSBpcyBvbiB0aGlzIGVsZW1lbnQpLCB0aGVuIHNldCB0aGUgYmVhbSBpZiB3ZSBoYXZlIG9uZS5cblx0XHRcdC8vIHJlc2V0IHRoZSB2YXJpYWJsZXMgZm9yIHRoZSBuZXh0IG5vdGVzLlxuXHRcdFx0dmFyIGR1ciA9IFRoaXMuZ2V0RHVyYXRpb24oaGFzaFBhcmFtcyk7XG5cdFx0XHRpZiAoZHVyID49IDAuMjUpIHtcdC8vIFRoZSBiZWFtIGVuZHMgb24gdGhlIG5vdGUgYmVmb3JlIHRoaXMuXG5cdFx0XHRcdGVuZEJlYW1MYXN0KCk7XG5cdFx0XHR9IGVsc2UgaWYgKGhhc2hQYXJhbXMuZm9yY2VfZW5kX2JlYW1fbGFzdCAmJiBUaGlzLnBvdGVudGlhbFN0YXJ0QmVhbSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGVuZEJlYW1MYXN0KCk7XG5cdFx0XHR9IGVsc2UgaWYgKGhhc2hQYXJhbXMuZW5kX2JlYW0gJiYgVGhpcy5wb3RlbnRpYWxTdGFydEJlYW0gIT09IHVuZGVmaW5lZCkge1x0Ly8gdGhlIGJlYW0gaXMgZm9yY2VkIHRvIGVuZCBvbiB0aGlzIG5vdGUsIHByb2JhYmx5IGJlY2F1c2Ugb2YgYSBzcGFjZSBpbiB0aGUgQUJDXG5cdFx0XHRcdGlmIChoYXNoUGFyYW1zLnJlc3QgPT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRlbmRCZWFtSGVyZSgpO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0ZW5kQmVhbUxhc3QoKTtcblx0XHRcdH0gZWxzZSBpZiAoaGFzaFBhcmFtcy5yZXN0ID09PSB1bmRlZmluZWQpIHtcdC8vIHRoaXMgYSBzaG9ydCBub3RlIGFuZCB3ZSBhcmVuJ3QgYWJvdXQgdG8gZW5kIHRoZSBiZWFtXG5cdFx0XHRcdGlmIChUaGlzLnBvdGVudGlhbFN0YXJ0QmVhbSA9PT0gdW5kZWZpbmVkKSB7XHQvLyBXZSBhcmVuJ3QgY29sbGVjdGluZyBub3RlcyBmb3IgYSBiZWFtLCBzbyBzdGFydCBoZXJlLlxuXHRcdFx0XHRcdGlmICghaGFzaFBhcmFtcy5lbmRfYmVhbSkge1xuXHRcdFx0XHRcdFx0VGhpcy5wb3RlbnRpYWxTdGFydEJlYW0gPSBoYXNoUGFyYW1zO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIFRoaXMucG90ZW50aWFsRW5kQmVhbTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0VGhpcy5wb3RlbnRpYWxFbmRCZWFtID0gaGFzaFBhcmFtcztcdC8vIENvbnRpbnVlIHRoZSBiZWFtaW5nLCBsb29rIGZvciB0aGUgZW5kIG5leHQgbm90ZS5cblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHQvLyAgZW5kX2JlYW0gZ29lcyBvbiByZXN0cyBhbmQgbm90ZXMgd2hpY2ggcHJlY2VkZSByZXN0cyBfZXhjZXB0XyB3aGVuIGEgcmVzdCAob3Igc2V0IG9mIGFkamFjZW50IHJlc3RzKSBoYXMgbm9ybWFsIG5vdGVzIG9uIGJvdGggc2lkZXMgKG5vIHNwYWNlcylcbi8vXHRcdFx0aWYgKGhhc2hQYXJhbXMucmVzdCAhPT0gdW5kZWZpbmVkKVxuLy9cdFx0XHR7XG4vL1x0XHRcdFx0aGFzaFBhcmFtcy5lbmRfYmVhbSA9IHRydWU7XG4vL1x0XHRcdFx0dmFyIGVsMiA9IHRoaXMuZ2V0TGFzdE5vdGUoKTtcbi8vXHRcdFx0XHRpZiAoZWwyKSBlbDIuZW5kX2JlYW0gPSB0cnVlO1xuLy9cdFx0XHRcdC8vIFRPRE8tUEVSOiBpbXBsZW1lbnQgZXhjZXB0aW9uIG1lbnRpb25lZCBpbiB0aGUgY29tbWVudC5cbi8vXHRcdFx0fVxuXHRcdH0gZWxzZSB7XHQvLyBJdCdzIG5vdCBhIG5vdGUsIHNvIHRoZXJlIGRlZmluaXRlbHkgaXNuJ3QgYmVhbWluZyBhZnRlciBpdC5cblx0XHRcdGVuZEJlYW1MYXN0KCk7XG5cdFx0fVxuXHRcdGRlbGV0ZSBoYXNoUGFyYW1zLmVuZF9iZWFtO1x0Ly8gV2UgZG9uJ3Qgd2FudCB0aGlzIHRlbXBvcmFyeSB2YXJpYWJsZSBoYW5naW5nIGFyb3VuZC5cblx0XHRkZWxldGUgaGFzaFBhcmFtcy5mb3JjZV9lbmRfYmVhbV9sYXN0O1x0Ly8gV2UgZG9uJ3Qgd2FudCB0aGlzIHRlbXBvcmFyeSB2YXJpYWJsZSBoYW5naW5nIGFyb3VuZC5cblx0XHRwdXNoTm90ZShoYXNoUGFyYW1zKTtcblx0fTtcblxuXHR0aGlzLmFwcGVuZFN0YXJ0aW5nRWxlbWVudCA9IGZ1bmN0aW9uKHR5cGUsIHN0YXJ0Q2hhciwgZW5kQ2hhciwgaGFzaFBhcmFtczIpXG5cdHtcblx0XHQvLyBJZiB3ZSdyZSBpbiB0aGUgbWlkZGxlIG9mIGJlYW1pbmcsIHRoZW4gZW5kIHRoZSBiZWFtLlxuXHRcdHRoaXMuY2xvc2VMaW5lKCk7XG5cblx0XHQvLyBXZSBvbmx5IGV2ZXIgd2FudCBpbXBsaWVkIG5hdHVyYWxzIHRoZSBmaXJzdCB0aW1lLlxuXHRcdHZhciBpbXBsaWVkTmF0dXJhbHM7XG5cdFx0aWYgKHR5cGUgPT09ICdrZXknKSB7XG5cdFx0XHRpbXBsaWVkTmF0dXJhbHMgPSBoYXNoUGFyYW1zMi5pbXBsaWVkTmF0dXJhbHM7XG5cdFx0XHRkZWxldGUgaGFzaFBhcmFtczIuaW1wbGllZE5hdHVyYWxzO1xuXHRcdFx0ZGVsZXRlIGhhc2hQYXJhbXMyLmV4cGxpY2l0QWNjaWRlbnRhbHM7XG5cdFx0fVxuXG5cdFx0Ly8gQ2xvbmUgdGhlIG9iamVjdCBiZWNhdXNlIGl0IHdpbGwgYmUgc3RpY2tpbmcgYXJvdW5kIGZvciB0aGUgbmV4dCBsaW5lIGFuZCB3ZSBkb24ndCB3YW50IHRoZSBleHRyYSBmaWVsZHMgaW4gaXQuXG5cdFx0dmFyIGhhc2hQYXJhbXMgPSBwYXJzZUNvbW1vbi5jbG9uZShoYXNoUGFyYW1zMik7XG5cblx0XHRpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmKSB7IC8vIGJlIHN1cmUgdGhhdCB3ZSBhcmUgb24gYSBtdXNpYyB0eXBlIGxpbmUgYmVmb3JlIGRvaW5nIHRoZSBmb2xsb3dpbmcuXG5cdFx0XHQvLyBJZiB0aGlzIGlzIGEgY2xlZiB0eXBlLCB0aGVuIHdlIHJlcGxhY2UgdGhlIHdvcmtpbmcgY2xlZiBvbiB0aGUgbGluZS4gVGhpcyBpcyBrZXB0IHNlcGFyYXRlIGZyb21cblx0XHRcdC8vIHRoZSBjbGVmIGluIGNhc2UgdGhlcmUgaXMgYW4gaW5saW5lIGNsZWYgZmllbGQuIFdlIG5lZWQgdG8ga25vdyB3aGF0IHRoZSBjdXJyZW50IHBvc2l0aW9uIGZvclxuXHRcdFx0Ly8gdGhlIG5vdGUgaXMuXG5cdFx0XHRpZiAodHlwZSA9PT0gJ2NsZWYnKVxuXHRcdFx0XHR0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmZbdGhpcy5zdGFmZk51bV0ud29ya2luZ0NsZWYgPSBoYXNoUGFyYW1zO1xuXG5cdFx0XHQvLyBJZiB0aGlzIGlzIHRoZSBmaXJzdCBpdGVtIGluIHRoaXMgc3RhZmYsIHRoZW4gd2UgbWlnaHQgaGF2ZSB0byBpbml0aWFsaXplIHRoZSBzdGFmZiwgZmlyc3QuXG5cdFx0XHRpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmLmxlbmd0aCA8PSB0aGlzLnN0YWZmTnVtKSB7XG5cdFx0XHRcdHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXSA9IHt9O1xuXHRcdFx0XHR0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmZbdGhpcy5zdGFmZk51bV0uY2xlZiA9IHBhcnNlQ29tbW9uLmNsb25lKHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlswXS5jbGVmKTtcblx0XHRcdFx0dGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmW3RoaXMuc3RhZmZOdW1dLmtleSA9IHBhcnNlQ29tbW9uLmNsb25lKHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlswXS5rZXkpO1xuXHRcdFx0XHRpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmWzBdLm1ldGVyKVxuXHRcdFx0XHRcdHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXS5tZXRlciA9IHBhcnNlQ29tbW9uLmNsb25lKHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlswXS5tZXRlcik7XG5cdFx0XHRcdHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXS53b3JraW5nQ2xlZiA9IHBhcnNlQ29tbW9uLmNsb25lKHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlswXS53b3JraW5nQ2xlZik7XG5cdFx0XHRcdHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXS52b2ljZXMgPSBbW11dO1xuXHRcdFx0fVxuXG5cdFx0XHQvLyBUaGVzZSBlbGVtZW50cyBzaG91bGQgbm90IGJlIGFkZGVkIHR3aWNlLCBzbyBpZiB0aGUgZWxlbWVudCBleGlzdHMgb24gdGhpcyBsaW5lIHdpdGhvdXQgYSBub3RlIG9yIGJhciBiZWZvcmUgaXQsIGp1c3QgcmVwbGFjZSB0aGUgc3RhZmYgdmVyc2lvbi5cblx0XHRcdHZhciB2b2ljZSA9IHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXS52b2ljZXNbdGhpcy52b2ljZU51bV07XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHZvaWNlLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmICh2b2ljZVtpXS5lbF90eXBlID09PSAnbm90ZScgfHwgdm9pY2VbaV0uZWxfdHlwZSA9PT0gJ2JhcicpIHtcblx0XHRcdFx0XHRoYXNoUGFyYW1zLmVsX3R5cGUgPSB0eXBlO1xuXHRcdFx0XHRcdGhhc2hQYXJhbXMuc3RhcnRDaGFyID0gc3RhcnRDaGFyO1xuXHRcdFx0XHRcdGhhc2hQYXJhbXMuZW5kQ2hhciA9IGVuZENoYXI7XG5cdFx0XHRcdFx0aWYgKGltcGxpZWROYXR1cmFscylcblx0XHRcdFx0XHRcdGhhc2hQYXJhbXMuYWNjaWRlbnRhbHMgPSBpbXBsaWVkTmF0dXJhbHMuY29uY2F0KGhhc2hQYXJhbXMuYWNjaWRlbnRhbHMpO1xuXHRcdFx0XHRcdHZvaWNlLnB1c2goaGFzaFBhcmFtcyk7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICh2b2ljZVtpXS5lbF90eXBlID09PSB0eXBlKSB7XG5cdFx0XHRcdFx0aGFzaFBhcmFtcy5lbF90eXBlID0gdHlwZTtcblx0XHRcdFx0XHRoYXNoUGFyYW1zLnN0YXJ0Q2hhciA9IHN0YXJ0Q2hhcjtcblx0XHRcdFx0XHRoYXNoUGFyYW1zLmVuZENoYXIgPSBlbmRDaGFyO1xuXHRcdFx0XHRcdGlmIChpbXBsaWVkTmF0dXJhbHMpXG5cdFx0XHRcdFx0XHRoYXNoUGFyYW1zLmFjY2lkZW50YWxzID0gaW1wbGllZE5hdHVyYWxzLmNvbmNhdChoYXNoUGFyYW1zLmFjY2lkZW50YWxzKTtcblx0XHRcdFx0XHR2b2ljZVtpXSA9IGhhc2hQYXJhbXM7XG5cdFx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHQvLyBXZSBkaWRuJ3Qgc2VlIGVpdGhlciB0aGF0IHR5cGUgb3IgYSBub3RlLCBzbyByZXBsYWNlIHRoZSBlbGVtZW50IHRvIHRoZSBzdGFmZi5cblx0XHRcdHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXVt0eXBlXSA9IGhhc2hQYXJhbXMyO1xuXHRcdH1cblx0fTtcblxuXHR0aGlzLmdldE51bUxpbmVzID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMubGluZXMubGVuZ3RoO1xuXHR9O1xuXG5cdHRoaXMucHVzaExpbmUgPSBmdW5jdGlvbihoYXNoKSB7XG5cdFx0aWYgKHRoaXMudnNraXBQZW5kaW5nKSB7XG5cdFx0XHRoYXNoLnZza2lwID0gdGhpcy52c2tpcFBlbmRpbmc7XG5cdFx0XHRkZWxldGUgdGhpcy52c2tpcFBlbmRpbmc7XG5cdFx0fVxuXHRcdHRoaXMubGluZXMucHVzaChoYXNoKTtcblx0fTtcblxuXHR0aGlzLmFkZFN1YnRpdGxlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0dGhpcy5wdXNoTGluZSh7c3VidGl0bGU6IHN0cn0pO1xuXHR9O1xuXG5cdHRoaXMuYWRkU3BhY2luZyA9IGZ1bmN0aW9uKG51bSkge1xuXHRcdHRoaXMudnNraXBQZW5kaW5nID0gbnVtO1xuXHR9O1xuXG5cdHRoaXMuYWRkTmV3UGFnZSA9IGZ1bmN0aW9uKG51bSkge1xuXHRcdHRoaXMucHVzaExpbmUoe25ld3BhZ2U6IG51bX0pO1xuXHR9O1xuXG5cdHRoaXMuYWRkU2VwYXJhdG9yID0gZnVuY3Rpb24oc3BhY2VBYm92ZSwgc3BhY2VCZWxvdywgbGluZUxlbmd0aCkge1xuXHRcdHRoaXMucHVzaExpbmUoe3NlcGFyYXRvcjoge3NwYWNlQWJvdmU6IHNwYWNlQWJvdmUsIHNwYWNlQmVsb3c6IHNwYWNlQmVsb3csIGxpbmVMZW5ndGg6IGxpbmVMZW5ndGh9fSk7XG5cdH07XG5cblx0dGhpcy5hZGRUZXh0ID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0dGhpcy5wdXNoTGluZSh7dGV4dDogc3RyfSk7XG5cdH07XG5cblx0dGhpcy5hZGRDZW50ZXJlZCA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdHRoaXMucHVzaExpbmUoe3RleHQ6IFt7dGV4dDogc3RyLCBjZW50ZXI6IHRydWUgfV19KTtcblx0fTtcblxuXHR0aGlzLmNvbnRhaW5zTm90ZXMgPSBmdW5jdGlvbih2b2ljZSkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdm9pY2UubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmICh2b2ljZVtpXS5lbF90eXBlID09PSAnbm90ZScgfHwgdm9pY2VbaV0uZWxfdHlwZSA9PT0gJ2JhcicpXG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdH1cblx0XHRyZXR1cm4gZmFsc2U7XG5cdH07XG5cblx0dGhpcy5jb250YWluc05vdGVzU3RyaWN0ID0gZnVuY3Rpb24odm9pY2UpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHZvaWNlLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodm9pY2VbaV0uZWxfdHlwZSA9PT0gJ25vdGUnICYmIHZvaWNlW2ldLnJlc3QgPT09IHVuZGVmaW5lZClcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuLy9cdGFueVZvaWNlQ29udGFpbnNOb3RlczogZnVuY3Rpb24obGluZSkge1xuLy9cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lLnN0YWZmLnZvaWNlcy5sZW5ndGg7IGkrKykge1xuLy9cdFx0XHRpZiAodGhpcy5jb250YWluc05vdGVzKGxpbmUuc3RhZmYudm9pY2VzW2ldKSlcbi8vXHRcdFx0XHRyZXR1cm4gdHJ1ZTtcbi8vXHRcdH1cbi8vXHRcdHJldHVybiBmYWxzZTtcbi8vXHR9LFxuXG5cdHRoaXMuc3RhcnROZXdMaW5lID0gZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0Ly8gSWYgdGhlIHBvaW50ZWQgdG8gbGluZSBkb2Vzbid0IGV4aXN0LCBqdXN0IGNyZWF0ZSB0aGF0LiBJZiB0aGUgbGluZSBkb2VzIGV4aXN0LCBidXQgZG9lc24ndCBoYXZlIGFueSBtdXNpYyBvbiBpdCwganVzdCB1c2UgaXQuXG5cdFx0Ly8gSWYgaXQgZG9lcyBleGlzdCBhbmQgaGFzIG11c2ljLCB0aGVuIGluY3JlbWVudCB0aGUgbGluZSBudW1iZXIuIElmIHRoZSBuZXcgZWxlbWVudCBkb2Vzbid0IGV4aXN0LCBjcmVhdGUgaXQuXG5cdFx0dmFyIFRoaXMgPSB0aGlzO1xuXHRcdHRoaXMuY2xvc2VMaW5lKCk7XHQvLyBDbG9zZSB0aGUgcHJldmlvdXMgbGluZS5cblx0XHR2YXIgY3JlYXRlVm9pY2UgPSBmdW5jdGlvbihwYXJhbXMpIHtcblx0XHRcdFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS52b2ljZXNbVGhpcy52b2ljZU51bV0gPSBbXTtcblx0XHRcdGlmIChUaGlzLmlzRmlyc3RMaW5lKFRoaXMubGluZU51bSkpIHtcblx0XHRcdFx0aWYgKHBhcmFtcy5uYW1lKSB7aWYgKCFUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0udGl0bGUpIFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS50aXRsZSA9IFtdO1RoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS50aXRsZVtUaGlzLnZvaWNlTnVtXSA9IHBhcmFtcy5uYW1lO31cblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGlmIChwYXJhbXMuc3VibmFtZSkge2lmICghVGhpcy5saW5lc1tUaGlzLmxpbmVOdW1dLnN0YWZmW1RoaXMuc3RhZmZOdW1dLnRpdGxlKSBUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0udGl0bGUgPSBbXTtUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0udGl0bGVbVGhpcy52b2ljZU51bV0gPSBwYXJhbXMuc3VibmFtZTt9XG5cdFx0XHR9XG5cdFx0XHRpZiAocGFyYW1zLnN0eWxlKVxuXHRcdFx0XHRUaGlzLmFwcGVuZEVsZW1lbnQoJ3N0eWxlJywgbnVsbCwgbnVsbCwge2hlYWQ6IHBhcmFtcy5zdHlsZX0pO1xuXHRcdFx0aWYgKHBhcmFtcy5zdGVtKVxuXHRcdFx0XHRUaGlzLmFwcGVuZEVsZW1lbnQoJ3N0ZW0nLCBudWxsLCBudWxsLCB7ZGlyZWN0aW9uOiBwYXJhbXMuc3RlbX0pO1xuXHRcdFx0ZWxzZSBpZiAoVGhpcy52b2ljZU51bSA+IDApIHtcblx0XHRcdFx0aWYgKFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS52b2ljZXNbMF0hPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0dmFyIGZvdW5kID0gZmFsc2U7XG5cdFx0XHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0udm9pY2VzWzBdLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRpZiAoVGhpcy5saW5lc1tUaGlzLmxpbmVOdW1dLnN0YWZmW1RoaXMuc3RhZmZOdW1dLnZvaWNlc1swXS5lbF90eXBlID09PSAnc3RlbScpXG5cdFx0XHRcdFx0XHRcdGZvdW5kID0gdHJ1ZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKCFmb3VuZCkge1xuXHRcdFx0XHRcdFx0dmFyIHN0ZW0gPSB7IGVsX3R5cGU6ICdzdGVtJywgZGlyZWN0aW9uOiAndXAnIH07XG5cdFx0XHRcdFx0XHRUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0udm9pY2VzWzBdLnNwbGljZSgwLDAsc3RlbSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdFRoaXMuYXBwZW5kRWxlbWVudCgnc3RlbScsIG51bGwsIG51bGwsIHtkaXJlY3Rpb246ICdkb3duJ30pO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHBhcmFtcy5zY2FsZSlcblx0XHRcdFx0VGhpcy5hcHBlbmRFbGVtZW50KCdzY2FsZScsIG51bGwsIG51bGwsIHsgc2l6ZTogcGFyYW1zLnNjYWxlfSApO1xuXHRcdH07XG5cdFx0dmFyIGNyZWF0ZVN0YWZmID0gZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0XHRpZiAocGFyYW1zLmtleSAmJiBwYXJhbXMua2V5LmltcGxpZWROYXR1cmFscykge1xuXHRcdFx0XHRwYXJhbXMua2V5LmFjY2lkZW50YWxzID0gcGFyYW1zLmtleS5hY2NpZGVudGFscy5jb25jYXQocGFyYW1zLmtleS5pbXBsaWVkTmF0dXJhbHMpO1xuXHRcdFx0XHRkZWxldGUgcGFyYW1zLmtleS5pbXBsaWVkTmF0dXJhbHM7XG5cdFx0XHR9XG5cblx0XHRcdFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXSA9IHt2b2ljZXM6IFsgXSwgY2xlZjogcGFyYW1zLmNsZWYsIGtleTogcGFyYW1zLmtleSwgd29ya2luZ0NsZWY6IHBhcmFtcy5jbGVmIH07XG5cdFx0XHRpZiAocGFyYW1zLnN0YWZmbGluZXMgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0uY2xlZi5zdGFmZmxpbmVzID0gcGFyYW1zLnN0YWZmbGluZXM7XG5cdFx0XHRcdFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS53b3JraW5nQ2xlZi5zdGFmZmxpbmVzID0gcGFyYW1zLnN0YWZmbGluZXM7XG5cdFx0XHR9XG5cdFx0XHRpZiAocGFyYW1zLnN0YWZmc2NhbGUpIHtcblx0XHRcdFx0VGhpcy5saW5lc1tUaGlzLmxpbmVOdW1dLnN0YWZmW1RoaXMuc3RhZmZOdW1dLnN0YWZmc2NhbGUgPSBwYXJhbXMuc3RhZmZzY2FsZTtcblx0XHRcdH1cblx0XHRcdGlmIChwYXJhbXMudHJpcGxldGZvbnQpIFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS50cmlwbGV0Zm9udCA9IHBhcmFtcy50cmlwbGV0Zm9udDtcblx0XHRcdGlmIChwYXJhbXMudm9jYWxmb250KSBUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0udm9jYWxmb250ID0gcGFyYW1zLnZvY2FsZm9udDtcblx0XHRcdGlmIChwYXJhbXMuYnJhY2tldCkgVGhpcy5saW5lc1tUaGlzLmxpbmVOdW1dLnN0YWZmW1RoaXMuc3RhZmZOdW1dLmJyYWNrZXQgPSBwYXJhbXMuYnJhY2tldDtcblx0XHRcdGlmIChwYXJhbXMuYnJhY2UpIFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS5icmFjZSA9IHBhcmFtcy5icmFjZTtcblx0XHRcdGlmIChwYXJhbXMuY29ubmVjdEJhckxpbmVzKSBUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0uY29ubmVjdEJhckxpbmVzID0gcGFyYW1zLmNvbm5lY3RCYXJMaW5lcztcblx0XHRcdGlmIChwYXJhbXMuYmFyTnVtYmVyKSBUaGlzLmxpbmVzW1RoaXMubGluZU51bV0uc3RhZmZbVGhpcy5zdGFmZk51bV0uYmFyTnVtYmVyID0gcGFyYW1zLmJhck51bWJlcjtcblx0XHRcdGNyZWF0ZVZvaWNlKHBhcmFtcyk7XG5cdFx0XHQvLyBTb21lIHN0dWZmIGp1c3QgaGFwcGVucyBmb3IgdGhlIGZpcnN0IHZvaWNlXG5cdFx0XHRpZiAocGFyYW1zLnBhcnQpXG5cdFx0XHRcdFRoaXMuYXBwZW5kRWxlbWVudCgncGFydCcsIHBhcmFtcy5zdGFydENoYXIsIHBhcmFtcy5lbmRDaGFyLCB7dGl0bGU6IHBhcmFtcy5wYXJ0fSk7XG5cdFx0XHRpZiAocGFyYW1zLm1ldGVyICE9PSB1bmRlZmluZWQpIFRoaXMubGluZXNbVGhpcy5saW5lTnVtXS5zdGFmZltUaGlzLnN0YWZmTnVtXS5tZXRlciA9IHBhcmFtcy5tZXRlcjtcblx0XHR9O1xuXHRcdHZhciBjcmVhdGVMaW5lID0gZnVuY3Rpb24ocGFyYW1zKSB7XG5cdFx0XHRUaGlzLmxpbmVzW1RoaXMubGluZU51bV0gPSB7c3RhZmY6IFtdfTtcblx0XHRcdGNyZWF0ZVN0YWZmKHBhcmFtcyk7XG5cdFx0fTtcblx0XHRpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dID09PSB1bmRlZmluZWQpIGNyZWF0ZUxpbmUocGFyYW1zKTtcblx0XHRlbHNlIGlmICh0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmYgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5saW5lTnVtKys7XG5cdFx0XHR0aGlzLnN0YXJ0TmV3TGluZShwYXJhbXMpO1xuXHRcdH0gZWxzZSBpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmW3RoaXMuc3RhZmZOdW1dID09PSB1bmRlZmluZWQpIGNyZWF0ZVN0YWZmKHBhcmFtcyk7XG5cdFx0ZWxzZSBpZiAodGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmW3RoaXMuc3RhZmZOdW1dLnZvaWNlc1t0aGlzLnZvaWNlTnVtXSA9PT0gdW5kZWZpbmVkKSBjcmVhdGVWb2ljZShwYXJhbXMpO1xuXHRcdGVsc2UgaWYgKCF0aGlzLmNvbnRhaW5zTm90ZXModGhpcy5saW5lc1t0aGlzLmxpbmVOdW1dLnN0YWZmW3RoaXMuc3RhZmZOdW1dLnZvaWNlc1t0aGlzLnZvaWNlTnVtXSkpIHJldHVybjtcblx0XHRlbHNlIHtcblx0XHRcdHRoaXMubGluZU51bSsrO1xuXHRcdFx0dGhpcy5zdGFydE5ld0xpbmUocGFyYW1zKTtcblx0XHR9XG5cdH07XG5cblx0dGhpcy5oYXNCZWdpbk11c2ljID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly8gcmV0dXJuIHRydWUgaWYgdGhlcmUgZXhpc3RzIGF0IGxlYXN0IG9uZSBsaW5lIHRoYXQgY29udGFpbnMgXCJzdGFmZlwiXG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodGhpcy5saW5lc1tpXS5zdGFmZilcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0fVxuXHRcdHJldHVybiBmYWxzZTtcblx0fTtcblxuXHR0aGlzLmlzRmlyc3RMaW5lID0gZnVuY3Rpb24oaW5kZXgpIHtcblx0XHRmb3IgKHZhciBpID0gaW5kZXgtMTsgaSA+PSAwOyBpLS0pIHtcblx0XHRcdGlmICh0aGlzLmxpbmVzW2ldLnN0YWZmICE9PSB1bmRlZmluZWQpIHJldHVybiBmYWxzZTtcblx0XHR9XG5cdFx0cmV0dXJuIHRydWU7XG5cdH07XG5cblx0dGhpcy5nZXRNZXRlciA9IGZ1bmN0aW9uKCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGxpbmUgPSB0aGlzLmxpbmVzW2ldO1xuXHRcdFx0aWYgKGxpbmUuc3RhZmYpIHtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBsaW5lLnN0YWZmLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0dmFyIG1ldGVyID0gbGluZS5zdGFmZltqXS5tZXRlcjtcblx0XHRcdFx0XHRpZiAobWV0ZXIpIHtcblx0XHRcdFx0XHRcdHJldHVybiBtZXRlcjtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHsgdHlwZTogXCJjb21tb25fdGltZVwiLCB9O1xuXHR9O1xuXG5cdHRoaXMuZ2V0TWV0ZXJGcmFjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdHZhciBtZXRlciA9IHRoaXMuZ2V0TWV0ZXIoKTtcblx0XHR2YXIgbnVtID0gNDtcblx0XHR2YXIgZGVuID0gNDtcblx0XHRpZiAobWV0ZXIpIHtcblx0XHRcdGlmIChtZXRlci50eXBlID09PSAnc3BlY2lmaWVkJykge1xuXHRcdFx0XHRudW0gPSBwYXJzZUludChtZXRlci52YWx1ZVswXS5udW0sIDEwKTtcblx0XHRcdFx0ZGVuID0gcGFyc2VJbnQobWV0ZXIudmFsdWVbMF0uZGVuLDEwKTtcblx0XHRcdH0gZWxzZSBpZiAobWV0ZXIudHlwZSA9PT0gJ2N1dF90aW1lJykge1xuXHRcdFx0XHRudW0gPSAyO1xuXHRcdFx0XHRkZW4gPSAyO1xuXHRcdFx0fSBlbHNlIGlmIChtZXRlci50eXBlID09PSAnY29tbW9uX3RpbWUnKSB7XG5cdFx0XHRcdG51bSA9IDQ7XG5cdFx0XHRcdGRlbiA9IDQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMubWV0ZXIgPSB7IG51bTogbnVtLCBkZW46IGRlbiB9O1xuXHRcdHJldHVybiB0aGlzLm1ldGVyOyAvLyBUT0RPLVBFUjogaXMgdGhpcyBzYXZlZCB2YWx1ZSB1c2VkIGFueXdoZXJlPyBBIGdldCBmdW5jdGlvbiBzaG91bGRuJ3QgY2hhbmdlIHN0YXRlLlxuXHR9O1xuXG5cdHRoaXMuZ2V0Q3VycmVudFZvaWNlID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMubGluZXNbdGhpcy5saW5lTnVtXSAhPT0gdW5kZWZpbmVkICYmIHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXSAhPT0gdW5kZWZpbmVkICYmIHRoaXMubGluZXNbdGhpcy5saW5lTnVtXS5zdGFmZlt0aGlzLnN0YWZmTnVtXS52b2ljZXNbdGhpcy52b2ljZU51bV0gIT09IHVuZGVmaW5lZClcblx0XHRcdHJldHVybiB0aGlzLmxpbmVzW3RoaXMubGluZU51bV0uc3RhZmZbdGhpcy5zdGFmZk51bV0udm9pY2VzW3RoaXMudm9pY2VOdW1dO1xuXHRcdGVsc2UgcmV0dXJuIG51bGw7XG5cdH07XG5cblx0dGhpcy5zZXRDdXJyZW50Vm9pY2UgPSBmdW5jdGlvbihzdGFmZk51bSwgdm9pY2VOdW0pIHtcblx0XHR0aGlzLnN0YWZmTnVtID0gc3RhZmZOdW07XG5cdFx0dGhpcy52b2ljZU51bSA9IHZvaWNlTnVtO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5saW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKHRoaXMubGluZXNbaV0uc3RhZmYpIHtcblx0XHRcdFx0aWYgKHRoaXMubGluZXNbaV0uc3RhZmZbc3RhZmZOdW1dID09PSB1bmRlZmluZWQgfHwgdGhpcy5saW5lc1tpXS5zdGFmZltzdGFmZk51bV0udm9pY2VzW3ZvaWNlTnVtXSA9PT0gdW5kZWZpbmVkIHx8XG5cdFx0XHRcdFx0IXRoaXMuY29udGFpbnNOb3Rlcyh0aGlzLmxpbmVzW2ldLnN0YWZmW3N0YWZmTnVtXS52b2ljZXNbdm9pY2VOdW1dICkpIHtcblx0XHRcdFx0XHR0aGlzLmxpbmVOdW0gPSAgaTtcblx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0dGhpcy5saW5lTnVtID0gIGk7XG5cdH07XG5cblx0dGhpcy5hZGRNZXRhVGV4dCA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0XHRpZiAodGhpcy5tZXRhVGV4dFtrZXldID09PSB1bmRlZmluZWQpXG5cdFx0XHR0aGlzLm1ldGFUZXh0W2tleV0gPSB2YWx1ZTtcblx0XHRlbHNlXG5cdFx0XHR0aGlzLm1ldGFUZXh0W2tleV0gKz0gXCJcXG5cIiArIHZhbHVlO1xuXHR9O1xuXG5cdHRoaXMuYWRkTWV0YVRleHRBcnJheSA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0XHRpZiAodGhpcy5tZXRhVGV4dFtrZXldID09PSB1bmRlZmluZWQpXG5cdFx0XHR0aGlzLm1ldGFUZXh0W2tleV0gPSBbdmFsdWVdO1xuXHRcdGVsc2Vcblx0XHRcdHRoaXMubWV0YVRleHRba2V5XS5wdXNoKHZhbHVlKTtcblx0fTtcblx0dGhpcy5hZGRNZXRhVGV4dE9iaiA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcblx0XHR0aGlzLm1ldGFUZXh0W2tleV0gPSB2YWx1ZTtcblx0fTtcblxuXHRmdW5jdGlvbiBhZGRWZXJ0aWNhbEluZm8odGltaW5nRXZlbnRzKSB7XG5cdFx0Ly8gQWRkIHZlcnRpY2FsIGluZm8gdG8gdGhlIGJhciBldmVudHM6IHB1dCB0aGUgbmV4dCBldmVudCdzIHRvcCwgYW5kIHRoZSBldmVudCBhZnRlciB0aGUgbmV4dCBtZWFzdXJlJ3MgdG9wLlxuXHRcdHZhciBsYXN0QmFyVG9wO1xuXHRcdHZhciBsYXN0QmFyQm90dG9tO1xuXHRcdHZhciBsYXN0RXZlbnRUb3A7XG5cdFx0dmFyIGxhc3RFdmVudEJvdHRvbTtcblx0XHRmb3IgKHZhciBlID0gdGltaW5nRXZlbnRzLmxlbmd0aCAtIDE7IGUgPj0gMDsgZS0tKSB7XG5cdFx0XHR2YXIgZXYgPSB0aW1pbmdFdmVudHNbZV07XG5cdFx0XHRpZiAoZXYudHlwZSA9PT0gJ2JhcicpIHtcblx0XHRcdFx0ZXYudG9wID0gbGFzdEV2ZW50VG9wO1xuXHRcdFx0XHRldi5uZXh0VG9wID0gbGFzdEJhclRvcDtcblx0XHRcdFx0bGFzdEJhclRvcCA9IGxhc3RFdmVudFRvcDtcblxuXHRcdFx0XHRldi5ib3R0b20gPSBsYXN0RXZlbnRCb3R0b207XG5cdFx0XHRcdGV2Lm5leHRCb3R0b20gPSBsYXN0QmFyQm90dG9tO1xuXHRcdFx0XHRsYXN0QmFyQm90dG9tID0gbGFzdEV2ZW50Qm90dG9tO1xuXHRcdFx0fSBlbHNlIGlmIChldi50eXBlID09PSAnZXZlbnQnKSB7XG5cdFx0XHRcdGxhc3RFdmVudFRvcCA9IGV2LnRvcDtcblx0XHRcdFx0bGFzdEV2ZW50Qm90dG9tID0gZXYudG9wICsgZXYuaGVpZ2h0O1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGZ1bmN0aW9uIG1ha2VTb3J0ZWRBcnJheShoYXNoKSB7XG5cdFx0dmFyIGFyciA9IFtdO1xuXHRcdGZvciAodmFyIGsgaW4gaGFzaCkge1xuXHRcdFx0aWYgKGhhc2guaGFzT3duUHJvcGVydHkoaykpXG5cdFx0XHRcdGFyci5wdXNoKGhhc2hba10pO1xuXHRcdH1cblx0XHRhcnIgPSBhcnIuc29ydChmdW5jdGlvbiAoYSwgYikge1xuXHRcdFx0dmFyIGRpZmYgPSBhLm1pbGxpc2Vjb25kcyAtIGIubWlsbGlzZWNvbmRzO1xuXHRcdFx0Ly8gaWYgdGhlIGV2ZW50cyBoYXZlIHRoZSBzYW1lIHRpbWUsIG1ha2Ugc3VyZSBhIGJhciBjb21lcyBiZWZvcmUgYSBub3RlXG5cdFx0XHRpZiAoZGlmZiAhPT0gMCkge1xuXHRcdFx0XHRyZXR1cm4gZGlmZjtcblx0XHRcdH1cblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRyZXR1cm4gYS50eXBlID09PSBcImJhclwiID8gLTEgOiAxO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHRcdHJldHVybiBhcnI7XG5cdH1cblxuXHR0aGlzLmFkZEVsZW1lbnRUb0V2ZW50cyA9IGZ1bmN0aW9uKGV2ZW50SGFzaCwgZWxlbWVudCwgdm9pY2VUaW1lTWlsbGlzZWNvbmRzLCB0b3AsIGhlaWdodCwgbGluZSwgbWVhc3VyZU51bWJlciwgdGltZURpdmlkZXIsIGlzVGllZFN0YXRlLCBuZXh0SXNCYXIpIHtcblx0XHRpZiAoZWxlbWVudC5oaW50KVxuXHRcdFx0cmV0dXJuIHsgaXNUaWVkU3RhdGU6IHVuZGVmaW5lZCwgZHVyYXRpb246IDAgfTtcblx0XHR2YXIgcmVhbER1cmF0aW9uID0gZWxlbWVudC5kdXJhdGlvbkNsYXNzID8gZWxlbWVudC5kdXJhdGlvbkNsYXNzIDogZWxlbWVudC5kdXJhdGlvbjtcblx0XHRpZiAoZWxlbWVudC5hYmNlbGVtLnJlc3QgJiYgZWxlbWVudC5hYmNlbGVtLnJlc3QudHlwZSA9PT0gXCJzcGFjZXJcIilcblx0XHRcdHJlYWxEdXJhdGlvbiA9IDA7XG5cdFx0aWYgKHJlYWxEdXJhdGlvbiA+IDApIHtcblx0XHRcdHZhciBlcyA9IFtdO1xuXHRcdFx0Ly8gSWYgdGhlcmUgaXMgYW4gaW52aXNpYmxlIHJlc3QsIHRoZW4gdGhlcmUgYXJlIG5vdCBlbGVtZW50cywgc28gZG9uJ3QgcHVzaCBhIG51bGwgb25lLlxuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50LmVsZW1zZXQubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKGVsZW1lbnQuZWxlbXNldFtpXSAhPT0gbnVsbClcblx0XHRcdFx0XHRlcy5wdXNoKGVsZW1lbnQuZWxlbXNldFtpXSk7XG5cdFx0XHR9XG5cdFx0XHR2YXIgaXNUaWVkVG9OZXh0ID0gZWxlbWVudC5zdGFydFRpZTtcblx0XHRcdGlmIChpc1RpZWRTdGF0ZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdGV2ZW50SGFzaFtcImV2ZW50XCIgKyBpc1RpZWRTdGF0ZV0uZWxlbWVudHMucHVzaChlcyk7IC8vIEFkZCB0aGUgdGllZCBub3RlIHRvIHRoZSBmaXJzdCBub3RlIHRoYXQgaXQgaXMgdGllZCB0b1xuXHRcdFx0XHRpZiAoIWlzVGllZFRvTmV4dClcblx0XHRcdFx0XHRpc1RpZWRTdGF0ZSA9IHVuZGVmaW5lZDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIHRoZSBsYXN0IG5vdGUgd2Fzbid0IHRpZWQuXG5cdFx0XHRcdGlmICghZXZlbnRIYXNoW1wiZXZlbnRcIiArIHZvaWNlVGltZU1pbGxpc2Vjb25kc10pIHtcblx0XHRcdFx0XHRldmVudEhhc2hbXCJldmVudFwiICsgdm9pY2VUaW1lTWlsbGlzZWNvbmRzXSA9IHtcblx0XHRcdFx0XHRcdHR5cGU6IFwiZXZlbnRcIixcblx0XHRcdFx0XHRcdG1pbGxpc2Vjb25kczogdm9pY2VUaW1lTWlsbGlzZWNvbmRzLFxuXHRcdFx0XHRcdFx0bGluZTogbGluZSxcblx0XHRcdFx0XHRcdG1lYXN1cmVOdW1iZXI6IG1lYXN1cmVOdW1iZXIsXG5cdFx0XHRcdFx0XHR0b3A6IHRvcCxcblx0XHRcdFx0XHRcdGhlaWdodDogaGVpZ2h0LFxuXHRcdFx0XHRcdFx0bGVmdDogZWxlbWVudC54LFxuXHRcdFx0XHRcdFx0d2lkdGg6IGVsZW1lbnQudyxcblx0XHRcdFx0XHRcdGVsZW1lbnRzOiBbZXNdLFxuXHRcdFx0XHRcdFx0c3RhcnRDaGFyOiBlbGVtZW50LmFiY2VsZW0uc3RhcnRDaGFyLFxuXHRcdFx0XHRcdFx0ZW5kQ2hhcjogZWxlbWVudC5hYmNlbGVtLmVuZENoYXIsXG5cdFx0XHRcdFx0XHRzdGFydENoYXJBcnJheTogW2VsZW1lbnQuYWJjZWxlbS5zdGFydENoYXJdLFxuXHRcdFx0XHRcdFx0ZW5kQ2hhckFycmF5OiBbZWxlbWVudC5hYmNlbGVtLmVuZENoYXJdXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBJZiB0aGVyZSBpcyBtb3JlIHRoYW4gb25lIHZvaWNlIHRoZW4gdHdvIG5vdGVzIGNhbiBmYWxsIGF0IHRoZSBzYW1lIHRpbWUuIFVzdWFsbHkgdGhleSB3b3VsZCBiZSBsaW5lZCB1cCBpbiB0aGUgc2FtZSBwbGFjZSwgYnV0IGlmIGl0IGlzIGEgd2hvbGUgcmVzdCwgdGhlbiBpdCBpcyBwbGFjZWQgZnVubnkuIEluIGFueSBjYXNlLCB0aGUgbGVmdCBtb3N0IGVsZW1lbnQgd2lucy5cblx0XHRcdFx0XHRldmVudEhhc2hbXCJldmVudFwiICsgdm9pY2VUaW1lTWlsbGlzZWNvbmRzXS5sZWZ0ID0gTWF0aC5taW4oZXZlbnRIYXNoW1wiZXZlbnRcIiArIHZvaWNlVGltZU1pbGxpc2Vjb25kc10ubGVmdCwgZWxlbWVudC54KTtcblx0XHRcdFx0XHRldmVudEhhc2hbXCJldmVudFwiICsgdm9pY2VUaW1lTWlsbGlzZWNvbmRzXS5lbGVtZW50cy5wdXNoKGVzKTtcblx0XHRcdFx0XHRldmVudEhhc2hbXCJldmVudFwiICsgdm9pY2VUaW1lTWlsbGlzZWNvbmRzXS5zdGFydENoYXJBcnJheS5wdXNoKGVsZW1lbnQuYWJjZWxlbS5zdGFydENoYXIpO1xuXHRcdFx0XHRcdGV2ZW50SGFzaFtcImV2ZW50XCIgKyB2b2ljZVRpbWVNaWxsaXNlY29uZHNdLmVuZENoYXJBcnJheS5wdXNoKGVsZW1lbnQuYWJjZWxlbS5lbmRDaGFyKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAobmV4dElzQmFyKSB7XG5cdFx0XHRcdFx0ZXZlbnRIYXNoW1wiZXZlbnRcIiArIHZvaWNlVGltZU1pbGxpc2Vjb25kc10ubWVhc3VyZVN0YXJ0ID0gdHJ1ZTtcblx0XHRcdFx0XHRuZXh0SXNCYXIgPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoaXNUaWVkVG9OZXh0KVxuXHRcdFx0XHRcdGlzVGllZFN0YXRlID0gdm9pY2VUaW1lTWlsbGlzZWNvbmRzO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4geyBpc1RpZWRTdGF0ZTogaXNUaWVkU3RhdGUsIGR1cmF0aW9uOiByZWFsRHVyYXRpb24gLyB0aW1lRGl2aWRlciwgbmV4dElzQmFyOiBuZXh0SXNCYXIgfHwgZWxlbWVudC50eXBlID09PSAnYmFyJyB9O1xuXHR9O1xuXG5cdHRoaXMubWFrZVZvaWNlc0FycmF5ID0gZnVuY3Rpb24oKSB7XG5cdFx0Ly8gRmlyc3QgbWFrZSBhIG5ldyBhcnJheSB0aGF0IGlzIGFycmFuZ2VkIGJ5IHZvaWNlIHNvIHRoYXQgdGhlIHJlcGVhdHMgdGhhdCBzcGFuIGRpZmZlcmVudCBsaW5lcyBhcmUgaGFuZGxlZCBjb3JyZWN0bHkuXG5cdFx0dmFyIHZvaWNlc0FyciA9IFtdO1xuXHRcdGZvciAodmFyIGxpbmUgPSAwOyBsaW5lIDwgdGhpcy5lbmdyYXZlci5zdGFmZmdyb3Vwcy5sZW5ndGg7IGxpbmUrKykge1xuXHRcdFx0dmFyIGdyb3VwID0gdGhpcy5lbmdyYXZlci5zdGFmZmdyb3Vwc1tsaW5lXTtcblx0XHRcdHZhciBmaXJzdFN0YWZmID0gZ3JvdXAuc3RhZmZzWzBdO1xuXHRcdFx0dmFyIG1pZGRsZUMgPSBmaXJzdFN0YWZmLmFic29sdXRlWTtcblx0XHRcdHZhciB0b3AgPSBtaWRkbGVDIC0gZmlyc3RTdGFmZi50b3AgKiBzcGFjaW5nLlNURVA7XG5cdFx0XHR2YXIgbGFzdFN0YWZmID0gZ3JvdXAuc3RhZmZzW2dyb3VwLnN0YWZmcy5sZW5ndGggLSAxXTtcblx0XHRcdG1pZGRsZUMgPSBsYXN0U3RhZmYuYWJzb2x1dGVZO1xuXHRcdFx0dmFyIGJvdHRvbSA9IG1pZGRsZUMgLSBsYXN0U3RhZmYuYm90dG9tICogc3BhY2luZy5TVEVQO1xuXHRcdFx0dmFyIGhlaWdodCA9IGJvdHRvbSAtIHRvcDtcblxuXHRcdFx0dmFyIHZvaWNlcyA9IGdyb3VwLnZvaWNlcztcblx0XHRcdGZvciAodmFyIHYgPSAwOyB2IDwgdm9pY2VzLmxlbmd0aDsgdisrKSB7XG5cdFx0XHRcdHZhciBtZWFzdXJlTnVtYmVyID0gMDtcblx0XHRcdFx0dmFyIG5vdGVGb3VuZCA9IGZhbHNlO1xuXHRcdFx0XHRpZiAoIXZvaWNlc0Fyclt2XSlcblx0XHRcdFx0XHR2b2ljZXNBcnJbdl0gPSBbXTtcblx0XHRcdFx0dmFyIGVsZW1lbnRzID0gdm9pY2VzW3ZdLmNoaWxkcmVuO1xuXHRcdFx0XHRmb3IgKHZhciBlbGVtID0gMDsgZWxlbSA8IGVsZW1lbnRzLmxlbmd0aDsgZWxlbSsrKSB7XG5cdFx0XHRcdFx0dm9pY2VzQXJyW3ZdLnB1c2goe3RvcDogdG9wLCBoZWlnaHQ6IGhlaWdodCwgbGluZTogbGluZSwgbWVhc3VyZU51bWJlcjogbWVhc3VyZU51bWJlciwgZWxlbTogZWxlbWVudHNbZWxlbV19KTtcblx0XHRcdFx0XHRpZiAoZWxlbWVudHNbZWxlbV0udHlwZSA9PT0gJ2JhcicgJiYgbm90ZUZvdW5kKSAvLyBDb3VudCB0aGUgbWVhc3VyZXMgYnkgY291bnRpbmcgdGhlIGJhciBsaW5lcywgYnV0IHNraXAgYSBiYXIgbGluZSB0aGF0IGFwcGVhcnMgYXQgdGhlIGxlZnQgb2YgdGhlIG11c2ljLCBiZWZvcmUgYW55IG5vdGVzLlxuXHRcdFx0XHRcdFx0bWVhc3VyZU51bWJlcisrO1xuXHRcdFx0XHRcdGlmIChlbGVtZW50c1tlbGVtXS50eXBlID09PSAnbm90ZScpXG5cdFx0XHRcdFx0XHRub3RlRm91bmQgPSB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB2b2ljZXNBcnI7XG5cdH07XG5cblx0dGhpcy5zZXR1cEV2ZW50cyA9IGZ1bmN0aW9uKHN0YXJ0aW5nRGVsYXksIHRpbWVEaXZpZGVyKSB7XG5cdFx0dmFyIHRpbWluZ0V2ZW50cyA9IFtdO1xuXG5cdFx0dmFyIGV2ZW50SGFzaCA9IHt9O1xuXHRcdC8vIFRoZSB0aW1lIGlzIHRoZSBudW1iZXIgb2Ygc2Vjb25kcyBmcm9tIHRoZSBiZWdpbm5pbmcgb2YgdGhlIHBpZWNlLlxuXHRcdC8vIFRoZSB1bml0cyB3ZSBhcmUgc2Nhbm5pbmcgYXJlIGluIG5vdGF0aW9uIHVuaXRzIChpLmUuIDAuMjUgaXMgYSBxdWFydGVyIG5vdGUpXG5cdFx0dmFyIHRpbWUgPSBzdGFydGluZ0RlbGF5O1xuXHRcdHZhciBpc1RpZWRTdGF0ZTtcblx0XHR2YXIgbmV4dElzQmFyID0gdHJ1ZTtcblx0XHR2YXIgdm9pY2VzID0gdGhpcy5tYWtlVm9pY2VzQXJyYXkoKTtcblx0XHRmb3IgKHZhciB2ID0gMDsgdiA8IHZvaWNlcy5sZW5ndGg7IHYrKykge1xuXHRcdFx0dmFyIHZvaWNlVGltZSA9IHRpbWU7XG5cdFx0XHR2YXIgdm9pY2VUaW1lTWlsbGlzZWNvbmRzID0gTWF0aC5yb3VuZCh2b2ljZVRpbWUgKiAxMDAwKTtcblx0XHRcdHZhciBzdGFydGluZ1JlcGVhdEVsZW0gPSAwO1xuXHRcdFx0dmFyIGVuZGluZ1JlcGVhdEVsZW0gPSAtMTtcblx0XHRcdHZhciBlbGVtZW50cyA9IHZvaWNlc1t2XTtcblx0XHRcdGZvciAodmFyIGVsZW0gPSAwOyBlbGVtIDwgZWxlbWVudHMubGVuZ3RoOyBlbGVtKyspIHtcblx0XHRcdFx0dmFyIGVsZW1lbnQgPSBlbGVtZW50c1tlbGVtXS5lbGVtO1xuXHRcdFx0XHRpZiAoZWxlbWVudC5hYmNlbGVtLmVsX3R5cGUgPT09IFwidGVtcG9cIikge1xuXHRcdFx0XHRcdHZhciBicG0gPSB0aGlzLmdldEJwbShlbGVtZW50LmFiY2VsZW0pO1xuXHRcdFx0XHRcdHZhciBiZWF0TGVuZ3RoID0gdGhpcy5nZXRCZWF0TGVuZ3RoKCk7XG5cdFx0XHRcdFx0dmFyIGJlYXRzUGVyU2Vjb25kID0gYnBtIC8gNjA7XG5cdFx0XHRcdFx0dGltZURpdmlkZXIgPSBiZWF0TGVuZ3RoICogYmVhdHNQZXJTZWNvbmQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIHJldCA9IHRoaXMuYWRkRWxlbWVudFRvRXZlbnRzKGV2ZW50SGFzaCwgZWxlbWVudCwgdm9pY2VUaW1lTWlsbGlzZWNvbmRzLCBlbGVtZW50c1tlbGVtXS50b3AsIGVsZW1lbnRzW2VsZW1dLmhlaWdodCwgZWxlbWVudHNbZWxlbV0ubGluZSwgZWxlbWVudHNbZWxlbV0ubWVhc3VyZU51bWJlciwgdGltZURpdmlkZXIsIGlzVGllZFN0YXRlLCBuZXh0SXNCYXIpO1xuXHRcdFx0XHRpc1RpZWRTdGF0ZSA9IHJldC5pc1RpZWRTdGF0ZTtcblx0XHRcdFx0bmV4dElzQmFyID0gcmV0Lm5leHRJc0Jhcjtcblx0XHRcdFx0dm9pY2VUaW1lICs9IHJldC5kdXJhdGlvbjtcblx0XHRcdFx0dm9pY2VUaW1lTWlsbGlzZWNvbmRzID0gTWF0aC5yb3VuZCh2b2ljZVRpbWUgKiAxMDAwKTtcblx0XHRcdFx0aWYgKGVsZW1lbnQudHlwZSA9PT0gJ2JhcicpIHtcblx0XHRcdFx0XHR2YXIgYmFyVHlwZSA9IGVsZW1lbnQuYWJjZWxlbS50eXBlO1xuXHRcdFx0XHRcdHZhciBlbmRSZXBlYXQgPSAoYmFyVHlwZSA9PT0gXCJiYXJfcmlnaHRfcmVwZWF0XCIgfHwgYmFyVHlwZSA9PT0gXCJiYXJfZGJsX3JlcGVhdFwiKTtcblx0XHRcdFx0XHR2YXIgc3RhcnRFbmRpbmcgPSAoZWxlbWVudC5hYmNlbGVtLnN0YXJ0RW5kaW5nID09PSAnMScpO1xuXHRcdFx0XHRcdHZhciBzdGFydFJlcGVhdCA9IChiYXJUeXBlID09PSBcImJhcl9sZWZ0X3JlcGVhdFwiIHx8IGJhclR5cGUgPT09IFwiYmFyX2RibF9yZXBlYXRcIiB8fCBiYXJUeXBlID09PSBcImJhcl9yaWdodF9yZXBlYXRcIik7XG5cdFx0XHRcdFx0aWYgKGVuZFJlcGVhdCkge1xuXHRcdFx0XHRcdFx0aWYgKGVuZGluZ1JlcGVhdEVsZW0gPT09IC0xKVxuXHRcdFx0XHRcdFx0XHRlbmRpbmdSZXBlYXRFbGVtID0gZWxlbTtcblx0XHRcdFx0XHRcdGZvciAodmFyIGVsMiA9IHN0YXJ0aW5nUmVwZWF0RWxlbTsgZWwyIDwgZW5kaW5nUmVwZWF0RWxlbTsgZWwyKyspIHtcblx0XHRcdFx0XHRcdFx0dmFyIGVsZW1lbnQyID0gZWxlbWVudHNbZWwyXS5lbGVtO1xuXHRcdFx0XHRcdFx0XHRyZXQgPSB0aGlzLmFkZEVsZW1lbnRUb0V2ZW50cyhldmVudEhhc2gsIGVsZW1lbnQyLCB2b2ljZVRpbWVNaWxsaXNlY29uZHMsIGVsZW1lbnRzW2VsMl0udG9wLCBlbGVtZW50c1tlbDJdLmhlaWdodCwgZWxlbWVudHNbZWwyXS5saW5lLCBlbGVtZW50c1tlbDJdLm1lYXN1cmVOdW1iZXIsIHRpbWVEaXZpZGVyLCBpc1RpZWRTdGF0ZSwgbmV4dElzQmFyKTtcblx0XHRcdFx0XHRcdFx0aXNUaWVkU3RhdGUgPSByZXQuaXNUaWVkU3RhdGU7XG5cdFx0XHRcdFx0XHRcdG5leHRJc0JhciA9IHJldC5uZXh0SXNCYXI7XG5cdFx0XHRcdFx0XHRcdHZvaWNlVGltZSArPSByZXQuZHVyYXRpb247XG5cdFx0XHRcdFx0XHRcdHZvaWNlVGltZU1pbGxpc2Vjb25kcyA9IE1hdGgucm91bmQodm9pY2VUaW1lICogMTAwMCk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRuZXh0SXNCYXIgPSB0cnVlO1xuXHRcdFx0XHRcdFx0ZW5kaW5nUmVwZWF0RWxlbSA9IC0xO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoc3RhcnRFbmRpbmcpXG5cdFx0XHRcdFx0XHRlbmRpbmdSZXBlYXRFbGVtID0gZWxlbTtcblx0XHRcdFx0XHRpZiAoc3RhcnRSZXBlYXQpXG5cdFx0XHRcdFx0XHRzdGFydGluZ1JlcGVhdEVsZW0gPSBlbGVtO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdC8vIG5vdyB3ZSBoYXZlIGFsbCB0aGUgZXZlbnRzLCBidXQgaWYgdGhlcmUgYXJlIG11bHRpcGxlIHZvaWNlcyB0aGVuIHRoZXJlIG1heSBiZSBldmVudHMgb3V0IG9mIG9yZGVyIG9yIGR1cGxpY2F0ZWQsIHNvIG5vcm1hbGl6ZSBpdC5cblx0XHR0aW1pbmdFdmVudHMgPSBtYWtlU29ydGVkQXJyYXkoZXZlbnRIYXNoKTtcblx0XHRhZGRWZXJ0aWNhbEluZm8odGltaW5nRXZlbnRzKTtcblx0XHRyZXR1cm4gdGltaW5nRXZlbnRzO1xuXHR9O1xuXG5cdGZ1bmN0aW9uIGdldFZlcnRpY2FsKGdyb3VwKSB7XG5cdFx0dmFyIHZvaWNlcyA9IGdyb3VwLnZvaWNlcztcblx0XHR2YXIgZmlyc3RTdGFmZiA9IGdyb3VwLnN0YWZmc1swXTtcblx0XHR2YXIgbWlkZGxlQyA9IGZpcnN0U3RhZmYuYWJzb2x1dGVZO1xuXHRcdHZhciB0b3AgPSBtaWRkbGVDIC0gZmlyc3RTdGFmZi50b3Aqc3BhY2luZy5TVEVQO1xuXHRcdHZhciBsYXN0U3RhZmYgPSBncm91cC5zdGFmZnNbZ3JvdXAuc3RhZmZzLmxlbmd0aC0xXTtcblx0XHRtaWRkbGVDID0gbGFzdFN0YWZmLmFic29sdXRlWTtcblx0XHR2YXIgYm90dG9tID0gbWlkZGxlQyAtIGxhc3RTdGFmZi5ib3R0b20qc3BhY2luZy5TVEVQO1xuXHRcdHZhciBoZWlnaHQgPSBib3R0b20gLSB0b3A7XG5cdFx0cmV0dXJuIHsgdG9wOiB0b3AsIGhlaWdodDogaGVpZ2h0IH07XG5cdH1cblxuXHR0aGlzLmdldEJwbSA9IGZ1bmN0aW9uKHRlbXBvKSB7XG5cdFx0dmFyIGJwbTtcblx0XHRpZiAodGVtcG8pIHtcblx0XHRcdGJwbSA9IHRlbXBvLmJwbTtcblx0XHRcdHZhciBiZWF0TGVuZ3RoID0gdGhpcy5nZXRCZWF0TGVuZ3RoKCk7XG5cdFx0XHR2YXIgc3RhdGVkQmVhdExlbmd0aCA9IHRlbXBvLmR1cmF0aW9uICYmIHRlbXBvLmR1cmF0aW9uLmxlbmd0aCA+IDAgPyB0ZW1wby5kdXJhdGlvblswXSA6IGJlYXRMZW5ndGg7XG5cdFx0XHRicG0gPSBicG0gKiBzdGF0ZWRCZWF0TGVuZ3RoIC8gYmVhdExlbmd0aDtcblx0XHR9XG5cdFx0aWYgKCFicG0pIHtcblx0XHRcdGJwbSA9IDE4MDtcblx0XHRcdC8vIENvbXBlbnNhdGUgZm9yIGNvbXBvdW5kIG1ldGVyLCB3aGVyZSB0aGUgYmVhdCBpc24ndCBhIGJlYXQuXG5cdFx0XHR2YXIgbWV0ZXIgPSB0aGlzLmdldE1ldGVyRnJhY3Rpb24oKTtcblx0XHRcdGlmIChtZXRlciAmJiBtZXRlci5kZW4gPT09IDgpIHtcblx0XHRcdFx0YnBtID0gMTIwO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gYnBtO1xuXHR9O1xuXG5cdHRoaXMuc2V0VGltaW5nID0gZnVuY3Rpb24gKGJwbSwgbWVhc3VyZXNPZkRlbGF5KSB7XG5cdFx0aWYgKCFicG0pIHtcblx0XHRcdHZhciB0ZW1wbyA9IHRoaXMubWV0YVRleHQgPyB0aGlzLm1ldGFUZXh0LnRlbXBvIDogbnVsbDtcblx0XHRcdGJwbSA9IHRoaXMuZ2V0QnBtKHRlbXBvKTtcblx0XHR9XG5cblx0XHR2YXIgYmVhdExlbmd0aCA9IHRoaXMuZ2V0QmVhdExlbmd0aCgpO1xuXHRcdHZhciBiZWF0c1BlclNlY29uZCA9IGJwbSAvIDYwO1xuXG5cdFx0dmFyIG1lYXN1cmVMZW5ndGggPSB0aGlzLmdldEJhckxlbmd0aCgpO1xuXG5cdFx0dmFyIHN0YXJ0aW5nRGVsYXkgPSBtZWFzdXJlTGVuZ3RoIC8gYmVhdExlbmd0aCAqIG1lYXN1cmVzT2ZEZWxheSAvIGJlYXRzUGVyU2Vjb25kO1xuXHRcdGlmIChzdGFydGluZ0RlbGF5KVxuXHRcdFx0c3RhcnRpbmdEZWxheSAtPSB0aGlzLmdldFBpY2t1cExlbmd0aCgpIC8gYmVhdExlbmd0aCAvIGJlYXRzUGVyU2Vjb25kO1xuXHRcdHZhciB0aW1lRGl2aWRlciA9IGJlYXRMZW5ndGggKiBiZWF0c1BlclNlY29uZDtcblxuXHRcdHRoaXMubm90ZVRpbWluZ3MgPSB0aGlzLnNldHVwRXZlbnRzKHN0YXJ0aW5nRGVsYXksIHRpbWVEaXZpZGVyKTtcblx0fTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHVuZTtcbiIsIi8vIGFiY19lZGl0b3IuanNcbi8vIHdpbmRvdy5BQkNKUy5FZGl0b3IgaXMgdGhlIGludGVyZmFjZSBjbGFzcyBmb3IgdGhlIGFyZWEgdGhhdCBjb250YWlucyB0aGUgQUJDIHRleHQuIEl0IGlzIHJlc3BvbnNpYmxlIGZvclxuLy8gaG9sZGluZyB0aGUgdGV4dCBvZiB0aGUgdHVuZSBhbmQgY2FsbGluZyB0aGUgcGFyc2VyIGFuZCB0aGUgcmVuZGVyaW5nIGVuZ2luZXMuXG4vL1xuLy8gRWRpdEFyZWEgaXMgYW4gZXhhbXBsZSBvZiB1c2luZyBhIHRleHRhcmVhIGFzIHRoZSBjb250cm9sIHRoYXQgaXMgc2hvd24gdG8gdGhlIHVzZXIuIEFzIGxvbmcgYXNcbi8vIHRoZSBzYW1lIGludGVyZmFjZSBpcyB1c2VkLCB3aW5kb3cuQUJDSlMuRWRpdG9yIGNhbiB1c2UgYSBkaWZmZXJlbnQgdHlwZSBvZiBvYmplY3QuXG4vL1xuLy8gRWRpdEFyZWE6XG4vLyAtIGNvbnN0cnVjdG9yKHRleHRhcmVhaWQpXG4vL1x0XHRUaGlzIGNvbnRhaW5zIHRoZSBpZCBvZiBhIHRleHRhcmVhIGNvbnRyb2wgdGhhdCB3aWxsIGJlIHVzZWQuXG4vLyAtIGFkZFNlbGVjdGlvbkxpc3RlbmVyKGxpc3RlbmVyKVxuLy9cdFx0QSBjYWxsYmFjayBjbGFzcyB0aGF0IGNvbnRhaW5zIHRoZSBlbnRyeSBwb2ludCBmaXJlU2VsZWN0aW9uQ2hhbmdlZCgpXG4vLyAtIGFkZENoYW5nZUxpc3RlbmVyKGxpc3RlbmVyKVxuLy9cdFx0QSBjYWxsYmFjayBjbGFzcyB0aGF0IGNvbnRhaW5zIHRoZSBlbnRyeSBwb2ludCBmaXJlQ2hhbmdlZCgpXG4vLyAtIGdldFNlbGVjdGlvbigpXG4vL1x0XHRyZXR1cm5zIHRoZSBvYmplY3QgeyBzdGFydDogLCBlbmQ6IH0gd2l0aCB0aGUgY3VycmVudCBzZWxlY3Rpb24gaW4gY2hhcmFjdGVyc1xuLy8gLSBzZXRTZWxlY3Rpb24oc3RhcnQsIGVuZClcbi8vXHRcdHN0YXJ0IGFuZCBlbmQgYXJlIHRoZSBjaGFyYWN0ZXIgcG9zaXRpb25zIHRoYXQgc2hvdWxkIGJlIHNlbGVjdGVkLlxuLy8gLSBnZXRTdHJpbmcoKVxuLy9cdFx0cmV0dXJucyB0aGUgQUJDIHRleHQgdGhhdCBpcyBjdXJyZW50bHkgZGlzcGxheWVkLlxuLy8gLSBzZXRTdHJpbmcoc3RyKVxuLy9cdFx0c2V0cyB0aGUgQUJDIHRleHQgdGhhdCBpcyBjdXJyZW50bHkgZGlzcGxheWVkLCBhbmQgcmVzZXRzIHRoZSBpbml0aWFsVGV4dCB2YXJpYWJsZVxuLy8gLSBnZXRFbGVtKClcbi8vXHRcdHJldHVybnMgdGhlIHRleHRhcmVhIGVsZW1lbnRcbi8vIC0gc3RyaW5nIGluaXRpYWxUZXh0XG4vL1x0XHRDb250YWlucyB0aGUgc3RhcnRpbmcgdGV4dC4gVGhpcyBjYW4gYmUgY29tcGFyZWQgYWdhaW5zdCB0aGUgY3VycmVudCB0ZXh0IHRvIHNlZSBpZiBhbnl0aGluZyBjaGFuZ2VkLlxuLy9cblxuLypnbG9iYWwgZG9jdW1lbnQsIHdpbmRvdywgY2xlYXJUaW1lb3V0LCBzZXRUaW1lb3V0ICovXG5cbnZhciBUdW5lQm9vayA9IHJlcXVpcmUoJy4uL2FwaS9hYmNfdHVuZWJvb2snKS5UdW5lQm9vaztcbnZhciBwYXJzZUNvbW1vbiA9IHJlcXVpcmUoJy4uL3BhcnNlL2FiY19jb21tb24nKTtcbnZhciBQYXJzZSA9IHJlcXVpcmUoJy4uL3BhcnNlL2FiY19wYXJzZScpO1xudmFyIFRleHRQcmludGVyID0gcmVxdWlyZSgnLi4vdHJhbnNmb3JtL2FiYzJhYmNfd3JpdGUnKTtcbnZhciBFbmdyYXZlckNvbnRyb2xsZXIgPSByZXF1aXJlKCcuLi93cml0ZS9hYmNfZW5ncmF2ZXJfY29udHJvbGxlcicpO1xuXG4vLyBQb2x5ZmlsbCBmb3IgQ3VzdG9tRXZlbnQgZm9yIG9sZCBJRSB2ZXJzaW9uc1xuaWYgKCB0eXBlb2Ygd2luZG93LkN1c3RvbUV2ZW50ICE9PSBcImZ1bmN0aW9uXCIgKSB7XG5cdGZ1bmN0aW9uIEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMpIHtcblx0XHRwYXJhbXMgPSBwYXJhbXMgfHwge2J1YmJsZXM6IGZhbHNlLCBjYW5jZWxhYmxlOiBmYWxzZSwgZGV0YWlsOiB1bmRlZmluZWR9O1xuXHRcdHZhciBldnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCgnQ3VzdG9tRXZlbnQnKTtcblx0XHRldnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50LCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuXHRcdHJldHVybiBldnQ7XG5cdH1cblx0Q3VzdG9tRXZlbnQucHJvdG90eXBlID0gd2luZG93LkV2ZW50LnByb3RvdHlwZTtcblx0d2luZG93LkN1c3RvbUV2ZW50ID0gQ3VzdG9tRXZlbnQ7XG59XG5cbnZhciBFZGl0QXJlYSA9IGZ1bmN0aW9uKHRleHRhcmVhaWQpIHtcbiAgdGhpcy50ZXh0YXJlYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHRleHRhcmVhaWQpO1xuICB0aGlzLmluaXRpYWxUZXh0ID0gdGhpcy50ZXh0YXJlYS52YWx1ZTtcbiAgdGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG59XG5cbkVkaXRBcmVhLnByb3RvdHlwZS5hZGRTZWxlY3Rpb25MaXN0ZW5lciA9IGZ1bmN0aW9uKGxpc3RlbmVyKSB7XG4gIHRoaXMudGV4dGFyZWEub25tb3VzZW1vdmUgPSBmdW5jdGlvbihldikge1xuXHQgIGlmICh0aGlzLmlzRHJhZ2dpbmcpXG5cdCAgICBsaXN0ZW5lci5maXJlU2VsZWN0aW9uQ2hhbmdlZCgpO1xuICB9O1xufTtcblxuRWRpdEFyZWEucHJvdG90eXBlLmFkZENoYW5nZUxpc3RlbmVyID0gZnVuY3Rpb24obGlzdGVuZXIpIHtcbiAgdGhpcy5jaGFuZ2VsaXN0ZW5lciA9IGxpc3RlbmVyO1xuICB0aGlzLnRleHRhcmVhLm9ua2V5dXAgPSBmdW5jdGlvbigpIHtcbiAgICBsaXN0ZW5lci5maXJlQ2hhbmdlZCgpO1xuICB9O1xuICB0aGlzLnRleHRhcmVhLm9ubW91c2Vkb3duID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuaXNEcmFnZ2luZyA9IHRydWU7XG4gICAgbGlzdGVuZXIuZmlyZVNlbGVjdGlvbkNoYW5nZWQoKTtcbiAgfTtcbiAgdGhpcy50ZXh0YXJlYS5vbm1vdXNldXAgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5pc0RyYWdnaW5nID0gZmFsc2U7XG4gICAgbGlzdGVuZXIuZmlyZUNoYW5nZWQoKTtcbiAgfTtcbiAgdGhpcy50ZXh0YXJlYS5vbmNoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgIGxpc3RlbmVyLmZpcmVDaGFuZ2VkKCk7XG4gIH07XG59O1xuXG4vL1RPRE8gd29uJ3Qgd29yayB1bmRlciBJRT9cbkVkaXRBcmVhLnByb3RvdHlwZS5nZXRTZWxlY3Rpb24gPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIHtzdGFydDogdGhpcy50ZXh0YXJlYS5zZWxlY3Rpb25TdGFydCwgZW5kOiB0aGlzLnRleHRhcmVhLnNlbGVjdGlvbkVuZH07XG59O1xuXG5FZGl0QXJlYS5wcm90b3R5cGUuc2V0U2VsZWN0aW9uID0gZnVuY3Rpb24oc3RhcnQsIGVuZCkge1xuXHRpZih0aGlzLnRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKVxuXHQgICB0aGlzLnRleHRhcmVhLnNldFNlbGVjdGlvblJhbmdlKHN0YXJ0LCBlbmQpO1xuXHRlbHNlIGlmKHRoaXMudGV4dGFyZWEuY3JlYXRlVGV4dFJhbmdlKSB7XG5cdFx0Ly8gRm9yIElFOFxuXHQgICB2YXIgZSA9IHRoaXMudGV4dGFyZWEuY3JlYXRlVGV4dFJhbmdlKCk7XG5cdCAgIGUuY29sbGFwc2UodHJ1ZSk7XG5cdCAgIGUubW92ZUVuZCgnY2hhcmFjdGVyJywgZW5kKTtcblx0ICAgZS5tb3ZlU3RhcnQoJ2NoYXJhY3RlcicsIHN0YXJ0KTtcblx0ICAgZS5zZWxlY3QoKTtcblx0fVxuICB0aGlzLnRleHRhcmVhLmZvY3VzKCk7XG59O1xuXG5FZGl0QXJlYS5wcm90b3R5cGUuZ2V0U3RyaW5nID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnRleHRhcmVhLnZhbHVlO1xufTtcblxuRWRpdEFyZWEucHJvdG90eXBlLnNldFN0cmluZyA9IGZ1bmN0aW9uKHN0cikge1xuICB0aGlzLnRleHRhcmVhLnZhbHVlID0gc3RyO1xuICB0aGlzLmluaXRpYWxUZXh0ID0gdGhpcy5nZXRTdHJpbmcoKTtcbiAgaWYgKHRoaXMuY2hhbmdlbGlzdGVuZXIpIHtcbiAgICB0aGlzLmNoYW5nZWxpc3RlbmVyLmZpcmVDaGFuZ2VkKCk7XG4gIH1cbn07XG5cbkVkaXRBcmVhLnByb3RvdHlwZS5nZXRFbGVtID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiB0aGlzLnRleHRhcmVhO1xufTtcblxuLy9cbi8vIHdpbmRvdy5BQkNKUy5FZGl0b3I6XG4vL1xuLy8gY29uc3RydWN0b3IoZWRpdGFyZWEsIHBhcmFtcylcbi8vXHRcdGlmIGVkaXRhcmVhIGlzIGEgc3RyaW5nLCB0aGVuIGl0IGlzIGFuIEhUTUwgaWQgb2YgYSB0ZXh0YXJlYSBjb250cm9sLlxuLy9cdFx0T3RoZXJ3aXNlLCBpdCBzaG91bGQgYmUgYW4gaW5zdGFudGlhdGlvbiBvZiBhbiBvYmplY3QgdGhhdCBleHByZXNzZXMgdGhlIEVkaXRBcmVhIGludGVyZmFjZS5cbi8vXG4vL1x0XHRwYXJhbXMgaXMgYSBoYXNoIG9mOlxuLy9cdFx0Y2FudmFzX2lkOiBvciBwYXBlcl9pZDogSFRNTCBpZCB0byBkcmF3IGluLiBJZiBub3QgcHJlc2VudCwgdGhlbiB0aGUgZHJhd2luZyBoYXBwZW5zIGp1c3QgYmVsb3cgdGhlIGVkaXRvci5cbi8vXHRcdGdlbmVyYXRlX21pZGk6IGlmIHByZXNlbnQsIHRoZW4gbWlkaSBpcyBnZW5lcmF0ZWQuXG4vL1x0XHRtaWRpX2lkOiBpZiBwcmVzZW50LCB0aGUgSFRNTCBpZCB0byBwbGFjZSB0aGUgbWlkaSBjb250cm9sLiBPdGhlcndpc2UgaXQgaXMgcGxhY2VkIGluIHRoZSBzYW1lIGRpdiBhcyB0aGUgcGFwZXIuXG4vL1x0XHRtaWRpX2Rvd25sb2FkX2lkOiBpZiBwcmVzZW50LCB0aGUgSFRNTCBpZCB0byBwbGFjZSB0aGUgbWlkaSBkb3dubG9hZCBsaW5rLiBPdGhlcndpc2UgaXQgaXMgcGxhY2VkIGluIHRoZSBzYW1lIGRpdiBhcyB0aGUgcGFwZXIuXG4vL1x0XHRnZW5lcmF0ZV93YXJuaW5nczogaWYgcHJlc2VudCwgdGhlbiBwYXJzZXIgd2FybmluZ3MgYXJlIGRpc3BsYXllZCBvbiB0aGUgcGFnZS5cbi8vXHRcdHdhcm5pbmdzX2lkOiBpZiBwcmVzZW50LCB0aGUgSFRNTCBpZCB0byBwbGFjZSB0aGUgd2FybmluZ3MuIE90aGVyd2lzZSB0aGV5IGFyZSBwbGFjZWQgaW4gdGhlIHNhbWUgZGl2IGFzIHRoZSBwYXBlci5cbi8vXHRcdG9uY2hhbmdlOiBpZiBwcmVzZW50LCB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gdG8gY2FsbCB3aGVuZXZlciB0aGVyZSBoYXMgYmVlbiBhIGNoYW5nZS5cbi8vXHRcdGd1aTogaWYgcHJlc2VudCwgdGhlIHBhcGVyIGNhbiBzZW5kIGNoYW5nZXMgYmFjayB0byB0aGUgZWRpdG9yIChwcmVzdW1hYmx5IGJlY2F1c2UgdGhlIHVzZXIgY2hhbmdlZCBzb21ldGhpbmcgZGlyZWN0bHkuKVxuLy9cdFx0cGFyc2VyX29wdGlvbnM6IG9wdGlvbnMgdG8gc2VuZCB0byB0aGUgcGFyc2VyIGVuZ2luZS5cbi8vXHRcdG1pZGlfb3B0aW9uczogb3B0aW9ucyB0byBzZW5kIHRvIHRoZSBtaWRpIGVuZ2luZS5cbi8vXHRcdHJlbmRlcl9vcHRpb25zOiBvcHRpb25zIHRvIHNlbmQgdG8gdGhlIHJlbmRlciBlbmdpbmUuXG4vL1x0XHRpbmRpY2F0ZV9jaGFuZ2VkOiB0aGUgZGlydHkgZmxhZyBpcyBzZXQgaWYgdGhpcyBpcyB0cnVlLlxuLy9cbi8vIC0gc2V0UmVhZE9ubHkoYm9vbClcbi8vXHRcdGFkZHMgb3IgcmVtb3ZlcyB0aGUgY2xhc3MgYWJjX3RleHRhcmVhX3JlYWRvbmx5LCBhbmQgYWRkcyBvciByZW1vdmVzIHRoZSBhdHRyaWJ1dGUgcmVhZG9ubHk9eWVzXG4vLyAtIHNldERpcnR5U3R5bGUoYm9vbClcbi8vXHRcdGFkZHMgb3IgcmVtb3ZlcyB0aGUgY2xhc3MgYWJjX3RleHRhcmVhX2RpcnR5XG4vLyAtIHJlbmRlclR1bmUoYWJjLCBwYXJzZXJwYXJhbXMsIGRpdilcbi8vXHRcdEltbWVkaWF0ZWx5IHJlbmRlcnMgdGhlIHR1bmUuIChVc2VmdWwgZm9yIGNyZWF0aW5nIHRoZSBTVkcgb3V0cHV0IGJlaGluZCB0aGUgc2NlbmVzLCBpZiBkaXYgaXMgaGlkZGVuKVxuLy9cdFx0c3RyaW5nIGFiYzogdGhlIEFCQyB0ZXh0XG4vL1x0XHRwYXJzZXJwYXJhbXM6IHBhcmFtcyB0byBzZW5kIHRvIHRoZSBwYXJzZXJcbi8vXHRcdGRpdjogdGhlIEhUTUwgaWQgdG8gcmVuZGVyIHRvLlxuLy8gLSBtb2RlbENoYW5nZWQoKVxuLy9cdFx0Q2FsbGVkIHdoZW4gdGhlIG1vZGVsIGhhcyBiZWVuIGNoYW5nZWQgdG8gdHJpZ2dlciByZS1yZW5kZXJpbmdcbi8vIC0gcGFyc2VBQkMoKVxuLy9cdFx0Q2FsbGVkIGludGVybmFsbHkgYnkgZmlyZUNoYW5nZWQoKVxuLy9cdFx0cmV0dXJucyB0cnVlIGlmIHRoZXJlIGhhcyBiZWVuIGEgY2hhbmdlIHNpbmNlIGxhc3QgY2FsbC5cbi8vIC0gdXBkYXRlU2VsZWN0aW9uKClcbi8vXHRcdENhbGxlZCB3aGVuIHRoZSB1c2VyIGhhcyBjaGFuZ2VkIHRoZSBzZWxlY3Rpb24uIFRoaXMgY2FsbHMgdGhlIGVuZ3JhdmVyX2NvbnRyb2xsZXIgdG8gc2hvdyB0aGUgc2VsZWN0aW9uLlxuLy8gLSBmaXJlU2VsZWN0aW9uQ2hhbmdlZCgpXG4vL1x0XHRDYWxsZWQgYnkgdGhlIHRleHRhcmVhIG9iamVjdCB3aGVuIHRoZSB1c2VyIGhhcyBjaGFuZ2VkIHRoZSBzZWxlY3Rpb24uXG4vLyAtIHBhcmFtQ2hhbmdlZChlbmdyYXZlcnBhcmFtcylcbi8vXHRcdENhbGxlZCB0byBzaWduYWwgdGhhdCB0aGUgZW5ncmF2ZXIgcGFyYW1zIGhhdmUgY2hhbmdlZCwgc28gcmUtcmVuZGVyaW5nIHNob3VsZCBvY2N1ci5cbi8vIC0gZmlyZUNoYW5nZWQoKVxuLy9cdFx0Q2FsbGVkIGJ5IHRoZSB0ZXh0YXJlYSBvYmplY3Qgd2hlbiB0aGUgdXNlciBoYXMgY2hhbmdlZCBzb21ldGhpbmcuXG4vLyAtIHNldE5vdERpcnR5KClcbi8vXHRcdENhbGxlZCBieSB0aGUgY2xpZW50IGFwcCB0byByZXNldCB0aGUgZGlydHkgZmxhZ1xuLy8gLSBpc0RpcnR5KClcbi8vXHRcdFJldHVybnMgdHJ1ZSBvciBmYWxzZSwgd2hldGhlciB0aGUgdGV4dGFyZWEgY29udGFpbnMgdGhlIHNhbWUgdGV4dCB0aGF0IGl0IHN0YXJ0ZWQgd2l0aC5cbi8vIC0gaGlnaGxpZ2h0KGFiY2VsZW0pXG4vL1x0XHRDYWxsZWQgYnkgdGhlIGVuZ3JhdmVyX2NvbnRyb2xsZXIgdG8gaGlnaGxpZ2h0IGFuIGFyZWEuXG4vLyAtIHBhdXNlKGJvb2wpXG4vL1x0XHRTdG9wcyB0aGUgYXV0b21hdGljIHJlbmRlcmluZyB3aGVuIHRoZSB1c2VyIGlzIHR5cGluZy5cbi8vXG5cbnZhciBFZGl0b3IgPSBmdW5jdGlvbihlZGl0YXJlYSwgcGFyYW1zKSB7XG5cdC8vIENvcHkgYWxsIHRoZSBvcHRpb25zIHRoYXQgd2lsbCBiZSBwYXNzZWQgdGhyb3VnaFxuXHR0aGlzLmFiY2pzUGFyYW1zID0ge307XG5cdHZhciBrZXk7XG5cdGlmIChwYXJhbXMuYWJjanNQYXJhbXMpIHtcblx0XHRmb3IgKGtleSBpbiBwYXJhbXMuYWJjanNQYXJhbXMpIHtcblx0XHRcdGlmIChwYXJhbXMuYWJjanNQYXJhbXMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHRcdFx0XHR0aGlzLmFiY2pzUGFyYW1zW2tleV0gPSBwYXJhbXMuYWJjanNQYXJhbXNba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0aWYgKHBhcmFtcy5taWRpX29wdGlvbnMpIHtcblx0XHRmb3IgKGtleSBpbiBwYXJhbXMubWlkaV9vcHRpb25zKSB7XG5cdFx0XHRpZiAocGFyYW1zLm1pZGlfb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdHRoaXMuYWJjanNQYXJhbXNba2V5XSA9IHBhcmFtcy5taWRpX29wdGlvbnNba2V5XTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0aWYgKHBhcmFtcy5wYXJzZXJfb3B0aW9ucykge1xuXHRcdGZvciAoa2V5IGluIHBhcmFtcy5wYXJzZXJfb3B0aW9ucykge1xuXHRcdFx0aWYgKHBhcmFtcy5wYXJzZXJfb3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdHRoaXMuYWJjanNQYXJhbXNba2V5XSA9IHBhcmFtcy5wYXJzZXJfb3B0aW9uc1trZXldO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRpZiAocGFyYW1zLnJlbmRlcl9vcHRpb25zKSB7XG5cdFx0Zm9yIChrZXkgaW4gcGFyYW1zLnJlbmRlcl9vcHRpb25zKSB7XG5cdFx0XHRpZiAocGFyYW1zLnJlbmRlcl9vcHRpb25zLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0XHRcdFx0dGhpcy5hYmNqc1BhcmFtc1trZXldID0gcGFyYW1zLnJlbmRlcl9vcHRpb25zW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0aWYgKHBhcmFtcy5pbmRpY2F0ZV9jaGFuZ2VkKVxuXHRcdHRoaXMuaW5kaWNhdGVfY2hhbmdlZCA9IHRydWU7XG4gIGlmICh0eXBlb2YgZWRpdGFyZWEgPT09IFwic3RyaW5nXCIpIHtcbiAgICB0aGlzLmVkaXRhcmVhID0gbmV3IEVkaXRBcmVhKGVkaXRhcmVhKTtcbiAgfSBlbHNlIHtcbiAgICB0aGlzLmVkaXRhcmVhID0gZWRpdGFyZWE7XG4gIH1cbiAgdGhpcy5lZGl0YXJlYS5hZGRTZWxlY3Rpb25MaXN0ZW5lcih0aGlzKTtcbiAgdGhpcy5lZGl0YXJlYS5hZGRDaGFuZ2VMaXN0ZW5lcih0aGlzKTtcblxuICBpZiAocGFyYW1zLmNhbnZhc19pZCkge1xuICAgIHRoaXMuZGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocGFyYW1zLmNhbnZhc19pZCk7XG4gIH0gZWxzZSBpZiAocGFyYW1zLnBhcGVyX2lkKSB7XG4gICAgdGhpcy5kaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYXJhbXMucGFwZXJfaWQpO1xuICB9IGVsc2Uge1xuICAgIHRoaXMuZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIkRJVlwiKTtcbiAgICB0aGlzLmVkaXRhcmVhLmdldEVsZW0oKS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSh0aGlzLmRpdiwgdGhpcy5lZGl0YXJlYS5nZXRFbGVtKCkpO1xuICB9XG5cblx0Ly8gSWYgdGhlIHVzZXIgd2FudHMgbWlkaSwgdGhlbiBzdG9yZSB0aGUgZWxlbWVudHMgdGhhdCBpdCB3aWxsIGJlIHdyaXR0ZW4gdG8uIFRoZSBlbGVtZW50IGNvdWxkIGVpdGhlciBiZSBwYXNzZWQgaW4gYXMgYW4gaWQsXG5cdC8vIGFuIGVsZW1lbnQsIG9yIG5vdGhpbmcuIElmIG5vdGhpbmcgaXMgcGFzc2VkIGluLCB0aGVuIGp1c3QgcHV0IHRoZSBtaWRpIG9uIHRvcCBvZiB0aGUgZ2VuZXJhdGVkIG11c2ljLlxuXHRpZiAocGFyYW1zLmdlbmVyYXRlX21pZGkpIHtcblx0ICBcdHRoaXMuZ2VuZXJhdGVfbWlkaSA9IHBhcmFtcy5nZW5lcmF0ZV9taWRpO1xuXHRcdGlmICh0aGlzLmFiY2pzUGFyYW1zLmdlbmVyYXRlRG93bmxvYWQpIHtcblx0XHRcdGlmICh0eXBlb2YgcGFyYW1zLm1pZGlfZG93bmxvYWRfaWQgPT09ICdzdHJpbmcnKVxuXHRcdFx0XHR0aGlzLmRvd25sb2FkTWlkaSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHBhcmFtcy5taWRpX2Rvd25sb2FkX2lkKTtcblx0XHRcdGVsc2UgaWYgKHBhcmFtcy5taWRpX2Rvd25sb2FkX2lkKSAvLyBhc3N1bWUsIGlmIHRoZSB2YXIgaXMgbm90IGEgc3RyaW5nIGl0IGlzIGFuIGVsZW1lbnQuIElmIG5vdCwgaXQgd2lsbCBjcmFzaCBzb29uIGVub3VnaC5cblx0XHRcdFx0dGhpcy5kb3dubG9hZE1pZGkgPSBwYXJhbXMubWlkaV9kb3dubG9hZF9pZDtcblx0XHR9XG5cdFx0aWYgKHRoaXMuYWJjanNQYXJhbXMuZ2VuZXJhdGVJbmxpbmUgIT09IGZhbHNlKSB7IC8vIFRoZSBkZWZhdWx0IGZvciB0aGlzIGlzIHRydWUsIHNvIHVuZGVmaW5lZCBpcyBhbHNvIHRydWUuXG5cdFx0XHRpZiAodHlwZW9mIHBhcmFtcy5taWRpX2lkID09PSAnc3RyaW5nJylcblx0XHRcdFx0dGhpcy5pbmxpbmVNaWRpID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQocGFyYW1zLm1pZGlfaWQpO1xuXHRcdFx0ZWxzZSBpZiAocGFyYW1zLm1pZGlfaWQpIC8vIGFzc3VtZSwgaWYgdGhlIHZhciBpcyBub3QgYSBzdHJpbmcgaXQgaXMgYW4gZWxlbWVudC4gSWYgbm90LCBpdCB3aWxsIGNyYXNoIHNvb24gZW5vdWdoLlxuXHRcdFx0XHR0aGlzLmlubGluZU1pZGkgPSBwYXJhbXMubWlkaV9pZDtcblx0XHR9XG5cdH1cblxuICBpZiAocGFyYW1zLmdlbmVyYXRlX3dhcm5pbmdzIHx8IHBhcmFtcy53YXJuaW5nc19pZCkge1xuICAgIGlmIChwYXJhbXMud2FybmluZ3NfaWQpIHtcbiAgICAgIHRoaXMud2FybmluZ3NkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChwYXJhbXMud2FybmluZ3NfaWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLndhcm5pbmdzZGl2ID0gdGhpcy5kaXY7XG4gICAgfVxuICB9XG4gIFxuICB0aGlzLm9uY2hhbmdlQ2FsbGJhY2sgPSBwYXJhbXMub25jaGFuZ2U7XG5cbiAgaWYgKHBhcmFtcy5ndWkpIHtcbiAgICB0aGlzLnRhcmdldCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGVkaXRhcmVhKTtcbiAgICB0aGlzLmFiY2pzUGFyYW1zLmVkaXRhYmxlID0gdHJ1ZTtcbiAgfSBcbiAgdGhpcy5vbGR0ID0gXCJcIjtcbiAgdGhpcy5iUmVlbnRyeSA9IGZhbHNlO1xuICB0aGlzLnBhcnNlQUJDKCk7XG4gIHRoaXMubW9kZWxDaGFuZ2VkKCk7XG5cbiAgdGhpcy5hZGRDbGFzc05hbWUgPSBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICB2YXIgaGFzQ2xhc3NOYW1lID0gZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgICB2YXIgZWxlbWVudENsYXNzTmFtZSA9IGVsZW1lbnQuY2xhc3NOYW1lO1xuICAgICAgcmV0dXJuIChlbGVtZW50Q2xhc3NOYW1lLmxlbmd0aCA+IDAgJiYgKGVsZW1lbnRDbGFzc05hbWUgPT09IGNsYXNzTmFtZSB8fFxuICAgICAgICBuZXcgUmVnRXhwKFwiKF58XFxcXHMpXCIgKyBjbGFzc05hbWUgKyBcIihcXFxcc3wkKVwiKS50ZXN0KGVsZW1lbnRDbGFzc05hbWUpKSk7XG4gICAgfTtcblxuICAgIGlmICghaGFzQ2xhc3NOYW1lKGVsZW1lbnQsIGNsYXNzTmFtZSkpXG4gICAgICBlbGVtZW50LmNsYXNzTmFtZSArPSAoZWxlbWVudC5jbGFzc05hbWUgPyAnICcgOiAnJykgKyBjbGFzc05hbWU7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH07XG5cbiAgdGhpcy5yZW1vdmVDbGFzc05hbWUgPSBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICBlbGVtZW50LmNsYXNzTmFtZSA9IHBhcnNlQ29tbW9uLnN0cmlwKGVsZW1lbnQuY2xhc3NOYW1lLnJlcGxhY2UoXG4gICAgICBuZXcgUmVnRXhwKFwiKF58XFxcXHMrKVwiICsgY2xhc3NOYW1lICsgXCIoXFxcXHMrfCQpXCIpLCAnICcpKTtcbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfTtcblxuICB0aGlzLnNldFJlYWRPbmx5ID0gZnVuY3Rpb24ocmVhZE9ubHkpIHtcblx0ICB2YXIgcmVhZG9ubHlDbGFzcyA9ICdhYmNfdGV4dGFyZWFfcmVhZG9ubHknO1xuXHQgIHZhciBlbCA9IHRoaXMuZWRpdGFyZWEuZ2V0RWxlbSgpO1xuICAgIGlmIChyZWFkT25seSkge1xuICAgICAgZWwuc2V0QXR0cmlidXRlKCdyZWFkb25seScsICd5ZXMnKTtcblx0ICB0aGlzLmFkZENsYXNzTmFtZShlbCwgcmVhZG9ubHlDbGFzcyk7XG5cdH0gZWxzZSB7XG4gICAgICBlbC5yZW1vdmVBdHRyaWJ1dGUoJ3JlYWRvbmx5Jyk7XG5cdCAgdGhpcy5yZW1vdmVDbGFzc05hbWUoZWwsIHJlYWRvbmx5Q2xhc3MpO1xuICAgIH1cbiAgfTtcbn07XG5cbkVkaXRvci5wcm90b3R5cGUucmVuZGVyVHVuZSA9IGZ1bmN0aW9uKGFiYywgcGFyYW1zLCBkaXYpIHtcbiAgdmFyIHR1bmVib29rID0gbmV3IFR1bmVCb29rKGFiYyk7XG4gIHZhciBhYmNQYXJzZXIgPSBQYXJzZSgpO1xuICBhYmNQYXJzZXIucGFyc2UodHVuZWJvb2sudHVuZXNbMF0uYWJjLCBwYXJhbXMpOyAvL1RPRE8gaGFuZGxlIG11bHRpcGxlIHR1bmVzXG4gIHZhciB0dW5lID0gYWJjUGFyc2VyLmdldFR1bmUoKTtcbiAgdmFyIGVuZ3JhdmVyX2NvbnRyb2xsZXIgPSBuZXcgRW5ncmF2ZXJDb250cm9sbGVyKGRpdiwgdGhpcy5hYmNqc1BhcmFtcyk7XG4gIGVuZ3JhdmVyX2NvbnRyb2xsZXIuZW5ncmF2ZUFCQyh0dW5lKTtcbn07XG5cbkVkaXRvci5wcm90b3R5cGUucmVkcmF3TWlkaSA9IGZ1bmN0aW9uKCkge1xuXHRpZiAodGhpcy5nZW5lcmF0ZV9taWRpICYmICF0aGlzLm1pZGlQYXVzZSkge1xuXHRcdHZhciBldmVudCA9IG5ldyB3aW5kb3cuQ3VzdG9tRXZlbnQoXCJnZW5lcmF0ZU1pZGlcIiwge1xuXHRcdFx0ZGV0YWlsOiB7XG5cdFx0XHRcdHR1bmVzOiB0aGlzLnR1bmVzLFxuXHRcdFx0XHRhYmNqc1BhcmFtczogdGhpcy5hYmNqc1BhcmFtcyxcblx0XHRcdFx0ZG93bmxvYWRNaWRpRWw6IHRoaXMuZG93bmxvYWRNaWRpLFxuXHRcdFx0XHRpbmxpbmVNaWRpRWw6IHRoaXMuaW5saW5lTWlkaSxcblx0XHRcdFx0ZW5ncmF2aW5nRWw6IHRoaXMuZGl2XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0d2luZG93LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xuXHR9XG59O1xuXG5FZGl0b3IucHJvdG90eXBlLm1vZGVsQ2hhbmdlZCA9IGZ1bmN0aW9uKCkge1xuICBpZiAodGhpcy50dW5lcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgaWYgKHRoaXMuZG93bmxvYWRNaWRpICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5kb3dubG9hZE1pZGkuaW5uZXJIVE1MID0gXCJcIjtcbiAgICBpZiAodGhpcy5pbmxpbmVNaWRpICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5pbmxpbmVNaWRpLmlubmVySFRNTCA9IFwiXCI7XG4gICAgdGhpcy5kaXYuaW5uZXJIVE1MID0gXCJcIjtcblx0cmV0dXJuO1xuICB9XG5cbiAgaWYgKHRoaXMuYlJlZW50cnkpXG4gICAgcmV0dXJuOyAvLyBUT0RPIGlzIHRoaXMgbGlrZWx5PyBtYXliZSwgaWYgd2UgcmV3cml0ZSBhYmMgaW1tZWRpYXRlbHkgdy8gYWJjMmFiY1xuICB0aGlzLmJSZWVudHJ5ID0gdHJ1ZTtcbiAgdGhpcy50aW1lcklkID0gbnVsbDtcbiAgdGhpcy5kaXYuaW5uZXJIVE1MID0gXCJcIjtcbiAgdGhpcy5lbmdyYXZlcl9jb250cm9sbGVyID0gbmV3IEVuZ3JhdmVyQ29udHJvbGxlcih0aGlzLmRpdiwgdGhpcy5hYmNqc1BhcmFtcyk7XG4gIHRoaXMuZW5ncmF2ZXJfY29udHJvbGxlci5lbmdyYXZlQUJDKHRoaXMudHVuZXMpO1xuXHR0aGlzLnR1bmVzWzBdLmVuZ3JhdmVyID0gdGhpcy5lbmdyYXZlcl9jb250cm9sbGVyO1x0Ly8gVE9ETy1QRVI6IFdlIGFjdHVhbGx5IHdhbnQgYW4gb3V0cHV0IG9iamVjdCBmb3IgZWFjaCB0dW5lLCBub3QgdGhlIGVudGlyZSBjb250cm9sbGVyLiBXaGVuIHJlZmFjdG9yaW5nLCBkb24ndCBzYXZlIGRhdGEgaW4gdGhlIGNvbnRyb2xsZXIuXG5cdHRoaXMucmVkcmF3TWlkaSgpO1xuXG4gIGlmICh0aGlzLndhcm5pbmdzZGl2KSB7XG4gICAgdGhpcy53YXJuaW5nc2Rpdi5pbm5lckhUTUwgPSAodGhpcy53YXJuaW5ncykgPyB0aGlzLndhcm5pbmdzLmpvaW4oXCI8YnIgLz5cIikgOiBcIk5vIGVycm9yc1wiO1xuICB9IFxuICBpZiAodGhpcy50YXJnZXQpIHtcbiAgICB2YXIgdGV4dHByaW50ZXIgPSBuZXcgVGV4dFByaW50ZXIodGhpcy50YXJnZXQsIHRydWUpO1xuICAgIHRleHRwcmludGVyLnByaW50QUJDKHRoaXMudHVuZXNbMF0pOyAvL1RPRE8gaGFuZGxlIG11bHRpcGxlIHR1bmVzXG4gIH1cbiAgdGhpcy5lbmdyYXZlcl9jb250cm9sbGVyLmFkZFNlbGVjdExpc3RlbmVyKHRoaXMuaGlnaGxpZ2h0LmJpbmQodGhpcykpO1xuICB0aGlzLnVwZGF0ZVNlbGVjdGlvbigpO1xuICB0aGlzLmJSZWVudHJ5ID0gZmFsc2U7XG59O1xuXG4vLyBDYWxsIHRoaXMgdG8gcmVwYXJzZSBpbiByZXNwb25zZSB0byB0aGUgcHJpbnRpbmcgcGFyYW1ldGVycyBjaGFuZ2luZ1xuRWRpdG9yLnByb3RvdHlwZS5wYXJhbUNoYW5nZWQgPSBmdW5jdGlvbihlbmdyYXZlclBhcmFtcykge1xuXHRpZiAoZW5ncmF2ZXJQYXJhbXMpIHtcblx0XHRmb3IgKHZhciBrZXkgaW4gZW5ncmF2ZXJQYXJhbXMpIHtcblx0XHRcdGlmIChlbmdyYXZlclBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRcdHRoaXMuYWJjanNQYXJhbXNba2V5XSA9IGVuZ3JhdmVyUGFyYW1zW2tleV07XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHRoaXMub2xkdCA9IFwiXCI7XG5cdHRoaXMuZmlyZUNoYW5nZWQoKTtcbn07XG5cbi8vIHJldHVybiB0cnVlIGlmIHRoZSBtb2RlbCBoYXMgY2hhbmdlZFxuRWRpdG9yLnByb3RvdHlwZS5wYXJzZUFCQyA9IGZ1bmN0aW9uKCkge1xuICB2YXIgdCA9IHRoaXMuZWRpdGFyZWEuZ2V0U3RyaW5nKCk7XG4gIGlmICh0PT09dGhpcy5vbGR0KSB7XG4gICAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgXG4gIHRoaXMub2xkdCA9IHQ7XG4gIGlmICh0ID09PSBcIlwiKSB7XG5cdHRoaXMudHVuZXMgPSB1bmRlZmluZWQ7XG5cdHRoaXMud2FybmluZ3MgPSBcIlwiO1xuXHRyZXR1cm4gdHJ1ZTtcbiAgfVxuICB2YXIgdHVuZWJvb2sgPSBuZXcgVHVuZUJvb2sodCk7XG4gIFxuICB0aGlzLnR1bmVzID0gW107XG4gIHRoaXMuc3RhcnRQb3MgPSBbXTtcbiAgdGhpcy53YXJuaW5ncyA9IFtdO1xuICBmb3IgKHZhciBpPTA7IGk8dHVuZWJvb2sudHVuZXMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgYWJjUGFyc2VyID0gbmV3IFBhcnNlKCk7XG4gICAgYWJjUGFyc2VyLnBhcnNlKHR1bmVib29rLnR1bmVzW2ldLmFiYywgdGhpcy5hYmNqc1BhcmFtcyk7XG4gICAgdGhpcy50dW5lc1tpXSA9IGFiY1BhcnNlci5nZXRUdW5lKCk7XG5cdCAgdGhpcy5zdGFydFBvc1tpXSA9IHR1bmVib29rLnR1bmVzW2ldLnN0YXJ0UG9zO1xuICAgIHZhciB3YXJuaW5ncyA9IGFiY1BhcnNlci5nZXRXYXJuaW5ncygpIHx8IFtdO1xuICAgIGZvciAodmFyIGo9MDsgajx3YXJuaW5ncy5sZW5ndGg7IGorKykge1xuICAgICAgdGhpcy53YXJuaW5ncy5wdXNoKHdhcm5pbmdzW2pdKTtcbiAgICB9XG4gIH1cbiAgcmV0dXJuIHRydWU7XG59O1xuXG5FZGl0b3IucHJvdG90eXBlLnVwZGF0ZVNlbGVjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICB2YXIgc2VsZWN0aW9uID0gdGhpcy5lZGl0YXJlYS5nZXRTZWxlY3Rpb24oKTtcbiAgdHJ5IHtcbiAgICB0aGlzLmVuZ3JhdmVyX2NvbnRyb2xsZXIucmFuZ2VIaWdobGlnaHQoc2VsZWN0aW9uLnN0YXJ0LCBzZWxlY3Rpb24uZW5kKTtcbiAgfSBjYXRjaCAoZSkge30gLy8gbWF5YmUgcHJpbnRlciBpc24ndCBkZWZpbmVkIHlldD9cbn07XG5cbkVkaXRvci5wcm90b3R5cGUuZmlyZVNlbGVjdGlvbkNoYW5nZWQgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy51cGRhdGVTZWxlY3Rpb24oKTtcbn07XG5cbkVkaXRvci5wcm90b3R5cGUuc2V0RGlydHlTdHlsZSA9IGZ1bmN0aW9uKGlzRGlydHkpIHtcblx0aWYgKHRoaXMuaW5kaWNhdGVfY2hhbmdlZCA9PT0gdW5kZWZpbmVkKVxuXHRcdHJldHVybjtcbiAgdmFyIGFkZENsYXNzTmFtZSA9IGZ1bmN0aW9uKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICAgIHZhciBoYXNDbGFzc05hbWUgPSBmdW5jdGlvbihlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgICAgIHZhciBlbGVtZW50Q2xhc3NOYW1lID0gZWxlbWVudC5jbGFzc05hbWU7XG4gICAgICByZXR1cm4gKGVsZW1lbnRDbGFzc05hbWUubGVuZ3RoID4gMCAmJiAoZWxlbWVudENsYXNzTmFtZSA9PT0gY2xhc3NOYW1lIHx8XG4gICAgICAgIG5ldyBSZWdFeHAoXCIoXnxcXFxccylcIiArIGNsYXNzTmFtZSArIFwiKFxcXFxzfCQpXCIpLnRlc3QoZWxlbWVudENsYXNzTmFtZSkpKTtcbiAgICB9O1xuXG4gICAgaWYgKCFoYXNDbGFzc05hbWUoZWxlbWVudCwgY2xhc3NOYW1lKSlcbiAgICAgIGVsZW1lbnQuY2xhc3NOYW1lICs9IChlbGVtZW50LmNsYXNzTmFtZSA/ICcgJyA6ICcnKSArIGNsYXNzTmFtZTtcbiAgICByZXR1cm4gZWxlbWVudDtcbiAgfTtcblxuICB2YXIgcmVtb3ZlQ2xhc3NOYW1lID0gZnVuY3Rpb24oZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gICAgZWxlbWVudC5jbGFzc05hbWUgPSBwYXJzZUNvbW1vbi5zdHJpcChlbGVtZW50LmNsYXNzTmFtZS5yZXBsYWNlKFxuICAgICAgbmV3IFJlZ0V4cChcIihefFxcXFxzKylcIiArIGNsYXNzTmFtZSArIFwiKFxcXFxzK3wkKVwiKSwgJyAnKSk7XG4gICAgcmV0dXJuIGVsZW1lbnQ7XG4gIH07XG4gIFxuXHR2YXIgcmVhZG9ubHlDbGFzcyA9ICdhYmNfdGV4dGFyZWFfZGlydHknO1xuXHR2YXIgZWwgPSB0aGlzLmVkaXRhcmVhLmdldEVsZW0oKTtcblx0aWYgKGlzRGlydHkpIHtcblx0XHRhZGRDbGFzc05hbWUoZWwsIHJlYWRvbmx5Q2xhc3MpO1xuXHR9IGVsc2Uge1xuXHRcdHJlbW92ZUNsYXNzTmFtZShlbCwgcmVhZG9ubHlDbGFzcyk7XG4gICAgfVxufTtcblxuLy8gY2FsbCB3aGVuIGFiYyB0ZXh0IGlzIGNoYW5nZWQgYW5kIG5lZWRzIHJlLXBhcnNpbmdcbkVkaXRvci5wcm90b3R5cGUuZmlyZUNoYW5nZWQgPSBmdW5jdGlvbigpIHtcbiAgaWYgKHRoaXMuYklzUGF1c2VkKVxuICAgIHJldHVybjtcbiAgaWYgKHRoaXMucGFyc2VBQkMoKSkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBpZiAodGhpcy50aW1lcklkKVx0Ly8gSWYgdGhlIHVzZXIgaXMgc3RpbGwgdHlwaW5nLCBjYW5jZWwgdGhlIHVwZGF0ZVxuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXJJZCk7XG4gICAgdGhpcy50aW1lcklkID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG4gICAgICBzZWxmLm1vZGVsQ2hhbmdlZCgpO1xuICAgIH0sIDMwMCk7XHQvLyBJcyB0aGlzIGEgZ29vZCBjb21wcm9taXNlIGJldHdlZW4gcmVzcG9uc2l2ZW5lc3MgYW5kIG5vdCByZWRyYXdpbmcgdG9vIG11Y2g/XG5cdCAgdmFyIGlzRGlydHkgPSB0aGlzLmlzRGlydHkoKTtcblx0ICBpZiAodGhpcy53YXNEaXJ0eSAhPT0gaXNEaXJ0eSkge1xuXHRcdCAgdGhpcy53YXNEaXJ0eSA9IGlzRGlydHk7XG5cdFx0ICB0aGlzLnNldERpcnR5U3R5bGUoaXNEaXJ0eSk7XG5cdCAgfVxuXHQgIGlmICh0aGlzLm9uY2hhbmdlQ2FsbGJhY2spXG5cdFx0ICB0aGlzLm9uY2hhbmdlQ2FsbGJhY2sodGhpcyk7XG5cdCAgfVxufTtcblxuRWRpdG9yLnByb3RvdHlwZS5zZXROb3REaXJ0eSA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLmVkaXRhcmVhLmluaXRpYWxUZXh0ID0gdGhpcy5lZGl0YXJlYS5nZXRTdHJpbmcoKTtcblx0dGhpcy53YXNEaXJ0eSA9IGZhbHNlO1xuXHR0aGlzLnNldERpcnR5U3R5bGUoZmFsc2UpO1xufTtcblxuRWRpdG9yLnByb3RvdHlwZS5pc0RpcnR5ID0gZnVuY3Rpb24oKSB7XG5cdGlmICh0aGlzLmluZGljYXRlX2NoYW5nZWQgPT09IHVuZGVmaW5lZClcblx0XHRyZXR1cm4gZmFsc2U7XG5cdHJldHVybiB0aGlzLmVkaXRhcmVhLmluaXRpYWxUZXh0ICE9PSB0aGlzLmVkaXRhcmVhLmdldFN0cmluZygpO1xufTtcblxuRWRpdG9yLnByb3RvdHlwZS5oaWdobGlnaHQgPSBmdW5jdGlvbihhYmNlbGVtLCB0dW5lTnVtYmVyLCBjbGFzc2VzKSB7XG5cdC8vIFRPRE8tUEVSOiBUaGUgbWFya2VyIGFwcGVhcnMgdG8gZ2V0IG9mZiBieSBvbmUgZm9yIGVhY2ggdHVuZSBwYXJzZWQuIEknbSBub3Qgc3VyZSB3aHksIGJ1dCBhZGRpbmcgdGhlIHR1bmVOdW1iZXIgaW4gY29ycmVjdHMgaXQgZm9yIHRoZSB0aW1lIGJlaW5nLlxuXHR2YXIgb2Zmc2V0ID0gKHR1bmVOdW1iZXIgIT09IHVuZGVmaW5lZCkgPyB0aGlzLnN0YXJ0UG9zW3R1bmVOdW1iZXJdICsgdHVuZU51bWJlciA6IDA7XG5cbiAgdGhpcy5lZGl0YXJlYS5zZXRTZWxlY3Rpb24ob2Zmc2V0ICsgYWJjZWxlbS5zdGFydENoYXIsIG9mZnNldCArIGFiY2VsZW0uZW5kQ2hhcik7XG59O1xuXG5FZGl0b3IucHJvdG90eXBlLnBhdXNlID0gZnVuY3Rpb24oc2hvdWxkUGF1c2UpIHtcblx0dGhpcy5iSXNQYXVzZWQgPSBzaG91bGRQYXVzZTtcblx0aWYgKCFzaG91bGRQYXVzZSlcblx0XHR0aGlzLmZpcmVDaGFuZ2VkKCk7XG59O1xuXG5FZGl0b3IucHJvdG90eXBlLnBhdXNlTWlkaSA9IGZ1bmN0aW9uKHNob3VsZFBhdXNlKSB7XG5cdHRoaXMubWlkaVBhdXNlID0gc2hvdWxkUGF1c2U7XG5cdGlmICghc2hvdWxkUGF1c2UpXG5cdFx0dGhpcy5yZWRyYXdNaWRpKCk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVkaXRvcjtcbiIsIi8vICAgIGFiY19wYXJzZS5qczogcGFyc2VzIGEgc3RyaW5nIHJlcHJlc2VudGluZyBBQkMgTXVzaWMgTm90YXRpb24gaW50byBhIHVzYWJsZSBpbnRlcm5hbCBzdHJ1Y3R1cmUuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBQYXVsIFJvc2VuIChwYXVsIGF0IHBhdWxyb3NlbiBkb3QgbmV0KVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgcGFyc2VDb21tb24gPSB7fTtcblxucGFyc2VDb21tb24uY2xvbmUgPSBmdW5jdGlvbihzb3VyY2UpIHtcblx0dmFyIGRlc3RpbmF0aW9uID0ge307XG5cdGZvciAodmFyIHByb3BlcnR5IGluIHNvdXJjZSlcblx0XHRpZiAoc291cmNlLmhhc093blByb3BlcnR5KHByb3BlcnR5KSlcblx0XHRcdGRlc3RpbmF0aW9uW3Byb3BlcnR5XSA9IHNvdXJjZVtwcm9wZXJ0eV07XG5cdHJldHVybiBkZXN0aW5hdGlvbjtcbn07XG5cbnBhcnNlQ29tbW9uLmNsb25lQXJyYXkgPSBmdW5jdGlvbihzb3VyY2UpIHtcblx0dmFyIGRlc3RpbmF0aW9uID0gW107XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgc291cmNlLmxlbmd0aDsgaSsrKSB7XG5cdFx0ZGVzdGluYXRpb24ucHVzaChwYXJzZUNvbW1vbi5jbG9uZShzb3VyY2VbaV0pKTtcblx0fVxuXHRyZXR1cm4gZGVzdGluYXRpb247XG59O1xuXG5wYXJzZUNvbW1vbi5jbG9uZUhhc2hPZkhhc2ggPSBmdW5jdGlvbihzb3VyY2UpIHtcblx0dmFyIGRlc3RpbmF0aW9uID0ge307XG5cdGZvciAodmFyIHByb3BlcnR5IGluIHNvdXJjZSlcblx0XHRpZiAoc291cmNlLmhhc093blByb3BlcnR5KHByb3BlcnR5KSlcblx0XHRcdGRlc3RpbmF0aW9uW3Byb3BlcnR5XSA9IHBhcnNlQ29tbW9uLmNsb25lKHNvdXJjZVtwcm9wZXJ0eV0pO1xuXHRyZXR1cm4gZGVzdGluYXRpb247XG59O1xuXG5wYXJzZUNvbW1vbi5jbG9uZUhhc2hPZkFycmF5T2ZIYXNoID0gZnVuY3Rpb24oc291cmNlKSB7XG5cdHZhciBkZXN0aW5hdGlvbiA9IHt9O1xuXHRmb3IgKHZhciBwcm9wZXJ0eSBpbiBzb3VyY2UpXG5cdFx0aWYgKHNvdXJjZS5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkpXG5cdFx0XHRkZXN0aW5hdGlvbltwcm9wZXJ0eV0gPSBwYXJzZUNvbW1vbi5jbG9uZUFycmF5KHNvdXJjZVtwcm9wZXJ0eV0pO1xuXHRyZXR1cm4gZGVzdGluYXRpb247XG59O1xuXG5wYXJzZUNvbW1vbi5nc3ViID0gZnVuY3Rpb24oc291cmNlLCBwYXR0ZXJuLCByZXBsYWNlbWVudCkge1xuXHRyZXR1cm4gc291cmNlLnNwbGl0KHBhdHRlcm4pLmpvaW4ocmVwbGFjZW1lbnQpO1xufTtcblxucGFyc2VDb21tb24uc3RyaXAgPSBmdW5jdGlvbihzdHIpIHtcblx0cmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKy8sICcnKS5yZXBsYWNlKC9cXHMrJC8sICcnKTtcbn07XG5cbnBhcnNlQ29tbW9uLnN0YXJ0c1dpdGggPSBmdW5jdGlvbihzdHIsIHBhdHRlcm4pIHtcblx0cmV0dXJuIHN0ci5pbmRleE9mKHBhdHRlcm4pID09PSAwO1xufTtcblxucGFyc2VDb21tb24uZW5kc1dpdGggPSBmdW5jdGlvbihzdHIsIHBhdHRlcm4pIHtcblx0dmFyIGQgPSBzdHIubGVuZ3RoIC0gcGF0dGVybi5sZW5ndGg7XG5cdHJldHVybiBkID49IDAgJiYgc3RyLmxhc3RJbmRleE9mKHBhdHRlcm4pID09PSBkO1xufTtcblxucGFyc2VDb21tb24uZWFjaCA9IGZ1bmN0aW9uKGFyciwgaXRlcmF0b3IsIGNvbnRleHQpIHtcblx0Zm9yICh2YXIgaSA9IDAsIGxlbmd0aCA9IGFyci5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKylcblx0ICBpdGVyYXRvci5hcHBseShjb250ZXh0LCBbYXJyW2ldLGldKTtcbn07XG5cbnBhcnNlQ29tbW9uLmxhc3QgPSBmdW5jdGlvbihhcnIpIHtcblx0aWYgKGFyci5sZW5ndGggPT09IDApXG5cdFx0cmV0dXJuIG51bGw7XG5cdHJldHVybiBhcnJbYXJyLmxlbmd0aC0xXTtcbn07XG5cbnBhcnNlQ29tbW9uLmNvbXBhY3QgPSBmdW5jdGlvbihhcnIpIHtcblx0dmFyIG91dHB1dCA9IFtdO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuXHRcdGlmIChhcnJbaV0pXG5cdFx0XHRvdXRwdXQucHVzaChhcnJbaV0pO1xuXHR9XG5cdHJldHVybiBvdXRwdXQ7XG59O1xuXG5wYXJzZUNvbW1vbi5kZXRlY3QgPSBmdW5jdGlvbihhcnIsIGl0ZXJhdG9yKSB7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKGl0ZXJhdG9yKGFycltpXSkpXG5cdFx0XHRyZXR1cm4gdHJ1ZTtcblx0fVxuXHRyZXR1cm4gZmFsc2U7XG59O1xuXG4vLyBUaGUgZm9sbG93aW5nIGlzIGEgcG9seWZpbGwgZm9yIE9iamVjdC5yZW1vdmUgZm9yIElFOSwgSUUxMCwgYW5kIElFMTEuXG4vLyBmcm9tOmh0dHBzOi8vZ2l0aHViLmNvbS9qc2Vyei9qc19waWVjZS9ibG9iL21hc3Rlci9ET00vQ2hpbGROb2RlL3JlbW92ZSgpL3JlbW92ZSgpLm1kXG4oZnVuY3Rpb24gKGFycikge1xuXHRhcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuXHRcdGlmIChpdGVtLmhhc093blByb3BlcnR5KCdyZW1vdmUnKSkge1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoaXRlbSwgJ3JlbW92ZScsIHtcblx0XHRcdGNvbmZpZ3VyYWJsZTogdHJ1ZSxcblx0XHRcdGVudW1lcmFibGU6IHRydWUsXG5cdFx0XHR3cml0YWJsZTogdHJ1ZSxcblx0XHRcdHZhbHVlOiBmdW5jdGlvbiByZW1vdmUoKSB7XG5cdFx0XHRcdGlmICh0aGlzLnBhcmVudE5vZGUgIT09IG51bGwpXG5cdFx0XHRcdFx0dGhpcy5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXHR9KTtcbn0pKFtFbGVtZW50LnByb3RvdHlwZSwgQ2hhcmFjdGVyRGF0YS5wcm90b3R5cGUsIERvY3VtZW50VHlwZS5wcm90b3R5cGVdKTtcblxubW9kdWxlLmV4cG9ydHMgPSBwYXJzZUNvbW1vbjtcbiIsIi8vICAgIGFiY19wYXJzZS5qczogcGFyc2VzIGEgc3RyaW5nIHJlcHJlc2VudGluZyBBQkMgTXVzaWMgTm90YXRpb24gaW50byBhIHVzYWJsZSBpbnRlcm5hbCBzdHJ1Y3R1cmUuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBQYXVsIFJvc2VuIChwYXVsIGF0IHBhdWxyb3NlbiBkb3QgbmV0KVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG4vKmdsb2JhbCB3aW5kb3cgKi9cblxudmFyIHBhcnNlQ29tbW9uID0gcmVxdWlyZSgnLi9hYmNfY29tbW9uJyk7XG52YXIgcGFyc2VEaXJlY3RpdmUgPSByZXF1aXJlKCcuL2FiY19wYXJzZV9kaXJlY3RpdmUnKTtcbnZhciBQYXJzZUhlYWRlciA9IHJlcXVpcmUoJy4vYWJjX3BhcnNlX2hlYWRlcicpO1xudmFyIHBhcnNlS2V5Vm9pY2UgPSByZXF1aXJlKCcuL2FiY19wYXJzZV9rZXlfdm9pY2UnKTtcbnZhciBUb2tlbml6ZXIgPSByZXF1aXJlKCcuL2FiY190b2tlbml6ZXInKTtcbnZhciB0cmFuc3Bvc2UgPSByZXF1aXJlKCcuL2FiY190cmFuc3Bvc2UnKTtcblxudmFyIFR1bmUgPSByZXF1aXJlKCcuLi9kYXRhL2FiY190dW5lJyk7XG5cbnZhciBQYXJzZSA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHR1bmUgPSBuZXcgVHVuZSgpO1xuXHR2YXIgdG9rZW5pemVyID0gbmV3IFRva2VuaXplcigpO1xuXG5cdHRoaXMuZ2V0VHVuZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHJldHVybiB0dW5lO1xuXHR9O1xuXG5cdGZ1bmN0aW9uIGFkZFBvc2l0aW9uaW5nKGVsLCB0eXBlLCB2YWx1ZSkge1xuXHRcdGlmICghZWwucG9zaXRpb25pbmcpIGVsLnBvc2l0aW9uaW5nID0ge307XG5cdFx0ZWwucG9zaXRpb25pbmdbdHlwZV0gPSB2YWx1ZTtcblx0fVxuXG5cdGZ1bmN0aW9uIGFkZEZvbnQoZWwsIHR5cGUsIHZhbHVlKSB7XG5cdFx0aWYgKCFlbC5mb250cykgZWwuZm9udHMgPSB7fTtcblx0XHRlbC5mb250c1t0eXBlXSA9IHZhbHVlO1xuXHR9XG5cblx0dmFyIG11bHRpbGluZVZhcnMgPSB7XG5cdFx0cmVzZXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0Zm9yICh2YXIgcHJvcGVydHkgaW4gdGhpcykge1xuXHRcdFx0XHRpZiAodGhpcy5oYXNPd25Qcm9wZXJ0eShwcm9wZXJ0eSkgJiYgdHlwZW9mIHRoaXNbcHJvcGVydHldICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0XHRcdFx0XHRkZWxldGUgdGhpc1twcm9wZXJ0eV07XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHRcdHRoaXMuaUNoYXIgPSAwO1xuXHRcdFx0dGhpcy5rZXkgPSB7YWNjaWRlbnRhbHM6IFtdLCByb290OiAnbm9uZScsIGFjYzogJycsIG1vZGU6ICcnIH07XG5cdFx0XHR0aGlzLm1ldGVyID0gbnVsbDsgLy8gaWYgbm8gbWV0ZXIgaXMgc3BlY2lmaWVkLCBmcmVlIG1ldGVyIGlzIGFzc3VtZWRcblx0XHRcdHRoaXMub3JpZ01ldGVyID0gbnVsbDtcdC8vIHRoaXMgaXMgZm9yIG5ldyB2b2ljZXMgdGhhdCBhcmUgY3JlYXRlZCBhZnRlciB3ZSBzZXQgdGhlIG1ldGVyLlxuXHRcdFx0dGhpcy5oYXNNYWluVGl0bGUgPSBmYWxzZTtcblx0XHRcdHRoaXMuZGVmYXVsdF9sZW5ndGggPSAwLjEyNTtcblx0XHRcdHRoaXMuY2xlZiA9IHsgdHlwZTogJ3RyZWJsZScsIHZlcnRpY2FsUG9zOiAwIH07XG5cdFx0XHR0aGlzLm5leHRfbm90ZV9kdXJhdGlvbiA9IDA7XG5cdFx0XHR0aGlzLnN0YXJ0X25ld19saW5lID0gdHJ1ZTtcblx0XHRcdHRoaXMuaXNfaW5faGVhZGVyID0gdHJ1ZTtcblx0XHRcdHRoaXMuaXNfaW5faGlzdG9yeSA9IGZhbHNlO1xuXHRcdFx0dGhpcy5wYXJ0Rm9yTmV4dExpbmUgPSBcIlwiO1xuXHRcdFx0dGhpcy5oYXZlbnRfc2V0X2xlbmd0aCA9IHRydWU7XG5cdFx0XHR0aGlzLnZvaWNlcyA9IHt9O1xuXHRcdFx0dGhpcy5zdGF2ZXMgPSBbXTtcblx0XHRcdHRoaXMubWFjcm9zID0ge307XG5cdFx0XHR0aGlzLmN1cnJCYXJOdW1iZXIgPSAxO1xuXHRcdFx0dGhpcy5iYXJDb3VudGVyID0ge307XG5cdFx0XHR0aGlzLmluVGV4dEJsb2NrID0gZmFsc2U7XG5cdFx0XHR0aGlzLmluUHNCbG9jayA9IGZhbHNlO1xuXHRcdFx0dGhpcy5pZ25vcmVkRGVjb3JhdGlvbnMgPSBbXTtcblx0XHRcdHRoaXMudGV4dEJsb2NrID0gXCJcIjtcblx0XHRcdHRoaXMuc2NvcmVfaXNfcHJlc2VudCA9IGZhbHNlO1x0Ly8gQ2FuJ3QgaGF2ZSBvcmlnaW5hbCBWOiBsaW5lcyB3aGVuIHRoZXJlIGlzIHRoZSBzY29yZSBkaXJlY3RpdmVcblx0XHRcdHRoaXMuaW5FbmRpbmcgPSBmYWxzZTtcblx0XHRcdHRoaXMuaW5UaWUgPSBmYWxzZTtcblx0XHRcdHRoaXMuaW5UaWVDaG9yZCA9IHt9O1xuXHRcdFx0dGhpcy52b2NhbFBvc2l0aW9uID0gXCJhdXRvXCI7XG5cdFx0XHR0aGlzLmR5bmFtaWNQb3NpdGlvbiA9IFwiYXV0b1wiO1xuXHRcdFx0dGhpcy5jaG9yZFBvc2l0aW9uID0gXCJhdXRvXCI7XG5cdFx0XHR0aGlzLm9ybmFtZW50UG9zaXRpb24gPSBcImF1dG9cIjtcblx0XHRcdHRoaXMudm9sdW1lUG9zaXRpb24gPSBcImF1dG9cIjtcblx0XHRcdHRoaXMub3BlblNsdXJzID0gW107XG5cdFx0fSxcblx0XHRkaWZmZXJlbnRGb250OiBmdW5jdGlvbih0eXBlLCBkZWZhdWx0Rm9udHMpIHtcblx0XHRcdGlmICh0aGlzW3R5cGVdLmRlY29yYXRpb24gIT09IGRlZmF1bHRGb250c1t0eXBlXS5kZWNvcmF0aW9uKSByZXR1cm4gdHJ1ZTtcblx0XHRcdGlmICh0aGlzW3R5cGVdLmZhY2UgIT09IGRlZmF1bHRGb250c1t0eXBlXS5mYWNlKSByZXR1cm4gdHJ1ZTtcblx0XHRcdGlmICh0aGlzW3R5cGVdLnNpemUgIT09IGRlZmF1bHRGb250c1t0eXBlXS5zaXplKSByZXR1cm4gdHJ1ZTtcblx0XHRcdGlmICh0aGlzW3R5cGVdLnN0eWxlICE9PSBkZWZhdWx0Rm9udHNbdHlwZV0uc3R5bGUpIHJldHVybiB0cnVlO1xuXHRcdFx0aWYgKHRoaXNbdHlwZV0ud2VpZ2h0ICE9PSBkZWZhdWx0Rm9udHNbdHlwZV0ud2VpZ2h0KSByZXR1cm4gdHJ1ZTtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9LFxuXHRcdGFkZEZvcm1hdHRpbmdPcHRpb25zOiBmdW5jdGlvbihlbCwgZGVmYXVsdEZvbnRzLCBlbFR5cGUpIHtcblx0XHRcdGlmIChlbFR5cGUgPT09ICdub3RlJykge1xuXHRcdFx0XHRpZiAodGhpcy52b2NhbFBvc2l0aW9uICE9PSAnYXV0bycpIGFkZFBvc2l0aW9uaW5nKGVsLCAndm9jYWxQb3NpdGlvbicsIHRoaXMudm9jYWxQb3NpdGlvbik7XG5cdFx0XHRcdGlmICh0aGlzLmR5bmFtaWNQb3NpdGlvbiAhPT0gJ2F1dG8nKSBhZGRQb3NpdGlvbmluZyhlbCwgJ2R5bmFtaWNQb3NpdGlvbicsIHRoaXMuZHluYW1pY1Bvc2l0aW9uKTtcblx0XHRcdFx0aWYgKHRoaXMuY2hvcmRQb3NpdGlvbiAhPT0gJ2F1dG8nKSBhZGRQb3NpdGlvbmluZyhlbCwgJ2Nob3JkUG9zaXRpb24nLCB0aGlzLmNob3JkUG9zaXRpb24pO1xuXHRcdFx0XHRpZiAodGhpcy5vcm5hbWVudFBvc2l0aW9uICE9PSAnYXV0bycpIGFkZFBvc2l0aW9uaW5nKGVsLCAnb3JuYW1lbnRQb3NpdGlvbicsIHRoaXMub3JuYW1lbnRQb3NpdGlvbik7XG5cdFx0XHRcdGlmICh0aGlzLnZvbHVtZVBvc2l0aW9uICE9PSAnYXV0bycpIGFkZFBvc2l0aW9uaW5nKGVsLCAndm9sdW1lUG9zaXRpb24nLCB0aGlzLnZvbHVtZVBvc2l0aW9uKTtcblx0XHRcdFx0aWYgKHRoaXMuZGlmZmVyZW50Rm9udChcImFubm90YXRpb25mb250XCIsIGRlZmF1bHRGb250cykpIGFkZEZvbnQoZWwsICdhbm5vdGF0aW9uZm9udCcsIHRoaXMuYW5ub3RhdGlvbmZvbnQpO1xuXHRcdFx0XHRpZiAodGhpcy5kaWZmZXJlbnRGb250KFwiZ2Nob3JkZm9udFwiLCBkZWZhdWx0Rm9udHMpKSBhZGRGb250KGVsLCAnZ2Nob3JkZm9udCcsIHRoaXMuZ2Nob3JkZm9udCk7XG5cdFx0XHRcdGlmICh0aGlzLmRpZmZlcmVudEZvbnQoXCJ2b2NhbGZvbnRcIiwgZGVmYXVsdEZvbnRzKSkgYWRkRm9udChlbCwgJ3ZvY2FsZm9udCcsIHRoaXMudm9jYWxmb250KTtcblx0XHRcdFx0aWYgKHRoaXMuZGlmZmVyZW50Rm9udChcInRyaXBsZXRmb250XCIsIGRlZmF1bHRGb250cykpIGFkZEZvbnQoZWwsICd0cmlwbGV0Zm9udCcsIHRoaXMudHJpcGxldGZvbnQpO1xuXHRcdFx0fSBlbHNlIGlmIChlbFR5cGUgPT09ICdiYXInKSB7XG5cdFx0XHRcdGlmICh0aGlzLmR5bmFtaWNQb3NpdGlvbiAhPT0gJ2F1dG8nKSBhZGRQb3NpdGlvbmluZyhlbCwgJ2R5bmFtaWNQb3NpdGlvbicsIHRoaXMuZHluYW1pY1Bvc2l0aW9uKTtcblx0XHRcdFx0aWYgKHRoaXMuY2hvcmRQb3NpdGlvbiAhPT0gJ2F1dG8nKSBhZGRQb3NpdGlvbmluZyhlbCwgJ2Nob3JkUG9zaXRpb24nLCB0aGlzLmNob3JkUG9zaXRpb24pO1xuXHRcdFx0XHRpZiAodGhpcy5vcm5hbWVudFBvc2l0aW9uICE9PSAnYXV0bycpIGFkZFBvc2l0aW9uaW5nKGVsLCAnb3JuYW1lbnRQb3NpdGlvbicsIHRoaXMub3JuYW1lbnRQb3NpdGlvbik7XG5cdFx0XHRcdGlmICh0aGlzLnZvbHVtZVBvc2l0aW9uICE9PSAnYXV0bycpIGFkZFBvc2l0aW9uaW5nKGVsLCAndm9sdW1lUG9zaXRpb24nLCB0aGlzLnZvbHVtZVBvc2l0aW9uKTtcblx0XHRcdFx0aWYgKHRoaXMuZGlmZmVyZW50Rm9udChcIm1lYXN1cmVmb250XCIsIGRlZmF1bHRGb250cykpIGFkZEZvbnQoZWwsICdtZWFzdXJlZm9udCcsIHRoaXMubWVhc3VyZWZvbnQpO1xuXHRcdFx0XHRpZiAodGhpcy5kaWZmZXJlbnRGb250KFwicmVwZWF0Zm9udFwiLCBkZWZhdWx0Rm9udHMpKSBhZGRGb250KGVsLCAncmVwZWF0Zm9udCcsIHRoaXMucmVwZWF0Zm9udCk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5cdHZhciBhZGRXYXJuaW5nID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0aWYgKCFtdWx0aWxpbmVWYXJzLndhcm5pbmdzKVxuXHRcdFx0bXVsdGlsaW5lVmFycy53YXJuaW5ncyA9IFtdO1xuXHRcdG11bHRpbGluZVZhcnMud2FybmluZ3MucHVzaChzdHIpO1xuXHR9O1xuXG5cdHZhciBhZGRXYXJuaW5nT2JqZWN0ID0gZnVuY3Rpb24od2FybmluZ09iamVjdCkge1xuXHRcdGlmICghbXVsdGlsaW5lVmFycy53YXJuaW5nT2JqZWN0cylcblx0XHRcdG11bHRpbGluZVZhcnMud2FybmluZ09iamVjdHMgPSBbXTtcblx0XHRtdWx0aWxpbmVWYXJzLndhcm5pbmdPYmplY3RzLnB1c2god2FybmluZ09iamVjdCk7XG5cdH07XG5cblx0dmFyIGVuY29kZSA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdHZhciByZXQgPSBwYXJzZUNvbW1vbi5nc3ViKHN0ciwgJ1xceDEyJywgJyAnKTtcblx0XHRyZXQgPSBwYXJzZUNvbW1vbi5nc3ViKHJldCwgJyYnLCAnJmFtcDsnKTtcblx0XHRyZXQgPSBwYXJzZUNvbW1vbi5nc3ViKHJldCwgJzwnLCAnJmx0OycpO1xuXHRcdHJldHVybiBwYXJzZUNvbW1vbi5nc3ViKHJldCwgJz4nLCAnJmd0OycpO1xuXHR9O1xuXG5cdHZhciB3YXJuID0gZnVuY3Rpb24oc3RyLCBsaW5lLCBjb2xfbnVtKSB7XG5cdFx0aWYgKCFsaW5lKSBsaW5lID0gXCIgXCI7XG5cdFx0dmFyIGJhZF9jaGFyID0gbGluZS5jaGFyQXQoY29sX251bSk7XG5cdFx0aWYgKGJhZF9jaGFyID09PSAnICcpXG5cdFx0XHRiYWRfY2hhciA9IFwiU1BBQ0VcIjtcblx0XHR2YXIgY2xlYW5fbGluZSA9IGVuY29kZShsaW5lLnN1YnN0cmluZygwLCBjb2xfbnVtKSkgK1xuXHRcdFx0JzxzcGFuIHN0eWxlPVwidGV4dC1kZWNvcmF0aW9uOnVuZGVybGluZTtmb250LXNpemU6MS4zZW07Zm9udC13ZWlnaHQ6Ym9sZDtcIj4nICsgYmFkX2NoYXIgKyAnPC9zcGFuPicgK1xuXHRcdFx0ZW5jb2RlKGxpbmUuc3Vic3RyaW5nKGNvbF9udW0rMSkpO1xuXHRcdGFkZFdhcm5pbmcoXCJNdXNpYyBMaW5lOlwiICsgdHVuZS5nZXROdW1MaW5lcygpICsgXCI6XCIgKyAoY29sX251bSsxKSArICc6ICcgKyBzdHIgKyBcIjogIFwiICsgY2xlYW5fbGluZSk7XG5cdFx0YWRkV2FybmluZ09iamVjdCh7bWVzc2FnZTpzdHIsIGxpbmU6bGluZSwgc3RhcnRDaGFyOiBtdWx0aWxpbmVWYXJzLmlDaGFyICsgY29sX251bSwgY29sdW1uOiBjb2xfbnVtfSk7XG5cdH07XG5cdHZhciBoZWFkZXIgPSBuZXcgUGFyc2VIZWFkZXIodG9rZW5pemVyLCB3YXJuLCBtdWx0aWxpbmVWYXJzLCB0dW5lKTtcblxuXHR0aGlzLmdldFdhcm5pbmdzID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIG11bHRpbGluZVZhcnMud2FybmluZ3M7XG5cdH07XG5cdHRoaXMuZ2V0V2FybmluZ09iamVjdHMgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gbXVsdGlsaW5lVmFycy53YXJuaW5nT2JqZWN0cztcblx0fTtcblxuXHR2YXIgbGV0dGVyX3RvX2Nob3JkID0gZnVuY3Rpb24obGluZSwgaSlcblx0e1xuXHRcdGlmIChsaW5lLmNoYXJBdChpKSA9PT0gJ1wiJylcblx0XHR7XG5cdFx0XHR2YXIgY2hvcmQgPSB0b2tlbml6ZXIuZ2V0QnJhY2tldHRlZFN1YnN0cmluZyhsaW5lLCBpLCA1KTtcblx0XHRcdGlmICghY2hvcmRbMl0pXG5cdFx0XHRcdHdhcm4oXCJNaXNzaW5nIHRoZSBjbG9zaW5nIHF1b3RlIHdoaWxlIHBhcnNpbmcgdGhlIGNob3JkIHN5bWJvbFwiLCBsaW5lICwgaSk7XG5cdFx0XHQvLyBJZiBpdCBzdGFydHMgd2l0aCBeLCB0aGVuIHRoZSBjaG9yZCBhcHBlYXJzIGFib3ZlLlxuXHRcdFx0Ly8gSWYgaXQgc3RhcnRzIHdpdGggXyB0aGVuIHRoZSBjaG9yZCBhcHBlYXJzIGJlbG93LlxuXHRcdFx0Ly8gKG5vdGUgdGhhdCB0aGUgMi4wIGRyYWZ0IHN0YW5kYXJkIGRlZmluZXMgdGhlbSBhcyBub3QgY2hvcmRzLCBidXQgYW5ub3RhdGlvbnMgYW5kIGFsc28gZGVmaW5lcyBALilcblx0XHRcdGlmIChjaG9yZFswXSA+IDAgJiYgY2hvcmRbMV0ubGVuZ3RoID4gMCAmJiBjaG9yZFsxXS5jaGFyQXQoMCkgPT09ICdeJykge1xuXHRcdFx0XHRjaG9yZFsxXSA9IGNob3JkWzFdLnN1YnN0cmluZygxKTtcblx0XHRcdFx0Y2hvcmRbMl0gPSAnYWJvdmUnO1xuXHRcdFx0fSBlbHNlIGlmIChjaG9yZFswXSA+IDAgJiYgY2hvcmRbMV0ubGVuZ3RoID4gMCAmJiBjaG9yZFsxXS5jaGFyQXQoMCkgPT09ICdfJykge1xuXHRcdFx0XHRjaG9yZFsxXSA9IGNob3JkWzFdLnN1YnN0cmluZygxKTtcblx0XHRcdFx0Y2hvcmRbMl0gPSAnYmVsb3cnO1xuXHRcdFx0fSBlbHNlIGlmIChjaG9yZFswXSA+IDAgJiYgY2hvcmRbMV0ubGVuZ3RoID4gMCAmJiBjaG9yZFsxXS5jaGFyQXQoMCkgPT09ICc8Jykge1xuXHRcdFx0XHRjaG9yZFsxXSA9IGNob3JkWzFdLnN1YnN0cmluZygxKTtcblx0XHRcdFx0Y2hvcmRbMl0gPSAnbGVmdCc7XG5cdFx0XHR9IGVsc2UgaWYgKGNob3JkWzBdID4gMCAmJiBjaG9yZFsxXS5sZW5ndGggPiAwICYmIGNob3JkWzFdLmNoYXJBdCgwKSA9PT0gJz4nKSB7XG5cdFx0XHRcdGNob3JkWzFdID0gY2hvcmRbMV0uc3Vic3RyaW5nKDEpO1xuXHRcdFx0XHRjaG9yZFsyXSA9ICdyaWdodCc7XG5cdFx0XHR9IGVsc2UgaWYgKGNob3JkWzBdID4gMCAmJiBjaG9yZFsxXS5sZW5ndGggPiAwICYmIGNob3JkWzFdLmNoYXJBdCgwKSA9PT0gJ0AnKSB7XG5cdFx0XHRcdC8vIEAtMTUsNS43XG5cdFx0XHRcdGNob3JkWzFdID0gY2hvcmRbMV0uc3Vic3RyaW5nKDEpO1xuXHRcdFx0XHR2YXIgeCA9IHRva2VuaXplci5nZXRGbG9hdChjaG9yZFsxXSk7XG5cdFx0XHRcdGlmICh4LmRpZ2l0cyA9PT0gMClcblx0XHRcdFx0XHR3YXJuKFwiTWlzc2luZyBmaXJzdCBwb3NpdGlvbiBpbiBhYnNvbHV0ZWx5IHBvc2l0aW9uZWQgYW5ub3RhdGlvbi5cIiwgbGluZSAsIGkpO1xuXHRcdFx0XHRjaG9yZFsxXSA9IGNob3JkWzFdLnN1YnN0cmluZyh4LmRpZ2l0cyk7XG5cdFx0XHRcdGlmIChjaG9yZFsxXVswXSAhPT0gJywnKVxuXHRcdFx0XHRcdHdhcm4oXCJNaXNzaW5nIGNvbW1hIGFic29sdXRlbHkgcG9zaXRpb25lZCBhbm5vdGF0aW9uLlwiLCBsaW5lICwgaSk7XG5cdFx0XHRcdGNob3JkWzFdID0gY2hvcmRbMV0uc3Vic3RyaW5nKDEpO1xuXHRcdFx0XHR2YXIgeSA9IHRva2VuaXplci5nZXRGbG9hdChjaG9yZFsxXSk7XG5cdFx0XHRcdGlmICh5LmRpZ2l0cyA9PT0gMClcblx0XHRcdFx0XHR3YXJuKFwiTWlzc2luZyBzZWNvbmQgcG9zaXRpb24gaW4gYWJzb2x1dGVseSBwb3NpdGlvbmVkIGFubm90YXRpb24uXCIsIGxpbmUgLCBpKTtcblx0XHRcdFx0Y2hvcmRbMV0gPSBjaG9yZFsxXS5zdWJzdHJpbmcoeS5kaWdpdHMpO1xuXHRcdFx0XHR2YXIgd3MgPSB0b2tlbml6ZXIuc2tpcFdoaXRlU3BhY2UoY2hvcmRbMV0pO1xuXHRcdFx0XHRjaG9yZFsxXSA9IGNob3JkWzFdLnN1YnN0cmluZyh3cyk7XG5cdFx0XHRcdGNob3JkWzJdID0gbnVsbDtcblx0XHRcdFx0Y2hvcmRbM10gPSB7IHg6IHgudmFsdWUsIHk6IHkudmFsdWUgfTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGNob3JkWzFdID0gY2hvcmRbMV0ucmVwbGFjZSgvKFtBQkNERUZHMC05XSliL2csIFwiJDHima1cIik7XG5cdFx0XHRcdGNob3JkWzFdID0gY2hvcmRbMV0ucmVwbGFjZSgvKFtBQkNERUZHMC05XSkjL2csIFwiJDHima9cIik7XG5cdFx0XHRcdGNob3JkWzJdID0gJ2RlZmF1bHQnO1xuXHRcdFx0XHRjaG9yZFsxXSA9IHRyYW5zcG9zZS5jaG9yZE5hbWUobXVsdGlsaW5lVmFycywgY2hvcmRbMV0pO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGNob3JkO1xuXHRcdH1cblx0XHRyZXR1cm4gWzAsIFwiXCJdO1xuXHR9O1xuXG5cdHZhciBsZWdhbEFjY2VudHMgPSBbIFwidHJpbGxcIiwgXCJsb3dlcm1vcmRlbnRcIiwgXCJ1cHBlcm1vcmRlbnRcIiwgXCJtb3JkZW50XCIsIFwicHJhbGx0cmlsbGVyXCIsIFwiYWNjZW50XCIsXG5cdFx0XCJmZXJtYXRhXCIsIFwiaW52ZXJ0ZWRmZXJtYXRhXCIsIFwidGVudXRvXCIsIFwiMFwiLCBcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiK1wiLCBcIndlZGdlXCIsXG5cdFx0XCJvcGVuXCIsIFwidGh1bWJcIiwgXCJzbmFwXCIsIFwidHVyblwiLCBcInJvbGxcIiwgXCJicmVhdGhcIiwgXCJzaG9ydHBocmFzZVwiLCBcIm1lZGl1bXBocmFzZVwiLCBcImxvbmdwaHJhc2VcIixcblx0XHRcInNlZ25vXCIsIFwiY29kYVwiLCBcIkQuUy5cIiwgXCJELkMuXCIsIFwiZmluZVwiLFxuXHRcdFwic2xpZGVcIiwgXCJeXCIsIFwibWFyY2F0b1wiLFxuXHRcdFwidXBib3dcIiwgXCJkb3duYm93XCIsIFwiL1wiLCBcIi8vXCIsIFwiLy8vXCIsIFwiLy8vL1wiLCBcInRyZW0xXCIsIFwidHJlbTJcIiwgXCJ0cmVtM1wiLCBcInRyZW00XCIsXG5cdFx0XCJ0dXJueFwiLCBcImludmVydGVkdHVyblwiLCBcImludmVydGVkdHVybnhcIiwgXCJ0cmlsbChcIiwgXCJ0cmlsbClcIiwgXCJhcnBlZ2dpb1wiLCBcInhzdGVtXCIsIFwibWFya1wiLCBcInVtYXJjYXRvXCIsXG5cdFx0XCJzdHlsZT1ub3JtYWxcIiwgXCJzdHlsZT1oYXJtb25pY1wiLCBcInN0eWxlPXJoeXRobVwiLCBcInN0eWxlPXhcIlxuXHRdO1xuXHR2YXIgdm9sdW1lRGVjb3JhdGlvbnMgPSBbIFwicFwiLCBcInBwXCIsIFwiZlwiLCBcImZmXCIsIFwibWZcIiwgXCJtcFwiLCBcInBwcFwiLCBcInBwcHBcIiwgIFwiZmZmXCIsIFwiZmZmZlwiLCBcInNmelwiIF07XG5cdHZhciBkeW5hbWljRGVjb3JhdGlvbnMgPSBbXCJjcmVzY2VuZG8oXCIsIFwiY3Jlc2NlbmRvKVwiLCBcImRpbWludWVuZG8oXCIsIFwiZGltaW51ZW5kbylcIl07XG5cblx0dmFyIGFjY2VudFBzZXVkb255bXMgPSBbIFtcIjxcIiwgXCJhY2NlbnRcIl0sIFtcIj5cIiwgXCJhY2NlbnRcIl0sIFtcInRyXCIsIFwidHJpbGxcIl0sXG5cdFx0W1wicGx1c1wiLCBcIitcIl0sIFsgXCJlbXBoYXNpc1wiLCBcImFjY2VudFwiXSxcblx0XHRbIFwiXlwiLCBcInVtYXJjYXRvXCIgXSwgWyBcIm1hcmNhdG9cIiwgXCJ1bWFyY2F0b1wiIF0gXTtcblx0dmFyIGFjY2VudER5bmFtaWNQc2V1ZG9ueW1zID0gWyBbXCI8KFwiLCBcImNyZXNjZW5kbyhcIl0sIFtcIjwpXCIsIFwiY3Jlc2NlbmRvKVwiXSxcblx0XHRbXCI+KFwiLCBcImRpbWludWVuZG8oXCJdLCBbXCI+KVwiLCBcImRpbWludWVuZG8pXCJdIF07XG5cdHZhciBsZXR0ZXJfdG9fYWNjZW50ID0gZnVuY3Rpb24obGluZSwgaSlcblx0e1xuXHRcdHZhciBtYWNybyA9IG11bHRpbGluZVZhcnMubWFjcm9zW2xpbmUuY2hhckF0KGkpXTtcblxuXHRcdGlmIChtYWNybyAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRpZiAobWFjcm8uY2hhckF0KDApID09PSAnIScgfHwgbWFjcm8uY2hhckF0KDApID09PSAnKycpXG5cdFx0XHRcdG1hY3JvID0gbWFjcm8uc3Vic3RyaW5nKDEpO1xuXHRcdFx0aWYgKG1hY3JvLmNoYXJBdChtYWNyby5sZW5ndGgtMSkgPT09ICchJyB8fCBtYWNyby5jaGFyQXQobWFjcm8ubGVuZ3RoLTEpID09PSAnKycpXG5cdFx0XHRcdG1hY3JvID0gbWFjcm8uc3Vic3RyaW5nKDAsIG1hY3JvLmxlbmd0aC0xKTtcblx0XHRcdGlmIChwYXJzZUNvbW1vbi5kZXRlY3QobGVnYWxBY2NlbnRzLCBmdW5jdGlvbihhY2MpIHtcblx0XHRcdFx0XHRyZXR1cm4gKG1hY3JvID09PSBhY2MpO1xuXHRcdFx0XHR9KSlcblx0XHRcdFx0cmV0dXJuIFsgMSwgbWFjcm8gXTtcblx0XHRcdGVsc2UgaWYgKHBhcnNlQ29tbW9uLmRldGVjdCh2b2x1bWVEZWNvcmF0aW9ucywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHRcdFx0cmV0dXJuIChtYWNybyA9PT0gYWNjKTtcblx0XHRcdFx0fSkpIHtcblx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMudm9sdW1lUG9zaXRpb24gPT09ICdoaWRkZW4nKVxuXHRcdFx0XHRcdG1hY3JvID0gXCJcIjtcblx0XHRcdFx0cmV0dXJuIFsxLCBtYWNyb107XG5cdFx0XHR9IGVsc2UgaWYgKHBhcnNlQ29tbW9uLmRldGVjdChkeW5hbWljRGVjb3JhdGlvbnMsIGZ1bmN0aW9uKGFjYykge1xuXHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmR5bmFtaWNQb3NpdGlvbiA9PT0gJ2hpZGRlbicpXG5cdFx0XHRcdFx0XHRtYWNybyA9IFwiXCI7XG5cdFx0XHRcdFx0cmV0dXJuIChtYWNybyA9PT0gYWNjKTtcblx0XHRcdFx0fSkpIHtcblx0XHRcdFx0cmV0dXJuIFsxLCBtYWNyb107XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIXBhcnNlQ29tbW9uLmRldGVjdChtdWx0aWxpbmVWYXJzLmlnbm9yZWREZWNvcmF0aW9ucywgZnVuY3Rpb24oZGVjKSB7XG5cdFx0XHRcdFx0cmV0dXJuIChtYWNybyA9PT0gZGVjKTtcblx0XHRcdFx0fSkpXG5cdFx0XHRcdFx0d2FybihcIlVua25vd24gbWFjcm86IFwiICsgbWFjcm8sIGxpbmUsIGkpO1xuXHRcdFx0XHRyZXR1cm4gWzEsICcnIF07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHN3aXRjaCAobGluZS5jaGFyQXQoaSkpXG5cdFx0e1xuXHRcdFx0Y2FzZSAnLic6cmV0dXJuIFsxLCAnc3RhY2NhdG8nXTtcblx0XHRcdGNhc2UgJ3UnOnJldHVybiBbMSwgJ3VwYm93J107XG5cdFx0XHRjYXNlICd2JzpyZXR1cm4gWzEsICdkb3duYm93J107XG5cdFx0XHRjYXNlICd+JzpyZXR1cm4gWzEsICdpcmlzaHJvbGwnXTtcblx0XHRcdGNhc2UgJyEnOlxuXHRcdFx0Y2FzZSAnKyc6XG5cdFx0XHRcdHZhciByZXQgPSB0b2tlbml6ZXIuZ2V0QnJhY2tldHRlZFN1YnN0cmluZyhsaW5lLCBpLCA1KTtcblx0XHRcdFx0Ly8gQmUgc3VyZSB0aGF0IHRoZSBhY2NlbnQgaXMgcmVjb2duaXphYmxlLlxuXHRcdFx0aWYgKHJldFsxXS5sZW5ndGggPiAwICYmIChyZXRbMV0uY2hhckF0KDApID09PSAnXicgfHwgcmV0WzFdLmNoYXJBdCgwKSA9PT0nXycpKVxuXHRcdFx0XHRcdHJldFsxXSA9IHJldFsxXS5zdWJzdHJpbmcoMSk7XHQvLyBUT0RPLVBFUjogVGhlIHRlc3QgZmlsZXMgaGF2ZSBpbmRpY2F0b3JzIGZvcmNpbmcgdGhlIG9ybmFtZW50IHRvIHRoZSB0b3Agb3IgYm90dG9tLCBidXQgdGhhdCBpc24ndCBpbiB0aGUgc3RhbmRhcmQuIFdlJ2xsIGp1c3QgaWdub3JlIHRoZW0uXG5cdFx0XHRcdGlmIChwYXJzZUNvbW1vbi5kZXRlY3QobGVnYWxBY2NlbnRzLCBmdW5jdGlvbihhY2MpIHtcblx0XHRcdFx0XHRyZXR1cm4gKHJldFsxXSA9PT0gYWNjKTtcblx0XHRcdFx0fSkpXG5cdFx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdFx0aWYgKHBhcnNlQ29tbW9uLmRldGVjdCh2b2x1bWVEZWNvcmF0aW9ucywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHRcdFx0XHRyZXR1cm4gKHJldFsxXSA9PT0gYWNjKTtcblx0XHRcdFx0XHR9KSkge1xuXHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLnZvbHVtZVBvc2l0aW9uID09PSAnaGlkZGVuJyApXG5cdFx0XHRcdFx0XHRyZXRbMV0gPSAnJztcblx0XHRcdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHBhcnNlQ29tbW9uLmRldGVjdChkeW5hbWljRGVjb3JhdGlvbnMsIGZ1bmN0aW9uKGFjYykge1xuXHRcdFx0XHRcdFx0cmV0dXJuIChyZXRbMV0gPT09IGFjYyk7XG5cdFx0XHRcdFx0fSkpIHtcblx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5keW5hbWljUG9zaXRpb24gPT09ICdoaWRkZW4nIClcblx0XHRcdFx0XHRcdHJldFsxXSA9ICcnO1xuXHRcdFx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChwYXJzZUNvbW1vbi5kZXRlY3QoYWNjZW50UHNldWRvbnltcywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHRcdFx0aWYgKHJldFsxXSA9PT0gYWNjWzBdKSB7XG5cdFx0XHRcdFx0XHRyZXRbMV0gPSBhY2NbMV07XG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0XHRcdHJldHVybiBmYWxzZTtcblx0XHRcdFx0fSkpXG5cdFx0XHRcdFx0cmV0dXJuIHJldDtcblxuXHRcdFx0XHRpZiAocGFyc2VDb21tb24uZGV0ZWN0KGFjY2VudER5bmFtaWNQc2V1ZG9ueW1zLCBmdW5jdGlvbihhY2MpIHtcblx0XHRcdFx0XHRpZiAocmV0WzFdID09PSBhY2NbMF0pIHtcblx0XHRcdFx0XHRcdHJldFsxXSA9IGFjY1sxXTtcblx0XHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHRcdH0gZWxzZVxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdFx0XHR9KSkge1xuXHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmR5bmFtaWNQb3NpdGlvbiA9PT0gJ2hpZGRlbicgKVxuXHRcdFx0XHRcdFx0cmV0WzFdID0gJyc7XG5cdFx0XHRcdFx0XHRyZXR1cm4gcmV0O1xuXHRcdFx0XHR9XG5cdFx0XHRcdC8vIFdlIGRpZG4ndCBmaW5kIHRoZSBhY2NlbnQgaW4gdGhlIGxpc3QsIHNvIGNvbnN1bWUgdGhlIHNwYWNlLCBidXQgZG9uJ3QgcmV0dXJuIGFuIGFjY2VudC5cblx0XHRcdFx0Ly8gQWx0aG91Z2ggaXQgaXMgcG9zc2libGUgdGhhdCAhIHdhcyB1c2VkIGFzIGEgbGluZSBicmVhaywgc28gYWNjZXB0IHRoYXQuXG5cdFx0XHRpZiAobGluZS5jaGFyQXQoaSkgPT09ICchJyAmJiAocmV0WzBdID09PSAxIHx8IGxpbmUuY2hhckF0KGkrcmV0WzBdLTEpICE9PSAnIScpKVxuXHRcdFx0XHRcdHJldHVybiBbMSwgbnVsbCBdO1xuXHRcdFx0XHR3YXJuKFwiVW5rbm93biBkZWNvcmF0aW9uOiBcIiArIHJldFsxXSwgbGluZSwgaSk7XG5cdFx0XHRcdHJldFsxXSA9IFwiXCI7XG5cdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHRjYXNlICdIJzpyZXR1cm4gWzEsICdmZXJtYXRhJ107XG5cdFx0XHRjYXNlICdKJzpyZXR1cm4gWzEsICdzbGlkZSddO1xuXHRcdFx0Y2FzZSAnTCc6cmV0dXJuIFsxLCAnYWNjZW50J107XG5cdFx0XHRjYXNlICdNJzpyZXR1cm4gWzEsICdtb3JkZW50J107XG5cdFx0XHRjYXNlICdPJzpyZXR1cm5bMSwgJ2NvZGEnXTtcblx0XHRcdGNhc2UgJ1AnOnJldHVyblsxLCAncHJhbGx0cmlsbGVyJ107XG5cdFx0XHRjYXNlICdSJzpyZXR1cm4gWzEsICdyb2xsJ107XG5cdFx0XHRjYXNlICdTJzpyZXR1cm4gWzEsICdzZWdubyddO1xuXHRcdFx0Y2FzZSAnVCc6cmV0dXJuIFsxLCAndHJpbGwnXTtcblx0XHR9XG5cdFx0cmV0dXJuIFswLCAwXTtcblx0fTtcblxuXHR2YXIgbGV0dGVyX3RvX3NwYWNlciA9IGZ1bmN0aW9uKGxpbmUsIGkpXG5cdHtcblx0XHR2YXIgc3RhcnQgPSBpO1xuXHRcdHdoaWxlICh0b2tlbml6ZXIuaXNXaGl0ZVNwYWNlKGxpbmUuY2hhckF0KGkpKSlcblx0XHRcdGkrKztcblx0XHRyZXR1cm4gWyBpLXN0YXJ0IF07XG5cdH07XG5cblx0Ly8gcmV0dXJucyB0aGUgY2xhc3Mgb2YgdGhlIGJhciBsaW5lXG5cdC8vIHRoZSBudW1iZXIgb2YgdGhlIHJlcGVhdFxuXHQvLyBhbmQgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIHVzZWQgdXBcblx0Ly8gaWYgMCBpcyByZXR1cm5lZCwgdGhlbiB0aGUgbmV4dCBlbGVtZW50IHdhcyBub3QgYSBiYXIgbGluZVxuXHR2YXIgbGV0dGVyX3RvX2JhciA9IGZ1bmN0aW9uKGxpbmUsIGN1cnJfcG9zKVxuXHR7XG5cdFx0dmFyIHJldCA9IHRva2VuaXplci5nZXRCYXJMaW5lKGxpbmUsIGN1cnJfcG9zKTtcblx0XHRpZiAocmV0LmxlbiA9PT0gMClcblx0XHRcdHJldHVybiBbMCxcIlwiXTtcblx0XHRpZiAocmV0Lndhcm4pIHtcblx0XHRcdHdhcm4ocmV0Lndhcm4sIGxpbmUsIGN1cnJfcG9zKTtcblx0XHRcdHJldHVybiBbcmV0LmxlbixcIlwiXTtcblx0XHR9XG5cblx0XHQvLyBOb3cgc2VlIGlmIHRoaXMgaXMgYSByZXBlYXRlZCBlbmRpbmdcblx0XHQvLyBBIHJlcGVhdGVkIGVuZGluZyBpcyBhbGwgb2YgdGhlIGNoYXJhY3RlcnMgMSwyLDMsNCw1LDYsNyw4LDksMCwtLCBhbmQgY29tbWFcblx0XHQvLyBJdCBjYW4gYWxzbyBvcHRpb25hbGx5IHN0YXJ0IHdpdGggJ1snLCB3aGljaCBpcyBpZ25vcmVkLlxuXHRcdC8vIEFsc28sIGl0IGNhbiBoYXZlIHdoaXRlIHNwYWNlIGJlZm9yZSB0aGUgJ1snLlxuXHRcdGZvciAodmFyIHdzID0gMDsgd3MgPCBsaW5lLmxlbmd0aDsgd3MrKylcblx0XHRcdGlmIChsaW5lLmNoYXJBdChjdXJyX3BvcyArIHJldC5sZW4gKyB3cykgIT09ICcgJylcblx0XHRcdFx0YnJlYWs7XG5cdFx0dmFyIG9yaWdfYmFyX2xlbiA9IHJldC5sZW47XG5cdFx0aWYgKGxpbmUuY2hhckF0KGN1cnJfcG9zK3JldC5sZW4rd3MpID09PSAnWycpIHtcblx0XHRcdHJldC5sZW4gKz0gd3MgKyAxO1xuXHRcdH1cblxuXHRcdC8vIEl0IGNhbiBhbHNvIGJlIGEgcXVvdGVkIHN0cmluZy4gSXQgaXMgdW5jbGVhciB3aGV0aGVyIHRoYXQgY29uc3RydWN0IHJlcXVpcmVzICdbJywgYnV0IGl0IHNlZW1zIGxpa2UgaXQgd291bGQuIG90aGVyd2lzZSBpdCB3b3VsZCBiZSBjb25mdXNlZCB3aXRoIGEgcmVndWxhciBjaG9yZC5cblx0XHRpZiAobGluZS5jaGFyQXQoY3Vycl9wb3MrcmV0LmxlbikgPT09ICdcIicgJiYgbGluZS5jaGFyQXQoY3Vycl9wb3MrcmV0Lmxlbi0xKSA9PT0gJ1snKSB7XG5cdFx0XHR2YXIgZW5kaW5nID0gdG9rZW5pemVyLmdldEJyYWNrZXR0ZWRTdWJzdHJpbmcobGluZSwgY3Vycl9wb3MrcmV0LmxlbiwgNSk7XG5cdFx0XHRyZXR1cm4gW3JldC5sZW4rZW5kaW5nWzBdLCByZXQudG9rZW4sIGVuZGluZ1sxXV07XG5cdFx0fVxuXHRcdHZhciByZXRSZXAgPSB0b2tlbml6ZXIuZ2V0VG9rZW5PZihsaW5lLnN1YnN0cmluZyhjdXJyX3BvcytyZXQubGVuKSwgXCIxMjM0NTY3ODkwLSxcIik7XG5cdFx0aWYgKHJldFJlcC5sZW4gPT09IDAgfHwgcmV0UmVwLnRva2VuWzBdID09PSAnLScpXG5cdFx0XHRyZXR1cm4gW29yaWdfYmFyX2xlbiwgcmV0LnRva2VuXTtcblxuXHRcdHJldHVybiBbcmV0LmxlbityZXRSZXAubGVuLCByZXQudG9rZW4sIHJldFJlcC50b2tlbl07XG5cdH07XG5cblx0dmFyIHRyaXBsZXRRID0ge1xuXHRcdDI6IDMsXG5cdFx0MzogMixcblx0XHQ0OiAzLFxuXHRcdDU6IDIsIC8vIFRPRE8tUEVSOiBub3QgaGFuZGxpbmcgNi84IHJoeXRobSB5ZXRcblx0XHQ2OiAyLFxuXHRcdDc6IDIsIC8vIFRPRE8tUEVSOiBub3QgaGFuZGxpbmcgNi84IHJoeXRobSB5ZXRcblx0XHQ4OiAzLFxuXHRcdDk6IDIgLy8gVE9ETy1QRVI6IG5vdCBoYW5kbGluZyA2Lzggcmh5dGhtIHlldFxuXHR9O1xuXHR2YXIgbGV0dGVyX3RvX29wZW5fc2x1cnNfYW5kX3RyaXBsZXRzID0gIGZ1bmN0aW9uKGxpbmUsIGkpIHtcblx0XHQvLyBjb25zdW1lIHNwYWNlcywgYW5kIGxvb2sgZm9yIGFsbCB0aGUgb3BlbiBwYXJlbnMuIElmIHRoZXJlIGlzIGEgbnVtYmVyIGFmdGVyIHRoZSBvcGVuIHBhcmVuLFxuXHRcdC8vIHRoYXQgaXMgYSB0cmlwbGV0LiBPdGhlcndpc2UgdGhhdCBpcyBhIHNsdXIuIENvbGxlY3QgYWxsIHRoZSBzbHVycyBhbmQgdGhlIGZpcnN0IHRyaXBsZXQuXG5cdFx0dmFyIHJldCA9IHt9O1xuXHRcdHZhciBzdGFydCA9IGk7XG5cdFx0d2hpbGUgKGxpbmUuY2hhckF0KGkpID09PSAnKCcgfHwgdG9rZW5pemVyLmlzV2hpdGVTcGFjZShsaW5lLmNoYXJBdChpKSkpIHtcblx0XHRcdGlmIChsaW5lLmNoYXJBdChpKSA9PT0gJygnKSB7XG5cdFx0XHRcdGlmIChpKzEgPCBsaW5lLmxlbmd0aCAmJiAobGluZS5jaGFyQXQoaSsxKSA+PSAnMicgJiYgbGluZS5jaGFyQXQoaSsxKSA8PSAnOScpKSB7XG5cdFx0XHRcdFx0aWYgKHJldC50cmlwbGV0ICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHR3YXJuKFwiQ2FuJ3QgbmVzdCB0cmlwbGV0c1wiLCBsaW5lLCBpKTtcblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdHJldC50cmlwbGV0ID0gbGluZS5jaGFyQXQoaSsxKSAtICcwJztcblx0XHRcdFx0XHRcdHJldC50cmlwbGV0USA9IHRyaXBsZXRRW3JldC50cmlwbGV0XTtcblx0XHRcdFx0XHRcdHJldC5udW1fbm90ZXMgPSByZXQudHJpcGxldDtcblx0XHRcdFx0XHRcdGlmIChpKzIgPCBsaW5lLmxlbmd0aCAmJiBsaW5lLmNoYXJBdChpKzIpID09PSAnOicpIHtcblx0XHRcdFx0XHRcdFx0Ly8gV2UgYXJlIGV4cGVjdGluZyBcIihwOnE6clwiIG9yIFwiKHA6cVwiIG9yIFwiKHA6OnJcIlxuXHRcdFx0XHRcdFx0XHQvLyBUaGF0IGlzOiBcInB1dCBwIG5vdGVzIGludG8gdGhlIHRpbWUgb2YgcSBmb3IgdGhlIG5leHQgciBub3Rlc1wiXG5cdFx0XHRcdFx0XHRcdC8vIGlmIHIgaXMgbWlzc2luZywgdGhlbiBpdCBpcyBlcXVhbCB0byBwLlxuXHRcdFx0XHRcdFx0XHQvLyBpZiBxIGlzIG1pc3NpbmcsIGl0IGlzIGRldGVybWluZWQgZnJvbSB0aGlzIHRhYmxlOlxuXHRcdFx0XHRcdFx0XHQvLyAoMiBub3RlcyBpbiB0aGUgdGltZSBvZiAzXG5cdFx0XHRcdFx0XHRcdC8vICgzIG5vdGVzIGluIHRoZSB0aW1lIG9mIDJcblx0XHRcdFx0XHRcdFx0Ly8gKDQgbm90ZXMgaW4gdGhlIHRpbWUgb2YgM1xuXHRcdFx0XHRcdFx0XHQvLyAoNSBub3RlcyBpbiB0aGUgdGltZSBvZiBuIHwgaWYgdGltZSBzaWcgaXMgKDYvOCwgOS84LCAxMi84KSwgbj0zLCBlbHNlIG49MlxuXHRcdFx0XHRcdFx0XHQvLyAoNiBub3RlcyBpbiB0aGUgdGltZSBvZiAyXG5cdFx0XHRcdFx0XHRcdC8vICg3IG5vdGVzIGluIHRoZSB0aW1lIG9mIG5cblx0XHRcdFx0XHRcdFx0Ly8gKDggbm90ZXMgaW4gdGhlIHRpbWUgb2YgM1xuXHRcdFx0XHRcdFx0XHQvLyAoOSBub3RlcyBpbiB0aGUgdGltZSBvZiBuXG5cdFx0XHRcdFx0XHRcdGlmIChpKzMgPCBsaW5lLmxlbmd0aCAmJiBsaW5lLmNoYXJBdChpKzMpID09PSAnOicpIHtcblx0XHRcdFx0XHRcdFx0XHQvLyBUaGUgc2Vjb25kIG51bWJlciwgJ3EnLCBpcyBub3QgcHJlc2VudC5cblx0XHRcdFx0XHRcdFx0XHRpZiAoaSs0IDwgbGluZS5sZW5ndGggJiYgKGxpbmUuY2hhckF0KGkrNCkgPj0gJzEnICYmIGxpbmUuY2hhckF0KGkrNCkgPD0gJzknKSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0cmV0Lm51bV9ub3RlcyA9IGxpbmUuY2hhckF0KGkrNCkgLSAnMCc7XG5cdFx0XHRcdFx0XHRcdFx0XHRpICs9IDM7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0XHRcdFx0XHR3YXJuKFwiZXhwZWN0ZWQgbnVtYmVyIGFmdGVyIHRoZSB0d28gY29sb25zIGFmdGVyIHRoZSB0cmlwbGV0IHRvIG1hcmsgdGhlIGR1cmF0aW9uXCIsIGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGkrMyA8IGxpbmUubGVuZ3RoICYmIChsaW5lLmNoYXJBdChpKzMpID49ICcxJyAmJiBsaW5lLmNoYXJBdChpKzMpIDw9ICc5JykpIHtcblx0XHRcdFx0XHRcdFx0XHRyZXQudHJpcGxldFEgPSBsaW5lLmNoYXJBdChpKzMpIC0gJzAnO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChpKzQgPCBsaW5lLmxlbmd0aCAmJiBsaW5lLmNoYXJBdChpKzQpID09PSAnOicpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChpKzUgPCBsaW5lLmxlbmd0aCAmJiAobGluZS5jaGFyQXQoaSs1KSA+PSAnMScgJiYgbGluZS5jaGFyQXQoaSs1KSA8PSAnOScpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHJldC5udW1fbm90ZXMgPSBsaW5lLmNoYXJBdChpKzUpIC0gJzAnO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpICs9IDQ7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGkgKz0gMjtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH0gZWxzZVxuXHRcdFx0XHRcdFx0XHRcdHdhcm4oXCJleHBlY3RlZCBudW1iZXIgYWZ0ZXIgdGhlIHRyaXBsZXQgdG8gbWFyayB0aGUgZHVyYXRpb25cIiwgbGluZSwgaSk7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGkrKztcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRpZiAocmV0LnN0YXJ0U2x1ciA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0cmV0LnN0YXJ0U2x1ciA9IDE7XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0cmV0LnN0YXJ0U2x1cisrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpKys7XG5cdFx0fVxuXHRcdHJldC5jb25zdW1lZCA9IGktc3RhcnQ7XG5cdFx0cmV0dXJuIHJldDtcblx0fTtcblxuXHR2YXIgYWRkV29yZHMgPSBmdW5jdGlvbihsaW5lLCB3b3Jkcykge1xuXHRcdGlmICghbGluZSkgeyB3YXJuKFwiQ2FuJ3QgYWRkIHdvcmRzIGJlZm9yZSB0aGUgZmlyc3QgbGluZSBvZiBtdXNpY1wiLCBsaW5lLCAwKTsgcmV0dXJuOyB9XG5cdFx0d29yZHMgPSBwYXJzZUNvbW1vbi5zdHJpcCh3b3Jkcyk7XG5cdFx0aWYgKHdvcmRzLmNoYXJBdCh3b3Jkcy5sZW5ndGgtMSkgIT09ICctJylcblx0XHRcdHdvcmRzID0gd29yZHMgKyAnICc7XHQvLyBKdXN0IG1ha2VzIGl0IGVhc2llciB0byBwYXJzZSBiZWxvdywgc2luY2UgZXZlcnkgd29yZCBoYXMgYSBkaXZpZGVyIGFmdGVyIGl0LlxuXHRcdHZhciB3b3JkX2xpc3QgPSBbXTtcblx0XHQvLyBmaXJzdCBtYWtlIGEgbGlzdCBvZiB3b3JkcyBmcm9tIHRoZSBzdHJpbmcgd2UgYXJlIHBhc3NlZC4gQSB3b3JkIGlzIGRpdmlkZWQgb24gZWl0aGVyIGEgc3BhY2Ugb3IgZGFzaC5cblx0XHR2YXIgbGFzdF9kaXZpZGVyID0gMDtcblx0XHR2YXIgcmVwbGFjZSA9IGZhbHNlO1xuXHRcdHZhciBhZGRXb3JkID0gZnVuY3Rpb24oaSkge1xuXHRcdFx0dmFyIHdvcmQgPSBwYXJzZUNvbW1vbi5zdHJpcCh3b3Jkcy5zdWJzdHJpbmcobGFzdF9kaXZpZGVyLCBpKSk7XG5cdFx0XHRsYXN0X2RpdmlkZXIgPSBpKzE7XG5cdFx0XHRpZiAod29yZC5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdGlmIChyZXBsYWNlKVxuXHRcdFx0XHRcdHdvcmQgPSBwYXJzZUNvbW1vbi5nc3ViKHdvcmQsJ34nLCAnICcpO1xuXHRcdFx0XHR2YXIgZGl2ID0gd29yZHMuY2hhckF0KGkpO1xuXHRcdFx0XHRpZiAoZGl2ICE9PSAnXycgJiYgZGl2ICE9PSAnLScpXG5cdFx0XHRcdFx0ZGl2ID0gJyAnO1xuXHRcdFx0XHR3b3JkX2xpc3QucHVzaCh7c3lsbGFibGU6IHRva2VuaXplci50cmFuc2xhdGVTdHJpbmcod29yZCksIGRpdmlkZXI6IGRpdn0pO1xuXHRcdFx0XHRyZXBsYWNlID0gZmFsc2U7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0c3dpdGNoICh3b3Jkcy5jaGFyQXQoaSkpIHtcblx0XHRcdFx0Y2FzZSAnICc6XG5cdFx0XHRcdGNhc2UgJ1xceDEyJzpcblx0XHRcdFx0XHRhZGRXb3JkKGkpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICctJzpcblx0XHRcdFx0XHRpZiAoIWFkZFdvcmQoaSkgJiYgd29yZF9saXN0Lmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdHBhcnNlQ29tbW9uLmxhc3Qod29yZF9saXN0KS5kaXZpZGVyID0gJy0nO1xuXHRcdFx0XHRcdFx0d29yZF9saXN0LnB1c2goe3NraXA6IHRydWUsIHRvOiAnbmV4dCd9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ18nOlxuXHRcdFx0XHRcdGFkZFdvcmQoaSk7XG5cdFx0XHRcdFx0d29yZF9saXN0LnB1c2goe3NraXA6IHRydWUsIHRvOiAnc2x1cid9KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnKic6XG5cdFx0XHRcdFx0YWRkV29yZChpKTtcblx0XHRcdFx0XHR3b3JkX2xpc3QucHVzaCh7c2tpcDogdHJ1ZSwgdG86ICduZXh0J30pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICd8Jzpcblx0XHRcdFx0XHRhZGRXb3JkKGkpO1xuXHRcdFx0XHRcdHdvcmRfbGlzdC5wdXNoKHtza2lwOiB0cnVlLCB0bzogJ2Jhcid9KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnfic6XG5cdFx0XHRcdFx0cmVwbGFjZSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dmFyIGluU2x1ciA9IGZhbHNlO1xuXHRcdHBhcnNlQ29tbW9uLmVhY2gobGluZSwgZnVuY3Rpb24oZWwpIHtcblx0XHRcdGlmICh3b3JkX2xpc3QubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHRcdGlmICh3b3JkX2xpc3RbMF0uc2tpcCkge1xuXHRcdFx0XHRcdHN3aXRjaCAod29yZF9saXN0WzBdLnRvKSB7XG5cdFx0XHRcdFx0XHRjYXNlICduZXh0JzogaWYgKGVsLmVsX3R5cGUgPT09ICdub3RlJyAmJiBlbC5waXRjaGVzICE9PSBudWxsICYmICFpblNsdXIpIHdvcmRfbGlzdC5zaGlmdCgpOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ3NsdXInOiBpZiAoZWwuZWxfdHlwZSA9PT0gJ25vdGUnICYmIGVsLnBpdGNoZXMgIT09IG51bGwpIHdvcmRfbGlzdC5zaGlmdCgpOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2Jhcic6IGlmIChlbC5lbF90eXBlID09PSAnYmFyJykgd29yZF9saXN0LnNoaWZ0KCk7IGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoZWwuZWxfdHlwZSAhPT0gJ2JhcicpIHtcblx0XHRcdFx0XHRcdGlmIChlbC5seXJpYyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0XHRlbC5seXJpYyA9IFt7c3lsbGFibGU6IFwiXCIsIGRpdmlkZXI6IFwiIFwifV07XG5cdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdGVsLmx5cmljLnB1c2goe3N5bGxhYmxlOiBcIlwiLCBkaXZpZGVyOiBcIiBcIn0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoZWwuZWxfdHlwZSA9PT0gJ25vdGUnICYmIGVsLnJlc3QgPT09IHVuZGVmaW5lZCAmJiAhaW5TbHVyKSB7XG5cdFx0XHRcdFx0XHR2YXIgbHlyaWMgPSB3b3JkX2xpc3Quc2hpZnQoKTtcblx0XHRcdFx0XHRcdGlmIChseXJpYy5zeWxsYWJsZSlcblx0XHRcdFx0XHRcdFx0bHlyaWMuc3lsbGFibGUgPSBseXJpYy5zeWxsYWJsZS5yZXBsYWNlKC8gKy9nLCdcXHhBMCcpO1xuXHRcdFx0XHRcdFx0aWYgKGVsLmx5cmljID09PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRcdGVsLmx5cmljID0gWyBseXJpYyBdO1xuXHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHRlbC5seXJpYy5wdXNoKGx5cmljKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9KTtcblx0fTtcblxuXHR2YXIgYWRkU3ltYm9scyA9IGZ1bmN0aW9uKGxpbmUsIHdvcmRzKSB7XG5cdFx0Ly8gVE9ETy1QRVI6IEN1cnJlbnRseSBjb3BpZWQgZnJvbSB3OiBsaW5lLiBUaGlzIG5lZWRzIHRvIGJlIHJlYWQgYXMgc3ltYm9scyBpbnN0ZWFkLlxuXHRcdGlmICghbGluZSkgeyB3YXJuKFwiQ2FuJ3QgYWRkIHN5bWJvbHMgYmVmb3JlIHRoZSBmaXJzdCBsaW5lIG9mIG11c2ljXCIsIGxpbmUsIDApOyByZXR1cm47IH1cblx0XHR3b3JkcyA9IHBhcnNlQ29tbW9uLnN0cmlwKHdvcmRzKTtcblx0XHRpZiAod29yZHMuY2hhckF0KHdvcmRzLmxlbmd0aC0xKSAhPT0gJy0nKVxuXHRcdFx0d29yZHMgPSB3b3JkcyArICcgJztcdC8vIEp1c3QgbWFrZXMgaXQgZWFzaWVyIHRvIHBhcnNlIGJlbG93LCBzaW5jZSBldmVyeSB3b3JkIGhhcyBhIGRpdmlkZXIgYWZ0ZXIgaXQuXG5cdFx0dmFyIHdvcmRfbGlzdCA9IFtdO1xuXHRcdC8vIGZpcnN0IG1ha2UgYSBsaXN0IG9mIHdvcmRzIGZyb20gdGhlIHN0cmluZyB3ZSBhcmUgcGFzc2VkLiBBIHdvcmQgaXMgZGl2aWRlZCBvbiBlaXRoZXIgYSBzcGFjZSBvciBkYXNoLlxuXHRcdHZhciBsYXN0X2RpdmlkZXIgPSAwO1xuXHRcdHZhciByZXBsYWNlID0gZmFsc2U7XG5cdFx0dmFyIGFkZFdvcmQgPSBmdW5jdGlvbihpKSB7XG5cdFx0XHR2YXIgd29yZCA9IHBhcnNlQ29tbW9uLnN0cmlwKHdvcmRzLnN1YnN0cmluZyhsYXN0X2RpdmlkZXIsIGkpKTtcblx0XHRcdGxhc3RfZGl2aWRlciA9IGkrMTtcblx0XHRcdGlmICh3b3JkLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0aWYgKHJlcGxhY2UpXG5cdFx0XHRcdFx0d29yZCA9IHBhcnNlQ29tbW9uLmdzdWIod29yZCwgJ34nLCAnICcpO1xuXHRcdFx0XHR2YXIgZGl2ID0gd29yZHMuY2hhckF0KGkpO1xuXHRcdFx0XHRpZiAoZGl2ICE9PSAnXycgJiYgZGl2ICE9PSAnLScpXG5cdFx0XHRcdFx0ZGl2ID0gJyAnO1xuXHRcdFx0XHR3b3JkX2xpc3QucHVzaCh7c3lsbGFibGU6IHRva2VuaXplci50cmFuc2xhdGVTdHJpbmcod29yZCksIGRpdmlkZXI6IGRpdn0pO1xuXHRcdFx0XHRyZXBsYWNlID0gZmFsc2U7XG5cdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH07XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB3b3Jkcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0c3dpdGNoICh3b3Jkcy5jaGFyQXQoaSkpIHtcblx0XHRcdFx0Y2FzZSAnICc6XG5cdFx0XHRcdGNhc2UgJ1xceDEyJzpcblx0XHRcdFx0XHRhZGRXb3JkKGkpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICctJzpcblx0XHRcdFx0XHRpZiAoIWFkZFdvcmQoaSkgJiYgd29yZF9saXN0Lmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdHBhcnNlQ29tbW9uLmxhc3Qod29yZF9saXN0KS5kaXZpZGVyID0gJy0nO1xuXHRcdFx0XHRcdFx0d29yZF9saXN0LnB1c2goe3NraXA6IHRydWUsIHRvOiAnbmV4dCd9KTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ18nOlxuXHRcdFx0XHRcdGFkZFdvcmQoaSk7XG5cdFx0XHRcdFx0d29yZF9saXN0LnB1c2goe3NraXA6IHRydWUsIHRvOiAnc2x1cid9KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnKic6XG5cdFx0XHRcdFx0YWRkV29yZChpKTtcblx0XHRcdFx0XHR3b3JkX2xpc3QucHVzaCh7c2tpcDogdHJ1ZSwgdG86ICduZXh0J30pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICd8Jzpcblx0XHRcdFx0XHRhZGRXb3JkKGkpO1xuXHRcdFx0XHRcdHdvcmRfbGlzdC5wdXNoKHtza2lwOiB0cnVlLCB0bzogJ2Jhcid9KTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnfic6XG5cdFx0XHRcdFx0cmVwbGFjZSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dmFyIGluU2x1ciA9IGZhbHNlO1xuXHRcdHBhcnNlQ29tbW9uLmVhY2gobGluZSwgZnVuY3Rpb24oZWwpIHtcblx0XHRcdGlmICh3b3JkX2xpc3QubGVuZ3RoICE9PSAwKSB7XG5cdFx0XHRcdGlmICh3b3JkX2xpc3RbMF0uc2tpcCkge1xuXHRcdFx0XHRcdHN3aXRjaCAod29yZF9saXN0WzBdLnRvKSB7XG5cdFx0XHRcdFx0XHRjYXNlICduZXh0JzogaWYgKGVsLmVsX3R5cGUgPT09ICdub3RlJyAmJiBlbC5waXRjaGVzICE9PSBudWxsICYmICFpblNsdXIpIHdvcmRfbGlzdC5zaGlmdCgpOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ3NsdXInOiBpZiAoZWwuZWxfdHlwZSA9PT0gJ25vdGUnICYmIGVsLnBpdGNoZXMgIT09IG51bGwpIHdvcmRfbGlzdC5zaGlmdCgpOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2Jhcic6IGlmIChlbC5lbF90eXBlID09PSAnYmFyJykgd29yZF9saXN0LnNoaWZ0KCk7IGJyZWFrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRpZiAoZWwuZWxfdHlwZSA9PT0gJ25vdGUnICYmIGVsLnJlc3QgPT09IHVuZGVmaW5lZCAmJiAhaW5TbHVyKSB7XG5cdFx0XHRcdFx0XHR2YXIgbHlyaWMgPSB3b3JkX2xpc3Quc2hpZnQoKTtcblx0XHRcdFx0XHRcdGlmIChlbC5seXJpYyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0XHRlbC5seXJpYyA9IFsgbHlyaWMgXTtcblx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0ZWwubHlyaWMucHVzaChseXJpYyk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdH07XG5cblx0dmFyIGdldEJyb2tlblJoeXRobSA9IGZ1bmN0aW9uKGxpbmUsIGluZGV4KSB7XG5cdFx0c3dpdGNoIChsaW5lLmNoYXJBdChpbmRleCkpIHtcblx0XHRcdGNhc2UgJz4nOlxuXHRcdFx0aWYgKGluZGV4IDwgbGluZS5sZW5ndGggLSAxICYmIGxpbmUuY2hhckF0KGluZGV4KzEpID09PSAnPicpXHQvLyBkb3VibGUgPj5cblx0XHRcdFx0XHRyZXR1cm4gWzIsIDEuNzUsIDAuMjVdO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0cmV0dXJuIFsxLCAxLjUsIDAuNV07XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnPCc6XG5cdFx0XHRpZiAoaW5kZXggPCBsaW5lLmxlbmd0aCAtIDEgJiYgbGluZS5jaGFyQXQoaW5kZXgrMSkgPT09ICc8JylcdC8vIGRvdWJsZSA8PFxuXHRcdFx0XHRcdHJldHVybiBbMiwgMC4yNSwgMS43NV07XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRyZXR1cm4gWzEsIDAuNSwgMS41XTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cdC8vIFRPRE8tUEVSOiBtYWtlIHRoaXMgYSBtZXRob2QgaW4gZWwuXG5cdHZhciBhZGRFbmRCZWFtID0gZnVuY3Rpb24oZWwpIHtcblx0XHRpZiAoZWwuZHVyYXRpb24gIT09IHVuZGVmaW5lZCAmJiBlbC5kdXJhdGlvbiA8IDAuMjUpXG5cdFx0XHRlbC5lbmRfYmVhbSA9IHRydWU7XG5cdFx0cmV0dXJuIGVsO1xuXHR9O1xuXG5cdHZhciBwaXRjaGVzID0ge0E6IDUsIEI6IDYsIEM6IDAsIEQ6IDEsIEU6IDIsIEY6IDMsIEc6IDQsIGE6IDEyLCBiOiAxMywgYzogNywgZDogOCwgZTogOSwgZjogMTAsIGc6IDExfTtcblx0dmFyIHJlc3RzID0ge3g6ICdpbnZpc2libGUnLCB5OiAnc3BhY2VyJywgejogJ3Jlc3QnLCBaOiAnbXVsdGltZWFzdXJlJyB9O1xuXHR2YXIgZ2V0Q29yZU5vdGUgPSBmdW5jdGlvbihsaW5lLCBpbmRleCwgZWwsIGNhbkhhdmVCcm9rZW5SaHl0aG0pIHtcblx0XHQvL3ZhciBlbCA9IHsgc3RhcnRDaGFyOiBpbmRleCB9O1xuXHRcdHZhciBpc0NvbXBsZXRlID0gZnVuY3Rpb24oc3RhdGUpIHtcblx0XHRcdHJldHVybiAoc3RhdGUgPT09ICdvY3RhdmUnIHx8IHN0YXRlID09PSAnZHVyYXRpb24nIHx8IHN0YXRlID09PSAnWmR1cmF0aW9uJyB8fCBzdGF0ZSA9PT0gJ2Jyb2tlbl9yaHl0aG0nIHx8IHN0YXRlID09PSAnZW5kX3NsdXInKTtcblx0XHR9O1xuXHRcdHZhciBzdGF0ZSA9ICdzdGFydFNsdXInO1xuXHRcdHZhciBkdXJhdGlvblNldEJ5UHJldmlvdXNOb3RlID0gZmFsc2U7XG5cdFx0d2hpbGUgKDEpIHtcblx0XHRcdHN3aXRjaChsaW5lLmNoYXJBdChpbmRleCkpIHtcblx0XHRcdFx0Y2FzZSAnKCc6XG5cdFx0XHRcdFx0aWYgKHN0YXRlID09PSAnc3RhcnRTbHVyJykge1xuXHRcdFx0XHRcdFx0aWYgKGVsLnN0YXJ0U2x1ciA9PT0gdW5kZWZpbmVkKSBlbC5zdGFydFNsdXIgPSAxOyBlbHNlIGVsLnN0YXJ0U2x1cisrO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoaXNDb21wbGV0ZShzdGF0ZSkpIHtlbC5lbmRDaGFyID0gaW5kZXg7cmV0dXJuIGVsO31cblx0XHRcdFx0XHRlbHNlIHJldHVybiBudWxsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICcpJzpcblx0XHRcdFx0XHRpZiAoaXNDb21wbGV0ZShzdGF0ZSkpIHtcblx0XHRcdFx0XHRcdGlmIChlbC5lbmRTbHVyID09PSB1bmRlZmluZWQpIGVsLmVuZFNsdXIgPSAxOyBlbHNlIGVsLmVuZFNsdXIrKztcblx0XHRcdFx0XHR9IGVsc2UgcmV0dXJuIG51bGw7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJ14nOlxuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PT0gJ3N0YXJ0U2x1cicpIHtlbC5hY2NpZGVudGFsID0gJ3NoYXJwJztzdGF0ZSA9ICdzaGFycDInO31cblx0XHRcdFx0XHRlbHNlIGlmIChzdGF0ZSA9PT0gJ3NoYXJwMicpIHtlbC5hY2NpZGVudGFsID0gJ2RibHNoYXJwJztzdGF0ZSA9ICdwaXRjaCc7fVxuXHRcdFx0XHRcdGVsc2UgaWYgKGlzQ29tcGxldGUoc3RhdGUpKSB7ZWwuZW5kQ2hhciA9IGluZGV4O3JldHVybiBlbDt9XG5cdFx0XHRcdFx0ZWxzZSByZXR1cm4gbnVsbDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnXyc6XG5cdFx0XHRcdFx0aWYgKHN0YXRlID09PSAnc3RhcnRTbHVyJykge2VsLmFjY2lkZW50YWwgPSAnZmxhdCc7c3RhdGUgPSAnZmxhdDInO31cblx0XHRcdFx0XHRlbHNlIGlmIChzdGF0ZSA9PT0gJ2ZsYXQyJykge2VsLmFjY2lkZW50YWwgPSAnZGJsZmxhdCc7c3RhdGUgPSAncGl0Y2gnO31cblx0XHRcdFx0XHRlbHNlIGlmIChpc0NvbXBsZXRlKHN0YXRlKSkge2VsLmVuZENoYXIgPSBpbmRleDtyZXR1cm4gZWw7fVxuXHRcdFx0XHRcdGVsc2UgcmV0dXJuIG51bGw7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJz0nOlxuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PT0gJ3N0YXJ0U2x1cicpIHtlbC5hY2NpZGVudGFsID0gJ25hdHVyYWwnO3N0YXRlID0gJ3BpdGNoJzt9XG5cdFx0XHRcdFx0ZWxzZSBpZiAoaXNDb21wbGV0ZShzdGF0ZSkpIHtlbC5lbmRDaGFyID0gaW5kZXg7cmV0dXJuIGVsO31cblx0XHRcdFx0XHRlbHNlIHJldHVybiBudWxsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICdBJzpcblx0XHRcdFx0Y2FzZSAnQic6XG5cdFx0XHRcdGNhc2UgJ0MnOlxuXHRcdFx0XHRjYXNlICdEJzpcblx0XHRcdFx0Y2FzZSAnRSc6XG5cdFx0XHRcdGNhc2UgJ0YnOlxuXHRcdFx0XHRjYXNlICdHJzpcblx0XHRcdFx0Y2FzZSAnYSc6XG5cdFx0XHRcdGNhc2UgJ2InOlxuXHRcdFx0XHRjYXNlICdjJzpcblx0XHRcdFx0Y2FzZSAnZCc6XG5cdFx0XHRcdGNhc2UgJ2UnOlxuXHRcdFx0XHRjYXNlICdmJzpcblx0XHRcdFx0Y2FzZSAnZyc6XG5cdFx0XHRcdFx0aWYgKHN0YXRlID09PSAnc3RhcnRTbHVyJyB8fCBzdGF0ZSA9PT0gJ3NoYXJwMicgfHwgc3RhdGUgPT09ICdmbGF0MicgfHwgc3RhdGUgPT09ICdwaXRjaCcpIHtcblx0XHRcdFx0XHRcdGVsLnBpdGNoID0gcGl0Y2hlc1tsaW5lLmNoYXJBdChpbmRleCldO1xuXHRcdFx0XHRcdFx0dHJhbnNwb3NlLm5vdGUobXVsdGlsaW5lVmFycywgZWwpO1xuXHRcdFx0XHRcdFx0c3RhdGUgPSAnb2N0YXZlJztcblx0XHRcdFx0XHRcdC8vIEF0IHRoaXMgcG9pbnQgd2UgaGF2ZSBhIHZhbGlkIG5vdGUuIFRoZSByZXN0IGlzIG9wdGlvbmFsLiBTZXQgdGhlIGR1cmF0aW9uIGluIGNhc2Ugd2UgZG9uJ3QgZ2V0IG9uZSBiZWxvd1xuXHRcdFx0XHRcdFx0aWYgKGNhbkhhdmVCcm9rZW5SaHl0aG0gJiYgbXVsdGlsaW5lVmFycy5uZXh0X25vdGVfZHVyYXRpb24gIT09IDApIHtcblx0XHRcdFx0XHRcdFx0ZWwuZHVyYXRpb24gPSBtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoICogbXVsdGlsaW5lVmFycy5uZXh0X25vdGVfZHVyYXRpb247XG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMubmV4dF9ub3RlX2R1cmF0aW9uID0gMDtcblx0XHRcdFx0XHRcdFx0ZHVyYXRpb25TZXRCeVByZXZpb3VzTm90ZSA9IHRydWU7XG5cdFx0XHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0XHRcdFx0ZWwuZHVyYXRpb24gPSBtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoO1xuXHRcdFx0XHRcdFx0Ly8gSWYgdGhlIGNsZWYgaXMgcGVyY3Vzc2lvbiwgdGhlcmUgaXMgcHJvYmFibHkgc29tZSB0cmFuc2xhdGlvbiBvZiB0aGUgcGl0Y2ggdG8gYSBwYXJ0aWN1bGFyIGRydW0ga2l0IGl0ZW0uXG5cdFx0XHRcdFx0XHRpZiAoKG11bHRpbGluZVZhcnMuY2xlZiAmJiBtdWx0aWxpbmVWYXJzLmNsZWYudHlwZSA9PT0gXCJwZXJjXCIpIHx8XG5cdFx0XHRcdFx0XHRcdChtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZSAmJiBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5jbGVmID09PSBcInBlcmNcIikpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGtleSA9IGxpbmUuY2hhckF0KGluZGV4KTtcblx0XHRcdFx0XHRcdFx0aWYgKGVsLmFjY2lkZW50YWwpIHtcblx0XHRcdFx0XHRcdFx0XHR2YXIgYWNjTWFwID0geyAnZGJsZmxhdCc6ICdfXycsICdmbGF0JzogJ18nLCAnbmF0dXJhbCc6ICc9JywgJ3NoYXJwJzogJ14nLCAnZGJsc2hhcnAnOiAnXl4nfTtcblx0XHRcdFx0XHRcdFx0XHRrZXkgPSBhY2NNYXBbZWwuYWNjaWRlbnRhbF0gKyBrZXk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKHR1bmUuZm9ybWF0dGluZyAmJiB0dW5lLmZvcm1hdHRpbmcubWlkaSAmJiB0dW5lLmZvcm1hdHRpbmcubWlkaS5kcnVtbWFwKVxuXHRcdFx0XHRcdFx0XHRcdGVsLm1pZGlwaXRjaCA9IHR1bmUuZm9ybWF0dGluZy5taWRpLmRydW1tYXBba2V5XTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2UgaWYgKGlzQ29tcGxldGUoc3RhdGUpKSB7ZWwuZW5kQ2hhciA9IGluZGV4O3JldHVybiBlbDt9XG5cdFx0XHRcdFx0ZWxzZSByZXR1cm4gbnVsbDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnLCc6XG5cdFx0XHRcdFx0aWYgKHN0YXRlID09PSAnb2N0YXZlJykge2VsLnBpdGNoIC09IDc7fVxuXHRcdFx0XHRcdGVsc2UgaWYgKGlzQ29tcGxldGUoc3RhdGUpKSB7ZWwuZW5kQ2hhciA9IGluZGV4O3JldHVybiBlbDt9XG5cdFx0XHRcdFx0ZWxzZSByZXR1cm4gbnVsbDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnXFwnJzpcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT09ICdvY3RhdmUnKSB7ZWwucGl0Y2ggKz0gNzt9XG5cdFx0XHRcdFx0ZWxzZSBpZiAoaXNDb21wbGV0ZShzdGF0ZSkpIHtlbC5lbmRDaGFyID0gaW5kZXg7cmV0dXJuIGVsO31cblx0XHRcdFx0XHRlbHNlIHJldHVybiBudWxsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICd4Jzpcblx0XHRcdFx0Y2FzZSAneSc6XG5cdFx0XHRcdGNhc2UgJ3onOlxuXHRcdFx0XHRjYXNlICdaJzpcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT09ICdzdGFydFNsdXInKSB7XG5cdFx0XHRcdFx0XHRlbC5yZXN0ID0geyB0eXBlOiByZXN0c1tsaW5lLmNoYXJBdChpbmRleCldIH07XG5cdFx0XHRcdFx0XHQvLyBUaGVyZSBzaG91bGRuJ3QgYmUgc29tZSBvZiB0aGUgcHJvcGVydGllcyB0aGF0IG5vdGVzIGhhdmUuIElmIHNvbWUgc25lYWsgaW4gZHVlIHRvIGJhZCBzeW50YXggaW4gdGhlIGFiYyBmaWxlLFxuXHRcdFx0XHRcdFx0Ly8ganVzdCBuaXggdGhlbSBoZXJlLlxuXHRcdFx0XHRcdFx0ZGVsZXRlIGVsLmFjY2lkZW50YWw7XG5cdFx0XHRcdFx0XHRkZWxldGUgZWwuc3RhcnRTbHVyO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGVsLnN0YXJ0VGllO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGVsLmVuZFNsdXI7XG5cdFx0XHRcdFx0XHRkZWxldGUgZWwuZW5kVGllO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGVsLmVuZF9iZWFtO1xuXHRcdFx0XHRcdFx0ZGVsZXRlIGVsLmdyYWNlX25vdGVzO1xuXHRcdFx0XHRcdFx0Ly8gQXQgdGhpcyBwb2ludCB3ZSBoYXZlIGEgdmFsaWQgbm90ZS4gVGhlIHJlc3QgaXMgb3B0aW9uYWwuIFNldCB0aGUgZHVyYXRpb24gaW4gY2FzZSB3ZSBkb24ndCBnZXQgb25lIGJlbG93XG5cdFx0XHRcdFx0XHRpZiAoZWwucmVzdC50eXBlID09PSAnbXVsdGltZWFzdXJlJykge1xuXHRcdFx0XHRcdFx0XHRlbC5kdXJhdGlvbiA9IDE7XG5cdFx0XHRcdFx0XHRcdHN0YXRlID0gJ1pkdXJhdGlvbic7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRpZiAoY2FuSGF2ZUJyb2tlblJoeXRobSAmJiBtdWx0aWxpbmVWYXJzLm5leHRfbm90ZV9kdXJhdGlvbiAhPT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdGVsLmR1cmF0aW9uID0gbXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCAqIG11bHRpbGluZVZhcnMubmV4dF9ub3RlX2R1cmF0aW9uO1xuXHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMubmV4dF9ub3RlX2R1cmF0aW9uID0gMDtcblx0XHRcdFx0XHRcdFx0XHRkdXJhdGlvblNldEJ5UHJldmlvdXNOb3RlID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0XHRcdFx0ZWwuZHVyYXRpb24gPSBtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoO1xuXHRcdFx0XHRcdFx0XHRzdGF0ZSA9ICdkdXJhdGlvbic7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIGlmIChpc0NvbXBsZXRlKHN0YXRlKSkge2VsLmVuZENoYXIgPSBpbmRleDtyZXR1cm4gZWw7fVxuXHRcdFx0XHRcdGVsc2UgcmV0dXJuIG51bGw7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJzEnOlxuXHRcdFx0XHRjYXNlICcyJzpcblx0XHRcdFx0Y2FzZSAnMyc6XG5cdFx0XHRcdGNhc2UgJzQnOlxuXHRcdFx0XHRjYXNlICc1Jzpcblx0XHRcdFx0Y2FzZSAnNic6XG5cdFx0XHRcdGNhc2UgJzcnOlxuXHRcdFx0XHRjYXNlICc4Jzpcblx0XHRcdFx0Y2FzZSAnOSc6XG5cdFx0XHRcdGNhc2UgJzAnOlxuXHRcdFx0XHRjYXNlICcvJzpcblx0XHRcdFx0XHRpZiAoc3RhdGUgPT09ICdvY3RhdmUnIHx8IHN0YXRlID09PSAnZHVyYXRpb24nKSB7XG5cdFx0XHRcdFx0XHR2YXIgZnJhY3Rpb24gPSB0b2tlbml6ZXIuZ2V0RnJhY3Rpb24obGluZSwgaW5kZXgpO1xuXHRcdFx0XHRcdFx0Ly9pZiAoIWR1cmF0aW9uU2V0QnlQcmV2aW91c05vdGUpXG5cdFx0XHRcdFx0XHRcdGVsLmR1cmF0aW9uID0gZWwuZHVyYXRpb24gKiBmcmFjdGlvbi52YWx1ZTtcblx0XHRcdFx0XHRcdC8vIFRPRE8tUEVSOiBXZSBjYW4gdGVzdCB0aGUgcmV0dXJuZWQgZHVyYXRpb24gaGVyZSBhbmQgZ2l2ZSBhIHdhcm5pbmcgaWYgaXQgaXNuJ3QgdGhlIG9uZSBleHBlY3RlZC5cblx0XHRcdFx0XHRcdGVsLmVuZENoYXIgPSBmcmFjdGlvbi5pbmRleDtcblx0XHRcdFx0XHRcdHdoaWxlIChmcmFjdGlvbi5pbmRleCA8IGxpbmUubGVuZ3RoICYmICh0b2tlbml6ZXIuaXNXaGl0ZVNwYWNlKGxpbmUuY2hhckF0KGZyYWN0aW9uLmluZGV4KSkgfHwgbGluZS5jaGFyQXQoZnJhY3Rpb24uaW5kZXgpID09PSAnLScpKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChsaW5lLmNoYXJBdChmcmFjdGlvbi5pbmRleCkgPT09ICctJylcblx0XHRcdFx0XHRcdFx0XHRlbC5zdGFydFRpZSA9IHt9O1xuXHRcdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdFx0ZWwgPSBhZGRFbmRCZWFtKGVsKTtcblx0XHRcdFx0XHRcdFx0ZnJhY3Rpb24uaW5kZXgrKztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGluZGV4ID0gZnJhY3Rpb24uaW5kZXgtMTtcblx0XHRcdFx0XHRcdHN0YXRlID0gJ2Jyb2tlbl9yaHl0aG0nO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoc3RhdGUgPT09ICdzaGFycDInKSB7XG5cdFx0XHRcdFx0XHRlbC5hY2NpZGVudGFsID0gJ3F1YXJ0ZXJzaGFycCc7c3RhdGUgPSAncGl0Y2gnO1xuXHRcdFx0XHRcdH0gZWxzZSBpZiAoc3RhdGUgPT09ICdmbGF0MicpIHtcblx0XHRcdFx0XHRcdGVsLmFjY2lkZW50YWwgPSAncXVhcnRlcmZsYXQnO3N0YXRlID0gJ3BpdGNoJztcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHN0YXRlID09PSAnWmR1cmF0aW9uJykge1xuXHRcdFx0XHRcdFx0dmFyIG51bSA9IHRva2VuaXplci5nZXROdW1iZXIobGluZSwgaW5kZXgpO1xuXHRcdFx0XHRcdFx0ZWwuZHVyYXRpb24gPSBudW0ubnVtO1xuXHRcdFx0XHRcdFx0ZWwuZW5kQ2hhciA9IG51bS5pbmRleDtcblx0XHRcdFx0XHRcdHJldHVybiBlbDtcblx0XHRcdFx0XHR9IGVsc2UgcmV0dXJuIG51bGw7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgJy0nOlxuXHRcdFx0XHRcdGlmIChzdGF0ZSA9PT0gJ3N0YXJ0U2x1cicpIHtcblx0XHRcdFx0XHRcdC8vIFRoaXMgaXMgdGhlIGZpcnN0IGNoYXJhY3Rlciwgc28gaXQgbXVzdCBoYXZlIGJlZW4gbWVhbnQgZm9yIHRoZSBwcmV2aW91cyBub3RlLiBDb3JyZWN0IHRoYXQgaGVyZS5cblx0XHRcdFx0XHRcdHR1bmUuYWRkVGllVG9MYXN0Tm90ZSgpO1xuXHRcdFx0XHRcdFx0ZWwuZW5kVGllID0gdHJ1ZTtcblx0XHRcdFx0XHR9IGVsc2UgaWYgKHN0YXRlID09PSAnb2N0YXZlJyB8fCBzdGF0ZSA9PT0gJ2R1cmF0aW9uJyB8fCBzdGF0ZSA9PT0gJ2VuZF9zbHVyJykge1xuXHRcdFx0XHRcdFx0ZWwuc3RhcnRUaWUgPSB7fTtcblx0XHRcdFx0XHRcdGlmICghZHVyYXRpb25TZXRCeVByZXZpb3VzTm90ZSAmJiBjYW5IYXZlQnJva2VuUmh5dGhtKVxuXHRcdFx0XHRcdFx0XHRzdGF0ZSA9ICdicm9rZW5fcmh5dGhtJztcblx0XHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0XHQvLyBQZWVrIGFoZWFkIHRvIHRoZSBuZXh0IGNoYXJhY3Rlci4gSWYgaXQgaXMgYSBzcGFjZSwgdGhlbiB3ZSBoYXZlIGFuIGVuZCBiZWFtLlxuXHRcdFx0XHRcdFx0XHRpZiAodG9rZW5pemVyLmlzV2hpdGVTcGFjZShsaW5lLmNoYXJBdChpbmRleCArIDEpKSlcblx0XHRcdFx0XHRcdFx0XHRhZGRFbmRCZWFtKGVsKTtcblx0XHRcdFx0XHRcdFx0ZWwuZW5kQ2hhciA9IGluZGV4KzE7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBlbDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2UgaWYgKHN0YXRlID09PSAnYnJva2VuX3JoeXRobScpIHtlbC5lbmRDaGFyID0gaW5kZXg7cmV0dXJuIGVsO31cblx0XHRcdFx0XHRlbHNlIHJldHVybiBudWxsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlICcgJzpcblx0XHRcdFx0Y2FzZSAnXFx0Jzpcblx0XHRcdFx0XHRpZiAoaXNDb21wbGV0ZShzdGF0ZSkpIHtcblx0XHRcdFx0XHRcdGVsLmVuZF9iZWFtID0gdHJ1ZTtcblx0XHRcdFx0XHRcdC8vIGxvb2sgYWhlYWQgdG8gc2VlIGlmIHRoZXJlIGlzIGEgdGllXG5cdFx0XHRcdFx0XHRkbyB7XG5cdFx0XHRcdFx0XHRcdGlmIChsaW5lLmNoYXJBdChpbmRleCkgPT09ICctJylcblx0XHRcdFx0XHRcdFx0XHRlbC5zdGFydFRpZSA9IHt9O1xuXHRcdFx0XHRcdFx0XHRpbmRleCsrO1xuXHRcdFx0XHRcdFx0fSB3aGlsZSAoaW5kZXggPCBsaW5lLmxlbmd0aCAmJiAodG9rZW5pemVyLmlzV2hpdGVTcGFjZShsaW5lLmNoYXJBdChpbmRleCkpIHx8IGxpbmUuY2hhckF0KGluZGV4KSA9PT0gJy0nKSk7XG5cdFx0XHRcdFx0XHRlbC5lbmRDaGFyID0gaW5kZXg7XG5cdFx0XHRcdFx0XHRpZiAoIWR1cmF0aW9uU2V0QnlQcmV2aW91c05vdGUgJiYgY2FuSGF2ZUJyb2tlblJoeXRobSAmJiAobGluZS5jaGFyQXQoaW5kZXgpID09PSAnPCcgfHwgbGluZS5jaGFyQXQoaW5kZXgpID09PSAnPicpKSB7XHQvLyBUT0RPLVBFUjogRG9uJ3QgbmVlZCB0aGUgdGVzdCBmb3IgPCBhbmQgPiwgYnV0IHRoYXQgbWFrZXMgdGhlIGVuZENoYXIgd29yayBvdXQgZm9yIHRoZSByZWdyZXNzaW9uIHRlc3QuXG5cdFx0XHRcdFx0XHRcdGluZGV4LS07XG5cdFx0XHRcdFx0XHRcdHN0YXRlID0gJ2Jyb2tlbl9yaHl0aG0nO1xuXHRcdFx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0XHRcdHJldHVybiBlbDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZSByZXR1cm4gbnVsbDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSAnPic6XG5cdFx0XHRcdGNhc2UgJzwnOlxuXHRcdFx0XHRcdGlmIChpc0NvbXBsZXRlKHN0YXRlKSkge1xuXHRcdFx0XHRcdFx0aWYgKGNhbkhhdmVCcm9rZW5SaHl0aG0pIHtcblx0XHRcdFx0XHRcdFx0dmFyIGJyMiA9IGdldEJyb2tlblJoeXRobShsaW5lLCBpbmRleCk7XG5cdFx0XHRcdFx0XHRcdGluZGV4ICs9IGJyMlswXSAtIDE7XHQvLyBpbmRleCBnZXRzIGluY3JlbWVudGVkIGJlbG93LCBzbyB3ZSdsbCBsZXQgdGhhdCBoYXBwZW5cblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5uZXh0X25vdGVfZHVyYXRpb24gPSBicjJbMl07XG5cdFx0XHRcdFx0XHRcdGVsLmR1cmF0aW9uID0gYnIyWzFdKmVsLmR1cmF0aW9uO1xuXHRcdFx0XHRcdFx0XHRzdGF0ZSA9ICdlbmRfc2x1cic7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRlbC5lbmRDaGFyID0gaW5kZXg7XG5cdFx0XHRcdFx0XHRcdHJldHVybiBlbDtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdGlmIChpc0NvbXBsZXRlKHN0YXRlKSkge1xuXHRcdFx0XHRcdFx0ZWwuZW5kQ2hhciA9IGluZGV4O1xuXHRcdFx0XHRcdFx0cmV0dXJuIGVsO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4gbnVsbDtcblx0XHRcdH1cblx0XHRcdGluZGV4Kys7XG5cdFx0XHRpZiAoaW5kZXggPT09IGxpbmUubGVuZ3RoKSB7XG5cdFx0XHRcdGlmIChpc0NvbXBsZXRlKHN0YXRlKSkge2VsLmVuZENoYXIgPSBpbmRleDtyZXR1cm4gZWw7fVxuXHRcdFx0XHRlbHNlIHJldHVybiBudWxsO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblxuXHRmdW5jdGlvbiBzdGFydE5ld0xpbmUoKSB7XG5cdFx0dmFyIHBhcmFtcyA9IHsgc3RhcnRDaGFyOiAtMSwgZW5kQ2hhcjogLTF9O1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLnBhcnRGb3JOZXh0TGluZS5sZW5ndGgpXG5cdFx0XHRwYXJhbXMucGFydCA9IG11bHRpbGluZVZhcnMucGFydEZvck5leHRMaW5lO1xuXHRcdHBhcmFtcy5jbGVmID0gbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UgJiYgbXVsdGlsaW5lVmFycy5zdGF2ZXNbbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3RhZmZOdW1dLmNsZWYgIT09IHVuZGVmaW5lZCA/IHBhcnNlQ29tbW9uLmNsb25lKG11bHRpbGluZVZhcnMuc3RhdmVzW211bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLnN0YWZmTnVtXS5jbGVmKSA6IHBhcnNlQ29tbW9uLmNsb25lKG11bHRpbGluZVZhcnMuY2xlZik7XG5cdFx0dmFyIHNjb3JlVHJhbnNwb3NlID0gbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UgPyBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zY29yZVRyYW5zcG9zZSA6IDA7XG5cdFx0cGFyYW1zLmtleSA9IHBhcnNlS2V5Vm9pY2Uuc3RhbmRhcmRLZXkobXVsdGlsaW5lVmFycy5rZXkucm9vdCttdWx0aWxpbmVWYXJzLmtleS5hY2MrbXVsdGlsaW5lVmFycy5rZXkubW9kZSwgbXVsdGlsaW5lVmFycy5rZXkucm9vdCwgbXVsdGlsaW5lVmFycy5rZXkuYWNjLCBzY29yZVRyYW5zcG9zZSk7XG5cdFx0cGFyYW1zLmtleS5tb2RlID0gbXVsdGlsaW5lVmFycy5rZXkubW9kZTtcblx0XHRpZiAobXVsdGlsaW5lVmFycy5rZXkuaW1wbGllZE5hdHVyYWxzKVxuXHRcdFx0cGFyYW1zLmtleS5pbXBsaWVkTmF0dXJhbHMgPSBtdWx0aWxpbmVWYXJzLmtleS5pbXBsaWVkTmF0dXJhbHM7XG5cdFx0aWYgKG11bHRpbGluZVZhcnMua2V5LmV4cGxpY2l0QWNjaWRlbnRhbHMpIHtcblx0XHRcdGZvciAodmFyIGkgPSAwOyBpIDwgbXVsdGlsaW5lVmFycy5rZXkuZXhwbGljaXRBY2NpZGVudGFscy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHR2YXIgZm91bmQgPSBmYWxzZTtcblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBwYXJhbXMua2V5LmFjY2lkZW50YWxzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0aWYgKHBhcmFtcy5rZXkuYWNjaWRlbnRhbHNbal0ubm90ZSA9PT0gbXVsdGlsaW5lVmFycy5rZXkuZXhwbGljaXRBY2NpZGVudGFsc1tpXS5ub3RlKSB7XG5cdFx0XHRcdFx0XHQvLyBJZiB0aGUgbm90ZSBpcyBhbHJlYWR5IGluIHRoZSBsaXN0LCBvdmVycmlkZSBpdCB3aXRoIHRoZSBuZXcgdmFsdWVcblx0XHRcdFx0XHRcdHBhcmFtcy5rZXkuYWNjaWRlbnRhbHNbal0uYWNjID0gbXVsdGlsaW5lVmFycy5rZXkuZXhwbGljaXRBY2NpZGVudGFsc1tpXS5hY2M7XG5cdFx0XHRcdFx0XHRmb3VuZCA9IHRydWU7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGlmICghZm91bmQpXG5cdFx0XHRcdFx0cGFyYW1zLmtleS5hY2NpZGVudGFscy5wdXNoKG11bHRpbGluZVZhcnMua2V5LmV4cGxpY2l0QWNjaWRlbnRhbHNbaV0pO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAocGFyYW1zLmtleS5leHBsaWNpdEFjY2lkZW50YWxzKVxuXHRcdFx0ZGVsZXRlIHBhcmFtcy5rZXkuZXhwbGljaXRBY2NpZGVudGFscztcblx0XHRwYXJzZUtleVZvaWNlLmFkZFBvc1RvS2V5KHBhcmFtcy5jbGVmLCBwYXJhbXMua2V5KTtcblx0XHRpZiAobXVsdGlsaW5lVmFycy5tZXRlciAhPT0gbnVsbCkge1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlKSB7XG5cdFx0XHRcdHBhcnNlQ29tbW9uLmVhY2gobXVsdGlsaW5lVmFycy5zdGF2ZXMsIGZ1bmN0aW9uKHN0KSB7XG5cdFx0XHRcdFx0c3QubWV0ZXIgPSBtdWx0aWxpbmVWYXJzLm1ldGVyO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0cGFyYW1zLm1ldGVyID0gbXVsdGlsaW5lVmFycy5zdGF2ZXNbbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3RhZmZOdW1dLm1ldGVyO1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLnN0YXZlc1ttdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZk51bV0ubWV0ZXIgPSBudWxsO1xuXHRcdFx0fSBlbHNlXG5cdFx0XHRcdHBhcmFtcy5tZXRlciA9IG11bHRpbGluZVZhcnMubWV0ZXI7XG5cdFx0XHRtdWx0aWxpbmVWYXJzLm1ldGVyID0gbnVsbDtcblx0XHR9IGVsc2UgaWYgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlICYmIG11bHRpbGluZVZhcnMuc3RhdmVzW211bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLnN0YWZmTnVtXS5tZXRlcikge1xuXHRcdFx0Ly8gTWFrZSBzdXJlIHRoYXQgZWFjaCB2b2ljZSBnZXRzIHRoZSBtZXRlciBtYXJraW5nLlxuXHRcdFx0cGFyYW1zLm1ldGVyID0gbXVsdGlsaW5lVmFycy5zdGF2ZXNbbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3RhZmZOdW1dLm1ldGVyO1xuXHRcdFx0bXVsdGlsaW5lVmFycy5zdGF2ZXNbbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3RhZmZOdW1dLm1ldGVyID0gbnVsbDtcblx0XHR9XG5cdFx0aWYgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlICYmIG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLm5hbWUpXG5cdFx0XHRwYXJhbXMubmFtZSA9IG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLm5hbWU7XG5cdFx0aWYgKG11bHRpbGluZVZhcnMudm9jYWxmb250KVxuXHRcdFx0cGFyYW1zLnZvY2FsZm9udCA9IG11bHRpbGluZVZhcnMudm9jYWxmb250O1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLnRyaXBsZXRmb250KVxuXHRcdFx0cGFyYW1zLnRyaXBsZXRmb250ID0gbXVsdGlsaW5lVmFycy50cmlwbGV0Zm9udDtcblx0XHRpZiAobXVsdGlsaW5lVmFycy5zdHlsZSlcblx0XHRcdHBhcmFtcy5zdHlsZSA9IG11bHRpbGluZVZhcnMuc3R5bGU7XG5cdFx0aWYgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlKSB7XG5cdFx0XHR2YXIgc3RhZmYgPSBtdWx0aWxpbmVWYXJzLnN0YXZlc1ttdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZk51bV07XG5cdFx0XHRpZiAoc3RhZmYuYnJhY2UpIHBhcmFtcy5icmFjZSA9IHN0YWZmLmJyYWNlO1xuXHRcdFx0aWYgKHN0YWZmLmJyYWNrZXQpIHBhcmFtcy5icmFja2V0ID0gc3RhZmYuYnJhY2tldDtcblx0XHRcdGlmIChzdGFmZi5jb25uZWN0QmFyTGluZXMpIHBhcmFtcy5jb25uZWN0QmFyTGluZXMgPSBzdGFmZi5jb25uZWN0QmFyTGluZXM7XG5cdFx0XHRpZiAoc3RhZmYubmFtZSkgcGFyYW1zLm5hbWUgPSBzdGFmZi5uYW1lW211bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLmluZGV4XTtcblx0XHRcdGlmIChzdGFmZi5zdWJuYW1lKSBwYXJhbXMuc3VibmFtZSA9IHN0YWZmLnN1Ym5hbWVbbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UuaW5kZXhdO1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLnN0ZW0pXG5cdFx0XHRcdHBhcmFtcy5zdGVtID0gbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3RlbTtcblx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZmxpbmVzKVxuXHRcdFx0XHRwYXJhbXMuc3RhZmZsaW5lcyA9IG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLnN0YWZmbGluZXM7XG5cdFx0XHRpZiAobXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3RhZmZzY2FsZSlcblx0XHRcdFx0cGFyYW1zLnN0YWZmc2NhbGUgPSBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZnNjYWxlO1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLnNjYWxlKVxuXHRcdFx0XHRwYXJhbXMuc2NhbGUgPSBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zY2FsZTtcblx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdHlsZSlcblx0XHRcdFx0cGFyYW1zLnN0eWxlID0gbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2Uuc3R5bGU7XG5cdFx0XHRpZiAobXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UudHJhbnNwb3NlKVxuXHRcdFx0XHRwYXJhbXMuY2xlZi50cmFuc3Bvc2UgPSBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS50cmFuc3Bvc2U7XG5cdFx0fVxuXHRcdHZhciBpc0ZpcnN0Vm9pY2UgPSBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZSA9PT0gdW5kZWZpbmVkIHx8IChtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZk51bSA9PT0gIDAgJiYgbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UuaW5kZXggPT09ICAwKTtcblx0XHRpZiAobXVsdGlsaW5lVmFycy5iYXJOdW1iZXJzID09PSAwICYmIGlzRmlyc3RWb2ljZSAmJiBtdWx0aWxpbmVWYXJzLmN1cnJCYXJOdW1iZXIgIT09IDEpXG5cdFx0XHRwYXJhbXMuYmFyTnVtYmVyID0gbXVsdGlsaW5lVmFycy5jdXJyQmFyTnVtYmVyO1xuXHRcdHR1bmUuc3RhcnROZXdMaW5lKHBhcmFtcyk7XG5cdFx0aWYgKG11bHRpbGluZVZhcnMua2V5LmltcGxpZWROYXR1cmFscylcblx0XHRcdGRlbGV0ZSBtdWx0aWxpbmVWYXJzLmtleS5pbXBsaWVkTmF0dXJhbHM7XG5cblx0XHRtdWx0aWxpbmVWYXJzLnBhcnRGb3JOZXh0TGluZSA9IFwiXCI7XG5cdH1cblxuXHR2YXIgbGV0dGVyX3RvX2dyYWNlID0gIGZ1bmN0aW9uKGxpbmUsIGkpIHtcblx0XHQvLyBHcmFjZSBub3RlcyBhcmUgYW4gYXJyYXkgb2Y6IHN0YXJ0c2x1ciwgbm90ZSwgZW5kc2x1ciwgc3BhY2U7IHdoZXJlIG5vdGUgaXMgYWNjaWRlbnRhbCwgcGl0Y2gsIGR1cmF0aW9uXG5cdFx0aWYgKGxpbmUuY2hhckF0KGkpID09PSAneycpIHtcblx0XHRcdC8vIGZldGNoIHRoZSBncmFjZW5vdGVzIHN0cmluZyBhbmQgY29uc3VtZSB0aGF0IGludG8gdGhlIGFycmF5XG5cdFx0XHR2YXIgZ3JhID0gdG9rZW5pemVyLmdldEJyYWNrZXR0ZWRTdWJzdHJpbmcobGluZSwgaSwgMSwgJ30nKTtcblx0XHRcdGlmICghZ3JhWzJdKVxuXHRcdFx0XHR3YXJuKFwiTWlzc2luZyB0aGUgY2xvc2luZyAnfScgd2hpbGUgcGFyc2luZyBncmFjZSBub3RlXCIsIGxpbmUsIGkpO1xuXHRcdFx0Ly8gSWYgdGhlcmUgaXMgYSBzbHVyIGFmdGVyIHRoZSBncmFjZSBjb25zdHJ1Y3Rpb24sIHRoZW4gbW92ZSBpdCB0byB0aGUgbGFzdCBub3RlIGluc2lkZSB0aGUgZ3JhY2UgY29uc3RydWN0aW9uXG5cdFx0XHRpZiAobGluZVtpK2dyYVswXV0gPT09ICcpJykge1xuXHRcdFx0XHRncmFbMF0rKztcblx0XHRcdFx0Z3JhWzFdICs9ICcpJztcblx0XHRcdH1cblxuXHRcdFx0dmFyIGdyYWNlbm90ZXMgPSBbXTtcblx0XHRcdHZhciBpaSA9IDA7XG5cdFx0XHR2YXIgaW5UaWUgPSBmYWxzZTtcblx0XHRcdHdoaWxlIChpaSA8IGdyYVsxXS5sZW5ndGgpIHtcblx0XHRcdFx0dmFyIGFjY2lhY2NhdHVyYSA9IGZhbHNlO1xuXHRcdFx0XHRpZiAoZ3JhWzFdLmNoYXJBdChpaSkgPT09ICcvJykge1xuXHRcdFx0XHRcdGFjY2lhY2NhdHVyYSA9IHRydWU7XG5cdFx0XHRcdFx0aWkrKztcblx0XHRcdFx0fVxuXHRcdFx0XHR2YXIgbm90ZSA9IGdldENvcmVOb3RlKGdyYVsxXSwgaWksIHt9LCBmYWxzZSk7XG5cdFx0XHRcdGlmIChub3RlICE9PSBudWxsKSB7XG5cdFx0XHRcdFx0Ly8gVGhlIGdyYWNlIG5vdGUgZHVyYXRpb25zIHNob3VsZCBub3QgYmUgYWZmZWN0ZWQgYnkgdGhlIGRlZmF1bHQgbGVuZ3RoOiB0aGV5IHNob3VsZCBiZSBiYXNlZCBvbiAxLzE2LCBzbyBpZiB0aGF0IGlzbid0IHRoZSBkZWZhdWx0LCB0aGVuIG11bHRpcGx5IGhlcmUuXG5cdFx0XHRcdFx0bm90ZS5kdXJhdGlvbiA9IG5vdGUuZHVyYXRpb24gLyAobXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCAqIDgpO1xuXHRcdFx0XHRcdGlmIChhY2NpYWNjYXR1cmEpXG5cdFx0XHRcdFx0XHRub3RlLmFjY2lhY2NhdHVyYSA9IHRydWU7XG5cdFx0XHRcdFx0Z3JhY2Vub3Rlcy5wdXNoKG5vdGUpO1xuXG5cdFx0XHRcdFx0aWYgKGluVGllKSB7XG5cdFx0XHRcdFx0XHRub3RlLmVuZFRpZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRpblRpZSA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAobm90ZS5zdGFydFRpZSlcblx0XHRcdFx0XHRcdGluVGllID0gdHJ1ZTtcblxuXHRcdFx0XHRcdGlpICA9IG5vdGUuZW5kQ2hhcjtcblx0XHRcdFx0XHRkZWxldGUgbm90ZS5lbmRDaGFyO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdC8vIFdlIHNob3VsZG4ndCBnZXQgYW55dGhpbmcgYnV0IG5vdGVzIG9yIGEgc3BhY2UgaGVyZSwgc28gcmVwb3J0IGFuIGVycm9yXG5cdFx0XHRcdFx0aWYgKGdyYVsxXS5jaGFyQXQoaWkpID09PSAnICcpIHtcblx0XHRcdFx0XHRcdGlmIChncmFjZW5vdGVzLmxlbmd0aCA+IDApXG5cdFx0XHRcdFx0XHRcdGdyYWNlbm90ZXNbZ3JhY2Vub3Rlcy5sZW5ndGgtMV0uZW5kX2JlYW0gPSB0cnVlO1xuXHRcdFx0XHRcdH0gZWxzZVxuXHRcdFx0XHRcdFx0d2FybihcIlVua25vd24gY2hhcmFjdGVyICdcIiArIGdyYVsxXS5jaGFyQXQoaWkpICsgXCInIHdoaWxlIHBhcnNpbmcgZ3JhY2Ugbm90ZVwiLCBsaW5lLCBpKTtcblx0XHRcdFx0XHRpaSsrO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAoZ3JhY2Vub3Rlcy5sZW5ndGgpXG5cdFx0XHRcdHJldHVybiBbZ3JhWzBdLCBncmFjZW5vdGVzXTtcblx0XHR9XG5cdFx0cmV0dXJuIFsgMCBdO1xuXHR9O1xuXG5cdGZ1bmN0aW9uIGxldHRlcl90b19vdmVybGF5KGxpbmUsIGkpIHtcblx0XHRpZiAobGluZS5jaGFyQXQoaSkgPT09ICcmJykge1xuXHRcdFx0dmFyIHN0YXJ0ID0gaTtcblx0XHRcdHdoaWxlIChsaW5lLmNoYXJBdChpKSAmJiBsaW5lLmNoYXJBdChpKSAhPT0gJzonICYmIGxpbmUuY2hhckF0KGkpICE9PSAnfCcpXG5cdFx0XHRcdGkrKztcblx0XHRcdHJldHVybiBbIGktc3RhcnQsIGxpbmUuc3Vic3RyaW5nKHN0YXJ0KzEsIGkpIF07XG5cdFx0fVxuXHRcdHJldHVybiBbIDAgXTtcblx0fVxuXG5cdGZ1bmN0aW9uIGR1cmF0aW9uT2ZNZWFzdXJlKG11bHRpbGluZVZhcnMpIHtcblx0XHQvLyBUT0RPLVBFUjogVGhpcyBjb3VsZCBiZSBtb3JlIGNvbXBsaWNhdGVkIGlmIG9uZSBvZiB0aGUgdW51c3VhbCBtZWFzdXJlcyBpcyB1c2VkLlxuXHRcdHZhciBtZXRlciA9IG11bHRpbGluZVZhcnMub3JpZ01ldGVyO1xuXHRcdGlmICghbWV0ZXIgfHwgbWV0ZXIudHlwZSAhPT0gJ3NwZWNpZmllZCcpXG5cdFx0XHRyZXR1cm4gMTtcblx0XHRpZiAoIW1ldGVyLnZhbHVlIHx8IG1ldGVyLnZhbHVlLmxlbmd0aCA9PT0gMClcblx0XHRcdHJldHVybiAxO1xuXHRcdHJldHVybiBwYXJzZUludChtZXRlci52YWx1ZVswXS5udW0sIDEwKSAvIHBhcnNlSW50KG1ldGVyLnZhbHVlWzBdLmRlbiwgMTApO1xuXHR9XG5cblx0Ly9cblx0Ly8gUGFyc2UgbGluZSBvZiBtdXNpY1xuXHQvL1xuXHQvLyBUaGlzIGlzIGEgc3RyZWFtIG9mIDwoYmFyLW1hcmtpbmd8aGVhZGVyfG5vdGUtZ3JvdXApLi4uPiBpbiBhbnkgb3JkZXIsIHdpdGggb3B0aW9uYWwgc3BhY2VzIGJldHdlZW4gZWFjaCBlbGVtZW50XG5cdC8vIGNvcmUtbm90ZSBpcyA8b3Blbi1zbHVyLCBhY2NpZGVudGFsLCBwaXRjaDpyZXF1aXJlZCwgb2N0YXZlLCBkdXJhdGlvbiwgY2xvc2Utc2x1ciZ8dGllPiB3aXRoIG5vIHNwYWNlcyB3aXRoaW4gdGhhdFxuXHQvLyBjaG9yZCBpcyA8b3Blbi1icmFja2V0OnJlcXVpcmVkLCBjb3JlLW5vdGU6cmVxdWlyZWQuLi4gY2xvc2UtYnJhY2tldDpyZXF1aXJlZCBkdXJhdGlvbj4gd2l0aCBubyBzcGFjZXMgd2l0aGluIHRoYXRcblx0Ly8gZ3JhY2Utbm90ZXMgaXMgPG9wZW4tYnJhY2U6cmVxdWlyZWQsIChvcGVuLXNsdXJ8Y29yZS1ub3RlOnJlcXVpcmVkfGNsb3NlLXNsdXIpLi4uLCBjbG9zZS1icmFjZTpyZXF1aXJlZD4gc3BhY2VzIGFyZSBhbGxvd2VkXG5cdC8vIG5vdGUtZ3JvdXAgaXMgPGdyYWNlLW5vdGVzLCBjaG9yZCBzeW1ib2xzJnxkZWNvcmF0aW9ucy4uLiwgZ3JhY2Utbm90ZXMsIHNsdXImfHRyaXBsZXQsIGNob3JkfGNvcmUtbm90ZSwgZW5kLXNsdXJ8dGllPiBzcGFjZXMgYXJlIGFsbG93ZWQgYmV0d2VlbiBpdGVtc1xuXHQvLyBiYXItbWFya2luZyBpcyA8YW1wZXJzYW5kPiBvciA8Y2hvcmQgc3ltYm9scyZ8ZGVjb3JhdGlvbnMuLi4sIGJhcjpyZXF1aXJlZD4gc3BhY2VzIGFsbG93ZWRcblx0Ly8gaGVhZGVyIGlzIDxvcGVuLWJyYWNrZXQ6cmVxdWlyZWQsIEt8TXxMfFY6cmVxdWlyZWQsIGNvbG9uOnJlcXVpcmVkLCBmaWVsZDpyZXF1aXJlZCwgY2xvc2UtYnJhY2tldDpyZXF1aXJlZD4gc3BhY2VzIGNhbiBvY2N1ciBiZXR3ZWVuIHRoZSBjb2xvbiwgaW4gdGhlIGZpZWxkLCBhbmQgYmVmb3JlIHRoZSBjbG9zZSBicmFja2V0XG5cdC8vIGhlYWRlciBjYW4gYWxzbyBiZSB0aGUgb25seSB0aGluZyBvbiBhIGxpbmUuIFRoaXMgaXMgdHJ1ZSBldmVuIGlmIGl0IGlzIGEgY29udGludWF0aW9uIGxpbmUuIEluIHRoaXMgY2FzZSB0aGUgYnJhY2tldHMgYXJlIG5vdCByZXF1aXJlZC5cblx0Ly8gYSBzcGFjZSBpcyBhIGJhY2stdGljaywgYSBzcGFjZSwgb3IgYSB0YWIuIElmIGl0IGlzIGEgYmFjay10aWNrLCB0aGVuIHRoZXJlIGlzIG5vIGVuZC1iZWFtLlxuXG5cdC8vIExpbmUgcHJlcHJvY2Vzc2luZzogYW55dGhpbmcgYWZ0ZXIgYSAlIGlzIGlnbm9yZWQgKHRoZSBkb3VibGUgJSUgc2hvdWxkIGhhdmUgYmVlbiB0YWtlbiBjYXJlIG9mIGJlZm9yZSB0aGlzKVxuXHQvLyBUaGVuLCBhbGwgbGVhZGluZyBhbmQgdHJhaWxpbmcgc3BhY2VzIGFyZSBpZ25vcmVkLlxuXHQvLyBJZiB0aGVyZSB3YXMgYSBsaW5lIGNvbnRpbnVhdGlvbiwgdGhlIFxcbiB3YXMgcmVwbGFjZWQgYnkgYSBcXHIgYW5kIHRoZSBcXCB3YXMgcmVwbGFjZWQgYnkgYSBzcGFjZS4gVGhpcyBhbGxvd3MgdGhlIGNvbnN0cnVjdFxuXHQvLyBvZiBoYXZpbmcgYSBoZWFkZXIgbWlkLWxpbmUgY29uY2VwdHVhbGx5LCBidXQgYWN0dWFsbHkgYmUgYXQgdGhlIHN0YXJ0IG9mIHRoZSBsaW5lLiBUaGlzIGlzIGVxdWl2b2xlbnQgdG8gcHV0dGluZyB0aGUgaGVhZGVyIGluIFsgXS5cblxuXHQvLyBUT0RPLVBFUjogSG93IHRvIGhhbmRsZSAhIGZvciBsaW5lIGJyZWFrP1xuXHQvLyBUT0RPLVBFUjogZG90cyBiZWZvcmUgYmFyLCBkb3RzIGJlZm9yZSBzbHVyXG5cdC8vIFRPRE8tUEVSOiBVOiByZWRlZmluYWJsZSBzeW1ib2xzLlxuXG5cdC8vIEFtYmlndW91cyBzeW1ib2xzOlxuXHQvLyBcIltcIiBjYW4gYmUgdGhlIHN0YXJ0IG9mIGEgY2hvcmQsIHRoZSBzdGFydCBvZiBhIGhlYWRlciBlbGVtZW50IG9yIHBhcnQgb2YgYSBiYXIgbGluZS5cblx0Ly8gLS0tIGlmIGl0IGlzIGltbWVkaWF0ZWx5IGZvbGxvd2VkIGJ5IFwifFwiLCBpdCBpcyBhIGJhciBsaW5lXG5cdC8vIC0tLSBpZiBpdCBpcyBpbW1lZGlhdGVseSBmb2xsb3dlZCBieSBLOiBMOiBNOiBWOiBpdCBpcyBhIGhlYWRlciAobm90ZTogdGhlcmUgYXJlIG90aGVyIGhlYWRlcnMgbWVudGlvbmVkIGluIHRoZSBzdGFuZGFyZCwgYnV0IEknbSBub3Qgc3VyZSBob3cgdGhleSB3b3VsZCBiZSB1c2VkLilcblx0Ly8gLS0tIG90aGVyd2lzZSBpdCBpcyB0aGUgYmVnaW5uaW5nIG9mIGEgY2hvcmRcblx0Ly8gXCIoXCIgY2FuIGJlIHRoZSBzdGFydCBvZiBhIHNsdXIgb3IgYSB0cmlwbGV0XG5cdC8vIC0tLSBpZiBpdCBpcyBmb2xsb3dlZCBieSBhIG51bWJlciBmcm9tIDItOSwgdGhlbiBpdCBpcyBhIHRyaXBsZXRcblx0Ly8gLS0tIG90aGVyd2lzZSBpdCBpcyBhIHNsdXJcblx0Ly8gXCJdXCJcblx0Ly8gLS0tIGlmIHRoZXJlIGlzIGEgY2hvcmQgb3BlbiwgdGhlbiB0aGlzIGlzIHRoZSBjbG9zZVxuXHQvLyAtLS0gaWYgaXQgaXMgYWZ0ZXIgYSBbfCwgdGhlbiBpdCBpcyBhbiBpbnZpc2libGUgYmFyIGxpbmVcblx0Ly8gLS0tIG90aGVyd2lzZSwgaXQgaXMgcGFyIG9mIGEgYmFyXG5cdC8vIFwiLlwiIGNhbiBiZSBhIGJhciBtb2RpZmllciBvciBhIHNsdXIgbW9kaWZpZXIsIG9yIGEgZGVjb3JhdGlvblxuXHQvLyAtLS0gaWYgaXQgY29tZXMgaW1tZWRpYXRlbHkgYmVmb3JlIGEgYmFyLCBpdCBpcyBhIGJhciBtb2RpZmllclxuXHQvLyAtLS0gaWYgaXQgY29tZXMgaW1tZWRpYXRlbHkgYmVmb3JlIGEgc2x1ciwgaXQgaXMgYSBzbHVyIG1vZGlmaWVyXG5cdC8vIC0tLSBvdGhlcndpc2UgaXQgaXMgYSBkZWNvcmF0aW9uIGZvciB0aGUgbmV4dCBub3RlLlxuXHQvLyBudW1iZXI6XG5cdC8vIC0tLSBpZiBpdCBpcyBhZnRlciBhIGJhciwgd2l0aCBubyBzcGFjZSwgaXQgaXMgYW4gZW5kaW5nIG1hcmtlclxuXHQvLyAtLS0gaWYgaXQgaXMgYWZ0ZXIgYSAoIHdpdGggbm8gc3BhY2UsIGl0IGlzIGEgdHJpcGxldCBjb3VudFxuXHQvLyAtLS0gaWYgaXQgaXMgYWZ0ZXIgYSBwaXRjaCBvciBvY3RhdmUgb3Igc2xhc2gsIHRoZW4gaXQgaXMgYSBkdXJhdGlvblxuXG5cdC8vIFVuYW1iaWd1b3VzIHN5bWJvbHMgKGV4Y2VwdCBpbnNpZGUgcXVvdGVkIHN0cmluZ3MpOlxuXHQvLyB2ZXJ0aWNhbC1iYXIsIGNvbG9uOiBwYXJ0IG9mIGEgYmFyXG5cdC8vIEFCQ0RFRkdhYmNkZWZnOiBwaXRjaFxuXHQvLyB4eXpaOiByZXN0XG5cdC8vIGNvbW1hLCBwcmltZTogb2N0YXZlXG5cdC8vIGNsb3NlLXBhcmVuOiBlbmQtc2x1clxuXHQvLyBoeXBoZW46IHRpZVxuXHQvLyB0aWxkZSwgdiwgdSwgYmFuZywgcGx1cywgVEhMTVBTTzogZGVjb3JhdGlvblxuXHQvLyBjYXJhdCwgdW5kZXJzY29yZSwgZXF1YWw6IGFjY2lkZW50YWxcblx0Ly8gYW1wZXJzYW5kOiB0aW1lIHJlc2V0XG5cdC8vIG9wZW4tY3VybHksIGNsb3NlLWN1cmx5OiBncmFjZSBub3Rlc1xuXHQvLyBkb3VibGUtcXVvdGU6IGNob3JkIHN5bWJvbFxuXHQvLyBsZXNzLXRoYW4sIGdyZWF0ZXItdGhhbiwgc2xhc2g6IGR1cmF0aW9uXG5cdC8vIGJhY2stdGljaywgc3BhY2UsIHRhYjogc3BhY2Vcblx0dmFyIG5vbkRlY29yYXRpb25zID0gXCJBQkNERUZHYWJjZGVmZ3h5elpbXXxeX3tcIjtcdC8vIHVzZSB0aGlzIHRvIHByZXNjcmVlbiBzbyB3ZSBkb24ndCBoYXZlIHRvIGxvb2sgZm9yIGEgZGVjb3JhdGlvbiBhdCBldmVyeSBub3RlLlxuXG5cdHZhciBwYXJzZVJlZ3VsYXJNdXNpY0xpbmUgPSBmdW5jdGlvbihsaW5lKSB7XG5cdFx0aGVhZGVyLnJlc29sdmVUZW1wbygpO1xuXHRcdC8vbXVsdGlsaW5lVmFycy5oYXZlbnRfc2V0X2xlbmd0aCA9IGZhbHNlO1x0Ly8gVG8gbGF0ZSB0byBzZXQgdGhpcyBub3cuXG5cdFx0bXVsdGlsaW5lVmFycy5pc19pbl9oZWFkZXIgPSBmYWxzZTtcdC8vIFdlIHNob3VsZCBoYXZlIGdvdHRlbiBhIGtleSBoZWFkZXIgYnkgbm93LCBidXQganVzdCBpbiBjYXNlLCB0aGlzIGlzIGRlZmluaXRlbHkgb3V0IG9mIHRoZSBoZWFkZXIuXG5cdFx0dmFyIGkgPSAwO1xuXHRcdHZhciBzdGFydE9mTGluZSA9IG11bHRpbGluZVZhcnMuaUNoYXI7XG5cdFx0Ly8gc2VlIGlmIHRoZXJlIGlzIG5vdGhpbmcgYnV0IGEgY29tbWVudCBvbiB0aGlzIGxpbmUuIElmIHNvLCBqdXN0IGlnbm9yZSBpdC4gQSBmdWxsIGxpbmUgY29tbWVudCBpcyBvcHRpb25hbCB3aGl0ZSBzcGFjZSBmb2xsb3dlZCBieSAlXG5cdFx0d2hpbGUgKHRva2VuaXplci5pc1doaXRlU3BhY2UobGluZS5jaGFyQXQoaSkpICYmIGkgPCBsaW5lLmxlbmd0aClcblx0XHRcdGkrKztcblx0XHRpZiAoaSA9PT0gbGluZS5sZW5ndGggfHwgbGluZS5jaGFyQXQoaSkgPT09ICclJylcblx0XHRcdHJldHVybjtcblxuXHRcdC8vIFN0YXJ0IHdpdGggdGhlIHN0YW5kYXJkIHN0YWZmLCBjbGVmIGFuZCBrZXkgc3ltYm9scyBvbiBlYWNoIGxpbmVcblx0XHR2YXIgZGVsYXlTdGFydE5ld0xpbmUgPSBtdWx0aWxpbmVWYXJzLnN0YXJ0X25ld19saW5lO1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLmNvbnRpbnVlYWxsID09PSB1bmRlZmluZWQpXG5cdFx0XHRtdWx0aWxpbmVWYXJzLnN0YXJ0X25ld19saW5lID0gdHJ1ZTtcblx0XHRlbHNlXG5cdFx0XHRtdWx0aWxpbmVWYXJzLnN0YXJ0X25ld19saW5lID0gZmFsc2U7XG5cdFx0dmFyIHRyaXBsZXROb3Rlc0xlZnQgPSAwO1xuXG5cdFx0Ly8gU2VlIGlmIHRoZSBsaW5lIHN0YXJ0cyB3aXRoIGEgaGVhZGVyIGZpZWxkXG5cdFx0dmFyIHJldEhlYWRlciA9IGhlYWRlci5sZXR0ZXJfdG9fYm9keV9oZWFkZXIobGluZSwgaSk7XG5cdFx0aWYgKHJldEhlYWRlclswXSA+IDApIHtcblx0XHRcdGkgKz0gcmV0SGVhZGVyWzBdO1xuXHRcdFx0aWYgKHJldEhlYWRlclsxXSA9PT0gJ1YnKVxuXHRcdFx0XHRkZWxheVN0YXJ0TmV3TGluZSA9IHRydWU7IC8vIGZpeGVzIGJ1ZyBvbiB0aGlzOiBjW1Y6Ml1kXG5cdFx0XHQvLyBUT0RPLVBFUjogSGFuZGxlIGlubGluZSBoZWFkZXJzXG5cdFx0fVxuXHRcdHZhciBlbCA9IHsgfTtcblxuXHRcdHdoaWxlIChpIDwgbGluZS5sZW5ndGgpXG5cdFx0e1xuXHRcdFx0dmFyIHN0YXJ0SSA9IGk7XG5cdFx0XHRpZiAobGluZS5jaGFyQXQoaSkgPT09ICclJylcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdHZhciByZXRJbmxpbmVIZWFkZXIgPSBoZWFkZXIubGV0dGVyX3RvX2lubGluZV9oZWFkZXIobGluZSwgaSk7XG5cdFx0XHRpZiAocmV0SW5saW5lSGVhZGVyWzBdID4gMCkge1xuXHRcdFx0XHRcdGkgKz0gcmV0SW5saW5lSGVhZGVyWzBdO1xuXHRcdFx0XHRcdGlmIChyZXRJbmxpbmVIZWFkZXJbMV0gPT09ICdWJylcblx0XHRcdFx0XHRcdGRlbGF5U3RhcnROZXdMaW5lID0gdHJ1ZTsgLy8gZml4ZXMgYnVnIG9uIHRoaXM6IGNbVjoyXWRcblx0XHRcdFx0XHQvLyBUT0RPLVBFUjogSGFuZGxlIGlubGluZSBoZWFkZXJzXG5cdFx0XHRcdFx0Ly9tdWx0aWxpbmVWYXJzLnN0YXJ0X25ld19saW5lID0gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQvLyBXYWl0IHVudGlsIGhlcmUgdG8gYWN0dWFsbHkgc3RhcnQgdGhlIGxpbmUgYmVjYXVzZSB3ZSBrbm93IHdlJ3JlIHBhc3QgdGhlIGlubGluZSBzdGF0ZW1lbnRzLlxuXHRcdFx0XHRpZiAoZGVsYXlTdGFydE5ld0xpbmUpIHtcblx0XHRcdFx0XHRzdGFydE5ld0xpbmUoKTtcblx0XHRcdFx0XHRkZWxheVN0YXJ0TmV3TGluZSA9IGZhbHNlO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0Ly8gV2UgbmVlZCB0byBkZWNpZGUgaWYgdGhlIGZvbGxvd2luZyBjaGFyYWN0ZXJzIGFyZSBhIGJhci1tYXJraW5nIG9yIGEgbm90ZS1ncm91cC5cblx0XHRcdFx0Ly8gVW5mb3J0dW5hdGVseSwgdGhhdCBpcyBhbWJpZ3VvdXMuIEJvdGggY2FuIGNvbnRhaW4gY2hvcmQgc3ltYm9scyBhbmQgZGVjb3JhdGlvbnMuXG5cdFx0XHRcdC8vIElmIHRoZXJlIGlzIGEgZ3JhY2Ugbm90ZSBlaXRoZXIgYmVmb3JlIG9yIGFmdGVyIHRoZSBjaG9yZCBzeW1ib2xzIGFuZCBkZWNvcmF0aW9ucywgdGhlbiBpdCBpcyBkZWZpbml0ZWx5IGEgbm90ZS1ncm91cC5cblx0XHRcdFx0Ly8gSWYgdGhlcmUgaXMgYSBiYXIgbWFya2VyLCBpdCBpcyBkZWZpbml0ZWx5IGEgYmFyLW1hcmtpbmcuXG5cdFx0XHRcdC8vIElmIHRoZXJlIGlzIGVpdGhlciBhIGNvcmUtbm90ZSBvciBjaG9yZCwgaXQgaXMgZGVmaW5pdGVseSBhIG5vdGUtZ3JvdXAuXG5cdFx0XHRcdC8vIFNvLCBsb29wIHdoaWxlIHdlIGZpbmQgZ3JhY2Utbm90ZXMsIGNob3Jkcy1zeW1ib2xzLCBvciBkZWNvcmF0aW9ucy4gW0l0IGlzIGFuIGVycm9yIHRvIGhhdmUgbW9yZSB0aGFuIG9uZSBncmFjZS1ub3RlIGdyb3VwIGluIGEgcm93OyB0aGUgb3RoZXJzIGNhbiBiZSBtdWx0aXBsZV1cblx0XHRcdFx0Ly8gVGhlbiwgaWYgdGhlcmUgaXMgYSBncmFjZS1ub3RlLCB3ZSBrbm93IHdoZXJlIHRvIGdvLlxuXHRcdFx0XHQvLyBFbHNlIHNlZSBpZiB3ZSBoYXZlIGEgY2hvcmQsIGNvcmUtbm90ZSwgc2x1ciwgdHJpcGxldCwgb3IgYmFyLlxuXG5cdFx0XHRcdHZhciByZXQ7XG5cdFx0XHRcdHdoaWxlICgxKSB7XG5cdFx0XHRcdFx0cmV0ID0gdG9rZW5pemVyLmVhdFdoaXRlU3BhY2UobGluZSwgaSk7XG5cdFx0XHRcdFx0aWYgKHJldCA+IDApIHtcblx0XHRcdFx0XHRcdGkgKz0gcmV0O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoaSA+IDAgJiYgbGluZS5jaGFyQXQoaS0xKSA9PT0gJ1xceDEyJykge1xuXHRcdFx0XHRcdFx0Ly8gdGhlcmUgaXMgb25lIGNhc2Ugd2hlcmUgYSBsaW5lIGNvbnRpbnVhdGlvbiBpc24ndCB0aGUgc2FtZSBhcyBiZWluZyBvbiB0aGUgc2FtZSBsaW5lLCBhbmQgdGhhdCBpcyBpZiB0aGUgbmV4dCBjaGFyYWN0ZXIgYWZ0ZXIgaXQgaXMgYSBoZWFkZXIuXG5cdFx0XHRcdFx0XHRyZXQgPSBoZWFkZXIubGV0dGVyX3RvX2JvZHlfaGVhZGVyKGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0aWYgKHJldFswXSA+IDApIHtcblx0XHRcdFx0XHRcdFx0aWYgKHJldFsxXSA9PT0gJ1YnKVxuXHRcdFx0XHRcdFx0XHRcdHN0YXJ0TmV3TGluZSgpOyAvLyBmaXhlcyBidWcgb24gdGhpczogY1xcXFxuVjoyXVxcXFxuZFxuXHRcdFx0XHRcdFx0XHQvLyBUT0RPOiBpbnNlcnQgaGVhZGVyIGhlcmVcblx0XHRcdFx0XHRcdFx0aSA9IHJldFswXTtcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5zdGFydF9uZXdfbGluZSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHQvLyBnYXRoZXIgYWxsIHRoZSBncmFjZSBub3RlcywgY2hvcmQgc3ltYm9scyBhbmQgZGVjb3JhdGlvbnNcblx0XHRcdFx0XHRyZXQgPSBsZXR0ZXJfdG9fc3BhY2VyKGxpbmUsIGkpO1xuXHRcdFx0XHRcdGlmIChyZXRbMF0gPiAwKSB7XG5cdFx0XHRcdFx0XHRpICs9IHJldFswXTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXQgPSBsZXR0ZXJfdG9fb3ZlcmxheShsaW5lLCBpKTtcblx0XHRcdFx0XHRpZiAocmV0WzBdID4gMCkge1xuXHRcdFx0XHRcdFx0dHVuZS5hcHBlbmRFbGVtZW50KCdvdmVybGF5Jywgc3RhcnRPZkxpbmUsIHN0YXJ0T2ZMaW5lKzEsIHt9KTtcblx0XHRcdFx0XHRcdGkgKz0gMTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRyZXQgPSBsZXR0ZXJfdG9fY2hvcmQobGluZSwgaSk7XG5cdFx0XHRcdFx0aWYgKHJldFswXSA+IDApIHtcblx0XHRcdFx0XHRcdC8vIFRoZXJlIGNvdWxkIGJlIG1vcmUgdGhhbiBvbmUgY2hvcmQgaGVyZSBpZiB0aGV5IGhhdmUgZGlmZmVyZW50IHBvc2l0aW9ucy5cblx0XHRcdFx0XHRcdC8vIElmIHR3byBjaG9yZHMgaGF2ZSB0aGUgc2FtZSBwb3NpdGlvbiwgdGhlbiBjb25uZWN0IHRoZW0gd2l0aCBuZXdsaW5lLlxuXHRcdFx0XHRcdFx0aWYgKCFlbC5jaG9yZClcblx0XHRcdFx0XHRcdFx0ZWwuY2hvcmQgPSBbXTtcblx0XHRcdFx0XHRcdHZhciBjaG9yZE5hbWUgPSB0b2tlbml6ZXIudHJhbnNsYXRlU3RyaW5nKHJldFsxXSk7XG5cdFx0XHRcdFx0XHRjaG9yZE5hbWUgPSBjaG9yZE5hbWUucmVwbGFjZSgvOy9nLCBcIlxcblwiKTtcblx0XHRcdFx0XHRcdHZhciBhZGRlZENob3JkID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBjaSA9IDA7IGNpIDwgZWwuY2hvcmQubGVuZ3RoOyBjaSsrKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChlbC5jaG9yZFtjaV0ucG9zaXRpb24gPT09IHJldFsyXSkge1xuXHRcdFx0XHRcdFx0XHRcdGFkZGVkQ2hvcmQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdGVsLmNob3JkW2NpXS5uYW1lICs9IFwiXFxuXCIgKyBjaG9yZE5hbWU7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmIChhZGRlZENob3JkID09PSBmYWxzZSkge1xuXHRcdFx0XHRcdFx0XHRpZiAocmV0WzJdID09PSBudWxsICYmIHJldFszXSlcblx0XHRcdFx0XHRcdFx0XHRlbC5jaG9yZC5wdXNoKHtuYW1lOiBjaG9yZE5hbWUsIHJlbF9wb3NpdGlvbjogcmV0WzNdfSk7XG5cdFx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0XHRlbC5jaG9yZC5wdXNoKHtuYW1lOiBjaG9yZE5hbWUsIHBvc2l0aW9uOiByZXRbMl19KTtcblx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0aSArPSByZXRbMF07XG5cdFx0XHRcdFx0XHR2YXIgaWkgPSB0b2tlbml6ZXIuc2tpcFdoaXRlU3BhY2UobGluZS5zdWJzdHJpbmcoaSkpO1xuXHRcdFx0XHRcdFx0aWYgKGlpID4gMClcblx0XHRcdFx0XHRcdFx0ZWwuZm9yY2VfZW5kX2JlYW1fbGFzdCA9IHRydWU7XG5cdFx0XHRcdFx0XHRpICs9IGlpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAobm9uRGVjb3JhdGlvbnMuaW5kZXhPZihsaW5lLmNoYXJBdChpKSkgPT09IC0xKVxuXHRcdFx0XHRcdFx0XHRyZXQgPSBsZXR0ZXJfdG9fYWNjZW50KGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0ZWxzZSByZXQgPSBbIDAgXTtcblx0XHRcdFx0XHRcdGlmIChyZXRbMF0gPiAwKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChyZXRbMV0gPT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0XHRpZiAoaSArIDEgPCBsaW5lLmxlbmd0aClcblx0XHRcdFx0XHRcdFx0XHRcdHN0YXJ0TmV3TGluZSgpO1x0Ly8gVGhlcmUgd2FzIGEgISBpbiB0aGUgbWlkZGxlIG9mIHRoZSBsaW5lLiBTdGFydCBhIG5ldyBsaW5lIGlmIHRoZXJlIGlzIGFueXRoaW5nIGFmdGVyIGl0LlxuXHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKHJldFsxXS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHJldFsxXS5pbmRleE9mKFwic3R5bGU9XCIpID09PSAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlbC5zdHlsZSA9IHJldFsxXS5zdWJzdHIoNik7XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChlbC5kZWNvcmF0aW9uID09PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVsLmRlY29yYXRpb24gPSBbXTtcblx0XHRcdFx0XHRcdFx0XHRcdGVsLmRlY29yYXRpb24ucHVzaChyZXRbMV0pO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRpICs9IHJldFswXTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHJldCA9IGxldHRlcl90b19ncmFjZShsaW5lLCBpKTtcblx0XHRcdFx0XHRcdFx0Ly8gVE9ETy1QRVI6IEJlIHN1cmUgdGhlcmUgYXJlbid0IGFscmVhZHkgZ3JhY2Ugbm90ZXMgZGVmaW5lZC4gVGhhdCBpcyBhbiBlcnJvci5cblx0XHRcdFx0XHRcdFx0aWYgKHJldFswXSA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHRlbC5ncmFjZW5vdGVzID0gcmV0WzFdO1xuXHRcdFx0XHRcdFx0XHRcdGkgKz0gcmV0WzBdO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblxuXHRcdFx0XHRyZXQgPSBsZXR0ZXJfdG9fYmFyKGxpbmUsIGkpO1xuXHRcdFx0XHRpZiAocmV0WzBdID4gMCkge1xuXHRcdFx0XHRcdC8vIFRoaXMgaXMgZGVmaW5pdGVseSBhIGJhclxuXHRcdFx0XHRcdGlmIChlbC5ncmFjZW5vdGVzICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdC8vIEF0dGFjaCB0aGUgZ3JhY2Ugbm90ZSB0byBhbiBpbnZpc2libGUgbm90ZVxuXHRcdFx0XHRcdFx0ZWwucmVzdCA9IHsgdHlwZTogJ3NwYWNlcicgfTtcblx0XHRcdFx0XHRcdGVsLmR1cmF0aW9uID0gMC4xMjU7IC8vIFRPRE8tUEVSOiBJIGRvbid0IHRoaW5rIHRoZSBkdXJhdGlvbiBvZiB0aGlzIG1hdHRlcnMgbXVjaCwgYnV0IGZpZ3VyZSBvdXQgaWYgaXQgZG9lcy5cblx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuYWRkRm9ybWF0dGluZ09wdGlvbnMoZWwsIHR1bmUuZm9ybWF0dGluZywgJ25vdGUnKTtcblx0XHRcdFx0XHRcdHR1bmUuYXBwZW5kRWxlbWVudCgnbm90ZScsIHN0YXJ0T2ZMaW5lK2ksIHN0YXJ0T2ZMaW5lK2krcmV0WzBdLCBlbCk7XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLm1lYXN1cmVOb3RFbXB0eSA9IHRydWU7XG5cdFx0XHRcdFx0XHRlbCA9IHt9O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHR2YXIgYmFyID0ge3R5cGU6IHJldFsxXX07XG5cdFx0XHRcdFx0aWYgKGJhci50eXBlLmxlbmd0aCA9PT0gMClcblx0XHRcdFx0XHRcdHdhcm4oXCJVbmtub3duIGJhciB0eXBlXCIsIGxpbmUsIGkpO1xuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMuaW5FbmRpbmcgJiYgYmFyLnR5cGUgIT09ICdiYXJfdGhpbicpIHtcblx0XHRcdFx0XHRcdFx0YmFyLmVuZEVuZGluZyA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuaW5FbmRpbmcgPSBmYWxzZTtcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGlmIChyZXRbMl0pIHtcblx0XHRcdFx0XHRcdFx0YmFyLnN0YXJ0RW5kaW5nID0gcmV0WzJdO1xuXHRcdFx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5pbkVuZGluZylcblx0XHRcdFx0XHRcdFx0XHRiYXIuZW5kRW5kaW5nID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pbkVuZGluZyA9IHRydWU7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoZWwuZGVjb3JhdGlvbiAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0XHRiYXIuZGVjb3JhdGlvbiA9IGVsLmRlY29yYXRpb247XG5cdFx0XHRcdFx0XHRpZiAoZWwuY2hvcmQgIT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRcdFx0YmFyLmNob3JkID0gZWwuY2hvcmQ7XG5cdFx0XHRcdFx0XHRpZiAoYmFyLnN0YXJ0RW5kaW5nICYmIG11bHRpbGluZVZhcnMuYmFyRmlyc3RFbmRpbmdOdW0gPT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5iYXJGaXJzdEVuZGluZ051bSA9IG11bHRpbGluZVZhcnMuY3VyckJhck51bWJlcjtcblx0XHRcdFx0XHRcdGVsc2UgaWYgKGJhci5zdGFydEVuZGluZyAmJiBiYXIuZW5kRW5kaW5nICYmIG11bHRpbGluZVZhcnMuYmFyRmlyc3RFbmRpbmdOdW0pXG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuY3VyckJhck51bWJlciA9IG11bHRpbGluZVZhcnMuYmFyRmlyc3RFbmRpbmdOdW07XG5cdFx0XHRcdFx0XHRlbHNlIGlmIChiYXIuZW5kRW5kaW5nKVxuXHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmJhckZpcnN0RW5kaW5nTnVtID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0aWYgKGJhci50eXBlICE9PSAnYmFyX2ludmlzaWJsZScgJiYgbXVsdGlsaW5lVmFycy5tZWFzdXJlTm90RW1wdHkpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGlzRmlyc3RWb2ljZSA9IG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlID09PSB1bmRlZmluZWQgfHwgKG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLnN0YWZmTnVtID09PSAgMCAmJiBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5pbmRleCA9PT0gIDApO1xuXHRcdFx0XHRcdFx0XHRpZiAoaXNGaXJzdFZvaWNlKSB7XG5cdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5jdXJyQmFyTnVtYmVyKys7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMuYmFyTnVtYmVycyAmJiBtdWx0aWxpbmVWYXJzLmN1cnJCYXJOdW1iZXIgJSBtdWx0aWxpbmVWYXJzLmJhck51bWJlcnMgPT09IDApXG5cdFx0XHRcdFx0XHRcdFx0XHRiYXIuYmFyTnVtYmVyID0gbXVsdGlsaW5lVmFycy5jdXJyQmFyTnVtYmVyO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmFkZEZvcm1hdHRpbmdPcHRpb25zKGVsLCB0dW5lLmZvcm1hdHRpbmcsICdiYXInKTtcblx0XHRcdFx0XHRcdHR1bmUuYXBwZW5kRWxlbWVudCgnYmFyJywgc3RhcnRPZkxpbmUraSwgc3RhcnRPZkxpbmUraStyZXRbMF0sIGJhcik7XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLm1lYXN1cmVOb3RFbXB0eSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0ZWwgPSB7fTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aSArPSByZXRbMF07XG5cdFx0XHRcdFx0dmFyIGN2ID0gbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UgPyBtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZk51bSArICctJyArIG11bHRpbGluZVZhcnMuY3VycmVudFZvaWNlLmluZGV4IDogJ09OTFknO1xuXHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmxpbmVCcmVha3MpIHtcblx0XHRcdFx0XHRcdGlmICghbXVsdGlsaW5lVmFycy5iYXJDb3VudGVyW2N2XSlcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5iYXJDb3VudGVyW2N2XSA9IDA7XG5cdFx0XHRcdFx0XHR2YXIgYnJlYWtOb3cgPSBtdWx0aWxpbmVWYXJzLmxpbmVCcmVha3NbJycrbXVsdGlsaW5lVmFycy5iYXJDb3VudGVyW2N2XV07XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmJhckNvdW50ZXJbY3ZdKys7XG5cdFx0XHRcdFx0XHRpZiAoYnJlYWtOb3cpXG5cdFx0XHRcdFx0XHRcdHN0YXJ0TmV3TGluZSgpO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIGlmIChsaW5lW2ldID09PSAnJicpIHtcdC8vIGJhY2t0cmFjayB0byBiZWdpbm5pbmcgb2YgbWVhc3VyZVxuXHRcdFx0XHRcdHdhcm4oXCJPdmVybGF5IG5vdCB5ZXQgc3VwcG9ydGVkXCIsIGxpbmUsIGkpO1xuXHRcdFx0XHRcdGkrKztcblxuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdC8vIFRoaXMgaXMgZGVmaW5pdGVseSBhIG5vdGUgZ3JvdXBcblx0XHRcdFx0XHQvL1xuXHRcdFx0XHRcdC8vIExvb2sgZm9yIGFzIG1hbnkgb3BlbiBzbHVycyBhbmQgdHJpcGxldHMgYXMgdGhlcmUgYXJlLiAoTm90ZTogb25seSB0aGUgZmlyc3QgdHJpcGxldCBpcyB2YWxpZC4pXG5cdFx0XHRcdFx0cmV0ID0gbGV0dGVyX3RvX29wZW5fc2x1cnNfYW5kX3RyaXBsZXRzKGxpbmUsIGkpO1xuXHRcdFx0XHRcdGlmIChyZXQuY29uc3VtZWQgPiAwKSB7XG5cdFx0XHRcdFx0XHRpZiAocmV0LnN0YXJ0U2x1ciAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0XHRlbC5zdGFydFNsdXIgPSByZXQuc3RhcnRTbHVyO1xuXHRcdFx0XHRcdFx0aWYgKHJldC50cmlwbGV0ICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRyaXBsZXROb3Rlc0xlZnQgPiAwKVxuXHRcdFx0XHRcdFx0XHRcdHdhcm4oXCJDYW4ndCBuZXN0IHRyaXBsZXRzXCIsIGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRlbC5zdGFydFRyaXBsZXQgPSByZXQudHJpcGxldDtcblx0XHRcdFx0XHRcdFx0XHRlbC50cmlwbGV0TXVsdGlwbGllciA9IHJldC50cmlwbGV0USAvIHJldC50cmlwbGV0O1xuXHRcdFx0XHRcdFx0XHRcdHRyaXBsZXROb3Rlc0xlZnQgPSByZXQubnVtX25vdGVzID09PSB1bmRlZmluZWQgPyByZXQudHJpcGxldCA6IHJldC5udW1fbm90ZXM7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdGkgKz0gcmV0LmNvbnN1bWVkO1xuXHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdC8vIGhhbmRsZSBjaG9yZHMuXG5cdFx0XHRcdFx0aWYgKGxpbmUuY2hhckF0KGkpID09PSAnWycpIHtcblx0XHRcdFx0XHRcdHZhciBjaG9yZFN0YXJ0Q2hhciA9IGk7XG5cdFx0XHRcdFx0XHRpKys7XG5cdFx0XHRcdFx0XHR2YXIgY2hvcmREdXJhdGlvbiA9IG51bGw7XG5cdFx0XHRcdFx0XHR2YXIgcmVtZW1iZXJFbmRCZWFtID0gZmFsc2U7XG5cblx0XHRcdFx0XHRcdHZhciBkb25lID0gZmFsc2U7XG5cdFx0XHRcdFx0XHR3aGlsZSAoIWRvbmUpIHtcblx0XHRcdFx0XHRcdFx0dmFyIGFjY2VudCA9IGxldHRlcl90b19hY2NlbnQobGluZSwgaSk7XG5cdFx0XHRcdFx0XHRcdGlmIChhY2NlbnRbMF0gPiAwKSB7XG5cdFx0XHRcdFx0XHRcdFx0aSArPSBhY2NlbnRbMF07XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHR2YXIgY2hvcmROb3RlID0gZ2V0Q29yZU5vdGUobGluZSwgaSwge30sIGZhbHNlKTtcblx0XHRcdFx0XHRcdFx0aWYgKGNob3JkTm90ZSAhPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChhY2NlbnRbMF0gPiAwKSB7IC8vIElmIHdlIGZvdW5kIGEgZGVjb3JhdGlvbiBhYm92ZSwgaXQgbW9kaWZpZXMgdGhlIGVudGlyZSBjaG9yZC4gXCJzdHlsZVwiIGlzIGhhbmRsZWQgYmVsb3cuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAoYWNjZW50WzFdLmluZGV4T2YoXCJzdHlsZT1cIikgIT09IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGVsLmRlY29yYXRpb24gPT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbC5kZWNvcmF0aW9uID0gW107XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGVsLmRlY29yYXRpb24ucHVzaChhY2NlbnRbMV0pO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRpZiAoY2hvcmROb3RlLmVuZF9iZWFtKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlbC5lbmRfYmVhbSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRkZWxldGUgY2hvcmROb3RlLmVuZF9iZWFtO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRpZiAoZWwucGl0Y2hlcyA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRlbC5kdXJhdGlvbiA9IGNob3JkTm90ZS5kdXJhdGlvbjtcblx0XHRcdFx0XHRcdFx0XHRcdGVsLnBpdGNoZXMgPSBbIGNob3JkTm90ZSBdO1xuXHRcdFx0XHRcdFx0XHRcdH0gZWxzZVx0Ly8gSnVzdCBpZ25vcmUgdGhlIG5vdGUgbGVuZ3RocyBvZiBhbGwgYnV0IHRoZSBmaXJzdCBub3RlLiBUaGUgc3RhbmRhcmQgaXNuJ3QgY2xlYXIgaGVyZSwgYnV0IHRoaXMgc2VlbXMgbGVzcyBjb25mdXNpbmcuXG5cdFx0XHRcdFx0XHRcdFx0XHRlbC5waXRjaGVzLnB1c2goY2hvcmROb3RlKTtcblx0XHRcdFx0XHRcdFx0XHRkZWxldGUgY2hvcmROb3RlLmR1cmF0aW9uO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChhY2NlbnRbMF0gPiAwKSB7IC8vIElmIHdlIGZvdW5kIGEgc3R5bGUgYWJvdmUsIGl0IG1vZGlmaWVzIHRoZSBpbmRpdmlkdWFsIHBpdGNoLCBub3QgdGhlIGVudGlyZSBjaG9yZC5cblx0XHRcdFx0XHRcdFx0XHRcdGlmIChhY2NlbnRbMV0uaW5kZXhPZihcInN0eWxlPVwiKSA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbC5waXRjaGVzW2VsLnBpdGNoZXMubGVuZ3RoLTFdLnN0eWxlID0gYWNjZW50WzFdLnN1YnN0cig2KTtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5pblRpZUNob3JkW2VsLnBpdGNoZXMubGVuZ3RoXSkge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y2hvcmROb3RlLmVuZFRpZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmluVGllQ2hvcmRbZWwucGl0Y2hlcy5sZW5ndGhdID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRpZiAoY2hvcmROb3RlLnN0YXJ0VGllKVxuXHRcdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pblRpZUNob3JkW2VsLnBpdGNoZXMubGVuZ3RoXSA9IHRydWU7XG5cblx0XHRcdFx0XHRcdFx0XHRpICA9IGNob3JkTm90ZS5lbmRDaGFyO1xuXHRcdFx0XHRcdFx0XHRcdGRlbGV0ZSBjaG9yZE5vdGUuZW5kQ2hhcjtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIGlmIChsaW5lLmNoYXJBdChpKSA9PT0gJyAnKSB7XG5cdFx0XHRcdFx0XHRcdFx0Ly8gU3BhY2VzIGFyZSBub3QgYWxsb3dlZCBpbiBjaG9yZHMsIGJ1dCB3ZSBjYW4gcmVjb3ZlciBmcm9tIGl0IGJ5IGlnbm9yaW5nIGl0LlxuXHRcdFx0XHRcdFx0XHRcdHdhcm4oXCJTcGFjZXMgYXJlIG5vdCBhbGxvd2VkIGluIGNob3Jkc1wiLCBsaW5lLCBpKTtcblx0XHRcdFx0XHRcdFx0XHRpKys7XG5cdFx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGkgPCBsaW5lLmxlbmd0aCAmJiBsaW5lLmNoYXJBdChpKSA9PT0gJ10nKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHQvLyBjb25zdW1lIHRoZSBjbG9zZSBicmFja2V0XG5cdFx0XHRcdFx0XHRcdFx0XHRpKys7XG5cblx0XHRcdFx0XHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLm5leHRfbm90ZV9kdXJhdGlvbiAhPT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRlbC5kdXJhdGlvbiA9IGVsLmR1cmF0aW9uICogbXVsdGlsaW5lVmFycy5uZXh0X25vdGVfZHVyYXRpb247XG5cdFx0XHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMubmV4dF9ub3RlX2R1cmF0aW9uID0gMDtcblx0XHRcdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMuaW5UaWUpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cGFyc2VDb21tb24uZWFjaChlbC5waXRjaGVzLCBmdW5jdGlvbihwaXRjaCkgeyBwaXRjaC5lbmRUaWUgPSB0cnVlOyB9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pblRpZSA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0XHRcdFx0XHRpZiAodHJpcGxldE5vdGVzTGVmdCA+IDApIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0dHJpcGxldE5vdGVzTGVmdC0tO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAodHJpcGxldE5vdGVzTGVmdCA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsLmVuZFRyaXBsZXQgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdHZhciBwb3N0Q2hvcmREb25lID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0XHR3aGlsZSAoaSA8IGxpbmUubGVuZ3RoICYmICFwb3N0Q2hvcmREb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdHN3aXRjaCAobGluZS5jaGFyQXQoaSkpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlICcgJzpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlICdcXHQnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWRkRW5kQmVhbShlbCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjYXNlICcpJzpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChlbC5lbmRTbHVyID09PSB1bmRlZmluZWQpIGVsLmVuZFNsdXIgPSAxOyBlbHNlIGVsLmVuZFNsdXIrKztcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJy0nOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0cGFyc2VDb21tb24uZWFjaChlbC5waXRjaGVzLCBmdW5jdGlvbihwaXRjaCkgeyBwaXRjaC5zdGFydFRpZSA9IHt9OyB9KTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuaW5UaWUgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAnPic6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2FzZSAnPCc6XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHR2YXIgYnIyID0gZ2V0QnJva2VuUmh5dGhtKGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aSArPSBicjJbMF0gLSAxO1x0Ly8gaW5kZXggZ2V0cyBpbmNyZW1lbnRlZCBiZWxvdywgc28gd2UnbGwgbGV0IHRoYXQgaGFwcGVuXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLm5leHRfbm90ZV9kdXJhdGlvbiA9IGJyMlsyXTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaG9yZER1cmF0aW9uKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRjaG9yZER1cmF0aW9uID0gY2hvcmREdXJhdGlvbiAqIGJyMlsxXTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hvcmREdXJhdGlvbiA9IGJyMlsxXTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzEnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzInOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzMnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzQnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzUnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzYnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzcnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzgnOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJzknOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdGNhc2UgJy8nOlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0dmFyIGZyYWN0aW9uID0gdG9rZW5pemVyLmdldEZyYWN0aW9uKGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0Y2hvcmREdXJhdGlvbiA9IGZyYWN0aW9uLnZhbHVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aSA9IGZyYWN0aW9uLmluZGV4O1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKGxpbmUuY2hhckF0KGkpID09PSAnICcpXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHJlbWVtYmVyRW5kQmVhbSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobGluZS5jaGFyQXQoaSkgPT09ICctJyB8fCBsaW5lLmNoYXJBdChpKSA9PT0gJyknIHx8IGxpbmUuY2hhckF0KGkpID09PSAnICcgfHwgbGluZS5jaGFyQXQoaSkgPT09ICc8JyB8fCBsaW5lLmNoYXJBdChpKSA9PT0gJz4nKVxuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRpLS07IC8vIFN1YnRyYWN0aW5nIG9uZSBiZWNhdXNlIG9uZSBpcyBhdXRvbWF0aWNhbGx5IGFkZGVkIGJlbG93XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBvc3RDaG9yZERvbmUgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0XHRcdFx0XHRcdHBvc3RDaG9yZERvbmUgPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0aWYgKCFwb3N0Q2hvcmREb25lKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0aSsrO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0XHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgJ10nIHRvIGVuZCB0aGUgY2hvcmRzXCIsIGxpbmUsIGkpO1xuXG5cdFx0XHRcdFx0XHRcdFx0aWYgKGVsLnBpdGNoZXMgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0aWYgKGNob3JkRHVyYXRpb24gIT09IG51bGwpIHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0ZWwuZHVyYXRpb24gPSBlbC5kdXJhdGlvbiAqIGNob3JkRHVyYXRpb247XG5cdFx0XHRcdFx0XHRcdFx0XHRcdGlmIChyZW1lbWJlckVuZEJlYW0pXG5cdFx0XHRcdFx0XHRcdFx0XHRcdFx0YWRkRW5kQmVhbShlbCk7XG5cdFx0XHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuYWRkRm9ybWF0dGluZ09wdGlvbnMoZWwsIHR1bmUuZm9ybWF0dGluZywgJ25vdGUnKTtcblx0XHRcdFx0XHRcdFx0XHRcdHR1bmUuYXBwZW5kRWxlbWVudCgnbm90ZScsIHN0YXJ0T2ZMaW5lK2Nob3JkU3RhcnRDaGFyLCBzdGFydE9mTGluZStpLCBlbCk7XG5cdFx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLm1lYXN1cmVOb3RFbXB0eSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0XHRlbCA9IHt9O1xuXHRcdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRkb25lID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdC8vIFNpbmdsZSBwaXRjaFxuXHRcdFx0XHRcdFx0dmFyIGVsMiA9IHt9O1xuXHRcdFx0XHRcdFx0dmFyIGNvcmUgPSBnZXRDb3JlTm90ZShsaW5lLCBpLCBlbDIsIHRydWUpO1xuXHRcdFx0XHRcdFx0aWYgKGVsMi5lbmRUaWUgIT09IHVuZGVmaW5lZCkgbXVsdGlsaW5lVmFycy5pblRpZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRpZiAoY29yZSAhPT0gbnVsbCkge1xuXHRcdFx0XHRcdFx0XHRpZiAoY29yZS5waXRjaCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZWwucGl0Y2hlcyA9IFsgeyB9IF07XG5cdFx0XHRcdFx0XHRcdFx0Ly8gVE9ETy1QRVI6IHN0cmFpZ2h0ZW4gdGhpcyBvdXQgc28gdGhlcmUgaXMgbm90IHNvIG11Y2ggY29weWluZzogZ2V0Q29yZU5vdGUgc2hvdWxkbid0IGNoYW5nZSBlJ1xuXHRcdFx0XHRcdFx0XHRcdGlmIChjb3JlLmFjY2lkZW50YWwgIT09IHVuZGVmaW5lZCkgZWwucGl0Y2hlc1swXS5hY2NpZGVudGFsID0gY29yZS5hY2NpZGVudGFsO1xuXHRcdFx0XHRcdFx0XHRcdGVsLnBpdGNoZXNbMF0ucGl0Y2ggPSBjb3JlLnBpdGNoO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChjb3JlLm1pZGlwaXRjaClcblx0XHRcdFx0XHRcdFx0XHRcdGVsLnBpdGNoZXNbMF0ubWlkaXBpdGNoID0gY29yZS5taWRpcGl0Y2g7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuZW5kU2x1ciAhPT0gdW5kZWZpbmVkKSBlbC5waXRjaGVzWzBdLmVuZFNsdXIgPSBjb3JlLmVuZFNsdXI7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuZW5kVGllICE9PSB1bmRlZmluZWQpIGVsLnBpdGNoZXNbMF0uZW5kVGllID0gY29yZS5lbmRUaWU7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuc3RhcnRTbHVyICE9PSB1bmRlZmluZWQpIGVsLnBpdGNoZXNbMF0uc3RhcnRTbHVyID0gY29yZS5zdGFydFNsdXI7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGVsLnN0YXJ0U2x1ciAhPT0gdW5kZWZpbmVkKSBlbC5waXRjaGVzWzBdLnN0YXJ0U2x1ciA9IGVsLnN0YXJ0U2x1cjtcblx0XHRcdFx0XHRcdFx0XHRpZiAoY29yZS5zdGFydFRpZSAhPT0gdW5kZWZpbmVkKSBlbC5waXRjaGVzWzBdLnN0YXJ0VGllID0gY29yZS5zdGFydFRpZTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZWwuc3RhcnRUaWUgIT09IHVuZGVmaW5lZCkgZWwucGl0Y2hlc1swXS5zdGFydFRpZSA9IGVsLnN0YXJ0VGllO1xuXHRcdFx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0XHRcdGVsLnJlc3QgPSBjb3JlLnJlc3Q7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuZW5kU2x1ciAhPT0gdW5kZWZpbmVkKSBlbC5lbmRTbHVyID0gY29yZS5lbmRTbHVyO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChjb3JlLmVuZFRpZSAhPT0gdW5kZWZpbmVkKSBlbC5yZXN0LmVuZFRpZSA9IGNvcmUuZW5kVGllO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChjb3JlLnN0YXJ0U2x1ciAhPT0gdW5kZWZpbmVkKSBlbC5zdGFydFNsdXIgPSBjb3JlLnN0YXJ0U2x1cjtcblx0XHRcdFx0XHRcdFx0XHRpZiAoY29yZS5zdGFydFRpZSAhPT0gdW5kZWZpbmVkKSBlbC5yZXN0LnN0YXJ0VGllID0gY29yZS5zdGFydFRpZTtcblx0XHRcdFx0XHRcdFx0XHRpZiAoZWwuc3RhcnRUaWUgIT09IHVuZGVmaW5lZCkgZWwucmVzdC5zdGFydFRpZSA9IGVsLnN0YXJ0VGllO1xuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuY2hvcmQgIT09IHVuZGVmaW5lZCkgZWwuY2hvcmQgPSBjb3JlLmNob3JkO1xuXHRcdFx0XHRcdFx0XHRpZiAoY29yZS5kdXJhdGlvbiAhPT0gdW5kZWZpbmVkKSBlbC5kdXJhdGlvbiA9IGNvcmUuZHVyYXRpb247XG5cdFx0XHRcdFx0XHRcdGlmIChjb3JlLmRlY29yYXRpb24gIT09IHVuZGVmaW5lZCkgZWwuZGVjb3JhdGlvbiA9IGNvcmUuZGVjb3JhdGlvbjtcblx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuZ3JhY2VOb3RlcyAhPT0gdW5kZWZpbmVkKSBlbC5ncmFjZU5vdGVzID0gY29yZS5ncmFjZU5vdGVzO1xuXHRcdFx0XHRcdFx0XHRkZWxldGUgZWwuc3RhcnRTbHVyO1xuXHRcdFx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5pblRpZSkge1xuXHRcdFx0XHRcdFx0XHRcdGlmIChlbC5waXRjaGVzICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGVsLnBpdGNoZXNbMF0uZW5kVGllID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuaW5UaWUgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHR9IGVsc2UgaWYgKGVsLnJlc3QudHlwZSAhPT0gJ3NwYWNlcicpIHtcblx0XHRcdFx0XHRcdFx0XHRcdGVsLnJlc3QuZW5kVGllID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuaW5UaWUgPSBmYWxzZTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuc3RhcnRUaWUgfHwgZWwuc3RhcnRUaWUpXG5cdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pblRpZSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGkgID0gY29yZS5lbmRDaGFyO1xuXG5cdFx0XHRcdFx0XHRcdGlmICh0cmlwbGV0Tm90ZXNMZWZ0ID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHRyaXBsZXROb3Rlc0xlZnQtLTtcblx0XHRcdFx0XHRcdFx0XHRpZiAodHJpcGxldE5vdGVzTGVmdCA9PT0gMCkge1xuXHRcdFx0XHRcdFx0XHRcdFx0ZWwuZW5kVHJpcGxldCA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHRcdFx0aWYgKGNvcmUuZW5kX2JlYW0pXG5cdFx0XHRcdFx0XHRcdFx0YWRkRW5kQmVhbShlbCk7XG5cblx0XHRcdFx0XHRcdFx0Ly8gSWYgdGhlcmUgaXMgYSB3aG9sZSByZXN0LCB0aGVuIGl0IHNob3VsZCBiZSB0aGUgZHVyYXRpb24gb2YgdGhlIG1lYXN1cmUsIG5vdCBpdCdzIG93biBkdXJhdGlvbi4gV2UgbmVlZCB0byBzcGVjaWFsIGNhc2UgaXQuXG5cdFx0XHRcdFx0XHRcdGlmIChlbC5yZXN0ICYmIGVsLnJlc3QudHlwZSA9PT0gJ3Jlc3QnICYmIGVsLmR1cmF0aW9uID09PSAxKSB7XG5cdFx0XHRcdFx0XHRcdFx0ZWwucmVzdC50eXBlID0gJ3dob2xlJztcblxuXHRcdFx0XHRcdFx0XHRcdGVsLmR1cmF0aW9uID0gZHVyYXRpb25PZk1lYXN1cmUobXVsdGlsaW5lVmFycyk7XG5cdFx0XHRcdFx0XHRcdH1cblxuXHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmFkZEZvcm1hdHRpbmdPcHRpb25zKGVsLCB0dW5lLmZvcm1hdHRpbmcsICdub3RlJyk7XG5cdFx0XHRcdFx0XHRcdHR1bmUuYXBwZW5kRWxlbWVudCgnbm90ZScsIHN0YXJ0T2ZMaW5lK3N0YXJ0SSwgc3RhcnRPZkxpbmUraSwgZWwpO1xuXHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLm1lYXN1cmVOb3RFbXB0eSA9IHRydWU7XG5cdFx0XHRcdFx0XHRcdGVsID0ge307XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXG5cdFx0XHRcdFx0aWYgKGkgPT09IHN0YXJ0SSkge1x0Ly8gZG9uJ3Qga25vdyB3aGF0IHRoaXMgaXMsIHNvIGlnbm9yZSBpdC5cblx0XHRcdFx0XHRcdGlmIChsaW5lLmNoYXJBdChpKSAhPT0gJyAnICYmIGxpbmUuY2hhckF0KGkpICE9PSAnYCcpXG5cdFx0XHRcdFx0XHRcdHdhcm4oXCJVbmtub3duIGNoYXJhY3RlciBpZ25vcmVkXCIsIGxpbmUsIGkpO1xuXHRcdFx0XHRcdFx0aSsrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuXHR2YXIgcGFyc2VMaW5lID0gZnVuY3Rpb24obGluZSkge1xuXHRcdHZhciByZXQgPSBoZWFkZXIucGFyc2VIZWFkZXIobGluZSk7XG5cdFx0aWYgKHJldC5yZWd1bGFyKVxuXHRcdFx0cGFyc2VSZWd1bGFyTXVzaWNMaW5lKHJldC5zdHIpO1xuXHRcdGlmIChyZXQubmV3bGluZSAmJiBtdWx0aWxpbmVWYXJzLmNvbnRpbnVlYWxsID09PSB1bmRlZmluZWQpXG5cdFx0XHRzdGFydE5ld0xpbmUoKTtcblx0XHRpZiAocmV0LndvcmRzKVxuXHRcdFx0YWRkV29yZHModHVuZS5nZXRDdXJyZW50Vm9pY2UoKSwgbGluZS5zdWJzdHJpbmcoMikpO1xuXHRcdGlmIChyZXQuc3ltYm9scylcblx0XHRcdGFkZFN5bWJvbHModHVuZS5nZXRDdXJyZW50Vm9pY2UoKSwgbGluZS5zdWJzdHJpbmcoMikpO1xuXHRcdGlmIChyZXQucmVjdXJzZSlcblx0XHRcdHBhcnNlTGluZShyZXQuc3RyKTtcblx0fTtcblxuXHRmdW5jdGlvbiBhcHBlbmRMYXN0TWVhc3VyZSh2b2ljZSwgbmV4dFZvaWNlKSB7XG5cdFx0dm9pY2UucHVzaCh7XG5cdFx0XHRlbF90eXBlOiAnaGludCdcblx0XHR9KTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IG5leHRWb2ljZS5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGVsZW1lbnQgPSBuZXh0Vm9pY2VbaV07XG5cdFx0XHR2YXIgaGludCA9IHBhcnNlQ29tbW9uLmNsb25lKGVsZW1lbnQpO1xuXHRcdFx0dm9pY2UucHVzaChoaW50KTtcblx0XHRcdGlmIChlbGVtZW50LmVsX3R5cGUgPT09ICdiYXInKVxuXHRcdFx0XHRcdHJldHVybjtcblx0XHR9XG5cdH1cblxuXHRmdW5jdGlvbiBhZGRIaW50TWVhc3VyZShzdGFmZiwgbmV4dFN0YWZmKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdGFmZi5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIHN0YXZlID0gc3RhZmZbaV07XG5cdFx0XHR2YXIgbmV4dFN0YXZlID0gbmV4dFN0YWZmW2ldO1xuXHRcdFx0aWYgKG5leHRTdGF2ZSkgeyAvLyBCZSBzdXJlIHRoZXJlIGlzIHRoZSBzYW1lIG51bWJlciBvZiBzdGF2ZXMgb24gdGhlIG5leHQgbGluZS5cblx0XHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBuZXh0U3RhdmUudm9pY2VzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRcdFx0dmFyIG5leHRWb2ljZSA9IG5leHRTdGF2ZS52b2ljZXNbal07XG5cdFx0XHRcdFx0dmFyIHZvaWNlID0gc3RhdmUudm9pY2VzW2pdO1xuXHRcdFx0XHRcdGlmICh2b2ljZSkgeyAvLyBCZSBzdXJlIHRoZXJlIGFyZSB0aGUgc2FtZSBudW1iZXIgb2Ygdm9pY2VzIG9uIHRoZSBwcmV2aW91cyBsaW5lLlxuXHRcdFx0XHRcdFx0YXBwZW5kTGFzdE1lYXN1cmUodm9pY2UsIG5leHRWb2ljZSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0ZnVuY3Rpb24gYWRkSGludE1lYXN1cmVzKCkge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdHVuZS5saW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGxpbmUgPSB0dW5lLmxpbmVzW2ldLnN0YWZmO1xuXHRcdFx0aWYgKGxpbmUpIHtcblx0XHRcdFx0dmFyIGogPSBpKzE7XG5cdFx0XHRcdHdoaWxlIChqIDwgdHVuZS5saW5lcy5sZW5ndGggJiYgdHVuZS5saW5lc1tqXS5zdGFmZiA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdGorKztcblx0XHRcdFx0aWYgKGogPCB0dW5lLmxpbmVzLmxlbmd0aCkge1xuXHRcdFx0XHRcdHZhciBuZXh0TGluZSA9IHR1bmUubGluZXNbal0uc3RhZmY7XG5cdFx0XHRcdFx0YWRkSGludE1lYXN1cmUobGluZSwgbmV4dExpbmUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0dGhpcy5wYXJzZSA9IGZ1bmN0aW9uKHN0clR1bmUsIHN3aXRjaGVzKSB7XG5cdFx0Ly8gdGhlIHN3aXRjaGVzIGFyZSBvcHRpb25hbCBhbmQgY2F1c2UgYSBkaWZmZXJlbmNlIGluIHRoZSB3YXkgdGhlIHR1bmUgaXMgcGFyc2VkLlxuXHRcdC8vIHN3aXRjaGVzLmhlYWRlcl9vbmx5IDogc3RvcCBwYXJzaW5nIHdoZW4gdGhlIGhlYWRlciBpcyBmaW5pc2hlZFxuXHRcdC8vIHN3aXRjaGVzLnN0b3Bfb25fd2FybmluZyA6IHN0b3AgYXQgdGhlIGZpcnN0IHdhcm5pbmcgZW5jb3VudGVyZWQuXG5cdFx0Ly8gc3dpdGNoZXMucHJpbnQ6IGZvcm1hdCBmb3IgdGhlIHBhZ2UgaW5zdGVhZCBvZiB0aGUgYnJvd3Nlci5cblx0XHQvLyBzd2l0Y2hlcy5mb3JtYXQ6IGEgaGFzaCBvZiB0aGUgZGVzaXJlZCBmb3JtYXR0aW5nIGNvbW1hbmRzLlxuXHRcdC8vIHN3aXRjaGVzLmhpbnRfbWVhc3VyZXM6IHB1dCB0aGUgbmV4dCBtZWFzdXJlIGF0IHRoZSBlbmQgb2YgdGhlIGN1cnJlbnQgbGluZS5cblx0XHQvLyBzd2l0Y2hlcy50cmFuc3Bvc2U6IGNoYW5nZSB0aGUga2V5IHNpZ25hdHVyZSwgY2hvcmRzLCBhbmQgbm90ZXMgYnkgYSBudW1iZXIgb2YgaGFsZi1zdGVwcy5cblx0XHRpZiAoIXN3aXRjaGVzKSBzd2l0Y2hlcyA9IHt9O1xuXHRcdHR1bmUucmVzZXQoKTtcblx0XHRpZiAoc3dpdGNoZXMucHJpbnQpXG5cdFx0XHR0dW5lLm1lZGlhID0gJ3ByaW50Jztcblx0XHRtdWx0aWxpbmVWYXJzLnJlc2V0KCk7XG5cdFx0aWYgKHN3aXRjaGVzLnZpc3VhbFRyYW5zcG9zZSkge1xuXHRcdFx0bXVsdGlsaW5lVmFycy5nbG9iYWxUcmFuc3Bvc2UgPSBwYXJzZUludChzd2l0Y2hlcy52aXN1YWxUcmFuc3Bvc2UpO1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuZ2xvYmFsVHJhbnNwb3NlID09PSAwKVxuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmdsb2JhbFRyYW5zcG9zZSA9IHVuZGVmaW5lZDtcblx0XHR9IGVsc2Vcblx0XHRcdG11bHRpbGluZVZhcnMuZ2xvYmFsVHJhbnNwb3NlID0gdW5kZWZpbmVkO1xuXHRcdGlmIChzd2l0Y2hlcy5saW5lQnJlYWtzKSB7XG5cdFx0XHQvLyBjaGFuZ2UgdGhlIGZvcm1hdCBvZiB0aGUgdGhlIGxpbmUgYnJlYWtzIGZvciBlYXN5IHRlc3RpbmcuXG5cdFx0XHRtdWx0aWxpbmVWYXJzLmxpbmVCcmVha3MgPSB7fTtcblx0XHRcdG11bHRpbGluZVZhcnMuY29udGludWVhbGwgPSB0cnVlO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzd2l0Y2hlcy5saW5lQnJlYWtzLmxlbmd0aDsgaSsrKVxuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmxpbmVCcmVha3NbJycrc3dpdGNoZXMubGluZUJyZWFrc1tpXV0gPSB0cnVlO1xuXHRcdH1cblx0XHRoZWFkZXIucmVzZXQodG9rZW5pemVyLCB3YXJuLCBtdWx0aWxpbmVWYXJzLCB0dW5lKTtcblxuXHRcdC8vIFRha2UgY2FyZSBvZiB3aGF0ZXZlciBsaW5lIGVuZGluZ3MgY29tZSBvdXIgd2F5XG5cdFx0c3RyVHVuZSA9IHBhcnNlQ29tbW9uLmdzdWIoc3RyVHVuZSwgJ1xcclxcbicsICdcXG4nKTtcblx0XHRzdHJUdW5lID0gcGFyc2VDb21tb24uZ3N1YihzdHJUdW5lLCAnXFxyJywgJ1xcbicpO1xuXHRcdHN0clR1bmUgKz0gJ1xcbic7XHQvLyBUYWNrZWQgb24gdGVtcG9yYXJpbHkgdG8gbWFrZSB0aGUgbGFzdCBsaW5lIGNvbnRpbnVhdGlvbiB3b3JrXG5cdFx0c3RyVHVuZSA9IHN0clR1bmUucmVwbGFjZSgvXFxuXFxcXC4qXFxuL2csIFwiXFxuXCIpO1x0Ly8gZ2V0IHJpZCBvZiBsYXRleCBjb21tYW5kcy5cblx0XHR2YXIgY29udGludWF0aW9uUmVwbGFjZW1lbnQgPSBmdW5jdGlvbihhbGwsIGJhY2tzbGFzaCwgY29tbWVudCl7XG5cdFx0XHR2YXIgc3BhY2VzID0gXCIgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiO1xuXHRcdFx0dmFyIHBhZGRpbmcgPSBjb21tZW50ID8gc3BhY2VzLnN1YnN0cmluZygwLCBjb21tZW50Lmxlbmd0aCkgOiBcIlwiO1xuXHRcdFx0cmV0dXJuIGJhY2tzbGFzaCArIFwiIFxceDEyXCIgKyBwYWRkaW5nO1xuXHRcdH07XG5cdFx0c3RyVHVuZSA9IHN0clR1bmUucmVwbGFjZSgvXFxcXChbIFxcdF0qKSglLiopKlxcbi9nLCBjb250aW51YXRpb25SZXBsYWNlbWVudCk7XHQvLyB0YWtlIGNhcmUgb2YgbGluZSBjb250aW51YXRpb25zIHJpZ2h0IGF3YXksIGJ1dCBrZWVwIHRoZSBzYW1lIG51bWJlciBvZiBjaGFyYWN0ZXJzXG5cdFx0dmFyIGxpbmVzID0gc3RyVHVuZS5zcGxpdCgnXFxuJyk7XG5cdFx0aWYgKHBhcnNlQ29tbW9uLmxhc3QobGluZXMpLmxlbmd0aCA9PT0gMClcdC8vIHJlbW92ZSB0aGUgYmxhbmsgbGluZSB3ZSBhZGRlZCBhYm92ZS5cblx0XHRcdGxpbmVzLnBvcCgpO1xuXHRcdHRyeSB7XG5cdFx0XHRpZiAoc3dpdGNoZXMuZm9ybWF0KSB7XG5cdFx0XHRcdHBhcnNlRGlyZWN0aXZlLmdsb2JhbEZvcm1hdHRpbmcoc3dpdGNoZXMuZm9ybWF0KTtcblx0XHRcdH1cblx0XHRcdHBhcnNlQ29tbW9uLmVhY2gobGluZXMsICBmdW5jdGlvbihsaW5lKSB7XG5cdFx0XHRcdGlmIChzd2l0Y2hlcy5oZWFkZXJfb25seSAmJiBtdWx0aWxpbmVWYXJzLmlzX2luX2hlYWRlciA9PT0gZmFsc2UpXG5cdFx0XHRcdFx0dGhyb3cgXCJub3JtYWxfYWJvcnRcIjtcblx0XHRcdFx0aWYgKHN3aXRjaGVzLnN0b3Bfb25fd2FybmluZyAmJiBtdWx0aWxpbmVWYXJzLndhcm5pbmdzKVxuXHRcdFx0XHRcdHRocm93IFwibm9ybWFsX2Fib3J0XCI7XG5cdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmlzX2luX2hpc3RvcnkpIHtcblx0XHRcdFx0XHRpZiAobGluZS5jaGFyQXQoMSkgPT09ICc6Jykge1xuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pc19pbl9oaXN0b3J5ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRwYXJzZUxpbmUobGluZSk7XG5cdFx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0XHR0dW5lLmFkZE1ldGFUZXh0KFwiaGlzdG9yeVwiLCB0b2tlbml6ZXIudHJhbnNsYXRlU3RyaW5nKHRva2VuaXplci5zdHJpcENvbW1lbnQobGluZSkpKTtcblx0XHRcdFx0fSBlbHNlIGlmIChtdWx0aWxpbmVWYXJzLmluVGV4dEJsb2NrKSB7XG5cdFx0XHRcdFx0aWYgKHBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgobGluZSwgXCIlJWVuZHRleHRcIikpIHtcblx0XHRcdFx0XHRcdC8vdHVuZS5hZGRNZXRhVGV4dChcInRleHRCbG9ja1wiLCBtdWx0aWxpbmVWYXJzLnRleHRCbG9jayk7XG5cdFx0XHRcdFx0XHR0dW5lLmFkZFRleHQobXVsdGlsaW5lVmFycy50ZXh0QmxvY2spO1xuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pblRleHRCbG9jayA9IGZhbHNlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdGlmIChwYXJzZUNvbW1vbi5zdGFydHNXaXRoKGxpbmUsIFwiJSVcIikpXG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMudGV4dEJsb2NrICs9ICcgJyArIGxpbmUuc3Vic3RyaW5nKDIpO1xuXHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnRleHRCbG9jayArPSAnICcgKyBsaW5lO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fSBlbHNlIGlmIChtdWx0aWxpbmVWYXJzLmluUHNCbG9jaykge1xuXHRcdFx0XHRcdGlmIChwYXJzZUNvbW1vbi5zdGFydHNXaXRoKGxpbmUsIFwiJSVlbmRwc1wiKSkge1xuXHRcdFx0XHRcdFx0Ly8gSnVzdCBpZ25vcmUgcG9zdHNjcmlwdFxuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pblBzQmxvY2sgPSBmYWxzZTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy50ZXh0QmxvY2sgKz0gJyAnICsgbGluZTtcblx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0cGFyc2VMaW5lKGxpbmUpO1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmlDaGFyICs9IGxpbmUubGVuZ3RoICsgMTtcblx0XHRcdH0pO1xuXHRcdFx0dmFyIHBoID0gMTEqNzI7XG5cdFx0XHR2YXIgcGwgPSA4LjUqNzI7XG5cdFx0XHRzd2l0Y2ggKG11bHRpbGluZVZhcnMucGFwZXJzaXplKSB7XG5cdFx0XHRcdC8vY2FzZSBcImxldHRlclwiOiBwaCA9IDExKjcyOyBwbCA9IDguNSo3MjsgYnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJsZWdhbFwiOiBwaCA9IDE0KjcyOyBwbCA9IDguNSo3MjsgYnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJBNFwiOiBwaCA9IDExLjcqNzI7IHBsID0gOC4zKjcyOyBicmVhaztcblx0XHRcdH1cblx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmxhbmRzY2FwZSkge1xuXHRcdFx0XHR2YXIgeCA9IHBoO1xuXHRcdFx0XHRwaCA9IHBsO1xuXHRcdFx0XHRwbCA9IHg7XG5cdFx0XHR9XG5cdFx0XHRtdWx0aWxpbmVWYXJzLm9wZW5TbHVycyA9IHR1bmUuY2xlYW5VcChwbCwgcGgsIG11bHRpbGluZVZhcnMuYmFyc3BlcnN0YWZmLCBtdWx0aWxpbmVWYXJzLnN0YWZmbm9ub3RlLCBtdWx0aWxpbmVWYXJzLm9wZW5TbHVycyk7XG5cdFx0fSBjYXRjaCAoZXJyKSB7XG5cdFx0XHRpZiAoZXJyICE9PSBcIm5vcm1hbF9hYm9ydFwiKVxuXHRcdFx0XHR0aHJvdyBlcnI7XG5cdFx0fVxuXHRcdGlmIChzd2l0Y2hlcy5oaW50X21lYXN1cmVzKSB7XG5cdFx0XHRhZGRIaW50TWVhc3VyZXMoKTtcblx0XHR9XG5cdH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnNlO1xuIiwiLypnbG9iYWwgd2luZG93ICovXG5cbnZhciBwYXJzZUNvbW1vbiA9IHJlcXVpcmUoJy4vYWJjX2NvbW1vbicpO1xuXG52YXIgcGFyc2VEaXJlY3RpdmUgPSB7fTtcblxuKGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIHRva2VuaXplcjtcblx0dmFyIHdhcm47XG5cdHZhciBtdWx0aWxpbmVWYXJzO1xuXHR2YXIgdHVuZTtcblx0cGFyc2VEaXJlY3RpdmUuaW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKHRva2VuaXplcl8sIHdhcm5fLCBtdWx0aWxpbmVWYXJzXywgdHVuZV8pIHtcblx0XHR0b2tlbml6ZXIgPSB0b2tlbml6ZXJfO1xuXHRcdHdhcm4gPSB3YXJuXztcblx0XHRtdWx0aWxpbmVWYXJzID0gbXVsdGlsaW5lVmFyc187XG5cdFx0dHVuZSA9IHR1bmVfO1xuXHRcdGluaXRpYWxpemVGb250cygpO1xuXHR9O1xuXG5cdGZ1bmN0aW9uIGluaXRpYWxpemVGb250cygpIHtcblx0XHRtdWx0aWxpbmVWYXJzLmFubm90YXRpb25mb250ICA9IHsgZmFjZTogXCJIZWx2ZXRpY2FcIiwgc2l6ZTogMTIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy5nY2hvcmRmb250ICA9IHsgZmFjZTogXCJIZWx2ZXRpY2FcIiwgc2l6ZTogMTIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy5oaXN0b3J5Zm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTYsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy5pbmZvZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTQsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy5tZWFzdXJlZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTQsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy5wYXJ0c2ZvbnQgID0geyBmYWNlOiBcIlxcXCJUaW1lcyBOZXcgUm9tYW5cXFwiXCIsIHNpemU6IDE1LCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdG11bHRpbGluZVZhcnMucmVwZWF0Zm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTMsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy50ZXh0Zm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTYsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0bXVsdGlsaW5lVmFycy50cmlwbGV0Zm9udCA9IHtmYWNlOiBcIlRpbWVzXCIsIHNpemU6IDExLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIn07XG5cdFx0bXVsdGlsaW5lVmFycy52b2NhbGZvbnQgID0geyBmYWNlOiBcIlxcXCJUaW1lcyBOZXcgUm9tYW5cXFwiXCIsIHNpemU6IDEzLCB3ZWlnaHQ6IFwiYm9sZFwiLCBzdHlsZTogXCJub3JtYWxcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRtdWx0aWxpbmVWYXJzLndvcmRzZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTYsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cblx0XHQvLyBUaGVzZSBmb250cyBhcmUgZ2xvYmFsIGZvciB0aGUgZW50aXJlIHR1bmUuXG5cdFx0dHVuZS5mb3JtYXR0aW5nLmNvbXBvc2VyZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTQsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0dHVuZS5mb3JtYXR0aW5nLnN1YnRpdGxlZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTYsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0dHVuZS5mb3JtYXR0aW5nLnRlbXBvZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTUsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdHR1bmUuZm9ybWF0dGluZy50aXRsZWZvbnQgID0geyBmYWNlOiBcIlxcXCJUaW1lcyBOZXcgUm9tYW5cXFwiXCIsIHNpemU6IDIwLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdHR1bmUuZm9ybWF0dGluZy5mb290ZXJmb250ICA9IHsgZmFjZTogXCJcXFwiVGltZXMgTmV3IFJvbWFuXFxcIlwiLCBzaXplOiAxMiwgd2VpZ2h0OiBcIm5vcm1hbFwiLCBzdHlsZTogXCJub3JtYWxcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHR0dW5lLmZvcm1hdHRpbmcuaGVhZGVyZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0dHVuZS5mb3JtYXR0aW5nLnZvaWNlZm9udCAgPSB7IGZhY2U6IFwiXFxcIlRpbWVzIE5ldyBSb21hblxcXCJcIiwgc2l6ZTogMTMsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXG5cdFx0Ly8gdGhlc2UgYXJlIHRoZSBkZWZhdWx0IGZvbnRzIGZvciB0aGVzZSBlbGVtZW50IHR5cGVzLiBJbiB0aGUgcHJpbnRlciwgdGhlc2UgZm9udHMgbWlnaHQgY2hhbmdlIGFzIHRoZSB0dW5lIHByb2dyZXNzZXMuXG5cdFx0dHVuZS5mb3JtYXR0aW5nLmFubm90YXRpb25mb250ICA9IG11bHRpbGluZVZhcnMuYW5ub3RhdGlvbmZvbnQ7XG5cdFx0dHVuZS5mb3JtYXR0aW5nLmdjaG9yZGZvbnQgID0gbXVsdGlsaW5lVmFycy5nY2hvcmRmb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy5oaXN0b3J5Zm9udCAgPSBtdWx0aWxpbmVWYXJzLmhpc3Rvcnlmb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy5pbmZvZm9udCAgPSBtdWx0aWxpbmVWYXJzLmluZm9mb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy5tZWFzdXJlZm9udCAgPSBtdWx0aWxpbmVWYXJzLm1lYXN1cmVmb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy5wYXJ0c2ZvbnQgID0gbXVsdGlsaW5lVmFycy5wYXJ0c2ZvbnQ7XG5cdFx0dHVuZS5mb3JtYXR0aW5nLnJlcGVhdGZvbnQgID0gbXVsdGlsaW5lVmFycy5yZXBlYXRmb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy50ZXh0Zm9udCAgPSBtdWx0aWxpbmVWYXJzLnRleHRmb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy50cmlwbGV0Zm9udCAgPSBtdWx0aWxpbmVWYXJzLnRyaXBsZXRmb250O1xuXHRcdHR1bmUuZm9ybWF0dGluZy52b2NhbGZvbnQgID0gbXVsdGlsaW5lVmFycy52b2NhbGZvbnQ7XG5cdFx0dHVuZS5mb3JtYXR0aW5nLndvcmRzZm9udCAgPSBtdWx0aWxpbmVWYXJzLndvcmRzZm9udDtcblx0fVxuXG5cdHZhciBmb250VHlwZUNhbkhhdmVCb3ggPSB7IGdjaG9yZGZvbnQ6IHRydWUsIG1lYXN1cmVmb250OiB0cnVlLCBwYXJ0c2ZvbnQ6IHRydWUgfTtcblxuXHR2YXIgZm9udFRyYW5zbGF0aW9uID0gZnVuY3Rpb24oZm9udEZhY2UpIHtcblx0XHQvLyBUaGlzIHRyYW5zbGF0ZXMgUG9zdHNjcmlwdCBmb250cyBmb3IgYSB3ZWIgYWx0ZXJuYXRpdmUuXG5cdFx0Ly8gTm90ZSB0aGF0IHRoZSBwb3N0c2NyaXB0IGZvbnRzIGNvbnRhaW4gaXRhbGljIGFuZCBib2xkIGluZm8gaW4gdGhlbSwgc28gd2hhdCBpcyByZXR1cm5lZCBpcyBhIGhhc2guXG5cblx0XHRzd2l0Y2ggKGZvbnRGYWNlKSB7XG5cdFx0XHRjYXNlIFwiQXJpYWwtSXRhbGljXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiQXJpYWxcIiwgd2VpZ2h0OiBcIm5vcm1hbFwiLCBzdHlsZTogXCJpdGFsaWNcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJBcmlhbC1Cb2xkXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiQXJpYWxcIiwgd2VpZ2h0OiBcImJvbGRcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiQm9va21hbi1EZW1pXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiQm9va21hbixzZXJpZlwiLCB3ZWlnaHQ6IFwiYm9sZFwiLCBzdHlsZTogXCJub3JtYWxcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJCb29rbWFuLURlbWlJdGFsaWNcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJCb29rbWFuLHNlcmlmXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkJvb2ttYW4tTGlnaHRcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJCb29rbWFuLHNlcmlmXCIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiQm9va21hbi1MaWdodEl0YWxpY1wiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIkJvb2ttYW4sc2VyaWZcIiwgd2VpZ2h0OiBcIm5vcm1hbFwiLCBzdHlsZTogXCJpdGFsaWNcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJDb3VyaWVyXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiXFxcIkNvdXJpZXIgTmV3XFxcIlwiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkNvdXJpZXItT2JsaXF1ZVwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJDb3VyaWVyIE5ld1xcXCJcIiwgd2VpZ2h0OiBcIm5vcm1hbFwiLCBzdHlsZTogXCJpdGFsaWNcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJDb3VyaWVyLUJvbGRcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJcXFwiQ291cmllciBOZXdcXFwiXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkNvdXJpZXItQm9sZE9ibGlxdWVcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJcXFwiQ291cmllciBOZXdcXFwiXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkF2YW50R2FyZGUtQm9va1wiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIkF2YW50R2FyZGUsQXJpYWxcIiwgd2VpZ2h0OiBcIm5vcm1hbFwiLCBzdHlsZTogXCJub3JtYWxcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJBdmFudEdhcmRlLUJvb2tPYmxpcXVlXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiQXZhbnRHYXJkZSxBcmlhbFwiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkF2YW50R2FyZGUtRGVtaVwiOlxuXHRcdFx0Y2FzZSBcIkF2YW50LUdhcmRlLURlbWlcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJBdmFudEdhcmRlLEFyaWFsXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkF2YW50R2FyZGUtRGVtaU9ibGlxdWVcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJBdmFudEdhcmRlLEFyaWFsXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkhlbHZldGljYS1PYmxpcXVlXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiSGVsdmV0aWNhXCIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiSGVsdmV0aWNhLUJvbGRcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJIZWx2ZXRpY2FcIiwgd2VpZ2h0OiBcImJvbGRcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiSGVsdmV0aWNhLUJvbGRPYmxpcXVlXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiSGVsdmV0aWNhXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkhlbHZldGljYS1OYXJyb3dcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJcXFwiSGVsdmV0aWNhIE5hcnJvd1xcXCIsSGVsdmV0aWNhXCIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiSGVsdmV0aWNhLU5hcnJvdy1PYmxpcXVlXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiXFxcIkhlbHZldGljYSBOYXJyb3dcXFwiLEhlbHZldGljYVwiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIkhlbHZldGljYS1OYXJyb3ctQm9sZFwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJIZWx2ZXRpY2EgTmFycm93XFxcIixIZWx2ZXRpY2FcIiwgd2VpZ2h0OiBcImJvbGRcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiSGVsdmV0aWNhLU5hcnJvdy1Cb2xkT2JsaXF1ZVwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJIZWx2ZXRpY2EgTmFycm93XFxcIixIZWx2ZXRpY2FcIiwgd2VpZ2h0OiBcImJvbGRcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiUGFsYXRpbm8tUm9tYW5cIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJQYWxhdGlub1wiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIlBhbGF0aW5vLUl0YWxpY1wiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlBhbGF0aW5vXCIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiUGFsYXRpbm8tQm9sZFwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlBhbGF0aW5vXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIlBhbGF0aW5vLUJvbGRJdGFsaWNcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJQYWxhdGlub1wiLCB3ZWlnaHQ6IFwiYm9sZFwiLCBzdHlsZTogXCJpdGFsaWNcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJOZXdDZW50dXJ5U2NobGJrLVJvbWFuXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiXFxcIk5ldyBDZW50dXJ5XFxcIixzZXJpZlwiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIk5ld0NlbnR1cnlTY2hsYmstSXRhbGljXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiXFxcIk5ldyBDZW50dXJ5XFxcIixzZXJpZlwiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIml0YWxpY1wiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIk5ld0NlbnR1cnlTY2hsYmstQm9sZFwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJOZXcgQ2VudHVyeVxcXCIsc2VyaWZcIiwgd2VpZ2h0OiBcImJvbGRcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiTmV3Q2VudHVyeVNjaGxiay1Cb2xkSXRhbGljXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiXFxcIk5ldyBDZW50dXJ5XFxcIixzZXJpZlwiLCB3ZWlnaHQ6IFwiYm9sZFwiLCBzdHlsZTogXCJpdGFsaWNcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJUaW1lc1wiOlxuXHRcdFx0Y2FzZSBcIlRpbWVzLVJvbWFuXCI6XG5cdFx0XHRjYXNlIFwiVGltZXMtTmFycm93XCI6XG5cdFx0XHRjYXNlIFwiVGltZXMtQ291cmllclwiOlxuXHRcdFx0Y2FzZSBcIlRpbWVzLU5ldy1Sb21hblwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJUaW1lcyBOZXcgUm9tYW5cXFwiXCIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwibm9ybWFsXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiVGltZXMtSXRhbGljXCI6XG5cdFx0XHRjYXNlIFwiVGltZXMtSXRhbGljc1wiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJUaW1lcyBOZXcgUm9tYW5cXFwiXCIsIHdlaWdodDogXCJub3JtYWxcIiwgc3R5bGU6IFwiaXRhbGljXCIsIGRlY29yYXRpb246IFwibm9uZVwiIH07XG5cdFx0XHRjYXNlIFwiVGltZXMtQm9sZFwiOlxuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBcIlxcXCJUaW1lcyBOZXcgUm9tYW5cXFwiXCIsIHdlaWdodDogXCJib2xkXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiB9O1xuXHRcdFx0Y2FzZSBcIlRpbWVzLUJvbGRJdGFsaWNcIjpcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJcXFwiVGltZXMgTmV3IFJvbWFuXFxcIlwiLCB3ZWlnaHQ6IFwiYm9sZFwiLCBzdHlsZTogXCJpdGFsaWNcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGNhc2UgXCJaYXBmQ2hhbmNlcnktTWVkaXVtSXRhbGljXCI6XG5cdFx0XHRcdHJldHVybiB7IGZhY2U6IFwiXFxcIlphcGYgQ2hhbmNlcnlcXFwiLGN1cnNpdmUsc2VyaWZcIiwgd2VpZ2h0OiBcIm5vcm1hbFwiLCBzdHlsZTogXCJub3JtYWxcIiwgZGVjb3JhdGlvbjogXCJub25lXCIgfTtcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0fTtcblxuXHR2YXIgZ2V0Rm9udFBhcmFtZXRlciA9IGZ1bmN0aW9uKHRva2VucywgY3VycmVudFNldHRpbmcsIHN0ciwgcG9zaXRpb24sIGNtZCkge1xuXHRcdC8vIEV2ZXJ5IGZvbnQgcGFyYW1ldGVyIGhhcyB0aGUgZm9sbG93aW5nIGZvcm1hdDpcblx0XHQvLyA8ZmFjZT4gPHV0Zjg+IDxzaXplPiA8bW9kaWZpZXJzPiA8Ym94PlxuXHRcdC8vIFdoZXJlOlxuXHRcdC8vIGZhY2U6IGVpdGhlciBhIHN0YW5kYXJkIHdlYiBmb250IG5hbWUsIG9yIGEgcG9zdHNjcmlwdCBmb250LCBlbnVtZXJhdGVkIGluIGZvbnRUcmFuc2xhdGlvbi4gVGhpcyBjb3VsZCBhbHNvIGJlIGFuICogb3IgYmUgbWlzc2luZyBpZiB0aGUgZmFjZSBzaG91bGRuJ3QgY2hhbmdlLlxuXHRcdC8vIHV0Zjg6IFRoaXMgaXMgb3B0aW9uYWwsIGFuZCBzcGVjaWZpZXMgdXRmOC4gVGhhdCdzIGFsbCB0aGF0IGlzIHN1cHBvcnRlZCBzbyB0aGUgZmllbGQgaXMganVzdCBzaWxlbnRseSBpZ25vcmVkLlxuXHRcdC8vIHNpemU6IFRoZSBzaXplLCBpbiBwaXhlbHMuIFRoaXMgbWF5IGJlIG9taXR0ZWQgaWYgdGhlIHNpemUgaXMgbm90IGNoYW5naW5nLlxuXHRcdC8vIG1vZGlmaWVyczogemVybyBvciBtb3JlIG9mIFwiYm9sZFwiLCBcIml0YWxpY1wiLCBcInVuZGVybGluZVwiXG5cdFx0Ly8gYm94OiBPbmx5IGFwcGxpZXMgdG8gdGhlIG1lYXN1cmUgbnVtYmVycywgZ2Nob3JkcywgYW5kIHRoZSBwYXJ0cy4gSWYgcHJlc2VudCwgdGhlbiBhIGJveCBpcyBkcmF3biBhcm91bmQgdGhlIGNoYXJhY3RlcnMuXG5cdFx0Ly8gSWYgZmFjZSBpcyBwcmVzZW50LCB0aGVuIGFsbCB0aGUgbW9kaWZpZXJzIGFyZSBjbGVhcmVkLiBJZiBmYWNlIGlzIGFic2VudCwgdGhlbiB0aGUgbW9kaWZpZXJzIGFyZSBpbGxlZ2FsLlxuXHRcdC8vIFRoZSBmYWNlIGNhbiBiZSBhIHNpbmdsZSB3b3JkLCBhIHNldCBvZiB3b3JkcyBzZXBhcmF0ZWQgYnkgaHlwaGVucywgb3IgYSBxdW90ZWQgc3RyaW5nLlxuXHRcdC8vXG5cdFx0Ly8gU28sIGluIHByYWN0aWNhbGl0eSwgdGhlcmUgYXJlIHRocmVlIHR5cGVzIG9mIGZvbnQgZGVmaW5pdGlvbnM6IGEgbnVtYmVyIG9ubHksIGFuIGFzdGVyaXNrIGFuZCBhIG51bWJlciBvbmx5LCBvciB0aGUgZnVsbCBkZWZpbml0aW9uICh3aXRoIGFuIG9wdGlvbmFsIHNpemUpLlxuXHRcdGZ1bmN0aW9uIHByb2Nlc3NOdW1iZXJPbmx5KCkge1xuXHRcdFx0dmFyIHNpemUgPSBwYXJzZUludCh0b2tlbnNbMF0udG9rZW4pO1xuXHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRpZiAoIWN1cnJlbnRTZXR0aW5nKSB7XG5cdFx0XHRcdHdhcm4oXCJDYW4ndCBzZXQganVzdCB0aGUgc2l6ZSBvZiB0aGUgZm9udCBzaW5jZSB0aGVyZSBpcyBubyBkZWZhdWx0IHZhbHVlLlwiLCBzdHIsIHBvc2l0aW9uKTtcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogXCJcXFwiVGltZXMgTmV3IFJvbWFuXFxcIlwiLCB3ZWlnaHQ6IFwibm9ybWFsXCIsIHN0eWxlOiBcIm5vcm1hbFwiLCBkZWNvcmF0aW9uOiBcIm5vbmVcIiwgc2l6ZTogc2l6ZX07XG5cdFx0XHR9XG5cdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRyZXR1cm4geyBmYWNlOiBjdXJyZW50U2V0dGluZy5mYWNlLCB3ZWlnaHQ6IGN1cnJlbnRTZXR0aW5nLndlaWdodCwgc3R5bGU6IGN1cnJlbnRTZXR0aW5nLnN0eWxlLCBkZWNvcmF0aW9uOiBjdXJyZW50U2V0dGluZy5kZWNvcmF0aW9uLCBzaXplOiBzaXplfTtcblx0XHRcdH1cblx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAxICYmIHRva2Vuc1swXS50b2tlbiA9PT0gXCJib3hcIiAmJiBmb250VHlwZUNhbkhhdmVCb3hbY21kXSlcblx0XHRcdFx0cmV0dXJuIHsgZmFjZTogY3VycmVudFNldHRpbmcuZmFjZSwgd2VpZ2h0OiBjdXJyZW50U2V0dGluZy53ZWlnaHQsIHN0eWxlOiBjdXJyZW50U2V0dGluZy5zdHlsZSwgZGVjb3JhdGlvbjogY3VycmVudFNldHRpbmcuZGVjb3JhdGlvbiwgc2l6ZTogc2l6ZSwgYm94OiB0cnVlfTtcblx0XHRcdHdhcm4oXCJFeHRyYSBwYXJhbWV0ZXJzIGluIGZvbnQgZGVmaW5pdGlvbi5cIiwgc3RyLCBwb3NpdGlvbik7XG5cdFx0XHRyZXR1cm4geyBmYWNlOiBjdXJyZW50U2V0dGluZy5mYWNlLCB3ZWlnaHQ6IGN1cnJlbnRTZXR0aW5nLndlaWdodCwgc3R5bGU6IGN1cnJlbnRTZXR0aW5nLnN0eWxlLCBkZWNvcmF0aW9uOiBjdXJyZW50U2V0dGluZy5kZWNvcmF0aW9uLCBzaXplOiBzaXplfTtcblx0XHR9XG5cblx0XHQvLyBmb3JtYXQgMTogYXN0ZXJpc2sgYW5kIG51bWJlciBvbmx5XG5cdFx0aWYgKHRva2Vuc1swXS50b2tlbiA9PT0gJyonKSB7XG5cdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdGlmICh0b2tlbnNbMF0udHlwZSA9PT0gJ251bWJlcicpXG5cdFx0XHRcdHJldHVybiBwcm9jZXNzTnVtYmVyT25seSgpO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBmb250IHNpemUgbnVtYmVyIGFmdGVyICouXCIsIHN0ciwgcG9zaXRpb24pO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIGZvcm1hdCAyOiBudW1iZXIgb25seVxuXHRcdGlmICh0b2tlbnNbMF0udHlwZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdHJldHVybiBwcm9jZXNzTnVtYmVyT25seSgpO1xuXHRcdH1cblxuXHRcdC8vIGZvcm1hdCAzOiB3aG9sZSBkZWZpbml0aW9uXG5cdFx0dmFyIGZhY2UgPSBbXTtcblx0XHR2YXIgc2l6ZTtcblx0XHR2YXIgd2VpZ2h0ID0gXCJub3JtYWxcIjtcblx0XHR2YXIgc3R5bGUgPSBcIm5vcm1hbFwiO1xuXHRcdHZhciBkZWNvcmF0aW9uID0gXCJub25lXCI7XG5cdFx0dmFyIGJveCA9IGZhbHNlO1xuXHRcdHZhciBzdGF0ZSA9ICdmYWNlJztcblx0XHR2YXIgaHlwaGVuTGFzdCA9IGZhbHNlO1xuXHRcdHdoaWxlICh0b2tlbnMubGVuZ3RoKSB7XG5cdFx0XHR2YXIgY3VyclRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHR2YXIgd29yZCA9IGN1cnJUb2tlbi50b2tlbi50b0xvd2VyQ2FzZSgpO1xuXHRcdFx0c3dpdGNoIChzdGF0ZSkge1xuXHRcdFx0XHRjYXNlICdmYWNlJzpcblx0XHRcdFx0XHRpZiAoaHlwaGVuTGFzdCB8fCAod29yZCAhPT0gJ3V0ZicgJiYgY3VyclRva2VuLnR5cGUgIT09ICdudW1iZXInICYmIHdvcmQgIT09IFwiYm9sZFwiICYmIHdvcmQgIT09IFwiaXRhbGljXCIgJiYgd29yZCAhPT0gXCJ1bmRlcmxpbmVcIiAmJiB3b3JkICE9PSBcImJveFwiKSkge1xuXHRcdFx0XHRcdFx0aWYgKGZhY2UubGVuZ3RoID4gMCAmJiBjdXJyVG9rZW4udG9rZW4gPT09ICctJykge1xuXHRcdFx0XHRcdFx0XHRoeXBoZW5MYXN0ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0ZmFjZVtmYWNlLmxlbmd0aC0xXSA9IGZhY2VbZmFjZS5sZW5ndGgtMV0gKyBjdXJyVG9rZW4udG9rZW47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRcdFx0aWYgKGh5cGhlbkxhc3QpIHtcblx0XHRcdFx0XHRcdFx0XHRoeXBoZW5MYXN0ID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdFx0ZmFjZVtmYWNlLmxlbmd0aC0xXSA9IGZhY2VbZmFjZS5sZW5ndGgtMV0gKyBjdXJyVG9rZW4udG9rZW47XG5cdFx0XHRcdFx0XHRcdH0gZWxzZVxuXHRcdFx0XHRcdFx0XHRcdGZhY2UucHVzaChjdXJyVG9rZW4udG9rZW4pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRpZiAoY3VyclRva2VuLnR5cGUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChzaXplKSB7XG5cdFx0XHRcdFx0XHRcdFx0d2FybihcIkZvbnQgc2l6ZSBzcGVjaWZpZWQgdHdpY2UgaW4gZm9udCBkZWZpbml0aW9uLlwiLCBzdHIsIHBvc2l0aW9uKTtcblx0XHRcdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdFx0XHRzaXplID0gY3VyclRva2VuLnRva2VuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdHN0YXRlID0gJ21vZGlmaWVyJztcblx0XHRcdFx0XHRcdH0gZWxzZSBpZiAod29yZCA9PT0gXCJib2xkXCIpXG5cdFx0XHRcdFx0XHRcdHdlaWdodCA9IFwiYm9sZFwiO1xuXHRcdFx0XHRcdFx0ZWxzZSBpZiAod29yZCA9PT0gXCJpdGFsaWNcIilcblx0XHRcdFx0XHRcdFx0c3R5bGUgPSBcIml0YWxpY1wiO1xuXHRcdFx0XHRcdFx0ZWxzZSBpZiAod29yZCA9PT0gXCJ1bmRlcmxpbmVcIilcblx0XHRcdFx0XHRcdFx0ZGVjb3JhdGlvbiA9IFwidW5kZXJsaW5lXCI7XG5cdFx0XHRcdFx0XHRlbHNlIGlmICh3b3JkID09PSBcImJveFwiKSB7XG5cdFx0XHRcdFx0XHRcdGlmIChmb250VHlwZUNhbkhhdmVCb3hbY21kXSlcblx0XHRcdFx0XHRcdFx0XHRib3ggPSB0cnVlO1xuXHRcdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdFx0d2FybihcIlRoaXMgZm9udCBzdHlsZSBkb2Vzbid0IHN1cHBvcnQgXFxcImJveFxcXCJcIiwgc3RyLCBwb3NpdGlvbik7XG5cdFx0XHRcdFx0XHRcdHN0YXRlID0gXCJmaW5pc2hlZFwiO1xuXHRcdFx0XHRcdFx0fSBlbHNlIGlmICh3b3JkID09PSBcInV0ZlwiKSB7XG5cdFx0XHRcdFx0XHRcdGN1cnJUb2tlbiA9IHRva2Vucy5zaGlmdCgpOyAvLyB0aGlzIGdldHMgcmlkIG9mIHRoZSBcIjhcIiBhZnRlciBcInV0ZlwiXG5cdFx0XHRcdFx0XHRcdHN0YXRlID0gXCJzaXplXCI7XG5cdFx0XHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0XHRcdFx0d2FybihcIlVua25vd24gcGFyYW1ldGVyIFwiICsgY3VyclRva2VuLnRva2VuICsgXCIgaW4gZm9udCBkZWZpbml0aW9uLlwiLCBzdHIsIHBvc2l0aW9uKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJzaXplXCI6XG5cdFx0XHRcdFx0aWYgKGN1cnJUb2tlbi50eXBlID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRcdFx0aWYgKHNpemUpIHtcblx0XHRcdFx0XHRcdFx0d2FybihcIkZvbnQgc2l6ZSBzcGVjaWZpZWQgdHdpY2UgaW4gZm9udCBkZWZpbml0aW9uLlwiLCBzdHIsIHBvc2l0aW9uKTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHNpemUgPSBjdXJyVG9rZW4udG9rZW47XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBmb250IHNpemUgaW4gZm9udCBkZWZpbml0aW9uLlwiLCBzdHIsIHBvc2l0aW9uKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0c3RhdGUgPSAnbW9kaWZpZXInO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwibW9kaWZpZXJcIjpcblx0XHRcdFx0XHRpZiAod29yZCA9PT0gXCJib2xkXCIpXG5cdFx0XHRcdFx0XHR3ZWlnaHQgPSBcImJvbGRcIjtcblx0XHRcdFx0XHRlbHNlIGlmICh3b3JkID09PSBcIml0YWxpY1wiKVxuXHRcdFx0XHRcdFx0c3R5bGUgPSBcIml0YWxpY1wiO1xuXHRcdFx0XHRcdGVsc2UgaWYgKHdvcmQgPT09IFwidW5kZXJsaW5lXCIpXG5cdFx0XHRcdFx0XHRkZWNvcmF0aW9uID0gXCJ1bmRlcmxpbmVcIjtcblx0XHRcdFx0XHRlbHNlIGlmICh3b3JkID09PSBcImJveFwiKSB7XG5cdFx0XHRcdFx0XHRpZiAoZm9udFR5cGVDYW5IYXZlQm94W2NtZF0pXG5cdFx0XHRcdFx0XHRcdGJveCA9IHRydWU7XG5cdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdHdhcm4oXCJUaGlzIGZvbnQgc3R5bGUgZG9lc24ndCBzdXBwb3J0IFxcXCJib3hcXFwiXCIsIHN0ciwgcG9zaXRpb24pO1xuXHRcdFx0XHRcdFx0c3RhdGUgPSBcImZpbmlzaGVkXCI7XG5cdFx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0XHR3YXJuKFwiVW5rbm93biBwYXJhbWV0ZXIgXCIgKyBjdXJyVG9rZW4udG9rZW4gKyBcIiBpbiBmb250IGRlZmluaXRpb24uXCIsIHN0ciwgcG9zaXRpb24pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiZmluaXNoZWRcIjpcblx0XHRcdFx0XHR3YXJuKFwiRXh0cmEgY2hhcmFjdGVycyBmb3VuZCBhZnRlciBcXFwiYm94XFxcIiBpbiBmb250IGRlZmluaXRpb24uXCIsIHN0ciwgcG9zaXRpb24pO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChzaXplID09PSB1bmRlZmluZWQpIHtcblx0XHRcdGlmICghY3VycmVudFNldHRpbmcpIHtcblx0XHRcdFx0d2FybihcIk11c3Qgc3BlY2lmeSB0aGUgc2l6ZSBvZiB0aGUgZm9udCBzaW5jZSB0aGVyZSBpcyBubyBkZWZhdWx0IHZhbHVlLlwiLCBzdHIsIHBvc2l0aW9uKTtcblx0XHRcdFx0c2l6ZSA9IDEyO1xuXHRcdFx0fSBlbHNlXG5cdFx0XHRcdHNpemUgPSBjdXJyZW50U2V0dGluZy5zaXplO1xuXHRcdH0gZWxzZVxuXHRcdFx0c2l6ZSA9IHBhcnNlRmxvYXQoc2l6ZSk7XG5cblx0XHRmYWNlID0gZmFjZS5qb2luKCcgJyk7XG5cdFx0dmFyIHBzRm9udCA9IGZvbnRUcmFuc2xhdGlvbihmYWNlKTtcblx0XHR2YXIgZm9udCA9IHt9O1xuXHRcdGlmIChwc0ZvbnQpIHtcblx0XHRcdGZvbnQuZmFjZSA9IHBzRm9udC5mYWNlO1xuXHRcdFx0Zm9udC53ZWlnaHQgPSBwc0ZvbnQud2VpZ2h0O1xuXHRcdFx0Zm9udC5zdHlsZSA9IHBzRm9udC5zdHlsZTtcblx0XHRcdGZvbnQuZGVjb3JhdGlvbiA9IHBzRm9udC5kZWNvcmF0aW9uO1xuXHRcdFx0Zm9udC5zaXplID0gc2l6ZTtcblx0XHRcdGlmIChib3gpXG5cdFx0XHRcdGZvbnQuYm94ID0gdHJ1ZTtcblx0XHRcdHJldHVybiBmb250O1xuXHRcdH1cblx0XHRmb250LmZhY2UgPSBmYWNlO1xuXHRcdGZvbnQud2VpZ2h0ID0gd2VpZ2h0O1xuXHRcdGZvbnQuc3R5bGUgPSBzdHlsZTtcblx0XHRmb250LmRlY29yYXRpb24gPSBkZWNvcmF0aW9uO1xuXHRcdGZvbnQuc2l6ZSA9IHNpemU7XG5cdFx0aWYgKGJveClcblx0XHRcdGZvbnQuYm94ID0gdHJ1ZTtcblx0XHRyZXR1cm4gZm9udDtcblx0fTtcblxuXHR2YXIgZ2V0Q2hhbmdpbmdGb250ID0gZnVuY3Rpb24oY21kLCB0b2tlbnMsIHN0cikge1xuXHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKVxuXHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyBhIGZvbnQgYXMgYSBwYXJhbWV0ZXIuXCI7XG5cdFx0bXVsdGlsaW5lVmFyc1tjbWRdID0gZ2V0Rm9udFBhcmFtZXRlcih0b2tlbnMsIG11bHRpbGluZVZhcnNbY21kXSwgc3RyLCAwLCBjbWQpO1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLmlzX2luX2hlYWRlcikgLy8gSWYgdGhlIGZvbnQgYXBwZWFycyBpbiB0aGUgaGVhZGVyLCB0aGVuIGl0IGJlY29tZXMgdGhlIGRlZmF1bHQgZm9udC5cblx0XHRcdHR1bmUuZm9ybWF0dGluZ1tjbWRdID0gbXVsdGlsaW5lVmFyc1tjbWRdO1xuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXHR2YXIgZ2V0R2xvYmFsRm9udCA9IGZ1bmN0aW9uKGNtZCwgdG9rZW5zLCBzdHIpIHtcblx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMClcblx0XHRcdHJldHVybiBcIkRpcmVjdGl2ZSBcXFwiXCIgKyBjbWQgKyBcIlxcXCIgcmVxdWlyZXMgYSBmb250IGFzIGEgcGFyYW1ldGVyLlwiO1xuXHRcdHR1bmUuZm9ybWF0dGluZ1tjbWRdID0gZ2V0Rm9udFBhcmFtZXRlcih0b2tlbnMsIHR1bmUuZm9ybWF0dGluZ1tjbWRdLCBzdHIsIDAsIGNtZCk7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG5cblx0dmFyIHNldFNjYWxlID0gZnVuY3Rpb24oY21kLCB0b2tlbnMpIHtcblx0XHR2YXIgc2NyYXRjaCA9IFwiXCI7XG5cdFx0cGFyc2VDb21tb24uZWFjaCh0b2tlbnMsIGZ1bmN0aW9uKHRvaykge1xuXHRcdFx0c2NyYXRjaCArPSB0b2sudG9rZW47XG5cdFx0fSk7XG5cdFx0dmFyIG51bSA9IHBhcnNlRmxvYXQoc2NyYXRjaCk7XG5cdFx0aWYgKGlzTmFOKG51bSkgfHwgbnVtID09PSAwKVxuXHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyBhIG51bWJlciBhcyBhIHBhcmFtZXRlci5cIjtcblx0XHR0dW5lLmZvcm1hdHRpbmcuc2NhbGUgPSBudW07XG5cblx0fTtcblxuXHR2YXIgZ2V0UmVxdWlyZWRNZWFzdXJlbWVudCA9IGZ1bmN0aW9uKGNtZCwgdG9rZW5zKSB7XG5cdFx0dmFyIHBvaW50cyA9IHRva2VuaXplci5nZXRNZWFzdXJlbWVudCh0b2tlbnMpO1xuXHRcdGlmIChwb2ludHMudXNlZCA9PT0gMCB8fCB0b2tlbnMubGVuZ3RoICE9PSAwKVxuXHRcdFx0cmV0dXJuIHsgZXJyb3I6IFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyBhIG1lYXN1cmVtZW50IGFzIGEgcGFyYW1ldGVyLlwifTtcblx0XHRyZXR1cm4gcG9pbnRzLnZhbHVlO1xuXHR9O1xuXHR2YXIgb25lUGFyYW1ldGVyTWVhc3VyZW1lbnQgPSBmdW5jdGlvbihjbWQsIHRva2Vucykge1xuXHRcdHZhciBwb2ludHMgPSB0b2tlbml6ZXIuZ2V0TWVhc3VyZW1lbnQodG9rZW5zKTtcblx0XHRpZiAocG9pbnRzLnVzZWQgPT09IDAgfHwgdG9rZW5zLmxlbmd0aCAhPT0gMClcblx0XHRcdHJldHVybiBcIkRpcmVjdGl2ZSBcXFwiXCIgKyBjbWQgKyBcIlxcXCIgcmVxdWlyZXMgYSBtZWFzdXJlbWVudCBhcyBhIHBhcmFtZXRlci5cIjtcblx0XHR0dW5lLmZvcm1hdHRpbmdbY21kXSA9IHBvaW50cy52YWx1ZTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblxuXHR2YXIgYWRkTXVsdGlsaW5lVmFyID0gZnVuY3Rpb24oa2V5LCBjbWQsIHRva2VucywgbWluLCBtYXgpIHtcblx0XHRpZiAodG9rZW5zLmxlbmd0aCAhPT0gMSB8fCB0b2tlbnNbMF0udHlwZSAhPT0gJ251bWJlcicpXG5cdFx0XHRyZXR1cm4gXCJEaXJlY3RpdmUgXFxcIlwiICsgY21kICsgXCJcXFwiIHJlcXVpcmVzIGEgbnVtYmVyIGFzIGEgcGFyYW1ldGVyLlwiO1xuXHRcdHZhciBpID0gdG9rZW5zWzBdLmludHQ7XG5cdFx0aWYgKG1pbiAhPT0gdW5kZWZpbmVkICYmIGkgPCBtaW4pXG5cdFx0XHRyZXR1cm4gXCJEaXJlY3RpdmUgXFxcIlwiICsgY21kICsgXCJcXFwiIHJlcXVpcmVzIGEgbnVtYmVyIGdyZWF0ZXIgdGhhbiBvciBlcXVhbCB0byBcIiArIG1pbiArIFwiIGFzIGEgcGFyYW1ldGVyLlwiO1xuXHRcdGlmIChtYXggIT09IHVuZGVmaW5lZCAmJiBpID4gbWF4KVxuXHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyBhIG51bWJlciBsZXNzIHRoYW4gb3IgZXF1YWwgdG8gXCIgKyBtYXggKyBcIiBhcyBhIHBhcmFtZXRlci5cIjtcblx0XHRtdWx0aWxpbmVWYXJzW2tleV0gPSBpO1xuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cdHZhciBhZGRNdWx0aWxpbmVWYXJCb29sID0gZnVuY3Rpb24oa2V5LCBjbWQsIHRva2Vucykge1xuXHRcdHZhciBzdHIgPSBhZGRNdWx0aWxpbmVWYXIoa2V5LCBjbWQsIHRva2VucywgMCwgMSk7XG5cdFx0aWYgKHN0ciAhPT0gbnVsbCkgcmV0dXJuIHN0cjtcblx0XHRtdWx0aWxpbmVWYXJzW2tleV0gPSAobXVsdGlsaW5lVmFyc1trZXldID09PSAxKTtcblx0XHRyZXR1cm4gbnVsbDtcblx0fTtcblxuXHR2YXIgYWRkTXVsdGlsaW5lVmFyT25lUGFyYW1DaG9pY2UgPSBmdW5jdGlvbihrZXksIGNtZCwgdG9rZW5zLCBjaG9pY2VzKSB7XG5cdFx0aWYgKHRva2Vucy5sZW5ndGggIT09IDEpXG5cdFx0XHRyZXR1cm4gXCJEaXJlY3RpdmUgXFxcIlwiICsgY21kICsgXCJcXFwiIHJlcXVpcmVzIG9uZSBvZiBbIFwiICsgY2hvaWNlcy5qb2luKFwiLCBcIikgKyBcIiBdIGFzIGEgcGFyYW1ldGVyLlwiO1xuXHRcdHZhciBjaG9pY2UgPSB0b2tlbnNbMF0udG9rZW47XG5cdFx0dmFyIGZvdW5kID0gZmFsc2U7XG5cdFx0Zm9yICh2YXIgaSA9IDA7ICFmb3VuZCAmJiBpIDwgY2hvaWNlcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKGNob2ljZXNbaV0gPT09IGNob2ljZSlcblx0XHRcdFx0Zm91bmQgPSB0cnVlO1xuXHRcdH1cblx0XHRpZiAoIWZvdW5kKVxuXHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyBvbmUgb2YgWyBcIiArIGNob2ljZXMuam9pbihcIiwgXCIpICsgXCIgXSBhcyBhIHBhcmFtZXRlci5cIjtcblx0XHRtdWx0aWxpbmVWYXJzW2tleV0gPSBjaG9pY2U7XG5cdFx0cmV0dXJuIG51bGw7XG5cdH07XG5cblx0dmFyIG1pZGlDbWRQYXJhbTAgPSBbXG5cdFx0XCJub2JhcmxpbmVzXCIsXG5cdFx0XCJiYXJsaW5lc1wiLFxuXHRcdFwiYmVhdGFjY2VudHNcIixcblx0XHRcIm5vYmVhdGFjY2VudHNcIixcblx0XHRcImRyb25lb25cIixcblx0XHRcImRyb25lb2ZmXCIsXG5cdFx0XCJkcnVtb25cIixcblx0XHRcImRydW1vZmZcIixcblx0XHRcImZlcm1hdGFmaXhlZFwiLFxuXHRcdFwiZmVybWF0YXByb3BvcnRpb25hbFwiLFxuXHRcdFwiZ2Nob3Jkb25cIixcblx0XHRcImdjaG9yZG9mZlwiLFxuXHRcdFwiY29udHJvbGNvbWJvXCIsXG5cdFx0XCJ0ZW1wZXJhbWVudG5vcm1hbFwiLFxuXHRcdFwibm9wb3J0YW1lbnRvXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTFTdHJpbmcgPSBbXG5cdFx0XCJnY2hvcmRcIixcblx0XHRcInB0c3RyZXNzXCIsXG5cdFx0XCJiZWF0c3RyaW5nXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTFJbnRlZ2VyID0gW1xuXHRcdFwiYmFzc3ZvbFwiLFxuXHRcdFwiY2hvcmR2b2xcIixcblx0XHRcImNcIixcblx0XHRcImNoYW5uZWxcIixcblx0XHRcImJlYXRtb2RcIixcblx0XHRcImRlbHRhbG91ZG5lc3NcIixcblx0XHRcImRydW1iYXJzXCIsXG5cdFx0XCJncmFjZWRpdmlkZXJcIixcblx0XHRcIm1ha2VjaG9yZGNoYW5uZWxzXCIsXG5cdFx0XCJyYW5kb21jaG9yZGF0dGFja1wiLFxuXHRcdFwiY2hvcmRhdHRhY2tcIixcblx0XHRcInN0cmVzc21vZGVsXCIsXG5cdFx0XCJ0cmFuc3Bvc2VcIixcblx0XHRcInJ0cmFuc3Bvc2VcIixcblx0XHRcInZvbGluY1wiXG5cdF07XG5cdHZhciBtaWRpQ21kUGFyYW0xSW50ZWdlcjFPcHRpb25hbEludGVnZXIgPSBbXG5cdFx0XCJwcm9ncmFtXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTJJbnRlZ2VyID0gW1xuXHRcdFwicmF0aW9cIixcblx0XHRcInNudFwiLFxuXHRcdFwiYmVuZHZlbG9jaXR5XCIsXG5cdFx0XCJwaXRjaGJlbmRcIixcblx0XHRcImNvbnRyb2xcIixcblx0XHRcInRlbXBlcmFtZW50bGluZWFyXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTRJbnRlZ2VyID0gW1xuXHRcdFwiYmVhdFwiXG5cdF07XG5cdHZhciBtaWRpQ21kUGFyYW01SW50ZWdlciA9IFtcblx0XHRcImRyb25lXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTFJbnRlZ2VyT3B0aW9uYWxPY3RhdmUgPSBbXG5cdFx0XCJiYXNzcHJvZ1wiLFxuXHRcdFwiY2hvcmRwcm9nXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTFTdHJpbmcxSW50ZWdlciA9IFtcblx0XHRcInBvcnRhbWVudG9cIlxuXHRdO1xuXHR2YXIgbWlkaUNtZFBhcmFtRnJhY3Rpb24gPSBbXG5cdFx0XCJleHBhbmRcIixcblx0XHRcImdyYWNlXCIsXG5cdFx0XCJ0cmltXCJcblx0XTtcblx0dmFyIG1pZGlDbWRQYXJhbTFTdHJpbmdWYXJpYWJsZUludGVnZXJzID0gW1xuXHRcdFwiZHJ1bVwiLFxuXHRcdFwiY2hvcmRuYW1lXCJcblx0XTtcblxuXHR2YXIgcGFyc2VNaWRpQ29tbWFuZCA9IGZ1bmN0aW9uKG1pZGksIHR1bmUsIHJlc3RPZlN0cmluZykge1xuXHRcdHZhciBtaWRpX2NtZCA9IG1pZGkuc2hpZnQoKS50b2tlbjtcblx0XHR2YXIgbWlkaV9wYXJhbXMgPSBbXTtcblx0XHRpZiAobWlkaUNtZFBhcmFtMC5pbmRleE9mKG1pZGlfY21kKSA+PSAwKSB7XG5cdFx0XHQvLyBOTyBQQVJBTUVURVJTXG5cdFx0XHRpZiAobWlkaS5sZW5ndGggIT09IDApXG5cdFx0XHRcdHdhcm4oXCJVbmV4cGVjdGVkIHBhcmFtZXRlciBpbiBNSURJIFwiICsgbWlkaV9jbWQsIHJlc3RPZlN0cmluZywgMCk7XG5cdFx0fSBlbHNlIGlmIChtaWRpQ21kUGFyYW0xU3RyaW5nLmluZGV4T2YobWlkaV9jbWQpID49IDApIHtcblx0XHRcdC8vIE9ORSBTVFJJTkcgUEFSQU1FVEVSXG5cdFx0XHRpZiAobWlkaS5sZW5ndGggIT09IDEpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBvbmUgcGFyYW1ldGVyIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2Vcblx0XHRcdFx0bWlkaV9wYXJhbXMucHVzaChtaWRpWzBdLnRva2VuKTtcblx0XHR9IGVsc2UgaWYgKG1pZGlDbWRQYXJhbTFJbnRlZ2VyLmluZGV4T2YobWlkaV9jbWQpID49IDApIHtcblx0XHRcdC8vIE9ORSBJTlQgUEFSQU1FVEVSXG5cdFx0XHRpZiAobWlkaS5sZW5ndGggIT09IDEpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBvbmUgcGFyYW1ldGVyIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGlbMF0udHlwZSAhPT0gXCJudW1iZXJcIilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIG9uZSBpbnRlZ2VyIHBhcmFtZXRlciBpbiBNSURJIFwiICsgbWlkaV9jbWQsIHJlc3RPZlN0cmluZywgMCk7XG5cdFx0XHRlbHNlXG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVswXS5pbnR0KTtcblx0XHR9IGVsc2UgaWYgKG1pZGlDbWRQYXJhbTFJbnRlZ2VyMU9wdGlvbmFsSW50ZWdlci5pbmRleE9mKG1pZGlfY21kKSA+PSAwKSB7XG5cdFx0XHQvLyBPTkUgSU5UIFBBUkFNRVRFUiwgT05FIE9QVElPTkFMIFBBUkFNRVRFUlxuXHRcdFx0aWYgKG1pZGkubGVuZ3RoICE9PSAxICYmIG1pZGkubGVuZ3RoICE9PSAyKVxuXHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgb25lIG9yIHR3byBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGlbMF0udHlwZSAhPT0gXCJudW1iZXJcIilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGludGVnZXIgcGFyYW1ldGVyIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGkubGVuZ3RoID09PSAyICYmIG1pZGlbMV0udHlwZSAhPT0gXCJudW1iZXJcIilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGludGVnZXIgcGFyYW1ldGVyIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbMF0uaW50dCk7XG5cdFx0XHRcdGlmIChtaWRpLmxlbmd0aCA9PT0gMilcblx0XHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbMV0uaW50dCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChtaWRpQ21kUGFyYW0ySW50ZWdlci5pbmRleE9mKG1pZGlfY21kKSA+PSAwKSB7XG5cdFx0XHQvLyBUV08gSU5UIFBBUkFNRVRFUlNcblx0XHRcdGlmIChtaWRpLmxlbmd0aCAhPT0gMilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIHR3byBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGlbMF0udHlwZSAhPT0gXCJudW1iZXJcIiB8fCBtaWRpWzFdLnR5cGUgIT09IFwibnVtYmVyXCIpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCB0d28gaW50ZWdlciBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbMF0uaW50dCk7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVsxXS5pbnR0KTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKG1pZGlDbWRQYXJhbTFTdHJpbmcxSW50ZWdlci5pbmRleE9mKG1pZGlfY21kKSA+PSAwKSB7XG5cdFx0XHQvLyBPTkUgU1RSSU5HIFBBUkFNRVRFUiwgT05FIElOVCBQQVJBTUVURVJcblx0XHRcdGlmIChtaWRpLmxlbmd0aCAhPT0gMilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIHR3byBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGlbMF0udHlwZSAhPT0gXCJhbHBoYVwiIHx8IG1pZGlbMV0udHlwZSAhPT0gXCJudW1iZXJcIilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIG9uZSBzdHJpbmcgYW5kIG9uZSBpbnRlZ2VyIHBhcmFtZXRlcnMgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVswXS50b2tlbik7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVsxXS5pbnR0KTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKG1pZGlfY21kID09PSAnZHJ1bW1hcCcpIHtcblx0XHRcdC8vIEJVSUxEIEFOIE9CSkVDVCBPRiBBQkMgTk9URSA9PiBNSURJIE5PVEVcblx0XHRcdGlmIChtaWRpLmxlbmd0aCA9PT0gMiAmJiBtaWRpWzBdLnR5cGUgPT09ICdhbHBoYScgJiYgbWlkaVsxXS50eXBlID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRpZiAoIXR1bmUuZm9ybWF0dGluZykgdHVuZS5mb3JtYXR0aW5nID0ge307XG5cdFx0XHRcdGlmICghdHVuZS5mb3JtYXR0aW5nLm1pZGkpIHR1bmUuZm9ybWF0dGluZy5taWRpID0ge307XG5cdFx0XHRcdGlmICghdHVuZS5mb3JtYXR0aW5nLm1pZGkuZHJ1bW1hcCkgdHVuZS5mb3JtYXR0aW5nLm1pZGkuZHJ1bW1hcCA9IHt9O1xuXHRcdFx0XHR0dW5lLmZvcm1hdHRpbmcubWlkaS5kcnVtbWFwW21pZGlbMF0udG9rZW5dID0gbWlkaVsxXS5pbnR0O1xuXHRcdFx0XHRtaWRpX3BhcmFtcyA9IHR1bmUuZm9ybWF0dGluZy5taWRpLmRydW1tYXA7XG5cdFx0XHR9IGVsc2UgaWYgKG1pZGkubGVuZ3RoID09PSAzICYmIG1pZGlbMF0udHlwZSA9PT0gJ3B1bmN0JyAmJiBtaWRpWzFdLnR5cGUgPT09ICdhbHBoYScgJiYgbWlkaVsyXS50eXBlID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRpZiAoIXR1bmUuZm9ybWF0dGluZykgdHVuZS5mb3JtYXR0aW5nID0ge307XG5cdFx0XHRcdGlmICghdHVuZS5mb3JtYXR0aW5nLm1pZGkpIHR1bmUuZm9ybWF0dGluZy5taWRpID0ge307XG5cdFx0XHRcdGlmICghdHVuZS5mb3JtYXR0aW5nLm1pZGkuZHJ1bW1hcCkgdHVuZS5mb3JtYXR0aW5nLm1pZGkuZHJ1bW1hcCA9IHt9O1xuXHRcdFx0XHR0dW5lLmZvcm1hdHRpbmcubWlkaS5kcnVtbWFwW21pZGlbMF0udG9rZW4rbWlkaVsxXS50b2tlbl0gPSBtaWRpWzJdLmludHQ7XG5cdFx0XHRcdG1pZGlfcGFyYW1zID0gdHVuZS5mb3JtYXR0aW5nLm1pZGkuZHJ1bW1hcDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBvbmUgbm90ZSBuYW1lIGFuZCBvbmUgaW50ZWdlciBwYXJhbWV0ZXIgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobWlkaUNtZFBhcmFtRnJhY3Rpb24uaW5kZXhPZihtaWRpX2NtZCkgPj0gMCkge1xuXHRcdFx0Ly8gT05FIEZSQUNUSU9OIFBBUkFNRVRFUlxuXHRcdFx0aWYgKG1pZGkubGVuZ3RoICE9PSAzKVxuXHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgZnJhY3Rpb24gcGFyYW1ldGVyIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGlbMF0udHlwZSAhPT0gXCJudW1iZXJcIiB8fCBtaWRpWzFdLnRva2VuICE9PSBcIi9cIiB8fCBtaWRpWzJdLnR5cGUgIT09IFwibnVtYmVyXCIpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBmcmFjdGlvbiBwYXJhbWV0ZXIgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVswXS5pbnR0KTtcblx0XHRcdFx0bWlkaV9wYXJhbXMucHVzaChtaWRpWzJdLmludHQpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobWlkaUNtZFBhcmFtNEludGVnZXIuaW5kZXhPZihtaWRpX2NtZCkgPj0gMCkge1xuXHRcdFx0Ly8gRk9VUiBJTlQgUEFSQU1FVEVSU1xuXHRcdFx0aWYgKG1pZGkubGVuZ3RoICE9PSA0KVxuXHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgZm91ciBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2UgaWYgKG1pZGlbMF0udHlwZSAhPT0gXCJudW1iZXJcIiB8fCBtaWRpWzFdLnR5cGUgIT09IFwibnVtYmVyXCIgfHwgbWlkaVsyXS50eXBlICE9PSBcIm51bWJlclwiIHx8IG1pZGlbM10udHlwZSAhPT0gXCJudW1iZXJcIilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGZvdXIgaW50ZWdlciBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbMF0uaW50dCk7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVsxXS5pbnR0KTtcblx0XHRcdFx0bWlkaV9wYXJhbXMucHVzaChtaWRpWzJdLmludHQpO1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbM10uaW50dCk7XG5cdFx0XHR9XG5cdFx0fSBlbHNlIGlmIChtaWRpQ21kUGFyYW01SW50ZWdlci5pbmRleE9mKG1pZGlfY21kKSA+PSAwKSB7XG5cdFx0XHQvLyBGSVZFIElOVCBQQVJBTUVURVJTXG5cdFx0XHRpZiAobWlkaS5sZW5ndGggIT09IDUpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBmaXZlIHBhcmFtZXRlcnMgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0ZWxzZSBpZiAobWlkaVswXS50eXBlICE9PSBcIm51bWJlclwiIHx8IG1pZGlbMV0udHlwZSAhPT0gXCJudW1iZXJcIiB8fCBtaWRpWzJdLnR5cGUgIT09IFwibnVtYmVyXCIgfHwgbWlkaVszXS50eXBlICE9PSBcIm51bWJlclwiIHx8IG1pZGlbNF0udHlwZSAhPT0gXCJudW1iZXJcIilcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGZpdmUgaW50ZWdlciBwYXJhbWV0ZXJzIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbMF0uaW50dCk7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVsxXS5pbnR0KTtcblx0XHRcdFx0bWlkaV9wYXJhbXMucHVzaChtaWRpWzJdLmludHQpO1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKG1pZGlbM10uaW50dCk7XG5cdFx0XHRcdG1pZGlfcGFyYW1zLnB1c2gobWlkaVs0XS5pbnR0KTtcblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKG1pZGlDbWRQYXJhbTFJbnRlZ2VyMU9wdGlvbmFsSW50ZWdlci5pbmRleE9mKG1pZGlfY21kKSA+PSAwKSB7XG5cdFx0XHQvLyBPTkUgSU5UIFBBUkFNRVRFUiwgT05FIE9QVElPTkFMIE9DVEFWRSBQQVJBTUVURVJcblx0XHRcdGlmIChtaWRpLmxlbmd0aCAhPT0gMSB8fCBtaWRpLmxlbmd0aCAhPT0gNClcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIG9uZSBvciB0d28gcGFyYW1ldGVycyBpbiBNSURJIFwiICsgbWlkaV9jbWQsIHJlc3RPZlN0cmluZywgMCk7XG5cdFx0XHRlbHNlIGlmIChtaWRpWzBdLnR5cGUgIT09IFwibnVtYmVyXCIpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBpbnRlZ2VyIHBhcmFtZXRlciBpbiBNSURJIFwiICsgbWlkaV9jbWQsIHJlc3RPZlN0cmluZywgMCk7XG5cdFx0XHRlbHNlIGlmIChtaWRpLmxlbmd0aCA9PT0gNCkge1xuXHRcdFx0XHRpZiAobWlkaVsxXS50b2tlbiAhPT0gXCJvY3RhdmVcIilcblx0XHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgb2N0YXZlIHBhcmFtZXRlciBpbiBNSURJIFwiICsgbWlkaV9jbWQsIHJlc3RPZlN0cmluZywgMCk7XG5cdFx0XHRcdGlmIChtaWRpWzJdLnRva2VuICE9PSBcIj1cIilcblx0XHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgb2N0YXZlIHBhcmFtZXRlciBpbiBNSURJIFwiICsgbWlkaV9jbWQsIHJlc3RPZlN0cmluZywgMCk7XG5cdFx0XHRcdGlmIChtaWRpWzNdLnR5cGUgIT09IFwibnVtYmVyXCIpXG5cdFx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGludGVnZXIgcGFyYW1ldGVyIGZvciBvY3RhdmUgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0bWlkaV9wYXJhbXMucHVzaChtaWRpWzBdLmludHQpO1xuXHRcdFx0XHRpZiAobWlkaS5sZW5ndGggPT09IDQpXG5cdFx0XHRcdFx0bWlkaV9wYXJhbXMucHVzaChtaWRpWzNdLmludHQpO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobWlkaUNtZFBhcmFtMVN0cmluZ1ZhcmlhYmxlSW50ZWdlcnMuaW5kZXhPZihtaWRpX2NtZCkgPj0gMCkge1xuXHRcdFx0Ly8gT05FIFNUUklORywgVkFSSUFCTEUgSU5UIFBBUkFNRVRFUlNcblx0XHRcdGlmIChtaWRpLmxlbmd0aCA8IDIpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBzdHJpbmcgcGFyYW1ldGVyIGFuZCBhdCBsZWFzdCBvbmUgaW50ZWdlciBwYXJhbWV0ZXIgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0ZWxzZSBpZiAobWlkaVswXS50eXBlICE9PSBcImFscGhhXCIpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBzdHJpbmcgcGFyYW1ldGVyIGFuZCBhdCBsZWFzdCBvbmUgaW50ZWdlciBwYXJhbWV0ZXIgaW4gTUlESSBcIiArIG1pZGlfY21kLCByZXN0T2ZTdHJpbmcsIDApO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdHZhciBwID0gbWlkaS5zaGlmdCgpO1xuXHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKHAudG9rZW4pO1xuXHRcdFx0XHR3aGlsZSAobWlkaS5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0cCA9IG1pZGkuc2hpZnQoKTtcblx0XHRcdFx0XHRpZiAocC50eXBlICE9PSBcIm51bWJlclwiKVxuXHRcdFx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGludGVnZXIgcGFyYW1ldGVyIGluIE1JREkgXCIgKyBtaWRpX2NtZCwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdFx0XHRtaWRpX3BhcmFtcy5wdXNoKHAuaW50dCk7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAodHVuZS5oYXNCZWdpbk11c2ljKCkpXG5cdFx0XHR0dW5lLmFwcGVuZEVsZW1lbnQoJ21pZGknLCAtMSwgLTEsIHsgY21kOiBtaWRpX2NtZCwgcGFyYW1zOiBtaWRpX3BhcmFtcyB9KTtcblx0XHRlbHNlIHtcblx0XHRcdGlmICh0dW5lLmZvcm1hdHRpbmdbJ21pZGknXSA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHR0dW5lLmZvcm1hdHRpbmdbJ21pZGknXSA9IHt9O1xuXHRcdFx0dHVuZS5mb3JtYXR0aW5nWydtaWRpJ11bbWlkaV9jbWRdID0gbWlkaV9wYXJhbXM7XG5cdFx0fVxuXHR9O1xuXG5cdHBhcnNlRGlyZWN0aXZlLnBhcnNlRm9udENoYW5nZUxpbmUgPSBmdW5jdGlvbih0ZXh0c3RyKSB7XG5cdFx0dmFyIHRleHRQYXJ0cyA9IHRleHRzdHIuc3BsaXQoJyQnKTtcblx0XHRpZiAodGV4dFBhcnRzLmxlbmd0aCA+IDEgJiYgbXVsdGlsaW5lVmFycy5zZXRmb250KSB7XG5cdFx0XHR2YXIgdGV4dGFyciA9IFsgeyB0ZXh0OiB0ZXh0UGFydHNbMF0gfV07XG5cdFx0XHRmb3IgKHZhciBpID0gMTsgaSA8IHRleHRQYXJ0cy5sZW5ndGg7IGkrKykge1xuXHRcdFx0XHRpZiAodGV4dFBhcnRzW2ldLmNoYXJBdCgwKSA9PT0gJzAnKVxuXHRcdFx0XHRcdHRleHRhcnIucHVzaCh7IHRleHQ6IHRleHRQYXJ0c1tpXS5zdWJzdHJpbmcoMSkgfSk7XG5cdFx0XHRcdGVsc2UgaWYgKHRleHRQYXJ0c1tpXS5jaGFyQXQoMCkgPT09ICcxJyAmJiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbMV0pXG5cdFx0XHRcdFx0dGV4dGFyci5wdXNoKHtmb250OiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbMV0sIHRleHQ6IHRleHRQYXJ0c1tpXS5zdWJzdHJpbmcoMSkgfSk7XG5cdFx0XHRcdGVsc2UgaWYgKHRleHRQYXJ0c1tpXS5jaGFyQXQoMCkgPT09ICcyJyAmJiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbMl0pXG5cdFx0XHRcdFx0dGV4dGFyci5wdXNoKHtmb250OiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbMl0sIHRleHQ6IHRleHRQYXJ0c1tpXS5zdWJzdHJpbmcoMSkgfSk7XG5cdFx0XHRcdGVsc2UgaWYgKHRleHRQYXJ0c1tpXS5jaGFyQXQoMCkgPT09ICczJyAmJiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbM10pXG5cdFx0XHRcdFx0dGV4dGFyci5wdXNoKHtmb250OiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbM10sIHRleHQ6IHRleHRQYXJ0c1tpXS5zdWJzdHJpbmcoMSkgfSk7XG5cdFx0XHRcdGVsc2UgaWYgKHRleHRQYXJ0c1tpXS5jaGFyQXQoMCkgPT09ICc0JyAmJiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbNF0pXG5cdFx0XHRcdFx0dGV4dGFyci5wdXNoKHtmb250OiBtdWx0aWxpbmVWYXJzLnNldGZvbnRbNF0sIHRleHQ6IHRleHRQYXJ0c1tpXS5zdWJzdHJpbmcoMSkgfSk7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR0ZXh0YXJyW3RleHRhcnIubGVuZ3RoLTFdLnRleHQgKz0gJyQnICsgdGV4dFBhcnRzW2ldO1xuXHRcdFx0fVxuXHRcdFx0aWYgKHRleHRhcnIubGVuZ3RoID4gMSlcblx0XHRcdFx0cmV0dXJuIHRleHRhcnI7XG5cdFx0fVxuXHRcdHJldHVybiB0ZXh0c3RyO1xuXHR9O1xuXG5cdHZhciBwb3NpdGlvbkNob2ljZXMgPSBbICdhdXRvJywgJ2Fib3ZlJywgJ2JlbG93JywgJ2hpZGRlbicgXTtcblx0cGFyc2VEaXJlY3RpdmUuYWRkRGlyZWN0aXZlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0dmFyIHRva2VucyA9IHRva2VuaXplci50b2tlbml6ZShzdHIsIDAsIHN0ci5sZW5ndGgpO1x0Ly8gMyBvciBtb3JlICUgaW4gYSByb3csIG9yIGp1c3Qgc3BhY2VzIGFmdGVyICUlIGlzIGp1c3QgYSBjb21tZW50XG5cdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDAgfHwgdG9rZW5zWzBdLnR5cGUgIT09ICdhbHBoYScpIHJldHVybiBudWxsO1xuXHRcdHZhciByZXN0T2ZTdHJpbmcgPSBzdHIuc3Vic3RyaW5nKHN0ci5pbmRleE9mKHRva2Vuc1swXS50b2tlbikrdG9rZW5zWzBdLnRva2VuLmxlbmd0aCk7XG5cdFx0cmVzdE9mU3RyaW5nID0gdG9rZW5pemVyLnN0cmlwQ29tbWVudChyZXN0T2ZTdHJpbmcpO1xuXHRcdHZhciBjbWQgPSB0b2tlbnMuc2hpZnQoKS50b2tlbi50b0xvd2VyQ2FzZSgpO1xuXHRcdHZhciBzY3JhdGNoID0gXCJcIjtcblx0XHRzd2l0Y2ggKGNtZClcblx0XHR7XG5cdFx0XHQvLyBUaGUgZm9sbG93aW5nIGRpcmVjdGl2ZXMgd2VyZSBhZGRlZCB0byBhYmNfcGFyc2VyX2xpbnQsIGJ1dCBoYXZlbid0IGJlZW4gaW1wbGVtZW50ZWQgaGVyZS5cblx0XHRcdC8vIE1vc3Qgb2YgdGhlbSBhcmUgZGlyZWN0IHRyYW5zbGF0aW9ucyBmcm9tIHRoZSBkaXJlY3RpdmVzIHRoYXQgd2lsbCBiZSBwYXJzZWQgaW4uIFNlZSBhYmNtMnBzJ3MgZm9ybWF0LnR4dCBmb3IgaW5mbyBvbiBlYWNoIG9mIHRoZXNlLlxuXHRcdFx0Ly9cdFx0XHRcdFx0YWxpZ25iYXJzOiB7IHR5cGU6IFwibnVtYmVyXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRhbGlnbmNvbXBvc2VyOiB7IHR5cGU6IFwic3RyaW5nXCIsIEVudW06IFsgJ2xlZnQnLCAnY2VudGVyJywncmlnaHQnIF0sIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRic3RlbWRvd246IHsgdHlwZTogXCJib29sZWFuXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRjb250aW51ZWFsbDogeyB0eXBlOiBcImJvb2xlYW5cIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdGR5bmFsaWduOiB7IHR5cGU6IFwiYm9vbGVhblwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0ZXhwcmFib3ZlOiB7IHR5cGU6IFwiYm9vbGVhblwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0ZXhwcmJlbG93OiB7IHR5cGU6IFwiYm9vbGVhblwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0ZmxhdGJlYW1zOiB7IHR5cGU6IFwiYm9vbGVhblwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0Z2Nob3JkYm94OiB7IHR5cGU6IFwiYm9vbGVhblwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0Z3JhY2VzbHVyczogeyB0eXBlOiBcImJvb2xlYW5cIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdGdyYWNlc3BhY2ViZWZvcmU6IHsgdHlwZTogXCJudW1iZXJcIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdGdyYWNlc3BhY2VpbnNpZGU6IHsgdHlwZTogXCJudW1iZXJcIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdGdyYWNlc3BhY2VhZnRlcjogeyB0eXBlOiBcIm51bWJlclwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0aW5mb3NwYWNlOiB7IHR5cGU6IFwibnVtYmVyXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRsaW5lc2tpcGZhYzogeyB0eXBlOiBcIm51bWJlclwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0bWF4c2hyaW5rOiB7IHR5cGU6IFwibnVtYmVyXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRtYXhzdGFmZnNlcDogeyB0eXBlOiBcIm51bWJlclwiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Ly9cdFx0XHRcdFx0bWF4c3lzc3RhZmZzZXA6IHsgdHlwZTogXCJudW1iZXJcIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdG5vdGVzcGFjaW5nZmFjdG9yOiB7IHR5cGU6IFwibnVtYmVyXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRwYXJza2lwZmFjOiB7IHR5cGU6IFwibnVtYmVyXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRzbHVyaGVpZ2h0OiB7IHR5cGU6IFwibnVtYmVyXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRzcGxpdHR1bmU6IHsgdHlwZTogXCJib29sZWFuXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRzcXVhcmVicmV2ZTogeyB0eXBlOiBcImJvb2xlYW5cIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdHN0ZW1oZWlnaHQ6IHsgdHlwZTogXCJudW1iZXJcIiwgb3B0aW9uYWw6IHRydWUgfSxcblx0XHRcdC8vXHRcdFx0XHRcdHN0cmFpZ2h0ZmxhZ3M6IHsgdHlwZTogXCJib29sZWFuXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHRzdHJldGNoc3RhZmY6IHsgdHlwZTogXCJib29sZWFuXCIsIG9wdGlvbmFsOiB0cnVlIH0sXG5cdFx0XHQvL1x0XHRcdFx0XHR0aXRsZWZvcm1hdDogeyB0eXBlOiBcInN0cmluZ1wiLCBvcHRpb25hbDogdHJ1ZSB9LFxuXHRcdFx0Y2FzZSBcImJhZ3BpcGVzXCI6dHVuZS5mb3JtYXR0aW5nLmJhZ3BpcGVzID0gdHJ1ZTticmVhaztcblx0XHRcdGNhc2UgXCJsYW5kc2NhcGVcIjptdWx0aWxpbmVWYXJzLmxhbmRzY2FwZSA9IHRydWU7YnJlYWs7XG5cdFx0XHRjYXNlIFwicGFwZXJzaXplXCI6bXVsdGlsaW5lVmFycy5wYXBlcnNpemUgPSByZXN0T2ZTdHJpbmc7YnJlYWs7XG5cdFx0XHRjYXNlIFwic2x1cmdyYWNlc1wiOnR1bmUuZm9ybWF0dGluZy5zbHVyZ3JhY2VzID0gdHJ1ZTticmVhaztcblx0XHRcdGNhc2UgXCJzdHJldGNobGFzdFwiOnR1bmUuZm9ybWF0dGluZy5zdHJldGNobGFzdCA9IHRydWU7YnJlYWs7XG5cdFx0XHRjYXNlIFwidGl0bGVjYXBzXCI6bXVsdGlsaW5lVmFycy50aXRsZWNhcHMgPSB0cnVlO2JyZWFrO1xuXHRcdFx0Y2FzZSBcInRpdGxlbGVmdFwiOnR1bmUuZm9ybWF0dGluZy50aXRsZWxlZnQgPSB0cnVlO2JyZWFrO1xuXHRcdFx0Y2FzZSBcIm1lYXN1cmVib3hcIjp0dW5lLmZvcm1hdHRpbmcubWVhc3VyZWJveCA9IHRydWU7YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJ2b2NhbFwiOiByZXR1cm4gYWRkTXVsdGlsaW5lVmFyT25lUGFyYW1DaG9pY2UoXCJ2b2NhbFBvc2l0aW9uXCIsIGNtZCwgdG9rZW5zLCBwb3NpdGlvbkNob2ljZXMpO1xuXHRcdFx0Y2FzZSBcImR5bmFtaWNcIjogcmV0dXJuIGFkZE11bHRpbGluZVZhck9uZVBhcmFtQ2hvaWNlKFwiZHluYW1pY1Bvc2l0aW9uXCIsIGNtZCwgdG9rZW5zLCBwb3NpdGlvbkNob2ljZXMpO1xuXHRcdFx0Y2FzZSBcImdjaG9yZFwiOiByZXR1cm4gYWRkTXVsdGlsaW5lVmFyT25lUGFyYW1DaG9pY2UoXCJjaG9yZFBvc2l0aW9uXCIsIGNtZCwgdG9rZW5zLCBwb3NpdGlvbkNob2ljZXMpO1xuXHRcdFx0Y2FzZSBcIm9ybmFtZW50XCI6IHJldHVybiBhZGRNdWx0aWxpbmVWYXJPbmVQYXJhbUNob2ljZShcIm9ybmFtZW50UG9zaXRpb25cIiwgY21kLCB0b2tlbnMsIHBvc2l0aW9uQ2hvaWNlcyk7XG5cdFx0XHRjYXNlIFwidm9sdW1lXCI6IHJldHVybiBhZGRNdWx0aWxpbmVWYXJPbmVQYXJhbUNob2ljZShcInZvbHVtZVBvc2l0aW9uXCIsIGNtZCwgdG9rZW5zLCBwb3NpdGlvbkNob2ljZXMpO1xuXG5cdFx0XHRjYXNlIFwiYm90bWFyZ2luXCI6XG5cdFx0XHRjYXNlIFwiYm90c3BhY2VcIjpcblx0XHRcdGNhc2UgXCJjb21wb3NlcnNwYWNlXCI6XG5cdFx0XHRjYXNlIFwiaW5kZW50XCI6XG5cdFx0XHRjYXNlIFwibGVmdG1hcmdpblwiOlxuXHRcdFx0Y2FzZSBcImxpbmVzZXBcIjpcblx0XHRcdGNhc2UgXCJtdXNpY3NwYWNlXCI6XG5cdFx0XHRjYXNlIFwicGFydHNzcGFjZVwiOlxuXHRcdFx0Y2FzZSBcInBhZ2VoZWlnaHRcIjpcblx0XHRcdGNhc2UgXCJwYWdld2lkdGhcIjpcblx0XHRcdGNhc2UgXCJyaWdodG1hcmdpblwiOlxuXHRcdFx0Y2FzZSBcInN0YWZmc2VwXCI6XG5cdFx0XHRjYXNlIFwic3RhZmZ3aWR0aFwiOlxuXHRcdFx0Y2FzZSBcInN1YnRpdGxlc3BhY2VcIjpcblx0XHRcdGNhc2UgXCJzeXNzdGFmZnNlcFwiOlxuXHRcdFx0Y2FzZSBcInN5c3RlbXNlcFwiOlxuXHRcdFx0Y2FzZSBcInRleHRzcGFjZVwiOlxuXHRcdFx0Y2FzZSBcInRpdGxlc3BhY2VcIjpcblx0XHRcdGNhc2UgXCJ0b3BtYXJnaW5cIjpcblx0XHRcdGNhc2UgXCJ0b3BzcGFjZVwiOlxuXHRcdFx0Y2FzZSBcInZvY2Fsc3BhY2VcIjpcblx0XHRcdGNhc2UgXCJ3b3Jkc3NwYWNlXCI6XG5cdFx0XHRcdHJldHVybiBvbmVQYXJhbWV0ZXJNZWFzdXJlbWVudChjbWQsIHRva2Vucyk7XG5cdFx0XHRjYXNlIFwidnNraXBcIjpcblx0XHRcdFx0dmFyIHZza2lwID0gZ2V0UmVxdWlyZWRNZWFzdXJlbWVudChjbWQsIHRva2Vucyk7XG5cdFx0XHRcdGlmICh2c2tpcC5lcnJvcilcblx0XHRcdFx0XHRyZXR1cm4gdnNraXAuZXJyb3I7XG5cdFx0XHRcdHR1bmUuYWRkU3BhY2luZyh2c2tpcCk7XG5cdFx0XHRcdHJldHVybiBudWxsO1xuXHRcdFx0Y2FzZSBcInNjYWxlXCI6XG5cdFx0XHRcdHNldFNjYWxlKGNtZCwgdG9rZW5zKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwic2VwXCI6XG5cdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKVxuXHRcdFx0XHRcdHR1bmUuYWRkU2VwYXJhdG9yKCk7XG5cdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdHZhciBwb2ludHMgPSB0b2tlbml6ZXIuZ2V0TWVhc3VyZW1lbnQodG9rZW5zKTtcblx0XHRcdFx0XHRpZiAocG9pbnRzLnVzZWQgPT09IDApXG5cdFx0XHRcdFx0XHRyZXR1cm4gXCJEaXJlY3RpdmUgXFxcIlwiICsgY21kICsgXCJcXFwiIHJlcXVpcmVzIDMgbnVtYmVyczogc3BhY2UgYWJvdmUsIHNwYWNlIGJlbG93LCBsZW5ndGggb2YgbGluZVwiO1xuXHRcdFx0XHRcdHZhciBzcGFjZUFib3ZlID0gcG9pbnRzLnZhbHVlO1xuXG5cdFx0XHRcdFx0cG9pbnRzID0gdG9rZW5pemVyLmdldE1lYXN1cmVtZW50KHRva2Vucyk7XG5cdFx0XHRcdFx0aWYgKHBvaW50cy51c2VkID09PSAwKVxuXHRcdFx0XHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyAzIG51bWJlcnM6IHNwYWNlIGFib3ZlLCBzcGFjZSBiZWxvdywgbGVuZ3RoIG9mIGxpbmVcIjtcblx0XHRcdFx0XHR2YXIgc3BhY2VCZWxvdyA9IHBvaW50cy52YWx1ZTtcblxuXHRcdFx0XHRcdHBvaW50cyA9IHRva2VuaXplci5nZXRNZWFzdXJlbWVudCh0b2tlbnMpO1xuXHRcdFx0XHRcdGlmIChwb2ludHMudXNlZCA9PT0gMCB8fCB0b2tlbnMubGVuZ3RoICE9PSAwKVxuXHRcdFx0XHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIFxcXCJcIiArIGNtZCArIFwiXFxcIiByZXF1aXJlcyAzIG51bWJlcnM6IHNwYWNlIGFib3ZlLCBzcGFjZSBiZWxvdywgbGVuZ3RoIG9mIGxpbmVcIjtcblx0XHRcdFx0XHR2YXIgbGVuTGluZSA9IHBvaW50cy52YWx1ZTtcblx0XHRcdFx0XHR0dW5lLmFkZFNlcGFyYXRvcihzcGFjZUFib3ZlLCBzcGFjZUJlbG93LCBsZW5MaW5lKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJiYXJzcGVyc3RhZmZcIjpcblx0XHRcdFx0c2NyYXRjaCA9IGFkZE11bHRpbGluZVZhcignYmFyc3BlcnN0YWZmJywgY21kLCB0b2tlbnMpO1xuXHRcdFx0XHRpZiAoc2NyYXRjaCAhPT0gbnVsbCkgcmV0dXJuIHNjcmF0Y2g7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcInN0YWZmbm9ub3RlXCI6XG5cdFx0XHRcdC8vIFRoZSBzZW5zZSBvZiB0aGUgYm9vbGVhbiBpcyBvcHBvc2l0ZSBoZXJlLiBcIjBcIiBtZWFucyB0cnVlLlxuXHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCAhPT0gMSlcblx0XHRcdFx0XHRyZXR1cm4gXCJEaXJlY3RpdmUgc3RhZmZub25vdGUgcmVxdWlyZXMgb25lIHBhcmFtZXRlcjogMCBvciAxXCI7XG5cdFx0XHRcdGlmICh0b2tlbnNbMF0udG9rZW4gPT09ICcwJylcblx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnN0YWZmbm9ub3RlID0gdHJ1ZTtcblx0XHRcdFx0ZWxzZSBpZiAodG9rZW5zWzBdLnRva2VuID09PSAnMScpXG5cdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5zdGFmZm5vbm90ZSA9IGZhbHNlO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0cmV0dXJuIFwiRGlyZWN0aXZlIHN0YWZmbm9ub3RlIHJlcXVpcmVzIG9uZSBwYXJhbWV0ZXI6IDAgb3IgMSAocmVjZWl2ZWQgXCIgKyB0b2tlbnNbMF0udG9rZW4gKyAnKSc7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcInByaW50dGVtcG9cIjpcblx0XHRcdFx0c2NyYXRjaCA9IGFkZE11bHRpbGluZVZhckJvb2woJ3ByaW50VGVtcG8nLCBjbWQsIHRva2Vucyk7XG5cdFx0XHRcdGlmIChzY3JhdGNoICE9PSBudWxsKSByZXR1cm4gc2NyYXRjaDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwicGFydHNib3hcIjpcblx0XHRcdFx0c2NyYXRjaCA9IGFkZE11bHRpbGluZVZhckJvb2woJ3BhcnRzQm94JywgY21kLCB0b2tlbnMpO1xuXHRcdFx0XHRpZiAoc2NyYXRjaCAhPT0gbnVsbCkgcmV0dXJuIHNjcmF0Y2g7XG5cdFx0XHRcdG11bHRpbGluZVZhcnMucGFydHNmb250LmJveCA9IG11bHRpbGluZVZhcnMucGFydHNCb3g7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcIm1lYXN1cmVuYlwiOlxuXHRcdFx0Y2FzZSBcImJhcm51bWJlcnNcIjpcblx0XHRcdFx0c2NyYXRjaCA9IGFkZE11bHRpbGluZVZhcignYmFyTnVtYmVycycsIGNtZCwgdG9rZW5zKTtcblx0XHRcdFx0aWYgKHNjcmF0Y2ggIT09IG51bGwpIHJldHVybiBzY3JhdGNoO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJiZWdpbnRleHRcIjpcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5pblRleHRCbG9jayA9IHRydWU7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImNvbnRpbnVlYWxsXCI6XG5cdFx0XHRcdG11bHRpbGluZVZhcnMuY29udGludWVhbGwgPSB0cnVlO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJiZWdpbnBzXCI6XG5cdFx0XHRcdG11bHRpbGluZVZhcnMuaW5Qc0Jsb2NrID0gdHJ1ZTtcblx0XHRcdFx0d2FybihcIlBvc3RzY3JpcHQgaWdub3JlZFwiLCBzdHIsIDApO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJkZWNvXCI6XG5cdFx0XHRcdGlmIChyZXN0T2ZTdHJpbmcubGVuZ3RoID4gMClcblx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmlnbm9yZWREZWNvcmF0aW9ucy5wdXNoKHJlc3RPZlN0cmluZy5zdWJzdHJpbmcoMCwgcmVzdE9mU3RyaW5nLmluZGV4T2YoJyAnKSkpO1xuXHRcdFx0XHR3YXJuKFwiRGVjb3JhdGlvbiByZWRlZmluaXRpb24gaWdub3JlZFwiLCBzdHIsIDApO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJ0ZXh0XCI6XG5cdFx0XHRcdHZhciB0ZXh0c3RyID0gdG9rZW5pemVyLnRyYW5zbGF0ZVN0cmluZyhyZXN0T2ZTdHJpbmcpO1xuXHRcdFx0XHR0dW5lLmFkZFRleHQocGFyc2VEaXJlY3RpdmUucGFyc2VGb250Q2hhbmdlTGluZSh0ZXh0c3RyKSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImNlbnRlclwiOlxuXHRcdFx0XHR2YXIgY2VudGVyc3RyID0gdG9rZW5pemVyLnRyYW5zbGF0ZVN0cmluZyhyZXN0T2ZTdHJpbmcpO1xuXHRcdFx0XHR0dW5lLmFkZENlbnRlcmVkKHBhcnNlRGlyZWN0aXZlLnBhcnNlRm9udENoYW5nZUxpbmUoY2VudGVyc3RyKSk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSBcImZvbnRcIjpcblx0XHRcdFx0Ly8gZG9uJ3QgbmVlZCB0byBkbyBhbnl0aGluZyBmb3IgdGhpczsgaXQgaXMgYSB1c2VsZXNzIGRpcmVjdGl2ZVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJzZXRmb250XCI6XG5cdFx0XHRcdHZhciBzZlRva2VucyA9IHRva2VuaXplci50b2tlbml6ZShyZXN0T2ZTdHJpbmcsIDAsIHJlc3RPZlN0cmluZy5sZW5ndGgpO1xuLy9cdFx0XHRcdHZhciBzZkRvbmUgPSBmYWxzZTtcblx0XHRcdFx0aWYgKHNmVG9rZW5zLmxlbmd0aCA+PSA0KSB7XG5cdFx0XHRcdFx0aWYgKHNmVG9rZW5zWzBdLnRva2VuID09PSAnLScgJiYgc2ZUb2tlbnNbMV0udHlwZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0XHRcdHZhciBzZk51bSA9IHBhcnNlSW50KHNmVG9rZW5zWzFdLnRva2VuKTtcblx0XHRcdFx0XHRcdGlmIChzZk51bSA+PSAxICYmIHNmTnVtIDw9IDQpIHtcblx0XHRcdFx0XHRcdFx0aWYgKCFtdWx0aWxpbmVWYXJzLnNldGZvbnQpXG5cdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5zZXRmb250ID0gW107XG5cdFx0XHRcdFx0XHRcdHNmVG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0XHRcdHNmVG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuc2V0Zm9udFtzZk51bV0gPSBnZXRGb250UGFyYW1ldGVyKHNmVG9rZW5zLCBtdWx0aWxpbmVWYXJzLnNldGZvbnRbc2ZOdW1dLCBzdHIsIDAsICdzZXRmb250Jyk7XG4vL1x0XHRcdFx0XHRcdFx0dmFyIHNmU2l6ZSA9IHNmVG9rZW5zLnBvcCgpO1xuLy9cdFx0XHRcdFx0XHRcdGlmIChzZlNpemUudHlwZSA9PT0gJ251bWJlcicpIHtcbi8vXHRcdFx0XHRcdFx0XHRcdHNmU2l6ZSA9IHBhcnNlSW50KHNmU2l6ZS50b2tlbik7XG4vL1x0XHRcdFx0XHRcdFx0XHR2YXIgc2ZGb250TmFtZSA9ICcnO1xuLy9cdFx0XHRcdFx0XHRcdFx0Zm9yICh2YXIgc2ZpID0gMjsgc2ZpIDwgc2ZUb2tlbnMubGVuZ3RoOyBzZmkrKylcbi8vXHRcdFx0XHRcdFx0XHRcdFx0c2ZGb250TmFtZSArPSBzZlRva2Vuc1tzZmldLnRva2VuO1xuLy9cdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5zZXRmb250W3NmTnVtXSA9IHsgZmFjZTogc2ZGb250TmFtZSwgc2l6ZTogc2ZTaXplIH07XG4vL1x0XHRcdFx0XHRcdFx0XHRzZkRvbmUgPSB0cnVlO1xuLy9cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cbi8vXHRcdFx0XHRpZiAoIXNmRG9uZSlcbi8vXHRcdFx0XHRcdHJldHVybiBcIkJhZCBwYXJhbWV0ZXJzOiBcIiArIGNtZDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwiZ2Nob3JkZm9udFwiOlxuXHRcdFx0Y2FzZSBcInBhcnRzZm9udFwiOlxuXHRcdFx0Y2FzZSBcInRyaXBsZXRmb250XCI6XG5cdFx0XHRjYXNlIFwidm9jYWxmb250XCI6XG5cdFx0XHRjYXNlIFwidGV4dGZvbnRcIjpcblx0XHRcdGNhc2UgXCJhbm5vdGF0aW9uZm9udFwiOlxuXHRcdFx0Y2FzZSBcImhpc3Rvcnlmb250XCI6XG5cdFx0XHRjYXNlIFwiaW5mb2ZvbnRcIjpcblx0XHRcdGNhc2UgXCJtZWFzdXJlZm9udFwiOlxuXHRcdFx0Y2FzZSBcInJlcGVhdGZvbnRcIjpcblx0XHRcdGNhc2UgXCJ3b3Jkc2ZvbnRcIjpcblx0XHRcdFx0cmV0dXJuIGdldENoYW5naW5nRm9udChjbWQsIHRva2Vucywgc3RyKTtcblx0XHRcdGNhc2UgXCJjb21wb3NlcmZvbnRcIjpcblx0XHRcdGNhc2UgXCJzdWJ0aXRsZWZvbnRcIjpcblx0XHRcdGNhc2UgXCJ0ZW1wb2ZvbnRcIjpcblx0XHRcdGNhc2UgXCJ0aXRsZWZvbnRcIjpcblx0XHRcdGNhc2UgXCJ2b2ljZWZvbnRcIjpcblx0XHRcdGNhc2UgXCJmb290ZXJmb250XCI6XG5cdFx0XHRjYXNlIFwiaGVhZGVyZm9udFwiOlxuXHRcdFx0XHRyZXR1cm4gZ2V0R2xvYmFsRm9udChjbWQsIHRva2Vucywgc3RyKTtcblx0XHRcdGNhc2UgXCJiYXJsYWJlbGZvbnRcIjpcblx0XHRcdGNhc2UgXCJiYXJudW1iZXJmb250XCI6XG5cdFx0XHRjYXNlIFwiYmFybnVtZm9udFwiOlxuXHRcdFx0XHRyZXR1cm4gZ2V0Q2hhbmdpbmdGb250KFwibWVhc3VyZWZvbnRcIiwgdG9rZW5zLCBzdHIpO1xuXHRcdFx0Y2FzZSBcInN0YXZlc1wiOlxuXHRcdFx0Y2FzZSBcInNjb3JlXCI6XG5cdFx0XHRcdG11bHRpbGluZVZhcnMuc2NvcmVfaXNfcHJlc2VudCA9IHRydWU7XG5cdFx0XHRcdHZhciBhZGRWb2ljZSA9IGZ1bmN0aW9uKGlkLCBuZXdTdGFmZiwgYnJhY2tldCwgYnJhY2UsIGNvbnRpbnVlQmFyKSB7XG5cdFx0XHRcdFx0aWYgKG5ld1N0YWZmIHx8IG11bHRpbGluZVZhcnMuc3RhdmVzLmxlbmd0aCA9PT0gMCkge1xuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5zdGF2ZXMucHVzaCh7aW5kZXg6IG11bHRpbGluZVZhcnMuc3RhdmVzLmxlbmd0aCwgbnVtVm9pY2VzOiAwfSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHZhciBzdGFmZiA9IHBhcnNlQ29tbW9uLmxhc3QobXVsdGlsaW5lVmFycy5zdGF2ZXMpO1xuXHRcdFx0XHRcdGlmIChicmFja2V0ICE9PSB1bmRlZmluZWQpIHN0YWZmLmJyYWNrZXQgPSBicmFja2V0O1xuXHRcdFx0XHRcdGlmIChicmFjZSAhPT0gdW5kZWZpbmVkKSBzdGFmZi5icmFjZSA9IGJyYWNlO1xuXHRcdFx0XHRcdGlmIChjb250aW51ZUJhcikgc3RhZmYuY29ubmVjdEJhckxpbmVzID0gJ2VuZCc7XG5cdFx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMudm9pY2VzW2lkXSA9PT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF0gPSB7c3RhZmZOdW06IHN0YWZmLmluZGV4LCBpbmRleDogc3RhZmYubnVtVm9pY2VzfTtcblx0XHRcdFx0XHRcdHN0YWZmLm51bVZvaWNlcysrO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fTtcblxuXHRcdFx0XHR2YXIgb3BlblBhcmVuID0gZmFsc2U7XG5cdFx0XHRcdHZhciBvcGVuQnJhY2tldCA9IGZhbHNlO1xuXHRcdFx0XHR2YXIgb3BlbkJyYWNlID0gZmFsc2U7XG5cdFx0XHRcdHZhciBqdXN0T3BlblBhcmVuID0gZmFsc2U7XG5cdFx0XHRcdHZhciBqdXN0T3BlbkJyYWNrZXQgPSBmYWxzZTtcblx0XHRcdFx0dmFyIGp1c3RPcGVuQnJhY2UgPSBmYWxzZTtcblx0XHRcdFx0dmFyIGNvbnRpbnVlQmFyID0gZmFsc2U7XG5cdFx0XHRcdHZhciBsYXN0Vm9pY2U7XG5cdFx0XHRcdHZhciBhZGRDb250aW51ZUJhciA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnRpbnVlQmFyID0gdHJ1ZTtcblx0XHRcdFx0XHRpZiAobGFzdFZvaWNlKSB7XG5cdFx0XHRcdFx0XHR2YXIgdHkgPSAnc3RhcnQnO1xuXHRcdFx0XHRcdFx0aWYgKGxhc3RWb2ljZS5zdGFmZk51bSA+IDApIHtcblx0XHRcdFx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMuc3RhdmVzW2xhc3RWb2ljZS5zdGFmZk51bS0xXS5jb25uZWN0QmFyTGluZXMgPT09ICdzdGFydCcgfHxcblx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnN0YXZlc1tsYXN0Vm9pY2Uuc3RhZmZOdW0tMV0uY29ubmVjdEJhckxpbmVzID09PSAnY29udGludWUnKVxuXHRcdFx0XHRcdFx0XHRcdHR5ID0gJ2NvbnRpbnVlJztcblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuc3RhdmVzW2xhc3RWb2ljZS5zdGFmZk51bV0uY29ubmVjdEJhckxpbmVzID0gdHk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9O1xuXHRcdFx0XHR3aGlsZSAodG9rZW5zLmxlbmd0aCkge1xuXHRcdFx0XHRcdHZhciB0ID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0c3dpdGNoICh0LnRva2VuKSB7XG5cdFx0XHRcdFx0XHRjYXNlICcoJzpcblx0XHRcdFx0XHRcdFx0aWYgKG9wZW5QYXJlbikgd2FybihcIkNhbid0IG5lc3QgcGFyZW50aGVzaXMgaW4gJSVzY29yZVwiLCBzdHIsIHQuc3RhcnQpO1xuXHRcdFx0XHRcdFx0XHRlbHNlIHtvcGVuUGFyZW4gPSB0cnVlO2p1c3RPcGVuUGFyZW4gPSB0cnVlO31cblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICcpJzpcblx0XHRcdFx0XHRcdFx0aWYgKCFvcGVuUGFyZW4gfHwganVzdE9wZW5QYXJlbikgd2FybihcIlVuZXhwZWN0ZWQgY2xvc2UgcGFyZW50aGVzaXMgaW4gJSVzY29yZVwiLCBzdHIsIHQuc3RhcnQpO1xuXHRcdFx0XHRcdFx0XHRlbHNlIG9wZW5QYXJlbiA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ1snOlxuXHRcdFx0XHRcdFx0XHRpZiAob3BlbkJyYWNrZXQpIHdhcm4oXCJDYW4ndCBuZXN0IGJyYWNrZXRzIGluICUlc2NvcmVcIiwgc3RyLCB0LnN0YXJ0KTtcblx0XHRcdFx0XHRcdFx0ZWxzZSB7b3BlbkJyYWNrZXQgPSB0cnVlO2p1c3RPcGVuQnJhY2tldCA9IHRydWU7fVxuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ10nOlxuXHRcdFx0XHRcdFx0XHRpZiAoIW9wZW5CcmFja2V0IHx8IGp1c3RPcGVuQnJhY2tldCkgd2FybihcIlVuZXhwZWN0ZWQgY2xvc2UgYnJhY2tldCBpbiAlJXNjb3JlXCIsIHN0ciwgdC5zdGFydCk7XG5cdFx0XHRcdFx0XHRcdGVsc2Uge29wZW5CcmFja2V0ID0gZmFsc2U7bXVsdGlsaW5lVmFycy5zdGF2ZXNbbGFzdFZvaWNlLnN0YWZmTnVtXS5icmFja2V0ID0gJ2VuZCc7fVxuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ3snOlxuXHRcdFx0XHRcdFx0XHRpZiAob3BlbkJyYWNlICkgd2FybihcIkNhbid0IG5lc3QgYnJhY2VzIGluICUlc2NvcmVcIiwgc3RyLCB0LnN0YXJ0KTtcblx0XHRcdFx0XHRcdFx0ZWxzZSB7b3BlbkJyYWNlID0gdHJ1ZTtqdXN0T3BlbkJyYWNlID0gdHJ1ZTt9XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnfSc6XG5cdFx0XHRcdFx0XHRcdGlmICghb3BlbkJyYWNlIHx8IGp1c3RPcGVuQnJhY2UpIHdhcm4oXCJVbmV4cGVjdGVkIGNsb3NlIGJyYWNlIGluICUlc2NvcmVcIiwgc3RyLCB0LnN0YXJ0KTtcblx0XHRcdFx0XHRcdFx0ZWxzZSB7b3BlbkJyYWNlID0gZmFsc2U7bXVsdGlsaW5lVmFycy5zdGF2ZXNbbGFzdFZvaWNlLnN0YWZmTnVtXS5icmFjZSA9ICdlbmQnO31cblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICd8Jzpcblx0XHRcdFx0XHRcdFx0YWRkQ29udGludWVCYXIoKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHR2YXIgdmMgPSBcIlwiO1xuXHRcdFx0XHRcdFx0XHR3aGlsZSAodC50eXBlID09PSAnYWxwaGEnIHx8IHQudHlwZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0XHRcdFx0XHR2YyArPSB0LnRva2VuO1xuXHRcdFx0XHRcdFx0XHRcdGlmICh0LmNvbnRpbnVlSWQpXG5cdFx0XHRcdFx0XHRcdFx0XHR0ID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0dmFyIG5ld1N0YWZmID0gIW9wZW5QYXJlbiB8fCBqdXN0T3BlblBhcmVuO1xuXHRcdFx0XHRcdFx0XHR2YXIgYnJhY2tldCA9IGp1c3RPcGVuQnJhY2tldCA/ICdzdGFydCcgOiBvcGVuQnJhY2tldCA/ICdjb250aW51ZScgOiB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0XHRcdHZhciBicmFjZSA9IGp1c3RPcGVuQnJhY2UgPyAnc3RhcnQnIDogb3BlbkJyYWNlID8gJ2NvbnRpbnVlJyA6IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRcdFx0YWRkVm9pY2UodmMsIG5ld1N0YWZmLCBicmFja2V0LCBicmFjZSwgY29udGludWVCYXIpO1xuXHRcdFx0XHRcdFx0XHRqdXN0T3BlblBhcmVuID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdGp1c3RPcGVuQnJhY2tldCA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0XHRqdXN0T3BlbkJyYWNlID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdGNvbnRpbnVlQmFyID0gZmFsc2U7XG5cdFx0XHRcdFx0XHRcdGxhc3RWb2ljZSA9IG11bHRpbGluZVZhcnMudm9pY2VzW3ZjXTtcblx0XHRcdFx0XHRcdFx0aWYgKGNtZCA9PT0gJ3N0YXZlcycpXG5cdFx0XHRcdFx0XHRcdFx0YWRkQ29udGludWVCYXIoKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRjYXNlIFwibmV3cGFnZVwiOlxuXHRcdFx0XHR2YXIgcGdOdW0gPSB0b2tlbml6ZXIuZ2V0SW50KHJlc3RPZlN0cmluZyk7XG5cdFx0XHRcdHR1bmUuYWRkTmV3UGFnZShwZ051bS5kaWdpdHMgPT09IDAgPyAtMSA6IHBnTnVtLnZhbHVlKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJhYmNcIjpcblx0XHRcdFx0dmFyIGFyciA9IHJlc3RPZlN0cmluZy5zcGxpdCgnICcpO1xuXHRcdFx0XHRzd2l0Y2ggKGFyclswXSkge1xuXHRcdFx0XHRcdGNhc2UgXCItY29weXJpZ2h0XCI6XG5cdFx0XHRcdFx0Y2FzZSBcIi1jcmVhdG9yXCI6XG5cdFx0XHRcdFx0Y2FzZSBcIi1lZGl0ZWQtYnlcIjpcblx0XHRcdFx0XHRjYXNlIFwiLXZlcnNpb25cIjpcblx0XHRcdFx0XHRjYXNlIFwiLWNoYXJzZXRcIjpcblx0XHRcdFx0XHRcdHZhciBzdWJDbWQgPSBhcnIuc2hpZnQoKTtcblx0XHRcdFx0XHRcdHR1bmUuYWRkTWV0YVRleHQoY21kK3N1YkNtZCwgYXJyLmpvaW4oJyAnKSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0cmV0dXJuIFwiVW5rbm93biBkaXJlY3RpdmU6IFwiICsgY21kK2FyclswXTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJoZWFkZXJcIjpcblx0XHRcdGNhc2UgXCJmb290ZXJcIjpcblx0XHRcdFx0dmFyIGZvb3RlclN0ciA9IHRva2VuaXplci5nZXRNZWF0KHJlc3RPZlN0cmluZywgMCwgcmVzdE9mU3RyaW5nLmxlbmd0aCk7XG5cdFx0XHRcdGZvb3RlclN0ciA9IHJlc3RPZlN0cmluZy5zdWJzdHJpbmcoZm9vdGVyU3RyLnN0YXJ0LCBmb290ZXJTdHIuZW5kKTtcblx0XHRcdFx0aWYgKGZvb3RlclN0ci5jaGFyQXQoMCkgPT09ICdcIicgJiYgZm9vdGVyU3RyLmNoYXJBdChmb290ZXJTdHIubGVuZ3RoLTEpID09PSAnXCInIClcblx0XHRcdFx0XHRmb290ZXJTdHIgPSBmb290ZXJTdHIuc3Vic3RyaW5nKDEsIGZvb3RlclN0ci5sZW5ndGgtMSk7XG5cdFx0XHRcdHZhciBmb290ZXJBcnIgPSBmb290ZXJTdHIuc3BsaXQoJ1xcdCcpO1xuXHRcdFx0XHR2YXIgZm9vdGVyID0ge307XG5cdFx0XHRcdGlmIChmb290ZXJBcnIubGVuZ3RoID09PSAxKVxuXHRcdFx0XHRcdGZvb3RlciA9IHsgbGVmdDogXCJcIiwgY2VudGVyOiBmb290ZXJBcnJbMF0sIHJpZ2h0OiBcIlwiIH07XG5cdFx0XHRcdGVsc2UgaWYgKGZvb3RlckFyci5sZW5ndGggPT09IDIpXG5cdFx0XHRcdFx0Zm9vdGVyID0geyBsZWZ0OiBmb290ZXJBcnJbMF0sIGNlbnRlcjogZm9vdGVyQXJyWzFdLCByaWdodDogXCJcIiB9O1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0Zm9vdGVyID0geyBsZWZ0OiBmb290ZXJBcnJbMF0sIGNlbnRlcjogZm9vdGVyQXJyWzFdLCByaWdodDogZm9vdGVyQXJyWzJdIH07XG5cdFx0XHRcdGlmIChmb290ZXJBcnIubGVuZ3RoID4gMylcblx0XHRcdFx0XHR3YXJuKFwiVG9vIG1hbnkgdGFicyBpbiBcIiArIGNtZCArIFwiOiBcIiArIGZvb3RlckFyci5sZW5ndGggKyBcIiBmb3VuZC5cIiwgcmVzdE9mU3RyaW5nLCAwKTtcblxuXHRcdFx0XHR0dW5lLmFkZE1ldGFUZXh0T2JqKGNtZCwgZm9vdGVyKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJtaWRpXCI6XG5cdFx0XHRcdHZhciBtaWRpID0gdG9rZW5pemVyLnRva2VuaXplKHJlc3RPZlN0cmluZywgMCwgcmVzdE9mU3RyaW5nLmxlbmd0aCwgdHJ1ZSk7XG5cdFx0XHRcdGlmIChtaWRpLmxlbmd0aCA+IDAgJiYgbWlkaVswXS50b2tlbiA9PT0gJz0nKVxuXHRcdFx0XHRcdG1pZGkuc2hpZnQoKTtcblx0XHRcdFx0aWYgKG1pZGkubGVuZ3RoID09PSAwKVxuXHRcdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCBtaWRpIGNvbW1hbmRcIiwgcmVzdE9mU3RyaW5nLCAwKTtcblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdHBhcnNlTWlkaUNvbW1hbmQobWlkaSwgdHVuZSwgcmVzdE9mU3RyaW5nKTtcblx0XHRcdFx0YnJlYWs7XG5cblx0XHRcdGNhc2UgXCJtYXBcIjpcblx0XHRcdGNhc2UgXCJwZXJjbWFwXCI6XG5cdFx0XHRjYXNlIFwicGxheXRlbXBvXCI6XG5cdFx0XHRjYXNlIFwiYXVxdWFsaXR5XCI6XG5cdFx0XHRjYXNlIFwiY29udGludW91c1wiOlxuXHRcdFx0Y2FzZSBcIm5vYmFyY2hlY2tcIjpcblx0XHRcdFx0Ly8gVE9ETy1QRVI6IEFjdHVhbGx5IGhhbmRsZSB0aGUgcGFyYW1ldGVycyBvZiB0aGVzZVxuXHRcdFx0XHR0dW5lLmZvcm1hdHRpbmdbY21kXSA9IHJlc3RPZlN0cmluZztcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRyZXR1cm4gXCJVbmtub3duIGRpcmVjdGl2ZTogXCIgKyBjbWQ7XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXHRwYXJzZURpcmVjdGl2ZS5nbG9iYWxGb3JtYXR0aW5nID0gZnVuY3Rpb24oZm9ybWF0SGFzaCkge1xuXHRcdGZvciAodmFyIGNtZCBpbiBmb3JtYXRIYXNoKSB7XG5cdFx0XHRpZiAoZm9ybWF0SGFzaC5oYXNPd25Qcm9wZXJ0eShjbWQpKSB7XG5cdFx0XHRcdHZhciB2YWx1ZSA9ICcnK2Zvcm1hdEhhc2hbY21kXTtcblx0XHRcdFx0dmFyIHRva2VucyA9IHRva2VuaXplci50b2tlbml6ZSh2YWx1ZSwgMCwgdmFsdWUubGVuZ3RoKTtcblx0XHRcdFx0dmFyIHNjcmF0Y2g7XG5cdFx0XHRcdHN3aXRjaCAoY21kKSB7XG5cdFx0XHRcdFx0Y2FzZSBcInRpdGxlZm9udFwiOlxuXHRcdFx0XHRcdGNhc2UgXCJnY2hvcmRmb250XCI6XG5cdFx0XHRcdFx0Y2FzZSBcImNvbXBvc2VyZm9udFwiOlxuXHRcdFx0XHRcdGNhc2UgXCJmb290ZXJmb250XCI6XG5cdFx0XHRcdFx0Y2FzZSBcImhlYWRlcmZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwiaGlzdG9yeWZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwiaW5mb2ZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwibWVhc3VyZWZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwicGFydHNmb250XCI6XG5cdFx0XHRcdFx0Y2FzZSBcInJlcGVhdGZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwic3VidGl0bGVmb250XCI6XG5cdFx0XHRcdFx0Y2FzZSBcInRlbXBvZm9udFwiOlxuXHRcdFx0XHRcdGNhc2UgXCJ0ZXh0Zm9udFwiOlxuXHRcdFx0XHRcdGNhc2UgXCJ2b2ljZWZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwidHJpcGxldGZvbnRcIjpcblx0XHRcdFx0XHRjYXNlIFwidm9jYWxmb250XCI6XG5cdFx0XHRcdFx0Y2FzZSBcIndvcmRzZm9udFwiOlxuXHRcdFx0XHRcdGNhc2UgXCJhbm5vdGF0aW9uZm9udFwiOlxuXHRcdFx0XHRcdFx0Z2V0Q2hhbmdpbmdGb250KGNtZCwgdG9rZW5zLCB2YWx1ZSk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlIFwic2NhbGVcIjpcblx0XHRcdFx0XHRcdHNldFNjYWxlKGNtZCwgdG9rZW5zKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgXCJwYXJ0c2JveFwiOlxuXHRcdFx0XHRcdFx0c2NyYXRjaCA9IGFkZE11bHRpbGluZVZhckJvb2woJ3BhcnRzQm94JywgY21kLCB0b2tlbnMpO1xuXHRcdFx0XHRcdFx0aWYgKHNjcmF0Y2ggIT09IG51bGwpIHdhcm4oc2NyYXRjaCk7XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnBhcnRzZm9udC5ib3ggPSBtdWx0aWxpbmVWYXJzLnBhcnRzQm94O1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdHdhcm4oXCJGb3JtYXR0aW5nIGRpcmVjdGl2ZSB1bnJlY29nbml6ZWQ6IFwiLCBjbWQsIDApO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBwYXJzZURpcmVjdGl2ZTtcbiIsIi8vICAgIGFiY19wYXJzZV9oZWFkZXIuanM6IHBhcnNlcyBhIHRoZSBoZWFkZXIgZmllbGRzIGZyb20gYSBzdHJpbmcgcmVwcmVzZW50aW5nIEFCQyBNdXNpYyBOb3RhdGlvbiBpbnRvIGEgdXNhYmxlIGludGVybmFsIHN0cnVjdHVyZS5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IFBhdWwgUm9zZW4gKHBhdWwgYXQgcGF1bHJvc2VuIGRvdCBuZXQpXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbi8qZ2xvYmFsIHdpbmRvdyAqL1xuXG52YXIgcGFyc2VDb21tb24gPSByZXF1aXJlKCcuL2FiY19jb21tb24nKTtcbnZhciBwYXJzZURpcmVjdGl2ZSA9IHJlcXVpcmUoJy4vYWJjX3BhcnNlX2RpcmVjdGl2ZScpO1xudmFyIHBhcnNlS2V5Vm9pY2UgPSByZXF1aXJlKCcuL2FiY19wYXJzZV9rZXlfdm9pY2UnKTtcblxudmFyIFBhcnNlSGVhZGVyID0gZnVuY3Rpb24odG9rZW5pemVyLCB3YXJuLCBtdWx0aWxpbmVWYXJzLCB0dW5lKSB7XG5cdHRoaXMucmVzZXQgPSBmdW5jdGlvbih0b2tlbml6ZXIsIHdhcm4sIG11bHRpbGluZVZhcnMsIHR1bmUpIHtcblx0XHRwYXJzZUtleVZvaWNlLmluaXRpYWxpemUodG9rZW5pemVyLCB3YXJuLCBtdWx0aWxpbmVWYXJzLCB0dW5lKTtcblx0XHRwYXJzZURpcmVjdGl2ZS5pbml0aWFsaXplKHRva2VuaXplciwgd2FybiwgbXVsdGlsaW5lVmFycywgdHVuZSk7XG5cdH07XG5cdHRoaXMucmVzZXQodG9rZW5pemVyLCB3YXJuLCBtdWx0aWxpbmVWYXJzLCB0dW5lKTtcblxuXHR0aGlzLnNldFRpdGxlID0gZnVuY3Rpb24odGl0bGUpIHtcblx0XHRpZiAobXVsdGlsaW5lVmFycy5oYXNNYWluVGl0bGUpXG5cdFx0XHR0dW5lLmFkZFN1YnRpdGxlKHRva2VuaXplci50cmFuc2xhdGVTdHJpbmcodG9rZW5pemVyLnN0cmlwQ29tbWVudCh0aXRsZSkpKTtcdC8vIGRpc3BsYXkgc2Vjb25kYXJ5IHRpdGxlXG5cdFx0ZWxzZVxuXHRcdHtcblx0XHRcdHZhciB0aXRsZVN0ciA9IHRva2VuaXplci50cmFuc2xhdGVTdHJpbmcodG9rZW5pemVyLnRoZVJldmVyc2VyKHRva2VuaXplci5zdHJpcENvbW1lbnQodGl0bGUpKSk7XG5cdFx0XHRpZiAobXVsdGlsaW5lVmFycy50aXRsZWNhcHMpXG5cdFx0XHRcdHRpdGxlU3RyID0gdGl0bGVTdHIudG9VcHBlckNhc2UoKTtcblx0XHRcdHR1bmUuYWRkTWV0YVRleHQoXCJ0aXRsZVwiLCB0aXRsZVN0cik7XG5cdFx0XHRtdWx0aWxpbmVWYXJzLmhhc01haW5UaXRsZSA9IHRydWU7XG5cdFx0fVxuXHR9O1xuXG5cdHRoaXMuc2V0TWV0ZXIgPSBmdW5jdGlvbihsaW5lKSB7XG5cdFx0bGluZSA9IHRva2VuaXplci5zdHJpcENvbW1lbnQobGluZSk7XG5cdFx0aWYgKGxpbmUgPT09ICdDJykge1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPT09IHRydWUpIHtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCA9IDAuMTI1O1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmhhdmVudF9zZXRfbGVuZ3RoID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4ge3R5cGU6ICdjb21tb25fdGltZSd9O1xuXHRcdH0gZWxzZSBpZiAobGluZSA9PT0gJ0N8Jykge1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPT09IHRydWUpIHtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCA9IDAuMTI1O1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmhhdmVudF9zZXRfbGVuZ3RoID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4ge3R5cGU6ICdjdXRfdGltZSd9O1xuXHRcdH0gZWxzZSBpZiAobGluZSA9PT0gJ28nKSB7XG5cdFx0XHRpZiAobXVsdGlsaW5lVmFycy5oYXZlbnRfc2V0X2xlbmd0aCA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoID0gMC4xMjU7XG5cdFx0XHRcdG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiB7dHlwZTogJ3RlbXB1c19wZXJmZWN0dW0nfTtcblx0XHR9IGVsc2UgaWYgKGxpbmUgPT09ICdjJykge1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPT09IHRydWUpIHtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCA9IDAuMTI1O1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmhhdmVudF9zZXRfbGVuZ3RoID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4ge3R5cGU6ICd0ZW1wdXNfaW1wZXJmZWN0dW0nfTtcblx0XHR9IGVsc2UgaWYgKGxpbmUgPT09ICdvLicpIHtcblx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmhhdmVudF9zZXRfbGVuZ3RoID09PSB0cnVlKSB7XG5cdFx0XHRcdG11bHRpbGluZVZhcnMuZGVmYXVsdF9sZW5ndGggPSAwLjEyNTtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5oYXZlbnRfc2V0X2xlbmd0aCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHt0eXBlOiAndGVtcHVzX3BlcmZlY3R1bV9wcm9sYXRpbyd9O1xuXHRcdH0gZWxzZSBpZiAobGluZSA9PT0gJ2MuJykge1xuXHRcdFx0aWYgKG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPT09IHRydWUpIHtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCA9IDAuMTI1O1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmhhdmVudF9zZXRfbGVuZ3RoID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4ge3R5cGU6ICd0ZW1wdXNfaW1wZXJmZWN0dW1fcHJvbGF0aW8nfTtcblx0XHR9IGVsc2UgaWYgKGxpbmUubGVuZ3RoID09PSAwIHx8IGxpbmUudG9Mb3dlckNhc2UoKSA9PT0gJ25vbmUnKSB7XG5cdFx0XHRpZiAobXVsdGlsaW5lVmFycy5oYXZlbnRfc2V0X2xlbmd0aCA9PT0gdHJ1ZSkge1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoID0gMC4xMjU7XG5cdFx0XHRcdG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPSBmYWxzZTtcblx0XHRcdH1cblx0XHRcdHJldHVybiBudWxsO1xuXHRcdH1cblx0XHRlbHNlXG5cdFx0e1xuXHRcdFx0dmFyIHRva2VucyA9IHRva2VuaXplci50b2tlbml6ZShsaW5lLCAwLCBsaW5lLmxlbmd0aCk7XG5cdFx0XHQvLyB0aGUgZm9ybSBpcyBbb3Blbl9wYXJlbl0gZGVjaW1hbCBbIHBsdXN8ZG90IGRlY2ltYWwgXS4uLiBbY2xvc2VfcGFyZW5dIHNsYXNoIGRlY2ltYWwgW3BsdXMgc2FtZV9hc19iZWZvcmVdXG5cdFx0XHR0cnkge1xuXHRcdFx0XHR2YXIgcGFyc2VOdW0gPSBmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQvLyBoYW5kbGVzIHRoaXMgbXVjaDogW29wZW5fcGFyZW5dIGRlY2ltYWwgWyBwbHVzfGRvdCBkZWNpbWFsIF0uLi4gW2Nsb3NlX3BhcmVuXVxuXHRcdFx0XHRcdHZhciByZXQgPSB7dmFsdWU6IDAsIG51bTogXCJcIn07XG5cblx0XHRcdFx0XHR2YXIgdG9rID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRvay50b2tlbiA9PT0gJygnKVxuXHRcdFx0XHRcdFx0dG9rID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0d2hpbGUgKDEpIHtcblx0XHRcdFx0XHRcdGlmICh0b2sudHlwZSAhPT0gJ251bWJlcicpIHRocm93IFwiRXhwZWN0ZWQgdG9wIG51bWJlciBvZiBtZXRlclwiO1xuXHRcdFx0XHRcdFx0cmV0LnZhbHVlICs9IHBhcnNlSW50KHRvay50b2tlbik7XG5cdFx0XHRcdFx0XHRyZXQubnVtICs9IHRvay50b2tlbjtcblx0XHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwIHx8IHRva2Vuc1swXS50b2tlbiA9PT0gJy8nKSByZXR1cm4gcmV0O1xuXHRcdFx0XHRcdFx0dG9rID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0XHRpZiAodG9rLnRva2VuID09PSAnKScpIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDAgfHwgdG9rZW5zWzBdLnRva2VuID09PSAnLycpIHJldHVybiByZXQ7XG5cdFx0XHRcdFx0XHRcdHRocm93IFwiVW5leHBlY3RlZCBwYXJlbiBpbiBtZXRlclwiO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKHRvay50b2tlbiAhPT0gJy4nICYmIHRvay50b2tlbiAhPT0gJysnKSB0aHJvdyBcIkV4cGVjdGVkIHRvcCBudW1iZXIgb2YgbWV0ZXJcIjtcblx0XHRcdFx0XHRcdHJldC5udW0gKz0gdG9rLnRva2VuO1xuXHRcdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHRocm93IFwiRXhwZWN0ZWQgdG9wIG51bWJlciBvZiBtZXRlclwiO1xuXHRcdFx0XHRcdFx0dG9rID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdHJldHVybiByZXQ7XHQvLyBqdXN0IHRvIHN1cHByZXNzIHdhcm5pbmdcblx0XHRcdFx0fTtcblxuXHRcdFx0XHR2YXIgcGFyc2VGcmFjdGlvbiA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdC8vIGhhbmRsZXMgdGhpcyBtdWNoOiBwYXJzZU51bSBzbGFzaCBkZWNpbWFsXG5cdFx0XHRcdFx0dmFyIHJldCA9IHBhcnNlTnVtKCk7XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHJldHVybiByZXQ7XG5cdFx0XHRcdFx0dmFyIHRvayA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdGlmICh0b2sudG9rZW4gIT09ICcvJykgdGhyb3cgXCJFeHBlY3RlZCBzbGFzaCBpbiBtZXRlclwiO1xuXHRcdFx0XHRcdHRvayA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdGlmICh0b2sudHlwZSAhPT0gJ251bWJlcicpIHRocm93IFwiRXhwZWN0ZWQgYm90dG9tIG51bWJlciBvZiBtZXRlclwiO1xuXHRcdFx0XHRcdHJldC5kZW4gPSB0b2sudG9rZW47XG5cdFx0XHRcdFx0cmV0LnZhbHVlID0gcmV0LnZhbHVlIC8gcGFyc2VJbnQocmV0LmRlbik7XG5cdFx0XHRcdFx0cmV0dXJuIHJldDtcblx0XHRcdFx0fTtcblxuXHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgdGhyb3cgXCJFeHBlY3RlZCBtZXRlciBkZWZpbml0aW9uIGluIE06IGxpbmVcIjtcblx0XHRcdFx0dmFyIG1ldGVyID0ge3R5cGU6ICdzcGVjaWZpZWQnLCB2YWx1ZTogWyBdfTtcblx0XHRcdFx0dmFyIHRvdGFsTGVuZ3RoID0gMDtcblx0XHRcdFx0d2hpbGUgKDEpIHtcblx0XHRcdFx0XHR2YXIgcmV0ID0gcGFyc2VGcmFjdGlvbigpO1xuXHRcdFx0XHRcdHRvdGFsTGVuZ3RoICs9IHJldC52YWx1ZTtcblx0XHRcdFx0XHR2YXIgbXYgPSB7IG51bTogcmV0Lm51bSB9O1xuXHRcdFx0XHRcdGlmIChyZXQuZGVuICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRtdi5kZW4gPSByZXQuZGVuO1xuXHRcdFx0XHRcdG1ldGVyLnZhbHVlLnB1c2gobXYpO1xuXHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSBicmVhaztcblx0XHRcdFx0XHQvL3ZhciB0b2sgPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHQvL2lmICh0b2sudG9rZW4gIT09ICcrJykgdGhyb3cgXCJFeHRyYSBjaGFyYWN0ZXJzIGluIE06IGxpbmVcIjtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmhhdmVudF9zZXRfbGVuZ3RoID09PSB0cnVlKSB7XG5cdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCA9IHRvdGFsTGVuZ3RoIDwgMC43NSA/IDAuMDYyNSA6IDAuMTI1O1xuXHRcdFx0XHRcdG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPSBmYWxzZTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gbWV0ZXI7XG5cdFx0XHR9IGNhdGNoIChlKSB7XG5cdFx0XHRcdHdhcm4oZSwgbGluZSwgMCk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9O1xuXG5cdHRoaXMuY2FsY1RlbXBvID0gZnVuY3Rpb24ocmVsVGVtcG8pIHtcblx0XHR2YXIgZHVyID0gMS80O1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLm1ldGVyICYmIG11bHRpbGluZVZhcnMubWV0ZXIudHlwZSA9PT0gJ3NwZWNpZmllZCcpIHtcblx0XHRcdGR1ciA9IDEgLyBwYXJzZUludChtdWx0aWxpbmVWYXJzLm1ldGVyLnZhbHVlWzBdLmRlbik7XG5cdFx0fSBlbHNlIGlmIChtdWx0aWxpbmVWYXJzLm9yaWdNZXRlciAmJiBtdWx0aWxpbmVWYXJzLm9yaWdNZXRlci50eXBlID09PSAnc3BlY2lmaWVkJykge1xuXHRcdFx0ZHVyID0gMSAvIHBhcnNlSW50KG11bHRpbGluZVZhcnMub3JpZ01ldGVyLnZhbHVlWzBdLmRlbik7XG5cdFx0fVxuXHRcdC8vdmFyIGR1ciA9IG11bHRpbGluZVZhcnMuZGVmYXVsdF9sZW5ndGggPyBtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoIDogMTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHJlbFRlbXBvLmR1cmF0aW9uOyBpKyspXG5cdFx0XHRyZWxUZW1wby5kdXJhdGlvbltpXSA9IGR1ciAqIHJlbFRlbXBvLmR1cmF0aW9uW2ldO1xuXHRcdHJldHVybiByZWxUZW1wbztcblx0fTtcblxuXHR0aGlzLnJlc29sdmVUZW1wbyA9IGZ1bmN0aW9uKCkge1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLnRlbXBvKSB7XHQvLyBJZiB0aGVyZSdzIGEgdGVtcG8gd2FpdGluZyB0byBiZSByZXNvbHZlZFxuXHRcdFx0dGhpcy5jYWxjVGVtcG8obXVsdGlsaW5lVmFycy50ZW1wbyk7XG5cdFx0XHR0dW5lLm1ldGFUZXh0LnRlbXBvID0gbXVsdGlsaW5lVmFycy50ZW1wbztcblx0XHRcdGRlbGV0ZSBtdWx0aWxpbmVWYXJzLnRlbXBvO1xuXHRcdH1cblx0fTtcblxuXHR0aGlzLmFkZFVzZXJEZWZpbml0aW9uID0gZnVuY3Rpb24obGluZSwgc3RhcnQsIGVuZCkge1xuXHRcdHZhciBlcXVhbHMgPSBsaW5lLmluZGV4T2YoJz0nLCBzdGFydCk7XG5cdFx0aWYgKGVxdWFscyA9PT0gLTEpIHtcblx0XHRcdHdhcm4oXCJOZWVkIGFuID0gaW4gYSBtYWNybyBkZWZpbml0aW9uXCIsIGxpbmUsIHN0YXJ0KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cblx0XHR2YXIgYmVmb3JlID0gcGFyc2VDb21tb24uc3RyaXAobGluZS5zdWJzdHJpbmcoc3RhcnQsIGVxdWFscykpO1xuXHRcdHZhciBhZnRlciA9IHBhcnNlQ29tbW9uLnN0cmlwKGxpbmUuc3Vic3RyaW5nKGVxdWFscysxKSk7XG5cblx0XHRpZiAoYmVmb3JlLmxlbmd0aCAhPT0gMSkge1xuXHRcdFx0d2FybihcIk1hY3JvIGRlZmluaXRpb25zIGNhbiBvbmx5IGJlIG9uZSBjaGFyYWN0ZXJcIiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHR2YXIgbGVnYWxDaGFycyA9IFwiSElKS0xNTk9QUVJTVFVWV1hZaGlqa2xtbm9wcXJzdHV2d35cIjtcblx0XHRpZiAobGVnYWxDaGFycy5pbmRleE9mKGJlZm9yZSkgPT09IC0xKSB7XG5cdFx0XHR3YXJuKFwiTWFjcm8gZGVmaW5pdGlvbnMgbXVzdCBiZSBILVksIGgtdywgb3IgdGlsZGVcIiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0cmV0dXJuO1xuXHRcdH1cblx0XHRpZiAoYWZ0ZXIubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR3YXJuKFwiTWlzc2luZyBtYWNybyBkZWZpbml0aW9uXCIsIGxpbmUsIHN0YXJ0KTtcblx0XHRcdHJldHVybjtcblx0XHR9XG5cdFx0aWYgKG11bHRpbGluZVZhcnMubWFjcm9zID09PSB1bmRlZmluZWQpXG5cdFx0XHRtdWx0aWxpbmVWYXJzLm1hY3JvcyA9IHt9O1xuXHRcdG11bHRpbGluZVZhcnMubWFjcm9zW2JlZm9yZV0gPSBhZnRlcjtcblx0fTtcblxuXHR0aGlzLnNldERlZmF1bHRMZW5ndGggPSBmdW5jdGlvbihsaW5lLCBzdGFydCwgZW5kKSB7XG5cdFx0dmFyIGxlbiA9IHBhcnNlQ29tbW9uLmdzdWIobGluZS5zdWJzdHJpbmcoc3RhcnQsIGVuZCksIFwiIFwiLCBcIlwiKTtcblx0XHR2YXIgbGVuX2FyciA9IGxlbi5zcGxpdCgnLycpO1xuXHRcdGlmIChsZW5fYXJyLmxlbmd0aCA9PT0gMikge1xuXHRcdFx0dmFyIG4gPSBwYXJzZUludChsZW5fYXJyWzBdKTtcblx0XHRcdHZhciBkID0gcGFyc2VJbnQobGVuX2FyclsxXSk7XG5cdFx0XHRpZiAoZCA+IDApIHtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5kZWZhdWx0X2xlbmd0aCA9IG4gLyBkO1x0Ly8gYSB3aG9sZSBub3RlIGlzIDFcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5oYXZlbnRfc2V0X2xlbmd0aCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH0gZWxzZSBpZiAobGVuX2Fyci5sZW5ndGggPT09IDEgJiYgbGVuX2FyclswXSA9PT0gJzEnKSB7XG5cdFx0XHRtdWx0aWxpbmVWYXJzLmRlZmF1bHRfbGVuZ3RoID0gMTtcblx0XHRcdG11bHRpbGluZVZhcnMuaGF2ZW50X3NldF9sZW5ndGggPSBmYWxzZTtcblx0XHR9XG5cdH07XG5cblxuXHR2YXIgdGVtcG9TdHJpbmcgPSB7XG5cblx0XHRsYXJnaGlzc2ltbzogMjAsXG5cdFx0YWRhZ2lzc2ltbzogMjQsXG5cdFx0c29zdGVudXRvOiAyOCxcblx0XHRncmF2ZTogMzIsXG5cdFx0bGFyZ286IDQwLFxuXHRcdGxlbnRvOiA1MCxcblx0XHRsYXJnaGV0dG86IDYwLFxuXHRcdGFkYWdpbzogNjgsXG5cdFx0YWRhZ2lldHRvOiA3NCxcblx0XHRhbmRhbnRlOiA4MCxcblx0XHRhbmRhbnRpbm86IDg4LFxuXHRcdFwibWFyY2lhIG1vZGVyYXRvXCI6IDg0LFxuXHRcdFwiYW5kYW50ZSBtb2RlcmF0b1wiOiAxMDAsXG5cdFx0bW9kZXJhdG86IDExMixcblx0XHRhbGxlZ3JldHRvOiAxMTYsXG5cdFx0XCJhbGxlZ3JvIG1vZGVyYXRvXCI6IDEyMCxcblx0XHRhbGxlZ3JvOiAxMjYsXG5cdFx0YW5pbWF0bzogMTMyLFxuXHRcdGFnaXRhdG86IDE0MCxcblx0XHR2ZWxvY2U6IDE0OCxcblx0XHRcIm1vc3NvIHZpdm9cIjogMTU2LFxuXHRcdHZpdmFjZTogMTY0LFxuXHRcdHZpdmFjaXNzaW1vOiAxNzIsXG5cdFx0YWxsZWdyaXNzaW1vOiAxNzYsXG5cdFx0cHJlc3RvOiAxODQsXG5cdFx0cHJlc3Rpc3NpbW86IDIxMCxcblx0fTtcblxuXHR0aGlzLnNldFRlbXBvID0gZnVuY3Rpb24obGluZSwgc3RhcnQsIGVuZCkge1xuXHRcdC8vUSAtIHRlbXBvOyBjYW4gYmUgdXNlZCB0byBzcGVjaWZ5IHRoZSBub3RlcyBwZXIgbWludXRlLCBlLmcuIElmXG5cdFx0Ly90aGUgbWV0ZXIgZGVub21pbmF0b3IgaXMgYSA0IG5vdGUgdGhlbiBROjEyMCBvciBROkM9MTIwXG5cdFx0Ly9pcyAxMjAgcXVhcnRlciBub3RlcyBwZXIgbWludXRlLiBTaW1pbGFybHkgIFE6QzM9NDAgd291bGQgYmUgNDBcblx0XHQvL2RvdHRlZCBoYWxmIG5vdGVzIHBlciBtaW51dGUuIEFuIGFic29sdXRlIHRlbXBvIG1heSBhbHNvIGJlXG5cdFx0Ly9zZXQsIGUuZy4gUToxLzg9MTIwIGlzIDEyMCBlaWdodGggbm90ZXMgcGVyIG1pbnV0ZSxcblx0XHQvL2lycmVzcGVjdGl2ZSBvZiB0aGUgbWV0ZXIncyBkZW5vbWluYXRvci5cblx0XHQvL1xuXHRcdC8vIFRoaXMgaXMgZWl0aGVyIGEgbnVtYmVyLCBcIkM9bnVtYmVyXCIsIFwiQ251bWJlcj1udW1iZXJcIiwgb3IgZnJhY3Rpb24gW2ZyYWN0aW9uLi4uXT1udW1iZXJcblx0XHQvLyBJdCBkZXBlbmRzIG9uIHRoZSBNOiBmaWVsZCwgd2hpY2ggbWF5IGVpdGhlciBub3QgYmUgcHJlc2VudCwgb3IgbWF5IGFwcGVhciBhZnRlciB0aGlzLlxuXHRcdC8vIElmIE06IGlzIG5vdCBwcmVzZW50LCBhbiBlaWdodGggbm90ZSBpcyB1c2VkLlxuXHRcdC8vIFRoYXQgbWVhbnMgdGhhdCB0aGlzIGZpZWxkIGNhbid0IGJlIGNhbGN1bGF0ZWQgdW50aWwgdGhlIGVuZCwgaWYgaXQgaXMgdGhlIGZpcnN0IHRocmVlIHR5cGVzLCBzaW5jZSB3ZSBkb24ndCBrbm93IGlmIHdlJ2xsIHNlZSBhbiBNOiBmaWVsZC5cblx0XHQvLyBTbywgaWYgaXQgaXMgdGhlIGZvdXJ0aCB0eXBlLCBzZXQgaXQgaGVyZSwgb3RoZXJ3aXNlLCBzYXZlIHRoZSBpbmZvIGluIHRoZSBtdWx0aWxpbmVWYXJzLlxuXHRcdC8vIFRoZSB0ZW1wb3JhcnkgdmFyaWFibGVzIHdlIGtlZXAgYXJlIHRoZSBkdXJhdGlvbiBhbmQgdGhlIGJwbS4gSW4gdGhlIGZpcnN0IHR3byBmb3JtcywgdGhlIGR1cmF0aW9uIGlzIDEuXG5cdFx0Ly8gSW4gYWRkaXRpb24sIGEgcXVvdGVkIHN0cmluZyBtYXkgYm90aCBwcmVjZWRlIGFuZCBmb2xsb3cuIElmIGEgcXVvdGVkIHN0cmluZyBpcyBwcmVzZW50LCB0aGVuIHRoZSBkdXJhdGlvbiBwYXJ0IGlzIG9wdGlvbmFsLlxuXHRcdHRyeSB7XG5cdFx0XHR2YXIgdG9rZW5zID0gdG9rZW5pemVyLnRva2VuaXplKGxpbmUsIHN0YXJ0LCBlbmQpO1xuXG5cdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgdGhyb3cgXCJNaXNzaW5nIHBhcmFtZXRlciBpbiBROiBmaWVsZFwiO1xuXG5cdFx0XHR2YXIgdGVtcG8gPSB7fTtcblx0XHRcdHZhciBkZWxheVNldCA9IHRydWU7XG5cdFx0XHR2YXIgdG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdGlmICh0b2tlbi50eXBlID09PSAncXVvdGUnKSB7XG5cdFx0XHRcdHRlbXBvLnByZVN0cmluZyA9IHRva2VuLnRva2VuO1xuXHRcdFx0XHR0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkge1x0Ly8gSXQncyBvayB0byBqdXN0IGdldCBhIHN0cmluZyBmb3IgdGhlIHRlbXBvXG5cdFx0XHRcdFx0Ly8gSWYgdGhlIHN0cmluZyBpcyBhIHdlbGwta25vd24gdGVtcG8sIHB1dCBpbiB0aGUgYnBtXG5cdFx0XHRcdFx0aWYgKHRlbXBvU3RyaW5nW3RlbXBvLnByZVN0cmluZy50b0xvd2VyQ2FzZSgpXSkge1xuXHRcdFx0XHRcdFx0dGVtcG8uYnBtID0gdGVtcG9TdHJpbmdbdGVtcG8ucHJlU3RyaW5nLnRvTG93ZXJDYXNlKCldO1xuXHRcdFx0XHRcdFx0dGVtcG8uc3VwcHJlc3NCcG0gPSB0cnVlO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRyZXR1cm4ge3R5cGU6ICdpbW1lZGlhdGUnLCB0ZW1wbzogdGVtcG99O1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRpZiAodG9rZW4udHlwZSA9PT0gJ2FscGhhJyAmJiB0b2tlbi50b2tlbiA9PT0gJ0MnKVx0IHsgLy8gZWl0aGVyIHR5cGUgMiBvciB0eXBlIDNcblx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHRocm93IFwiTWlzc2luZyB0ZW1wbyBhZnRlciBDIGluIFE6IGZpZWxkXCI7XG5cdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdGlmICh0b2tlbi50eXBlID09PSAncHVuY3QnICYmIHRva2VuLnRva2VuID09PSAnPScpIHtcblx0XHRcdFx0XHQvLyBUaGlzIGlzIGEgdHlwZSAyIGZvcm1hdC4gVGhlIGR1cmF0aW9uIGlzIGFuIGltcGxpZWQgMVxuXHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSB0aHJvdyBcIk1pc3NpbmcgdGVtcG8gYWZ0ZXIgPSBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnR5cGUgIT09ICdudW1iZXInKSB0aHJvdyBcIkV4cGVjdGVkIG51bWJlciBhZnRlciA9IGluIFE6IGZpZWxkXCI7XG5cdFx0XHRcdFx0dGVtcG8uZHVyYXRpb24gPSBbMV07XG5cdFx0XHRcdFx0dGVtcG8uYnBtID0gcGFyc2VJbnQodG9rZW4udG9rZW4pO1xuXHRcdFx0XHR9IGVsc2UgaWYgKHRva2VuLnR5cGUgPT09ICdudW1iZXInKSB7XG5cdFx0XHRcdFx0Ly8gVGhpcyBpcyBhIHR5cGUgMyBmb3JtYXQuXG5cdFx0XHRcdFx0dGVtcG8uZHVyYXRpb24gPSBbcGFyc2VJbnQodG9rZW4udG9rZW4pXTtcblx0XHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgdGhyb3cgXCJNaXNzaW5nID0gYWZ0ZXIgZHVyYXRpb24gaW4gUTogZmllbGRcIjtcblx0XHRcdFx0XHR0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdGlmICh0b2tlbi50eXBlICE9PSAncHVuY3QnIHx8IHRva2VuLnRva2VuICE9PSAnPScpIHRocm93IFwiRXhwZWN0ZWQgPSBhZnRlciBkdXJhdGlvbiBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSB0aHJvdyBcIk1pc3NpbmcgdGVtcG8gYWZ0ZXIgPSBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnR5cGUgIT09ICdudW1iZXInKSB0aHJvdyBcIkV4cGVjdGVkIG51bWJlciBhZnRlciA9IGluIFE6IGZpZWxkXCI7XG5cdFx0XHRcdFx0dGVtcG8uYnBtID0gcGFyc2VJbnQodG9rZW4udG9rZW4pO1xuXHRcdFx0XHR9IGVsc2UgdGhyb3cgXCJFeHBlY3RlZCBudW1iZXIgb3IgZXF1YWwgYWZ0ZXIgQyBpbiBROiBmaWVsZFwiO1xuXG5cdFx0XHR9IGVsc2UgaWYgKHRva2VuLnR5cGUgPT09ICdudW1iZXInKSB7XHQvLyBlaXRoZXIgdHlwZSAxIG9yIHR5cGUgNFxuXHRcdFx0XHR2YXIgbnVtID0gcGFyc2VJbnQodG9rZW4udG9rZW4pO1xuXHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCB8fCB0b2tlbnNbMF0udHlwZSA9PT0gJ3F1b3RlJykge1xuXHRcdFx0XHRcdC8vIFRoaXMgaXMgdHlwZSAxXG5cdFx0XHRcdFx0dGVtcG8uZHVyYXRpb24gPSBbMV07XG5cdFx0XHRcdFx0dGVtcG8uYnBtID0gbnVtO1xuXHRcdFx0XHR9IGVsc2Uge1x0Ly8gVGhpcyBpcyB0eXBlIDRcblx0XHRcdFx0XHRkZWxheVNldCA9IGZhbHNlO1xuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnR5cGUgIT09ICdwdW5jdCcgJiYgdG9rZW4udG9rZW4gIT09ICcvJykgdGhyb3cgXCJFeHBlY3RlZCBmcmFjdGlvbiBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnR5cGUgIT09ICdudW1iZXInKSB0aHJvdyBcIkV4cGVjdGVkIGZyYWN0aW9uIGluIFE6IGZpZWxkXCI7XG5cdFx0XHRcdFx0dmFyIGRlbiA9IHBhcnNlSW50KHRva2VuLnRva2VuKTtcblx0XHRcdFx0XHR0ZW1wby5kdXJhdGlvbiA9IFtudW0vZGVuXTtcblx0XHRcdFx0XHQvLyBXZSBnb3QgdGhlIGZpcnN0IGZyYWN0aW9uLCBrZWVwIGdldHRpbmcgbW9yZSBhcyBsb25nIGFzIHdlIGZpbmQgdGhlbS5cblx0XHRcdFx0XHR3aGlsZSAodG9rZW5zLmxlbmd0aCA+IDAgICYmIHRva2Vuc1swXS50b2tlbiAhPT0gJz0nICYmIHRva2Vuc1swXS50eXBlICE9PSAncXVvdGUnKSB7XG5cdFx0XHRcdFx0XHR0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0aWYgKHRva2VuLnR5cGUgIT09ICdudW1iZXInKSB0aHJvdyBcIkV4cGVjdGVkIGZyYWN0aW9uIGluIFE6IGZpZWxkXCI7XG5cdFx0XHRcdFx0XHRudW0gPSBwYXJzZUludCh0b2tlbi50b2tlbik7XG5cdFx0XHRcdFx0XHR0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0aWYgKHRva2VuLnR5cGUgIT09ICdwdW5jdCcgJiYgdG9rZW4udG9rZW4gIT09ICcvJykgdGhyb3cgXCJFeHBlY3RlZCBmcmFjdGlvbiBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdFx0dG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRcdGlmICh0b2tlbi50eXBlICE9PSAnbnVtYmVyJykgdGhyb3cgXCJFeHBlY3RlZCBmcmFjdGlvbiBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdFx0ZGVuID0gcGFyc2VJbnQodG9rZW4udG9rZW4pO1xuXHRcdFx0XHRcdFx0dGVtcG8uZHVyYXRpb24ucHVzaChudW0vZGVuKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0dG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRpZiAodG9rZW4udHlwZSAhPT0gJ3B1bmN0JyAmJiB0b2tlbi50b2tlbiAhPT0gJz0nKSB0aHJvdyBcIkV4cGVjdGVkID0gaW4gUTogZmllbGRcIjtcblx0XHRcdFx0XHR0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdGlmICh0b2tlbi50eXBlICE9PSAnbnVtYmVyJykgdGhyb3cgXCJFeHBlY3RlZCB0ZW1wbyBpbiBROiBmaWVsZFwiO1xuXHRcdFx0XHRcdHRlbXBvLmJwbSA9IHBhcnNlSW50KHRva2VuLnRva2VuKTtcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHRocm93IFwiVW5rbm93biB2YWx1ZSBpbiBROiBmaWVsZFwiO1xuXHRcdFx0aWYgKHRva2Vucy5sZW5ndGggIT09IDApIHtcblx0XHRcdFx0dG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0aWYgKHRva2VuLnR5cGUgPT09ICdxdW90ZScpIHtcblx0XHRcdFx0XHR0ZW1wby5wb3N0U3RyaW5nID0gdG9rZW4udG9rZW47XG5cdFx0XHRcdFx0dG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCAhPT0gMCkgdGhyb3cgXCJVbmV4cGVjdGVkIHN0cmluZyBhdCBlbmQgb2YgUTogZmllbGRcIjtcblx0XHRcdH1cblx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLnByaW50VGVtcG8gPT09IGZhbHNlKVxuXHRcdFx0XHR0ZW1wby5zdXBwcmVzcyA9IHRydWU7XG5cdFx0XHRyZXR1cm4ge3R5cGU6IGRlbGF5U2V0PydkZWxheVNldCc6J2ltbWVkaWF0ZScsIHRlbXBvOiB0ZW1wb307XG5cdFx0fSBjYXRjaCAobXNnKSB7XG5cdFx0XHR3YXJuKG1zZywgbGluZSwgc3RhcnQpO1xuXHRcdFx0cmV0dXJuIHt0eXBlOiAnbm9uZSd9O1xuXHRcdH1cblx0fTtcblxuXHR0aGlzLmxldHRlcl90b19pbmxpbmVfaGVhZGVyID0gZnVuY3Rpb24obGluZSwgaSlcblx0e1xuXHRcdHZhciB3cyA9IHRva2VuaXplci5lYXRXaGl0ZVNwYWNlKGxpbmUsIGkpO1xuXHRcdGkgKz13cztcblx0XHRpZiAobGluZS5sZW5ndGggPj0gaSs1ICYmIGxpbmUuY2hhckF0KGkpID09PSAnWycgJiYgbGluZS5jaGFyQXQoaSsyKSA9PT0gJzonKSB7XG5cdFx0XHR2YXIgZSA9IGxpbmUuaW5kZXhPZignXScsIGkpO1xuXHRcdFx0c3dpdGNoKGxpbmUuc3Vic3RyaW5nKGksIGkrMykpXG5cdFx0XHR7XG5cdFx0XHRcdGNhc2UgXCJbSTpcIjpcblx0XHRcdFx0XHR2YXIgZXJyID0gcGFyc2VEaXJlY3RpdmUuYWRkRGlyZWN0aXZlKGxpbmUuc3Vic3RyaW5nKGkrMywgZSkpO1xuXHRcdFx0XHRcdGlmIChlcnIpIHdhcm4oZXJyLCBsaW5lLCBpKTtcblx0XHRcdFx0XHRyZXR1cm4gWyBlLWkrMSt3cyBdO1xuXHRcdFx0XHRjYXNlIFwiW006XCI6XG5cdFx0XHRcdFx0dmFyIG1ldGVyID0gdGhpcy5zZXRNZXRlcihsaW5lLnN1YnN0cmluZyhpKzMsIGUpKTtcblx0XHRcdFx0XHRpZiAodHVuZS5oYXNCZWdpbk11c2ljKCkgJiYgbWV0ZXIpXG5cdFx0XHRcdFx0XHR0dW5lLmFwcGVuZFN0YXJ0aW5nRWxlbWVudCgnbWV0ZXInLCAtMSwgLTEsIG1ldGVyKTtcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLm1ldGVyID0gbWV0ZXI7XG5cdFx0XHRcdFx0cmV0dXJuIFsgZS1pKzErd3MgXTtcblx0XHRcdFx0Y2FzZSBcIltLOlwiOlxuXHRcdFx0XHRcdHZhciByZXN1bHQgPSBwYXJzZUtleVZvaWNlLnBhcnNlS2V5KGxpbmUuc3Vic3RyaW5nKGkrMywgZSkpO1xuXHRcdFx0XHRcdGlmIChyZXN1bHQuZm91bmRDbGVmICYmIHR1bmUuaGFzQmVnaW5NdXNpYygpKVxuXHRcdFx0XHRcdFx0dHVuZS5hcHBlbmRTdGFydGluZ0VsZW1lbnQoJ2NsZWYnLCAtMSwgLTEsIG11bHRpbGluZVZhcnMuY2xlZik7XG5cdFx0XHRcdFx0aWYgKHJlc3VsdC5mb3VuZEtleSAmJiB0dW5lLmhhc0JlZ2luTXVzaWMoKSlcblx0XHRcdFx0XHRcdHR1bmUuYXBwZW5kU3RhcnRpbmdFbGVtZW50KCdrZXknLCAtMSwgLTEsIHBhcnNlS2V5Vm9pY2UuZml4S2V5KG11bHRpbGluZVZhcnMuY2xlZiwgbXVsdGlsaW5lVmFycy5rZXkpKTtcblx0XHRcdFx0XHRyZXR1cm4gWyBlLWkrMSt3cyBdO1xuXHRcdFx0XHRjYXNlIFwiW1A6XCI6XG5cdFx0XHRcdFx0aWYgKHR1bmUubGluZXMubGVuZ3RoIDw9IHR1bmUubGluZU51bSlcblx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMucGFydEZvck5leHRMaW5lID0gbGluZS5zdWJzdHJpbmcoaSszLCBlKTtcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHR0dW5lLmFwcGVuZEVsZW1lbnQoJ3BhcnQnLCAtMSwgLTEsIHt0aXRsZTogbGluZS5zdWJzdHJpbmcoaSszLCBlKX0pO1xuXHRcdFx0XHRcdHJldHVybiBbIGUtaSsxK3dzIF07XG5cdFx0XHRcdGNhc2UgXCJbTDpcIjpcblx0XHRcdFx0XHR0aGlzLnNldERlZmF1bHRMZW5ndGgobGluZSwgaSszLCBlKTtcblx0XHRcdFx0XHRyZXR1cm4gWyBlLWkrMSt3cyBdO1xuXHRcdFx0XHRjYXNlIFwiW1E6XCI6XG5cdFx0XHRcdFx0aWYgKGUgPiAwKSB7XG5cdFx0XHRcdFx0XHR2YXIgdGVtcG8gPSB0aGlzLnNldFRlbXBvKGxpbmUsIGkrMywgZSk7XG5cdFx0XHRcdFx0XHRpZiAodGVtcG8udHlwZSA9PT0gJ2RlbGF5U2V0JykgdHVuZS5hcHBlbmRFbGVtZW50KCd0ZW1wbycsIC0xLCAtMSwgdGhpcy5jYWxjVGVtcG8odGVtcG8udGVtcG8pKTtcblx0XHRcdFx0XHRcdGVsc2UgaWYgKHRlbXBvLnR5cGUgPT09ICdpbW1lZGlhdGUnKSB0dW5lLmFwcGVuZEVsZW1lbnQoJ3RlbXBvJywgLTEsIC0xLCB0ZW1wby50ZW1wbyk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gWyBlLWkrMSt3cywgbGluZS5jaGFyQXQoaSsxKSwgbGluZS5zdWJzdHJpbmcoaSszLCBlKV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiW1Y6XCI6XG5cdFx0XHRcdFx0aWYgKGUgPiAwKSB7XG5cdFx0XHRcdFx0XHRwYXJzZUtleVZvaWNlLnBhcnNlVm9pY2UobGluZSwgaSszLCBlKTtcblx0XHRcdFx0XHRcdC8vc3RhcnROZXdMaW5lKCk7XG5cdFx0XHRcdFx0XHRyZXR1cm4gWyBlLWkrMSt3cywgbGluZS5jaGFyQXQoaSsxKSwgbGluZS5zdWJzdHJpbmcoaSszLCBlKV07XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0Ly8gVE9ETzogY29tcGxhaW4gYWJvdXQgdW5oYW5kbGVkIGhlYWRlclxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gWyAwIF07XG5cdH07XG5cblx0dGhpcy5sZXR0ZXJfdG9fYm9keV9oZWFkZXIgPSBmdW5jdGlvbihsaW5lLCBpKVxuXHR7XG5cdFx0aWYgKGxpbmUubGVuZ3RoID49IGkrMykge1xuXHRcdFx0c3dpdGNoKGxpbmUuc3Vic3RyaW5nKGksIGkrMikpXG5cdFx0XHR7XG5cdFx0XHRcdGNhc2UgXCJJOlwiOlxuXHRcdFx0XHRcdHZhciBlcnIgPSBwYXJzZURpcmVjdGl2ZS5hZGREaXJlY3RpdmUobGluZS5zdWJzdHJpbmcoaSsyKSk7XG5cdFx0XHRcdFx0aWYgKGVycikgd2FybihlcnIsIGxpbmUsIGkpO1xuXHRcdFx0XHRcdHJldHVybiBbIGxpbmUubGVuZ3RoIF07XG5cdFx0XHRcdGNhc2UgXCJNOlwiOlxuXHRcdFx0XHRcdHZhciBtZXRlciA9IHRoaXMuc2V0TWV0ZXIobGluZS5zdWJzdHJpbmcoaSsyKSk7XG5cdFx0XHRcdFx0aWYgKHR1bmUuaGFzQmVnaW5NdXNpYygpICYmIG1ldGVyKVxuXHRcdFx0XHRcdFx0dHVuZS5hcHBlbmRTdGFydGluZ0VsZW1lbnQoJ21ldGVyJywgLTEsIC0xLCBtZXRlcik7XG5cdFx0XHRcdFx0cmV0dXJuIFsgbGluZS5sZW5ndGggXTtcblx0XHRcdFx0Y2FzZSBcIks6XCI6XG5cdFx0XHRcdFx0dmFyIHJlc3VsdCA9IHBhcnNlS2V5Vm9pY2UucGFyc2VLZXkobGluZS5zdWJzdHJpbmcoaSsyKSk7XG5cdFx0XHRcdFx0aWYgKHJlc3VsdC5mb3VuZENsZWYgJiYgdHVuZS5oYXNCZWdpbk11c2ljKCkpXG5cdFx0XHRcdFx0XHR0dW5lLmFwcGVuZFN0YXJ0aW5nRWxlbWVudCgnY2xlZicsIC0xLCAtMSwgbXVsdGlsaW5lVmFycy5jbGVmKTtcblx0XHRcdFx0XHRpZiAocmVzdWx0LmZvdW5kS2V5ICYmIHR1bmUuaGFzQmVnaW5NdXNpYygpKVxuXHRcdFx0XHRcdFx0dHVuZS5hcHBlbmRTdGFydGluZ0VsZW1lbnQoJ2tleScsIC0xLCAtMSwgcGFyc2VLZXlWb2ljZS5maXhLZXkobXVsdGlsaW5lVmFycy5jbGVmLCBtdWx0aWxpbmVWYXJzLmtleSkpO1xuXHRcdFx0XHRcdHJldHVybiBbIGxpbmUubGVuZ3RoIF07XG5cdFx0XHRcdGNhc2UgXCJQOlwiOlxuXHRcdFx0XHRcdGlmICh0dW5lLmhhc0JlZ2luTXVzaWMoKSlcblx0XHRcdFx0XHRcdHR1bmUuYXBwZW5kRWxlbWVudCgncGFydCcsIC0xLCAtMSwge3RpdGxlOiBsaW5lLnN1YnN0cmluZyhpKzIpfSk7XG5cdFx0XHRcdFx0cmV0dXJuIFsgbGluZS5sZW5ndGggXTtcblx0XHRcdFx0Y2FzZSBcIkw6XCI6XG5cdFx0XHRcdFx0dGhpcy5zZXREZWZhdWx0TGVuZ3RoKGxpbmUsIGkrMiwgbGluZS5sZW5ndGgpO1xuXHRcdFx0XHRcdHJldHVybiBbIGxpbmUubGVuZ3RoIF07XG5cdFx0XHRcdGNhc2UgXCJROlwiOlxuXHRcdFx0XHRcdHZhciBlID0gbGluZS5pbmRleE9mKCdcXHgxMicsIGkrMik7XG5cdFx0XHRcdFx0aWYgKGUgPT09IC0xKSBlID0gbGluZS5sZW5ndGg7XG5cdFx0XHRcdFx0dmFyIHRlbXBvID0gdGhpcy5zZXRUZW1wbyhsaW5lLCBpKzIsIGUpO1xuXHRcdFx0XHRcdGlmICh0ZW1wby50eXBlID09PSAnZGVsYXlTZXQnKSB0dW5lLmFwcGVuZEVsZW1lbnQoJ3RlbXBvJywgLTEsIC0xLCB0aGlzLmNhbGNUZW1wbyh0ZW1wby50ZW1wbykpO1xuXHRcdFx0XHRcdGVsc2UgaWYgKHRlbXBvLnR5cGUgPT09ICdpbW1lZGlhdGUnKSB0dW5lLmFwcGVuZEVsZW1lbnQoJ3RlbXBvJywgLTEsIC0xLCB0ZW1wby50ZW1wbyk7XG5cdFx0XHRcdHJldHVybiBbIGUsIGxpbmUuY2hhckF0KGkpLCBwYXJzZUNvbW1vbi5zdHJpcChsaW5lLnN1YnN0cmluZyhpKzIpKV07XG5cdFx0XHRcdGNhc2UgXCJWOlwiOlxuXHRcdFx0XHRcdHBhcnNlS2V5Vm9pY2UucGFyc2VWb2ljZShsaW5lLCBpKzIsIGxpbmUubGVuZ3RoKTtcbi8vXHRcdFx0XHRcdFx0c3RhcnROZXdMaW5lKCk7XG5cdFx0XHRcdFx0cmV0dXJuIFsgbGluZS5sZW5ndGgsIGxpbmUuY2hhckF0KGkpLCBwYXJzZUNvbW1vbi5zdHJpcChsaW5lLnN1YnN0cmluZyhpKzIpKV07XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0Ly8gVE9ETzogY29tcGxhaW4gYWJvdXQgdW5oYW5kbGVkIGhlYWRlclxuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gWyAwIF07XG5cdH07XG5cblx0dmFyIG1ldGFUZXh0SGVhZGVycyA9IHtcblx0XHRBOiAnYXV0aG9yJyxcblx0XHRCOiAnYm9vaycsXG5cdFx0QzogJ2NvbXBvc2VyJyxcblx0XHREOiAnZGlzY29ncmFwaHknLFxuXHRcdEY6ICd1cmwnLFxuXHRcdEc6ICdncm91cCcsXG5cdFx0STogJ2luc3RydWN0aW9uJyxcblx0XHROOiAnbm90ZXMnLFxuXHRcdE86ICdvcmlnaW4nLFxuXHRcdFI6ICdyaHl0aG0nLFxuXHRcdFM6ICdzb3VyY2UnLFxuXHRcdFc6ICd1bmFsaWduZWRXb3JkcycsXG5cdFx0WjogJ3RyYW5zY3JpcHRpb24nXG5cdH07XG5cblx0dGhpcy5wYXJzZUhlYWRlciA9IGZ1bmN0aW9uKGxpbmUpIHtcblx0XHRpZiAocGFyc2VDb21tb24uc3RhcnRzV2l0aChsaW5lLCAnJSUnKSkge1xuXHRcdFx0dmFyIGVyciA9IHBhcnNlRGlyZWN0aXZlLmFkZERpcmVjdGl2ZShsaW5lLnN1YnN0cmluZygyKSk7XG5cdFx0XHRpZiAoZXJyKSB3YXJuKGVyciwgbGluZSwgMik7XG5cdFx0XHRyZXR1cm4ge307XG5cdFx0fVxuXHRcdHZhciBpID0gbGluZS5pbmRleE9mKCclJyk7XG5cdFx0aWYgKGkgPj0gMClcblx0XHRcdGxpbmUgPSBsaW5lLnN1YnN0cmluZygwLCBpKTtcblx0XHRsaW5lID0gbGluZS5yZXBsYWNlKC9cXHMrJC8sICcnKTtcblxuXHRcdGlmIChsaW5lLmxlbmd0aCA9PT0gMClcblx0XHRcdHJldHVybiB7fTtcblxuXHRcdGlmIChsaW5lLmxlbmd0aCA+PSAyKSB7XG5cdFx0XHRpZiAobGluZS5jaGFyQXQoMSkgPT09ICc6Jykge1xuXHRcdFx0XHR2YXIgbmV4dExpbmUgPSBcIlwiO1xuXHRcdFx0XHRpZiAobGluZS5pbmRleE9mKCdcXHgxMicpID49IDAgJiYgbGluZS5jaGFyQXQoMCkgIT09ICd3Jykge1x0Ly8gdzogaXMgdGhlIG9ubHkgaGVhZGVyIGZpZWxkIHRoYXQgY2FuIGhhdmUgYSBjb250aW51YXRpb24uXG5cdFx0XHRcdFx0bmV4dExpbmUgPSBsaW5lLnN1YnN0cmluZyhsaW5lLmluZGV4T2YoJ1xceDEyJykrMSk7XG5cdFx0XHRcdFx0bGluZSA9IGxpbmUuc3Vic3RyaW5nKDAsIGxpbmUuaW5kZXhPZignXFx4MTInKSk7XHQvL1RoaXMgaGFuZGxlcyBhIGNvbnRpbnVhdGlvbiBtYXJrIG9uIGEgaGVhZGVyIGZpZWxkXG5cdFx0XHRcdH1cblx0XHRcdFx0dmFyIGZpZWxkID0gbWV0YVRleHRIZWFkZXJzW2xpbmUuY2hhckF0KDApXTtcblx0XHRcdFx0aWYgKGZpZWxkICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0XHRpZiAoZmllbGQgPT09ICd1bmFsaWduZWRXb3JkcycpXG5cdFx0XHRcdFx0XHR0dW5lLmFkZE1ldGFUZXh0QXJyYXkoZmllbGQsIHBhcnNlRGlyZWN0aXZlLnBhcnNlRm9udENoYW5nZUxpbmUodG9rZW5pemVyLnRyYW5zbGF0ZVN0cmluZyh0b2tlbml6ZXIuc3RyaXBDb21tZW50KGxpbmUuc3Vic3RyaW5nKDIpKSkpKTtcblx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHR0dW5lLmFkZE1ldGFUZXh0KGZpZWxkLCB0b2tlbml6ZXIudHJhbnNsYXRlU3RyaW5nKHRva2VuaXplci5zdHJpcENvbW1lbnQobGluZS5zdWJzdHJpbmcoMikpKSk7XG5cdFx0XHRcdFx0cmV0dXJuIHt9O1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdHN3aXRjaChsaW5lLmNoYXJBdCgwKSlcblx0XHRcdFx0XHR7XG5cdFx0XHRcdFx0XHRjYXNlICAnSCc6XG5cdFx0XHRcdFx0XHRcdHR1bmUuYWRkTWV0YVRleHQoXCJoaXN0b3J5XCIsIHRva2VuaXplci50cmFuc2xhdGVTdHJpbmcodG9rZW5pemVyLnN0cmlwQ29tbWVudChsaW5lLnN1YnN0cmluZygyKSkpKTtcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5pc19pbl9oaXN0b3J5ID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICAnSyc6XG5cdFx0XHRcdFx0XHRcdC8vIHNpbmNlIHRoZSBrZXkgaXMgdGhlIGxhc3QgdGhpbmcgdGhhdCBjYW4gaGFwcGVuIGluIHRoZSBoZWFkZXIsIHdlIGNhbiByZXNvbHZlIHRoZSB0ZW1wbyBub3dcblx0XHRcdFx0XHRcdFx0dGhpcy5yZXNvbHZlVGVtcG8oKTtcblx0XHRcdFx0XHRcdFx0dmFyIHJlc3VsdCA9IHBhcnNlS2V5Vm9pY2UucGFyc2VLZXkobGluZS5zdWJzdHJpbmcoMikpO1xuXHRcdFx0XHRcdFx0XHRpZiAoIW11bHRpbGluZVZhcnMuaXNfaW5faGVhZGVyICYmIHR1bmUuaGFzQmVnaW5NdXNpYygpKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKHJlc3VsdC5mb3VuZENsZWYpXG5cdFx0XHRcdFx0XHRcdFx0XHR0dW5lLmFwcGVuZFN0YXJ0aW5nRWxlbWVudCgnY2xlZicsIC0xLCAtMSwgbXVsdGlsaW5lVmFycy5jbGVmKTtcblx0XHRcdFx0XHRcdFx0XHRpZiAocmVzdWx0LmZvdW5kS2V5KVxuXHRcdFx0XHRcdFx0XHRcdFx0dHVuZS5hcHBlbmRTdGFydGluZ0VsZW1lbnQoJ2tleScsIC0xLCAtMSwgcGFyc2VLZXlWb2ljZS5maXhLZXkobXVsdGlsaW5lVmFycy5jbGVmLCBtdWx0aWxpbmVWYXJzLmtleSkpO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuaXNfaW5faGVhZGVyID0gZmFsc2U7XHQvLyBUaGUgZmlyc3Qga2V5IHNpZ25pZmllcyB0aGUgZW5kIG9mIHRoZSBoZWFkZXIuXG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAgJ0wnOlxuXHRcdFx0XHRcdFx0XHR0aGlzLnNldERlZmF1bHRMZW5ndGgobGluZSwgMiwgbGluZS5sZW5ndGgpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgICdNJzpcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5vcmlnTWV0ZXIgPSBtdWx0aWxpbmVWYXJzLm1ldGVyID0gdGhpcy5zZXRNZXRlcihsaW5lLnN1YnN0cmluZygyKSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAgJ1AnOlxuXHRcdFx0XHRcdFx0XHQvLyBUT0RPLVBFUjogVGhlcmUgaXMgbW9yZSB0byBkbyB3aXRoIHBhcnRzLCBidXQgdGhlIHdyaXRlciBkb2Vzbid0IGNhcmUuXG5cdFx0XHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLmlzX2luX2hlYWRlcilcblx0XHRcdFx0XHRcdFx0XHR0dW5lLmFkZE1ldGFUZXh0KFwicGFydE9yZGVyXCIsIHRva2VuaXplci50cmFuc2xhdGVTdHJpbmcodG9rZW5pemVyLnN0cmlwQ29tbWVudChsaW5lLnN1YnN0cmluZygyKSkpKTtcblx0XHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMucGFydEZvck5leHRMaW5lID0gdG9rZW5pemVyLnRyYW5zbGF0ZVN0cmluZyh0b2tlbml6ZXIuc3RyaXBDb21tZW50KGxpbmUuc3Vic3RyaW5nKDIpKSk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAgJ1EnOlxuXHRcdFx0XHRcdFx0XHR2YXIgdGVtcG8gPSB0aGlzLnNldFRlbXBvKGxpbmUsIDIsIGxpbmUubGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0aWYgKHRlbXBvLnR5cGUgPT09ICdkZWxheVNldCcpIG11bHRpbGluZVZhcnMudGVtcG8gPSB0ZW1wby50ZW1wbztcblx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAodGVtcG8udHlwZSA9PT0gJ2ltbWVkaWF0ZScpIHR1bmUubWV0YVRleHQudGVtcG8gPSB0ZW1wby50ZW1wbztcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICAnVCc6XG5cdFx0XHRcdFx0XHRcdHRoaXMuc2V0VGl0bGUobGluZS5zdWJzdHJpbmcoMikpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ1UnOlxuXHRcdFx0XHRcdFx0XHR0aGlzLmFkZFVzZXJEZWZpbml0aW9uKGxpbmUsIDIsIGxpbmUubGVuZ3RoKTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICAnVic6XG5cdFx0XHRcdFx0XHRcdHBhcnNlS2V5Vm9pY2UucGFyc2VWb2ljZShsaW5lLCAyLCBsaW5lLmxlbmd0aCk7XG5cdFx0XHRcdFx0XHRcdGlmICghbXVsdGlsaW5lVmFycy5pc19pbl9oZWFkZXIpXG5cdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHtuZXdsaW5lOiB0cnVlfTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICAncyc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiB7c3ltYm9sczogdHJ1ZX07XG5cdFx0XHRcdFx0XHRjYXNlICAndyc6XG5cdFx0XHRcdFx0XHRcdHJldHVybiB7d29yZHM6IHRydWV9O1xuXHRcdFx0XHRcdFx0Y2FzZSAnWCc6XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0Y2FzZSAnRSc6XG5cdFx0XHRcdFx0XHRjYXNlICdtJzpcblx0XHRcdFx0XHRcdFx0d2FybihcIklnbm9yZWQgaGVhZGVyXCIsIGxpbmUsIDApO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0XHRcdC8vIEl0IHdhc24ndCBhIHJlY29nbml6ZWQgaGVhZGVyIHZhbHVlLCBzbyBwYXJzZSBpdCBhcyBtdXNpYy5cblx0XHRcdFx0XHRcdFx0aWYgKG5leHRMaW5lLmxlbmd0aClcblx0XHRcdFx0XHRcdFx0XHRuZXh0TGluZSA9IFwiXFx4MTJcIiArIG5leHRMaW5lO1xuXHRcdFx0XHRcdFx0XHQvL3BhcnNlUmVndWxhck11c2ljTGluZShsaW5lK25leHRMaW5lKTtcblx0XHRcdFx0XHRcdFx0Ly9uZXh0TGluZSA9IFwiXCI7XG5cdFx0XHRcdFx0XHRcdHJldHVybiB7cmVndWxhcjogdHJ1ZSwgc3RyOiBsaW5lK25leHRMaW5lfTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKG5leHRMaW5lLmxlbmd0aCA+IDApXG5cdFx0XHRcdFx0cmV0dXJuIHtyZWN1cnNlOiB0cnVlLCBzdHI6IG5leHRMaW5lfTtcblx0XHRcdFx0cmV0dXJuIHt9O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIElmIHdlIGdvdCB0aGlzIGZhciwgd2UgaGF2ZSBhIHJlZ3VsYXIgbGluZSBvZiBtdWxzaWNcblx0XHRyZXR1cm4ge3JlZ3VsYXI6IHRydWUsIHN0cjogbGluZX07XG5cdH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnNlSGVhZGVyO1xuIiwiLypnbG9iYWwgd2luZG93ICovXG5cbnZhciBwYXJzZUNvbW1vbiA9IHJlcXVpcmUoJy4vYWJjX2NvbW1vbicpO1xudmFyIHBhcnNlRGlyZWN0aXZlID0gcmVxdWlyZSgnLi9hYmNfcGFyc2VfZGlyZWN0aXZlJyk7XG52YXIgdHJhbnNwb3NlID0gcmVxdWlyZSgnLi9hYmNfdHJhbnNwb3NlJyk7XG5cbnZhciBwYXJzZUtleVZvaWNlID0ge307XG5cbihmdW5jdGlvbigpIHtcblx0dmFyIHRva2VuaXplcjtcblx0dmFyIHdhcm47XG5cdHZhciBtdWx0aWxpbmVWYXJzO1xuXHR2YXIgdHVuZTtcblx0cGFyc2VLZXlWb2ljZS5pbml0aWFsaXplID0gZnVuY3Rpb24odG9rZW5pemVyXywgd2Fybl8sIG11bHRpbGluZVZhcnNfLCB0dW5lXykge1xuXHRcdHRva2VuaXplciA9IHRva2VuaXplcl87XG5cdFx0d2FybiA9IHdhcm5fO1xuXHRcdG11bHRpbGluZVZhcnMgPSBtdWx0aWxpbmVWYXJzXztcblx0XHR0dW5lID0gdHVuZV87XG5cdH07XG5cblx0cGFyc2VLZXlWb2ljZS5zdGFuZGFyZEtleSA9IGZ1bmN0aW9uKGtleU5hbWUsIHJvb3QsIGFjYywgbG9jYWxUcmFuc3Bvc2UpIHtcblx0XHR2YXIga2V5MXNoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ2YnfTtcblx0XHR2YXIga2V5MnNoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ2MnfTtcblx0XHR2YXIga2V5M3NoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ2cnfTtcblx0XHR2YXIga2V5NHNoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ2QnfTtcblx0XHR2YXIga2V5NXNoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ0EnfTtcblx0XHR2YXIga2V5NnNoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ2UnfTtcblx0XHR2YXIga2V5N3NoYXJwID0ge2FjYzogJ3NoYXJwJywgbm90ZTogJ0InfTtcblx0XHR2YXIga2V5MWZsYXQgPSB7YWNjOiAnZmxhdCcsIG5vdGU6ICdCJ307XG5cdFx0dmFyIGtleTJmbGF0ID0ge2FjYzogJ2ZsYXQnLCBub3RlOiAnZSd9O1xuXHRcdHZhciBrZXkzZmxhdCA9IHthY2M6ICdmbGF0Jywgbm90ZTogJ0EnfTtcblx0XHR2YXIga2V5NGZsYXQgPSB7YWNjOiAnZmxhdCcsIG5vdGU6ICdkJ307XG5cdFx0dmFyIGtleTVmbGF0ID0ge2FjYzogJ2ZsYXQnLCBub3RlOiAnRyd9O1xuXHRcdHZhciBrZXk2ZmxhdCA9IHthY2M6ICdmbGF0Jywgbm90ZTogJ2MnfTtcblx0XHR2YXIga2V5N2ZsYXQgPSB7YWNjOiAnZmxhdCcsIG5vdGU6ICdGJ307XG5cblx0XHR2YXIga2V5cyA9IHtcblx0XHRcdCdDIyc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCwga2V5NHNoYXJwLCBrZXk1c2hhcnAsIGtleTZzaGFycCwga2V5N3NoYXJwIF0sXG5cdFx0XHQnQSNtJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCwga2V5NnNoYXJwLCBrZXk3c2hhcnAgXSxcblx0XHRcdCdHI01peCc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCwga2V5NHNoYXJwLCBrZXk1c2hhcnAsIGtleTZzaGFycCwga2V5N3NoYXJwIF0sXG5cdFx0XHQnRCNEb3InOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAsIGtleTdzaGFycCBdLFxuXHRcdFx0J0UjUGhyJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCwga2V5NnNoYXJwLCBrZXk3c2hhcnAgXSxcblx0XHRcdCdGI0x5ZCc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCwga2V5NHNoYXJwLCBrZXk1c2hhcnAsIGtleTZzaGFycCwga2V5N3NoYXJwIF0sXG5cdFx0XHQnQiNMb2MnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAsIGtleTdzaGFycCBdLFxuXG5cdFx0XHQnRiMnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAgXSxcblx0XHRcdCdEI20nOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAgXSxcblx0XHRcdCdDI01peCc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCwga2V5NHNoYXJwLCBrZXk1c2hhcnAsIGtleTZzaGFycCBdLFxuXHRcdFx0J0cjRG9yJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCwga2V5NnNoYXJwIF0sXG5cdFx0XHQnQSNQaHInOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAgXSxcblx0XHRcdCdCTHlkJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCwga2V5NnNoYXJwIF0sXG5cdFx0XHQnRSNMb2MnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAgXSxcblxuXHRcdFx0J0InOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwIF0sXG5cdFx0XHQnRyNtJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCBdLFxuXHRcdFx0J0YjTWl4JzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCBdLFxuXHRcdFx0J0MjRG9yJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCBdLFxuXHRcdFx0J0QjUGhyJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAsIGtleTVzaGFycCBdLFxuXHRcdFx0J0VMeWQnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwIF0sXG5cdFx0XHQnQSNMb2MnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwIF0sXG5cblx0XHRcdCdFJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAgXSxcblx0XHRcdCdDI20nOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCBdLFxuXHRcdFx0J0JNaXgnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCBdLFxuXHRcdFx0J0YjRG9yJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwLCBrZXk0c2hhcnAgXSxcblx0XHRcdCdHI1Bocic6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCwga2V5NHNoYXJwIF0sXG5cdFx0XHQnQUx5ZCc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCwga2V5NHNoYXJwIF0sXG5cdFx0XHQnRCNMb2MnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCBdLFxuXG5cdFx0XHQnQSc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCBdLFxuXHRcdFx0J0YjbSc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAsIGtleTNzaGFycCBdLFxuXHRcdFx0J0VNaXgnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAgXSxcblx0XHRcdCdCRG9yJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwIF0sXG5cdFx0XHQnQyNQaHInOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAgXSxcblx0XHRcdCdETHlkJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCwga2V5M3NoYXJwIF0sXG5cdFx0XHQnRyNMb2MnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAgXSxcblxuXHRcdFx0J0QnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwIF0sXG5cdFx0XHQnQm0nOiBbIGtleTFzaGFycCwga2V5MnNoYXJwIF0sXG5cdFx0XHQnQU1peCc6IFsga2V5MXNoYXJwLCBrZXkyc2hhcnAgXSxcblx0XHRcdCdFRG9yJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCBdLFxuXHRcdFx0J0YjUGhyJzogWyBrZXkxc2hhcnAsIGtleTJzaGFycCBdLFxuXHRcdFx0J0dMeWQnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwIF0sXG5cdFx0XHQnQyNMb2MnOiBbIGtleTFzaGFycCwga2V5MnNoYXJwIF0sXG5cblx0XHRcdCdHJzogWyBrZXkxc2hhcnAgXSxcblx0XHRcdCdFbSc6IFsga2V5MXNoYXJwIF0sXG5cdFx0XHQnRE1peCc6IFsga2V5MXNoYXJwIF0sXG5cdFx0XHQnQURvcic6IFsga2V5MXNoYXJwIF0sXG5cdFx0XHQnQlBocic6IFsga2V5MXNoYXJwIF0sXG5cdFx0XHQnQ0x5ZCc6IFsga2V5MXNoYXJwIF0sXG5cdFx0XHQnRiNMb2MnOiBbIGtleTFzaGFycCBdLFxuXG5cdFx0XHQnQyc6IFtdLFxuXHRcdFx0J0FtJzogW10sXG5cdFx0XHQnR01peCc6IFtdLFxuXHRcdFx0J0REb3InOiBbXSxcblx0XHRcdCdFUGhyJzogW10sXG5cdFx0XHQnRkx5ZCc6IFtdLFxuXHRcdFx0J0JMb2MnOiBbXSxcblxuXHRcdFx0J0YnOiBbIGtleTFmbGF0IF0sXG5cdFx0XHQnRG0nOiBbIGtleTFmbGF0IF0sXG5cdFx0XHQnQ01peCc6IFsga2V5MWZsYXQgXSxcblx0XHRcdCdHRG9yJzogWyBrZXkxZmxhdCBdLFxuXHRcdFx0J0FQaHInOiBbIGtleTFmbGF0IF0sXG5cdFx0XHQnQmJMeWQnOiBbIGtleTFmbGF0IF0sXG5cdFx0XHQnRUxvYyc6IFsga2V5MWZsYXQgXSxcblxuXHRcdFx0J0JiJzogWyBrZXkxZmxhdCwga2V5MmZsYXQgXSxcblx0XHRcdCdHbSc6IFsga2V5MWZsYXQsIGtleTJmbGF0IF0sXG5cdFx0XHQnRk1peCc6IFsga2V5MWZsYXQsIGtleTJmbGF0IF0sXG5cdFx0XHQnQ0Rvcic6IFsga2V5MWZsYXQsIGtleTJmbGF0IF0sXG5cdFx0XHQnRFBocic6IFsga2V5MWZsYXQsIGtleTJmbGF0IF0sXG5cdFx0XHQnRWJMeWQnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCBdLFxuXHRcdFx0J0FMb2MnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCBdLFxuXG5cdFx0XHQnRWInOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQgXSxcblx0XHRcdCdDbSc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCBdLFxuXHRcdFx0J0JiTWl4JzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0IF0sXG5cdFx0XHQnRkRvcic6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCBdLFxuXHRcdFx0J0dQaHInOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQgXSxcblx0XHRcdCdBYkx5ZCc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCBdLFxuXHRcdFx0J0RMb2MnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQgXSxcblxuXHRcdFx0J0FiJzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCBdLFxuXHRcdFx0J0ZtJzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCBdLFxuXHRcdFx0J0ViTWl4JzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCBdLFxuXHRcdFx0J0JiRG9yJzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCBdLFxuXHRcdFx0J0NQaHInOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0IF0sXG5cdFx0XHQnRGJMeWQnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0IF0sXG5cdFx0XHQnR0xvYyc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQgXSxcblxuXHRcdFx0J0RiJzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCwga2V5NWZsYXQgXSxcblx0XHRcdCdCYm0nOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCBdLFxuXHRcdFx0J0FiTWl4JzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCwga2V5NWZsYXQgXSxcblx0XHRcdCdFYkRvcic6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0IF0sXG5cdFx0XHQnRlBocic6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0IF0sXG5cdFx0XHQnR2JMeWQnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCBdLFxuXHRcdFx0J0NMb2MnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCBdLFxuXG5cdFx0XHQnR2InOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCwga2V5NmZsYXQgXSxcblx0XHRcdCdFYm0nOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCwga2V5NmZsYXQgXSxcblx0XHRcdCdEYk1peCc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCBdLFxuXHRcdFx0J0FiRG9yJzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCwga2V5NWZsYXQsIGtleTZmbGF0IF0sXG5cdFx0XHQnQmJQaHInOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCwga2V5NmZsYXQgXSxcblx0XHRcdCdDYkx5ZCc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCBdLFxuXHRcdFx0J0ZMb2MnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQsIGtleTRmbGF0LCBrZXk1ZmxhdCwga2V5NmZsYXQgXSxcblxuXHRcdFx0J0NiJzogWyBrZXkxZmxhdCwga2V5MmZsYXQsIGtleTNmbGF0LCBrZXk0ZmxhdCwga2V5NWZsYXQsIGtleTZmbGF0LCBrZXk3ZmxhdCBdLFxuXHRcdFx0J0FibSc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCwga2V5N2ZsYXQgXSxcblx0XHRcdCdHYk1peCc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCwga2V5N2ZsYXQgXSxcblx0XHRcdCdEYkRvcic6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCwga2V5N2ZsYXQgXSxcblx0XHRcdCdFYlBocic6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCwga2V5N2ZsYXQgXSxcblx0XHRcdCdGYkx5ZCc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCwga2V5N2ZsYXQgXSxcblx0XHRcdCdCYkxvYyc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQsIGtleTVmbGF0LCBrZXk2ZmxhdCwga2V5N2ZsYXQgXSxcblxuXHRcdFx0Ly8gVGhlIGZvbGxvd2luZyBhcmUgbm90IGluIHRoZSAyLjAgc3BlYywgYnV0IHNlZW0gbm9ybWFsIGVub3VnaC5cblx0XHRcdC8vIFRPRE8tUEVSOiBUaGVzZSBTT1VORCB0aGUgc2FtZSBhcyB3aGF0J3Mgd3JpdHRlbiwgYnV0IHRoZXkgYXJlbid0IHJpZ2h0XG5cdFx0XHQnQSMnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCBdLFxuXHRcdFx0J0IjJzogW10sXG5cdFx0XHQnRCMnOiBbIGtleTFmbGF0LCBrZXkyZmxhdCwga2V5M2ZsYXQgXSxcblx0XHRcdCdFIyc6IFsga2V5MWZsYXQgXSxcblx0XHRcdCdHIyc6IFsga2V5MWZsYXQsIGtleTJmbGF0LCBrZXkzZmxhdCwga2V5NGZsYXQgXSxcblx0XHRcdCdHYm0nOiBbIGtleTFzaGFycCwga2V5MnNoYXJwLCBrZXkzc2hhcnAsIGtleTRzaGFycCwga2V5NXNoYXJwLCBrZXk2c2hhcnAsIGtleTdzaGFycCBdXG5cdFx0fTtcblxuXHRcdHJldHVybiB0cmFuc3Bvc2Uua2V5U2lnbmF0dXJlKG11bHRpbGluZVZhcnMsIGtleXMsIGtleU5hbWUsIHJvb3QsIGFjYywgbG9jYWxUcmFuc3Bvc2UpO1xuXHR9O1xuXG5cdHZhciBjbGVmTGluZXMgPSB7XG5cdFx0J3RyZWJsZSc6IHsgY2xlZjogJ3RyZWJsZScsIHBpdGNoOiA0LCBtaWQ6IDAgfSxcblx0XHQndHJlYmxlKzgnOiB7IGNsZWY6ICd0cmVibGUrOCcsIHBpdGNoOiA0LCBtaWQ6IDAgfSxcblx0XHQndHJlYmxlLTgnOiB7IGNsZWY6ICd0cmVibGUtOCcsIHBpdGNoOiA0LCBtaWQ6IDAgfSxcblx0XHQndHJlYmxlMSc6IHsgY2xlZjogJ3RyZWJsZScsIHBpdGNoOiAyLCBtaWQ6IDIgfSxcblx0XHQndHJlYmxlMic6IHsgY2xlZjogJ3RyZWJsZScsIHBpdGNoOiA0LCBtaWQ6IDAgfSxcblx0XHQndHJlYmxlMyc6IHsgY2xlZjogJ3RyZWJsZScsIHBpdGNoOiA2LCBtaWQ6IC0yIH0sXG5cdFx0J3RyZWJsZTQnOiB7IGNsZWY6ICd0cmVibGUnLCBwaXRjaDogOCwgbWlkOiAtNCB9LFxuXHRcdCd0cmVibGU1JzogeyBjbGVmOiAndHJlYmxlJywgcGl0Y2g6IDEwLCBtaWQ6IC02IH0sXG5cdFx0J3BlcmMnOiB7IGNsZWY6ICdwZXJjJywgcGl0Y2g6IDYsIG1pZDogMCB9LFxuXHRcdCdub25lJzogeyBjbGVmOiAnbm9uZScsIG1pZDogMCB9LFxuXHRcdCdiYXNzJzogeyBjbGVmOiAnYmFzcycsIHBpdGNoOiA4LCBtaWQ6IC0xMiB9LFxuXHRcdCdiYXNzKzgnOiB7IGNsZWY6ICdiYXNzKzgnLCBwaXRjaDogOCwgbWlkOiAtMTIgfSxcblx0XHQnYmFzcy04JzogeyBjbGVmOiAnYmFzcy04JywgcGl0Y2g6IDgsIG1pZDogLTEyIH0sXG5cdFx0J2Jhc3MrMTYnOiB7IGNsZWY6ICdiYXNzJywgcGl0Y2g6IDgsIG1pZDogLTEyIH0sXG5cdFx0J2Jhc3MtMTYnOiB7IGNsZWY6ICdiYXNzJywgcGl0Y2g6IDgsIG1pZDogLTEyIH0sXG5cdFx0J2Jhc3MxJzogeyBjbGVmOiAnYmFzcycsIHBpdGNoOiAyLCBtaWQ6IC02IH0sXG5cdFx0J2Jhc3MyJzogeyBjbGVmOiAnYmFzcycsIHBpdGNoOiA0LCBtaWQ6IC04IH0sXG5cdFx0J2Jhc3MzJzogeyBjbGVmOiAnYmFzcycsIHBpdGNoOiA2LCBtaWQ6IC0xMCB9LFxuXHRcdCdiYXNzNCc6IHsgY2xlZjogJ2Jhc3MnLCBwaXRjaDogOCwgbWlkOiAtMTIgfSxcblx0XHQnYmFzczUnOiB7IGNsZWY6ICdiYXNzJywgcGl0Y2g6IDEwLCBtaWQ6IC0xNCB9LFxuXHRcdCd0ZW5vcic6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogOCwgbWlkOiAtOCB9LFxuXHRcdCd0ZW5vcjEnOiB7IGNsZWY6ICdhbHRvJywgcGl0Y2g6IDIsIG1pZDogLTIgfSxcblx0XHQndGVub3IyJzogeyBjbGVmOiAnYWx0bycsIHBpdGNoOiA0LCBtaWQ6IC00IH0sXG5cdFx0J3Rlbm9yMyc6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogNiwgbWlkOiAtNiB9LFxuXHRcdCd0ZW5vcjQnOiB7IGNsZWY6ICdhbHRvJywgcGl0Y2g6IDgsIG1pZDogLTggfSxcblx0XHQndGVub3I1JzogeyBjbGVmOiAnYWx0bycsIHBpdGNoOiAxMCwgbWlkOiAtMTAgfSxcblx0XHQnYWx0byc6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogNiwgbWlkOiAtNiB9LFxuXHRcdCdhbHRvMSc6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogMiwgbWlkOiAtMiB9LFxuXHRcdCdhbHRvMic6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogNCwgbWlkOiAtNCB9LFxuXHRcdCdhbHRvMyc6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogNiwgbWlkOiAtNiB9LFxuXHRcdCdhbHRvNCc6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogOCwgbWlkOiAtOCB9LFxuXHRcdCdhbHRvNSc6IHsgY2xlZjogJ2FsdG8nLCBwaXRjaDogMTAsIG1pZDogLTEwIH0sXG5cdFx0J2FsdG8rOCc6IHsgY2xlZjogJ2FsdG8rOCcsIHBpdGNoOiA2LCBtaWQ6IC02IH0sXG5cdFx0J2FsdG8tOCc6IHsgY2xlZjogJ2FsdG8tOCcsIHBpdGNoOiA2LCBtaWQ6IC02IH1cblx0fTtcblxuXHR2YXIgY2FsY01pZGRsZSA9IGZ1bmN0aW9uKGNsZWYsIG9jdCkge1xuXHRcdHZhciB2YWx1ZSA9IGNsZWZMaW5lc1tjbGVmXTtcblx0XHR2YXIgbWlkID0gdmFsdWUgPyB2YWx1ZS5taWQgOiAwO1xuXHRcdHJldHVybiBtaWQrb2N0O1xuXHR9O1xuXG5cdHBhcnNlS2V5Vm9pY2UuZml4Q2xlZiA9IGZ1bmN0aW9uKGNsZWYpIHtcblx0XHR2YXIgdmFsdWUgPSBjbGVmTGluZXNbY2xlZi50eXBlXTtcblx0XHRpZiAodmFsdWUpIHtcblx0XHRcdGNsZWYuY2xlZlBvcyA9IHZhbHVlLnBpdGNoO1xuXHRcdFx0Y2xlZi50eXBlID0gdmFsdWUuY2xlZjtcblx0XHR9XG5cdH07XG5cblx0cGFyc2VLZXlWb2ljZS5kZWVwQ29weUtleSA9IGZ1bmN0aW9uKGtleSkge1xuXHRcdHZhciByZXQgPSB7IGFjY2lkZW50YWxzOiBbXSwgcm9vdDoga2V5LnJvb3QsIGFjYzoga2V5LmFjYywgbW9kZToga2V5Lm1vZGUgfTtcblx0XHRwYXJzZUNvbW1vbi5lYWNoKGtleS5hY2NpZGVudGFscywgZnVuY3Rpb24oaykge1xuXHRcdHJldC5hY2NpZGVudGFscy5wdXNoKHBhcnNlQ29tbW9uLmNsb25lKGspKTtcblx0XHR9KTtcblx0XHRyZXR1cm4gcmV0O1xuXHR9O1xuXG5cdHZhciBwaXRjaGVzID0ge0E6IDUsIEI6IDYsIEM6IDAsIEQ6IDEsIEU6IDIsIEY6IDMsIEc6IDQsIGE6IDEyLCBiOiAxMywgYzogNywgZDogOCwgZTogOSwgZjogMTAsIGc6IDExfTtcblxuXHRwYXJzZUtleVZvaWNlLmFkZFBvc1RvS2V5ID0gZnVuY3Rpb24oY2xlZiwga2V5KSB7XG5cdFx0Ly8gU2hpZnQgdGhlIGtleSBzaWduYXR1cmUgZnJvbSB0aGUgdHJlYmxlIHBvc2l0aW9ucyB0byB3aGF0ZXZlciBwb3NpdGlvbiBpcyBuZWVkZWQgZm9yIHRoZSBjbGVmLlxuXHRcdC8vIFRoaXMgbWF5IHB1dCB0aGUga2V5IHNpZ25hdHVyZSB1bm5hdHVyYWxseSBoaWdoIG9yIGxvdywgc28gaWYgaXQgZG9lcywgdGhlbiBzaGlmdCBpdC5cblx0XHR2YXIgbWlkID0gY2xlZi52ZXJ0aWNhbFBvcztcblx0XHRwYXJzZUNvbW1vbi5lYWNoKGtleS5hY2NpZGVudGFscywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHR2YXIgcGl0Y2ggPSBwaXRjaGVzW2FjYy5ub3RlXTtcblx0XHRcdHBpdGNoID0gcGl0Y2ggLSBtaWQ7XG5cdFx0XHRhY2MudmVydGljYWxQb3MgPSBwaXRjaDtcblx0XHR9KTtcblx0XHRpZiAoa2V5LmltcGxpZWROYXR1cmFscylcblx0XHRcdHBhcnNlQ29tbW9uLmVhY2goa2V5LmltcGxpZWROYXR1cmFscywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHRcdHZhciBwaXRjaCA9IHBpdGNoZXNbYWNjLm5vdGVdO1xuXHRcdFx0XHRwaXRjaCA9IHBpdGNoIC0gbWlkO1xuXHRcdFx0XHRhY2MudmVydGljYWxQb3MgPSBwaXRjaDtcblx0XHRcdH0pO1xuXG5cdFx0aWYgKG1pZCA8IC0xMCkge1xuXHRcdFx0cGFyc2VDb21tb24uZWFjaChrZXkuYWNjaWRlbnRhbHMsIGZ1bmN0aW9uKGFjYykge1xuXHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT0gNztcblx0XHRcdFx0aWYgKGFjYy52ZXJ0aWNhbFBvcyA+PSAxMSB8fCAoYWNjLnZlcnRpY2FsUG9zID09PSAxMCAmJiBhY2MuYWNjID09PSAnZmxhdCcpKVxuXHRcdFx0XHRcdGFjYy52ZXJ0aWNhbFBvcyAtPSA3O1xuXHRcdFx0XHRpZiAoYWNjLm5vdGUgPT09ICdBJyAmJiBhY2MuYWNjID09PSAnc2hhcnAnIClcblx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT03O1xuXHRcdFx0XHRpZiAoKGFjYy5ub3RlID09PSAnRycgfHwgYWNjLm5vdGUgPT09ICdGJykgJiYgYWNjLmFjYyA9PT0gJ2ZsYXQnIClcblx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT03O1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAoa2V5LmltcGxpZWROYXR1cmFscylcblx0XHRcdFx0cGFyc2VDb21tb24uZWFjaChrZXkuaW1wbGllZE5hdHVyYWxzLCBmdW5jdGlvbihhY2MpIHtcblx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT0gNztcblx0XHRcdFx0XHRpZiAoYWNjLnZlcnRpY2FsUG9zID49IDExIHx8IChhY2MudmVydGljYWxQb3MgPT09IDEwICYmIGFjYy5hY2MgPT09ICdmbGF0JykpXG5cdFx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT0gNztcblx0XHRcdFx0XHRpZiAoYWNjLm5vdGUgPT09ICdBJyAmJiBhY2MuYWNjID09PSAnc2hhcnAnIClcblx0XHRcdFx0XHRcdGFjYy52ZXJ0aWNhbFBvcyAtPTc7XG5cdFx0XHRcdFx0aWYgKChhY2Mubm90ZSA9PT0gJ0cnIHx8IGFjYy5ub3RlID09PSAnRicpICYmIGFjYy5hY2MgPT09ICdmbGF0JyApXG5cdFx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT03O1xuXHRcdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKG1pZCA8IC00KSB7XG5cdFx0XHRwYXJzZUNvbW1vbi5lYWNoKGtleS5hY2NpZGVudGFscywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHRcdGFjYy52ZXJ0aWNhbFBvcyAtPSA3O1xuXHRcdFx0XHRpZiAobWlkID09PSAtOCAmJiAoYWNjLm5vdGUgPT09ICdmJyB8fCBhY2Mubm90ZSA9PT0gJ2cnKSAmJiBhY2MuYWNjID09PSAnc2hhcnAnIClcblx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT03O1xuXHRcdFx0fSk7XG5cdFx0XHRpZiAoa2V5LmltcGxpZWROYXR1cmFscylcblx0XHRcdFx0cGFyc2VDb21tb24uZWFjaChrZXkuaW1wbGllZE5hdHVyYWxzLCBmdW5jdGlvbihhY2MpIHtcblx0XHRcdFx0XHRhY2MudmVydGljYWxQb3MgLT0gNztcblx0XHRcdFx0XHRpZiAobWlkID09PSAtOCAmJiAoYWNjLm5vdGUgPT09ICdmJyB8fCBhY2Mubm90ZSA9PT0gJ2cnKSAmJiBhY2MuYWNjID09PSAnc2hhcnAnIClcblx0XHRcdFx0XHRcdGFjYy52ZXJ0aWNhbFBvcyAtPTc7XG5cdFx0XHRcdH0pO1xuXHRcdH0gZWxzZSBpZiAobWlkID49IDcpIHtcblx0XHRcdHBhcnNlQ29tbW9uLmVhY2goa2V5LmFjY2lkZW50YWxzLCBmdW5jdGlvbihhY2MpIHtcblx0XHRcdFx0YWNjLnZlcnRpY2FsUG9zICs9IDc7XG5cdFx0XHR9KTtcblx0XHRcdGlmIChrZXkuaW1wbGllZE5hdHVyYWxzKVxuXHRcdFx0XHRwYXJzZUNvbW1vbi5lYWNoKGtleS5pbXBsaWVkTmF0dXJhbHMsIGZ1bmN0aW9uKGFjYykge1xuXHRcdFx0XHRcdGFjYy52ZXJ0aWNhbFBvcyArPSA3O1xuXHRcdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0cGFyc2VLZXlWb2ljZS5maXhLZXkgPSBmdW5jdGlvbihjbGVmLCBrZXkpIHtcblx0XHR2YXIgZml4ZWRLZXkgPSBwYXJzZUNvbW1vbi5jbG9uZShrZXkpO1xuXHRcdHBhcnNlS2V5Vm9pY2UuYWRkUG9zVG9LZXkoY2xlZiwgZml4ZWRLZXkpO1xuXHRcdHJldHVybiBmaXhlZEtleTtcblx0fTtcblxuXHR2YXIgcGFyc2VNaWRkbGUgPSBmdW5jdGlvbihzdHIpIHtcblx0XHR2YXIgaSA9IDA7XG5cdFx0dmFyIHAgPSBzdHIuY2hhckF0KGkrKyk7XG5cdFx0aWYgKHAgPT09ICdeJyB8fCBwID09PSAnXycpXG5cdFx0XHRwID0gc3RyLmNoYXJBdChpKyspO1xuXHQgIHZhciBtaWQgPSBwaXRjaGVzW3BdO1xuXHRcdGlmIChtaWQgPT09IHVuZGVmaW5lZClcblx0XHRcdG1pZCA9IDY7IC8vIElmIGEgbGVnYWwgbWlkZGxlIG5vdGUgd2Fzbid0IHJlY2VpdmVkLCBqdXN0IGlnbm9yZSBpdC5cblx0XHRmb3IgKCA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmIChzdHIuY2hhckF0KGkpID09PSAnLCcpIG1pZCAtPSA3O1xuXHRcdFx0ZWxzZSBpZiAoc3RyLmNoYXJBdChpKSA9PT0gXCInXCIpIG1pZCArPSA3O1xuXHRcdFx0ZWxzZSBicmVhaztcblx0XHR9XG5cdFx0cmV0dXJuIHsgbWlkOiBtaWQgLSA2LCBzdHI6IHN0ci5zdWJzdHJpbmcoaSkgfTtcdC8vIFdlIGdldCB0aGUgbm90ZSBpbiB0aGUgbWlkZGxlIG9mIHRoZSBzdGFmZi4gV2Ugd2FudCB0aGUgbm90ZSB0aGF0IGFwcGVhcnMgYXMgdGhlIGZpcnN0IGxlZGdlciBsaW5lIGJlbG93IHRoZSBzdGFmZi5cblx0fTtcblxuXHR2YXIgbm9ybWFsaXplQWNjaWRlbnRhbHMgPSBmdW5jdGlvbihhY2NzKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhY2NzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAoYWNjc1tpXS5ub3RlID09PSAnYicpXG5cdFx0XHRcdGFjY3NbaV0ubm90ZSA9ICdCJztcblx0XHRcdGVsc2UgaWYgKGFjY3NbaV0ubm90ZSA9PT0gJ2EnKVxuXHRcdFx0XHRhY2NzW2ldLm5vdGUgPSAnQSc7XG5cdFx0XHRlbHNlIGlmIChhY2NzW2ldLm5vdGUgPT09ICdGJylcblx0XHRcdFx0YWNjc1tpXS5ub3RlID0gJ2YnO1xuXHRcdFx0ZWxzZSBpZiAoYWNjc1tpXS5ub3RlID09PSAnRScpXG5cdFx0XHRcdGFjY3NbaV0ubm90ZSA9ICdlJztcblx0XHRcdGVsc2UgaWYgKGFjY3NbaV0ubm90ZSA9PT0gJ0QnKVxuXHRcdFx0XHRhY2NzW2ldLm5vdGUgPSAnZCc7XG5cdFx0XHRlbHNlIGlmIChhY2NzW2ldLm5vdGUgPT09ICdDJylcblx0XHRcdFx0YWNjc1tpXS5ub3RlID0gJ2MnO1xuXHRcdFx0ZWxzZSBpZiAoYWNjc1tpXS5ub3RlID09PSAnRycgJiYgYWNjc1tpXS5hY2MgPT09ICdzaGFycCcpXG5cdFx0XHRcdGFjY3NbaV0ubm90ZSA9ICdnJztcblx0XHRcdGVsc2UgaWYgKGFjY3NbaV0ubm90ZSA9PT0gJ2cnICYmIGFjY3NbaV0uYWNjID09PSAnZmxhdCcpXG5cdFx0XHRcdGFjY3NbaV0ubm90ZSA9ICdHJztcblx0XHR9XG5cdH07XG5cblx0cGFyc2VLZXlWb2ljZS5wYXJzZUtleSA9IGZ1bmN0aW9uKHN0cilcdC8vIChhbmQgY2xlZilcblx0e1xuXHRcdC8vIHJldHVybnM6XG5cdFx0Ly9cdFx0eyBmb3VuZENsZWY6IHRydWUsIGZvdW5kS2V5OiB0cnVlIH1cblx0XHQvLyBTaWRlIGVmZmVjdHM6XG5cdFx0Ly9cdFx0Y2FsbHMgd2FybigpIHdoZW4gdGhlcmUgaXMgYSBzeW50YXggZXJyb3Jcblx0XHQvL1x0XHRzZXRzIHRoZXNlIG1lbWJlcnMgb2YgbXVsdGlsaW5lVmFyczpcblx0XHQvL1x0XHRcdGNsZWZcblx0XHQvL1x0XHRcdGtleVxuXHRcdC8vXHRcdFx0c3R5bGVcblx0XHQvL1xuXHRcdC8vIFRoZSBmb3JtYXQgaXM6XG5cdFx0Ly8gSzogW+KfqGtleeKfqV0gW+KfqG1vZGlmaWVyc+KfqSpdXG5cdFx0Ly8gbW9kaWZpZXJzIGFyZSBhbnkgb2YgdGhlIGZvbGxvd2luZyBpbiBhbnkgb3JkZXI6XG5cdFx0Ly8gIFvin6hjbGVm4p+pXSBbbWlkZGxlPeKfqHBpdGNo4p+pXSBbdHJhbnNwb3NlPVstXeKfqG51bWJlcuKfqV0gW3N0YWZmbGluZXM94p+obnVtYmVy4p+pXSBbc3RhZmZzY2FsZT3in6hudW1iZXLin6ldW3N0eWxlPeKfqHN0eWxl4p+pXVxuXHRcdC8vIGtleSBpcyBub25lfEhQfEhwfOKfqHNwZWNpZmllZF9rZXnin6lcblx0XHQvLyBjbGVmIGlzIFtjbGVmPV0gW+KfqGNsZWYgdHlwZeKfqV0gW+KfqGxpbmUgbnVtYmVy4p+pXSBbKzh8LThdXG5cdFx0Ly8gc3BlY2lmaWVkX2tleSBpcyDin6hwaXRjaOKfqVsjfGJdW21vZGUoZmlyc3QgdGhyZWUgY2hhcnMgYXJlIHNpZ25pZmljYW50KV1bYWNjaWRlbnRhbHMqXVxuXHRcdGlmIChzdHIubGVuZ3RoID09PSAwKSB7XG5cdFx0XHQvLyBhbiBlbXB0eSBLOiBmaWVsZCBpcyB0aGUgc2FtZSBhcyBLOm5vbmVcblx0XHRcdHN0ciA9ICdub25lJztcblx0XHR9XG5cdFx0dmFyIHRva2VucyA9IHRva2VuaXplci50b2tlbml6ZShzdHIsIDAsIHN0ci5sZW5ndGgpO1xuXHRcdHZhciByZXQgPSB7fTtcblxuXHRcdC8vIGZpcnN0IHRoZSBrZXlcblx0XHRzd2l0Y2ggKHRva2Vuc1swXS50b2tlbikge1xuXHRcdFx0Y2FzZSAnSFAnOlxuXHRcdFx0XHRwYXJzZURpcmVjdGl2ZS5hZGREaXJlY3RpdmUoXCJiYWdwaXBlc1wiKTtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5rZXkgPSB7IHJvb3Q6IFwiSFBcIiwgYWNjaWRlbnRhbHM6IFtdLCBhY2M6IFwiXCIsIG1vZGU6IFwiXCIgfTtcblx0XHRcdFx0cmV0LmZvdW5kS2V5ID0gdHJ1ZTtcblx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnSHAnOlxuXHRcdFx0XHRwYXJzZURpcmVjdGl2ZS5hZGREaXJlY3RpdmUoXCJiYWdwaXBlc1wiKTtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy5rZXkgPSB7IHJvb3Q6IFwiSHBcIiwgYWNjaWRlbnRhbHM6IFt7YWNjOiAnbmF0dXJhbCcsIG5vdGU6ICdnJ30sIHthY2M6ICdzaGFycCcsIG5vdGU6ICdmJ30sIHthY2M6ICdzaGFycCcsIG5vdGU6ICdjJ31dLCBhY2M6IFwiXCIsIG1vZGU6IFwiXCIgfTtcblx0XHRcdFx0cmV0LmZvdW5kS2V5ID0gdHJ1ZTtcblx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnbm9uZSc6XG5cdFx0XHRcdC8vIHdlIGdvdCB0aGUgbm9uZSBrZXkgLSB0aGF0J3MgdGhlIHNhbWUgYXMgQyB0byB1c1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmtleSA9IHsgcm9vdDogXCJub25lXCIsIGFjY2lkZW50YWxzOiBbXSwgYWNjOiBcIlwiLCBtb2RlOiBcIlwiIH07XG5cdFx0XHRcdHJldC5mb3VuZEtleSA9IHRydWU7XG5cdFx0XHRcdHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdHZhciByZXRQaXRjaCA9IHRva2VuaXplci5nZXRLZXlQaXRjaCh0b2tlbnNbMF0udG9rZW4pO1xuXHRcdFx0XHRpZiAocmV0UGl0Y2gubGVuID4gMCkge1xuXHRcdFx0XHRcdHJldC5mb3VuZEtleSA9IHRydWU7XG5cdFx0XHRcdFx0dmFyIGFjYyA9IFwiXCI7XG5cdFx0XHRcdFx0dmFyIG1vZGUgPSBcIlwiO1xuXHRcdFx0XHRcdC8vIFRoZSBhY2NpZGVudGFsIGFuZCBtb2RlIG1pZ2h0IGJlIGF0dGFjaGVkIHRvIHRoZSBwaXRjaCwgc28gd2UgbWlnaHQgd2FudCB0byBqdXN0IHJlbW92ZSB0aGUgZmlyc3QgY2hhcmFjdGVyLlxuXHRcdFx0XHRcdGlmICh0b2tlbnNbMF0udG9rZW4ubGVuZ3RoID4gMSlcblx0XHRcdFx0XHRcdHRva2Vuc1swXS50b2tlbiA9IHRva2Vuc1swXS50b2tlbi5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0dmFyIGtleSA9IHJldFBpdGNoLnRva2VuO1xuXHRcdFx0XHRcdC8vIFdlIGdvdCBhIHBpdGNoIHRvIHN0YXJ0IHdpdGgsIHNvIHdlIG1pZ2h0IGFsc28gaGF2ZSBhbiBhY2NpZGVudGFsIGFuZCBhIG1vZGVcblx0XHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0XHRcdHZhciByZXRBY2MgPSB0b2tlbml6ZXIuZ2V0U2hhcnBGbGF0KHRva2Vuc1swXS50b2tlbik7XG5cdFx0XHRcdFx0XHRpZiAocmV0QWNjLmxlbiA+IDApIHtcblx0XHRcdFx0XHRcdFx0aWYgKHRva2Vuc1swXS50b2tlbi5sZW5ndGggPiAxKVxuXHRcdFx0XHRcdFx0XHRcdHRva2Vuc1swXS50b2tlbiA9IHRva2Vuc1swXS50b2tlbi5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRcdFx0a2V5ICs9IHJldEFjYy50b2tlbjtcblx0XHRcdFx0XHRcdFx0YWNjID0gcmV0QWNjLnRva2VuO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPiAwKSB7XG5cdFx0XHRcdFx0XHRcdHZhciByZXRNb2RlID0gdG9rZW5pemVyLmdldE1vZGUodG9rZW5zWzBdLnRva2VuKTtcblx0XHRcdFx0XHRcdFx0aWYgKHJldE1vZGUubGVuID4gMCkge1xuXHRcdFx0XHRcdFx0XHRcdHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdFx0XHRcdGtleSArPSByZXRNb2RlLnRva2VuO1xuXHRcdFx0XHRcdFx0XHRcdG1vZGUgPSByZXRNb2RlLnRva2VuO1xuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHQvLyBCZSBzdXJlIHRoYXQgdGhlIGtleSBzcGVjaWZpZWQgaXMgaW4gdGhlIGxpc3Q6IG5vdCBhbGwga2V5cyBhcmUgcGh5c2ljYWxseSBwb3NzaWJsZSwgbGlrZSBDYm1pbi5cblx0XHRcdFx0XHRcdGlmIChwYXJzZUtleVZvaWNlLnN0YW5kYXJkS2V5KGtleSwgcmV0UGl0Y2gudG9rZW4sIGFjYywgMCkgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0XHR3YXJuKFwiVW5zdXBwb3J0ZWQga2V5IHNpZ25hdHVyZTogXCIgKyBrZXksIHN0ciwgMCk7XG5cdFx0XHRcdFx0XHRcdHJldHVybiByZXQ7XG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIFdlIG5lZWQgdG8gZG8gYSBkZWVwIGNvcHkgYmVjYXVzZSB3ZSBhcmUgZ29pbmcgdG8gbW9kaWZ5IGl0XG5cdFx0XHRcdFx0dmFyIG9sZEtleSA9IHBhcnNlS2V5Vm9pY2UuZGVlcENvcHlLZXkobXVsdGlsaW5lVmFycy5rZXkpO1xuXHRcdFx0XHRcdC8vVE9ETy1QRVI6IEhBQ0shIFRvIGdldCB0aGUgbG9jYWwgdHJhbnNwb3NlIHRvIHdvcmssIHRoZSB0cmFuc3Bvc2l0aW9uIGlzIGRvbmUgZm9yIGVhY2ggbGluZS4gVGhpcyBjYXVzZWQgdGhlIGdsb2JhbCB0cmFuc3Bvc2l0aW9uIHZhcmlhYmxlIHRvIGJlIGZhY3RvcmVkIGluIHR3aWNlLCBzbywgaW5zdGVhZCBvZiByZXdyaXRpbmcgdGhhdCByaWdodCBub3csIEknbSBqdXN0IHN1YnRyYWN0aW5nIG9uZSBvZiB0aGVtIGhlcmUuXG5cdFx0XHRcdFx0dmFyIGtleUNvbXBlbnNhdGUgPSBtdWx0aWxpbmVWYXJzLmdsb2JhbFRyYW5zcG9zZSA/IC1tdWx0aWxpbmVWYXJzLmdsb2JhbFRyYW5zcG9zZSA6IDA7XG5cdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5rZXkgPSBwYXJzZUtleVZvaWNlLmRlZXBDb3B5S2V5KHBhcnNlS2V5Vm9pY2Uuc3RhbmRhcmRLZXkoa2V5LCByZXRQaXRjaC50b2tlbiwgYWNjLCBrZXlDb21wZW5zYXRlKSk7XG5cdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5rZXkubW9kZSA9IG1vZGU7XG5cdFx0XHRcdFx0aWYgKG9sZEtleSkge1xuXHRcdFx0XHRcdFx0Ly8gQWRkIG5hdHVyYWwgaW4gYWxsIHBsYWNlcyB0aGF0IHRoZSBvbGQga2V5IGhhZCBhbiBhY2NpZGVudGFsLlxuXHRcdFx0XHRcdFx0dmFyIGtrO1xuXHRcdFx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCBtdWx0aWxpbmVWYXJzLmtleS5hY2NpZGVudGFscy5sZW5ndGg7IGsrKykge1xuXHRcdFx0XHRcdFx0XHRmb3IgKGtrID0gMDsga2sgPCBvbGRLZXkuYWNjaWRlbnRhbHMubGVuZ3RoOyBraysrKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKG9sZEtleS5hY2NpZGVudGFsc1tra10ubm90ZSAmJiBtdWx0aWxpbmVWYXJzLmtleS5hY2NpZGVudGFsc1trXS5ub3RlLnRvTG93ZXJDYXNlKCkgPT09IG9sZEtleS5hY2NpZGVudGFsc1tra10ubm90ZS50b0xvd2VyQ2FzZSgpKVxuXHRcdFx0XHRcdFx0XHRcdFx0b2xkS2V5LmFjY2lkZW50YWxzW2trXS5ub3RlID0gbnVsbDtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0Zm9yIChrayA9IDA7IGtrIDwgb2xkS2V5LmFjY2lkZW50YWxzLmxlbmd0aDsga2srKykge1xuXHRcdFx0XHRcdFx0XHRpZiAob2xkS2V5LmFjY2lkZW50YWxzW2trXS5ub3RlKSB7XG5cdFx0XHRcdFx0XHRcdFx0aWYgKCFtdWx0aWxpbmVWYXJzLmtleS5pbXBsaWVkTmF0dXJhbHMpXG5cdFx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmtleS5pbXBsaWVkTmF0dXJhbHMgPSBbXTtcblx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmtleS5pbXBsaWVkTmF0dXJhbHMucHVzaCh7IGFjYzogJ25hdHVyYWwnLCBub3RlOiBvbGRLZXkuYWNjaWRlbnRhbHNba2tdLm5vdGUgfSk7XG5cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0YnJlYWs7XG5cdFx0fVxuXG5cdFx0Ly8gVGhlcmUgYXJlIHR3byBzcGVjaWFsIGNhc2VzIG9mIGRlcHJlY2F0ZWQgc3ludGF4LiBJZ25vcmUgdGhlbSBpZiB0aGV5IG9jY3VyXG5cdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHJldHVybiByZXQ7XG5cdFx0aWYgKHRva2Vuc1swXS50b2tlbiA9PT0gJ2V4cCcpIHRva2Vucy5zaGlmdCgpO1xuXHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSByZXR1cm4gcmV0O1xuXHRcdGlmICh0b2tlbnNbMF0udG9rZW4gPT09ICdvY3QnKSB0b2tlbnMuc2hpZnQoKTtcblxuXHRcdC8vIG5vdyBzZWUgaWYgdGhlcmUgYXJlIGV4dHJhIGFjY2lkZW50YWxzXG5cdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHJldHVybiByZXQ7XG5cdFx0dmFyIGFjY3MgPSB0b2tlbml6ZXIuZ2V0S2V5QWNjaWRlbnRhbHMyKHRva2Vucyk7XG5cdFx0aWYgKGFjY3Mud2Fybilcblx0XHRcdHdhcm4oYWNjcy53YXJuLCBzdHIsIDApO1xuXHRcdC8vIElmIHdlIGhhdmUgZXh0cmEgYWNjaWRlbnRhbHMsIGZpcnN0IHJlcGxhY2Ugb25lcyB0aGF0IGFyZSBvZiB0aGUgc2FtZSBwaXRjaCBiZWZvcmUgYWRkaW5nIHRoZW0gdG8gdGhlIGVuZC5cblx0XHRpZiAoYWNjcy5hY2NzKSB7XG5cdFx0XHRpZiAoIXJldC5mb3VuZEtleSkge1x0XHQvLyBpZiB0aGVyZSBhcmUgb25seSBleHRyYSBhY2NpZGVudGFscywgbWFrZSBzdXJlIHRoaXMgaXMgc2V0LlxuXHRcdFx0XHRyZXQuZm91bmRLZXkgPSB0cnVlO1xuXHRcdFx0XHRtdWx0aWxpbmVWYXJzLmtleSA9IHsgcm9vdDogXCJub25lXCIsIGFjYzogXCJcIiwgbW9kZTogXCJcIiwgYWNjaWRlbnRhbHM6IFtdIH07XG5cdFx0XHR9XG5cdFx0XHRub3JtYWxpemVBY2NpZGVudGFscyhhY2NzLmFjY3MpO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBhY2NzLmFjY3MubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIGZvdW5kID0gZmFsc2U7XG5cdFx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgbXVsdGlsaW5lVmFycy5rZXkuYWNjaWRlbnRhbHMubGVuZ3RoICYmICFmb3VuZDsgaisrKSB7XG5cdFx0XHRcdFx0aWYgKG11bHRpbGluZVZhcnMua2V5LmFjY2lkZW50YWxzW2pdLm5vdGUgPT09IGFjY3MuYWNjc1tpXS5ub3RlKSB7XG5cdFx0XHRcdFx0XHRmb3VuZCA9IHRydWU7XG5cdFx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5rZXkuYWNjaWRlbnRhbHNbal0uYWNjICE9PSBhY2NzLmFjY3NbaV0uYWNjKSB7XG5cdFx0XHRcdFx0XHRcdC8vIElmIHRoZSBhY2NpZGVudGFsIGlzIGRpZmZlcmVudCwgdGhlbiByZXBsYWNlIGl0LiBJZiBpdCBpcyB0aGUgc2FtZSwgdGhlbiB0aGUgZGVjbGFyYXRpb24gd2FzIHJlZHVuZGFudCwgc28ganVzdCBpZ25vcmUgaXQuXG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMua2V5LmFjY2lkZW50YWxzW2pdLmFjYyA9IGFjY3MuYWNjc1tpXS5hY2M7XG5cdFx0XHRcdFx0XHRcdGlmICghbXVsdGlsaW5lVmFycy5rZXkuZXhwbGljaXRBY2NpZGVudGFscylcblx0XHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmtleS5leHBsaWNpdEFjY2lkZW50YWxzID0gW107XG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMua2V5LmV4cGxpY2l0QWNjaWRlbnRhbHMucHVzaChhY2NzLmFjY3NbaV0pO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoIWZvdW5kKSB7XG5cdFx0XHRcdFx0aWYgKCFtdWx0aWxpbmVWYXJzLmtleS5leHBsaWNpdEFjY2lkZW50YWxzKVxuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5rZXkuZXhwbGljaXRBY2NpZGVudGFscyA9IFtdO1xuXHRcdFx0XHRcdG11bHRpbGluZVZhcnMua2V5LmV4cGxpY2l0QWNjaWRlbnRhbHMucHVzaChhY2NzLmFjY3NbaV0pO1xuXHRcdFx0XHRcdG11bHRpbGluZVZhcnMua2V5LmFjY2lkZW50YWxzLnB1c2goYWNjcy5hY2NzW2ldKTtcblx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5rZXkuaW1wbGllZE5hdHVyYWxzKSB7XG5cdFx0XHRcdFx0XHRmb3IgKHZhciBra2sgPSAwOyBra2sgPCBtdWx0aWxpbmVWYXJzLmtleS5pbXBsaWVkTmF0dXJhbHMubGVuZ3RoOyBra2srKykge1xuXHRcdFx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5rZXkuaW1wbGllZE5hdHVyYWxzW2tra10ubm90ZSA9PT0gYWNjcy5hY2NzW2ldLm5vdGUpXG5cdFx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5rZXkuaW1wbGllZE5hdHVyYWxzLnNwbGljZShra2ssIDEpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIE5vdyBzZWUgaWYgYW55IG9wdGlvbmFsIHBhcmFtZXRlcnMgYXJlIHByZXNlbnQuIFRoZXkgaGF2ZSB0aGUgZm9ybSBcImtleT12YWx1ZVwiLCBleGNlcHQgdGhhdCBcImNsZWY9XCIgaXMgb3B0aW9uYWxcblx0XHR2YXIgdG9rZW47XG5cdFx0d2hpbGUgKHRva2Vucy5sZW5ndGggPiAwKSB7XG5cdFx0XHRzd2l0Y2ggKHRva2Vuc1swXS50b2tlbikge1xuXHRcdFx0XHRjYXNlIFwibVwiOlxuXHRcdFx0XHRjYXNlIFwibWlkZGxlXCI6XG5cdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkID0gYWZ0ZXIgbWlkZGxlXCIsIHN0ciwgMCk7IHJldHVybiByZXQ7IH1cblx0XHRcdFx0XHR0b2tlbiA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdGlmICh0b2tlbi50b2tlbiAhPT0gXCI9XCIpIHsgd2FybihcIkV4cGVjdGVkID0gYWZ0ZXIgbWlkZGxlXCIsIHN0ciwgdG9rZW4uc3RhcnQpOyBicmVhazsgfVxuXHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSB7IHdhcm4oXCJFeHBlY3RlZCBwYXJhbWV0ZXIgYWZ0ZXIgbWlkZGxlPVwiLCBzdHIsIDApOyByZXR1cm4gcmV0OyB9XG5cdFx0XHRcdFx0dmFyIHBpdGNoID0gdG9rZW5pemVyLmdldFBpdGNoRnJvbVRva2Vucyh0b2tlbnMpO1xuXHRcdFx0XHRcdGlmIChwaXRjaC53YXJuKVxuXHRcdFx0XHRcdFx0d2FybihwaXRjaC53YXJuLCBzdHIsIDApO1xuXHRcdFx0XHRcdGlmIChwaXRjaC5wb3NpdGlvbilcblx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMuY2xlZi52ZXJ0aWNhbFBvcyA9IHBpdGNoLnBvc2l0aW9uIC0gNjtcdC8vIHdlIGdldCB0aGUgcG9zaXRpb24gZnJvbSB0aGUgbWlkZGxlIGxpbmUsIGJ1dCB3YW50IHRvIG9mZnNldCBpdCB0byB0aGUgZmlyc3QgbGVkZ2VyIGxpbmUuXG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJ0cmFuc3Bvc2VcIjpcblx0XHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgeyB3YXJuKFwiRXhwZWN0ZWQgPSBhZnRlciB0cmFuc3Bvc2VcIiwgc3RyLCAwKTsgcmV0dXJuIHJldDsgfVxuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnRva2VuICE9PSBcIj1cIikgeyB3YXJuKFwiRXhwZWN0ZWQgPSBhZnRlciB0cmFuc3Bvc2VcIiwgc3RyLCB0b2tlbi5zdGFydCk7IGJyZWFrOyB9XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkIHBhcmFtZXRlciBhZnRlciB0cmFuc3Bvc2U9XCIsIHN0ciwgMCk7IHJldHVybiByZXQ7IH1cblx0XHRcdFx0XHRpZiAodG9rZW5zWzBdLnR5cGUgIT09ICdudW1iZXInKSB7IHdhcm4oXCJFeHBlY3RlZCBudW1iZXIgYWZ0ZXIgdHJhbnNwb3NlXCIsIHN0ciwgdG9rZW5zWzBdLnN0YXJ0KTsgYnJlYWs7IH1cblx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmNsZWYudHJhbnNwb3NlID0gdG9rZW5zWzBdLmludHQ7XG5cdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJzdGFmZmxpbmVzXCI6XG5cdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkID0gYWZ0ZXIgc3RhZmZsaW5lc1wiLCBzdHIsIDApOyByZXR1cm4gcmV0OyB9XG5cdFx0XHRcdFx0dG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRpZiAodG9rZW4udG9rZW4gIT09IFwiPVwiKSB7IHdhcm4oXCJFeHBlY3RlZCA9IGFmdGVyIHN0YWZmbGluZXNcIiwgc3RyLCB0b2tlbi5zdGFydCk7IGJyZWFrOyB9XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkIHBhcmFtZXRlciBhZnRlciBzdGFmZmxpbmVzPVwiLCBzdHIsIDApOyByZXR1cm4gcmV0OyB9XG5cdFx0XHRcdFx0aWYgKHRva2Vuc1swXS50eXBlICE9PSAnbnVtYmVyJykgeyB3YXJuKFwiRXhwZWN0ZWQgbnVtYmVyIGFmdGVyIHN0YWZmbGluZXNcIiwgc3RyLCB0b2tlbnNbMF0uc3RhcnQpOyBicmVhazsgfVxuXHRcdFx0XHRcdG11bHRpbGluZVZhcnMuY2xlZi5zdGFmZmxpbmVzID0gdG9rZW5zWzBdLmludHQ7XG5cdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJzdGFmZnNjYWxlXCI6XG5cdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkID0gYWZ0ZXIgc3RhZmZzY2FsZVwiLCBzdHIsIDApOyByZXR1cm4gcmV0OyB9XG5cdFx0XHRcdFx0dG9rZW4gPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRpZiAodG9rZW4udG9rZW4gIT09IFwiPVwiKSB7IHdhcm4oXCJFeHBlY3RlZCA9IGFmdGVyIHN0YWZmc2NhbGVcIiwgc3RyLCB0b2tlbi5zdGFydCk7IGJyZWFrOyB9XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkIHBhcmFtZXRlciBhZnRlciBzdGFmZnNjYWxlPVwiLCBzdHIsIDApOyByZXR1cm4gcmV0OyB9XG5cdFx0XHRcdFx0aWYgKHRva2Vuc1swXS50eXBlICE9PSAnbnVtYmVyJykgeyB3YXJuKFwiRXhwZWN0ZWQgbnVtYmVyIGFmdGVyIHN0YWZmc2NhbGVcIiwgc3RyLCB0b2tlbnNbMF0uc3RhcnQpOyBicmVhazsgfVxuXHRcdFx0XHRcdG11bHRpbGluZVZhcnMuY2xlZi5zdGFmZnNjYWxlID0gdG9rZW5zWzBdLmZsb2F0dDtcblx0XHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcInN0eWxlXCI6XG5cdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHsgd2FybihcIkV4cGVjdGVkID0gYWZ0ZXIgc3R5bGVcIiwgc3RyLCAwKTsgcmV0dXJuIHJldDsgfVxuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnRva2VuICE9PSBcIj1cIikgeyB3YXJuKFwiRXhwZWN0ZWQgPSBhZnRlciBzdHlsZVwiLCBzdHIsIHRva2VuLnN0YXJ0KTsgYnJlYWs7IH1cblx0XHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgeyB3YXJuKFwiRXhwZWN0ZWQgcGFyYW1ldGVyIGFmdGVyIHN0eWxlPVwiLCBzdHIsIDApOyByZXR1cm4gcmV0OyB9XG5cdFx0XHRcdFx0c3dpdGNoICh0b2tlbnNbMF0udG9rZW4pIHtcblx0XHRcdFx0XHRcdGNhc2UgXCJub3JtYWxcIjpcblx0XHRcdFx0XHRcdGNhc2UgXCJoYXJtb25pY1wiOlxuXHRcdFx0XHRcdFx0Y2FzZSBcInJoeXRobVwiOlxuXHRcdFx0XHRcdFx0Y2FzZSBcInhcIjpcblx0XHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5zdHlsZSA9IHRva2Vuc1swXS50b2tlbjtcblx0XHRcdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0d2FybihcImVycm9yIHBhcnNpbmcgc3R5bGUgZWxlbWVudDogXCIgKyB0b2tlbnNbMF0udG9rZW4sIHN0ciwgdG9rZW5zWzBdLnN0YXJ0KTtcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiY2xlZlwiOlxuXHRcdFx0XHRcdHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSB7IHdhcm4oXCJFeHBlY3RlZCA9IGFmdGVyIGNsZWZcIiwgc3RyLCAwKTsgcmV0dXJuIHJldDsgfVxuXHRcdFx0XHRcdHRva2VuID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0aWYgKHRva2VuLnRva2VuICE9PSBcIj1cIikgeyB3YXJuKFwiRXhwZWN0ZWQgPSBhZnRlciBjbGVmXCIsIHN0ciwgdG9rZW4uc3RhcnQpOyBicmVhazsgfVxuXHRcdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSB7IHdhcm4oXCJFeHBlY3RlZCBwYXJhbWV0ZXIgYWZ0ZXIgY2xlZj1cIiwgc3RyLCAwKTsgcmV0dXJuIHJldDsgfVxuXHRcdFx0XHRcdC8vYnJlYWs7IHllcywgd2Ugd2FudCB0byBmYWxsIHRocm91Z2guIFRoYXQgYWxsb3dzIFwiY2xlZj1cIiB0byBiZSBvcHRpb25hbC5cblx0XHRcdFx0Y2FzZSBcInRyZWJsZVwiOlxuXHRcdFx0XHRjYXNlIFwiYmFzc1wiOlxuXHRcdFx0XHRjYXNlIFwiYWx0b1wiOlxuXHRcdFx0XHRjYXNlIFwidGVub3JcIjpcblx0XHRcdFx0Y2FzZSBcInBlcmNcIjpcblx0XHRcdFx0XHQvLyBjbGVmIGlzIFtjbGVmPV0gW+KfqGNsZWYgdHlwZeKfqV0gW+KfqGxpbmUgbnVtYmVy4p+pXSBbKzh8LThdXG5cdFx0XHRcdFx0dmFyIGNsZWYgPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHRzd2l0Y2ggKGNsZWYudG9rZW4pIHtcblx0XHRcdFx0XHRcdGNhc2UgJ3RyZWJsZSc6XG5cdFx0XHRcdFx0XHRjYXNlICd0ZW5vcic6XG5cdFx0XHRcdFx0XHRjYXNlICdhbHRvJzpcblx0XHRcdFx0XHRcdGNhc2UgJ2Jhc3MnOlxuXHRcdFx0XHRcdFx0Y2FzZSAncGVyYyc6XG5cdFx0XHRcdFx0XHRjYXNlICdub25lJzpcblx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdDJzogY2xlZi50b2tlbiA9ICdhbHRvJzsgYnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdGJzogY2xlZi50b2tlbiA9ICdiYXNzJzsgYnJlYWs7XG5cdFx0XHRcdFx0XHRjYXNlICdHJzogY2xlZi50b2tlbiA9ICd0cmVibGUnOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2MnOiBjbGVmLnRva2VuID0gJ2FsdG8nOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2YnOiBjbGVmLnRva2VuID0gJ2Jhc3MnOyBicmVhaztcblx0XHRcdFx0XHRcdGNhc2UgJ2cnOiBjbGVmLnRva2VuID0gJ3RyZWJsZSc7IGJyZWFrO1xuXHRcdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdFx0d2FybihcIkV4cGVjdGVkIGNsZWYgbmFtZS4gRm91bmQgXCIgKyBjbGVmLnRva2VuLCBzdHIsIGNsZWYuc3RhcnQpO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPiAwICYmIHRva2Vuc1swXS50eXBlID09PSAnbnVtYmVyJykge1xuXHRcdFx0XHRcdFx0Y2xlZi50b2tlbiArPSB0b2tlbnNbMF0udG9rZW47XG5cdFx0XHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPiAxICYmICh0b2tlbnNbMF0udG9rZW4gPT09ICctJyB8fCB0b2tlbnNbMF0udG9rZW4gPT09ICcrJykgJiYgdG9rZW5zWzFdLnRva2VuID09PSAnOCcpIHtcblx0XHRcdFx0XHRcdGNsZWYudG9rZW4gKz0gdG9rZW5zWzBdLnRva2VuICsgdG9rZW5zWzFdLnRva2VuO1xuXHRcdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bXVsdGlsaW5lVmFycy5jbGVmID0ge3R5cGU6IGNsZWYudG9rZW4sIHZlcnRpY2FsUG9zOiBjYWxjTWlkZGxlKGNsZWYudG9rZW4sIDApfTtcblx0XHRcdFx0XHRpZiAobXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UgJiYgbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UudHJhbnNwb3NlICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLmNsZWYudHJhbnNwb3NlID0gbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UudHJhbnNwb3NlO1xuXHRcdFx0XHRcdHJldC5mb3VuZENsZWYgPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdHdhcm4oXCJVbmtub3duIHBhcmFtZXRlcjogXCIgKyB0b2tlbnNbMF0udG9rZW4sIHN0ciwgdG9rZW5zWzBdLnN0YXJ0KTtcblx0XHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHJldDtcblx0fTtcblxuXHR2YXIgc2V0Q3VycmVudFZvaWNlID0gZnVuY3Rpb24oaWQpIHtcblx0XHRtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZSA9IG11bHRpbGluZVZhcnMudm9pY2VzW2lkXTtcblx0XHR0dW5lLnNldEN1cnJlbnRWb2ljZShtdWx0aWxpbmVWYXJzLmN1cnJlbnRWb2ljZS5zdGFmZk51bSwgbXVsdGlsaW5lVmFycy5jdXJyZW50Vm9pY2UuaW5kZXgpO1xuXHR9O1xuXG5cdHBhcnNlS2V5Vm9pY2UucGFyc2VWb2ljZSA9IGZ1bmN0aW9uKGxpbmUsIGksIGUpIHtcblx0XHQvL0ZpcnN0IHRydW5jYXRlIHRoZSBzdHJpbmcgdG8gdGhlIGZpcnN0IG5vbi1zcGFjZSBjaGFyYWN0ZXIgYWZ0ZXIgVjogdGhyb3VnaCBlaXRoZXIgdGhlXG5cdFx0Ly9lbmQgb2YgdGhlIGxpbmUgb3IgYSAlIGNoYXJhY3Rlci4gVGhlbiByZW1vdmUgdHJhaWxpbmcgc3BhY2VzLCB0b28uXG5cdFx0dmFyIHJldCA9IHRva2VuaXplci5nZXRNZWF0KGxpbmUsIGksIGUpO1xuXHRcdHZhciBzdGFydCA9IHJldC5zdGFydDtcblx0XHR2YXIgZW5kID0gcmV0LmVuZDtcblx0XHQvL1RoZSBmaXJzdCB0aGluZyBvbiB0aGUgbGluZSBpcyB0aGUgSUQuIEl0IGNhbiBiZSBhbnkgbm9uLXNwYWNlIHN0cmluZyBhbmQgdGVybWluYXRlcyBhdCB0aGVcblx0XHQvL2ZpcnN0IHNwYWNlLlxuXHRcdHZhciBpZCA9IHRva2VuaXplci5nZXRUb2tlbihsaW5lLCBzdGFydCwgZW5kKTtcblx0XHRpZiAoaWQubGVuZ3RoID09PSAwKSB7XG5cdFx0XHR3YXJuKFwiRXhwZWN0ZWQgYSB2b2ljZSBpZFwiLCBsaW5lLCBzdGFydCk7XG5cdFx0XHRyZXR1cm47XG5cdFx0fVxuXHRcdHZhciBpc05ldyA9IGZhbHNlO1xuXHRcdGlmIChtdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF0gPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0bXVsdGlsaW5lVmFycy52b2ljZXNbaWRdID0ge307XG5cdFx0XHRpc05ldyA9IHRydWU7XG5cdFx0XHRpZiAobXVsdGlsaW5lVmFycy5zY29yZV9pc19wcmVzZW50KVxuXHRcdFx0XHR3YXJuKFwiQ2FuJ3QgaGF2ZSBhbiB1bmtub3duIFY6IGlkIHdoZW4gdGhlICVzY29yZSBkaXJlY3RpdmUgaXMgcHJlc2VudFwiLCBsaW5lLCBzdGFydCk7XG5cdFx0fVxuXHRcdHN0YXJ0ICs9IGlkLmxlbmd0aDtcblx0XHRzdGFydCArPSB0b2tlbml6ZXIuZWF0V2hpdGVTcGFjZShsaW5lLCBzdGFydCk7XG5cblx0XHR2YXIgc3RhZmZJbmZvID0ge3N0YXJ0U3RhZmY6IGlzTmV3fTtcblx0XHR2YXIgYWRkTmV4dFRva2VuVG9TdGFmZkluZm8gPSBmdW5jdGlvbihuYW1lKSB7XG5cdFx0XHR2YXIgYXR0ciA9IHRva2VuaXplci5nZXRWb2ljZVRva2VuKGxpbmUsIHN0YXJ0LCBlbmQpO1xuXHRcdFx0aWYgKGF0dHIud2FybiAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgdmFsdWUgZm9yIFwiICsgbmFtZSArIFwiIGluIHZvaWNlOiBcIiArIGF0dHIud2FybiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0ZWxzZSBpZiAoYXR0ci50b2tlbi5sZW5ndGggPT09IDAgJiYgbGluZS5jaGFyQXQoc3RhcnQpICE9PSAnXCInKVxuXHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgdmFsdWUgZm9yIFwiICsgbmFtZSArIFwiIGluIHZvaWNlXCIsIGxpbmUsIHN0YXJ0KTtcblx0XHRcdGVsc2Vcblx0XHRcdFx0c3RhZmZJbmZvW25hbWVdID0gYXR0ci50b2tlbjtcblx0XHRcdHN0YXJ0ICs9IGF0dHIubGVuO1xuXHRcdH07XG5cdFx0dmFyIGFkZE5leHRUb2tlblRvVm9pY2VJbmZvID0gZnVuY3Rpb24oaWQsIG5hbWUsIHR5cGUpIHtcblx0XHRcdHZhciBhdHRyID0gdG9rZW5pemVyLmdldFZvaWNlVG9rZW4obGluZSwgc3RhcnQsIGVuZCk7XG5cdFx0XHRpZiAoYXR0ci53YXJuICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCB2YWx1ZSBmb3IgXCIgKyBuYW1lICsgXCIgaW4gdm9pY2U6IFwiICsgYXR0ci53YXJuLCBsaW5lLCBzdGFydCk7XG5cdFx0XHRlbHNlIGlmIChhdHRyLnRva2VuLmxlbmd0aCA9PT0gMCAmJiBsaW5lLmNoYXJBdChzdGFydCkgIT09ICdcIicpXG5cdFx0XHRcdHdhcm4oXCJFeHBlY3RlZCB2YWx1ZSBmb3IgXCIgKyBuYW1lICsgXCIgaW4gdm9pY2VcIiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0ZWxzZSB7XG5cdFx0XHRcdGlmICh0eXBlID09PSAnbnVtYmVyJylcblx0XHRcdFx0XHRhdHRyLnRva2VuID0gcGFyc2VGbG9hdChhdHRyLnRva2VuKTtcblx0XHRcdFx0bXVsdGlsaW5lVmFycy52b2ljZXNbaWRdW25hbWVdID0gYXR0ci50b2tlbjtcblx0XHRcdH1cblx0XHRcdHN0YXJ0ICs9IGF0dHIubGVuO1xuXHRcdH07XG5cdFx0dmFyIGFkZE5leHROb3RlVG9rZW5Ub1ZvaWNlSW5mbyA9IGZ1bmN0aW9uKGlkLCBuYW1lKSB7XG5cdFx0XHR2YXIgbm90ZVRvVHJhbnNwb3NpdGlvbiA9IHtcblx0XHRcdFx0XCJfQlwiOiAyLFxuXHRcdFx0XHRcIl9FXCI6IDksXG5cdFx0XHRcdFwiX2JcIjogLTEwLFxuXHRcdFx0XHRcIl9lXCI6IC0zXG5cdFx0XHR9O1xuXHRcdFx0dmFyIGF0dHIgPSB0b2tlbml6ZXIuZ2V0Vm9pY2VUb2tlbihsaW5lLCBzdGFydCwgZW5kKTtcblx0XHRcdGlmIChhdHRyLndhcm4gIT09IHVuZGVmaW5lZClcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIG9uZSBvZiAoX0IsIF9FLCBfYiwgX2UpIGZvciBcIiArIG5hbWUgKyBcIiBpbiB2b2ljZTogXCIgKyBhdHRyLndhcm4sIGxpbmUsIHN0YXJ0KTtcblx0XHRcdGVsc2UgaWYgKGF0dHIudG9rZW4ubGVuZ3RoID09PSAwICYmIGxpbmUuY2hhckF0KHN0YXJ0KSAhPT0gJ1wiJylcblx0XHRcdFx0d2FybihcIkV4cGVjdGVkIG9uZSBvZiAoX0IsIF9FLCBfYiwgX2UpIGZvciBcIiArIG5hbWUgKyBcIiBpbiB2b2ljZVwiLCBsaW5lLCBzdGFydCk7XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0dmFyIHQgPSBub3RlVG9UcmFuc3Bvc2l0aW9uW2F0dHIudG9rZW5dO1xuXHRcdFx0XHRpZiAoIXQpXG5cdFx0XHRcdFx0d2FybihcIkV4cGVjdGVkIG9uZSBvZiAoX0IsIF9FLCBfYiwgX2UpIGZvciBcIiArIG5hbWUgKyBcIiBpbiB2b2ljZVwiLCBsaW5lLCBzdGFydCk7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF1bbmFtZV0gPSB0O1xuXHRcdFx0fVxuXHRcdFx0c3RhcnQgKz0gYXR0ci5sZW47XG5cdFx0fTtcblxuXHRcdC8vVGhlbiB0aGUgZm9sbG93aW5nIGl0ZW1zIGNhbiBvY2N1ciBpbiBhbnkgb3JkZXI6XG5cdFx0d2hpbGUgKHN0YXJ0IDwgZW5kKSB7XG5cdFx0XHR2YXIgdG9rZW4gPSB0b2tlbml6ZXIuZ2V0Vm9pY2VUb2tlbihsaW5lLCBzdGFydCwgZW5kKTtcblx0XHRcdHN0YXJ0ICs9IHRva2VuLmxlbjtcblxuXHRcdFx0aWYgKHRva2VuLndhcm4pIHtcblx0XHRcdFx0d2FybihcIkVycm9yIHBhcnNpbmcgdm9pY2U6IFwiICsgdG9rZW4ud2FybiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dmFyIGF0dHIgPSBudWxsO1xuXHRcdFx0XHRzd2l0Y2ggKHRva2VuLnRva2VuKSB7XG5cdFx0XHRcdFx0Y2FzZSAnY2xlZic6XG5cdFx0XHRcdFx0Y2FzZSAnY2wnOlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9TdGFmZkluZm8oJ2NsZWYnKTtcblx0XHRcdFx0XHRcdC8vIFRPRE8tUEVSOiBjaGVjayBmb3IgYSBsZWdhbCBjbGVmOyBkbyBvY3Rhdml6aW5nXG5cdFx0XHRcdFx0XHR2YXIgb2N0ID0gMDtcblx0Ly9cdFx0XHRcdFx0XHRcdGZvciAodmFyIGlpID0gMDsgaWkgPCBzdGFmZkluZm8uY2xlZi5sZW5ndGg7IGlpKyspIHtcblx0Ly9cdFx0XHRcdFx0XHRcdFx0aWYgKHN0YWZmSW5mby5jbGVmW2lpXSA9PT0gJywnKSBvY3QgLT0gNztcblx0Ly9cdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAoc3RhZmZJbmZvLmNsZWZbaWldID09PSBcIidcIikgb2N0ICs9IDc7XG5cdC8vXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRpZiAoc3RhZmZJbmZvLmNsZWYgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0ICBzdGFmZkluZm8uY2xlZiA9IHN0YWZmSW5mby5jbGVmLnJlcGxhY2UoL1snLF0vZywgXCJcIik7IC8vJy8vY29tbWVudCBmb3IgZW1hY3MgZm9ybWF0dGluZyBvZiByZWdleHBcblx0XHRcdFx0XHRcdFx0aWYgKHN0YWZmSW5mby5jbGVmLmluZGV4T2YoJysxNicpICE9PSAtMSkge1xuXHRcdFx0XHRcdFx0XHRcdG9jdCArPSAxNDtcblx0XHRcdFx0XHRcdFx0XHRzdGFmZkluZm8uY2xlZiA9IHN0YWZmSW5mby5jbGVmLnJlcGxhY2UoJysxNicsICcnKTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHRzdGFmZkluZm8udmVydGljYWxQb3MgPSBjYWxjTWlkZGxlKHN0YWZmSW5mby5jbGVmLCBvY3QpO1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAndHJlYmxlJzpcblx0XHRcdFx0XHRjYXNlICdiYXNzJzpcblx0XHRcdFx0XHRjYXNlICd0ZW5vcic6XG5cdFx0XHRcdFx0Y2FzZSAnYWx0byc6XG5cdFx0XHRcdFx0Y2FzZSAncGVyYyc6XG5cdFx0XHRcdFx0Y2FzZSAnbm9uZSc6XG5cdFx0XHRcdFx0Y2FzZSAndHJlYmxlXFwnJzpcblx0XHRcdFx0XHRjYXNlICdiYXNzXFwnJzpcblx0XHRcdFx0XHRjYXNlICd0ZW5vclxcJyc6XG5cdFx0XHRcdFx0Y2FzZSAnYWx0b1xcJyc6XG5cdFx0XHRcdFx0Y2FzZSAnbm9uZVxcJyc6XG5cdFx0XHRcdFx0Y2FzZSAndHJlYmxlXFwnXFwnJzpcblx0XHRcdFx0XHRjYXNlICdiYXNzXFwnXFwnJzpcblx0XHRcdFx0XHRjYXNlICd0ZW5vclxcJ1xcJyc6XG5cdFx0XHRcdFx0Y2FzZSAnYWx0b1xcJ1xcJyc6XG5cdFx0XHRcdFx0Y2FzZSAnbm9uZVxcJ1xcJyc6XG5cdFx0XHRcdFx0Y2FzZSAndHJlYmxlLCc6XG5cdFx0XHRcdFx0Y2FzZSAnYmFzcywnOlxuXHRcdFx0XHRcdGNhc2UgJ3Rlbm9yLCc6XG5cdFx0XHRcdFx0Y2FzZSAnYWx0bywnOlxuXHRcdFx0XHRcdGNhc2UgJ25vbmUsJzpcblx0XHRcdFx0XHRjYXNlICd0cmVibGUsLCc6XG5cdFx0XHRcdFx0Y2FzZSAnYmFzcywsJzpcblx0XHRcdFx0XHRjYXNlICd0ZW5vciwsJzpcblx0XHRcdFx0XHRjYXNlICdhbHRvLCwnOlxuXHRcdFx0XHRcdGNhc2UgJ25vbmUsLCc6XG5cdFx0XHRcdFx0XHQvLyBUT0RPLVBFUjogaGFuZGxlIHRoZSBvY3RhdmUgaW5kaWNhdG9ycyBvbiB0aGUgY2xlZiBieSBjaGFuZ2luZyB0aGUgbWlkZGxlIHByb3BlcnR5XG5cdFx0XHRcdFx0XHR2YXIgb2N0MiA9IDA7XG5cdC8vXHRcdFx0XHRcdFx0XHRmb3IgKHZhciBpaWkgPSAwOyBpaWkgPCB0b2tlbi50b2tlbi5sZW5ndGg7IGlpaSsrKSB7XG5cdC8vXHRcdFx0XHRcdFx0XHRcdGlmICh0b2tlbi50b2tlbltpaWldID09PSAnLCcpIG9jdDIgLT0gNztcblx0Ly9cdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAodG9rZW4udG9rZW5baWlpXSA9PT0gXCInXCIpIG9jdDIgKz0gNztcblx0Ly9cdFx0XHRcdFx0XHRcdH1cblx0XHRcdFx0XHRcdFx0XHRcdFx0XHQgIHN0YWZmSW5mby5jbGVmID0gdG9rZW4udG9rZW4ucmVwbGFjZSgvWycsXS9nLCBcIlwiKTsgLy8nLy9jb21tZW50IGZvciBlbWFjcyBmb3JtYXR0aW5nIG9mIHJlZ2V4cFxuXHRcdFx0XHRcdFx0c3RhZmZJbmZvLnZlcnRpY2FsUG9zID0gY2FsY01pZGRsZShzdGFmZkluZm8uY2xlZiwgb2N0Mik7XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF0uY2xlZiA9IHRva2VuLnRva2VuO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnc3RhdmVzJzpcblx0XHRcdFx0XHRjYXNlICdzdGF2ZSc6XG5cdFx0XHRcdFx0Y2FzZSAnc3R2Jzpcblx0XHRcdFx0XHRcdGFkZE5leHRUb2tlblRvU3RhZmZJbmZvKCdzdGF2ZXMnKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ2JyYWNlJzpcblx0XHRcdFx0XHRjYXNlICdicmMnOlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9TdGFmZkluZm8oJ2JyYWNlJyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICdicmFja2V0Jzpcblx0XHRcdFx0XHRjYXNlICdicmsnOlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9TdGFmZkluZm8oJ2JyYWNrZXQnKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ25hbWUnOlxuXHRcdFx0XHRcdGNhc2UgJ25tJzpcblx0XHRcdFx0XHRcdGFkZE5leHRUb2tlblRvU3RhZmZJbmZvKCduYW1lJyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICdzdWJuYW1lJzpcblx0XHRcdFx0XHRjYXNlICdzbmFtZSc6XG5cdFx0XHRcdFx0Y2FzZSAnc25tJzpcblx0XHRcdFx0XHRcdGFkZE5leHRUb2tlblRvU3RhZmZJbmZvKCdzdWJuYW1lJyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICdtZXJnZSc6XG5cdFx0XHRcdFx0XHRzdGFmZkluZm8uc3RhcnRTdGFmZiA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnc3RlbSc6XG5cdFx0XHRcdFx0Y2FzZSAnc3RlbXMnOlxuXHRcdFx0XHRcdFx0YXR0ciA9IHRva2VuaXplci5nZXRWb2ljZVRva2VuKGxpbmUsIHN0YXJ0LCBlbmQpO1xuXHRcdFx0XHRcdFx0aWYgKGF0dHIud2FybiAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgdmFsdWUgZm9yIHN0ZW1zIGluIHZvaWNlOiBcIiArIGF0dHIud2FybiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0XHRcdFx0ZWxzZSBpZiAoYXR0ci50b2tlbiA9PT0gJ3VwJyB8fCBhdHRyLnRva2VuID09PSAnZG93bicpXG5cdFx0XHRcdFx0XHRcdG11bHRpbGluZVZhcnMudm9pY2VzW2lkXS5zdGVtID0gYXR0ci50b2tlbjtcblx0XHRcdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRcdFx0d2FybihcIkV4cGVjdGVkIHVwIG9yIGRvd24gZm9yIHZvaWNlIHN0ZW1cIiwgbGluZSwgc3RhcnQpO1xuXHRcdFx0XHRcdFx0c3RhcnQgKz0gYXR0ci5sZW47XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICd1cCc6XG5cdFx0XHRcdFx0Y2FzZSAnZG93bic6XG5cdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF0uc3RlbSA9IHRva2VuLnRva2VuO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnbWlkZGxlJzpcblx0XHRcdFx0XHRjYXNlICdtJzpcblx0XHRcdFx0XHRcdGFkZE5leHRUb2tlblRvU3RhZmZJbmZvKCd2ZXJ0aWNhbFBvcycpO1xuXHRcdFx0XHRcdFx0c3RhZmZJbmZvLnZlcnRpY2FsUG9zID0gcGFyc2VNaWRkbGUoc3RhZmZJbmZvLnZlcnRpY2FsUG9zKS5taWQ7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICdnY2hvcmRzJzpcblx0XHRcdFx0XHRjYXNlICdnY2gnOlxuXHRcdFx0XHRcdFx0bXVsdGlsaW5lVmFycy52b2ljZXNbaWRdLnN1cHByZXNzQ2hvcmRzID0gdHJ1ZTtcblx0XHRcdFx0XHRcdC8vIGdjaG9yZHMgY2FuIHN0YW5kIG9uIGl0cyBvd24sIG9yIGl0IGNvdWxkIGJlIGdjaG9yZHM9MC5cblx0XHRcdFx0XHRcdGF0dHIgPSB0b2tlbml6ZXIuZ2V0Vm9pY2VUb2tlbihsaW5lLCBzdGFydCwgZW5kKTtcblx0XHRcdFx0XHRcdGlmIChhdHRyLnRva2VuID09PSBcIjBcIilcblx0XHRcdFx0XHRcdFx0c3RhcnQgPSBzdGFydCArIGF0dHIubGVuO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnc3BhY2UnOlxuXHRcdFx0XHRcdGNhc2UgJ3NwYyc6XG5cdFx0XHRcdFx0XHRhZGROZXh0VG9rZW5Ub1N0YWZmSW5mbygnc3BhY2luZycpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnc2NhbGUnOlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9Wb2ljZUluZm8oaWQsICdzY2FsZScsICdudW1iZXInKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ3Njb3JlJzpcblx0XHRcdFx0XHRcdGFkZE5leHROb3RlVG9rZW5Ub1ZvaWNlSW5mbyhpZCwgJ3Njb3JlVHJhbnNwb3NlJyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICd0cmFuc3Bvc2UnOlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9Wb2ljZUluZm8oaWQsICd0cmFuc3Bvc2UnLCAnbnVtYmVyJyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlICdzdGFmZmxpbmVzJzpcblx0XHRcdFx0XHRcdGFkZE5leHRUb2tlblRvVm9pY2VJbmZvKGlkLCAnc3RhZmZsaW5lcycsICdudW1iZXInKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ3N0YWZmc2NhbGUnOlxuXHRcdFx0XHRcdFx0Ly8gVE9ETy1QRVI6IFRoaXMgaXMgcGFzc2VkIHRvIHRoZSBlbmdyYXZlciwgYnV0IHRoZSBlbmdyYXZlciBpZ25vcmVzIGl0LlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9Wb2ljZUluZm8oaWQsICdzdGFmZnNjYWxlJywgJ251bWJlcicpO1xuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnb2N0YXZlJzpcblx0XHRcdFx0XHRcdC8vIFRPRE8tUEVSOiBUaGlzIGlzIGFjY2VwdGVkLCBidXQgbm90IGltcGxlbWVudGVkLCB5ZXQuXG5cdFx0XHRcdFx0XHRhZGROZXh0VG9rZW5Ub1ZvaWNlSW5mbyhpZCwgJ29jdGF2ZScsICdudW1iZXInKTtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdGNhc2UgJ3ZvbHVtZSc6XG5cdFx0XHRcdFx0XHQvLyBUT0RPLVBFUjogVGhpcyBpcyBhY2NlcHRlZCwgYnV0IG5vdCBpbXBsZW1lbnRlZCwgeWV0LlxuXHRcdFx0XHRcdFx0YWRkTmV4dFRva2VuVG9Wb2ljZUluZm8oaWQsICd2b2x1bWUnLCAnbnVtYmVyJyk7XG5cdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHRjYXNlIFwic3R5bGVcIjpcblx0XHRcdFx0XHRcdGF0dHIgPSB0b2tlbml6ZXIuZ2V0Vm9pY2VUb2tlbihsaW5lLCBzdGFydCwgZW5kKTtcblx0XHRcdFx0XHRcdGlmIChhdHRyLndhcm4gIT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRcdFx0d2FybihcIkV4cGVjdGVkIHZhbHVlIGZvciBzdHlsZSBpbiB2b2ljZTogXCIgKyBhdHRyLndhcm4sIGxpbmUsIHN0YXJ0KTtcblx0XHRcdFx0XHRcdGVsc2UgaWYgKGF0dHIudG9rZW4gPT09ICdub3JtYWwnIHx8IGF0dHIudG9rZW4gPT09ICdoYXJtb25pYycgfHwgYXR0ci50b2tlbiA9PT0gJ3JoeXRobScgfHwgYXR0ci50b2tlbiA9PT0gJ3gnKVxuXHRcdFx0XHRcdFx0XHRtdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF0uc3R5bGUgPSBhdHRyLnRva2VuO1xuXHRcdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0XHR3YXJuKFwiRXhwZWN0ZWQgb25lIG9mIFtub3JtYWwsIGhhcm1vbmljLCByaHl0aG0sIHhdIGZvciB2b2ljZSBzdHlsZVwiLCBsaW5lLCBzdGFydCk7XG5cdFx0XHRcdFx0XHRzdGFydCArPSBhdHRyLmxlbjtcblx0XHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRcdC8vIGRlZmF1bHQ6XG5cdFx0XHRcdFx0Ly8gVXNlIHRoaXMgdG8gZmluZCBWOiB1c2FnZXMgdGhhdCBhcmVuJ3QgaGFuZGxlZC5cblx0XHRcdFx0XHQvLyBcdGNvbnNvbGUubG9nKFwicGFyc2Ugdm9pY2VcIiwgdG9rZW4sIHR1bmUubWV0YVRleHQudGl0bGUpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRzdGFydCArPSB0b2tlbml6ZXIuZWF0V2hpdGVTcGFjZShsaW5lLCBzdGFydCk7XG5cdFx0fVxuXG5cdFx0Ly8gbm93IHdlJ3ZlIGZpbGxlZCB1cCBzdGFmZkluZm8sIGZpZ3VyZSBvdXQgd2hhdCB0byBkbyB3aXRoIHRoaXMgdm9pY2Vcblx0XHQvLyBUT0RPLVBFUjogSXQgaXMgdW5jbGVhciBmcm9tIHRoZSBzdGFuZGFyZCBhbmQgdGhlIGV4YW1wbGVzIHdoYXQgdG8gZG8gd2l0aCBicmFjZSwgYnJhY2tldCwgYW5kIHN0YXZlcywgc28gdGhleSBhcmUgaWdub3JlZCBmb3Igbm93LlxuXHRcdGlmIChzdGFmZkluZm8uc3RhcnRTdGFmZiB8fCBtdWx0aWxpbmVWYXJzLnN0YXZlcy5sZW5ndGggPT09IDApIHtcblx0XHRcdG11bHRpbGluZVZhcnMuc3RhdmVzLnB1c2goe2luZGV4OiBtdWx0aWxpbmVWYXJzLnN0YXZlcy5sZW5ndGgsIG1ldGVyOiBtdWx0aWxpbmVWYXJzLm9yaWdNZXRlcn0pO1xuXHRcdFx0aWYgKCFtdWx0aWxpbmVWYXJzLnNjb3JlX2lzX3ByZXNlbnQpXG5cdFx0XHRcdG11bHRpbGluZVZhcnMuc3RhdmVzW211bHRpbGluZVZhcnMuc3RhdmVzLmxlbmd0aC0xXS5udW1Wb2ljZXMgPSAwO1xuXHRcdH1cblx0XHRpZiAobXVsdGlsaW5lVmFycy52b2ljZXNbaWRdLnN0YWZmTnVtID09PSB1bmRlZmluZWQpIHtcblx0XHRcdC8vIHN0b3JlIHdoZXJlIHRvIHdyaXRlIHRoaXMgZm9yIHF1aWNrIGFjY2VzcyBsYXRlci5cblx0XHRcdG11bHRpbGluZVZhcnMudm9pY2VzW2lkXS5zdGFmZk51bSA9IG11bHRpbGluZVZhcnMuc3RhdmVzLmxlbmd0aC0xO1xuXHRcdFx0dmFyIHZpID0gMDtcblx0XHRcdGZvcih2YXIgdiBpbiBtdWx0aWxpbmVWYXJzLnZvaWNlcykge1xuXHRcdFx0XHRpZihtdWx0aWxpbmVWYXJzLnZvaWNlcy5oYXNPd25Qcm9wZXJ0eSh2KSkge1xuXHRcdFx0XHRcdGlmIChtdWx0aWxpbmVWYXJzLnZvaWNlc1t2XS5zdGFmZk51bSA9PT0gbXVsdGlsaW5lVmFycy52b2ljZXNbaWRdLnN0YWZmTnVtKVxuXHRcdFx0XHRcdFx0dmkrKztcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdFx0bXVsdGlsaW5lVmFycy52b2ljZXNbaWRdLmluZGV4ID0gdmktMTtcblx0XHR9XG5cdFx0dmFyIHMgPSBtdWx0aWxpbmVWYXJzLnN0YXZlc1ttdWx0aWxpbmVWYXJzLnZvaWNlc1tpZF0uc3RhZmZOdW1dO1xuXHRcdGlmICghbXVsdGlsaW5lVmFycy5zY29yZV9pc19wcmVzZW50KVxuXHRcdFx0cy5udW1Wb2ljZXMrKztcblx0XHRpZiAoc3RhZmZJbmZvLmNsZWYpIHMuY2xlZiA9IHt0eXBlOiBzdGFmZkluZm8uY2xlZiwgdmVydGljYWxQb3M6IHN0YWZmSW5mby52ZXJ0aWNhbFBvc307XG5cdFx0aWYgKHN0YWZmSW5mby5zcGFjaW5nKSBzLnNwYWNpbmdfYmVsb3dfb2Zmc2V0ID0gc3RhZmZJbmZvLnNwYWNpbmc7XG5cdFx0aWYgKHN0YWZmSW5mby52ZXJ0aWNhbFBvcykgcy52ZXJ0aWNhbFBvcyA9IHN0YWZmSW5mby52ZXJ0aWNhbFBvcztcblxuXHRcdGlmIChzdGFmZkluZm8ubmFtZSkge2lmIChzLm5hbWUpIHMubmFtZS5wdXNoKHN0YWZmSW5mby5uYW1lKTsgZWxzZSBzLm5hbWUgPSBbIHN0YWZmSW5mby5uYW1lIF07fVxuXHRcdGlmIChzdGFmZkluZm8uc3VibmFtZSkge2lmIChzLnN1Ym5hbWUpIHMuc3VibmFtZS5wdXNoKHN0YWZmSW5mby5zdWJuYW1lKTsgZWxzZSBzLnN1Ym5hbWUgPSBbIHN0YWZmSW5mby5zdWJuYW1lIF07fVxuXG5cdFx0c2V0Q3VycmVudFZvaWNlKGlkKTtcblx0fTtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBwYXJzZUtleVZvaWNlO1xuIiwiLy8gICAgYWJjX3Rva2VuaXplci5qczogdG9rZW5pemVzIGFuIEFCQyBNdXNpYyBOb3RhdGlvbiBzdHJpbmcgdG8gc3VwcG9ydCBhYmNfcGFyc2UuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBQYXVsIFJvc2VuIChwYXVsIGF0IHBhdWxyb3NlbiBkb3QgbmV0KVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgcGFyc2VDb21tb24gPSByZXF1aXJlKCcuL2FiY19jb21tb24nKTtcblxuLy8gdGhpcyBpcyBhIHNlcmllcyBvZiBmdW5jdGlvbnMgdGhhdCBnZXQgYSBwYXJ0aWN1bGFyIGVsZW1lbnQgb3V0IG9mIHRoZSBwYXNzZWQgc3RyZWFtLlxuLy8gdGhlIHJldHVybiBpcyB0aGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgY29uc3VtZWQsIHNvIDAgbWVhbnMgdGhhdCB0aGUgZWxlbWVudCB3YXNuJ3QgZm91bmQuXG4vLyBhbHNvIHJldHVybmVkIGlzIHRoZSBlbGVtZW50IGZvdW5kLiBUaGlzIG1heSBiZSBhIGRpZmZlcmVudCBsZW5ndGggYmVjYXVzZSBzcGFjZXMgbWF5IGJlIGNvbnN1bWVkIHRoYXQgYXJlbid0IHBhcnQgb2YgdGhlIHN0cmluZy5cbi8vIFRoZSByZXR1cm4gc3RydWN0dXJlIGZvciBtb3N0IGNhbGxzIGlzIHsgbGVuOiBudW1fY2hhcnNfY29uc3VtZWQsIHRva2VuOiBzdHIgfVxudmFyIFRva2VuaXplciA9IGZ1bmN0aW9uKCkge1xuXHR0aGlzLnNraXBXaGl0ZVNwYWNlID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcblx0XHQgIGlmICghdGhpcy5pc1doaXRlU3BhY2Uoc3RyLmNoYXJBdChpKSkpXG5cdFx0XHRcdHJldHVybiBpO1xuXHRcdH1cblx0XHRyZXR1cm4gc3RyLmxlbmd0aDtcdC8vIEl0IG11c3QgaGF2ZSBiZWVuIGFsbCB3aGl0ZSBzcGFjZVxuXHR9O1xuXHR2YXIgZmluaXNoZWQgPSBmdW5jdGlvbihzdHIsIGkpIHtcblx0XHRyZXR1cm4gaSA+PSBzdHIubGVuZ3RoO1xuXHR9O1xuXHR0aGlzLmVhdFdoaXRlU3BhY2UgPSBmdW5jdGlvbihsaW5lLCBpbmRleCkge1xuXHRcdGZvciAodmFyIGkgPSBpbmRleDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHtcblx0XHQgIGlmICghdGhpcy5pc1doaXRlU3BhY2UobGluZS5jaGFyQXQoaSkpKVxuXHRcdFx0XHRyZXR1cm4gaS1pbmRleDtcblx0XHR9XG5cdFx0cmV0dXJuIGktaW5kZXg7XG5cdH07XG5cblx0Ly8gVGhpcyBqdXN0IGdldHMgdGhlIGJhc2ljIHBpdGNoIGxldHRlciwgaWdub3JpbmcgbGVhZGluZyBzcGFjZXMsIGFuZCBub3JtYWxpemluZyBpdCB0byBhIGNhcGl0YWxcblx0dGhpcy5nZXRLZXlQaXRjaCA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdHZhciBpID0gdGhpcy5za2lwV2hpdGVTcGFjZShzdHIpO1xuXHRcdGlmIChmaW5pc2hlZChzdHIsIGkpKVxuXHRcdFx0cmV0dXJuIHtsZW46IDB9O1xuXHRcdHN3aXRjaCAoc3RyLmNoYXJBdChpKSkge1xuXHRcdFx0Y2FzZSAnQSc6cmV0dXJuIHtsZW46IGkrMSwgdG9rZW46ICdBJ307XG5cdFx0XHRjYXNlICdCJzpyZXR1cm4ge2xlbjogaSsxLCB0b2tlbjogJ0InfTtcblx0XHRcdGNhc2UgJ0MnOnJldHVybiB7bGVuOiBpKzEsIHRva2VuOiAnQyd9O1xuXHRcdFx0Y2FzZSAnRCc6cmV0dXJuIHtsZW46IGkrMSwgdG9rZW46ICdEJ307XG5cdFx0XHRjYXNlICdFJzpyZXR1cm4ge2xlbjogaSsxLCB0b2tlbjogJ0UnfTtcblx0XHRcdGNhc2UgJ0YnOnJldHVybiB7bGVuOiBpKzEsIHRva2VuOiAnRid9O1xuXHRcdFx0Y2FzZSAnRyc6cmV0dXJuIHtsZW46IGkrMSwgdG9rZW46ICdHJ307XG4vL1x0XHRcdGNhc2UgJ2EnOnJldHVybiB7bGVuOiBpKzEsIHRva2VuOiAnQSd9O1xuLy9cdFx0XHRjYXNlICdiJzpyZXR1cm4ge2xlbjogaSsxLCB0b2tlbjogJ0InfTtcbi8vXHRcdFx0Y2FzZSAnYyc6cmV0dXJuIHtsZW46IGkrMSwgdG9rZW46ICdDJ307XG4vL1x0XHRcdGNhc2UgJ2QnOnJldHVybiB7bGVuOiBpKzEsIHRva2VuOiAnRCd9O1xuLy9cdFx0XHRjYXNlICdlJzpyZXR1cm4ge2xlbjogaSsxLCB0b2tlbjogJ0UnfTtcbi8vXHRcdFx0Y2FzZSAnZic6cmV0dXJuIHtsZW46IGkrMSwgdG9rZW46ICdGJ307XG4vL1x0XHRcdGNhc2UgJ2cnOnJldHVybiB7bGVuOiBpKzEsIHRva2VuOiAnRyd9O1xuXHRcdH1cblx0XHRyZXR1cm4ge2xlbjogMH07XG5cdH07XG5cblx0Ly8gVGhpcyBqdXN0IGdldHMgdGhlIGJhc2ljIGFjY2lkZW50YWwsIGlnbm9yaW5nIGxlYWRpbmcgc3BhY2VzLCBhbmQgb25seSB0aGUgb25lcyB0aGF0IGFwcGVhciBpbiBhIGtleVxuXHR0aGlzLmdldFNoYXJwRmxhdCA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdGlmIChzdHIgPT09ICdiYXNzJylcblx0XHRcdHJldHVybiB7bGVuOiAwfTtcblx0XHRzd2l0Y2ggKHN0ci5jaGFyQXQoMCkpIHtcblx0XHRcdGNhc2UgJyMnOnJldHVybiB7bGVuOiAxLCB0b2tlbjogJyMnfTtcblx0XHRcdGNhc2UgJ2InOnJldHVybiB7bGVuOiAxLCB0b2tlbjogJ2InfTtcblx0XHR9XG5cdFx0cmV0dXJuIHtsZW46IDB9O1xuXHR9O1xuXG5cdHRoaXMuZ2V0TW9kZSA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdHZhciBza2lwQWxwaGEgPSBmdW5jdGlvbihzdHIsIHN0YXJ0KSB7XG5cdFx0XHQvLyBUaGlzIHJldHVybnMgdGhlIGluZGV4IG9mIHRoZSBuZXh0IG5vbi1hbHBoYWJldGljIGNoYXIsIG9yIHRoZSBlbnRpcmUgbGVuZ3RoIG9mIHRoZSBzdHJpbmcgaWYgbm90IGZvdW5kLlxuXHRcdCAgd2hpbGUgKHN0YXJ0IDwgc3RyLmxlbmd0aCAmJiAoKHN0ci5jaGFyQXQoc3RhcnQpID49ICdhJyAmJiBzdHIuY2hhckF0KHN0YXJ0KSA8PSAneicpIHx8IChzdHIuY2hhckF0KHN0YXJ0KSA+PSAnQScgJiYgc3RyLmNoYXJBdChzdGFydCkgPD0gJ1onKSkpXG5cdFx0XHRcdHN0YXJ0Kys7XG5cdFx0XHRyZXR1cm4gc3RhcnQ7XG5cdFx0fTtcblxuXHRcdHZhciBpID0gdGhpcy5za2lwV2hpdGVTcGFjZShzdHIpO1xuXHRcdGlmIChmaW5pc2hlZChzdHIsIGkpKVxuXHRcdFx0cmV0dXJuIHtsZW46IDB9O1xuXHRcdHZhciBmaXJzdFRocmVlID0gc3RyLnN1YnN0cmluZyhpLGkrMykudG9Mb3dlckNhc2UoKTtcblx0XHRpZiAoZmlyc3RUaHJlZS5sZW5ndGggPiAxICYmIGZpcnN0VGhyZWUuY2hhckF0KDEpID09PSAnICcgfHwgZmlyc3RUaHJlZS5jaGFyQXQoMSkgPT09ICdeJyB8fCBmaXJzdFRocmVlLmNoYXJBdCgxKSA9PT0gJ18nIHx8IGZpcnN0VGhyZWUuY2hhckF0KDEpID09PSAnPScpIGZpcnN0VGhyZWUgPSBmaXJzdFRocmVlLmNoYXJBdCgwKTtcdC8vIFRoaXMgd2lsbCBoYW5kbGUgdGhlIGNhc2Ugb2YgJ20nXG5cdFx0c3dpdGNoIChmaXJzdFRocmVlKSB7XG5cdFx0XHRjYXNlICdtaXgnOnJldHVybiB7bGVuOiBza2lwQWxwaGEoc3RyLCBpKSwgdG9rZW46ICdNaXgnfTtcblx0XHRcdGNhc2UgJ2Rvcic6cmV0dXJuIHtsZW46IHNraXBBbHBoYShzdHIsIGkpLCB0b2tlbjogJ0Rvcid9O1xuXHRcdFx0Y2FzZSAncGhyJzpyZXR1cm4ge2xlbjogc2tpcEFscGhhKHN0ciwgaSksIHRva2VuOiAnUGhyJ307XG5cdFx0XHRjYXNlICdseWQnOnJldHVybiB7bGVuOiBza2lwQWxwaGEoc3RyLCBpKSwgdG9rZW46ICdMeWQnfTtcblx0XHRcdGNhc2UgJ2xvYyc6cmV0dXJuIHtsZW46IHNraXBBbHBoYShzdHIsIGkpLCB0b2tlbjogJ0xvYyd9O1xuXHRcdFx0Y2FzZSAnYWVvJzpyZXR1cm4ge2xlbjogc2tpcEFscGhhKHN0ciwgaSksIHRva2VuOiAnbSd9O1xuXHRcdFx0Y2FzZSAnbWFqJzpyZXR1cm4ge2xlbjogc2tpcEFscGhhKHN0ciwgaSksIHRva2VuOiAnJ307XG5cdFx0XHRjYXNlICdpb24nOnJldHVybiB7bGVuOiBza2lwQWxwaGEoc3RyLCBpKSwgdG9rZW46ICcnfTtcblx0XHRcdGNhc2UgJ21pbic6cmV0dXJuIHtsZW46IHNraXBBbHBoYShzdHIsIGkpLCB0b2tlbjogJ20nfTtcblx0XHRcdGNhc2UgJ20nOnJldHVybiB7bGVuOiBza2lwQWxwaGEoc3RyLCBpKSwgdG9rZW46ICdtJ307XG5cdFx0fVxuXHRcdHJldHVybiB7bGVuOiAwfTtcblx0fTtcblxuXHR0aGlzLmdldENsZWYgPSBmdW5jdGlvbihzdHIsIGJFeHBsaWNpdE9ubHkpIHtcblx0XHR2YXIgc3RyT3JpZyA9IHN0cjtcblx0XHR2YXIgaSA9IHRoaXMuc2tpcFdoaXRlU3BhY2Uoc3RyKTtcblx0XHRpZiAoZmluaXNoZWQoc3RyLCBpKSlcblx0XHRcdHJldHVybiB7bGVuOiAwfTtcblx0XHQvLyBUaGUgd29yZCAnY2xlZicgaXMgb3B0aW9uYWwsIGJ1dCBpZiBpdCBhcHBlYXJzLCBhIGNsZWYgTVVTVCBhcHBlYXJcblx0XHR2YXIgbmVlZHNDbGVmID0gZmFsc2U7XG5cdFx0dmFyIHN0ckNsZWYgPSBzdHIuc3Vic3RyaW5nKGkpO1xuXHRcdGlmIChwYXJzZUNvbW1vbi5zdGFydHNXaXRoKHN0ckNsZWYsICdjbGVmPScpKSB7XG5cdFx0XHRuZWVkc0NsZWYgPSB0cnVlO1xuXHRcdFx0c3RyQ2xlZiA9IHN0ckNsZWYuc3Vic3RyaW5nKDUpO1xuXHRcdFx0aSArPSA1O1xuXHRcdH1cblx0XHRpZiAoc3RyQ2xlZi5sZW5ndGggPT09IDAgJiYgbmVlZHNDbGVmKVxuXHRcdFx0cmV0dXJuIHtsZW46IGkrNSwgd2FybjogXCJObyBjbGVmIHNwZWNpZmllZDogXCIgKyBzdHJPcmlnfTtcblxuXHRcdHZhciBqID0gdGhpcy5za2lwV2hpdGVTcGFjZShzdHJDbGVmKTtcblx0XHRpZiAoZmluaXNoZWQoc3RyQ2xlZiwgaikpXG5cdFx0XHRyZXR1cm4ge2xlbjogMH07XG5cdFx0aWYgKGogPiAwKSB7XG5cdFx0XHRpICs9IGo7XG5cdFx0XHRzdHJDbGVmID0gc3RyQ2xlZi5zdWJzdHJpbmcoaik7XG5cdFx0fVxuXHRcdHZhciBuYW1lID0gbnVsbDtcblx0XHRpZiAocGFyc2VDb21tb24uc3RhcnRzV2l0aChzdHJDbGVmLCAndHJlYmxlJykpXG5cdFx0XHRuYW1lID0gJ3RyZWJsZSc7XG5cdFx0ZWxzZSBpZiAocGFyc2VDb21tb24uc3RhcnRzV2l0aChzdHJDbGVmLCAnYmFzczMnKSlcblx0XHRcdG5hbWUgPSAnYmFzczMnO1xuXHRcdGVsc2UgaWYgKHBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgoc3RyQ2xlZiwgJ2Jhc3MnKSlcblx0XHRcdG5hbWUgPSAnYmFzcyc7XG5cdFx0ZWxzZSBpZiAocGFyc2VDb21tb24uc3RhcnRzV2l0aChzdHJDbGVmLCAndGVub3InKSlcblx0XHRcdG5hbWUgPSAndGVub3InO1xuXHRcdGVsc2UgaWYgKHBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgoc3RyQ2xlZiwgJ2FsdG8yJykpXG5cdFx0XHRuYW1lID0gJ2FsdG8yJztcblx0XHRlbHNlIGlmIChwYXJzZUNvbW1vbi5zdGFydHNXaXRoKHN0ckNsZWYsICdhbHRvMScpKVxuXHRcdFx0bmFtZSA9ICdhbHRvMSc7XG5cdFx0ZWxzZSBpZiAocGFyc2VDb21tb24uc3RhcnRzV2l0aChzdHJDbGVmLCAnYWx0bycpKVxuXHRcdFx0bmFtZSA9ICdhbHRvJztcblx0XHRlbHNlIGlmICghYkV4cGxpY2l0T25seSAmJiAobmVlZHNDbGVmICYmIHBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgoc3RyQ2xlZiwgJ25vbmUnKSkpXG5cdFx0XHRuYW1lID0gJ25vbmUnO1xuXHRcdGVsc2UgaWYgKHBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgoc3RyQ2xlZiwgJ3BlcmMnKSlcblx0XHRcdG5hbWUgPSAncGVyYyc7XG5cdFx0ZWxzZSBpZiAoIWJFeHBsaWNpdE9ubHkgJiYgKG5lZWRzQ2xlZiAmJiBwYXJzZUNvbW1vbi5zdGFydHNXaXRoKHN0ckNsZWYsICdDJykpKVxuXHRcdFx0bmFtZSA9ICd0ZW5vcic7XG5cdFx0ZWxzZSBpZiAoIWJFeHBsaWNpdE9ubHkgJiYgKG5lZWRzQ2xlZiAmJiBwYXJzZUNvbW1vbi5zdGFydHNXaXRoKHN0ckNsZWYsICdGJykpKVxuXHRcdFx0bmFtZSA9ICdiYXNzJztcblx0XHRlbHNlIGlmICghYkV4cGxpY2l0T25seSAmJiAobmVlZHNDbGVmICYmIHBhcnNlQ29tbW9uLnN0YXJ0c1dpdGgoc3RyQ2xlZiwgJ0cnKSkpXG5cdFx0XHRuYW1lID0gJ3RyZWJsZSc7XG5cdFx0ZWxzZVxuXHRcdFx0cmV0dXJuIHtsZW46IGkrNSwgd2FybjogXCJVbmtub3duIGNsZWYgc3BlY2lmaWVkOiBcIiArIHN0ck9yaWd9O1xuXG5cdFx0c3RyQ2xlZiA9IHN0ckNsZWYuc3Vic3RyaW5nKG5hbWUubGVuZ3RoKTtcblx0XHRqID0gdGhpcy5pc01hdGNoKHN0ckNsZWYsICcrOCcpO1xuXHRcdGlmIChqID4gMClcblx0XHRcdG5hbWUgKz0gXCIrOFwiO1xuXHRcdGVsc2Uge1xuXHRcdFx0aiA9IHRoaXMuaXNNYXRjaChzdHJDbGVmLCAnLTgnKTtcblx0XHRcdGlmIChqID4gMClcblx0XHRcdFx0bmFtZSArPSBcIi04XCI7XG5cdFx0fVxuXHRcdHJldHVybiB7bGVuOiBpK25hbWUubGVuZ3RoLCB0b2tlbjogbmFtZSwgZXhwbGljaXQ6IG5lZWRzQ2xlZn07XG5cdH07XG5cblx0Ly8gVGhpcyByZXR1cm5zIG9uZSBvZiB0aGUgbGVnYWwgYmFyIGxpbmVzXG5cdC8vIFRoaXMgaXMgY2FsbGVkIGFsb3QgYW5kIHRoZXJlIGlzIG5vIG9idmlvdXMgdG9rZW5hYmxlIGl0ZW1zLCBzbyB0aGlzIGlzIGJyb2tlbiBhcGFydC5cblx0dGhpcy5nZXRCYXJMaW5lID0gZnVuY3Rpb24obGluZSwgaSkge1xuXHRcdHN3aXRjaCAobGluZS5jaGFyQXQoaSkpIHtcblx0XHRcdGNhc2UgJ10nOlxuXHRcdFx0XHQrK2k7XG5cdFx0XHRcdHN3aXRjaCAobGluZS5jaGFyQXQoaSkpIHtcblx0XHRcdFx0XHRjYXNlICd8JzogcmV0dXJuIHtsZW46IDIsIHRva2VuOiBcImJhcl90aGlja190aGluXCJ9O1xuXHRcdFx0XHRcdGNhc2UgJ1snOlxuXHRcdFx0XHRcdFx0KytpO1xuXHRcdFx0XHRcdFx0aWYgKChsaW5lLmNoYXJBdChpKSA+PSAnMScgJiYgbGluZS5jaGFyQXQoaSkgPD0gJzknKSB8fCBsaW5lLmNoYXJBdChpKSA9PT0gJ1wiJylcblx0XHRcdFx0XHRcdFx0cmV0dXJuIHtsZW46IDIsIHRva2VuOiBcImJhcl9pbnZpc2libGVcIn07XG5cdFx0XHRcdFx0XHRyZXR1cm4ge2xlbjogMSwgd2FybjogXCJVbmtub3duIGJhciBzeW1ib2xcIn07XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdHJldHVybiB7bGVuOiAxLCB0b2tlbjogXCJiYXJfaW52aXNpYmxlXCJ9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0Y2FzZSAnOic6XG5cdFx0XHRcdCsraTtcblx0XHRcdFx0c3dpdGNoIChsaW5lLmNoYXJBdChpKSkge1xuXHRcdFx0XHRcdGNhc2UgJzonOiByZXR1cm4ge2xlbjogMiwgdG9rZW46IFwiYmFyX2RibF9yZXBlYXRcIn07XG5cdFx0XHRcdFx0Y2FzZSAnfCc6XHQvLyA6fFxuXHRcdFx0XHRcdFx0KytpO1xuXHRcdFx0XHRcdFx0c3dpdGNoIChsaW5lLmNoYXJBdChpKSkge1xuXHRcdFx0XHRcdFx0XHRjYXNlICddJzpcdC8vIDp8XVxuXHRcdFx0XHRcdFx0XHRcdCsraTtcblx0XHRcdFx0XHRcdFx0XHRzd2l0Y2ggKGxpbmUuY2hhckF0KGkpKSB7XG5cdFx0XHRcdFx0XHRcdFx0XHRjYXNlICd8JzpcdC8vIDp8XXxcblx0XHRcdFx0XHRcdFx0XHRcdFx0KytpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRpZiAobGluZS5jaGFyQXQoaSkgPT09ICc6JykgIHJldHVybiB7bGVuOiA1LCB0b2tlbjogXCJiYXJfZGJsX3JlcGVhdFwifTtcblx0XHRcdFx0XHRcdFx0XHRcdFx0cmV0dXJuIHtsZW46IDMsIHRva2VuOiBcImJhcl9yaWdodF9yZXBlYXRcIn07XG5cdFx0XHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRcdFx0XHRyZXR1cm4ge2xlbjogMywgdG9rZW46IFwiYmFyX3JpZ2h0X3JlcGVhdFwifTtcblx0XHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0XHRcdGNhc2UgJ3wnOlx0Ly8gOnx8XG5cdFx0XHRcdFx0XHRcdFx0KytpO1xuXHRcdFx0XHRcdFx0XHRcdGlmIChsaW5lLmNoYXJBdChpKSA9PT0gJzonKSAgcmV0dXJuIHtsZW46IDQsIHRva2VuOiBcImJhcl9kYmxfcmVwZWF0XCJ9O1xuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB7bGVuOiAzLCB0b2tlbjogXCJiYXJfcmlnaHRfcmVwZWF0XCJ9O1xuXHRcdFx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0XHRcdHJldHVybiB7bGVuOiAyLCB0b2tlbjogXCJiYXJfcmlnaHRfcmVwZWF0XCJ9O1xuXHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRcdHJldHVybiB7bGVuOiAxLCB3YXJuOiBcIlVua25vd24gYmFyIHN5bWJvbFwifTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ1snOlx0Ly8gW1xuXHRcdFx0XHQrK2k7XG5cdFx0XHRcdGlmIChsaW5lLmNoYXJBdChpKSA9PT0gJ3wnKSB7XHQvLyBbfFxuXHRcdFx0XHRcdCsraTtcblx0XHRcdFx0XHRzd2l0Y2ggKGxpbmUuY2hhckF0KGkpKSB7XG5cdFx0XHRcdFx0XHRjYXNlICc6JzogcmV0dXJuIHtsZW46IDMsIHRva2VuOiBcImJhcl9sZWZ0X3JlcGVhdFwifTtcblx0XHRcdFx0XHRcdGNhc2UgJ10nOiByZXR1cm4ge2xlbjogMywgdG9rZW46IFwiYmFyX2ludmlzaWJsZVwifTtcblx0XHRcdFx0XHRcdGRlZmF1bHQ6IHJldHVybiB7bGVuOiAyLCB0b2tlbjogXCJiYXJfdGhpY2tfdGhpblwifTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0aWYgKChsaW5lLmNoYXJBdChpKSA+PSAnMScgJiYgbGluZS5jaGFyQXQoaSkgPD0gJzknKSB8fCBsaW5lLmNoYXJBdChpKSA9PT0gJ1wiJylcblx0XHRcdFx0XHRcdHJldHVybiB7bGVuOiAxLCB0b2tlbjogXCJiYXJfaW52aXNpYmxlXCJ9O1xuXHRcdFx0XHRcdHJldHVybiB7bGVuOiAwfTtcblx0XHRcdFx0fVxuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgJ3wnOlx0Ly8gfFxuXHRcdFx0XHQrK2k7XG5cdFx0XHRcdHN3aXRjaCAobGluZS5jaGFyQXQoaSkpIHtcblx0XHRcdFx0XHRjYXNlICddJzogcmV0dXJuIHtsZW46IDIsIHRva2VuOiBcImJhcl90aGluX3RoaWNrXCJ9O1xuXHRcdFx0XHRcdGNhc2UgJ3wnOiAvLyB8fFxuXHRcdFx0XHRcdFx0KytpO1xuXHRcdFx0XHRcdFx0aWYgKGxpbmUuY2hhckF0KGkpID09PSAnOicpIHJldHVybiB7bGVuOiAzLCB0b2tlbjogXCJiYXJfbGVmdF9yZXBlYXRcIn07XG5cdFx0XHRcdFx0XHRyZXR1cm4ge2xlbjogMiwgdG9rZW46IFwiYmFyX3RoaW5fdGhpblwifTtcblx0XHRcdFx0XHRjYXNlICc6JzpcdC8vIHw6XG5cdFx0XHRcdFx0XHR2YXIgY29sb25zID0gMDtcblx0XHRcdFx0XHRcdHdoaWxlIChsaW5lLmNoYXJBdChpK2NvbG9ucykgPT09ICc6JykgY29sb25zKys7XG5cdFx0XHRcdFx0XHRyZXR1cm4geyBsZW46IDErY29sb25zLCB0b2tlbjogXCJiYXJfbGVmdF9yZXBlYXRcIn07XG5cdFx0XHRcdFx0ZGVmYXVsdDogcmV0dXJuIHtsZW46IDEsIHRva2VuOiBcImJhcl90aGluXCJ9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdH1cblx0XHRyZXR1cm4ge2xlbjogMH07XG5cdH07XG5cblx0Ly8gdGhpcyByZXR1cm5zIGFsbCB0aGUgY2hhcmFjdGVycyBpbiB0aGUgc3RyaW5nIHRoYXQgbWF0Y2ggb25lIG9mIHRoZSBjaGFyYWN0ZXJzIGluIHRoZSBsZWdhbENoYXJzIHN0cmluZ1xuXHR0aGlzLmdldFRva2VuT2YgPSBmdW5jdGlvbihzdHIsIGxlZ2FsQ2hhcnMpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKGxlZ2FsQ2hhcnMuaW5kZXhPZihzdHIuY2hhckF0KGkpKSA8IDApXG5cdFx0XHRcdHJldHVybiB7bGVuOiBpLCB0b2tlbjogc3RyLnN1YnN0cmluZygwLCBpKX07XG5cdFx0fVxuXHRcdHJldHVybiB7bGVuOiBpLCB0b2tlbjogc3RyfTtcblx0fTtcblxuXHR0aGlzLmdldFRva2VuID0gZnVuY3Rpb24oc3RyLCBzdGFydCwgZW5kKSB7XG5cdFx0Ly8gVGhpcyByZXR1cm5zIHRoZSBuZXh0IHNldCBvZiBjaGFycyB0aGF0IGRvZXNuJ3QgY29udGFpbiBzcGFjZXNcblx0XHR2YXIgaSA9IHN0YXJ0O1xuXHRcdHdoaWxlIChpIDwgZW5kICYmICF0aGlzLmlzV2hpdGVTcGFjZShzdHIuY2hhckF0KGkpKSlcblx0XHRcdGkrKztcblx0XHRyZXR1cm4gc3RyLnN1YnN0cmluZyhzdGFydCwgaSk7XG5cdH07XG5cblx0Ly8gVGhpcyBqdXN0IHNlZXMgaWYgdGhlIG5leHQgdG9rZW4gaXMgdGhlIHdvcmQgcGFzc2VkIGluLCB3aXRoIHBvc3NpYmxlIGxlYWRpbmcgc3BhY2VzXG5cdHRoaXMuaXNNYXRjaCA9IGZ1bmN0aW9uKHN0ciwgbWF0Y2gpIHtcblx0XHR2YXIgaSA9IHRoaXMuc2tpcFdoaXRlU3BhY2Uoc3RyKTtcblx0XHRpZiAoZmluaXNoZWQoc3RyLCBpKSlcblx0XHRcdHJldHVybiAwO1xuXHRcdGlmIChwYXJzZUNvbW1vbi5zdGFydHNXaXRoKHN0ci5zdWJzdHJpbmcoaSksIG1hdGNoKSlcblx0XHRcdHJldHVybiBpK21hdGNoLmxlbmd0aDtcblx0XHRyZXR1cm4gMDtcblx0fTtcblxuXHR0aGlzLmdldFBpdGNoRnJvbVRva2VucyA9IGZ1bmN0aW9uKHRva2Vucykge1xuXHRcdHZhciByZXQgPSB7IH07XG5cdFx0dmFyIHBpdGNoZXMgPSB7QTogNSwgQjogNiwgQzogMCwgRDogMSwgRTogMiwgRjogMywgRzogNCwgYTogMTIsIGI6IDEzLCBjOiA3LCBkOiA4LCBlOiA5LCBmOiAxMCwgZzogMTF9O1xuXHRcdHJldC5wb3NpdGlvbiA9IHBpdGNoZXNbdG9rZW5zWzBdLnRva2VuXTtcblx0XHRpZiAocmV0LnBvc2l0aW9uID09PSB1bmRlZmluZWQpXG5cdFx0XHRyZXR1cm4geyB3YXJuOiBcIlBpdGNoIGV4cGVjdGVkLiBGb3VuZDogXCIgKyB0b2tlbnNbMF0udG9rZW4gfTtcblx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHR3aGlsZSAodG9rZW5zLmxlbmd0aCkge1xuXHRcdFx0c3dpdGNoICh0b2tlbnNbMF0udG9rZW4pIHtcblx0XHRcdFx0Y2FzZSAnLCc6IHJldC5wb3NpdGlvbiAtPSA3OyB0b2tlbnMuc2hpZnQoKTsgYnJlYWs7XG5cdFx0XHRcdGNhc2UgJ1xcJyc6IHJldC5wb3NpdGlvbiArPSA3OyB0b2tlbnMuc2hpZnQoKTsgYnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6IHJldHVybiByZXQ7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiByZXQ7XG5cdH07XG5cblx0dGhpcy5nZXRLZXlBY2NpZGVudGFsczIgPSBmdW5jdGlvbih0b2tlbnMpIHtcblx0XHR2YXIgYWNjcztcblx0XHQvLyBmaW5kIGFuZCBzdHJpcCBvZmYgYWxsIGFjY2lkZW50YWxzIGluIHRoZSB0b2tlbiBsaXN0XG5cdFx0d2hpbGUgKHRva2Vucy5sZW5ndGggPiAwKSB7XG5cdFx0XHR2YXIgYWNjO1xuXHRcdFx0aWYgKHRva2Vuc1swXS50b2tlbiA9PT0gJ14nKSB7XG5cdFx0XHRcdGFjYyA9ICdzaGFycCc7XG5cdFx0XHRcdHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHthY2NzOiBhY2NzLCB3YXJuOiAnRXhwZWN0ZWQgbm90ZSBuYW1lIGFmdGVyICcgKyBhY2N9O1xuXHRcdFx0XHRzd2l0Y2ggKHRva2Vuc1swXS50b2tlbikge1xuXHRcdFx0XHRcdGNhc2UgJ14nOiBhY2MgPSAnZGJsc2hhcnAnOyB0b2tlbnMuc2hpZnQoKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnLyc6IGFjYyA9ICdxdWFydGVyc2hhcnAnOyB0b2tlbnMuc2hpZnQoKTsgYnJlYWs7XG5cdFx0XHRcdH1cblx0XHRcdH0gZWxzZSBpZiAodG9rZW5zWzBdLnRva2VuID09PSAnPScpIHtcblx0XHRcdFx0YWNjID0gJ25hdHVyYWwnO1xuXHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdH0gZWxzZSBpZiAodG9rZW5zWzBdLnRva2VuID09PSAnXycpIHtcblx0XHRcdFx0YWNjID0gJ2ZsYXQnO1xuXHRcdFx0XHR0b2tlbnMuc2hpZnQoKTtcblx0XHRcdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHJldHVybiB7YWNjczogYWNjcywgd2FybjogJ0V4cGVjdGVkIG5vdGUgbmFtZSBhZnRlciAnICsgYWNjfTtcblx0XHRcdFx0c3dpdGNoICh0b2tlbnNbMF0udG9rZW4pIHtcblx0XHRcdFx0XHRjYXNlICdfJzogYWNjID0gJ2RibGZsYXQnOyB0b2tlbnMuc2hpZnQoKTsgYnJlYWs7XG5cdFx0XHRcdFx0Y2FzZSAnLyc6IGFjYyA9ICdxdWFydGVyZmxhdCc7IHRva2Vucy5zaGlmdCgpOyBicmVhaztcblx0XHRcdFx0fVxuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Ly8gTm90IGFuIGFjY2lkZW50YWwsIHdlJ2xsIGFzc3VtZSB0aGF0IGEgbGF0ZXIgcGFyc2Ugd2lsbCByZWNvZ25pemUgaXQuXG5cdFx0XHRcdHJldHVybiB7IGFjY3M6IGFjY3MgfTtcblx0XHRcdH1cblx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSByZXR1cm4ge2FjY3M6IGFjY3MsIHdhcm46ICdFeHBlY3RlZCBub3RlIG5hbWUgYWZ0ZXIgJyArIGFjY307XG5cdFx0XHRzd2l0Y2ggKHRva2Vuc1swXS50b2tlbi5jaGFyQXQoMCkpXG5cdFx0XHR7XG5cdFx0XHRcdGNhc2UgJ2EnOlxuXHRcdFx0XHRjYXNlICdiJzpcblx0XHRcdFx0Y2FzZSAnYyc6XG5cdFx0XHRcdGNhc2UgJ2QnOlxuXHRcdFx0XHRjYXNlICdlJzpcblx0XHRcdFx0Y2FzZSAnZic6XG5cdFx0XHRcdGNhc2UgJ2cnOlxuXHRcdFx0XHRjYXNlICdBJzpcblx0XHRcdFx0Y2FzZSAnQic6XG5cdFx0XHRcdGNhc2UgJ0MnOlxuXHRcdFx0XHRjYXNlICdEJzpcblx0XHRcdFx0Y2FzZSAnRSc6XG5cdFx0XHRcdGNhc2UgJ0YnOlxuXHRcdFx0XHRjYXNlICdHJzpcblx0XHRcdFx0XHRpZiAoYWNjcyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRcdFx0YWNjcyA9IFtdO1xuXHRcdFx0XHRcdGFjY3MucHVzaCh7IGFjYzogYWNjLCBub3RlOiB0b2tlbnNbMF0udG9rZW4uY2hhckF0KDApIH0pO1xuXHRcdFx0XHRcdGlmICh0b2tlbnNbMF0udG9rZW4ubGVuZ3RoID09PSAxKVxuXHRcdFx0XHRcdFx0dG9rZW5zLnNoaWZ0KCk7XG5cdFx0XHRcdFx0ZWxzZVxuXHRcdFx0XHRcdFx0dG9rZW5zWzBdLnRva2VuID0gdG9rZW5zWzBdLnRva2VuLnN1YnN0cmluZygxKTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4ge2FjY3M6IGFjY3MsIHdhcm46ICdFeHBlY3RlZCBub3RlIG5hbWUgYWZ0ZXIgJyArIGFjYyArICcgRm91bmQ6ICcgKyB0b2tlbnNbMF0udG9rZW4gfTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHsgYWNjczogYWNjcyB9O1xuXHR9O1xuXG5cdC8vIFRoaXMgZ2V0cyBhbiBhY2NpZGVudGFsIG1hcmtpbmcgZm9yIHRoZSBrZXkgc2lnbmF0dXJlLiBJdCBoYXMgdGhlIGFjY2lkZW50YWwgdGhlbiB0aGUgcGl0Y2ggbGV0dGVyLlxuXHR0aGlzLmdldEtleUFjY2lkZW50YWwgPSBmdW5jdGlvbihzdHIpIHtcblx0XHR2YXIgYWNjVHJhbnNsYXRpb24gPSB7XG5cdFx0XHQnXic6ICdzaGFycCcsXG5cdFx0XHQnXl4nOiAnZGJsc2hhcnAnLFxuXHRcdFx0Jz0nOiAnbmF0dXJhbCcsXG5cdFx0XHQnXyc6ICdmbGF0Jyxcblx0XHRcdCdfXyc6ICdkYmxmbGF0Jyxcblx0XHRcdCdfLyc6ICdxdWFydGVyZmxhdCcsXG5cdFx0XHQnXi8nOiAncXVhcnRlcnNoYXJwJ1xuXHRcdH07XG5cdFx0dmFyIGkgPSB0aGlzLnNraXBXaGl0ZVNwYWNlKHN0cik7XG5cdFx0aWYgKGZpbmlzaGVkKHN0ciwgaSkpXG5cdFx0XHRyZXR1cm4ge2xlbjogMH07XG5cdFx0dmFyIGFjYyA9IG51bGw7XG5cdFx0c3dpdGNoIChzdHIuY2hhckF0KGkpKVxuXHRcdHtcblx0XHRcdGNhc2UgJ14nOlxuXHRcdFx0Y2FzZSAnXyc6XG5cdFx0XHRjYXNlICc9Jzpcblx0XHRcdFx0YWNjID0gc3RyLmNoYXJBdChpKTtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRkZWZhdWx0OnJldHVybiB7bGVuOiAwfTtcblx0XHR9XG5cdFx0aSsrO1xuXHRcdGlmIChmaW5pc2hlZChzdHIsIGkpKVxuXHRcdFx0cmV0dXJuIHtsZW46IDEsIHdhcm46ICdFeHBlY3RlZCBub3RlIG5hbWUgYWZ0ZXIgYWNjaWRlbnRhbCd9O1xuXHRcdHN3aXRjaCAoc3RyLmNoYXJBdChpKSlcblx0XHR7XG5cdFx0XHRjYXNlICdhJzpcblx0XHRcdGNhc2UgJ2InOlxuXHRcdFx0Y2FzZSAnYyc6XG5cdFx0XHRjYXNlICdkJzpcblx0XHRcdGNhc2UgJ2UnOlxuXHRcdFx0Y2FzZSAnZic6XG5cdFx0XHRjYXNlICdnJzpcblx0XHRcdGNhc2UgJ0EnOlxuXHRcdFx0Y2FzZSAnQic6XG5cdFx0XHRjYXNlICdDJzpcblx0XHRcdGNhc2UgJ0QnOlxuXHRcdFx0Y2FzZSAnRSc6XG5cdFx0XHRjYXNlICdGJzpcblx0XHRcdGNhc2UgJ0cnOlxuXHRcdFx0XHRyZXR1cm4ge2xlbjogaSsxLCB0b2tlbjoge2FjYzogYWNjVHJhbnNsYXRpb25bYWNjXSwgbm90ZTogc3RyLmNoYXJBdChpKX19O1xuXHRcdFx0Y2FzZSAnXic6XG5cdFx0XHRjYXNlICdfJzpcblx0XHRcdGNhc2UgJy8nOlxuXHRcdFx0XHRhY2MgKz0gc3RyLmNoYXJBdChpKTtcblx0XHRcdFx0aSsrO1xuXHRcdFx0XHRpZiAoZmluaXNoZWQoc3RyLCBpKSlcblx0XHRcdFx0XHRyZXR1cm4ge2xlbjogMiwgd2FybjogJ0V4cGVjdGVkIG5vdGUgbmFtZSBhZnRlciBhY2NpZGVudGFsJ307XG5cdFx0XHRcdHN3aXRjaCAoc3RyLmNoYXJBdChpKSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdGNhc2UgJ2EnOlxuXHRcdFx0XHRcdGNhc2UgJ2InOlxuXHRcdFx0XHRcdGNhc2UgJ2MnOlxuXHRcdFx0XHRcdGNhc2UgJ2QnOlxuXHRcdFx0XHRcdGNhc2UgJ2UnOlxuXHRcdFx0XHRcdGNhc2UgJ2YnOlxuXHRcdFx0XHRcdGNhc2UgJ2cnOlxuXHRcdFx0XHRcdGNhc2UgJ0EnOlxuXHRcdFx0XHRcdGNhc2UgJ0InOlxuXHRcdFx0XHRcdGNhc2UgJ0MnOlxuXHRcdFx0XHRcdGNhc2UgJ0QnOlxuXHRcdFx0XHRcdGNhc2UgJ0UnOlxuXHRcdFx0XHRcdGNhc2UgJ0YnOlxuXHRcdFx0XHRcdGNhc2UgJ0cnOlxuXHRcdFx0XHRcdFx0cmV0dXJuIHtsZW46IGkrMSwgdG9rZW46IHthY2M6IGFjY1RyYW5zbGF0aW9uW2FjY10sIG5vdGU6IHN0ci5jaGFyQXQoaSl9fTtcblx0XHRcdFx0XHRkZWZhdWx0OlxuXHRcdFx0XHRcdFx0cmV0dXJuIHtsZW46IDIsIHdhcm46ICdFeHBlY3RlZCBub3RlIG5hbWUgYWZ0ZXIgYWNjaWRlbnRhbCd9O1xuXHRcdFx0XHR9XG5cdFx0XHRcdGJyZWFrO1xuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0cmV0dXJuIHtsZW46IDEsIHdhcm46ICdFeHBlY3RlZCBub3RlIG5hbWUgYWZ0ZXIgYWNjaWRlbnRhbCd9O1xuXHRcdH1cblx0fTtcblxuXHR0aGlzLmlzV2hpdGVTcGFjZSA9IGZ1bmN0aW9uKGNoKSB7XG5cdFx0cmV0dXJuIGNoID09PSAnICcgfHwgY2ggPT09ICdcXHQnIHx8IGNoID09PSAnXFx4MTInO1xuXHR9O1xuXG5cdHRoaXMuZ2V0TWVhdCA9IGZ1bmN0aW9uKGxpbmUsIHN0YXJ0LCBlbmQpIHtcblx0XHQvLyBUaGlzIHJlbW92ZXMgYW55IGNvbW1lbnRzIHN0YXJ0aW5nIHdpdGggJyUnIGFuZCB0cmltcyB0aGUgZW5kcyBvZiB0aGUgc3RyaW5nIHNvIHRoYXQgdGhlcmUgYXJlIG5vIGxlYWRpbmcgb3IgdHJhaWxpbmcgc3BhY2VzLlxuXHRcdC8vIGl0IHJldHVybnMganVzdCB0aGUgc3RhcnQgYW5kIGVuZCBjaGFyYWN0ZXJzIHRoYXQgY29udGFpbiB0aGUgbWVhdC5cblx0XHR2YXIgY29tbWVudCA9IGxpbmUuaW5kZXhPZignJScsIHN0YXJ0KTtcblx0XHRpZiAoY29tbWVudCA+PSAwICYmIGNvbW1lbnQgPCBlbmQpXG5cdFx0XHRlbmQgPSBjb21tZW50O1xuXHRcdHdoaWxlIChzdGFydCA8IGVuZCAmJiAobGluZS5jaGFyQXQoc3RhcnQpID09PSAnICcgfHwgbGluZS5jaGFyQXQoc3RhcnQpID09PSAnXFx0JyB8fCBsaW5lLmNoYXJBdChzdGFydCkgPT09ICdcXHgxMicpKVxuXHRcdFx0c3RhcnQrKztcblx0XHR3aGlsZSAoc3RhcnQgPCBlbmQgJiYgKGxpbmUuY2hhckF0KGVuZC0xKSA9PT0gJyAnIHx8IGxpbmUuY2hhckF0KGVuZC0xKSA9PT0gJ1xcdCcgfHwgbGluZS5jaGFyQXQoZW5kLTEpID09PSAnXFx4MTInKSlcblx0XHRcdGVuZC0tO1xuXHRcdHJldHVybiB7c3RhcnQ6IHN0YXJ0LCBlbmQ6IGVuZH07XG5cdH07XG5cblx0dmFyIGlzTGV0dGVyID0gZnVuY3Rpb24oY2gpIHtcblx0XHRyZXR1cm4gKGNoID49ICdBJyAmJiBjaCA8PSAnWicpIHx8IChjaCA+PSAnYScgJiYgY2ggPD0gJ3onKTtcblx0fTtcblxuXHR2YXIgaXNOdW1iZXIgPSBmdW5jdGlvbihjaCkge1xuXHRcdHJldHVybiAoY2ggPj0gJzAnICYmIGNoIDw9ICc5Jyk7XG5cdH07XG5cblx0dGhpcy50b2tlbml6ZSA9IGZ1bmN0aW9uKGxpbmUsIHN0YXJ0LCBlbmQsIGFscGhhVW50aWxXaGl0ZVNwYWNlKSB7XG5cdFx0Ly8gdGhpcyByZXR1cm5zIGFsbCB0aGUgdG9rZW5zIGluc2lkZSB0aGUgcGFzc2VkIHN0cmluZy4gQSB0b2tlbiBpcyBhIHB1bmN0dWF0aW9uIG1hcmssIGEgc3RyaW5nIG9mIGRpZ2l0cywgYSBzdHJpbmcgb2YgbGV0dGVycy5cblx0XHQvLyAgUXVvdGVkIHN0cmluZ3MgYXJlIG9uZSB0b2tlbi5cblx0XHQvLyAgSWYgdGhlcmUgaXMgYSBtaW51cyBzaWduIG5leHQgdG8gYSBudW1iZXIsIHRoZW4gaXQgaXMgaW5jbHVkZWQgaW4gdGhlIG51bWJlci5cblx0XHQvLyBJZiB0aGVyZSBpcyBhIHBlcmlvZCBpbW1lZGlhdGVseSBhZnRlciBhIG51bWJlciwgd2l0aCBhIG51bWJlciBpbW1lZGlhdGVseSBmb2xsb3dpbmcsIHRoZW4gYSBmbG9hdCBpcyByZXR1cm5lZC5cblx0XHQvLyBUaGUgdHlwZSBvZiB0b2tlbiBpcyByZXR1cm5lZDogcXVvdGUsIGFscGhhLCBudW1iZXIsIHB1bmN0XG5cdFx0Ly8gSWYgYWxwaGFVbnRpbFdoaXRlU3BhY2UgaXMgdHJ1ZSwgdGhlbiB0aGUgYmVoYXZpb3Igb2YgdGhlIGFscGhhIHRva2VuIGNoYW5nZXMuXG5cblx0XHR2YXIgcmV0ID0gdGhpcy5nZXRNZWF0KGxpbmUsIHN0YXJ0LCBlbmQpO1xuXHRcdHN0YXJ0ID0gcmV0LnN0YXJ0O1xuXHRcdGVuZCA9IHJldC5lbmQ7XG5cdFx0dmFyIHRva2VucyA9IFtdO1xuXHRcdHZhciBpO1xuXHRcdHdoaWxlIChzdGFydCA8IGVuZCkge1xuXHRcdFx0aWYgKGxpbmUuY2hhckF0KHN0YXJ0KSA9PT0gJ1wiJykge1xuXHRcdFx0XHRpID0gc3RhcnQrMTtcblx0XHRcdFx0d2hpbGUgKGkgPCBlbmQgJiYgbGluZS5jaGFyQXQoaSkgIT09ICdcIicpIGkrKztcblx0XHRcdFx0dG9rZW5zLnB1c2goeyB0eXBlOiAncXVvdGUnLCB0b2tlbjogbGluZS5zdWJzdHJpbmcoc3RhcnQrMSwgaSksIHN0YXJ0OiBzdGFydCsxLCBlbmQ6IGl9KTtcblx0XHRcdFx0aSsrO1xuXHRcdFx0fSBlbHNlIGlmIChpc0xldHRlcihsaW5lLmNoYXJBdChzdGFydCkpKSB7XG5cdFx0XHRcdGkgPSBzdGFydCsxO1xuXHRcdFx0XHRpZiAoYWxwaGFVbnRpbFdoaXRlU3BhY2UpXG5cdFx0XHRcdFx0d2hpbGUgKGkgPCBlbmQgJiYgIXRoaXMuaXNXaGl0ZVNwYWNlKGxpbmUuY2hhckF0KGkpKSkgaSsrO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0d2hpbGUgKGkgPCBlbmQgJiYgaXNMZXR0ZXIobGluZS5jaGFyQXQoaSkpKSBpKys7XG5cdFx0XHRcdHRva2Vucy5wdXNoKHsgdHlwZTogJ2FscGhhJywgdG9rZW46IGxpbmUuc3Vic3RyaW5nKHN0YXJ0LCBpKSwgY29udGludWVJZDogaXNOdW1iZXIobGluZS5jaGFyQXQoaSkpLCBzdGFydDogc3RhcnQsIGVuZDogaX0pO1xuXHRcdFx0XHRzdGFydCA9IGkgKyAxO1xuXHRcdFx0fSBlbHNlIGlmIChsaW5lLmNoYXJBdChzdGFydCkgPT09ICcuJyAmJiBpc051bWJlcihsaW5lLmNoYXJBdChpKzEpKSkge1xuXHRcdFx0XHRpID0gc3RhcnQrMTtcblx0XHRcdFx0dmFyIGludDIgPSBudWxsO1xuXHRcdFx0XHR2YXIgZmxvYXQyID0gbnVsbDtcblx0XHRcdFx0d2hpbGUgKGkgPCBlbmQgJiYgaXNOdW1iZXIobGluZS5jaGFyQXQoaSkpKSBpKys7XG5cblx0XHRcdFx0ZmxvYXQyID0gcGFyc2VGbG9hdChsaW5lLnN1YnN0cmluZyhzdGFydCwgaSkpO1xuXHRcdFx0XHR0b2tlbnMucHVzaCh7IHR5cGU6ICdudW1iZXInLCB0b2tlbjogbGluZS5zdWJzdHJpbmcoc3RhcnQsIGkpLCBpbnR0OiBpbnQyLCBmbG9hdHQ6IGZsb2F0MiwgY29udGludWVJZDogaXNMZXR0ZXIobGluZS5jaGFyQXQoaSkpLCBzdGFydDogc3RhcnQsIGVuZDogaX0pO1xuXHRcdFx0XHRzdGFydCA9IGkgKyAxO1xuXHRcdFx0fSBlbHNlIGlmIChpc051bWJlcihsaW5lLmNoYXJBdChzdGFydCkpIHx8IChsaW5lLmNoYXJBdChzdGFydCkgPT09ICctJyAmJiBpc051bWJlcihsaW5lLmNoYXJBdChpKzEpKSkpIHtcblx0XHRcdFx0aSA9IHN0YXJ0KzE7XG5cdFx0XHRcdHZhciBpbnR0ID0gbnVsbDtcblx0XHRcdFx0dmFyIGZsb2F0dCA9IG51bGw7XG5cdFx0XHRcdHdoaWxlIChpIDwgZW5kICYmIGlzTnVtYmVyKGxpbmUuY2hhckF0KGkpKSkgaSsrO1xuXHRcdFx0XHRpZiAobGluZS5jaGFyQXQoaSkgPT09ICcuJyAmJiBpc051bWJlcihsaW5lLmNoYXJBdChpKzEpKSkge1xuXHRcdFx0XHRcdGkrKztcblx0XHRcdFx0XHR3aGlsZSAoaSA8IGVuZCAmJiBpc051bWJlcihsaW5lLmNoYXJBdChpKSkpIGkrKztcblx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0aW50dCA9IHBhcnNlSW50KGxpbmUuc3Vic3RyaW5nKHN0YXJ0LCBpKSk7XG5cblx0XHRcdFx0ZmxvYXR0ID0gcGFyc2VGbG9hdChsaW5lLnN1YnN0cmluZyhzdGFydCwgaSkpO1xuXHRcdFx0XHR0b2tlbnMucHVzaCh7IHR5cGU6ICdudW1iZXInLCB0b2tlbjogbGluZS5zdWJzdHJpbmcoc3RhcnQsIGkpLCBpbnR0OiBpbnR0LCBmbG9hdHQ6IGZsb2F0dCwgY29udGludWVJZDogaXNMZXR0ZXIobGluZS5jaGFyQXQoaSkpLCBzdGFydDogc3RhcnQsIGVuZDogaX0pO1xuXHRcdFx0XHRzdGFydCA9IGkgKyAxO1xuXHRcdFx0fSBlbHNlIGlmIChsaW5lLmNoYXJBdChzdGFydCkgPT09ICcgJyB8fCBsaW5lLmNoYXJBdChzdGFydCkgPT09ICdcXHQnKSB7XG5cdFx0XHRcdGkgPSBzdGFydCsxO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dG9rZW5zLnB1c2goeyB0eXBlOiAncHVuY3QnLCB0b2tlbjogbGluZS5jaGFyQXQoc3RhcnQpLCBzdGFydDogc3RhcnQsIGVuZDogc3RhcnQrMX0pO1xuXHRcdFx0XHRpID0gc3RhcnQrMTtcblx0XHRcdH1cblx0XHRcdHN0YXJ0ID0gaTtcblx0XHR9XG5cdFx0cmV0dXJuIHRva2Vucztcblx0fTtcblxuXHR0aGlzLmdldFZvaWNlVG9rZW4gPSBmdW5jdGlvbihsaW5lLCBzdGFydCwgZW5kKSB7XG5cdFx0Ly8gVGhpcyBmaW5kcyB0aGUgbmV4dCB0b2tlbi4gQSB0b2tlbiBpcyBkZWxpbWl0ZWQgYnkgYSBzcGFjZSBvciBhbiBlcXVhbCBzaWduLiBJZiBpdCBzdGFydHMgd2l0aCBhIHF1b3RlLCB0aGVuIHRoZSBwb3J0aW9uIGJldHdlZW4gdGhlIHF1b3RlcyBpcyByZXR1cm5lZC5cblx0XHR2YXIgaSA9IHN0YXJ0O1xuXHRcdHdoaWxlIChpIDwgZW5kICYmIHRoaXMuaXNXaGl0ZVNwYWNlKGxpbmUuY2hhckF0KGkpKSB8fCBsaW5lLmNoYXJBdChpKSA9PT0gJz0nKVxuXHRcdFx0aSsrO1xuXG5cdFx0aWYgKGxpbmUuY2hhckF0KGkpID09PSAnXCInKSB7XG5cdFx0XHR2YXIgY2xvc2UgPSBsaW5lLmluZGV4T2YoJ1wiJywgaSsxKTtcblx0XHRcdGlmIChjbG9zZSA9PT0gLTEgfHwgY2xvc2UgPj0gZW5kKVxuXHRcdFx0XHRyZXR1cm4ge2xlbjogMSwgZXJyOiBcIk1pc3NpbmcgY2xvc2UgcXVvdGVcIn07XG5cdFx0XHRyZXR1cm4ge2xlbjogY2xvc2Utc3RhcnQrMSwgdG9rZW46IHRoaXMudHJhbnNsYXRlU3RyaW5nKGxpbmUuc3Vic3RyaW5nKGkrMSwgY2xvc2UpKX07XG5cdFx0fSBlbHNlIHtcblx0XHRcdHZhciBpaSA9IGk7XG5cdFx0XHR3aGlsZSAoaWkgPCBlbmQgJiYgIXRoaXMuaXNXaGl0ZVNwYWNlKGxpbmUuY2hhckF0KGlpKSkgJiYgbGluZS5jaGFyQXQoaWkpICE9PSAnPScpXG5cdFx0XHRcdGlpKys7XG5cdFx0XHRyZXR1cm4ge2xlbjogaWktc3RhcnQrMSwgdG9rZW46IGxpbmUuc3Vic3RyaW5nKGksIGlpKX07XG5cdFx0fVxuXHR9O1xuXG5cdHZhciBjaGFyTWFwID0ge1xuXHRcdFwiYGFcIjogJ8OgJywgXCInYVwiOiBcIsOhXCIsIFwiXmFcIjogXCLDolwiLCBcIn5hXCI6IFwiw6NcIiwgXCJcXFwiYVwiOiBcIsOkXCIsIFwib2FcIjogXCLDpVwiLCBcImFhXCI6IFwiw6VcIiwgXCI9YVwiOiBcIsSBXCIsIFwidWFcIjogXCLEg1wiLCBcIjthXCI6IFwixIVcIixcblx0XHRcImBlXCI6ICfDqCcsIFwiJ2VcIjogXCLDqVwiLCBcIl5lXCI6IFwiw6pcIiwgXCJcXFwiZVwiOiBcIsOrXCIsIFwiPWVcIjogXCLEk1wiLCBcInVlXCI6IFwixJVcIiwgXCI7ZVwiOiBcIsSZXCIsIFwiLmVcIjogXCLEl1wiLFxuXHRcdFwiYGlcIjogJ8OsJywgXCInaVwiOiBcIsOtXCIsIFwiXmlcIjogXCLDrlwiLCBcIlxcXCJpXCI6IFwiw69cIiwgXCI9aVwiOiBcIsSrXCIsIFwidWlcIjogXCLErVwiLCBcIjtpXCI6IFwixK9cIixcblx0XHRcImBvXCI6ICfDsicsIFwiJ29cIjogXCLDs1wiLCBcIl5vXCI6IFwiw7RcIiwgXCJ+b1wiOiBcIsO1XCIsIFwiXFxcIm9cIjogXCLDtlwiLCBcIj1vXCI6IFwixY1cIiwgXCJ1b1wiOiBcIsWPXCIsIFwiL29cIjogXCLDuFwiLFxuXHRcdFwiYHVcIjogJ8O5JywgXCIndVwiOiBcIsO6XCIsIFwiXnVcIjogXCLDu1wiLCBcIn51XCI6IFwixalcIiwgXCJcXFwidVwiOiBcIsO8XCIsIFwib3VcIjogXCLFr1wiLCBcIj11XCI6IFwixatcIiwgXCJ1dVwiOiBcIsWtXCIsIFwiO3VcIjogXCLFs1wiLFxuXHRcdFwiYEFcIjogJ8OAJywgXCInQVwiOiBcIsOBXCIsIFwiXkFcIjogXCLDglwiLCBcIn5BXCI6IFwiw4NcIiwgXCJcXFwiQVwiOiBcIsOEXCIsIFwib0FcIjogXCLDhVwiLCBcIkFBXCI6IFwiw4VcIiwgXCI9QVwiOiBcIsSAXCIsIFwidUFcIjogXCLEglwiLCBcIjtBXCI6IFwixIRcIixcblx0XHRcImBFXCI6ICfDiCcsIFwiJ0VcIjogXCLDiVwiLCBcIl5FXCI6IFwiw4pcIiwgXCJcXFwiRVwiOiBcIsOLXCIsIFwiPUVcIjogXCLEklwiLCBcInVFXCI6IFwixJRcIiwgXCI7RVwiOiBcIsSYXCIsIFwiLkVcIjogXCLEllwiLFxuXHRcdFwiYElcIjogJ8OMJywgXCInSVwiOiBcIsONXCIsIFwiXklcIjogXCLDjlwiLCBcIn5JXCI6IFwixKhcIiwgXCJcXFwiSVwiOiBcIsOPXCIsIFwiPUlcIjogXCLEqlwiLCBcInVJXCI6IFwixKxcIiwgXCI7SVwiOiBcIsSuXCIsIFwiLklcIjogXCLEsFwiLFxuXHRcdFwiYE9cIjogJ8OSJywgXCInT1wiOiBcIsOTXCIsIFwiXk9cIjogXCLDlFwiLCBcIn5PXCI6IFwiw5VcIiwgXCJcXFwiT1wiOiBcIsOWXCIsIFwiPU9cIjogXCLFjFwiLCBcInVPXCI6IFwixY5cIiwgXCIvT1wiOiBcIsOYXCIsXG5cdFx0XCJgVVwiOiAnw5knLCBcIidVXCI6IFwiw5pcIiwgXCJeVVwiOiBcIsObXCIsIFwiflVcIjogXCLFqFwiLCBcIlxcXCJVXCI6IFwiw5xcIiwgXCJvVVwiOiBcIsWuXCIsIFwiPVVcIjogXCLFqlwiLCBcInVVXCI6IFwixaxcIiwgXCI7VVwiOiBcIsWyXCIsXG5cdFx0XCJhZVwiOiBcIsOmXCIsIFwiQUVcIjogXCLDhlwiLCBcIm9lXCI6IFwixZNcIiwgXCJPRVwiOiBcIsWSXCIsIFwic3NcIjogXCLDn1wiLFxuXHRcdFwiJ2NcIjogXCLEh1wiLCBcIl5jXCI6IFwixIlcIiwgXCJ1Y1wiOiBcIsSNXCIsIFwiY2NcIjogXCLDp1wiLCBcIi5jXCI6IFwixItcIiwgXCJjQ1wiOiBcIsOHXCIsIFwiJ0NcIjogXCLEhlwiLCBcIl5DXCI6IFwixIhcIiwgXCJ1Q1wiOiBcIsSMXCIsIFwiLkNcIjogXCLEilwiLFxuXHRcdFwifk5cIjogXCLDkVwiLCBcIn5uXCI6IFwiw7FcIixcblx0XHRcIj1zXCI6IFwixaFcIiwgXCJ2c1wiOiBcIsWhXCIsXG5cdFx0XCJESFwiOiBcIsOQXCIsIFwiZGhcIjogXCLDsFwiLFxuXHRcdFwiSE9cIjogXCLFkFwiLCBcIkhvXCI6IFwixZFcIiwgXCJIVVwiOiBcIsWwXCIsIFwiSHVcIjogXCLFsVwiLFxuXHRcdFwiJ1lcIjogXCLDnVwiLCBcIid5XCI6IFwiw71cIiwgXCJeWVwiOiBcIsW2XCIsIFwiXnlcIjogXCLFt1wiLCBcIlxcXCJZXCI6IFwixbhcIiwgXCJcXFwieVwiOiBcIsO/XCIsXG5cdFx0XCJ2U1wiOiBcIsWgXCIsIFwidlpcIjogXCLFvVwiLCBcInZ6XCI6ICfFvidcblxuLy8gTW9yZSBjaGFyczogxLIgxLMgxI4gxI8gxJAgxJEgxJwgxJ0gxJ4gxJ8gxKAgxKEgxKIgxKMgxKQgxKUgxKYgxKcgxLQgxLUgxLYgxLcgxLggxLkgxLogxLsgxLwgxL0gxL4gxL8gxYAgxYEgxYIgxYMgxYQgxYUgxYYgxYcgxYggxYkgxYogxYsgxZQgxZUgxZYgxZcgxZggxZkgxZogxZsgxZwgxZ0gxZ4gxZ8gxaAgxaIgxaMgxaQgxaUgxaYgxacgxbQgxbUgxbkgxbogxbsgxbwgxb1cblx0fTtcblx0dmFyIGNoYXJNYXAxID0ge1xuXHRcdFwiI1wiOiBcIuKZr1wiLFxuXHRcdFwiYlwiOiBcIuKZrVwiLFxuXHRcdFwiPVwiOiBcIuKZrlwiXG5cdH07XG5cdHZhciBjaGFyTWFwMiA9IHtcblx0XHRcIjIwMVwiOiBcIuKZr1wiLFxuXHRcdFwiMjAyXCI6IFwi4pmtXCIsXG5cdFx0XCIyMDNcIjogXCLima5cIixcblx0XHRcIjI0MVwiOiBcIsKhXCIsXG5cdFx0XCIyNDJcIjogXCLColwiLCBcIjI1MlwiOiBcImFcIiwgXCIyNjJcIjogXCIyXCIsIFwiMjcyXCI6IFwib1wiLCBcIjMwMlwiOiBcIsOCXCIsIFwiMzEyXCI6IFwiw4pcIiwgXCIzMjJcIjogXCLDklwiLCBcIjMzMlwiOiBcIsOaXCIsIFwiMzQyXCI6IFwiw6JcIiwgXCIzNTJcIjogXCLDqlwiLCBcIjM2MlwiOiBcIsOyXCIsIFwiMzcyXCI6IFwiw7pcIixcblx0XHRcIjI0M1wiOiBcIsKjXCIsIFwiMjUzXCI6IFwiwqtcIiwgXCIyNjNcIjogXCIzXCIsIFwiMjczXCI6IFwiwrtcIiwgXCIzMDNcIjogXCLDg1wiLCBcIjMxM1wiOiBcIsOLXCIsIFwiMzIzXCI6IFwiw5NcIiwgXCIzMzNcIjogXCLDm1wiLCBcIjM0M1wiOiBcIsOjXCIsIFwiMzUzXCI6IFwiw6tcIiwgXCIzNjNcIjogXCLDs1wiLCBcIjM3M1wiOiBcIsO7XCIsXG5cdFx0XCIyNDRcIjogXCLCpFwiLCBcIjI1NFwiOiBcIsKsXCIsIFwiMjY0XCI6IFwiICDMgVwiLCBcIjI3NFwiOiBcIjHigYQ0XCIsIFwiMzA0XCI6IFwiw4RcIiwgXCIzMTRcIjogXCLDjFwiLCBcIjMyNFwiOiBcIsOUXCIsIFwiMzM0XCI6IFwiw5xcIiwgXCIzNDRcIjogXCLDpFwiLCBcIjM1NFwiOiBcIsOsXCIsIFwiMzY0XCI6IFwiw7RcIiwgXCIzNzRcIjogXCLDvFwiLFxuXHRcdFwiMjQ1XCI6IFwiwqVcIiwgXCIyNTVcIjogXCItXCIsIFwiMjY1XCI6IFwizrxcIiwgXCIyNzVcIjogXCIx4oGEMlwiLCBcIjMwNVwiOiBcIsOFXCIsIFwiMzE1XCI6IFwiw41cIiwgXCIzMjVcIjogXCLDlVwiLCBcIjMzNVwiOiBcIsOdXCIsICBcIjM0NVwiOiBcIsOlXCIsIFwiMzU1XCI6IFwiw61cIiwgXCIzNjVcIjogXCLDtVwiLCBcIjM3NVwiOiBcIsO9XCIsXG5cdFx0XCIyNDZcIjogXCLCplwiLCBcIjI1NlwiOiBcIsKuXCIsIFwiMjY2XCI6IFwiwrZcIiwgXCIyNzZcIjogXCIz4oGENFwiLCBcIjMwNlwiOiBcIsOGXCIsIFwiMzE2XCI6IFwiw45cIiwgXCIzMjZcIjogXCLDllwiLCBcIjMzNlwiOiBcIsOeXCIsIFwiMzQ2XCI6IFwiw6ZcIiwgXCIzNTZcIjogXCLDrlwiLCBcIjM2NlwiOiBcIsO2XCIsIFwiMzc2XCI6IFwiw75cIixcblx0XHRcIjI0N1wiOiBcIsKnXCIsIFwiMjU3XCI6IFwiIMyEXCIsIFwiMjY3XCI6IFwiwrdcIiwgXCIyNzdcIjogXCLCv1wiLCBcIjMwN1wiOiBcIsOHXCIsIFwiMzE3XCI6IFwiw49cIiwgXCIzMjdcIjogXCLDl1wiLCBcIjMzN1wiOiBcIsOfXCIsIFwiMzQ3XCI6IFwiw6dcIiwgXCIzNTdcIjogXCLDr1wiLCBcIjM2N1wiOiBcIsO3XCIsIFwiMzc3XCI6IFwiw79cIixcblx0XHRcIjI1MFwiOiBcIiDMiFwiLCBcIjI2MFwiOiBcIsKwXCIsIFwiMjcwXCI6IFwiIMynXCIsIFwiMzAwXCI6IFwiw4BcIiwgXCIzMTBcIjogXCLDiFwiLCBcIjMyMFwiOiBcIsOQXCIsIFwiMzMwXCI6IFwiw5hcIiwgXCIzNDBcIjogXCLDoFwiLCBcIjM1MFwiOiBcIsOoXCIsIFwiMzYwXCI6IFwiw7BcIiwgXCIzNzBcIjogXCLDuFwiLFxuXHRcdFwiMjUxXCI6IFwiwqlcIiwgXCIyNjFcIjogXCLCsVwiLCBcIjI3MVwiOiBcIjFcIiwgXCIzMDFcIjogXCLDgVwiLCBcIjMxMVwiOiBcIsOJXCIsIFwiMzIxXCI6IFwiw5FcIiwgXCIzMzFcIjogXCLDmVwiLCBcIjM0MVwiOiBcIsOhXCIsIFwiMzUxXCI6IFwiw6lcIiwgXCIzNjFcIjogXCLDsVwiLCBcIjM3MVwiOiBcIsO5XCIgfTtcblx0dGhpcy50cmFuc2xhdGVTdHJpbmcgPSBmdW5jdGlvbihzdHIpIHtcblx0XHR2YXIgYXJyID0gc3RyLnNwbGl0KCdcXFxcJyk7XG5cdFx0aWYgKGFyci5sZW5ndGggPT09IDEpIHJldHVybiBzdHI7XG5cdFx0dmFyIG91dCA9IG51bGw7XG5cdFx0cGFyc2VDb21tb24uZWFjaChhcnIsIGZ1bmN0aW9uKHMpIHtcblx0XHRcdGlmIChvdXQgPT09IG51bGwpXG5cdFx0XHRcdG91dCA9IHM7XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0dmFyIGMgPSBjaGFyTWFwW3Muc3Vic3RyaW5nKDAsIDIpXTtcblx0XHRcdFx0aWYgKGMgIT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRvdXQgKz0gYyArIHMuc3Vic3RyaW5nKDIpO1xuXHRcdFx0XHRlbHNlIHtcblx0XHRcdFx0XHRjID0gY2hhck1hcDJbcy5zdWJzdHJpbmcoMCwgMyldO1xuXHRcdFx0XHRcdGlmIChjICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRvdXQgKz0gYyArIHMuc3Vic3RyaW5nKDMpO1xuXHRcdFx0XHRcdGVsc2Uge1xuXHRcdFx0XHRcdFx0YyA9IGNoYXJNYXAxW3Muc3Vic3RyaW5nKDAsIDEpXTtcblx0XHRcdFx0XHRcdGlmIChjICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0XHRcdG91dCArPSBjICsgcy5zdWJzdHJpbmcoMSk7XG5cdFx0XHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0XHRcdG91dCArPSBcIlxcXFxcIiArIHM7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIG91dDtcblx0fTtcblx0dGhpcy5nZXROdW1iZXIgPSBmdW5jdGlvbihsaW5lLCBpbmRleCkge1xuXHRcdHZhciBudW0gPSAwO1xuXHRcdHdoaWxlIChpbmRleCA8IGxpbmUubGVuZ3RoKSB7XG5cdFx0XHRzd2l0Y2ggKGxpbmUuY2hhckF0KGluZGV4KSkge1xuXHRcdFx0XHRjYXNlICcwJzpudW0gPSBudW0qMTA7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnMSc6bnVtID0gbnVtKjEwKzE7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnMic6bnVtID0gbnVtKjEwKzI7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnMyc6bnVtID0gbnVtKjEwKzM7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnNCc6bnVtID0gbnVtKjEwKzQ7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnNSc6bnVtID0gbnVtKjEwKzU7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnNic6bnVtID0gbnVtKjEwKzY7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnNyc6bnVtID0gbnVtKjEwKzc7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnOCc6bnVtID0gbnVtKjEwKzg7aW5kZXgrKzticmVhaztcblx0XHRcdFx0Y2FzZSAnOSc6bnVtID0gbnVtKjEwKzk7aW5kZXgrKzticmVhaztcblx0XHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0XHRyZXR1cm4ge251bTogbnVtLCBpbmRleDogaW5kZXh9O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4ge251bTogbnVtLCBpbmRleDogaW5kZXh9O1xuXHR9O1xuXG5cdHRoaXMuZ2V0RnJhY3Rpb24gPSBmdW5jdGlvbihsaW5lLCBpbmRleCkge1xuXHRcdHZhciBudW0gPSAxO1xuXHRcdHZhciBkZW4gPSAxO1xuXHRcdGlmIChsaW5lLmNoYXJBdChpbmRleCkgIT09ICcvJykge1xuXHRcdFx0dmFyIHJldCA9IHRoaXMuZ2V0TnVtYmVyKGxpbmUsIGluZGV4KTtcblx0XHRcdG51bSA9IHJldC5udW07XG5cdFx0XHRpbmRleCA9IHJldC5pbmRleDtcblx0XHR9XG5cdFx0aWYgKGxpbmUuY2hhckF0KGluZGV4KSA9PT0gJy8nKSB7XG5cdFx0XHRpbmRleCsrO1xuXHRcdFx0aWYgKGxpbmUuY2hhckF0KGluZGV4KSA9PT0gJy8nKSB7XG5cdFx0XHRcdHZhciBkaXYgPSAwLjU7XG5cdFx0XHRcdHdoaWxlIChsaW5lLmNoYXJBdChpbmRleCsrKSA9PT0gJy8nKVxuXHRcdFx0XHRcdGRpdiA9IGRpdiAvMjtcblx0XHRcdFx0cmV0dXJuIHt2YWx1ZTogbnVtICogZGl2LCBpbmRleDogaW5kZXgtMX07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR2YXIgaVNhdmUgPSBpbmRleDtcblx0XHRcdFx0dmFyIHJldDIgPSB0aGlzLmdldE51bWJlcihsaW5lLCBpbmRleCk7XG5cdFx0XHRcdGlmIChyZXQyLm51bSA9PT0gMCAmJiBpU2F2ZSA9PT0gaW5kZXgpXHQvLyBJZiB3ZSBkaWRuJ3QgdXNlIGFueSBjaGFyYWN0ZXJzLCBpdCBpcyBhbiBpbXBsaWVkIDJcblx0XHRcdFx0XHRyZXQyLm51bSA9IDI7XG5cdFx0XHRcdGlmIChyZXQyLm51bSAhPT0gMClcblx0XHRcdFx0XHRkZW4gPSByZXQyLm51bTtcblx0XHRcdFx0aW5kZXggPSByZXQyLmluZGV4O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiB7dmFsdWU6IG51bS9kZW4sIGluZGV4OiBpbmRleH07XG5cdH07XG5cblx0dGhpcy50aGVSZXZlcnNlciA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdGlmIChwYXJzZUNvbW1vbi5lbmRzV2l0aChzdHIsIFwiLCBUaGVcIikpXG5cdFx0XHRyZXR1cm4gXCJUaGUgXCIgKyBzdHIuc3Vic3RyaW5nKDAsIHN0ci5sZW5ndGgtNSk7XG5cdFx0aWYgKHBhcnNlQ29tbW9uLmVuZHNXaXRoKHN0ciwgXCIsIEFcIikpXG5cdFx0XHRyZXR1cm4gXCJBIFwiICsgc3RyLnN1YnN0cmluZygwLCBzdHIubGVuZ3RoLTMpO1xuXHRcdHJldHVybiBzdHI7XG5cdH07XG5cblx0dGhpcy5zdHJpcENvbW1lbnQgPSBmdW5jdGlvbihzdHIpIHtcblx0XHR2YXIgaSA9IHN0ci5pbmRleE9mKCclJyk7XG5cdFx0aWYgKGkgPj0gMClcblx0XHRcdHJldHVybiBwYXJzZUNvbW1vbi5zdHJpcChzdHIuc3Vic3RyaW5nKDAsIGkpKTtcblx0XHRyZXR1cm4gcGFyc2VDb21tb24uc3RyaXAoc3RyKTtcblx0fTtcblxuXHR0aGlzLmdldEludCA9IGZ1bmN0aW9uKHN0cikge1xuXHRcdC8vIFRoaXMgcGFyc2VzIHRoZSBiZWdpbm5pbmcgb2YgdGhlIHN0cmluZyBmb3IgYSBudW1iZXIgYW5kIHJldHVybnMgeyB2YWx1ZTogbnVtLCBkaWdpdHM6IG51bSB9XG5cdFx0Ly8gSWYgZGlnaXRzIGlzIDAsIHRoZW4gdGhlIHN0cmluZyBkaWRuJ3QgcG9pbnQgdG8gYSBudW1iZXIuXG5cdFx0dmFyIHggPSBwYXJzZUludChzdHIpO1xuXHRcdGlmIChpc05hTih4KSlcblx0XHRcdHJldHVybiB7ZGlnaXRzOiAwfTtcblx0XHR2YXIgcyA9IFwiXCIgKyB4O1xuXHRcdHZhciBpID0gc3RyLmluZGV4T2Yocyk7XHQvLyBUaGlzIGlzIHRvIGFjY291bnQgZm9yIGxlYWRpbmcgc3BhY2VzXG5cdFx0cmV0dXJuIHt2YWx1ZTogeCwgZGlnaXRzOiBpK3MubGVuZ3RofTtcblx0fTtcblxuXHR0aGlzLmdldEZsb2F0ID0gZnVuY3Rpb24oc3RyKSB7XG5cdFx0Ly8gVGhpcyBwYXJzZXMgdGhlIGJlZ2lubmluZyBvZiB0aGUgc3RyaW5nIGZvciBhIG51bWJlciBhbmQgcmV0dXJucyB7IHZhbHVlOiBudW0sIGRpZ2l0czogbnVtIH1cblx0XHQvLyBJZiBkaWdpdHMgaXMgMCwgdGhlbiB0aGUgc3RyaW5nIGRpZG4ndCBwb2ludCB0byBhIG51bWJlci5cblx0XHR2YXIgeCA9IHBhcnNlRmxvYXQoc3RyKTtcblx0XHRpZiAoaXNOYU4oeCkpXG5cdFx0XHRyZXR1cm4ge2RpZ2l0czogMH07XG5cdFx0dmFyIHMgPSBcIlwiICsgeDtcblx0XHR2YXIgaSA9IHN0ci5pbmRleE9mKHMpO1x0Ly8gVGhpcyBpcyB0byBhY2NvdW50IGZvciBsZWFkaW5nIHNwYWNlc1xuXHRcdHJldHVybiB7dmFsdWU6IHgsIGRpZ2l0czogaStzLmxlbmd0aH07XG5cdH07XG5cblx0dGhpcy5nZXRNZWFzdXJlbWVudCA9IGZ1bmN0aW9uKHRva2Vucykge1xuXHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSByZXR1cm4geyB1c2VkOiAwIH07XG5cdFx0dmFyIHVzZWQgPSAxO1xuXHRcdHZhciBudW0gPSAnJztcblx0XHRpZiAodG9rZW5zWzBdLnRva2VuID09PSAnLScpIHtcblx0XHRcdHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0bnVtID0gJy0nO1xuXHRcdFx0dXNlZCsrO1xuXHRcdH1cblx0XHRlbHNlIGlmICh0b2tlbnNbMF0udHlwZSAhPT0gJ251bWJlcicpIHJldHVybiB7IHVzZWQ6IDAgfTtcblx0XHRudW0gKz0gdG9rZW5zLnNoaWZ0KCkudG9rZW47XG5cdFx0aWYgKHRva2Vucy5sZW5ndGggPT09IDApIHJldHVybiB7IHVzZWQ6IDEsIHZhbHVlOiBwYXJzZUludChudW0pIH07XG5cdFx0dmFyIHggPSB0b2tlbnMuc2hpZnQoKTtcblx0XHRpZiAoeC50b2tlbiA9PT0gJy4nKSB7XG5cdFx0XHR1c2VkKys7XG5cdFx0XHRpZiAodG9rZW5zLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHsgdXNlZDogdXNlZCwgdmFsdWU6IHBhcnNlSW50KG51bSkgfTtcblx0XHRcdGlmICh0b2tlbnNbMF0udHlwZSA9PT0gJ251bWJlcicpIHtcblx0XHRcdFx0eCA9IHRva2Vucy5zaGlmdCgpO1xuXHRcdFx0XHRudW0gPSBudW0gKyAnLicgKyB4LnRva2VuO1xuXHRcdFx0XHR1c2VkKys7XG5cdFx0XHRcdGlmICh0b2tlbnMubGVuZ3RoID09PSAwKSByZXR1cm4geyB1c2VkOiB1c2VkLCB2YWx1ZTogcGFyc2VGbG9hdChudW0pIH07XG5cdFx0XHR9XG5cdFx0XHR4ID0gdG9rZW5zLnNoaWZ0KCk7XG5cdFx0fVxuXHRcdHN3aXRjaCAoeC50b2tlbikge1xuXHRcdFx0Y2FzZSAncHQnOiByZXR1cm4geyB1c2VkOiB1c2VkKzEsIHZhbHVlOiBwYXJzZUZsb2F0KG51bSkgfTtcblx0XHRcdGNhc2UgJ2NtJzogcmV0dXJuIHsgdXNlZDogdXNlZCsxLCB2YWx1ZTogcGFyc2VGbG9hdChudW0pLzIuNTQqNzIgfTtcblx0XHRcdGNhc2UgJ2luJzogcmV0dXJuIHsgdXNlZDogdXNlZCsxLCB2YWx1ZTogcGFyc2VGbG9hdChudW0pKjcyIH07XG5cdFx0XHRkZWZhdWx0OiB0b2tlbnMudW5zaGlmdCh4KTsgcmV0dXJuIHsgdXNlZDogdXNlZCwgdmFsdWU6IHBhcnNlRmxvYXQobnVtKSB9O1xuXHRcdH1cblx0XHRyZXR1cm4geyB1c2VkOiAwIH07XG5cdH07XG5cdHZhciBzdWJzdEluQ2hvcmQgPSBmdW5jdGlvbihzdHIpXG5cdHtcblx0XHR3aGlsZSAoIHN0ci5pbmRleE9mKFwiXFxcXG5cIikgIT09IC0xKVxuXHRcdHtcblx0XHRcdHN0ciA9IHN0ci5yZXBsYWNlKFwiXFxcXG5cIiwgXCJcXG5cIik7XG5cdFx0fVxuXHRcdHJldHVybiBzdHI7XG5cdH07XG5cdHRoaXMuZ2V0QnJhY2tldHRlZFN1YnN0cmluZyA9IGZ1bmN0aW9uKGxpbmUsIGksIG1heEVycm9yQ2hhcnMsIF9tYXRjaENoYXIpXG5cdHtcblx0XHQvLyBUaGlzIGV4dHJhY3RzIHRoZSBzdWIgc3RyaW5nIGJ5IGxvb2tpbmcgYXQgdGhlIGZpcnN0IGNoYXJhY3RlciBhbmQgc2VhcmNoaW5nIGZvciB0aGF0XG5cdFx0Ly8gY2hhcmFjdGVyIGxhdGVyIGluIHRoZSBsaW5lIChvciBzZWFyY2ggZm9yIHRoZSBvcHRpb25hbCBfbWF0Y2hDaGFyKS5cblx0XHQvLyBGb3IgaW5zdGFuY2UsIGlmIHRoZSBmaXJzdCBjaGFyYWN0ZXIgaXMgYSBxdW90ZSBpdCB3aWxsIGxvb2sgZm9yXG5cdFx0Ly8gdGhlIGVuZCBxdW90ZS4gSWYgdGhlIGVuZCBvZiB0aGUgbGluZSBpcyByZWFjaGVkLCB0aGVuIG9ubHkgdXAgdG8gdGhlIGRlZmF1bHQgbnVtYmVyXG5cdFx0Ly8gb2YgY2hhcmFjdGVycyBhcmUgcmV0dXJuZWQsIHNvIHRoYXQgYSBtaXNzaW5nIGVuZCBxdW90ZSB3b24ndCBlYXQgdXAgdGhlIGVudGlyZSBsaW5lLlxuXHRcdC8vIEl0IHJldHVybnMgdGhlIHN1YnN0cmluZyBhbmQgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGNvbnN1bWVkLlxuXHRcdC8vIFRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBjb25zdW1lZCBpcyBub3JtYWxseSB0d28gbW9yZSB0aGFuIHRoZSBzaXplIG9mIHRoZSBzdWJzdHJpbmcsXG5cdFx0Ly8gYnV0IGluIHRoZSBlcnJvciBjYXNlIGl0IG1pZ2h0IG5vdCBiZS5cblx0XHR2YXIgbWF0Y2hDaGFyID0gX21hdGNoQ2hhciB8fCBsaW5lLmNoYXJBdChpKTtcblx0XHR2YXIgcG9zID0gaSsxO1xuXHRcdHdoaWxlICgocG9zIDwgbGluZS5sZW5ndGgpICYmIChsaW5lLmNoYXJBdChwb3MpICE9PSBtYXRjaENoYXIpKVxuXHRcdFx0Kytwb3M7XG5cdFx0aWYgKGxpbmUuY2hhckF0KHBvcykgPT09IG1hdGNoQ2hhcilcblx0XHRcdHJldHVybiBbcG9zLWkrMSxzdWJzdEluQ2hvcmQobGluZS5zdWJzdHJpbmcoaSsxLCBwb3MpKSwgdHJ1ZV07XG5cdFx0ZWxzZVx0Ly8gd2UgaGl0IHRoZSBlbmQgb2YgbGluZSwgc28gd2UnbGwganVzdCBwaWNrIGFuIGFyYml0cmFyeSBudW0gb2YgY2hhcnMgc28gdGhlIGxpbmUgZG9lc24ndCBkaXNhcHBlYXIuXG5cdFx0e1xuXHRcdFx0cG9zID0gaSttYXhFcnJvckNoYXJzO1xuXHRcdFx0aWYgKHBvcyA+IGxpbmUubGVuZ3RoLTEpXG5cdFx0XHRcdHBvcyA9IGxpbmUubGVuZ3RoLTE7XG5cdFx0XHRyZXR1cm4gW3Bvcy1pKzEsIHN1YnN0SW5DaG9yZChsaW5lLnN1YnN0cmluZyhpKzEsIHBvcykpLCBmYWxzZV07XG5cdFx0fVxuXHR9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUb2tlbml6ZXI7XG4iLCIvLyAgICBhYmNfdHJhbnNwb3NlLmpzOiBIYW5kbGVzIHRoZSBhdXRvbWF0aWMgdHJhbnNwb3NpdGlvbiBvZiBrZXkgc2lnbmF0dXJlcywgY2hvcmQgc3ltYm9scywgYW5kIG5vdGVzLlxuLy8gICAgQ29weXJpZ2h0IChDKSAyMDEwLTIwMTggUGF1bCBSb3NlbiAocGF1bCBhdCBwYXVscm9zZW4gZG90IG5ldClcbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHRyYW5zcG9zZSA9IHt9O1xuXG52YXIga2V5SW5kZXggPSB7XG5cdCdDJzogMCxcblx0J0MjJzogMSxcblx0J0RiJzogMSxcblx0J0QnOiAyLFxuXHQnRCMnOiAzLFxuXHQnRWInOiAzLFxuXHQnRSc6IDQsXG5cdCdGJzogNSxcblx0J0YjJzogNixcblx0J0diJzogNixcblx0J0cnOiA3LFxuXHQnRyMnOiA4LFxuXHQnQWInOiA4LFxuXHQnQSc6IDksXG5cdCdBIyc6IDEwLFxuXHQnQmInOiAxMCxcblx0J0InOiAxMVxufTtcbnZhciBuZXdLZXkgPSBbJ0MnLCAnRGInLCAnRCcsICdFYicsICdFJywgJ0YnLCAnRiMnLCAnRycsICdBYicsICdBJywgJ0JiJywgJ0InXTtcbnZhciBuZXdLZXlNaW5vciA9IFsnQycsICdDIycsICdEJywgJ0QjJywgJ0UnLCAnRicsICdGIycsICdHJywgJ0cjJywgJ0EnLCAnQmInLCAnQiddO1xuXG50cmFuc3Bvc2Uua2V5U2lnbmF0dXJlID0gZnVuY3Rpb24obXVsdGlsaW5lVmFycywga2V5cywga2V5TmFtZSwgcm9vdCwgYWNjLCBsb2NhbFRyYW5zcG9zZSkge1xuXHRpZiAoIWxvY2FsVHJhbnNwb3NlKSBsb2NhbFRyYW5zcG9zZSA9IDA7XG5cdG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2VWZXJ0aWNhbE1vdmVtZW50ID0gMDtcblx0bXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZVByZWZlckZsYXRzID0gZmFsc2U7XG5cdHZhciBrID0ga2V5c1trZXlOYW1lXTtcblx0aWYgKCFrKSByZXR1cm4gbXVsdGlsaW5lVmFycy5rZXk7IC8vIElmIHRoZSBrZXkgaXNuJ3QgaW4gdGhlIGxpc3QsIGl0IGlzIG5vbi1zdGFuZGFyZC4gV2Ugd29uJ3QgYXR0ZW1wdCB0byB0cmFuc3Bvc2UgaXQuXG5cdG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2UgPSAobXVsdGlsaW5lVmFycy5nbG9iYWxUcmFuc3Bvc2UgPyBtdWx0aWxpbmVWYXJzLmdsb2JhbFRyYW5zcG9zZSA6IDApICsgbG9jYWxUcmFuc3Bvc2U7XG5cblx0aWYgKCFtdWx0aWxpbmVWYXJzLmxvY2FsVHJhbnNwb3NlKVxuXHRcdHJldHVybiB7IGFjY2lkZW50YWxzOiBrLCByb290OiByb290LCBhY2M6IGFjYyB9O1xuXHRtdWx0aWxpbmVWYXJzLmdsb2JhbFRyYW5zcG9zZU9yaWdLZXlTaWcgPSBrO1xuXHRpZiAobXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZSAlIDEyID09PSAwKSB7XG5cdFx0bXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZVZlcnRpY2FsTW92ZW1lbnQgPSAobXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZSAvIDEyKSAqIDc7XG5cdFx0cmV0dXJuIHsgYWNjaWRlbnRhbHM6IGssIHJvb3Q6IHJvb3QsIGFjYzogYWNjIH07XG5cdH1cblxuXHR2YXIgYmFzZUtleSA9IGtleU5hbWVbMF07XG5cdGlmIChrZXlOYW1lWzFdID09PSAnYicgfHwga2V5TmFtZVsxXSA9PT0gJyMnKSB7XG5cdFx0YmFzZUtleSArPSBrZXlOYW1lWzFdO1xuXHRcdGtleU5hbWUgPSBrZXlOYW1lLnN1YnN0cigyKTtcblx0fSBlbHNlXG5cdFx0a2V5TmFtZSA9IGtleU5hbWUuc3Vic3RyKDEpO1xuXHR2YXIgaW5kZXggPSBrZXlJbmRleFtiYXNlS2V5XSArIG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2U7XG5cdHdoaWxlIChpbmRleCA8IDApIGluZGV4ICs9IDEyO1xuXHRpZiAoaW5kZXggPiAxMSkgaW5kZXggPSBpbmRleCAlIDEyO1xuXHR2YXIgbmV3S2V5TmFtZSA9IChrZXlOYW1lWzBdID09PSAnbScgPyBuZXdLZXlNaW5vcltpbmRleF0gOiBuZXdLZXlbaW5kZXhdKTtcblx0dmFyIHRyYW5zcG9zZWRLZXkgPSBuZXdLZXlOYW1lICsga2V5TmFtZTtcblx0dmFyIG5ld0tleVNpZyA9IGtleXNbdHJhbnNwb3NlZEtleV07XG5cdGlmIChuZXdLZXlTaWcubGVuZ3RoID4gMCAmJiBuZXdLZXlTaWdbMF0uYWNjID09PSAnZmxhdCcpXG5cdFx0bXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZVByZWZlckZsYXRzID0gdHJ1ZTtcblx0dmFyIGRpc3RhbmNlID0gdHJhbnNwb3NlZEtleS5jaGFyQ29kZUF0KDApIC0gYmFzZUtleS5jaGFyQ29kZUF0KDApO1xuXHRpZiAobXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZSA+IDApIHtcblx0XHRpZiAoZGlzdGFuY2UgPCAwKVxuXHRcdFx0ZGlzdGFuY2UgKz0gNztcblx0XHRlbHNlIGlmIChkaXN0YW5jZSA9PT0gMCkge1xuXHRcdFx0Ly8gVGhlcmUncyBhIGZ1bm55IHRoaW5nIHRoYXQgaGFwcGVucyB3aGVuIHRoZSBrZXkgY2hhbmdlcyBvbmx5IGFuIGFjY2lkZW50YWwncyBkaXN0YW5jZSwgZm9yIGluc3RhbmNlLCBmcm9tIEFiIHRvIEEuXG5cdFx0XHQvLyBJZiB0aGUgZGlzdGFuY2UgaXMgcG9zaXRpdmUgKHdlIGFyZSByYWlzaW5nIHBpdGNoKSwgYW5kIHRoZSBjaGFuZ2UgaXMgaGlnaGVyICh0aGF0IGlzLCBBYiAtPiBBKSwgdGhlbiByYWlzZSBhbiBvY3RhdmUuXG5cdFx0XHQvLyBUaGlzIHRlc3QgaXMgZWFzaWVyIGJlY2F1c2Ugd2Uga25vdyB0aGUga2V5cyBhcmUgbm90IGVxdWFsIChvciB3ZSB3b3VsZG4ndCBnZXQgdGhpcyBmYXIpLCBzbyBpZiB0aGUgYmFzZSBrZXkgaXMgYSBmbGF0IGtleSwgdGhlblxuXHRcdFx0Ly8gdGhlIHRyYW5zcG9zZWQga2V5IG11c3QgYmUgaGlnaGVyLiBMaWtld2lzZSwgaWYgdGhlIHRyYW5zcG9zZWQga2V5IGlzIHNoYXJwLCB0aGVuIHRoZSBiYXNlIGtleSBtdXN0IGJlIGxvd2VyLiBBbmQgb25lXG5cdFx0XHQvLyBvZiB0aG9zZSB0d28gdGhpbmdzIG11c3QgYmUgdHJ1ZSBiZWNhdXNlIHRoZXkgYXJlIG5vdCBib3RoIG5hdHVyYWwuXG5cdFx0XHRpZiAoYmFzZUtleVsxXSA9PT0gJyMnIHx8ICB0cmFuc3Bvc2VkS2V5WzFdID09PSAnYicpXG5cdFx0XHRcdGRpc3RhbmNlICs9IDc7XG5cdFx0fVxuXHR9IGVsc2UgaWYgKG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2UgPCAwKSB7XG5cdFx0aWYgKGRpc3RhbmNlID4gMClcblx0XHRcdGRpc3RhbmNlIC09IDc7XG5cdFx0ZWxzZSBpZiAoZGlzdGFuY2UgPT09IDApIHtcblx0XHRcdC8vIFRoZXJlJ3MgYSBmdW5ueSB0aGluZyB0aGF0IGhhcHBlbnMgd2hlbiB0aGUga2V5IGNoYW5nZXMgb25seSBhbiBhY2NpZGVudGFsJ3MgZGlzdGFuY2UsIGZvciBpbnN0YW5jZSwgZnJvbSBBYiB0byBBLlxuXHRcdFx0Ly8gSWYgdGhlIGRpc3RhbmNlIGlzIG5lZ2F0aXZlICh3ZSBhcmUgZHJvcHBpbmcgcGl0Y2gpLCBhbmQgdGhlIGNoYW5nZSBpcyBsb3dlciAodGhhdCBpcywgQSAtPiBBYiksIHRoZW4gZHJvcCBhbiBvY3RhdmUuXG5cdFx0XHRpZiAoYmFzZUtleVsxXSA9PT0gJ2InIHx8ICB0cmFuc3Bvc2VkS2V5WzFdID09PSAnIycpXG5cdFx0XHRcdGRpc3RhbmNlIC09IDc7XG5cdFx0fVxuXHR9XG5cblx0aWYgKG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2UgPiAwKVxuXHRcdG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2VWZXJ0aWNhbE1vdmVtZW50ID0gZGlzdGFuY2UgKyBNYXRoLmZsb29yKG11bHRpbGluZVZhcnMubG9jYWxUcmFuc3Bvc2UgLyAxMikgKiA3O1xuXHRlbHNlXG5cdFx0bXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZVZlcnRpY2FsTW92ZW1lbnQgPSBkaXN0YW5jZSArIE1hdGguY2VpbChtdWx0aWxpbmVWYXJzLmxvY2FsVHJhbnNwb3NlIC8gMTIpICogNztcblx0cmV0dXJuIHsgYWNjaWRlbnRhbHM6IG5ld0tleVNpZywgcm9vdDogbmV3S2V5TmFtZVswXSwgYWNjOiBuZXdLZXlOYW1lLmxlbmd0aCA+IDEgPyBuZXdLZXlOYW1lWzFdIDogXCJcIiB9O1xufTtcblxudmFyIHNoYXJwQ2hvcmRzID0gWyAnQycsICdD4pmvJywgJ0QnLCBcIkTima9cIiwgJ0UnLCAnRicsIFwiRuKZr1wiLCAnRycsICdH4pmvJywgJ0EnLCAnQeKZrycsICdCJ107XG52YXIgZmxhdENob3JkcyA9IFsgJ0MnLCAnROKZrScsICdEJywgJ0Xima0nLCAnRScsICdGJywgJ0fima0nLCAnRycsICdB4pmtJywgJ0EnLCAnQuKZrScsICdCJ107XG5cbnRyYW5zcG9zZS5jaG9yZE5hbWUgPSBmdW5jdGlvbihtdWx0aWxpbmVWYXJzLCBjaG9yZCkge1xuXHRpZiAobXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZSAmJiAobXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZSAlIDEyICE9PSAwKSkgeyAvLyBUaGUgY2hvcmRzIGFyZSB0aGUgc2FtZSBpZiBpdCBpcyBhbiBleGFjdCBvY3RhdmUgY2hhbmdlLlxuXHRcdHZhciB0cmFuc3Bvc2VGYWN0b3IgPSBtdWx0aWxpbmVWYXJzLmxvY2FsVHJhbnNwb3NlO1xuXHRcdHdoaWxlICh0cmFuc3Bvc2VGYWN0b3IgPCAwKSB0cmFuc3Bvc2VGYWN0b3IgKz0gMTI7XG5cdFx0aWYgKHRyYW5zcG9zZUZhY3RvciA+IDExKSB0cmFuc3Bvc2VGYWN0b3IgPSB0cmFuc3Bvc2VGYWN0b3IgJSAxMjtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0Pima0vZywgXCJgfjExYFwiKTtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0Tima0vZywgXCJgfjFgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvReKZrS9nLCBcImB+M2BcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9G4pmtL2csIFwiYH40YFwiKTtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0fima0vZywgXCJgfjZgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvQeKZrS9nLCBcImB+OGBcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9C4pmtL2csIFwiYH4xMGBcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9D4pmvL2csIFwiYH4xYFwiKTtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0Tima8vZywgXCJgfjNgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvReKZry9nLCBcImB+NWBcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9G4pmvL2csIFwiYH42YFwiKTtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0fima8vZywgXCJgfjhgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvQeKZry9nLCBcImB+MTBgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvQuKZry9nLCBcImB+MGBcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9DL2csIFwiYH4wYFwiKTtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0QvZywgXCJgfjJgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvRS9nLCBcImB+NGBcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9GL2csIFwiYH41YFwiKTtcblx0XHRjaG9yZCA9IGNob3JkLnJlcGxhY2UoL0cvZywgXCJgfjdgXCIpO1xuXHRcdGNob3JkID0gY2hvcmQucmVwbGFjZSgvQS9nLCBcImB+OWBcIik7XG5cdFx0Y2hvcmQgPSBjaG9yZC5yZXBsYWNlKC9CL2csIFwiYH4xMWBcIik7XG5cdFx0dmFyIGFyciA9IGNob3JkLnNwbGl0KFwiYFwiKTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykge1xuXHRcdFx0aWYgKGFycltpXVswXSA9PT0gJ34nKSB7XG5cdFx0XHRcdHZhciBjaG9yZE51bSA9IHBhcnNlSW50KGFycltpXS5zdWJzdHIoMSksMTApO1xuXHRcdFx0XHRjaG9yZE51bSArPSB0cmFuc3Bvc2VGYWN0b3I7XG5cdFx0XHRcdGlmIChjaG9yZE51bSA+IDExKSBjaG9yZE51bSAtPSAxMjtcblx0XHRcdFx0YXJyW2ldID0gbXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZVByZWZlckZsYXRzID8gZmxhdENob3Jkc1tjaG9yZE51bV0gOiBzaGFycENob3Jkc1tjaG9yZE51bV07XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGNob3JkID0gYXJyLmpvaW4oXCJcIik7XG5cdH1cblx0cmV0dXJuIGNob3JkO1xufTtcblxudmFyIHBpdGNoVG9MZXR0ZXIgPSBbICdjJywgJ2QnLCAnZScsICdmJywgJ2cnLCAnYScsICdiJyBdO1xuZnVuY3Rpb24gYWNjaWRlbnRhbENoYW5nZShvcmlnUGl0Y2gsIG5ld1BpdGNoLCBhY2NpZGVudGFsLCBvcmlnS2V5U2lnLCBuZXdLZXlTaWcpIHtcblx0dmFyIG9yaWdQaXRjaExldHRlciA9IHBpdGNoVG9MZXR0ZXJbKG9yaWdQaXRjaCArIDQ5KSAlIDddOyAvLyBNYWtlIHN1cmUgaXQgaXMgYSBwb3NpdGl2ZSBwaXRjaCBiZWZvcmUgbm9ybWFsaXppbmcuXG5cdHZhciBvcmlnQWNjaWRlbnRhbCA9IDA7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgb3JpZ0tleVNpZy5sZW5ndGg7IGkrKykge1xuXHRcdGlmIChvcmlnS2V5U2lnW2ldLm5vdGUudG9Mb3dlckNhc2UoKSA9PT0gb3JpZ1BpdGNoTGV0dGVyKVxuXHRcdFx0b3JpZ0FjY2lkZW50YWwgPSBhY2NpZGVudGFsc1tvcmlnS2V5U2lnW2ldLmFjY107XG5cdH1cblxuXHR2YXIgY3VycmVudEFjY2lkZW50YWwgPSBhY2NpZGVudGFsc1thY2NpZGVudGFsXTtcblx0dmFyIGRlbHRhID0gY3VycmVudEFjY2lkZW50YWwgLSBvcmlnQWNjaWRlbnRhbDtcblxuXHR2YXIgbmV3UGl0Y2hMZXR0ZXIgPSBwaXRjaFRvTGV0dGVyWyhuZXdQaXRjaCArIDQ5KSAlIDddOyAvLyBNYWtlIHN1cmUgaXQgaXMgYSBwb3NpdGl2ZSBwaXRjaCBiZWZvcmUgbm9ybWFsaXppbmcuXG5cdHZhciBuZXdBY2NpZGVudGFsID0gMDtcblx0Zm9yICh2YXIgaiA9IDA7IGogPCBuZXdLZXlTaWcuYWNjaWRlbnRhbHMubGVuZ3RoOyBqKyspIHtcblx0XHRpZiAobmV3S2V5U2lnLmFjY2lkZW50YWxzW2pdLm5vdGUudG9Mb3dlckNhc2UoKSA9PT0gbmV3UGl0Y2hMZXR0ZXIpXG5cdFx0XHRuZXdBY2NpZGVudGFsID0gYWNjaWRlbnRhbHNbbmV3S2V5U2lnLmFjY2lkZW50YWxzW2pdLmFjY107XG5cdH1cblx0dmFyIGNhbGNBY2NpZGVudGFsID0gZGVsdGEgKyBuZXdBY2NpZGVudGFsO1xuXHRpZiAoY2FsY0FjY2lkZW50YWwgPCAtMikge1xuXHRcdG5ld1BpdGNoLS07XG5cdFx0Y2FsY0FjY2lkZW50YWwgKz0gKG5ld1BpdGNoTGV0dGVyID09PSAnYycgfHwgbmV3UGl0Y2hMZXR0ZXIgPT09ICdmJykgPyAxIDogMjtcblx0fVxuXHRpZiAoY2FsY0FjY2lkZW50YWwgPiAyKSB7XG5cdFx0bmV3UGl0Y2grKztcblx0XHRjYWxjQWNjaWRlbnRhbCAtPSAobmV3UGl0Y2hMZXR0ZXIgPT09ICdiJyB8fCBuZXdQaXRjaExldHRlciA9PT0gJ2UnKSA/IDEgOiAyO1xuXHR9XG5cdHJldHVybiBbbmV3UGl0Y2gsIGNhbGNBY2NpZGVudGFsXTtcbn1cblxudmFyIGFjY2lkZW50YWxzID0ge1xuXHRkYmxmbGF0OiAtMixcblx0ZmxhdDogLTEsXG5cdG5hdHVyYWw6IDAsXG5cdHNoYXJwOiAxLFxuXHRkYmxzaGFycDogMlxufTtcbnZhciBhY2NpZGVudGFsczIgPSB7XG5cdFwiLTJcIjogXCJkYmxmbGF0XCIsXG5cdFwiLTFcIjogXCJmbGF0XCIsXG5cdFwiMFwiOiBcIm5hdHVyYWxcIixcblx0XCIxXCI6IFwic2hhcnBcIixcblx0XCIyXCI6IFwiZGJsc2hhcnBcIixcbn07XG50cmFuc3Bvc2Uubm90ZSA9IGZ1bmN0aW9uKG11bHRpbGluZVZhcnMsIGVsKSB7XG5cdC8vIHRoZSBcImVsXCIgdGhhdCBpcyBwYXNzZWQgaW4gaGFzIGVsLmFjY2lkZW50YWwsIGFuZCBlbC5waXRjaC4gXCJwaXRjaFwiIGlzIHRoZSB2ZXJ0aWNhbCBwb3NpdGlvbiAoMD1taWRkbGUgQylcblx0Ly8gbG9jYWxUcmFuc3Bvc2UgaXMgdGhlIG51bWJlciBvZiBoYWxmIHN0ZXBzXG5cdC8vIGxvY2FsVHJhbnNwb3NlVmVydGljYWxNb3ZlbWVudCBpcyB0aGUgdmVydGljYWwgZGlzdGFuY2UgdG8gbW92ZS5cblx0aWYgKCFtdWx0aWxpbmVWYXJzLmxvY2FsVHJhbnNwb3NlKVxuXHRcdHJldHVybjtcblx0dmFyIG9yaWdQaXRjaCA9IGVsLnBpdGNoO1xuXHRlbC5waXRjaCA9IGVsLnBpdGNoICsgbXVsdGlsaW5lVmFycy5sb2NhbFRyYW5zcG9zZVZlcnRpY2FsTW92ZW1lbnQ7XG5cblx0aWYgKGVsLmFjY2lkZW50YWwpIHtcblx0XHR2YXIgcmV0ID0gYWNjaWRlbnRhbENoYW5nZShvcmlnUGl0Y2gsIGVsLnBpdGNoLCBlbC5hY2NpZGVudGFsLCBtdWx0aWxpbmVWYXJzLmdsb2JhbFRyYW5zcG9zZU9yaWdLZXlTaWcsIG11bHRpbGluZVZhcnMua2V5KTtcblx0XHRlbC5waXRjaCA9IHJldFswXTtcblx0XHRlbC5hY2NpZGVudGFsID0gYWNjaWRlbnRhbHMyW3JldFsxXV07XG5cdH1cblxufTtcblxubW9kdWxlLmV4cG9ydHMgPSB0cmFuc3Bvc2U7XG4iLCIvLyAgICBhYmMyYWJjX3dyaXRlLmpzOiBQcmludHMgYW4gYWJjIGZpbGUgaW4gdGV4dCBmb3JtYXQgcGFyc2VkIGJ5IGFiY19wYXJzZS5qc1xuLy8gICAgQ29weXJpZ2h0IChDKSAyMDEwLTIwMTggR3JlZ29yeSBEeWtlIChncmVnZHlrZSBhdCBnbWFpbCBkb3QgY29tKVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgVGV4dFByaW50ZXIgPSBmdW5jdGlvbihlbGVtLCByZXBvc2l0aW9uKSB7XG4gICAgdGhpcy5lbGVtID0gZWxlbTtcbiAgICB0aGlzLnRleHQgPSBcIlwiO1xuICAgIHRoaXMubCA9IDEvODtcbiAgICB0aGlzLnJlcG9zaXRpb24gPSByZXBvc2l0aW9uIHx8IGZhbHNlO1xufVxuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUucHJpbnRTdHJpbmcgPSBmdW5jdGlvbihzdHIsIGVsZW0pIHtcbiAgICBpZiAodGhpcy5yZXBvc2l0aW9uICYmIGVsZW0pIGVsZW0uc3RhcnRDaGFyID0gdGhpcy50ZXh0Lmxlbmd0aDtcbiAgICB0aGlzLnRleHQgKz0gc3RyO1xuICAgIGlmICh0aGlzLnJlcG9zaXRpb24gJiYgZWxlbSkgZWxlbS5lbmRDaGFyID0gdGhpcy50ZXh0Lmxlbmd0aDtcbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5wcmludE5ld0xpbmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy50ZXh0ICs9IFwiXFxuXCI7XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUucHJpbnRTcGFjZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAodGhpcy50ZXh0W3RoaXMudGV4dC5sZW5ndGgtMV0ubWF0Y2goL1xccy8pKSByZXR1cm47IC8vVE9ETyBtYXRjaCB3aGl0ZXNwYWNlXG4gICAgdGhpcy50ZXh0ICs9IFwiIFwiO1xufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLnByaW50QUJDID0gZnVuY3Rpb24oYWJjdHVuZSkge1xuICAgIHRoaXMudGV4dCA9IFwiXCI7XG4gICAgdGhpcy5hYmN0dW5lID0gYWJjdHVuZTtcbiAgICAvL1RPRE8gZm9ybWF0dGluZ1xuICAgIHRoaXMucHJpbnRIZWFkZXIoKTtcbiAgICB0aGlzLnByaW50Qm9keSgpO1xuICAgIHRoaXMuZWxlbS52YWx1ZT10aGlzLnRleHQ7XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUucHJpbnRIZWFkZXIgPSBmdW5jdGlvbigpIHtcbiAgICAvLyBtdWNoIG9mIHRoaXMgaW5mbyBpcyBkdXBsaWNhdGVkIGluIG1ldGFUZXh0SEVhZGVycyBpbiBhYmNfcGFyc2VfaGVhZGVyLmpzXG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJ4XCIsXCJYXCIsXCIxXCIpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwidGl0bGVcIixcIlRcIik7XG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJjb21wb3NlclwiLFwiQ1wiKTtcbiAgICB0aGlzLnByaW50SGVhZGVyTGluZShcImhpc3RvcnlcIixcIkhcIik7XG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJhdXRob3JcIixcIkFcIik7XG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJib29rXCIsXCJCXCIpOyAgXG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJkaXNjb2dyYXBoeVwiLFwiRFwiKTsgIFxuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwidXJsXCIsXCJGXCIpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwiZ3JvdXBcIixcIkdcIik7XG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJpbnN0cnVjdGlvblwiLFwiSVwiKTtcbiAgICB0aGlzLnByaW50SGVhZGVyTGluZShcIm5vdGVzXCIsXCJOXCIpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwib3JpZ2luXCIsXCJPXCIpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwicmh5dGhtXCIsXCJSXCIpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwic291cmNlXCIsXCJTXCIpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwidW5hbGlnbmVkd29yZHNcIixcIldcIik7XG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJ0cmFuc2NyaXB0aW9uXCIsXCJaXCIpO1xuICAgIC8vVE9ETyBwYXJ0IG9yZGVyXG4gICAgLy9UT0RPIFEgdGVtcG9cbiAgICAvL1RPRE8gdGV4dEJsb2NrXG4gICAgdGhpcy5wcmludEhlYWRlckxpbmUoXCJOVUxMXCIsXCJMXCIsXCIxLzhcIik7IC8vVE9ETyBMXG5cbiAgICB0aGlzLnByaW50SGVhZGVyTGluZShcIk5VTExcIixcIk1cIix0aGlzLmdldE1ldGVyU3RyaW5nKHRoaXMuYWJjdHVuZS5saW5lc1swXS5zdGFmZlswXS5tZXRlcikpO1xuICAgIHRoaXMucHJpbnRIZWFkZXJMaW5lKFwiTlVMTFwiLFwiS1wiLHRoaXMuZ2V0S2V5U3RyaW5nKHRoaXMuYWJjdHVuZS5saW5lc1swXS5zdGFmZlswXS5rZXkpKTsvL1RPRE8gS1xufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLmdldEtleVN0cmluZyA9IGZ1bmN0aW9uKGtleSkge1xuICAgIHJldHVybiBrZXkucm9vdCtrZXkuYWNjK2tleS5tb2RlO1xufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLmdldE1ldGVyU3RyaW5nID0gZnVuY3Rpb24obWV0ZXIpIHtcbiAgICBzd2l0Y2ggKG1ldGVyLnR5cGUpIHtcbiAgICBjYXNlIFwiY3V0X3RpbWVcIjogcmV0dXJuIFwiQ3xcIjtcbiAgICBjYXNlIFwiY29tbW9uX3RpbWVcIjogcmV0dXJuIFwiQ1wiO1xuICAgIGNhc2UgXCJzcGVjaWZpZWRcIjpcbiAgICAgIGlmIChtZXRlci52YWx1ZVswXS5kZW4pXG5cdFx0cmV0dXJuIG1ldGVyLnZhbHVlWzBdLm51bStcIi9cIittZXRlci52YWx1ZVswXS5kZW47XG4gICAgICBlbHNlXG5cdCAgICByZXR1cm4gbWV0ZXIudmFsdWVbMF0ubnVtO1xuICAgIH1cbiAgICByZXR1cm4gXCJcIjtcbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5wcmludEhlYWRlckxpbmUgPSBmdW5jdGlvbihmaWVsZG5hbWUsIGFiY2ZpZWxkLCBkZWZhdXQpIHtcbiAgICB2YXIgdmFsID0gdGhpcy5hYmN0dW5lLm1ldGFUZXh0W2ZpZWxkbmFtZV0gfHwgZGVmYXV0O1xuICAgIGlmICh2YWwgIT09IHVuZGVmaW5lZCkge1xuXHR2YXIgdmFsYXJyYXkgPSB2YWwuc3BsaXQoXCJcXG5cIik7XG5cdGZvciAodmFyIGk9MDsgaTx2YWxhcnJheS5sZW5ndGg7IGkrKykge1xuXHQgICAgdGhpcy5wcmludFN0cmluZyhhYmNmaWVsZCtcIjogXCIrdmFsYXJyYXlbaV0pO1xuXHQgICAgdGhpcy5wcmludE5ld0xpbmUoKTtcblx0fSBcbiAgICB9XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUuZ2V0RWxlbSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmFiY2xpbmUubGVuZ3RoIDw9IHRoaXMucG9zKVxuXHRyZXR1cm4gbnVsbDtcbiAgICByZXR1cm4gdGhpcy5hYmNsaW5lW3RoaXMucG9zXTtcbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5nZXROZXh0RWxlbSA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICh0aGlzLmFiY2xpbmUubGVuZ3RoIDw9IHRoaXMucG9zKzEpXG5cdHJldHVybiBudWxsO1xuICAgIHJldHVybiB0aGlzLmFiY2xpbmVbdGhpcy5wb3MrMV07XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUucHJpbnRCb2R5ID0gZnVuY3Rpb24oKSB7XG4gICAgZm9yKHZhciBsaW5lPTA7IGxpbmU8dGhpcy5hYmN0dW5lLmxpbmVzLmxlbmd0aDsgbGluZSsrKSB7XG5cdHZhciBhYmNsaW5lID0gdGhpcy5hYmN0dW5lLmxpbmVzW2xpbmVdO1xuXHRpZiAoYWJjbGluZS5zdGFmZikge1xuXHQgICAgdGhpcy5wcmludEFCQ0xpbmUoYWJjbGluZS5zdGFmZik7XG5cdH0gZWxzZSBpZiAoYWJjbGluZS5zdWJ0aXRsZSAmJiBsaW5lIT09MCkge1xuXHQgICAgLy9UT0RPXG5cdH0gZWxzZSBpZiAoYWJjbGluZS50ZXh0KSB7XG5cdCAgICAvL1RPRE9cblx0fVxuICAgIH1cbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5wcmludEFCQ0xpbmUgPSBmdW5jdGlvbihzdGFmZnMpIHtcbiAgICBmb3IgKHRoaXMucyA9IDA7IHRoaXMucyA8IHN0YWZmcy5sZW5ndGg7IHRoaXMucysrKSB7XG5cdHRoaXMucHJpbnRBQkNTdGFmZihzdGFmZnNbdGhpcy5zXSk7XG4gICAgfVxufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLnByaW50QUJDU3RhZmYgPSBmdW5jdGlvbihhYmNzdGFmZikge1xuICAgIFxuICAgIC8vIFRPRE8gaWYgKGFiY3N0YWZmLmJyYWNrZXQpIGhlYWRlciArPSBcImJyYWNrZXQgXCIrYWJjc3RhZmYuYnJhY2tldCtcIiBcIjtcbiAgICAvLyBUT0RPIGlmIChhYmNzdGFmZi5icmFjZSkgaGVhZGVyICs9IFwiYnJhY2UgXCIrYWJjc3RhZmYuYnJhY2UrXCIgXCI7XG4gICAgXG4gICAgXG4gICAgZm9yICh0aGlzLnYgPSAwOyB0aGlzLnYgPCBhYmNzdGFmZi52b2ljZXMubGVuZ3RoOyB0aGlzLnYrKykge1xuXHQvLyBUT0RPIHN0dWZmIGFib3V0IHZvaWNlc1xuXHRcblx0Ly8gVE9ETyB0aGlzIGlzIHdoZXJlIGtleSBzaWcgaXMgdGhpcy52b2ljZS5hZGRDaGlsZCh0aGlzLnByaW50Q2xlZihhYmNzdGFmZi5jbGVmKSk7XG5cdC8vIHRoaXMudm9pY2UuYWRkQ2hpbGQodGhpcy5wcmludEtleVNpZ25hdHVyZShhYmNzdGFmZi5rZXkpKTtcblx0Ly8gaWYgKGFiY3N0YWZmLm1ldGVyKSB0aGlzLnZvaWNlLmFkZENoaWxkKHRoaXMucHJpbnRUaW1lU2lnbmF0dXJlKGFiY3N0YWZmLm1ldGVyKSk7XG5cdHRoaXMucHJpbnRBQkNWb2ljZShhYmNzdGFmZi52b2ljZXNbdGhpcy52XSk7XG4gICAgfVxuICAgIFxufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLnByaW50QUJDVm9pY2UgPSBmdW5jdGlvbihhYmNsaW5lKSB7XG4gICAgdGhpcy5hYmNsaW5lID0gYWJjbGluZTtcbiAgICBmb3IgKHRoaXMucG9zPTA7IHRoaXMucG9zPHRoaXMuYWJjbGluZS5sZW5ndGg7IHRoaXMucG9zKyspIHtcblx0dGhpcy5wcmludEFCQ0VsZW1lbnQoKTtcbiAgICB9XG4gICAgdGhpcy5wcmludE5ld0xpbmUoKTtcbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5wcmludEFCQ0VsZW1lbnQgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgZWxlbSA9IHRoaXMuZ2V0RWxlbSgpO1xuICAgIHN3aXRjaCAoZWxlbS5lbF90eXBlKSB7XG4gICAgY2FzZSBcIm5vdGVcIjpcblx0dGhpcy5wcmludEJlYW0oKTtcblx0YnJlYWs7XG4gICAgY2FzZSBcImJhclwiOlxuXHR0aGlzLnByaW50QmFyTGluZShlbGVtKTtcblx0YnJlYWs7XG4gICAgY2FzZSBcIm1ldGVyXCI6XG5cdC8vVE9ETyB0aGlzLnByaW50VGltZVNpZ25hdHVyZShlbGVtKTtcblx0YnJlYWs7XG4gICAgY2FzZSBcImNsZWZcIjpcblx0Ly9UT0RPIHRoaXMucHJpbnRDbGVmKGVsZW0pO1xuXHRicmVhaztcbiAgICBjYXNlIFwia2V5XCI6XG5cdC8vVE9ETyB0aGlzLnByaW50S2V5U2lnbmF0dXJlKGVsZW0pO1xuICAgIGNhc2UgXCJzdGVtXCI6XG5cdC8vVE9ETyBkbyBub3RoaW5nP1xuXHRicmVhaztcbiAgICBjYXNlIFwicGFydFwiOlxuXHQvL1RPRE8gcHJpbnQgcGFydFxuXHRicmVhaztcbiAgICBkZWZhdWx0OlxuXHQvL1RPRE8gc2hvdyB3ZSdyZSBtaXNzaW5nIHNvbWV0aGluZ1xuICAgIH1cbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5wcmludEJlYW0gPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLnByaW50U3BhY2UoKTtcbiAgICBpZiAodGhpcy5nZXRFbGVtKCkuc3RhcnRCZWFtICYmICF0aGlzLmdldEVsZW0oKS5lbmRCZWFtKSB7XG5cdHdoaWxlICh0aGlzLmdldEVsZW0oKSkge1xuXHQgICAgdGhpcy5wcmludE5vdGUodGhpcy5nZXRFbGVtKCkpO1xuXHQgICAgaWYgKHRoaXMuZ2V0RWxlbSgpLmVuZEJlYW0pIHtcblx0XHRicmVhaztcblx0ICAgIH1cblx0ICAgIHRoaXMucG9zKys7XG5cdH1cbiAgICB9IGVsc2Uge1xuXHR0aGlzLnByaW50Tm90ZSh0aGlzLmdldEVsZW0oKSk7XG4gICAgfVxuICAgIHRoaXMucHJpbnRTcGFjZSgpO1xufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLnByaW50Tm90ZSA9IGZ1bmN0aW9uKGVsZW0pIHtcbiAgICB2YXIgc3RyID0gXCJcIjtcblx0dmFyIGk7XG4gICAgaWYgKGVsZW0uY2hvcmQgIT09IHVuZGVmaW5lZCkge1xuXHRmb3IgKGk9MDsgaTxlbGVtLmNob3JkLmxlbmd0aDsgaSsrKSB7XG5cdCAgICBzdHIrPSAnXCInK2VsZW0uY2hvcmRbaV0ubmFtZSsnXCInO1xuXHR9XG4gICAgfVxuICAgIFxuICAgIC8vVE9ETyB1bmlmeSBtYXAgYmV0d2VlbiBuYW1lcyBhbmQgc3ltYm9scyAodG8gYmUgdXNlZCB3aXRoIGFiY3BhcnNlPylcbiAgICB2YXIgZGVjb3JhdGlvbnMgPSB7XG5cdFwic3RhY2NhdG9cIiA6IFwiLlwiLFxuXHRcInVwYm93XCIgOiBcInVcIixcblx0XCJkb3duYm93XCIgOiBcInZcIixcblx0XCJyb2xsXCIgOiBcIn5cIixcblx0XCJmZXJtYXRhXCIgOiBcIkhcIixcblx0XCJzbGlkZVwiIDogXCJKXCIsXG5cdFwiYWNjZW50XCIgOiBcIkxcIixcblx0XCJtb3JkZW50XCIgOiBcIk1cIixcblx0XCJwcmFsbHRyaWxsZXJcIiA6IFwiUFwiLFxuXHRcInRyaWxsXCIgOiBcIlRcIixcblx0XCJsb3dlclwiIDogXCIuXCJcbiAgICB9O1xuXG4gICAgaWYgKGVsZW0uZGVjb3JhdGlvbiAhPT0gdW5kZWZpbmVkKSB7XG5cdGZvciAoaT0wOyBpPGVsZW0uZGVjb3JhdGlvbi5sZW5ndGg7IGkrKykge1xuXHQgICAgdmFyIGRlYyA9IGVsZW0uZGVjb3JhdGlvbltpXTtcblx0ICAgIGlmIChkZWNvcmF0aW9uc1tkZWNdKSB7XG5cdFx0c3RyKz1kZWNvcmF0aW9uc1tkZWNdO1xuXHQgICAgfSBlbHNlIHtcblx0XHRzdHIrPVwiIVwiOyAvL1RPRE8gaGFyZGNvZGVkXG5cdFx0c3RyKz1kZWM7XG5cdFx0c3RyKz1cIiFcIjsgLy9UT0RPIGhhcmRjb2RlZFxuXHQgICAgfVxuXHR9XG4gICAgfVxuXG4gICAgaWYgKGVsZW0uZ3JhY2Vub3RlcyAhPT0gdW5kZWZpbmVkKSB7XG5cdHN0cis9XCJ7XCI7XG5cdGZvciAoaT0wOyBpPGVsZW0uZ3JhY2Vub3Rlcy5sZW5ndGg7IGkrKykge1xuXHQgICAgc3RyKz10aGlzLmdldE5vdGVTdHJpbmcoZWxlbS5ncmFjZW5vdGVzW2ldKTtcblx0fVxuXHRzdHIrPVwifVwiO1xuICAgIH1cblxuICAgIHZhciBpZ25vcmVzbHVyID0gZmFsc2U7XG4gICAgaWYgKGVsZW0ucGl0Y2hlcy5sZW5ndGggPT09IDEgJiYgZWxlbS5waXRjaGVzWzBdLnN0YXJ0U2x1cikge1xuXHRpZ25vcmVzbHVyID0gdHJ1ZTtcblx0c3RyKz10aGlzLm11bHRpcGx5U3RyaW5nKFwiKFwiLGVsZW0ucGl0Y2hlc1swXS5zdGFydFNsdXIubGVuZ3RoKTtcbiAgICB9XG5cbiAgICBpZiAoZWxlbS5zdGFydFNsdXIpIHtcblx0c3RyKz10aGlzLm11bHRpcGx5U3RyaW5nKFwiKFwiLGVsZW0uc3RhcnRTbHVyLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKChlbGVtLnBpdGNoZXMubGVuZ3RoID09PSAxICYmIGVsZW0ucGl0Y2hlc1swXS5lbmRTbHVyKSB8fCBlbGVtLmVuZFNsdXIpIHtcblx0aWdub3Jlc2x1ciA9IHRydWU7XG4gICAgfVxuXG4gICAgaWYgKGVsZW0uc3RhcnRUcmlwbGV0KSB7XG5cdHN0cis9XCIoM1wiO1xuICAgIH1cblxuICAgIGlmIChlbGVtLnBpdGNoZXMpIHtcblx0aWYgKGVsZW0ucGl0Y2hlcy5sZW5ndGggPiAxKSBzdHIrPVwiW1wiO1xuXHRmb3IgKGk9MDsgaTxlbGVtLnBpdGNoZXMubGVuZ3RoOyBpKyspIHtcblx0ICAgIGVsZW0ucGl0Y2hlc1tpXS5kdXJhdGlvbiA9IGVsZW0uZHVyYXRpb247XG5cdCAgICBzdHIrPXRoaXMuZ2V0Tm90ZVN0cmluZyhlbGVtLnBpdGNoZXNbaV0sIGlnbm9yZXNsdXIpO1xuXHR9XG5cdGlmIChlbGVtLnBpdGNoZXMubGVuZ3RoID4gMSkgc3RyKz1cIl1cIjtcbiAgICB9IFxuXG4gICAgaWYgKGVsZW0ucGl0Y2hlcy5sZW5ndGggPT09IDEgJiYgZWxlbS5waXRjaGVzWzBdLmVuZFNsdXIpIHtcblx0c3RyKz10aGlzLm11bHRpcGx5U3RyaW5nKFwiKVwiLGVsZW0ucGl0Y2hlc1swXS5lbmRTbHVyLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKGVsZW0uZW5kU2x1cikge1xuXHRzdHIrPXRoaXMubXVsdGlwbHlTdHJpbmcoXCIpXCIsZWxlbS5lbmRTbHVyLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgdGhpcy5wcmludFN0cmluZyhzdHIsZWxlbSk7XG5cbn07XG5cbi8vIGFjY2lkZW50YWxzLCB0aWVzIGFuZCBzb21ldGltZXMgc2x1cnMsIHNvbWV0aW1lcyBkdXJhdGlvblxuVGV4dFByaW50ZXIucHJvdG90eXBlLmdldE5vdGVTdHJpbmcgPSBmdW5jdGlvbihwaXRjaGVsZW0sIGlnbm9yZXNsdXIpIHtcbiAgICB2YXIgc3RyID0gXCJcIjtcbiAgICBpZiAoIWlnbm9yZXNsdXIgJiYgcGl0Y2hlbGVtLnN0YXJ0U2x1cikge1xuXHRzdHIrPVwiKFwiO1xuICAgIH1cblxuICAgIHZhciBzeW1iID0gXCJcIjtcbiAgICBzd2l0Y2ggKHBpdGNoZWxlbS5hY2NpZGVudGFsKSB7XG4gICAgY2FzZSBcInF1YXJ0ZXJzaGFycFwiOlxuXHRzeW1iID0gXCJeL1wiO1xuXHRicmVhaztcbiAgICBjYXNlIFwiZGJsc2hhcnBcIjpcblx0c3ltYiA9IFwiXl5cIjtcblx0YnJlYWs7XG4gICAgY2FzZSBcInNoYXJwXCI6XG5cdHN5bWIgPSBcIl5cIjtcblx0YnJlYWs7XG4gICAgY2FzZSBcInF1YXJ0ZXJmbGF0XCI6XG5cdHN5bWIgPSBcIl8vXCI7XG5cdGJyZWFrO1xuICAgIGNhc2UgXCJmbGF0XCI6XG5cdHN5bWIgPSBcIl9cIjtcblx0YnJlYWs7XG4gICAgY2FzZSBcImRibGZsYXRcIjpcblx0c3ltYiA9IFwiX19cIjtcblx0YnJlYWs7XG4gICAgY2FzZSBcIm5hdHVyYWxcIjpcblx0c3ltYiA9IFwiPVwiO1xuICAgIH1cbiAgICBzdHIrPXN5bWI7XG5cbiAgICB2YXIgcGl0Y2hlcyA9IFtcIkNcIixcIkRcIixcIkVcIixcIkZcIixcIkdcIixcIkFcIixcIkJcIl07XG4gICAgdmFyIHBpdGNoc3RyID0gcGl0Y2hlc1t0aGlzLmV4dHJhY3ROb3RlKHBpdGNoZWxlbS5waXRjaCldO1xuICAgIHZhciBvY3RhdmUgPSB0aGlzLmV4dHJhY3RPY3RhdmUocGl0Y2hlbGVtLnBpdGNoKTtcbiAgICBpZiAob2N0YXZlPjApIHtcblx0cGl0Y2hzdHIgPSBwaXRjaHN0ci50b0xvd2VyQ2FzZSgpO1xuXHRvY3RhdmUtLTtcblx0d2hpbGUgKG9jdGF2ZT4wKSB7XG5cdCAgICBwaXRjaHN0cis9XCInXCI7XG5cdCAgICBvY3RhdmUtLTtcblx0fVxuICAgIH0gZWxzZSB7XG5cdHdoaWxlIChvY3RhdmU8MCkge1xuXHQgICAgcGl0Y2hzdHIrPVwiLFwiO1xuXHQgICAgb2N0YXZlKys7XG5cdH1cbiAgICB9XG4gICAgXG4gICAgc3RyKz1waXRjaHN0cjtcbiAgICBcbiAgICBpZiAocGl0Y2hlbGVtLmR1cmF0aW9uKSB7XG5cdHN0cis9dGhpcy5nZXREdXJhdGlvblN0cmluZyhwaXRjaGVsZW0uZHVyYXRpb24pO1xuICAgIH1cblxuICAgIGlmICghaWdub3Jlc2x1ciAmJiBwaXRjaGVsZW0uZW5kU2x1cikge1xuXHRzdHIrPVwiKVwiO1xuICAgIH1cblxuICAgIGlmIChwaXRjaGVsZW0uc3RhcnRUaWUpIHtcblx0c3RyKz1cIi1cIjtcbiAgICB9XG5cbiAgICByZXR1cm4gc3RyO1xufTtcblxuVGV4dFByaW50ZXIucHJvdG90eXBlLmdldER1cmF0aW9uU3RyaW5nID0gZnVuY3Rpb24oZHVyYXRpb24pIHtcbiAgICAvL1RPRE8gZGV0ZWN0IGNyb29rZWQgcmh5dGhtXG4gICAgaWYgKGR1cmF0aW9uL3RoaXMubCA+IDEpIHtcblx0cmV0dXJuIGR1cmF0aW9uL3RoaXMubDtcbiAgICB9IFxuICAgIHZhciByZXQgPSBcIlwiO1xuICAgIGlmICh0aGlzLmwvZHVyYXRpb24+MSkge1xuXHRyZXQrPVwiL1wiO1xuXHRpZiAodGhpcy5sL2R1cmF0aW9uPjIpIHtcblx0ICAgIHJldCs9dGhpcy5sL2R1cmF0aW9uO1xuXHR9ICAgXG4gICAgfVxuICAgIHJldHVybiByZXQ7XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUuZXh0cmFjdE5vdGUgPSBmdW5jdGlvbihwaXRjaCkge1xuICAgIHZhciBwaXRjaDIgPSBwaXRjaCU3O1xuICAgIGlmIChwaXRjaDI8MCkgcGl0Y2gyKz03O1xuICAgIHJldHVybiBwaXRjaDI7XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUuZXh0cmFjdE9jdGF2ZSA9IGZ1bmN0aW9uKHBpdGNoKSB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IocGl0Y2gvNyk7XG59O1xuXG5UZXh0UHJpbnRlci5wcm90b3R5cGUucHJpbnRCYXJMaW5lID0gZnVuY3Rpb24oZWxlbSkge1xuICAgIHZhciBiYXJzdHIgPSBcIlwiO1xuICAgIHN3aXRjaCAoZWxlbS50eXBlKSB7XG4gICAgY2FzZSBcImJhcl90aGluXCI6IGJhcnN0cis9XCJ8XCI7IGJyZWFrO1xuICAgIGNhc2UgXCJiYXJfdGhpbl90aGlja1wiOiBiYXJzdHIrPVwifF1cIjsgYnJlYWs7XG4gICAgY2FzZSBcImJhcl90aGluX3RoaW5cIjogYmFyc3RyKz1cInx8XCI7IGJyZWFrO1xuICAgIGNhc2UgXCJiYXJfdGhpY2tfdGhpblwiOiBiYXJzdHIrPVwiW3xcIjsgYnJlYWs7XG4gICAgY2FzZSBcImJhcl9kYmxfcmVwZWF0XCI6IGJhcnN0cis9XCI6fHw6XCI7IGJyZWFrO1xuICAgIGNhc2UgXCJiYXJfbGVmdF9yZXBlYXRcIjogYmFyc3RyKz1cInw6XCI7IGJyZWFrO1xuICAgIGNhc2UgXCJiYXJfcmlnaHRfcmVwZWF0XCI6IGJhcnN0cis9XCI6fFwiOyBicmVhaztcbiAgICBjYXNlIFwiYmFyX2ludmlzaWJsZVwiOiBiYXJzdHIrPVwiXCI7IGJyZWFrO1xuICAgIH1cbiAgICB0aGlzLnByaW50U3RyaW5nKGJhcnN0cixlbGVtKTtcbn07XG5cblRleHRQcmludGVyLnByb3RvdHlwZS5tdWx0aXBseVN0cmluZyA9IGZ1bmN0aW9uIChzLCBuKSB7XG4gICAgdmFyIHJldCA9IFwiXCI7XG4gICAgZm9yICg7bj4wO24tLSkgcmV0Kz1zO1xuICAgIHJldHVybiByZXQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRleHRQcmludGVyO1xuIiwiLy8gICAgYWJjX2Fic29sdXRlX2VsZW1lbnQuanM6IERlZmluaXRpb24gb2YgdGhlIEFic29sdXRlRWxlbWVudCBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHNwYWNpbmcgPSByZXF1aXJlKCcuL2FiY19zcGFjaW5nJyk7XG5cbi8vIGR1cmF0aW9uIC0gYWN0dWFsIG11c2ljYWwgZHVyYXRpb24gLSBkaWZmZXJlbnQgZnJvbSBub3RlaGVhZCBkdXJhdGlvbiBpbiB0cmlwbGV0cy4gcmVmZXIgdG8gYWJjZWxlbSB0byBnZXQgdGhlIG5vdGVoZWFkIGR1cmF0aW9uXG4vLyBtaW5zcGFjaW5nIC0gc3BhY2luZyB3aGljaCBtdXN0IGJlIHRha2VuIG9uIHRvcCBvZiB0aGUgd2lkdGggZGVmaW5lZCBieSB0aGUgZHVyYXRpb25cbi8vIHR5cGUgaXMgYSBtZXRhLXR5cGUgZm9yIHRoZSBlbGVtZW50LiBJdCBpcyBub3QgbmVjZXNzYXJ5IGZvciBkcmF3aW5nLCBidXQgaXQgaXMgdXNlZnVsIHRvIG1ha2Ugc2VtYW50aWMgc2Vuc2Ugb2YgdGhlIGVsZW1lbnQuIEZvciBpbnN0YW5jZSwgaXQgY2FuIGJlIHVzZWQgaW4gdGhlIGVsZW1lbnQncyBjbGFzcyBuYW1lLlxudmFyIEFic29sdXRlRWxlbWVudCA9IGZ1bmN0aW9uIEFic29sdXRlRWxlbWVudChhYmNlbGVtLCBkdXJhdGlvbiwgbWluc3BhY2luZywgdHlwZSwgdHVuZU51bWJlciwgb3B0aW9ucykge1xuXHQvL2NvbnNvbGUubG9nKFwiQWJzb2x1dGU6XCIsYWJjZWxlbSwgdHlwZSk7XG5cdGlmICghb3B0aW9ucylcblx0XHRvcHRpb25zID0ge307XG5cdHRoaXMudHVuZU51bWJlciA9IHR1bmVOdW1iZXI7XG5cdHRoaXMuYWJjZWxlbSA9IGFiY2VsZW07XG5cdHRoaXMuZHVyYXRpb24gPSBkdXJhdGlvbjtcblx0dGhpcy5kdXJhdGlvbkNsYXNzID0gb3B0aW9ucy5kdXJhdGlvbkNsYXNzT3ZlcmlkZSA/IG9wdGlvbnMuZHVyYXRpb25DbGFzc092ZXJpZGUgOiB0aGlzLmR1cmF0aW9uO1xuXHR0aGlzLm1pbnNwYWNpbmcgPSBtaW5zcGFjaW5nIHx8IDA7XG5cdHRoaXMueCA9IDA7XG5cdHRoaXMuY2hpbGRyZW4gPSBbXTtcblx0dGhpcy5oZWFkcyA9IFtdO1xuXHR0aGlzLmV4dHJhID0gW107XG5cdHRoaXMuZXh0cmF3ID0gMDtcblx0Ly90aGlzLmRlY3MgPSBbXTtcblx0dGhpcy53ID0gMDtcblx0dGhpcy5yaWdodCA9IFtdO1xuXHR0aGlzLmludmlzaWJsZSA9IGZhbHNlO1xuXHR0aGlzLmJvdHRvbSA9IHVuZGVmaW5lZDtcblx0dGhpcy50b3AgPSB1bmRlZmluZWQ7XG5cdHRoaXMudHlwZSA9IHR5cGU7XG5cdC8vIHRoZXNlIGFyZSB0aGUgaGVpZ2h0cyBvZiBhbGwgb2YgdGhlIHZlcnRpY2FsIGVsZW1lbnRzIHRoYXQgY2FuJ3QgYmUgcGxhY2VkIHVudGlsIHRoZSBlbmQgb2YgdGhlIGxpbmUuXG5cdC8vIHRoZSB2ZXJ0aWNhbCBvcmRlciBvZiBlbGVtZW50cyB0aGF0IGFyZSBhYm92ZSBpczogdGVtcG8sIHBhcnQsIHZvbHVtZS9keW5hbWljLCBlbmRpbmcvY2hvcmQsIGx5cmljXG5cdC8vIHRoZSB2ZXJ0aWNhbCBvcmRlciBvZiBlbGVtZW50cyB0aGF0IGFyZSBiZWxvdyBpczogbHlyaWMsIGNob3JkLCB2b2x1bWUvZHluYW1pY1xuXHR0aGlzLnNwZWNpYWxZID0ge1xuXHRcdHRlbXBvSGVpZ2h0QWJvdmU6IDAsXG5cdFx0cGFydEhlaWdodEFib3ZlOiAwLFxuXHRcdHZvbHVtZUhlaWdodEFib3ZlOiAwLFxuXHRcdGR5bmFtaWNIZWlnaHRBYm92ZTogMCxcblx0XHRlbmRpbmdIZWlnaHRBYm92ZTogMCxcblx0XHRjaG9yZEhlaWdodEFib3ZlOiAwLFxuXHRcdGx5cmljSGVpZ2h0QWJvdmU6IDAsXG5cblx0XHRseXJpY0hlaWdodEJlbG93OiAwLFxuXHRcdGNob3JkSGVpZ2h0QmVsb3c6IDAsXG5cdFx0dm9sdW1lSGVpZ2h0QmVsb3c6IDAsXG5cdFx0ZHluYW1pY0hlaWdodEJlbG93OiAwXG5cdH07XG59O1xuXG4vLyBGb3IgZWFjaCBvZiB0aGUgcmVsYXRpdmUgZWxlbWVudHMgdGhhdCBjYW4ndCBiZSBwbGFjZWQgaW4gYWR2YW5jZSAoYmVjYXVzZSB0aGVpciB2ZXJ0aWNhbCBwbGFjZW1lbnQgZGVwZW5kcyBvbiBldmVyeXRoaW5nXG4vLyBlbHNlIG9uIHRoZSBsaW5lKSwgdGhpcyBpdGVyYXRlcyB0aHJvdWdoIHRoZW0gYW5kIHNldHMgdGhlaXIgcGl0Y2guIEJ5IHRoZSB0aW1lIHRoaXMgaXMgY2FsbGVkLCBzcGVjaWFsWVJlc29sdmVkIGNvbnRhaW5zIGFcbi8vIGhhc2ggd2l0aCB0aGUgdmVydGljYWwgcGxhY2VtZW50IChpbiBwaXRjaCB1bml0cykgZm9yIGVhY2ggdHlwZS5cbi8vIFRPRE8tUEVSOiBJIHRoaW5rIHRoaXMgbmVlZHMgdG8gYmUgc2VwYXJhdGVkIGJ5IFwiYWJvdmVcIiBhbmQgXCJiZWxvd1wiLiBIb3cgZG8gd2Uga25vdyB0aGF0IGZvciBkeW5hbWljcyBhdCB0aGUgcG9pbnQgd2hlcmUgdGhleSBhcmUgYmVpbmcgZGVmaW5lZCwgdGhvdWdoPyBXZSBuZWVkIGEgcGFzcyB0aHJvdWdoIGFsbCB0aGUgcmVsYXRpdmUgZWxlbWVudHMgdG8gc2V0IFwiYWJvdmVcIiBhbmQgXCJiZWxvd1wiLlxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5zZXRVcHBlckFuZExvd2VyRWxlbWVudHMgPSBmdW5jdGlvbihzcGVjaWFsWVJlc29sdmVkKSB7XG5cdC8vIHNwZWNpYWxZUmVzb2x2ZWQgY29udGFpbnMgdGhlIGFjdHVhbCBwaXRjaCBmb3IgZWFjaCBvZiB0aGUgY2xhc3NlcyBvZiBlbGVtZW50cy5cblx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlbltpXTtcblx0XHRmb3IgKHZhciBrZXkgaW4gdGhpcy5zcGVjaWFsWSkgeyAvLyBmb3IgZWFjaCBjbGFzcyBvZiBlbGVtZW50IHRoYXQgbmVlZHMgdG8gYmUgcGxhY2VkIHZlcnRpY2FsbHlcblx0XHRcdGlmICh0aGlzLnNwZWNpYWxZLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0XHRcdFx0aWYgKGNoaWxkW2tleV0pIHsgLy8gSWYgdGhpcyByZWxhdGl2ZSBlbGVtZW50IGhhcyBkZWZpbmVkIGEgaGVpZ2h0IGZvciB0aGlzIGNsYXNzIG9mIGVsZW1lbnRcblx0XHRcdFx0XHRjaGlsZC5waXRjaCA9IHNwZWNpYWxZUmVzb2x2ZWRba2V5XTtcblx0XHRcdFx0XHRpZiAoY2hpbGQudG9wID09PSB1bmRlZmluZWQpIHsgLy8gVE9ETy1QRVI6IEhBQ0shIE5vdCBzdXJlIHRoaXMgaXMgdGhlIHJpZ2h0IHBsYWNlIHRvIGRvIHRoaXMuXG5cdFx0XHRcdFx0XHRjaGlsZC5zZXRVcHBlckFuZExvd2VyRWxlbWVudHMoc3BlY2lhbFlSZXNvbHZlZCk7XG5cdFx0XHRcdFx0XHR0aGlzLnB1c2hUb3AoY2hpbGQudG9wKTtcblx0XHRcdFx0XHRcdHRoaXMucHVzaEJvdHRvbShjaGlsZC5ib3R0b20pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5nZXRNaW5XaWR0aCA9IGZ1bmN0aW9uICgpIHsgLy8gYWJzb2x1dGUgc3BhY2UgdGFrZW4gdG8gdGhlIHJpZ2h0IG9mIHRoZSBub3RlXG5cdHJldHVybiB0aGlzLnc7XG59O1xuXG5BYnNvbHV0ZUVsZW1lbnQucHJvdG90eXBlLmdldEV4dHJhV2lkdGggPSBmdW5jdGlvbiAoKSB7IC8vIHNwYWNlIG5lZWRlZCB0byB0aGUgbGVmdCBvZiB0aGUgbm90ZVxuXHRyZXR1cm4gLXRoaXMuZXh0cmF3O1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5hZGRFeHRyYSA9IGZ1bmN0aW9uIChleHRyYSkge1xuXHRpZiAoZXh0cmEuZHg8dGhpcy5leHRyYXcpIHRoaXMuZXh0cmF3ID0gZXh0cmEuZHg7XG5cdHRoaXMuZXh0cmFbdGhpcy5leHRyYS5sZW5ndGhdID0gZXh0cmE7XG5cdHRoaXMuYWRkQ2hpbGQoZXh0cmEpO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5hZGRIZWFkID0gZnVuY3Rpb24gKGhlYWQpIHtcblx0aWYgKGhlYWQuZHg8dGhpcy5leHRyYXcpIHRoaXMuZXh0cmF3ID0gaGVhZC5keDtcblx0dGhpcy5oZWFkc1t0aGlzLmhlYWRzLmxlbmd0aF0gPSBoZWFkO1xuXHR0aGlzLmFkZFJpZ2h0KGhlYWQpO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5hZGRSaWdodCA9IGZ1bmN0aW9uIChyaWdodCkge1xuXHRpZiAocmlnaHQuZHgrcmlnaHQudz50aGlzLncpIHRoaXMudyA9IHJpZ2h0LmR4K3JpZ2h0Lnc7XG5cdHRoaXMucmlnaHRbdGhpcy5yaWdodC5sZW5ndGhdID0gcmlnaHQ7XG5cdHRoaXMuYWRkQ2hpbGQocmlnaHQpO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5hZGRDZW50ZXJlZCA9IGZ1bmN0aW9uIChlbGVtKSB7XG5cdHZhciBoYWxmID0gZWxlbS53LzI7XG5cdGlmICgtaGFsZjx0aGlzLmV4dHJhdykgdGhpcy5leHRyYXcgPSAtaGFsZjtcblx0dGhpcy5leHRyYVt0aGlzLmV4dHJhLmxlbmd0aF0gPSBlbGVtO1xuXHRpZiAoZWxlbS5keCtoYWxmPnRoaXMudykgdGhpcy53ID0gZWxlbS5keCtoYWxmO1xuXHR0aGlzLnJpZ2h0W3RoaXMucmlnaHQubGVuZ3RoXSA9IGVsZW07XG5cdHRoaXMuYWRkQ2hpbGQoZWxlbSk7XG59O1xuXG5BYnNvbHV0ZUVsZW1lbnQucHJvdG90eXBlLnNldExpbWl0ID0gZnVuY3Rpb24obWVtYmVyLCBjaGlsZCkge1xuXHRpZiAoIWNoaWxkW21lbWJlcl0pIHJldHVybjtcblx0aWYgKCF0aGlzLnNwZWNpYWxZW21lbWJlcl0pXG5cdFx0dGhpcy5zcGVjaWFsWVttZW1iZXJdID0gY2hpbGRbbWVtYmVyXTtcblx0ZWxzZVxuXHRcdHRoaXMuc3BlY2lhbFlbbWVtYmVyXSA9IE1hdGgubWF4KHRoaXMuc3BlY2lhbFlbbWVtYmVyXSwgY2hpbGRbbWVtYmVyXSk7XG59O1xuXG5BYnNvbHV0ZUVsZW1lbnQucHJvdG90eXBlLmFkZENoaWxkID0gZnVuY3Rpb24gKGNoaWxkKSB7XG5cdC8vY29uc29sZS5sb2coXCJSZWxhdGl2ZTpcIixjaGlsZCk7XG5cdGNoaWxkLnBhcmVudCA9IHRoaXM7XG5cdHRoaXMuY2hpbGRyZW5bdGhpcy5jaGlsZHJlbi5sZW5ndGhdID0gY2hpbGQ7XG5cdHRoaXMucHVzaFRvcChjaGlsZC50b3ApO1xuXHR0aGlzLnB1c2hCb3R0b20oY2hpbGQuYm90dG9tKTtcblx0dGhpcy5zZXRMaW1pdCgndGVtcG9IZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgncGFydEhlaWdodEFib3ZlJywgY2hpbGQpO1xuXHR0aGlzLnNldExpbWl0KCd2b2x1bWVIZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgnZHluYW1pY0hlaWdodEFib3ZlJywgY2hpbGQpO1xuXHR0aGlzLnNldExpbWl0KCdlbmRpbmdIZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgnY2hvcmRIZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgnbHlyaWNIZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgnbHlyaWNIZWlnaHRCZWxvdycsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgnY2hvcmRIZWlnaHRCZWxvdycsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgndm9sdW1lSGVpZ2h0QmVsb3cnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ2R5bmFtaWNIZWlnaHRCZWxvdycsIGNoaWxkKTtcbn07XG5cbkFic29sdXRlRWxlbWVudC5wcm90b3R5cGUucHVzaFRvcCA9IGZ1bmN0aW9uICh0b3ApIHtcblx0aWYgKHRvcCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0aWYgKHRoaXMudG9wID09PSB1bmRlZmluZWQpXG5cdFx0XHR0aGlzLnRvcCA9IHRvcDtcblx0XHRlbHNlXG5cdFx0XHR0aGlzLnRvcCA9IE1hdGgubWF4KHRvcCwgdGhpcy50b3ApO1xuXHR9XG59O1xuXG5BYnNvbHV0ZUVsZW1lbnQucHJvdG90eXBlLnB1c2hCb3R0b20gPSBmdW5jdGlvbiAoYm90dG9tKSB7XG5cdGlmIChib3R0b20gIT09IHVuZGVmaW5lZCkge1xuXHRcdGlmICh0aGlzLmJvdHRvbSA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0dGhpcy5ib3R0b20gPSBib3R0b207XG5cdFx0ZWxzZVxuXHRcdFx0dGhpcy5ib3R0b20gPSBNYXRoLm1pbihib3R0b20sIHRoaXMuYm90dG9tKTtcblx0fVxufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5zZXRYID0gZnVuY3Rpb24gKHgpIHtcblx0dGhpcy54ID0geDtcblx0Zm9yICh2YXIgaT0wOyBpPHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspXG5cdFx0dGhpcy5jaGlsZHJlbltpXS5zZXRYKHgpO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5zZXRIaW50ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmhpbnQgPSB0cnVlO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKHJlbmRlcmVyLCBiYXJ0b3ApIHtcblx0aWYgKHRoaXMuaW52aXNpYmxlKSByZXR1cm47XG5cdHRoaXMuZWxlbXNldCA9IFtdO1xuXHRyZW5kZXJlci5iZWdpbkdyb3VwKCk7XG5cdGZvciAodmFyIGk9MDsgaTx0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0aWYgKC8qQUJDSlMud3JpdGUuZGVidWdQbGFjZW1lbnQqL2ZhbHNlKSB7XG5cdFx0XHRpZiAodGhpcy5jaGlsZHJlbltpXS5rbGFzcyA9PT0gJ29ybmFtZW50Jylcblx0XHRcdFx0cmVuZGVyZXIucHJpbnRTaGFkZWRCb3godGhpcy54LCByZW5kZXJlci5jYWxjWSh0aGlzLmNoaWxkcmVuW2ldLnRvcCksIHRoaXMudywgcmVuZGVyZXIuY2FsY1kodGhpcy5jaGlsZHJlbltpXS5ib3R0b20pLXJlbmRlcmVyLmNhbGNZKHRoaXMuY2hpbGRyZW5baV0udG9wKSwgXCJyZ2IoMCwwLDIwMClcIiwgMC4zKTtcblx0XHR9XG5cdFx0dmFyIGVsID0gdGhpcy5jaGlsZHJlbltpXS5kcmF3KHJlbmRlcmVyLGJhcnRvcCk7XG5cdFx0aWYgKGVsKVxuXHRcdFx0dGhpcy5lbGVtc2V0LnB1c2goZWwpO1xuXHR9XG5cdHZhciBrbGFzcyA9IHRoaXMudHlwZTtcblx0aWYgKHRoaXMudHlwZSA9PT0gJ25vdGUnIHx8IHRoaXMudHlwZSA9PT0gJ3Jlc3QnKSB7XG5cdFx0a2xhc3MgKz0gJyBkJyArIHRoaXMuZHVyYXRpb25DbGFzcztcblx0XHRrbGFzcyA9IGtsYXNzLnJlcGxhY2UoL1xcLi9nLCAnLScpO1xuXHRcdGlmICh0aGlzLmFiY2VsZW0ucGl0Y2hlcykge1xuXHRcdFx0Zm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLmFiY2VsZW0ucGl0Y2hlcy5sZW5ndGg7IGorKykge1xuXHRcdFx0XHRrbGFzcyArPSAnIHAnICsgdGhpcy5hYmNlbGVtLnBpdGNoZXNbal0ucGl0Y2g7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cdHZhciBnID0gcmVuZGVyZXIuZW5kR3JvdXAoa2xhc3MpO1xuXHRpZiAoZylcblx0XHR0aGlzLmVsZW1zZXQucHVzaChnKTtcblx0aWYgKHRoaXMua2xhc3MpXG5cdFx0dGhpcy5zZXRDbGFzcyhcIm1hcmtcIiwgXCJcIiwgXCIjMDBmZjAwXCIpO1xuXHRpZiAodGhpcy5oaW50KVxuXHRcdHRoaXMuc2V0Q2xhc3MoXCJhYmNqcy1oaW50XCIsIFwiXCIsIG51bGwpO1xuXHR2YXIgb3BhY2l0eSA9IC8qQUJDSlMud3JpdGUuZGVidWdQbGFjZW1lbnQqL2ZhbHNlID8gMC4zIDogMDsgLy8gQ3JlYXRlIHRyYW5zcGFyZW50IGJveCB0aGF0IGVuY29tcGFzc2VzIHRoZSBlbGVtZW50LCBhbmQgbm90IHNvIHRyYW5zcGFyZW50IHRvIGRlYnVnIGl0LlxuXHR2YXIgdGFyZ2V0ID0gcmVuZGVyZXIucHJpbnRTaGFkZWRCb3godGhpcy54LCByZW5kZXJlci5jYWxjWSh0aGlzLnRvcCksIHRoaXMudywgcmVuZGVyZXIuY2FsY1kodGhpcy5ib3R0b20pLXJlbmRlcmVyLmNhbGNZKHRoaXMudG9wKSwgXCIjMDAwMDAwXCIsIG9wYWNpdHkpO1xuXHR2YXIgc2VsZiA9IHRoaXM7XG5cdHZhciBjb250cm9sbGVyID0gcmVuZGVyZXIuY29udHJvbGxlcjtcblx0dGFyZ2V0LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBmdW5jdGlvbiAoKSB7XG5cdFx0dmFyIGNsYXNzZXMgPSBbXTtcblx0XHRpZiAoc2VsZi5lbGVtc2V0KSB7XG5cdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IHNlbGYuZWxlbXNldC5sZW5ndGg7IGorKykge1xuXHRcdFx0XHR2YXIgZXMgPSBzZWxmLmVsZW1zZXRbal07XG5cdFx0XHRcdGlmIChlcylcblx0XHRcdFx0XHRjbGFzc2VzLnB1c2goZXMuZ2V0QXR0cmlidXRlKFwiY2xhc3NcIikpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRjb250cm9sbGVyLm5vdGlmeVNlbGVjdChzZWxmLCBzZWxmLnR1bmVOdW1iZXIsIGNsYXNzZXMpO1xuXHR9KTtcblx0dGhpcy5hYmNlbGVtLmFic2VsZW0gPSB0aGlzO1xuXG5cdHZhciBzdGVwID0gc3BhY2luZy5TVEVQO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5pc0lFPS8qQGNjX29uIUAqL2ZhbHNlOy8vSUUgZGV0ZWN0b3JcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS5zZXRDbGFzcyA9IGZ1bmN0aW9uIChhZGRDbGFzcywgcmVtb3ZlQ2xhc3MsIGNvbG9yKSB7XG5cdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbGVtc2V0Lmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGVsID0gdGhpcy5lbGVtc2V0W2ldO1xuXHRcdGVsLnNldEF0dHJpYnV0ZShcImZpbGxcIiwgY29sb3IpO1xuXHRcdHZhciBrbHMgPSBlbC5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcblx0XHRpZiAoIWtscykga2xzID0gXCJcIjtcblx0XHRrbHMgPSBrbHMucmVwbGFjZShyZW1vdmVDbGFzcywgXCJcIik7XG5cdFx0a2xzID0ga2xzLnJlcGxhY2UoYWRkQ2xhc3MsIFwiXCIpO1xuXHRcdGlmIChhZGRDbGFzcy5sZW5ndGggPiAwKSB7XG5cdFx0XHRpZiAoa2xzLmxlbmd0aCA+IDAgJiYga2xzLmNoYXJBdChrbHMubGVuZ3RoIC0gMSkgIT09ICcgJykga2xzICs9IFwiIFwiO1xuXHRcdFx0a2xzICs9IGFkZENsYXNzO1xuXHRcdH1cblx0XHRlbC5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBrbHMpO1xuXHR9XG59O1xuXG5BYnNvbHV0ZUVsZW1lbnQucHJvdG90eXBlLmhpZ2hsaWdodCA9IGZ1bmN0aW9uIChrbGFzcywgY29sb3IpIHtcblx0aWYgKGtsYXNzID09PSB1bmRlZmluZWQpXG5cdFx0a2xhc3MgPSBcImFiY2pzLW5vdGVfc2VsZWN0ZWRcIjtcblx0aWYgKGNvbG9yID09PSB1bmRlZmluZWQpXG5cdFx0Y29sb3IgPSBcIiNmZjAwMDBcIjtcblx0dGhpcy5zZXRDbGFzcyhrbGFzcywgXCJcIiwgY29sb3IpO1xufTtcblxuQWJzb2x1dGVFbGVtZW50LnByb3RvdHlwZS51bmhpZ2hsaWdodCA9IGZ1bmN0aW9uIChrbGFzcywgY29sb3IpIHtcblx0aWYgKGtsYXNzID09PSB1bmRlZmluZWQpXG5cdFx0a2xhc3MgPSBcImFiY2pzLW5vdGVfc2VsZWN0ZWRcIjtcblx0aWYgKGNvbG9yID09PSB1bmRlZmluZWQpXG5cdFx0Y29sb3IgPSBcIiMwMDAwMDBcIjtcblx0dGhpcy5zZXRDbGFzcyhcIlwiLCBrbGFzcywgY29sb3IpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBYnNvbHV0ZUVsZW1lbnQ7XG4iLCIvLyBhYmNfYWJzdHJhY3RfZW5ncmF2ZXIuanM6IENyZWF0ZXMgYSBkYXRhIHN0cnVjdHVyZSBzdWl0YWJsZSBmb3IgcHJpbnRpbmcgYSBsaW5lIG9mIGFiY1xuLy8gQ29weXJpZ2h0IChDKSAyMDEwLTIwMTggR3JlZ29yeSBEeWtlIChncmVnZHlrZSBhdCBnbWFpbCBkb3QgY29tKVxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgQWJzb2x1dGVFbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfYWJzb2x1dGVfZWxlbWVudCcpO1xudmFyIEJlYW1FbGVtID0gcmVxdWlyZSgnLi9hYmNfYmVhbV9lbGVtZW50Jyk7XG52YXIgQnJhY2VFbGVtID0gcmVxdWlyZSgnLi9hYmNfYnJhY2VfZWxlbWVudCcpO1xudmFyIGNyZWF0ZUNsZWYgPSByZXF1aXJlKCcuL2FiY19jcmVhdGVfY2xlZicpO1xudmFyIGNyZWF0ZUtleVNpZ25hdHVyZSA9IHJlcXVpcmUoJy4vYWJjX2NyZWF0ZV9rZXlfc2lnbmF0dXJlJyk7XG52YXIgY3JlYXRlVGltZVNpZ25hdHVyZSA9IHJlcXVpcmUoJy4vYWJjX2NyZWF0ZV90aW1lX3NpZ25hdHVyZScpO1xudmFyIERlY29yYXRpb24gPSByZXF1aXJlKCcuL2FiY19kZWNvcmF0aW9uJyk7XG52YXIgRW5kaW5nRWxlbSA9IHJlcXVpcmUoJy4vYWJjX2VuZGluZ19lbGVtZW50Jyk7XG52YXIgZ2x5cGhzID0gcmVxdWlyZSgnLi9hYmNfZ2x5cGhzJyk7XG52YXIgUmVsYXRpdmVFbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfcmVsYXRpdmVfZWxlbWVudCcpO1xudmFyIHNwYWNpbmcgPSByZXF1aXJlKCcuL2FiY19zcGFjaW5nJyk7XG52YXIgU3RhZmZHcm91cEVsZW1lbnQgPSByZXF1aXJlKCcuL2FiY19zdGFmZl9ncm91cF9lbGVtZW50Jyk7XG52YXIgVGVtcG9FbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfdGVtcG9fZWxlbWVudCcpO1xudmFyIFRpZUVsZW0gPSByZXF1aXJlKCcuL2FiY190aWVfZWxlbWVudCcpO1xudmFyIFRyaXBsZXRFbGVtID0gcmVxdWlyZSgnLi9hYmNfdHJpcGxldF9lbGVtZW50Jyk7XG52YXIgVm9pY2VFbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfdm9pY2VfZWxlbWVudCcpO1xuXG52YXIgcGFyc2VDb21tb24gPSByZXF1aXJlKCcuLi9wYXJzZS9hYmNfY29tbW9uJyk7XG5cbnZhciBBYnN0cmFjdEVuZ3JhdmVyO1xuXG4oZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG52YXIgZ2V0RHVyYXRpb24gPSBmdW5jdGlvbihlbGVtKSB7XG4gIHZhciBkID0gMDtcbiAgaWYgKGVsZW0uZHVyYXRpb24pIHtcbiAgICBkID0gZWxlbS5kdXJhdGlvbjtcbiAgfVxuICByZXR1cm4gZDtcbn07XG5cbnZhciBoaW50ID0gZmFsc2U7XG5cblx0dmFyIGNoYXJ0YWJsZSA9IHtcblx0XHRyZXN0OnswOlwicmVzdHMud2hvbGVcIiwgMTpcInJlc3RzLmhhbGZcIiwgMjpcInJlc3RzLnF1YXJ0ZXJcIiwgMzpcInJlc3RzLjh0aFwiLCA0OiBcInJlc3RzLjE2dGhcIiw1OiBcInJlc3RzLjMybmRcIiwgNjogXCJyZXN0cy42NHRoXCIsIDc6IFwicmVzdHMuMTI4dGhcIiwgXCJtdWx0aVwiOiBcInJlc3RzLm11bHRpbWVhc3VyZVwifSxcblx0XHRub3RlOntcIi0xXCI6IFwibm90ZWhlYWRzLmRibFwiLCAwOlwibm90ZWhlYWRzLndob2xlXCIsIDE6XCJub3RlaGVhZHMuaGFsZlwiLCAyOlwibm90ZWhlYWRzLnF1YXJ0ZXJcIiwgMzpcIm5vdGVoZWFkcy5xdWFydGVyXCIsIDQ6XCJub3RlaGVhZHMucXVhcnRlclwiLCA1Olwibm90ZWhlYWRzLnF1YXJ0ZXJcIiwgNjpcIm5vdGVoZWFkcy5xdWFydGVyXCIsIDc6XCJub3RlaGVhZHMucXVhcnRlclwiLCAnbm9zdGVtJzpcIm5vdGVoZWFkcy5xdWFydGVyXCJ9LFxuXHRcdHJoeXRobTp7XCItMVwiOiBcIm5vdGVoZWFkcy5zbGFzaC53aG9sZVwiLCAwOlwibm90ZWhlYWRzLnNsYXNoLndob2xlXCIsIDE6XCJub3RlaGVhZHMuc2xhc2gud2hvbGVcIiwgMjpcIm5vdGVoZWFkcy5zbGFzaC5xdWFydGVyXCIsIDM6XCJub3RlaGVhZHMuc2xhc2gucXVhcnRlclwiLCA0Olwibm90ZWhlYWRzLnNsYXNoLnF1YXJ0ZXJcIiwgNTpcIm5vdGVoZWFkcy5zbGFzaC5xdWFydGVyXCIsIDY6XCJub3RlaGVhZHMuc2xhc2gucXVhcnRlclwiLCA3Olwibm90ZWhlYWRzLnNsYXNoLnF1YXJ0ZXJcIiwgbm9zdGVtOiBcIm5vdGVoZWFkcy5zbGFzaC5ub3N0ZW1cIn0sXG5cdFx0eDp7XCItMVwiOiBcIm5vdGVoZWFkcy5pbmRldGVybWluYXRlXCIsIDA6XCJub3RlaGVhZHMuaW5kZXRlcm1pbmF0ZVwiLCAxOlwibm90ZWhlYWRzLmluZGV0ZXJtaW5hdGVcIiwgMjpcIm5vdGVoZWFkcy5pbmRldGVybWluYXRlXCIsIDM6XCJub3RlaGVhZHMuaW5kZXRlcm1pbmF0ZVwiLCA0Olwibm90ZWhlYWRzLmluZGV0ZXJtaW5hdGVcIiwgNTpcIm5vdGVoZWFkcy5pbmRldGVybWluYXRlXCIsIDY6XCJub3RlaGVhZHMuaW5kZXRlcm1pbmF0ZVwiLCA3Olwibm90ZWhlYWRzLmluZGV0ZXJtaW5hdGVcIiwgbm9zdGVtOiBcIm5vdGVoZWFkcy5pbmRldGVybWluYXRlXCJ9LFxuXHRcdGhhcm1vbmljOntcIi0xXCI6IFwibm90ZWhlYWRzLmhhcm1vbmljLnF1YXJ0ZXJcIiwgMDpcIm5vdGVoZWFkcy5oYXJtb25pYy5xdWFydGVyXCIsIDE6XCJub3RlaGVhZHMuaGFybW9uaWMucXVhcnRlclwiLCAyOlwibm90ZWhlYWRzLmhhcm1vbmljLnF1YXJ0ZXJcIiwgMzpcIm5vdGVoZWFkcy5oYXJtb25pYy5xdWFydGVyXCIsIDQ6XCJub3RlaGVhZHMuaGFybW9uaWMucXVhcnRlclwiLCA1Olwibm90ZWhlYWRzLmhhcm1vbmljLnF1YXJ0ZXJcIiwgNjpcIm5vdGVoZWFkcy5oYXJtb25pYy5xdWFydGVyXCIsIDc6XCJub3RlaGVhZHMuaGFybW9uaWMucXVhcnRlclwiLCBub3N0ZW06IFwibm90ZWhlYWRzLmhhcm1vbmljLnF1YXJ0ZXJcIn0sXG5cdFx0dWZsYWdzOnszOlwiZmxhZ3MudTh0aFwiLCA0OlwiZmxhZ3MudTE2dGhcIiwgNTpcImZsYWdzLnUzMm5kXCIsIDY6XCJmbGFncy51NjR0aFwifSxcblx0XHRkZmxhZ3M6ezM6XCJmbGFncy5kOHRoXCIsIDQ6XCJmbGFncy5kMTZ0aFwiLCA1OlwiZmxhZ3MuZDMybmRcIiwgNjpcImZsYWdzLmQ2NHRoXCJ9XG5cdH07XG5cbkFic3RyYWN0RW5ncmF2ZXIgPSBmdW5jdGlvbihiYWdwaXBlcywgcmVuZGVyZXIsIHR1bmVOdW1iZXIpIHtcblx0dGhpcy5kZWNvcmF0aW9uID0gbmV3IERlY29yYXRpb24oKTtcblx0dGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xuXHR0aGlzLnR1bmVOdW1iZXIgPSB0dW5lTnVtYmVyO1xuICB0aGlzLmlzQmFncGlwZXMgPSBiYWdwaXBlcztcblx0dGhpcy5yZXNldCgpO1xufTtcblxuQWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcblx0dGhpcy5zbHVycyA9IHt9O1xuXHR0aGlzLnRpZXMgPSBbXTtcblx0dGhpcy5zbHVyc2J5dm9pY2UgPSB7fTtcblx0dGhpcy50aWVzYnl2b2ljZSA9IHt9O1xuXHR0aGlzLmVuZGluZ3NieXZvaWNlID0ge307XG5cdHRoaXMudHJpcGxldG11bHRpcGxpZXIgPSAxO1xuXG5cdHRoaXMuYWJjbGluZSA9IHVuZGVmaW5lZDtcblx0dGhpcy5hY2NpZGVudGFsU2xvdCA9IHVuZGVmaW5lZDtcblx0dGhpcy5hY2NpZGVudGFsc2hpZnR4ID0gdW5kZWZpbmVkO1xuXHR0aGlzLmRvdHNoaWZ0eCA9IHVuZGVmaW5lZDtcblx0dGhpcy5oYXNWb2NhbHMgPSBmYWxzZTtcblx0dGhpcy5taW5ZID0gdW5kZWZpbmVkO1xuXHR0aGlzLnBhcnRzdGFydGVsZW0gPSB1bmRlZmluZWQ7XG5cdHRoaXMuc3RhcnRsaW1pdGVsZW0gPSB1bmRlZmluZWQ7XG5cdHRoaXMuc3RlbWRpciA9IHVuZGVmaW5lZDtcbn07XG5cbkFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLnNldFN0ZW1IZWlnaHQgPSBmdW5jdGlvbihoZWlnaHRJblBpeGVscykge1xuXHR0aGlzLnN0ZW1IZWlnaHQgPSBoZWlnaHRJblBpeGVscyAvIHNwYWNpbmcuU1RFUDtcbn07XG5cbkFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLmdldEN1cnJlbnRWb2ljZUlkID0gZnVuY3Rpb24ocyx2KSB7XG4gIHJldHVybiBcInNcIitzK1widlwiK3Y7XG59O1xuXG5BYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5wdXNoQ3Jvc3NMaW5lRWxlbXMgPSBmdW5jdGlvbihzLHYpIHtcbiAgdGhpcy5zbHVyc2J5dm9pY2VbdGhpcy5nZXRDdXJyZW50Vm9pY2VJZChzLHYpXSA9IHRoaXMuc2x1cnM7XG4gIHRoaXMudGllc2J5dm9pY2VbdGhpcy5nZXRDdXJyZW50Vm9pY2VJZChzLHYpXSA9IHRoaXMudGllcztcbiAgdGhpcy5lbmRpbmdzYnl2b2ljZVt0aGlzLmdldEN1cnJlbnRWb2ljZUlkKHMsdildID0gdGhpcy5wYXJ0c3RhcnRlbGVtO1xufTtcblxuQWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUucG9wQ3Jvc3NMaW5lRWxlbXMgPSBmdW5jdGlvbihzLHYpIHtcbiAgdGhpcy5zbHVycyA9IHRoaXMuc2x1cnNieXZvaWNlW3RoaXMuZ2V0Q3VycmVudFZvaWNlSWQocyx2KV0gfHwge307XG4gIHRoaXMudGllcyA9IHRoaXMudGllc2J5dm9pY2VbdGhpcy5nZXRDdXJyZW50Vm9pY2VJZChzLHYpXSB8fCBbXTtcbiAgdGhpcy5wYXJ0c3RhcnRlbGVtID0gdGhpcy5lbmRpbmdzYnl2b2ljZVt0aGlzLmdldEN1cnJlbnRWb2ljZUlkKHMsdildO1xufTtcblxuXHRBYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5jb250YWluc0x5cmljcyA9IGZ1bmN0aW9uKHN0YXZlcykge1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc3RhdmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IHN0YXZlc1tpXS52b2ljZXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCBzdGF2ZXNbaV0udm9pY2VzW2pdLmxlbmd0aDsgaysrKSB7XG5cdFx0XHRcdFx0dmFyIGVsID0gc3RhdmVzW2ldLnZvaWNlc1tqXVtrXTtcblx0XHRcdFx0XHRpZiAoZWwubHlyaWMpIHtcblx0XHRcdFx0XHRcdC8vIFdlIGp1c3Qgd2FudCB0byBzZWUgaWYgdGhlcmUgYXJlIHZvY2FscyBiZWxvdyB0aGUgbXVzaWMgdG8ga25vdyB3aGVyZSB0byBwdXQgdGhlIGR5bmFtaWNzLlxuXHRcdFx0XHRcdFx0aWYgKCFlbC5wb3NpdGlvbmluZyB8fCBlbC5wb3NpdGlvbmluZy52b2NhbFBvc2l0aW9uID09PSAnYmVsb3cnKVxuXHRcdFx0XHRcdFx0XHR0aGlzLmhhc1ZvY2FscyA9IHRydWU7XG5cdFx0XHRcdFx0XHRyZXR1cm47XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHR9O1xuXG5BYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5jcmVhdGVBQkNMaW5lID0gZnVuY3Rpb24oc3RhZmZzLCB0ZW1wbykge1xuICAgIHRoaXMubWluWSA9IDI7IC8vIFBFUjogVGhpcyB3aWxsIGJlIHRoZSBsb3dlc3QgdGhhdCBhbnkgbm90ZSByZWFjaGVzLiBJdCB3aWxsIGJlIHVzZWQgdG8gc2V0IHRoZSBkeW5hbWljcyByb3cuXG5cdC8vIFNlZSBpZiB0aGVyZSBhcmUgYW55IGx5cmljcyBvbiB0aGlzIGxpbmUuXG5cdHRoaXMuY29udGFpbnNMeXJpY3Moc3RhZmZzKTtcbiAgdmFyIHN0YWZmZ3JvdXAgPSBuZXcgU3RhZmZHcm91cEVsZW1lbnQoKTtcblx0dGhpcy50ZW1wb1NldCA9IGZhbHNlO1xuICBmb3IgKHZhciBzID0gMDsgcyA8IHN0YWZmcy5sZW5ndGg7IHMrKykge1xuXHQgIGlmIChoaW50KVxuXHRcdCAgdGhpcy5yZXN0b3JlU3RhdGUoKTtcblx0ICBoaW50ID0gZmFsc2U7XG4gICAgdGhpcy5jcmVhdGVBQkNTdGFmZihzdGFmZmdyb3VwLCBzdGFmZnNbc10sIHRlbXBvLCBzKTtcbiAgfVxuICByZXR1cm4gc3RhZmZncm91cDtcbn07XG5cbkFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLmNyZWF0ZUFCQ1N0YWZmID0gZnVuY3Rpb24oc3RhZmZncm91cCwgYWJjc3RhZmYsIHRlbXBvLCBzKSB7XG4vLyBJZiB0aGUgdGVtcG8gaXMgcGFzc2VkIGluLCB0aGVuIHRoZSBmaXJzdCBlbGVtZW50IHNob3VsZCBnZXQgdGhlIHRlbXBvIGF0dGFjaGVkIHRvIGl0LlxuICBmb3IgKHZhciB2ID0gMDsgdiA8IGFiY3N0YWZmLnZvaWNlcy5sZW5ndGg7IHYrKykge1xuICAgIHZhciB2b2ljZSA9IG5ldyBWb2ljZUVsZW1lbnQodixhYmNzdGFmZi52b2ljZXMubGVuZ3RoKTtcbiAgICBpZiAodj09PTApIHtcblx0ICAgIHZvaWNlLmJhcmZyb20gPSAoYWJjc3RhZmYuY29ubmVjdEJhckxpbmVzPT09XCJzdGFydFwiIHx8IGFiY3N0YWZmLmNvbm5lY3RCYXJMaW5lcz09PVwiY29udGludWVcIik7XG5cdCAgICB2b2ljZS5iYXJ0byA9IChhYmNzdGFmZi5jb25uZWN0QmFyTGluZXM9PT1cImNvbnRpbnVlXCIgfHwgYWJjc3RhZmYuY29ubmVjdEJhckxpbmVzPT09XCJlbmRcIik7XG4gICAgfSBlbHNlIHtcblx0ICAgIHZvaWNlLmR1cGxpY2F0ZSA9IHRydWU7IC8vIGJhciBsaW5lcyBhbmQgb3RoZXIgZHVwbGljYXRlIGluZm8gbmVlZCBub3QgYmUgY3JlYXRlZFxuICAgIH1cbiAgICBpZiAoYWJjc3RhZmYudGl0bGUgJiYgYWJjc3RhZmYudGl0bGVbdl0pIHZvaWNlLmhlYWRlcj1hYmNzdGFmZi50aXRsZVt2XTtcblx0ICB2YXIgY2xlZiA9IGNyZWF0ZUNsZWYoYWJjc3RhZmYuY2xlZiwgdGhpcy50dW5lTnVtYmVyKTtcblx0ICBpZiAoY2xlZikge1xuXHRcdCAgaWYgKHYgPT09MCAmJiBhYmNzdGFmZi5iYXJOdW1iZXIpIHtcblx0XHRcdCAgdGhpcy5hZGRNZWFzdXJlTnVtYmVyKGFiY3N0YWZmLmJhck51bWJlciwgY2xlZik7XG5cdFx0ICB9XG5cdFx0ICB2b2ljZS5hZGRDaGlsZChjbGVmKTtcblx0ICB9XG5cdCAgdmFyIGtleVNpZyA9IGNyZWF0ZUtleVNpZ25hdHVyZShhYmNzdGFmZi5rZXksIHRoaXMudHVuZU51bWJlcik7XG5cdCAgaWYgKGtleVNpZykge1xuXHRcdCAgdm9pY2UuYWRkQ2hpbGQoa2V5U2lnKTtcblx0XHQgIHRoaXMuc3RhcnRsaW1pdGVsZW0gPSBrZXlTaWc7IC8vIGxpbWl0IHRpZXMgaGVyZVxuXHQgIH1cbiAgICBpZiAoYWJjc3RhZmYubWV0ZXIpIHtcblx0XHR2YXIgdHMgPSBjcmVhdGVUaW1lU2lnbmF0dXJlKGFiY3N0YWZmLm1ldGVyLCB0aGlzLnR1bmVOdW1iZXIpO1xuXHQgICAgdm9pY2UuYWRkQ2hpbGQodHMpO1xuXHRcdHRoaXMuc3RhcnRsaW1pdGVsZW0gPSB0czsgLy8gbGltaXQgdGllcyBoZXJlXG5cdH1cblx0ICBpZiAodm9pY2UuZHVwbGljYXRlKVxuXHRcdCAgdm9pY2UuY2hpbGRyZW4gPSBbXTsgLy8gd2Ugc2hvdWxkbid0IHJlcHJpbnQgdGhlIGFib3ZlIGlmIHdlJ3JlIHJldXNpbmcgdGhlIHNhbWUgc3RhZmYuIFdlIGp1c3QgY3JlYXRlZCB0aGVtIHRvIGdldCB0aGUgcmlnaHQgc3BhY2luZy5cbiAgICB2YXIgc3RhZmZMaW5lcyA9IGFiY3N0YWZmLmNsZWYuc3RhZmZsaW5lcyB8fCBhYmNzdGFmZi5jbGVmLnN0YWZmbGluZXMgPT09IDAgPyBhYmNzdGFmZi5jbGVmLnN0YWZmbGluZXMgOiA1O1xuICAgIHN0YWZmZ3JvdXAuYWRkVm9pY2Uodm9pY2UscyxzdGFmZkxpbmVzKTtcblx0ICB2YXIgaXNTaW5nbGVMaW5lU3RhZmYgPSBzdGFmZkxpbmVzID09PSAxO1xuXHQgIHRoaXMuY3JlYXRlQUJDVm9pY2UoYWJjc3RhZmYudm9pY2VzW3ZdLHRlbXBvLCBzLCB2LCBpc1NpbmdsZUxpbmVTdGFmZiwgdm9pY2UpO1xuXHQgIHN0YWZmZ3JvdXAuc2V0U3RhZmZMaW1pdHModm9pY2UpO1xuICAgICAgICAgICAgLy9Ub255OiBIZXJlIEkgYW0gZm9sbG93aW5nIHdoYXQgc3RhdmVzIG5lZWQgdG8gYmUgc3Vycm91bmRlZCBieSB0aGUgYnJhY2UsIGJ5IGluY3JlbWVudGluZyB0aGUgbGVuZ3RoIG9mIHRoZSBicmFjZSBjbGFzcy5cbiAgICAgICAgICAgIC8vU28gYmFzaWNhbGx5IHRoaXMga2VlcHMgaW5jcmVtZW50aW5nIHRoZSBudW1iZXIgb2Ygc3RhZmYgc3Vycm91bmRlZCBieSB0aGUgYnJhY2UgdW50aWwgaXQgc2VlcyBcImVuZFwiLlxuICAgICAgICAgICAgLy9UaGlzIHRoZW4gZ2V0cyBwcm9jZXNzZWQgaW4gYWJjX3N0YWZmX2dyb3VwX2VsZW1lbnQuanMsIHNvIHRoYXQgaXQgd2lsbCBoYXZlIHRoZSBjb3JyZWN0IHRvcCBhbmQgYm90dG9tIGNvb3JkaW5hdGVzIGZvciB0aGUgYnJhY2UuXG5cdFx0XHRpZihhYmNzdGFmZi5icmFjZSA9PT0gXCJzdGFydFwiKXtcblx0XHRcdFx0c3RhZmZncm91cC5icmFjZSA9IG5ldyBCcmFjZUVsZW0oMSwgdHJ1ZSk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKGFiY3N0YWZmLmJyYWNlID09PSBcImVuZFwiICYmIHN0YWZmZ3JvdXAuYnJhY2UpIHtcblx0XHRcdFx0c3RhZmZncm91cC5icmFjZS5pbmNyZWFzZVN0YXZlc0luY2x1ZGVkKCk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmKGFiY3N0YWZmLmJyYWNlID09PSBcImNvbnRpbnVlXCIgJiYgc3RhZmZncm91cC5icmFjZSl7XG5cdFx0XHRcdHN0YWZmZ3JvdXAuYnJhY2UuaW5jcmVhc2VTdGF2ZXNJbmNsdWRlZCgpO1xuXHRcdFx0fVxuICB9XG59O1xuXG5mdW5jdGlvbiBnZXRCZWFtR3JvdXAoYWJjbGluZSwgcG9zKSB7XG5cdC8vIElmIHRoZXJlIGFyZSBub3RlcyBiZWFtZWQgdG9nZXRoZXIsIHRoZXkgYXJlIGhhbmRsZWQgYXMgYSBncm91cCwgc28gZmluZCBhbGwgb2YgdGhlbSBoZXJlLlxuXHR2YXIgZWxlbSA9IGFiY2xpbmVbcG9zXTtcblx0aWYgKGVsZW0uZWxfdHlwZSAhPT0gJ25vdGUnIHx8ICFlbGVtLnN0YXJ0QmVhbSB8fCBlbGVtLmVuZEJlYW0pXG5cdFx0cmV0dXJuIHsgY291bnQ6IDEsIGVsZW06IGVsZW0gfTtcblxuXHR2YXIgZ3JvdXAgPSBbXTtcblx0d2hpbGUgKHBvcyA8IGFiY2xpbmUubGVuZ3RoICYmIGFiY2xpbmVbcG9zXS5lbF90eXBlID09PSAnbm90ZScpIHtcblx0XHRncm91cC5wdXNoKGFiY2xpbmVbcG9zXSk7XG5cdFx0aWYgKGFiY2xpbmVbcG9zXS5lbmRCZWFtKVxuXHRcdFx0YnJlYWs7XG5cdFx0cG9zKys7XG5cdH1cblx0cmV0dXJuIHsgY291bnQ6IGdyb3VwLmxlbmd0aCwgZWxlbTogZ3JvdXAgfTtcbn1cblxuQWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUuY3JlYXRlQUJDVm9pY2UgPSBmdW5jdGlvbihhYmNsaW5lLCB0ZW1wbywgcywgdiwgaXNTaW5nbGVMaW5lU3RhZmYsIHZvaWNlKSB7XG4gIHRoaXMucG9wQ3Jvc3NMaW5lRWxlbXMocyx2KTtcbiAgdGhpcy5zdGVtZGlyID0gKHRoaXMuaXNCYWdwaXBlcyk/XCJkb3duXCI6bnVsbDtcbiAgdGhpcy5hYmNsaW5lID0gYWJjbGluZTtcbiAgaWYgKHRoaXMucGFydHN0YXJ0ZWxlbSkge1xuICAgIHRoaXMucGFydHN0YXJ0ZWxlbSA9IG5ldyBFbmRpbmdFbGVtKFwiXCIsIG51bGwsIG51bGwpO1xuXHQgIHZvaWNlLmFkZE90aGVyKHRoaXMucGFydHN0YXJ0ZWxlbSk7XG4gIH1cbiAgZm9yICh2YXIgc2x1ciBpbiB0aGlzLnNsdXJzKSB7XG4gICAgaWYgKHRoaXMuc2x1cnMuaGFzT3duUHJvcGVydHkoc2x1cikpIHtcbiAgICAgIHRoaXMuc2x1cnNbc2x1cl09IG5ldyBUaWVFbGVtKG51bGwsIG51bGwsIHRoaXMuc2x1cnNbc2x1cl0uYWJvdmUsIHRoaXMuc2x1cnNbc2x1cl0uZm9yY2UsIGZhbHNlKTtcblx0XHRpZiAoaGludCkgdGhpcy5zbHVyc1tzbHVyXS5zZXRIaW50KCk7XG5cdCAgICB2b2ljZS5hZGRPdGhlcih0aGlzLnNsdXJzW3NsdXJdKTtcbiAgICB9XG4gIH1cbiAgZm9yICh2YXIgaT0wOyBpPHRoaXMudGllcy5sZW5ndGg7IGkrKykge1xuICAgIHRoaXMudGllc1tpXT1uZXcgVGllRWxlbShudWxsLCBudWxsLCB0aGlzLnRpZXNbaV0uYWJvdmUsIHRoaXMudGllc1tpXS5mb3JjZSwgdHJ1ZSk7XG5cdCAgaWYgKGhpbnQpIHRoaXMudGllc1tpXS5zZXRIaW50KCk7XG5cdCAgdm9pY2UuYWRkT3RoZXIodGhpcy50aWVzW2ldKTtcbiAgfVxuXG4gIGZvciAodmFyIGogPSAwOyBqIDwgdGhpcy5hYmNsaW5lLmxlbmd0aDsgaisrKSB7XG5cdCAgc2V0QXZlcmFnZVBpdGNoKHRoaXMuYWJjbGluZVtqXSk7XG5cdCAgdGhpcy5taW5ZID0gTWF0aC5taW4odGhpcy5hYmNsaW5lW2pdLm1pbnBpdGNoLCB0aGlzLm1pblkpO1xuICB9XG5cblx0dmFyIGlzRmlyc3RTdGFmZiA9IChzID09PSAwKTtcblx0dmFyIHBvcyA9IDA7XG5cdHdoaWxlIChwb3MgPCB0aGlzLmFiY2xpbmUubGVuZ3RoKSB7XG5cdFx0dmFyIHJldCA9IGdldEJlYW1Hcm91cCh0aGlzLmFiY2xpbmUsIHBvcyk7XG5cdFx0dmFyIGFic2VsZW1zID0gdGhpcy5jcmVhdGVBQkNFbGVtZW50KGlzRmlyc3RTdGFmZiwgaXNTaW5nbGVMaW5lU3RhZmYsIHZvaWNlLCByZXQuZWxlbSk7XG5cdFx0aWYgKGFic2VsZW1zKSB7XG5cdFx0XHRmb3IgKGkgPSAwOyBpIDwgYWJzZWxlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0aWYgKCF0aGlzLnRlbXBvU2V0ICYmIHRlbXBvICYmICF0ZW1wby5zdXBwcmVzcykge1xuXHRcdFx0XHRcdHRoaXMudGVtcG9TZXQgPSB0cnVlO1xuXHRcdFx0XHRcdGFic2VsZW1zW2ldLmFkZENoaWxkKG5ldyBUZW1wb0VsZW1lbnQodGVtcG8sIHRoaXMudHVuZU51bWJlciwgY3JlYXRlTm90ZUhlYWQpKTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2b2ljZS5hZGRDaGlsZChhYnNlbGVtc1tpXSk7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHBvcyArPSByZXQuY291bnQ7XG5cdH1cblx0dGhpcy5wdXNoQ3Jvc3NMaW5lRWxlbXMocywgdik7XG59O1xuXG5cdEFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLnNhdmVTdGF0ZSA9IGZ1bmN0aW9uKCkge1xuXHRcdHRoaXMudGllc1NhdmUgPSBwYXJzZUNvbW1vbi5jbG9uZUFycmF5KHRoaXMudGllcyk7XG5cdFx0dGhpcy5zbHVyc1NhdmUgPSBwYXJzZUNvbW1vbi5jbG9uZUhhc2hPZkhhc2godGhpcy5zbHVycyk7XG5cdFx0dGhpcy5zbHVyc2J5dm9pY2VTYXZlID0gcGFyc2VDb21tb24uY2xvbmVIYXNoT2ZIYXNoKHRoaXMuc2x1cnNieXZvaWNlKTtcblx0XHR0aGlzLnRpZXNieXZvaWNlU2F2ZSA9IHBhcnNlQ29tbW9uLmNsb25lSGFzaE9mQXJyYXlPZkhhc2godGhpcy50aWVzYnl2b2ljZSk7XG5cdH07XG5cblx0QWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUucmVzdG9yZVN0YXRlID0gZnVuY3Rpb24oKSB7XG5cdFx0dGhpcy50aWVzID0gcGFyc2VDb21tb24uY2xvbmVBcnJheSh0aGlzLnRpZXNTYXZlKTtcblx0XHR0aGlzLnNsdXJzID0gcGFyc2VDb21tb24uY2xvbmVIYXNoT2ZIYXNoKHRoaXMuc2x1cnNTYXZlKTtcblx0XHR0aGlzLnNsdXJzYnl2b2ljZSA9IHBhcnNlQ29tbW9uLmNsb25lSGFzaE9mSGFzaCh0aGlzLnNsdXJzYnl2b2ljZVNhdmUpO1xuXHRcdHRoaXMudGllc2J5dm9pY2UgPSBwYXJzZUNvbW1vbi5jbG9uZUhhc2hPZkFycmF5T2ZIYXNoKHRoaXMudGllc2J5dm9pY2VTYXZlKTtcblx0fTtcblxuXHQvLyBmdW5jdGlvbiB3cml0ZU1lYXN1cmVXaWR0aCh2b2ljZSkge1xuXHQvLyBcdHZhciB3aWR0aCA9IDA7XG5cdC8vIFx0Zm9yICh2YXIgaSA9IHZvaWNlLmNoaWxkcmVuLmxlbmd0aC0xOyBpID49IDA7IGktLSkge1xuXHQvLyBcdFx0dmFyIGVsZW0gPSB2b2ljZS5jaGlsZHJlbltpXTtcblx0Ly8gXHRcdGlmIChlbGVtLmFiY2VsZW0uZWxfdHlwZSA9PT0gJ2JhcicpXG5cdC8vIFx0XHRcdGJyZWFrO1xuXHQvLyBcdFx0d2lkdGggKz0gZWxlbS53O1xuXHQvLyBcdH1cblx0Ly8gXHRyZXR1cm4gbmV3IFJlbGF0aXZlRWxlbWVudCh3aWR0aC50b0ZpeGVkKDIpLCAtNzAsIDAsIHVuZGVmaW5lZCwge3R5cGU6XCJkZWJ1Z1wifSk7XG5cdC8vIH1cblxuXHQvLyByZXR1cm4gYW4gYXJyYXkgb2YgQWJzb2x1dGVFbGVtZW50XG5BYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5jcmVhdGVBQkNFbGVtZW50ID0gZnVuY3Rpb24oaXNGaXJzdFN0YWZmLCBpc1NpbmdsZUxpbmVTdGFmZiwgdm9pY2UsIGVsZW0pIHtcbiAgdmFyIGVsZW1zZXQgPSBbXTtcbiAgc3dpdGNoIChlbGVtLmVsX3R5cGUpIHtcblx0ICBjYXNlIHVuZGVmaW5lZDpcblx0ICBcdC8vIGl0IGlzIHVuZGVmaW5lZCBpZiB3ZSB3ZXJlIHBhc3NlZCBhbiBhcnJheSBpbiAtIGFuIGFycmF5IG1lYW5zIGEgc2V0IG9mIG5vdGVzIHRoYXQgc2hvdWxkIGJlIGJlYW1lZCB0b2dldGhlci5cblx0XHQgIGVsZW1zZXQgPSB0aGlzLmNyZWF0ZUJlYW0oaXNTaW5nbGVMaW5lU3RhZmYsIHZvaWNlLCBlbGVtKTtcblx0ICBcdGJyZWFrO1xuICBjYXNlIFwibm90ZVwiOlxuXHQgIGVsZW1zZXRbMF0gPSB0aGlzLmNyZWF0ZU5vdGUoZWxlbSwgZmFsc2UsIGlzU2luZ2xlTGluZVN0YWZmLCB2b2ljZSk7XG5cdCAgaWYgKHRoaXMudHJpcGxldCAmJiB0aGlzLnRyaXBsZXQuaXNDbG9zZWQoKSkge1xuXHRcdCAgdm9pY2UuYWRkT3RoZXIodGhpcy50cmlwbGV0KTtcblx0XHQgIHRoaXMudHJpcGxldCA9IG51bGw7XG5cdFx0ICB0aGlzLnRyaXBsZXRtdWx0aXBsaWVyID0gMTtcblx0ICB9XG4gICAgYnJlYWs7XG4gIGNhc2UgXCJiYXJcIjpcbiAgICBlbGVtc2V0WzBdID0gdGhpcy5jcmVhdGVCYXJMaW5lKHZvaWNlLCBlbGVtLCBpc0ZpcnN0U3RhZmYpO1xuICAgIGlmICh2b2ljZS5kdXBsaWNhdGUgJiYgZWxlbXNldC5sZW5ndGggPiAwKSBlbGVtc2V0WzBdLmludmlzaWJsZSA9IHRydWU7XG4vL1x0ICBlbGVtc2V0WzBdLmFkZENoaWxkKHdyaXRlTWVhc3VyZVdpZHRoKHZvaWNlKSk7XG4gICAgYnJlYWs7XG4gIGNhc2UgXCJtZXRlclwiOlxuICAgIGVsZW1zZXRbMF0gPSBjcmVhdGVUaW1lU2lnbmF0dXJlKGVsZW0sIHRoaXMudHVuZU51bWJlcik7XG5cdCAgdGhpcy5zdGFydGxpbWl0ZWxlbSA9IGVsZW1zZXRbMF07IC8vIGxpbWl0IHRpZXMgaGVyZVxuICAgIGlmICh2b2ljZS5kdXBsaWNhdGUgJiYgZWxlbXNldC5sZW5ndGggPiAwKSBlbGVtc2V0WzBdLmludmlzaWJsZSA9IHRydWU7XG4gICAgYnJlYWs7XG4gIGNhc2UgXCJjbGVmXCI6XG4gICAgZWxlbXNldFswXSA9IGNyZWF0ZUNsZWYoZWxlbSwgdGhpcy50dW5lTnVtYmVyKTtcblx0ICBpZiAoIWVsZW1zZXRbMF0pIHJldHVybiBudWxsO1xuICAgIGlmICh2b2ljZS5kdXBsaWNhdGUgJiYgZWxlbXNldC5sZW5ndGggPiAwKSBlbGVtc2V0WzBdLmludmlzaWJsZSA9IHRydWU7XG4gICAgYnJlYWs7XG4gIGNhc2UgXCJrZXlcIjpcblx0ICB2YXIgYWJzS2V5ID0gY3JlYXRlS2V5U2lnbmF0dXJlKGVsZW0sIHRoaXMudHVuZU51bWJlcik7XG5cdCAgaWYgKGFic0tleSkge1xuXHRcdCAgZWxlbXNldFswXSA9IGFic0tleTtcblx0XHQgIHRoaXMuc3RhcnRsaW1pdGVsZW0gPSBlbGVtc2V0WzBdOyAvLyBsaW1pdCB0aWVzIGhlcmVcblx0ICB9XG4gICAgaWYgKHZvaWNlLmR1cGxpY2F0ZSAmJiBlbGVtc2V0Lmxlbmd0aCA+IDApIGVsZW1zZXRbMF0uaW52aXNpYmxlID0gdHJ1ZTtcbiAgICBicmVhaztcbiAgY2FzZSBcInN0ZW1cIjpcbiAgICB0aGlzLnN0ZW1kaXI9ZWxlbS5kaXJlY3Rpb247XG4gICAgYnJlYWs7XG4gIGNhc2UgXCJwYXJ0XCI6XG4gICAgdmFyIGFic2VsZW0gPSBuZXcgQWJzb2x1dGVFbGVtZW50KGVsZW0sMCwwLCAncGFydCcsIHRoaXMudHVuZU51bWJlcik7XG5cdCAgdmFyIGRpbSA9IHRoaXMucmVuZGVyZXIuZ2V0VGV4dFNpemUoZWxlbS50aXRsZSwgJ3BhcnRzZm9udCcsIFwicGFydFwiKTtcbiAgICBhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQoZWxlbS50aXRsZSwgMCwgMCwgdW5kZWZpbmVkLCB7dHlwZTpcInBhcnRcIiwgaGVpZ2h0OiBkaW0uaGVpZ2h0L3NwYWNpbmcuU1RFUH0pKTtcbiAgICBlbGVtc2V0WzBdID0gYWJzZWxlbTtcbiAgICBicmVhaztcbiAgY2FzZSBcInRlbXBvXCI6XG4gICAgdmFyIGFic2VsZW0zID0gbmV3IEFic29sdXRlRWxlbWVudChlbGVtLDAsMCwgJ3RlbXBvJywgdGhpcy50dW5lTnVtYmVyKTtcbiAgICBhYnNlbGVtMy5hZGRDaGlsZChuZXcgVGVtcG9FbGVtZW50KGVsZW0sIHRoaXMudHVuZU51bWJlciwgY3JlYXRlTm90ZUhlYWQpKTtcbiAgICBlbGVtc2V0WzBdID0gYWJzZWxlbTM7XG4gICAgYnJlYWs7XG5cdCAgY2FzZSBcInN0eWxlXCI6XG5cdFx0ICBpZiAoZWxlbS5oZWFkID09PSBcIm5vcm1hbFwiKVxuXHRcdFx0ICBkZWxldGUgdGhpcy5zdHlsZTtcblx0XHQgIGVsc2Vcblx0XHRcdCAgdGhpcy5zdHlsZSA9IGVsZW0uaGVhZDtcblx0XHQgIGJyZWFrO1xuXHQgIGNhc2UgXCJoaW50XCI6XG5cdFx0ICBoaW50ID0gdHJ1ZTtcblx0XHQgIHRoaXMuc2F2ZVN0YXRlKCk7XG5cdFx0ICBicmVhaztcblx0ICBjYXNlIFwibWlkaVwiOlxuXHRcdC8vIFRoaXMgaGFzIG5vIGVmZmVjdCBvbiB0aGUgdmlzaWJsZSBtdXNpYywgc28ganVzdCBza2lwIGl0LlxuXHRcdGJyZWFrO1xuXG4gIGRlZmF1bHQ6XG4gICAgdmFyIGFic2VsZW0yID0gbmV3IEFic29sdXRlRWxlbWVudChlbGVtLDAsMCwgJ3Vuc3VwcG9ydGVkJywgdGhpcy50dW5lTnVtYmVyKTtcbiAgICBhYnNlbGVtMi5hZGRDaGlsZChuZXcgUmVsYXRpdmVFbGVtZW50KFwiZWxlbWVudCB0eXBlIFwiK2VsZW0uZWxfdHlwZSwgMCwgMCwgdW5kZWZpbmVkLCB7dHlwZTpcImRlYnVnXCJ9KSk7XG4gICAgZWxlbXNldFswXSA9IGFic2VsZW0yO1xuICB9XG5cbiAgcmV0dXJuIGVsZW1zZXQ7XG59O1xuXG5cdGZ1bmN0aW9uIHNldEF2ZXJhZ2VQaXRjaChlbGVtKSB7XG5cdFx0aWYgKGVsZW0ucGl0Y2hlcykge1xuXHRcdFx0c29ydFBpdGNoKGVsZW0pO1xuXHRcdFx0dmFyIHN1bSA9IDA7XG5cdFx0XHRmb3IgKHZhciBwID0gMDsgcCA8IGVsZW0ucGl0Y2hlcy5sZW5ndGg7IHArKykge1xuXHRcdFx0XHRzdW0gKz0gZWxlbS5waXRjaGVzW3BdLnZlcnRpY2FsUG9zO1xuXHRcdFx0fVxuXHRcdFx0ZWxlbS5hdmVyYWdlcGl0Y2ggPSBzdW0gLyBlbGVtLnBpdGNoZXMubGVuZ3RoO1xuXHRcdFx0ZWxlbS5taW5waXRjaCA9IGVsZW0ucGl0Y2hlc1swXS52ZXJ0aWNhbFBvcztcblx0XHRcdGVsZW0ubWF4cGl0Y2ggPSBlbGVtLnBpdGNoZXNbZWxlbS5waXRjaGVzLmxlbmd0aCAtIDFdLnZlcnRpY2FsUG9zO1xuXHRcdH1cblx0fVxuXG5cdEFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLmNhbGNCZWFtRGlyID0gZnVuY3Rpb24gKGlzU2luZ2xlTGluZVN0YWZmLCB2b2ljZSwgZWxlbXMpIHtcblx0XHRpZiAodGhpcy5zdGVtZGlyKSAvLyBJZiB0aGUgdXNlciBvciB2b2ljZSBpcyBmb3JjaW5nIHRoZSBzdGVtIGRpcmVjdGlvbiwgd2UgYWxyZWFkeSBrbm93IHRoZSBhbnN3ZXIuXG5cdFx0XHRyZXR1cm4gdGhpcy5zdGVtZGlyO1xuXHRcdHZhciBiZWFtZWxlbSA9IG5ldyBCZWFtRWxlbSh0aGlzLnN0ZW1IZWlnaHQsIHRoaXMuc3RlbWRpcik7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0YmVhbWVsZW0uYWRkKHthYmNlbGVtOiBlbGVtc1tpXX0pOyAvLyBUaGlzIGlzIGEgaGFjayB0byBjYWxsIGJlYW0gZWxlbSB3aXRoIGp1c3QgYSBtaW5pbXVtIG9mIHByb2Nlc3Npbmc6IGZvciBvdXIgcHVycG9zZXMsIHdlIGRvbid0IG5lZWQgdG8gY29uc3RydWN0IHRoZSB3aG9sZSBub3RlLlxuXHRcdH1cblxuXHRcdHZhciBkaXIgPSBiZWFtZWxlbS5jYWxjRGlyKCk7XG5cdFx0cmV0dXJuIGRpciA/IFwidXBcIiA6IFwiZG93blwiO1xuXHR9O1xuXG5cdEFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLmNyZWF0ZUJlYW0gPSBmdW5jdGlvbiAoaXNTaW5nbGVMaW5lU3RhZmYsIHZvaWNlLCBlbGVtcykge1xuXHRcdHZhciBhYnNlbGVtc2V0ID0gW107XG5cblx0XHR2YXIgZGlyID0gdGhpcy5jYWxjQmVhbURpcihpc1NpbmdsZUxpbmVTdGFmZiwgdm9pY2UsIGVsZW1zKTtcblx0XHR2YXIgYmVhbWVsZW0gPSBuZXcgQmVhbUVsZW0odGhpcy5zdGVtSGVpZ2h0LCBkaXIpO1xuXHRcdGlmIChoaW50KSBiZWFtZWxlbS5zZXRIaW50KCk7XG5cdFx0dmFyIG9sZERpciA9IHRoaXMuc3RlbWRpcjtcblx0XHR0aGlzLnN0ZW1kaXIgPSBkaXI7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGVsZW0gPSBlbGVtc1tpXTtcblx0XHRcdHZhciBhYnNlbGVtID0gdGhpcy5jcmVhdGVOb3RlKGVsZW0sIHRydWUsIGlzU2luZ2xlTGluZVN0YWZmLCB2b2ljZSk7XG5cdFx0XHRhYnNlbGVtc2V0LnB1c2goYWJzZWxlbSk7XG5cdFx0XHRiZWFtZWxlbS5hZGQoYWJzZWxlbSk7XG5cdFx0XHRpZiAodGhpcy50cmlwbGV0ICYmIHRoaXMudHJpcGxldC5pc0Nsb3NlZCgpKSB7XG5cdFx0XHRcdHZvaWNlLmFkZE90aGVyKHRoaXMudHJpcGxldCk7XG5cdFx0XHRcdHRoaXMudHJpcGxldCA9IG51bGw7XG5cdFx0XHRcdHRoaXMudHJpcGxldG11bHRpcGxpZXIgPSAxO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLnN0ZW1kaXIgPSBvbGREaXI7XG5cdFx0dm9pY2UuYWRkQmVhbShiZWFtZWxlbSk7XG5cdFx0cmV0dXJuIGFic2VsZW1zZXQ7XG5cdH07XG5cbnZhciBzb3J0UGl0Y2ggPSBmdW5jdGlvbihlbGVtKSB7XG4gIHZhciBzb3J0ZWQ7XG4gIGRvIHtcbiAgICBzb3J0ZWQgPSB0cnVlO1xuICAgIGZvciAodmFyIHAgPSAwOyBwPGVsZW0ucGl0Y2hlcy5sZW5ndGgtMTsgcCsrKSB7XG4gICAgICBpZiAoZWxlbS5waXRjaGVzW3BdLnBpdGNoPmVsZW0ucGl0Y2hlc1twKzFdLnBpdGNoKSB7XG4gICAgICAgIHNvcnRlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgdG1wID0gZWxlbS5waXRjaGVzW3BdO1xuICAgICAgICBlbGVtLnBpdGNoZXNbcF0gPSBlbGVtLnBpdGNoZXNbcCsxXTtcbiAgICAgICAgZWxlbS5waXRjaGVzW3ArMV0gPSB0bXA7XG4gICAgICB9XG4gICAgfVxuICB9IHdoaWxlICghc29ydGVkKTtcbn07XG5cbnZhciBsZWRnZXJMaW5lcyA9IGZ1bmN0aW9uKGFic2VsZW0sIG1pblBpdGNoLCBtYXhQaXRjaCwgaXNSZXN0LCBzeW1ib2xXaWR0aCwgYWRkaXRpb25hbExlZGdlcnMsIGRpciwgZHgsIHNjYWxlKSB7XG5cdGZvciAodmFyIGk9bWF4UGl0Y2g7IGk+MTE7IGktLSkge1xuXHRcdGlmIChpJTI9PT0wICYmICFpc1Jlc3QpIHtcblx0XHRcdGFic2VsZW0uYWRkQ2hpbGQobmV3IFJlbGF0aXZlRWxlbWVudChudWxsLCBkeCwgKHN5bWJvbFdpZHRoKzQpKnNjYWxlLCBpLCB7dHlwZTpcImxlZGdlclwifSkpO1xuXHRcdH1cblx0fVxuXG5cdGZvciAoaT1taW5QaXRjaDsgaTwxOyBpKyspIHtcblx0XHRpZiAoaSUyPT09MCAmJiAhaXNSZXN0KSB7XG5cdFx0XHRhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQobnVsbCwgZHgsIChzeW1ib2xXaWR0aCs0KSpzY2FsZSwgaSwge3R5cGU6XCJsZWRnZXJcIn0pKTtcblx0XHR9XG5cdH1cblxuXHRmb3IgKGkgPSAwOyBpIDwgYWRkaXRpb25hbExlZGdlcnMubGVuZ3RoOyBpKyspIHsgLy8gUEVSOiBkcmF3IGFkZGl0aW9uYWwgbGVkZ2Vyc1xuXHRcdHZhciBvZnMgPSBzeW1ib2xXaWR0aDtcblx0XHRpZiAoZGlyID09PSAnZG93bicpIG9mcyA9IC1vZnM7XG5cdFx0YWJzZWxlbS5hZGRDaGlsZChuZXcgUmVsYXRpdmVFbGVtZW50KG51bGwsIG9mcytkeCwgKHN5bWJvbFdpZHRoKzQpKnNjYWxlLCBhZGRpdGlvbmFsTGVkZ2Vyc1tpXSwge3R5cGU6XCJsZWRnZXJcIn0pKTtcblx0fVxufTtcblxuXHRBYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5hZGRHcmFjZU5vdGVzID0gZnVuY3Rpb24gKGVsZW0sIHZvaWNlLCBhYnNlbGVtLCBub3RlaGVhZCwgc3RlbUhlaWdodCwgaXNCYWdwaXBlcywgcm9vbXRha2VuKSB7XG5cdFx0dmFyIGdyYWNlc2NhbGUgPSAzIC8gNTtcblx0XHR2YXIgZ3JhY2VTY2FsZVN0ZW0gPSAzLjUgLyA1OyAvLyBUT0RPLVBFUjogZW1waXJpY2FsbHkgZm91bmQgY29uc3RhbnQuXG5cdFx0dmFyIGdyYWNlYmVhbSA9IG51bGw7XG5cdFx0dmFyIGZsYWc7XG5cblx0XHRpZiAoZWxlbS5ncmFjZW5vdGVzLmxlbmd0aCA+IDEpIHtcblx0XHRcdGdyYWNlYmVhbSA9IG5ldyBCZWFtRWxlbShzdGVtSGVpZ2h0ICogZ3JhY2VTY2FsZVN0ZW0sIFwiZ3JhY2VcIiwgaXNCYWdwaXBlcyk7XG5cdFx0XHRpZiAoaGludCkgZ3JhY2ViZWFtLnNldEhpbnQoKTtcblx0XHRcdGdyYWNlYmVhbS5tYWluTm90ZSA9IGFic2VsZW07XHQvLyB0aGlzIGdpdmVzIHVzIGEgcmVmZXJlbmNlIGJhY2sgdG8gdGhlIG5vdGUgdGhpcyBpcyBhdHRhY2hlZCB0byBzbyB0aGF0IHRoZSBzdGVtcyBjYW4gYmUgYXR0YWNoZWQgc29tZXdoZXJlLlxuXHRcdH1cblxuXHRcdHZhciBncmFjZW9mZnNldHMgPSBbXTtcblx0XHRmb3IgKGkgPSBlbGVtLmdyYWNlbm90ZXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsgLy8gZmlndXJlIG91dCB3aGVyZSB0byBwbGFjZSBlYWNoIGdyYWNlbm90ZVxuXHRcdFx0cm9vbXRha2VuICs9IDEwO1xuXHRcdFx0Z3JhY2VvZmZzZXRzW2ldID0gcm9vbXRha2VuO1xuXHRcdFx0aWYgKGVsZW0uZ3JhY2Vub3Rlc1tpXS5hY2NpZGVudGFsKSB7XG5cdFx0XHRcdHJvb210YWtlbiArPSA3O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHZhciBpO1xuXHRcdGZvciAoaSA9IDA7IGkgPCBlbGVtLmdyYWNlbm90ZXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBncmFjZXBpdGNoID0gZWxlbS5ncmFjZW5vdGVzW2ldLnZlcnRpY2FsUG9zO1xuXG5cdFx0XHRmbGFnID0gKGdyYWNlYmVhbSkgPyBudWxsIDogY2hhcnRhYmxlLnVmbGFnc1soaXNCYWdwaXBlcykgPyA1IDogM107XG5cdFx0XHR2YXIgYWNjaWRlbnRhbFNsb3QgPSBbXTtcblx0XHRcdHZhciByZXQgPSBjcmVhdGVOb3RlSGVhZChhYnNlbGVtLCBcIm5vdGVoZWFkcy5xdWFydGVyXCIsIGVsZW0uZ3JhY2Vub3Rlc1tpXSwgXCJ1cFwiLCAtZ3JhY2VvZmZzZXRzW2ldLCAtZ3JhY2VvZmZzZXRzW2ldLCBmbGFnLCAwLCAwLCBncmFjZXNjYWxlLCBhY2NpZGVudGFsU2xvdCk7XG5cdFx0XHR2YXIgZ3JhY2UgPSByZXQubm90ZWhlYWQ7XG5cdFx0XHR0aGlzLmFkZFNsdXJzQW5kVGllcyhhYnNlbGVtLCBlbGVtLmdyYWNlbm90ZXNbaV0sIGdyYWNlLCB2b2ljZSwgXCJ1cFwiKTtcblxuXHRcdFx0YWJzZWxlbS5hZGRFeHRyYShncmFjZSk7XG5cdFx0XHQvLyBQRVI6IGFkZGVkIGFjY2lhY2NhdHVyYSBzbGFzaFxuXHRcdFx0aWYgKGVsZW0uZ3JhY2Vub3Rlc1tpXS5hY2NpYWNjYXR1cmEpIHtcblx0XHRcdFx0dmFyIHBvcyA9IGVsZW0uZ3JhY2Vub3Rlc1tpXS52ZXJ0aWNhbFBvcyArIDcgKiBncmFjZXNjYWxlOyAgICAgICAgLy8gdGhlIHNhbWUgZm9ybXVsYSB0aGF0IGRldGVybWluZXMgdGhlIGZsYWcgcG9zaXRpb24uXG5cdFx0XHRcdHZhciBkQWNjaWFjY2F0dXJhID0gZ3JhY2ViZWFtID8gNSA6IDY7ICAgICAgICAvLyBqdXN0IGFuIG9mZnNldCB0byBtYWtlIGl0IGxpbmUgdXAgY29ycmVjdGx5LlxuXHRcdFx0XHRhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJmbGFncy51Z3JhY2VcIiwgLWdyYWNlb2Zmc2V0c1tpXSArIGRBY2NpYWNjYXR1cmEsIDAsIHBvcywge3NjYWxleDogZ3JhY2VzY2FsZSwgc2NhbGV5OiBncmFjZXNjYWxlfSkpO1xuXHRcdFx0fVxuXHRcdFx0aWYgKGdyYWNlYmVhbSkgeyAvLyBnaXZlIHRoZSBiZWFtIHRoZSBuZWNlc3NhcnkgaW5mb1xuXHRcdFx0XHR2YXIgZ3JhY2VEdXJhdGlvbiA9IGVsZW0uZ3JhY2Vub3Rlc1tpXS5kdXJhdGlvbiAvIDI7XG5cdFx0XHRcdGlmIChpc0JhZ3BpcGVzKSBncmFjZUR1cmF0aW9uIC89IDI7XG5cdFx0XHRcdHZhciBwc2V1ZG9hYnNlbGVtID0ge1xuXHRcdFx0XHRcdGhlYWRzOiBbZ3JhY2VdLFxuXHRcdFx0XHRcdGFiY2VsZW06IHthdmVyYWdlcGl0Y2g6IGdyYWNlcGl0Y2gsIG1pbnBpdGNoOiBncmFjZXBpdGNoLCBtYXhwaXRjaDogZ3JhY2VwaXRjaCwgZHVyYXRpb246IGdyYWNlRHVyYXRpb259XG5cdFx0XHRcdH07XG5cdFx0XHRcdGdyYWNlYmVhbS5hZGQocHNldWRvYWJzZWxlbSk7XG5cdFx0XHR9IGVsc2UgeyAvLyBkcmF3IHRoZSBzdGVtXG5cdFx0XHRcdHZhciBwMSA9IGdyYWNlcGl0Y2ggKyAxIC8gMyAqIGdyYWNlc2NhbGU7XG5cdFx0XHRcdHZhciBwMiA9IGdyYWNlcGl0Y2ggKyA3ICogZ3JhY2VzY2FsZTtcblx0XHRcdFx0dmFyIGR4ID0gZ3JhY2UuZHggKyBncmFjZS53O1xuXHRcdFx0XHR2YXIgd2lkdGggPSAtMC42O1xuXHRcdFx0XHRhYnNlbGVtLmFkZEV4dHJhKG5ldyBSZWxhdGl2ZUVsZW1lbnQobnVsbCwgZHgsIDAsIHAxLCB7XCJ0eXBlXCI6IFwic3RlbVwiLCBcInBpdGNoMlwiOiBwMiwgbGluZXdpZHRoOiB3aWR0aH0pKTtcblx0XHRcdH1cblx0XHRcdGxlZGdlckxpbmVzKGFic2VsZW0sIGdyYWNlcGl0Y2gsIGdyYWNlcGl0Y2gsIGZhbHNlLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoXCJub3RlaGVhZHMucXVhcnRlclwiKSwgW10sIHRydWUsIGdyYWNlLmR4IC0gMSwgMC42KTtcblxuXHRcdFx0aWYgKGkgPT09IDAgJiYgIWlzQmFncGlwZXMgJiYgIShlbGVtLnJlc3QgJiYgKGVsZW0ucmVzdC50eXBlID09PSBcInNwYWNlclwiIHx8IGVsZW0ucmVzdC50eXBlID09PSBcImludmlzaWJsZVwiKSkpIHtcblx0XHRcdFx0dmFyIGlzVGllID0gKGVsZW0uZ3JhY2Vub3Rlcy5sZW5ndGggPT09IDEgJiYgZ3JhY2UucGl0Y2ggPT09IG5vdGVoZWFkLnBpdGNoKTtcblx0XHRcdFx0dm9pY2UuYWRkT3RoZXIobmV3IFRpZUVsZW0oZ3JhY2UsIG5vdGVoZWFkLCBmYWxzZSwgdHJ1ZSwgaXNUaWUpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRpZiAoZ3JhY2ViZWFtKSB7XG5cdFx0XHR2b2ljZS5hZGRCZWFtKGdyYWNlYmVhbSk7XG5cdFx0fVxuXHRcdHJldHVybiByb29tdGFrZW47XG5cdH07XG5cblx0ZnVuY3Rpb24gYWRkUmVzdFRvQWJzRWxlbWVudChhYnNlbGVtLCBlbGVtLCBkdXJhdGlvbiwgZG90LCBpc011bHRpVm9pY2UsIHN0ZW1kaXIsIGlzU2luZ2xlTGluZVN0YWZmLCBkdXJsb2cpIHtcblx0XHR2YXIgYztcblx0XHR2YXIgcmVzdHBpdGNoID0gNztcblx0XHR2YXIgbm90ZUhlYWQ7XG5cdFx0dmFyIHJvb21UYWtlbjtcblx0XHR2YXIgcm9vbVRha2VuUmlnaHQ7XG5cblx0XHRpZiAoaXNNdWx0aVZvaWNlKSB7XG5cdFx0XHRpZiAoc3RlbWRpciA9PT0gXCJkb3duXCIpIHJlc3RwaXRjaCA9IDM7XG5cdFx0XHRpZiAoc3RlbWRpciA9PT0gXCJ1cFwiKSByZXN0cGl0Y2ggPSAxMTtcblx0XHR9XG5cdFx0Ly8gVGhlcmUgaXMgc3BlY2lhbCBwbGFjZW1lbnQgZm9yIHRoZSBwZXJjdXNzaW9uIHN0YWZmLiBJZiB0aGVyZSBpcyBvbmUgc3RhZmYgbGluZSwgdGhlbiBtb3ZlIHRoZSByZXN0IHBvc2l0aW9uLlxuXHRcdGlmIChpc1NpbmdsZUxpbmVTdGFmZikge1xuXHRcdFx0Ly8gVGhlIGhhbGYgYW5kIHdob2xlIHJlc3RzIGFyZSBhdHRhY2hlZCB0byBkaWZmZXJlbnQgbGluZXMgbm9ybWFsbHksIHNvIHdlIG5lZWQgdG8gdHdlYWsgdGhlaXIgcG9zaXRpb24gdG8gZ2V0IHRoZW0gdG8gYm90aCBiZSBhdHRhY2hlZCB0byB0aGUgc2FtZSBvbmUuXG5cdFx0XHRpZiAoZHVyYXRpb24gPCAwLjUpXG5cdFx0XHRcdHJlc3RwaXRjaCA9IDc7XG5cdFx0XHRlbHNlIGlmIChkdXJhdGlvbiA8IDEpXG5cdFx0XHRcdHJlc3RwaXRjaCA9IDc7XHQvLyBoYWxmIHJlc3Rcblx0XHRcdGVsc2Vcblx0XHRcdFx0cmVzdHBpdGNoID0gNTsgLy8gd2hvbGUgcmVzdFxuXHRcdH1cblx0XHRzd2l0Y2ggKGVsZW0ucmVzdC50eXBlKSB7XG5cdFx0XHRjYXNlIFwid2hvbGVcIjpcblx0XHRcdFx0YyA9IGNoYXJ0YWJsZS5yZXN0WzBdO1xuXHRcdFx0XHRlbGVtLmF2ZXJhZ2VwaXRjaCA9IHJlc3RwaXRjaDtcblx0XHRcdFx0ZWxlbS5taW5waXRjaCA9IHJlc3RwaXRjaDtcblx0XHRcdFx0ZWxlbS5tYXhwaXRjaCA9IHJlc3RwaXRjaDtcblx0XHRcdFx0ZG90ID0gMDtcblx0XHRcdFx0YnJlYWs7XG5cdFx0XHRjYXNlIFwicmVzdFwiOlxuXHRcdFx0XHRpZiAoZWxlbS5zdHlsZSA9PT0gXCJyaHl0aG1cIikgLy8gc3BlY2lhbCBjYXNlIGZvciByaHl0aG06IHJlc3RzIGFyZSBhIGhhbmR5IHdheSB0byBleHByZXNzIHRoZSByaHl0aG0uXG5cdFx0XHRcdFx0YyA9IGNoYXJ0YWJsZS5yaHl0aG1bLWR1cmxvZ107XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRjID0gY2hhcnRhYmxlLnJlc3RbLWR1cmxvZ107XG5cdFx0XHRcdGVsZW0uYXZlcmFnZXBpdGNoID0gcmVzdHBpdGNoO1xuXHRcdFx0XHRlbGVtLm1pbnBpdGNoID0gcmVzdHBpdGNoO1xuXHRcdFx0XHRlbGVtLm1heHBpdGNoID0gcmVzdHBpdGNoO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJpbnZpc2libGVcIjpcblx0XHRcdGNhc2UgXCJzcGFjZXJcIjpcblx0XHRcdFx0YyA9IFwiXCI7XG5cdFx0XHRcdGVsZW0uYXZlcmFnZXBpdGNoID0gcmVzdHBpdGNoO1xuXHRcdFx0XHRlbGVtLm1pbnBpdGNoID0gcmVzdHBpdGNoO1xuXHRcdFx0XHRlbGVtLm1heHBpdGNoID0gcmVzdHBpdGNoO1xuXHRcdFx0XHRicmVhaztcblx0XHRcdGNhc2UgXCJtdWx0aW1lYXN1cmVcIjpcblx0XHRcdFx0YyA9IGNoYXJ0YWJsZS5yZXN0WydtdWx0aSddO1xuXHRcdFx0XHRlbGVtLmF2ZXJhZ2VwaXRjaCA9IHJlc3RwaXRjaDtcblx0XHRcdFx0ZWxlbS5taW5waXRjaCA9IHJlc3RwaXRjaDtcblx0XHRcdFx0ZWxlbS5tYXhwaXRjaCA9IHJlc3RwaXRjaDtcblx0XHRcdFx0ZG90ID0gMDtcblx0XHRcdFx0dmFyIG1tV2lkdGggPSBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoYyk7XG5cdFx0XHRcdGFic2VsZW0uYWRkSGVhZChuZXcgUmVsYXRpdmVFbGVtZW50KGMsIC1tbVdpZHRoLCBtbVdpZHRoICogMiwgNykpO1xuXHRcdFx0XHR2YXIgbnVtTWVhc3VyZXMgPSBuZXcgUmVsYXRpdmVFbGVtZW50KFwiXCIgKyBlbGVtLmR1cmF0aW9uLCAwLCBtbVdpZHRoLCAxNiwge3R5cGU6IFwibXVsdGltZWFzdXJlLXRleHRcIn0pO1xuXHRcdFx0XHRhYnNlbGVtLmFkZEV4dHJhKG51bU1lYXN1cmVzKTtcblx0XHR9XG5cdFx0aWYgKGVsZW0ucmVzdC50eXBlICE9PSBcIm11bHRpbWVhc3VyZVwiKSB7XG5cdFx0XHR2YXIgcmV0ID0gY3JlYXRlTm90ZUhlYWQoYWJzZWxlbSwgYywge3ZlcnRpY2FsUG9zOiByZXN0cGl0Y2h9LCBudWxsLCAwLCAwLCBudWxsLCBkb3QsIDAsIDEsIFtdKTtcblx0XHRcdG5vdGVIZWFkID0gcmV0Lm5vdGVoZWFkO1xuXHRcdFx0aWYgKG5vdGVIZWFkKSB7XG5cdFx0XHRcdGFic2VsZW0uYWRkSGVhZChub3RlSGVhZCk7XG5cdFx0XHRcdHJvb21UYWtlbiA9IHJldC5hY2NpZGVudGFsc2hpZnR4O1xuXHRcdFx0XHRyb29tVGFrZW5SaWdodCA9IHJldC5kb3RzaGlmdHg7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiB7IG5vdGVIZWFkOiBub3RlSGVhZCwgcm9vbVRha2VuOiByb29tVGFrZW4sIHJvb21UYWtlblJpZ2h0OiByb29tVGFrZW5SaWdodCB9O1xuXHR9XG5cblx0QWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUuYWRkTm90ZVRvQWJjRWxlbWVudCA9IGZ1bmN0aW9uKGFic2VsZW0sIGVsZW0sIGRvdCwgc3RlbWRpciwgc3R5bGUsIHplcm9EdXJhdGlvbiwgZHVybG9nLCBub3N0ZW0sIHZvaWNlKSB7XG5cdFx0dmFyIGRvdHNoaWZ0eCA9IDA7IC8vIHJvb20gdGFrZW4gYnkgY2hvcmRzIHdpdGggZGlzcGxhY2VkIG5vdGVoZWFkcyB3aGljaCBjYXVzZSBkb3RzIHRvIHNoaWZ0XG5cdFx0dmFyIG5vdGVIZWFkO1xuXHRcdHZhciByb29tVGFrZW4gPSAwO1xuXHRcdHZhciByb29tVGFrZW5SaWdodCA9IDA7XG5cdFx0dmFyIG1pbjtcblx0XHR2YXIgaTtcblx0XHR2YXIgYWRkaXRpb25hbExlZGdlcnMgPSBbXTtcblx0XHQvLyBUaGUgYWNjaWRlbnRhbFNsb3Qgd2lsbCBob2xkIGEgbGlzdCBvZiBhbGwgdGhlIGFjY2lkZW50YWxzIG9uIHRoaXMgY2hvcmQuIEVhY2ggZWxlbWVudCBpcyBhIHZlcnRpY2FsIHBsYWNlLFxuXHRcdC8vIGFuZCBjb250YWlucyBhIHBpdGNoLCB3aGljaCBpcyB0aGUgbGFzdCBwaXRjaCB0aGF0IGNvbnRhaW5zIGFuIGFjY2lkZW50YWwgaW4gdGhhdCBzbG90LiBUaGUgc2xvdHMgYXJlIG51bWJlcmVkXG5cdFx0Ly8gZnJvbSBjbG9zZXN0IHRvIHRoZSBub3RlIHRvIGZhcnRoZXIgbGVmdC4gV2Ugb25seSBuZWVkIHRvIGtub3cgdGhlIGxhc3QgYWNjaWRlbnRhbCB3ZSBwbGFjZWQgYmVjYXVzZVxuXHRcdC8vIHdlIGtub3cgdGhhdCB0aGUgcGl0Y2hlcyBhcmUgc29ydGVkIGJ5IG5vdy5cblx0XHR2YXIgYWNjaWRlbnRhbFNsb3QgPSBbXTtcblx0XHR2YXIgc3ltYm9sV2lkdGggPSAwO1xuXG5cdFx0dmFyIGRpciA9IChlbGVtLmF2ZXJhZ2VwaXRjaD49NikgPyBcImRvd25cIjogXCJ1cFwiO1xuXHRcdGlmIChzdGVtZGlyKSBkaXI9c3RlbWRpcjtcblxuXHRcdHN0eWxlID0gZWxlbS5zdHlsZSA/IGVsZW0uc3R5bGUgOiBzdHlsZTsgLy8gZ2V0IHRoZSBzdHlsZSBvZiBub3RlIGhlYWQuXG5cdFx0aWYgKCFzdHlsZSB8fCBzdHlsZSA9PT0gXCJub3JtYWxcIikgc3R5bGUgPSBcIm5vdGVcIjtcblx0XHR2YXIgbm90ZVN5bWJvbDtcblx0XHRpZiAoemVyb0R1cmF0aW9uKVxuXHRcdFx0bm90ZVN5bWJvbCA9IGNoYXJ0YWJsZVtzdHlsZV0ubm9zdGVtO1xuXHRcdGVsc2Vcblx0XHRcdG5vdGVTeW1ib2wgPSBjaGFydGFibGVbc3R5bGVdWy1kdXJsb2ddO1xuXHRcdGlmICghbm90ZVN5bWJvbClcblx0XHRcdGNvbnNvbGUubG9nKFwibm90ZVN5bWJvbDpcIiwgc3R5bGUsIGR1cmxvZywgemVyb0R1cmF0aW9uKTtcblxuXHRcdC8vIGRldGVybWluZSBlbGVtZW50cyBvZiBjaG9yZHMgd2hpY2ggc2hvdWxkIGJlIHNoaWZ0ZWRcblx0XHR2YXIgcDtcblx0XHRmb3IgKHA9KGRpcj09PVwiZG93blwiKT9lbGVtLnBpdGNoZXMubGVuZ3RoLTI6MTsgKGRpcj09PVwiZG93blwiKT9wPj0wOnA8ZWxlbS5waXRjaGVzLmxlbmd0aDsgcD0oZGlyPT09XCJkb3duXCIpP3AtMTpwKzEpIHtcblx0XHRcdHZhciBwcmV2ID0gZWxlbS5waXRjaGVzWyhkaXI9PT1cImRvd25cIik/cCsxOnAtMV07XG5cdFx0XHR2YXIgY3VyciA9IGVsZW0ucGl0Y2hlc1twXTtcblx0XHRcdHZhciBkZWx0YSA9IChkaXI9PT1cImRvd25cIik/cHJldi5waXRjaC1jdXJyLnBpdGNoOmN1cnIucGl0Y2gtcHJldi5waXRjaDtcblx0XHRcdGlmIChkZWx0YTw9MSAmJiAhcHJldi5wcmludGVyX3NoaWZ0KSB7XG5cdFx0XHRcdGN1cnIucHJpbnRlcl9zaGlmdD0oZGVsdGEpP1wiZGlmZmVyZW50XCI6XCJzYW1lXCI7XG5cdFx0XHRcdGlmIChjdXJyLnZlcnRpY2FsUG9zID4gMTEgfHwgY3Vyci52ZXJ0aWNhbFBvcyA8IDEpIHsgICAgICAgIC8vIFBFUjogYWRkIGV4dHJhIGxlZGdlciBsaW5lXG5cdFx0XHRcdFx0YWRkaXRpb25hbExlZGdlcnMucHVzaChjdXJyLnZlcnRpY2FsUG9zIC0gKGN1cnIudmVydGljYWxQb3MlMikpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGlmIChkaXI9PT1cImRvd25cIikge1xuXHRcdFx0XHRcdHJvb21UYWtlbiA9IGdseXBocy5nZXRTeW1ib2xXaWR0aChub3RlU3ltYm9sKSsyO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGRvdHNoaWZ0eCA9IGdseXBocy5nZXRTeW1ib2xXaWR0aChub3RlU3ltYm9sKSsyO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0dmFyIHBwID0gZWxlbS5waXRjaGVzLmxlbmd0aDtcblx0XHRmb3IgKHA9MDsgcDxlbGVtLnBpdGNoZXMubGVuZ3RoOyBwKyspIHtcblxuXHRcdFx0aWYgKCFub3N0ZW0pIHtcblx0XHRcdFx0dmFyIGZsYWc7XG5cdFx0XHRcdGlmICgoZGlyPT09XCJkb3duXCIgJiYgcCE9PTApIHx8IChkaXI9PT1cInVwXCIgJiYgcCE9PXBwLTEpKSB7IC8vIG5vdCB0aGUgc3RlbW1lZCBlbGVtIG9mIHRoZSBjaG9yZFxuXHRcdFx0XHRcdGZsYWcgPSBudWxsO1xuXHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdGZsYWcgPSBjaGFydGFibGVbKGRpcj09PVwiZG93blwiKT9cImRmbGFnc1wiOlwidWZsYWdzXCJdWy1kdXJsb2ddO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHR2YXIgYztcblx0XHRcdGlmIChlbGVtLnBpdGNoZXNbcF0uc3R5bGUpIHsgLy8gVGhlcmUgaXMgYSBzdHlsZSBmb3IgdGhlIHdob2xlIGdyb3VwIG9mIHBpdGNoZXMsIGJ1dCB0aGVyZSBjb3VsZCBhbHNvIGJlIGFuIG92ZXJyaWRlIGZvciBhIHBhcnRpY3VsYXIgcGl0Y2guXG5cdFx0XHRcdGMgPSBjaGFydGFibGVbZWxlbS5waXRjaGVzW3BdLnN0eWxlXVstZHVybG9nXTtcblx0XHRcdH0gZWxzZVxuXHRcdFx0XHRjID0gbm90ZVN5bWJvbDtcblx0XHRcdC8vIFRoZSBoaWdoZXN0IHBvc2l0aW9uIGZvciB0aGUgc2FrZSBvZiBwbGFjaW5nIHNsdXJzIGlzIGl0c2VsZiBpZiB0aGUgc2x1ciBpcyBpbnRlcm5hbC4gSXQgaXMgdGhlIGhpZ2hlc3QgcG9zaXRpb24gcG9zc2libGUgaWYgdGhlIHNsdXIgaXMgZm9yIHRoZSB3aG9sZSBjaG9yZC5cblx0XHRcdC8vIElmIHRoZSBub3RlIGlzIHRoZSBvbmx5IG9uZSBpbiB0aGUgY2hvcmQsIHRoZW4gYW55IHNsdXIgaXQgaGFzIGNvdW50cyBhcyBpZiBpdCB3ZXJlIG9uIHRoZSB3aG9sZSBjaG9yZC5cblx0XHRcdGVsZW0ucGl0Y2hlc1twXS5oaWdoZXN0VmVydCA9IGVsZW0ucGl0Y2hlc1twXS52ZXJ0aWNhbFBvcztcblx0XHRcdHZhciBpc1RvcFdoZW5TdGVtSXNEb3duID0gKHN0ZW1kaXI9PT1cInVwXCIgfHwgZGlyPT09XCJ1cFwiKSAmJiBwPT09MDtcblx0XHRcdHZhciBpc0JvdHRvbVdoZW5TdGVtSXNVcCA9IChzdGVtZGlyPT09XCJkb3duXCIgfHwgZGlyPT09XCJkb3duXCIpICYmIHA9PT1wcC0xO1xuXHRcdFx0aWYgKGlzVG9wV2hlblN0ZW1Jc0Rvd24gfHwgaXNCb3R0b21XaGVuU3RlbUlzVXApIHsgLy8gcGxhY2UgdG8gcHV0IHNsdXJzIGlmIG5vdCBhbHJlYWR5IG9uIHBpdGNoZXNcblxuXHRcdFx0XHRpZiAoZWxlbS5zdGFydFNsdXIgfHwgcHAgPT09IDEpIHtcblx0XHRcdFx0XHRlbGVtLnBpdGNoZXNbcF0uaGlnaGVzdFZlcnQgPSBlbGVtLnBpdGNoZXNbcHAtMV0udmVydGljYWxQb3M7XG5cdFx0XHRcdFx0aWYgKHN0ZW1kaXI9PT1cInVwXCIgfHwgZGlyPT09XCJ1cFwiKVxuXHRcdFx0XHRcdFx0ZWxlbS5waXRjaGVzW3BdLmhpZ2hlc3RWZXJ0ICs9IDY7ICAgICAgICAvLyBJZiB0aGUgc3RlbSBpcyB1cCwgdGhlbiBjb21wZW5zYXRlIGZvciB0aGUgbGVuZ3RoIG9mIHRoZSBzdGVtXG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKGVsZW0uc3RhcnRTbHVyKSB7XG5cdFx0XHRcdFx0aWYgKCFlbGVtLnBpdGNoZXNbcF0uc3RhcnRTbHVyKSBlbGVtLnBpdGNoZXNbcF0uc3RhcnRTbHVyID0gW107IC8vVE9ETyBwb3NzaWJseSByZWR1bmRhbnQsIHByb3ZpZGVkIGFycmF5IGlzIG5vdCBvcHRpb25hbFxuXHRcdFx0XHRcdGZvciAoaT0wOyBpPGVsZW0uc3RhcnRTbHVyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRlbGVtLnBpdGNoZXNbcF0uc3RhcnRTbHVyLnB1c2goZWxlbS5zdGFydFNsdXJbaV0pO1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXG5cdFx0XHRcdGlmIChlbGVtLmVuZFNsdXIpIHtcblx0XHRcdFx0XHRlbGVtLnBpdGNoZXNbcF0uaGlnaGVzdFZlcnQgPSBlbGVtLnBpdGNoZXNbcHAtMV0udmVydGljYWxQb3M7XG5cdFx0XHRcdFx0aWYgKHN0ZW1kaXI9PT1cInVwXCIgfHwgZGlyPT09XCJ1cFwiKVxuXHRcdFx0XHRcdFx0ZWxlbS5waXRjaGVzW3BdLmhpZ2hlc3RWZXJ0ICs9IDY7ICAgICAgICAvLyBJZiB0aGUgc3RlbSBpcyB1cCwgdGhlbiBjb21wZW5zYXRlIGZvciB0aGUgbGVuZ3RoIG9mIHRoZSBzdGVtXG5cdFx0XHRcdFx0aWYgKCFlbGVtLnBpdGNoZXNbcF0uZW5kU2x1cikgZWxlbS5waXRjaGVzW3BdLmVuZFNsdXIgPSBbXTsgLy9UT0RPIHBvc3NpYmx5IHJlZHVuZGFudCwgcHJvdmlkZWQgYXJyYXkgaXMgbm90IG9wdGlvbmFsXG5cdFx0XHRcdFx0Zm9yIChpPTA7IGk8ZWxlbS5lbmRTbHVyLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdFx0XHRlbGVtLnBpdGNoZXNbcF0uZW5kU2x1ci5wdXNoKGVsZW0uZW5kU2x1cltpXSk7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cblx0XHRcdHZhciBoYXNTdGVtID0gIW5vc3RlbSAmJiBkdXJsb2c8PS0xO1xuXHRcdFx0dmFyIHJldCA9IGNyZWF0ZU5vdGVIZWFkKGFic2VsZW0sIGMsIGVsZW0ucGl0Y2hlc1twXSwgaGFzU3RlbSA/IGRpciA6IG51bGwsIDAsIC1yb29tVGFrZW4sIGZsYWcsIGRvdCwgZG90c2hpZnR4LCAxLCBhY2NpZGVudGFsU2xvdCk7XG5cdFx0XHRzeW1ib2xXaWR0aCA9IE1hdGgubWF4KGdseXBocy5nZXRTeW1ib2xXaWR0aChjKSwgc3ltYm9sV2lkdGgpO1xuXHRcdFx0YWJzZWxlbS5leHRyYXcgLT0gcmV0LmV4dHJhTGVmdDtcblx0XHRcdG5vdGVIZWFkID0gcmV0Lm5vdGVoZWFkO1xuXHRcdFx0aWYgKG5vdGVIZWFkKSB7XG5cdFx0XHRcdHRoaXMuYWRkU2x1cnNBbmRUaWVzKGFic2VsZW0sIGVsZW0ucGl0Y2hlc1twXSwgbm90ZUhlYWQsIHZvaWNlLCBoYXNTdGVtID8gZGlyIDogbnVsbCk7XG5cblx0XHRcdFx0aWYgKGVsZW0uZ3JhY2Vub3RlcyAmJiBlbGVtLmdyYWNlbm90ZXMubGVuZ3RoID4gMClcblx0XHRcdFx0XHRub3RlSGVhZC5ib3R0b20gPSBub3RlSGVhZC5ib3R0b20gLSAxO1x0IC8vIElmIHRoZXJlIGlzIGEgdGllIHRvIHRoZSBncmFjZSBub3RlcywgbGVhdmUgYSBsaXR0bGUgbW9yZSByb29tIGZvciB0aGUgbm90ZSB0byBhdm9pZCBjb2xsaXNpb25zLlxuXHRcdFx0XHRhYnNlbGVtLmFkZEhlYWQobm90ZUhlYWQpO1xuXHRcdFx0fVxuXHRcdFx0cm9vbVRha2VuICs9IHJldC5hY2NpZGVudGFsc2hpZnR4O1xuXHRcdFx0cm9vbVRha2VuUmlnaHQgPSBNYXRoLm1heChyb29tVGFrZW5SaWdodCxyZXQuZG90c2hpZnR4KTtcblx0XHR9XG5cblx0XHQvLyBkcmF3IHN0ZW0gZnJvbSB0aGUgZnVydGhlc3Qgbm90ZSB0byBhIHBpdGNoIGFib3ZlL2JlbG93IHRoZSBzdGVtbWVkIG5vdGVcblx0XHRpZiAoaGFzU3RlbSkge1xuXHRcdFx0dmFyIHAxID0gKGRpcj09PVwiZG93blwiKSA/IGVsZW0ubWlucGl0Y2gtNyA6IGVsZW0ubWlucGl0Y2grMS8zO1xuXHRcdFx0Ly8gUEVSIGFkZGVkIHN0ZW1kaXIgdGVzdCB0byBtYWtlIHRoZSBsaW5lIG1lZXQgdGhlIG5vdGUuXG5cdFx0XHRpZiAocDE+NiAmJiAhc3RlbWRpcikgcDE9Njtcblx0XHRcdHZhciBwMiA9IChkaXI9PT1cImRvd25cIikgPyBlbGVtLm1heHBpdGNoLTEvMyA6IGVsZW0ubWF4cGl0Y2grNztcblx0XHRcdC8vIFBFUiBhZGRlZCBzdGVtZGlyIHRlc3QgdG8gbWFrZSB0aGUgbGluZSBtZWV0IHRoZSBub3RlLlxuXHRcdFx0aWYgKHAyPDYgJiYgIXN0ZW1kaXIpIHAyPTY7XG5cdFx0XHR2YXIgZHggPSAoZGlyPT09XCJkb3duXCIgfHwgYWJzZWxlbS5oZWFkcy5sZW5ndGggPT09IDApPzA6YWJzZWxlbS5oZWFkc1swXS53O1xuXHRcdFx0dmFyIHdpZHRoID0gKGRpcj09PVwiZG93blwiKT8xOi0xO1xuXHRcdFx0Ly8gVE9ETy1QRVItSEFDSzogT25lIHR5cGUgb2Ygbm90ZSBoZWFkIGhhcyBhIGRpZmZlcmVudCBwbGFjZW1lbnQgb2YgdGhlIHN0ZW0uIFRoaXMgc2hvdWxkIGJlIG1vcmUgZ2VuZXJpY2FsbHkgY2FsY3VsYXRlZDpcblx0XHRcdGlmIChub3RlSGVhZC5jID09PSAnbm90ZWhlYWRzLnNsYXNoLnF1YXJ0ZXInKSB7XG5cdFx0XHRcdGlmIChkaXIgPT09ICdkb3duJylcblx0XHRcdFx0XHRwMiAtPSAxO1xuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdFx0cDEgKz0gMTtcblx0XHRcdH1cblx0XHRcdGFic2VsZW0uYWRkRXh0cmEobmV3IFJlbGF0aXZlRWxlbWVudChudWxsLCBkeCwgMCwgcDEsIHtcInR5cGVcIjogXCJzdGVtXCIsIFwicGl0Y2gyXCI6cDIsIGxpbmV3aWR0aDogd2lkdGh9KSk7XG5cdFx0XHRtaW4gPSBNYXRoLm1pbihwMSwgcDIpO1xuXHRcdH1cblx0XHRyZXR1cm4geyBub3RlSGVhZDogbm90ZUhlYWQsIHJvb21UYWtlbjogcm9vbVRha2VuLCByb29tVGFrZW5SaWdodDogcm9vbVRha2VuUmlnaHQsIG1pbjogbWluLCBhZGRpdGlvbmFsTGVkZ2VyczogYWRkaXRpb25hbExlZGdlcnMsIGRpcjogZGlyLCBzeW1ib2xXaWR0aDogc3ltYm9sV2lkdGggfTtcblx0fTtcblxuXHRBYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5hZGRMeXJpYyA9IGZ1bmN0aW9uKGFic2VsZW0sIGVsZW0pIHtcblx0XHR2YXIgbHlyaWNTdHIgPSBcIlwiO1xuXHRcdHBhcnNlQ29tbW9uLmVhY2goZWxlbS5seXJpYywgZnVuY3Rpb24obHkpIHtcblx0XHRcdHZhciBkaXYgPSBseS5kaXZpZGVyID09PSAnICcgPyBcIlwiIDogbHkuZGl2aWRlcjtcblx0XHRcdGx5cmljU3RyICs9IGx5LnN5bGxhYmxlICsgZGl2ICsgXCJcXG5cIjtcblx0XHR9KTtcblx0XHR2YXIgbHlyaWNEaW0gPSB0aGlzLnJlbmRlcmVyLmdldFRleHRTaXplKGx5cmljU3RyLCAndm9jYWxmb250JywgXCJseXJpY1wiKTtcblx0XHR2YXIgcG9zaXRpb24gPSBlbGVtLnBvc2l0aW9uaW5nID8gZWxlbS5wb3NpdGlvbmluZy52b2NhbFBvc2l0aW9uIDogJ2JlbG93Jztcblx0XHRhYnNlbGVtLmFkZENlbnRlcmVkKG5ldyBSZWxhdGl2ZUVsZW1lbnQobHlyaWNTdHIsIDAsIGx5cmljRGltLndpZHRoLCB1bmRlZmluZWQsIHt0eXBlOlwibHlyaWNcIiwgcG9zaXRpb246IHBvc2l0aW9uLCBoZWlnaHQ6IGx5cmljRGltLmhlaWdodCAvIHNwYWNpbmcuU1RFUCB9KSk7XG5cdH07XG5cblx0QWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUuYWRkQ2hvcmQgPSBmdW5jdGlvbihhYnNlbGVtLCBlbGVtLCByb29tVGFrZW4sIHJvb21UYWtlblJpZ2h0KSB7XG5cdFx0dmFyIGNob3JkTWFyZ2luID0gODsgLy8gSWYgdGhlcmUgYXJlIGNob3JkcyBuZXh0IHRvIGVhY2ggb3RoZXIsIHRoaXMgaXMgaG93IGNsb3NlIHRoZXkgY2FuIGdldC5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGVsZW0uY2hvcmQubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciB4ID0gMDtcblx0XHRcdHZhciB5O1xuXHRcdFx0dmFyIGRpbSA9IHRoaXMucmVuZGVyZXIuZ2V0VGV4dFNpemUoZWxlbS5jaG9yZFtpXS5uYW1lLCAnYW5ub3RhdGlvbmZvbnQnLCBcImFubm90YXRpb25cIik7XG5cdFx0XHR2YXIgY2hvcmRXaWR0aCA9IGRpbS53aWR0aDtcblx0XHRcdHZhciBjaG9yZEhlaWdodCA9IGRpbS5oZWlnaHQgLyBzcGFjaW5nLlNURVA7XG5cdFx0XHRzd2l0Y2ggKGVsZW0uY2hvcmRbaV0ucG9zaXRpb24pIHtcblx0XHRcdFx0Y2FzZSBcImxlZnRcIjpcblx0XHRcdFx0XHRyb29tVGFrZW4rPWNob3JkV2lkdGgrNztcblx0XHRcdFx0XHR4ID0gLXJvb21UYWtlbjsgICAgICAgIC8vIFRPRE8tUEVSOiBUaGlzIGlzIGp1c3QgYSBndWVzcyBmcm9tIHRyaWFsIGFuZCBlcnJvclxuXHRcdFx0XHRcdHkgPSBlbGVtLmF2ZXJhZ2VwaXRjaDtcblx0XHRcdFx0XHRhYnNlbGVtLmFkZEV4dHJhKG5ldyBSZWxhdGl2ZUVsZW1lbnQoZWxlbS5jaG9yZFtpXS5uYW1lLCB4LCBjaG9yZFdpZHRoKzQsIHksIHt0eXBlOlwidGV4dFwiLCBoZWlnaHQ6IGNob3JkSGVpZ2h0fSkpO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwicmlnaHRcIjpcblx0XHRcdFx0XHRyb29tVGFrZW5SaWdodCs9NDtcblx0XHRcdFx0XHR4ID0gcm9vbVRha2VuUmlnaHQ7Ly8gVE9ETy1QRVI6IFRoaXMgaXMganVzdCBhIGd1ZXNzIGZyb20gdHJpYWwgYW5kIGVycm9yXG5cdFx0XHRcdFx0eSA9IGVsZW0uYXZlcmFnZXBpdGNoO1xuXHRcdFx0XHRcdGFic2VsZW0uYWRkUmlnaHQobmV3IFJlbGF0aXZlRWxlbWVudChlbGVtLmNob3JkW2ldLm5hbWUsIHgsIGNob3JkV2lkdGgrNCwgeSwge3R5cGU6XCJ0ZXh0XCIsIGhlaWdodDogY2hvcmRIZWlnaHR9KSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJiZWxvd1wiOlxuXHRcdFx0XHRcdC8vIHNldHRpbmcgdGhlIHktY29vcmRpbmF0ZSB0byB1bmRlZmluZWQgZm9yIG5vdzogaXQgd2lsbCBiZSBvdmVyd3JpdHRlbiBsYXRlciBvbiwgYWZ0ZXIgd2UgZmlndXJlIG91dCB3aGF0IHRoZSBoaWdoZXN0IGVsZW1lbnQgb24gdGhlIGxpbmUgaXMuXG5cdFx0XHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KGVsZW0uY2hvcmRbaV0ubmFtZSwgMCwgY2hvcmRXaWR0aCtjaG9yZE1hcmdpbiwgdW5kZWZpbmVkLCB7dHlwZTogXCJ0ZXh0XCIsIHBvc2l0aW9uOiBcImJlbG93XCIsIGhlaWdodDogY2hvcmRIZWlnaHR9KSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJhYm92ZVwiOlxuXHRcdFx0XHRcdC8vIHNldHRpbmcgdGhlIHktY29vcmRpbmF0ZSB0byB1bmRlZmluZWQgZm9yIG5vdzogaXQgd2lsbCBiZSBvdmVyd3JpdHRlbiBsYXRlciBvbiwgYWZ0ZXIgd2UgZmlndXJlIG91dCB3aGF0IHRoZSBoaWdoZXN0IGVsZW1lbnQgb24gdGhlIGxpbmUgaXMuXG5cdFx0XHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KGVsZW0uY2hvcmRbaV0ubmFtZSwgMCwgY2hvcmRXaWR0aCtjaG9yZE1hcmdpbiwgdW5kZWZpbmVkLCB7dHlwZTogXCJ0ZXh0XCIsIGhlaWdodDogY2hvcmRIZWlnaHR9KSk7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0aWYgKGVsZW0uY2hvcmRbaV0ucmVsX3Bvc2l0aW9uKSB7XG5cdFx0XHRcdFx0XHR2YXIgcmVsUG9zaXRpb25ZID0gZWxlbS5jaG9yZFtpXS5yZWxfcG9zaXRpb24ueSArIDMqc3BhY2luZy5TVEVQOyAvLyBUT0RPLVBFUjogdGhpcyBpcyBhIGZ1ZGdlIGZhY3RvciB0byBtYWtlIGl0IGxpbmUgdXAgd2l0aCBhYmNtMnBzXG5cdFx0XHRcdFx0XHRhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQoZWxlbS5jaG9yZFtpXS5uYW1lLCB4ICsgZWxlbS5jaG9yZFtpXS5yZWxfcG9zaXRpb24ueCwgMCwgZWxlbS5taW5waXRjaCArIHJlbFBvc2l0aW9uWSAvIHNwYWNpbmcuU1RFUCwge3R5cGU6IFwidGV4dFwiLCBoZWlnaHQ6IGNob3JkSGVpZ2h0fSkpO1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHQvLyBzZXR0aW5nIHRoZSB5LWNvb3JkaW5hdGUgdG8gdW5kZWZpbmVkIGZvciBub3c6IGl0IHdpbGwgYmUgb3ZlcndyaXR0ZW4gbGF0ZXIgb24sIGFmdGVyIHdlIGZpZ3VyZSBvdXQgd2hhdCB0aGUgaGlnaGVzdCBlbGVtZW50IG9uIHRoZSBsaW5lIGlzLlxuXHRcdFx0XHRcdFx0dmFyIHBvczIgPSAnYWJvdmUnO1xuXHRcdFx0XHRcdFx0aWYgKGVsZW0ucG9zaXRpb25pbmcgJiYgZWxlbS5wb3NpdGlvbmluZy5jaG9yZFBvc2l0aW9uKVxuXHRcdFx0XHRcdFx0XHRwb3MyID0gZWxlbS5wb3NpdGlvbmluZy5jaG9yZFBvc2l0aW9uO1xuXG5cdFx0XHRcdFx0XHRkaW0gPSB0aGlzLnJlbmRlcmVyLmdldFRleHRTaXplKGVsZW0uY2hvcmRbaV0ubmFtZSwgJ2djaG9yZGZvbnQnLCBcImNob3JkXCIpO1xuXHRcdFx0XHRcdFx0Y2hvcmRIZWlnaHQgPSBkaW0uaGVpZ2h0IC8gc3BhY2luZy5TVEVQO1xuXHRcdFx0XHRcdFx0Y2hvcmRXaWR0aCA9IGRpbS53aWR0aDsgLy8gU2luY2UgdGhlIGNob3JkIGlzIGNlbnRlcmVkLCB3ZSBvbmx5IHVzZSBoYWxmIHRoZSB3aWR0aC5cblx0XHRcdFx0XHRcdGFic2VsZW0uYWRkQ2VudGVyZWQobmV3IFJlbGF0aXZlRWxlbWVudChlbGVtLmNob3JkW2ldLm5hbWUsIHgsIGNob3JkV2lkdGgsIHVuZGVmaW5lZCwge3R5cGU6IFwiY2hvcmRcIiwgcG9zaXRpb246IHBvczIsIGhlaWdodDogY2hvcmRIZWlnaHQgfSkpO1xuXHRcdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHsgcm9vbVRha2VuOiByb29tVGFrZW4sIHJvb21UYWtlblJpZ2h0OiByb29tVGFrZW5SaWdodCB9O1xuXHR9O1xuXG5BYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5jcmVhdGVOb3RlID0gZnVuY3Rpb24oZWxlbSwgbm9zdGVtLCBpc1NpbmdsZUxpbmVTdGFmZiwgdm9pY2UpIHsgLy9zdGVtIHByZXNlbmNlOiB0cnVlIGZvciBkcmF3aW5nIHN0ZW1sZXNzIG5vdGVoZWFkXG4gIHZhciBub3RlaGVhZCA9IG51bGw7XG4gIHZhciByb29tdGFrZW4gPSAwOyAvLyByb29tIG5lZWRlZCB0byB0aGUgbGVmdCBvZiB0aGUgbm90ZVxuICB2YXIgcm9vbXRha2VucmlnaHQgPSAwOyAvLyByb29tIG5lZWRlZCB0byB0aGUgcmlnaHQgb2YgdGhlIG5vdGVcbiAgdmFyIHN5bWJvbFdpZHRoID0gMDtcbiAgdmFyIGFkZGl0aW9uYWxMZWRnZXJzID0gW107IC8vIFBFUjogaGFuZGxlIHRoZSBjYXNlIG9mIFtiYyddLCB3aGVyZSB0aGUgYiBkb2Vzbid0IGhhdmUgYSBsZWRnZXIgbGluZVxuXG4gIHZhciBpO1xuICB2YXIgZGlyO1xuXG5cdHZhciBkdXJhdGlvbiA9IGdldER1cmF0aW9uKGVsZW0pO1xuXHR2YXIgemVyb0R1cmF0aW9uID0gZmFsc2U7XG4gIGlmIChkdXJhdGlvbiA9PT0gMCkgeyB6ZXJvRHVyYXRpb24gPSB0cnVlOyBkdXJhdGlvbiA9IDAuMjU7IG5vc3RlbSA9IHRydWU7IH0gICAgICAgIC8vUEVSOiB6ZXJvIGR1cmF0aW9uIHdpbGwgZHJhdyBhIHF1YXJ0ZXIgbm90ZSBoZWFkLlxuICB2YXIgZHVybG9nID0gTWF0aC5mbG9vcihNYXRoLmxvZyhkdXJhdGlvbikvTWF0aC5sb2coMikpOyAvL1RPRE8gdXNlIGdldER1cmxvZ1xuICB2YXIgZG90PTA7XG5cbiAgZm9yICh2YXIgdG90ID0gTWF0aC5wb3coMixkdXJsb2cpLCBpbmM9dG90LzI7IHRvdDxkdXJhdGlvbjsgZG90KyssdG90Kz1pbmMsaW5jLz0yKTtcblxuXG5cdGlmIChlbGVtLnN0YXJ0VHJpcGxldCkge1xuXHRcdHRoaXMudHJpcGxldG11bHRpcGxpZXIgPSBlbGVtLnRyaXBsZXRNdWx0aXBsaWVyO1xuXHR9XG5cbiAgdmFyIGR1cmF0aW9uRm9yU3BhY2luZyA9IGR1cmF0aW9uICogdGhpcy50cmlwbGV0bXVsdGlwbGllcjtcbiAgaWYgKGVsZW0ucmVzdCAmJiBlbGVtLnJlc3QudHlwZSA9PT0gJ211bHRpbWVhc3VyZScpXG4gIFx0ZHVyYXRpb25Gb3JTcGFjaW5nID0gMTtcbiAgdmFyIGFic1R5cGUgPSBlbGVtLnJlc3QgPyBcInJlc3RcIiA6IFwibm90ZVwiO1xuICB2YXIgYWJzZWxlbSA9IG5ldyBBYnNvbHV0ZUVsZW1lbnQoZWxlbSwgZHVyYXRpb25Gb3JTcGFjaW5nLCAxLCBhYnNUeXBlLCB0aGlzLnR1bmVOdW1iZXIsIHsgZHVyYXRpb25DbGFzc092ZXJpZGU6IGVsZW0uZHVyYXRpb24gKiB0aGlzLnRyaXBsZXRtdWx0aXBsaWVyfSk7XG4gIGlmIChoaW50KSBhYnNlbGVtLnNldEhpbnQoKTtcblxuICBpZiAoZWxlbS5yZXN0KSB7XG5cdCAgdmFyIHJldDEgPSBhZGRSZXN0VG9BYnNFbGVtZW50KGFic2VsZW0sIGVsZW0sIGR1cmF0aW9uLCBkb3QsIHZvaWNlLnZvaWNldG90YWwgPiAxLCB0aGlzLnN0ZW1kaXIsIGlzU2luZ2xlTGluZVN0YWZmLCBkdXJsb2cpO1xuXHQgIG5vdGVoZWFkID0gcmV0MS5ub3RlSGVhZDtcblx0ICByb29tdGFrZW4gPSByZXQxLnJvb21UYWtlbjtcblx0ICByb29tdGFrZW5yaWdodCA9IHJldDEucm9vbVRha2VuUmlnaHQ7XG4gIH0gZWxzZSB7XG5cdCAgdmFyIHJldDIgPSB0aGlzLmFkZE5vdGVUb0FiY0VsZW1lbnQoYWJzZWxlbSwgZWxlbSwgZG90LCB0aGlzLnN0ZW1kaXIsIHRoaXMuc3R5bGUsIHplcm9EdXJhdGlvbiwgZHVybG9nLCBub3N0ZW0sIHZvaWNlKTtcblx0ICBpZiAocmV0Mi5taW4gIT09IHVuZGVmaW5lZClcblx0XHQgIHRoaXMubWluWSA9IE1hdGgubWluKHJldDIubWluLCB0aGlzLm1pblkpO1xuXHQgIG5vdGVoZWFkID0gcmV0Mi5ub3RlSGVhZDtcblx0ICByb29tdGFrZW4gPSByZXQyLnJvb21UYWtlbjtcblx0ICByb29tdGFrZW5yaWdodCA9IHJldDIucm9vbVRha2VuUmlnaHQ7XG5cdCAgYWRkaXRpb25hbExlZGdlcnMgPSByZXQyLmFkZGl0aW9uYWxMZWRnZXJzO1xuXHQgIGRpciA9IHJldDIuZGlyO1xuXHQgIHN5bWJvbFdpZHRoID0gcmV0Mi5zeW1ib2xXaWR0aDtcbiAgfVxuXG4gIGlmIChlbGVtLmx5cmljICE9PSB1bmRlZmluZWQpIHtcbiAgXHR0aGlzLmFkZEx5cmljKGFic2VsZW0sIGVsZW0pO1xuICB9XG5cbiAgaWYgKGVsZW0uZ3JhY2Vub3RlcyAhPT0gdW5kZWZpbmVkKSB7XG5cdHJvb210YWtlbiArPSB0aGlzLmFkZEdyYWNlTm90ZXMoZWxlbSwgdm9pY2UsIGFic2VsZW0sIG5vdGVoZWFkLCB0aGlzLnN0ZW1IZWlnaHQsIHRoaXMuaXNCYWdwaXBlcywgcm9vbXRha2VuKTtcbiAgfVxuXG4gIGlmIChlbGVtLmRlY29yYXRpb24pIHtcblx0ICB0aGlzLmRlY29yYXRpb24uY3JlYXRlRGVjb3JhdGlvbih2b2ljZSwgZWxlbS5kZWNvcmF0aW9uLCBhYnNlbGVtLnRvcCwgKG5vdGVoZWFkKT9ub3RlaGVhZC53OjAsIGFic2VsZW0sIHJvb210YWtlbiwgZGlyLCBhYnNlbGVtLmJvdHRvbSwgZWxlbS5wb3NpdGlvbmluZywgdGhpcy5oYXNWb2NhbHMpO1xuICB9XG5cbiAgaWYgKGVsZW0uYmFyTnVtYmVyKSB7XG4gICAgYWJzZWxlbS5hZGRDaGlsZChuZXcgUmVsYXRpdmVFbGVtZW50KGVsZW0uYmFyTnVtYmVyLCAtMTAsIDAsIDAsIHt0eXBlOlwiYmFyTnVtYmVyXCJ9KSk7XG4gIH1cblxuICAvLyBsZWRnZXIgbGluZXNcblx0bGVkZ2VyTGluZXMoYWJzZWxlbSwgZWxlbS5taW5waXRjaCwgZWxlbS5tYXhwaXRjaCwgZWxlbS5yZXN0LCBzeW1ib2xXaWR0aCwgYWRkaXRpb25hbExlZGdlcnMsIGRpciwgLTIsIDEpO1xuXG4gIGlmIChlbGVtLmNob3JkICE9PSB1bmRlZmluZWQpIHtcbiAgXHR2YXIgcmV0MyA9IHRoaXMuYWRkQ2hvcmQoYWJzZWxlbSwgZWxlbSwgcm9vbXRha2VuLCByb29tdGFrZW5yaWdodCk7XG5cdCAgcm9vbXRha2VuID0gcmV0My5yb29tVGFrZW47XG5cdCAgcm9vbXRha2VucmlnaHQgPSByZXQzLnJvb21UYWtlblJpZ2h0O1xuICB9XG5cblxuICBpZiAoZWxlbS5zdGFydFRyaXBsZXQpIHtcbiAgICB0aGlzLnRyaXBsZXQgPSBuZXcgVHJpcGxldEVsZW0oZWxlbS5zdGFydFRyaXBsZXQsIG5vdGVoZWFkKTsgLy8gYWJvdmUgaXMgb3Bwb3NpdGUgZnJvbSBjYXNlIG9mIHNsdXJzXG4gIH1cblxuICBpZiAoZWxlbS5lbmRUcmlwbGV0ICYmIHRoaXMudHJpcGxldCkge1xuICAgIHRoaXMudHJpcGxldC5zZXRDbG9zZUFuY2hvcihub3RlaGVhZCk7XG4gIH1cblxuICByZXR1cm4gYWJzZWxlbTtcbn07XG5cblxuXG5cbnZhciBjcmVhdGVOb3RlSGVhZCA9IGZ1bmN0aW9uKGFic2VsZW0sIGMsIHBpdGNoZWxlbSwgZGlyLCBoZWFkeCwgZXh0cmF4LCBmbGFnLCBkb3QsIGRvdHNoaWZ0eCwgc2NhbGUsIGFjY2lkZW50YWxTbG90KSB7XG5cbiAgLy8gVE9ETyBzY2FsZSB0aGUgZG90IGFzIHdlbGxcbiAgdmFyIHBpdGNoID0gcGl0Y2hlbGVtLnZlcnRpY2FsUG9zO1xuICB2YXIgbm90ZWhlYWQ7XG4gIHZhciBpO1xuICB2YXIgYWNjaWRlbnRhbHNoaWZ0eCA9IDA7XG4gIHZhciBuZXdEb3RTaGlmdFggPSAwO1xuICB2YXIgZXh0cmFMZWZ0ID0gMDtcbiAgaWYgKGMgPT09IHVuZGVmaW5lZClcbiAgICBhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJwaXRjaCBpcyB1bmRlZmluZWRcIiwgMCwgMCwgMCwge3R5cGU6XCJkZWJ1Z1wifSkpO1xuICBlbHNlIGlmIChjPT09XCJcIikge1xuICAgIG5vdGVoZWFkID0gbmV3IFJlbGF0aXZlRWxlbWVudChudWxsLCAwLCAwLCBwaXRjaCk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHNoaWZ0aGVhZHggPSBoZWFkeDtcbiAgICBpZiAocGl0Y2hlbGVtLnByaW50ZXJfc2hpZnQpIHtcbiAgICAgIHZhciBhZGp1c3QgPSAocGl0Y2hlbGVtLnByaW50ZXJfc2hpZnQ9PT1cInNhbWVcIik/MTowO1xuICAgICAgc2hpZnRoZWFkeCA9IChkaXI9PT1cImRvd25cIik/LWdseXBocy5nZXRTeW1ib2xXaWR0aChjKSpzY2FsZSthZGp1c3Q6Z2x5cGhzLmdldFN5bWJvbFdpZHRoKGMpKnNjYWxlLWFkanVzdDtcbiAgICB9XG5cdCAgdmFyIG9wdHMgPSB7c2NhbGV4OnNjYWxlLCBzY2FsZXk6IHNjYWxlLCB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoYykqc2NhbGUgfTtcbiAgICBub3RlaGVhZCA9IG5ldyBSZWxhdGl2ZUVsZW1lbnQoYywgc2hpZnRoZWFkeCwgZ2x5cGhzLmdldFN5bWJvbFdpZHRoKGMpKnNjYWxlLCBwaXRjaCwgb3B0cyk7XG4gICAgaWYgKGZsYWcpIHtcbiAgICAgIHZhciBwb3MgPSBwaXRjaCsoKGRpcj09PVwiZG93blwiKT8tNzo3KSpzY2FsZTtcbiAgICAgIGlmIChzY2FsZT09PTEgJiYgKGRpcj09PVwiZG93blwiKT8ocG9zPjYpOihwb3M8NikpIHBvcz02O1xuICAgICAgdmFyIHhkZWx0YSA9IChkaXI9PT1cImRvd25cIik/aGVhZHg6aGVhZHgrbm90ZWhlYWQudy0wLjY7XG4gICAgICBhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoZmxhZywgeGRlbHRhLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoZmxhZykqc2NhbGUsIHBvcywge3NjYWxleDpzY2FsZSwgc2NhbGV5OiBzY2FsZX0pKTtcbiAgICB9XG5cdCAgbmV3RG90U2hpZnRYID0gbm90ZWhlYWQudytkb3RzaGlmdHgtMis1KmRvdDtcbiAgICBmb3IgKDtkb3Q+MDtkb3QtLSkge1xuICAgICAgdmFyIGRvdGFkanVzdHkgPSAoMS1NYXRoLmFicyhwaXRjaCklMik7IC8vUEVSOiB0YWtlIGFicyB2YWx1ZSBvZiB0aGUgcGl0Y2guIEFuZCB0aGUgc2hpZnQgc3RpbGwgaGFwcGVucyBvbiBsZWRnZXIgbGluZXMuXG4gICAgICBhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJkb3RzLmRvdFwiLCBub3RlaGVhZC53K2RvdHNoaWZ0eC0yKzUqZG90LCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoXCJkb3RzLmRvdFwiKSwgcGl0Y2grZG90YWRqdXN0eSkpO1xuICAgIH1cbiAgfVxuICAgICAgICBpZiAobm90ZWhlYWQpXG4gICAgICAgICAgICAgICAgbm90ZWhlYWQuaGlnaGVzdFZlcnQgPSBwaXRjaGVsZW0uaGlnaGVzdFZlcnQ7XG5cbiAgaWYgKHBpdGNoZWxlbS5hY2NpZGVudGFsKSB7XG4gICAgdmFyIHN5bWI7XG4gICAgc3dpdGNoIChwaXRjaGVsZW0uYWNjaWRlbnRhbCkge1xuICAgIGNhc2UgXCJxdWFydGVyc2hhcnBcIjpcbiAgICAgIHN5bWIgPSBcImFjY2lkZW50YWxzLmhhbGZzaGFycFwiO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlIFwiZGJsc2hhcnBcIjpcbiAgICAgIHN5bWIgPSBcImFjY2lkZW50YWxzLmRibHNoYXJwXCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwic2hhcnBcIjpcbiAgICAgIHN5bWIgPSBcImFjY2lkZW50YWxzLnNoYXJwXCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwicXVhcnRlcmZsYXRcIjpcbiAgICAgIHN5bWIgPSBcImFjY2lkZW50YWxzLmhhbGZmbGF0XCI7XG4gICAgICBicmVhaztcbiAgICBjYXNlIFwiZmxhdFwiOlxuICAgICAgc3ltYiA9IFwiYWNjaWRlbnRhbHMuZmxhdFwiO1xuICAgICAgYnJlYWs7XG4gICAgY2FzZSBcImRibGZsYXRcIjpcbiAgICAgIHN5bWIgPSBcImFjY2lkZW50YWxzLmRibGZsYXRcIjtcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgXCJuYXR1cmFsXCI6XG4gICAgICBzeW1iID0gXCJhY2NpZGVudGFscy5uYXRcIjtcbiAgICB9XG4gICAgICAgICAvLyBpZiBhIG5vdGUgaXMgYXQgbGVhc3QgYSBzaXh0aCBhd2F5LCBpdCBjYW4gc2hhcmUgYSBzbG90IHdpdGggYW5vdGhlciBhY2NpZGVudGFsXG4gICAgICAgICB2YXIgYWNjU2xvdEZvdW5kID0gZmFsc2U7XG4gICAgICAgICB2YXIgYWNjUGxhY2UgPSBleHRyYXg7XG4gICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGFjY2lkZW50YWxTbG90Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgIGlmIChwaXRjaCAtIGFjY2lkZW50YWxTbG90W2pdWzBdID49IDYpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICBhY2NpZGVudGFsU2xvdFtqXVswXSA9IHBpdGNoO1xuICAgICAgICAgICAgICAgICAgICAgICAgIGFjY1BsYWNlID0gYWNjaWRlbnRhbFNsb3Rbal1bMV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgYWNjU2xvdEZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgfVxuICAgICAgICAgaWYgKGFjY1Nsb3RGb3VuZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgYWNjUGxhY2UgLT0gKGdseXBocy5nZXRTeW1ib2xXaWR0aChzeW1iKSpzY2FsZSsyKTtcbiAgICAgICAgICAgICAgICAgYWNjaWRlbnRhbFNsb3QucHVzaChbcGl0Y2gsYWNjUGxhY2VdKTtcbiAgICAgICAgICAgICAgICAgYWNjaWRlbnRhbHNoaWZ0eCA9IChnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoc3ltYikqc2NhbGUrMik7XG4gICAgICAgICB9XG4gICAgYWJzZWxlbS5hZGRFeHRyYShuZXcgUmVsYXRpdmVFbGVtZW50KHN5bWIsIGFjY1BsYWNlLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoc3ltYiksIHBpdGNoLCB7c2NhbGV4OnNjYWxlLCBzY2FsZXk6IHNjYWxlfSkpO1xuXHQgIGV4dHJhTGVmdCA9IGdseXBocy5nZXRTeW1ib2xXaWR0aChzeW1iKSAvIDI7IC8vIFRPRE8tUEVSOiBXZSBuZWVkIGEgbGl0dGxlIGV4dHJhIHdpZHRoIGlmIHRoZXJlIGlzIGFuIGFjY2lkZW50YWwsIGJ1dCBJJ20gbm90IHN1cmUgd2h5IGl0IGlzbid0IHRoZSBmdWxsIHdpZHRoIG9mIHRoZSBhY2NpZGVudGFsLlxuICB9XG5cbiAgcmV0dXJuIHsgbm90ZWhlYWQ6IG5vdGVoZWFkLCBhY2NpZGVudGFsc2hpZnR4OiBhY2NpZGVudGFsc2hpZnR4LCBkb3RzaGlmdHg6IG5ld0RvdFNoaWZ0WCwgZXh0cmFMZWZ0OiBleHRyYUxlZnQgfTtcblxufTtcblxuXHRBYnN0cmFjdEVuZ3JhdmVyLnByb3RvdHlwZS5hZGRTbHVyc0FuZFRpZXMgPSBmdW5jdGlvbihhYnNlbGVtLCBwaXRjaGVsZW0sIG5vdGVoZWFkLCB2b2ljZSwgZGlyKSB7XG5cdFx0aWYgKHBpdGNoZWxlbS5lbmRUaWUpIHtcblx0XHRcdGlmICh0aGlzLnRpZXNbMF0pIHtcblx0XHRcdFx0dGhpcy50aWVzWzBdLnNldEVuZEFuY2hvcihub3RlaGVhZCk7XG5cdFx0XHRcdHRoaXMudGllcyA9IHRoaXMudGllcy5zbGljZSgxLHRoaXMudGllcy5sZW5ndGgpO1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdGlmIChwaXRjaGVsZW0uc3RhcnRUaWUpIHtcblx0XHRcdC8vUEVSOiBidWcgZml4OiB2YXIgdGllID0gbmV3IFRpZUVsZW0obm90ZWhlYWQsIG51bGwsICh0aGlzLnN0ZW1kaXI9PVwidXBcIiB8fCBkaXI9PVwiZG93blwiKSAmJiB0aGlzLnN0ZW1kaXIhPVwiZG93blwiLCh0aGlzLnN0ZW1kaXI9PVwiZG93blwiIHx8IHRoaXMuc3RlbWRpcj09XCJ1cFwiKSk7XG5cdFx0XHR2YXIgdGllID0gbmV3IFRpZUVsZW0obm90ZWhlYWQsIG51bGwsICh0aGlzLnN0ZW1kaXI9PT1cImRvd25cIiB8fCBkaXI9PT1cImRvd25cIikgJiYgdGhpcy5zdGVtZGlyIT09XCJ1cFwiLCh0aGlzLnN0ZW1kaXI9PT1cImRvd25cIiB8fCB0aGlzLnN0ZW1kaXI9PT1cInVwXCIpLCB0cnVlKTtcblx0XHRcdGlmIChoaW50KSB0aWUuc2V0SGludCgpO1xuXG5cdFx0XHR0aGlzLnRpZXNbdGhpcy50aWVzLmxlbmd0aF09dGllO1xuXHRcdFx0dm9pY2UuYWRkT3RoZXIodGllKTtcblx0XHRcdC8vIEhBQ0stUEVSOiBGb3IgdGhlIGFuaW1hdGlvbiwgd2UgbmVlZCB0byBrbm93IGlmIGEgbm90ZSBpcyB0aWVkIHRvIHRoZSBuZXh0IG9uZSwgc28gaGVyZSdzIGEgZmxhZy5cblx0XHRcdC8vIFVuZm9ydHVuYXRlbHksIG9ubHkgc29tZSBvZiB0aGUgbm90ZXMgaW4gdGhlIGN1cnJlbnQgZXZlbnQgbWlnaHQgYmUgdGllZCwgYnV0IHRoaXMgd2lsbCBjb25zaWRlciBpdFxuXHRcdFx0Ly8gdGllZCBpZiBhbnkgb25lIG9mIHRoZW0gaXMuIFRoYXQgd2lsbCB3b3JrIGZvciBtb3N0IGNhc2VzLlxuXHRcdFx0YWJzZWxlbS5zdGFydFRpZSA9IHRydWU7XG5cdFx0fVxuXG5cdFx0aWYgKHBpdGNoZWxlbS5lbmRTbHVyKSB7XG5cdFx0XHRmb3IgKHZhciBpPTA7IGk8cGl0Y2hlbGVtLmVuZFNsdXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIHNsdXJpZCA9IHBpdGNoZWxlbS5lbmRTbHVyW2ldO1xuXHRcdFx0XHR2YXIgc2x1cjtcblx0XHRcdFx0aWYgKHRoaXMuc2x1cnNbc2x1cmlkXSkge1xuXHRcdFx0XHRcdHNsdXIgPSB0aGlzLnNsdXJzW3NsdXJpZF07XG5cdFx0XHRcdFx0c2x1ci5zZXRFbmRBbmNob3Iobm90ZWhlYWQpO1xuXHRcdFx0XHRcdGRlbGV0ZSB0aGlzLnNsdXJzW3NsdXJpZF07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0c2x1ciA9IG5ldyBUaWVFbGVtKG51bGwsIG5vdGVoZWFkLCBkaXI9PT1cImRvd25cIiwodGhpcy5zdGVtZGlyPT09XCJ1cFwiIHx8IGRpcj09PVwiZG93blwiKSAmJiB0aGlzLnN0ZW1kaXIhPT1cImRvd25cIiwgZmFsc2UpO1xuXHRcdFx0XHRcdGlmIChoaW50KSBzbHVyLnNldEhpbnQoKTtcblx0XHRcdFx0XHR2b2ljZS5hZGRPdGhlcihzbHVyKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAodGhpcy5zdGFydGxpbWl0ZWxlbSkge1xuXHRcdFx0XHRcdHNsdXIuc2V0U3RhcnRYKHRoaXMuc3RhcnRsaW1pdGVsZW0pO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0aWYgKHBpdGNoZWxlbS5zdGFydFNsdXIpIHtcblx0XHRcdGZvciAoaT0wOyBpPHBpdGNoZWxlbS5zdGFydFNsdXIubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIHNsdXJpZCA9IHBpdGNoZWxlbS5zdGFydFNsdXJbaV0ubGFiZWw7XG5cdFx0XHRcdC8vUEVSOiBidWcgZml4OiB2YXIgc2x1ciA9IG5ldyBUaWVFbGVtKG5vdGVoZWFkLCBudWxsLCAodGhpcy5zdGVtZGlyPT1cInVwXCIgfHwgZGlyPT1cImRvd25cIikgJiYgdGhpcy5zdGVtZGlyIT1cImRvd25cIiwgdGhpcy5zdGVtZGlyKTtcblx0XHRcdFx0dmFyIHNsdXIgPSBuZXcgVGllRWxlbShub3RlaGVhZCwgbnVsbCwgKHRoaXMuc3RlbWRpcj09PVwiZG93blwiIHx8IGRpcj09PVwiZG93blwiKSAmJiB0aGlzLnN0ZW1kaXIhPT1cInVwXCIsIGZhbHNlLCBmYWxzZSk7XG5cdFx0XHRcdGlmIChoaW50KSBzbHVyLnNldEhpbnQoKTtcblx0XHRcdFx0dGhpcy5zbHVyc1tzbHVyaWRdPXNsdXI7XG5cdFx0XHRcdHZvaWNlLmFkZE90aGVyKHNsdXIpO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuQWJzdHJhY3RFbmdyYXZlci5wcm90b3R5cGUuYWRkTWVhc3VyZU51bWJlciA9IGZ1bmN0aW9uIChudW1iZXIsIGFic2VsZW0pIHtcblx0dmFyIG1lYXN1cmVOdW1IZWlnaHQgPSB0aGlzLnJlbmRlcmVyLmdldFRleHRTaXplKG51bWJlciwgXCJtZWFzdXJlZm9udFwiLCAnYmFyLW51bWJlcicpO1xuXHRhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQobnVtYmVyLCAwLCAwLCAxMSttZWFzdXJlTnVtSGVpZ2h0LmhlaWdodCAvIHNwYWNpbmcuU1RFUCwge3R5cGU6XCJiYXJOdW1iZXJcIn0pKTtcbn07XG5cbkFic3RyYWN0RW5ncmF2ZXIucHJvdG90eXBlLmNyZWF0ZUJhckxpbmUgPSBmdW5jdGlvbiAodm9pY2UsIGVsZW0sIGlzRmlyc3RTdGFmZikge1xuLy8gYmFyX3RoaW4sIGJhcl90aGluX3RoaWNrLCBiYXJfdGhpbl90aGluLCBiYXJfdGhpY2tfdGhpbiwgYmFyX3JpZ2h0X3JlcGVhdCwgYmFyX2xlZnRfcmVwZWF0LCBiYXJfZG91YmxlX3JlcGVhdFxuXG4gIHZhciBhYnNlbGVtID0gbmV3IEFic29sdXRlRWxlbWVudChlbGVtLCAwLCAxMCwgJ2JhcicsIHRoaXMudHVuZU51bWJlcik7XG4gIHZhciBhbmNob3IgPSBudWxsOyAvLyBwbGFjZSB0byBhdHRhY2ggcGFydCBsaW5lc1xuICB2YXIgZHggPSAwO1xuXG5cdGlmIChlbGVtLmJhck51bWJlcikge1xuXHRcdHRoaXMuYWRkTWVhc3VyZU51bWJlcihlbGVtLmJhck51bWJlciwgYWJzZWxlbSk7XG5cdH1cblxuXG4gIHZhciBmaXJzdGRvdHMgPSAoZWxlbS50eXBlPT09XCJiYXJfcmlnaHRfcmVwZWF0XCIgfHwgZWxlbS50eXBlPT09XCJiYXJfZGJsX3JlcGVhdFwiKTtcbiAgdmFyIGZpcnN0dGhpbiA9IChlbGVtLnR5cGUhPT1cImJhcl9sZWZ0X3JlcGVhdFwiICYmIGVsZW0udHlwZSE9PVwiYmFyX3RoaWNrX3RoaW5cIiAmJiBlbGVtLnR5cGUhPT1cImJhcl9pbnZpc2libGVcIik7XG4gIHZhciB0aGljayA9IChlbGVtLnR5cGU9PT1cImJhcl9yaWdodF9yZXBlYXRcIiB8fCBlbGVtLnR5cGU9PT1cImJhcl9kYmxfcmVwZWF0XCIgfHwgZWxlbS50eXBlPT09XCJiYXJfbGVmdF9yZXBlYXRcIiB8fFxuICAgICAgICAgZWxlbS50eXBlPT09XCJiYXJfdGhpbl90aGlja1wiIHx8IGVsZW0udHlwZT09PVwiYmFyX3RoaWNrX3RoaW5cIik7XG4gIHZhciBzZWNvbmR0aGluID0gKGVsZW0udHlwZT09PVwiYmFyX2xlZnRfcmVwZWF0XCIgfHwgZWxlbS50eXBlPT09XCJiYXJfdGhpY2tfdGhpblwiIHx8IGVsZW0udHlwZT09PVwiYmFyX3RoaW5fdGhpblwiIHx8IGVsZW0udHlwZT09PVwiYmFyX2RibF9yZXBlYXRcIik7XG4gIHZhciBzZWNvbmRkb3RzID0gKGVsZW0udHlwZT09PVwiYmFyX2xlZnRfcmVwZWF0XCIgfHwgZWxlbS50eXBlPT09XCJiYXJfZGJsX3JlcGVhdFwiKTtcblxuICAvLyBsaW1pdCBwb3NpdGlvbmluZyBvZiBzbHVyc1xuICBpZiAoZmlyc3Rkb3RzIHx8IHNlY29uZGRvdHMpIHtcbiAgICBmb3IgKHZhciBzbHVyIGluIHRoaXMuc2x1cnMpIHtcbiAgICAgIGlmICh0aGlzLnNsdXJzLmhhc093blByb3BlcnR5KHNsdXIpKSB7XG4gICAgICAgIHRoaXMuc2x1cnNbc2x1cl0uc2V0RW5kWChhYnNlbGVtKTtcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5zdGFydGxpbWl0ZWxlbSA9IGFic2VsZW07XG4gIH1cblxuICBpZiAoZmlyc3Rkb3RzKSB7XG4gICAgYWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KFwiZG90cy5kb3RcIiwgZHgsIDEsIDcpKTtcbiAgICBhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJkb3RzLmRvdFwiLCBkeCwgMSwgNSkpO1xuICAgIGR4Kz02OyAvLzIgaGFyZGNvZGVkLCB0d2ljZTtcbiAgfVxuXG4gIGlmIChmaXJzdHRoaW4pIHtcbiAgICBhbmNob3IgPSBuZXcgUmVsYXRpdmVFbGVtZW50KG51bGwsIGR4LCAxLCAyLCB7XCJ0eXBlXCI6IFwiYmFyXCIsIFwicGl0Y2gyXCI6MTAsIGxpbmV3aWR0aDowLjZ9KTtcbiAgICBhYnNlbGVtLmFkZFJpZ2h0KGFuY2hvcik7XG4gIH1cblxuICBpZiAoZWxlbS50eXBlPT09XCJiYXJfaW52aXNpYmxlXCIpIHtcbiAgICBhbmNob3IgPSBuZXcgUmVsYXRpdmVFbGVtZW50KG51bGwsIGR4LCAxLCAyLCB7XCJ0eXBlXCI6IFwibm9uZVwiLCBcInBpdGNoMlwiOjEwLCBsaW5ld2lkdGg6MC42fSk7XG4gICAgYWJzZWxlbS5hZGRSaWdodChhbmNob3IpO1xuICB9XG5cbiAgaWYgKGVsZW0uZGVjb3JhdGlvbikge1xuICAgIHRoaXMuZGVjb3JhdGlvbi5jcmVhdGVEZWNvcmF0aW9uKHZvaWNlLCBlbGVtLmRlY29yYXRpb24sIDEyLCAodGhpY2spPzM6MSwgYWJzZWxlbSwgMCwgXCJkb3duXCIsIDIsIGVsZW0ucG9zaXRpb25pbmcsIHRoaXMuaGFzVm9jYWxzKTtcbiAgfVxuXG4gIGlmICh0aGljaykge1xuICAgIGR4Kz00OyAvLzMgaGFyZGNvZGVkO1xuICAgIGFuY2hvciA9IG5ldyBSZWxhdGl2ZUVsZW1lbnQobnVsbCwgZHgsIDQsIDIsIHtcInR5cGVcIjogXCJiYXJcIiwgXCJwaXRjaDJcIjoxMCwgbGluZXdpZHRoOjR9KTtcbiAgICBhYnNlbGVtLmFkZFJpZ2h0KGFuY2hvcik7XG4gICAgZHgrPTU7XG4gIH1cblxuLy8gaWYgKHRoaXMucGFydHN0YXJ0ZWxlbSAmJiAodGhpY2sgfHwgKGZpcnN0dGhpbiAmJiBzZWNvbmR0aGluKSkpIHsgLy8gbWVhbnMgZW5kIG9mIG50aCBwYXJ0XG4vLyB0aGlzLnBhcnRzdGFydGVsZW0uYW5jaG9yMj1hbmNob3I7XG4vLyB0aGlzLnBhcnRzdGFydGVsZW0gPSBudWxsO1xuLy8gfVxuXG4gIGlmICh0aGlzLnBhcnRzdGFydGVsZW0gJiYgZWxlbS5lbmRFbmRpbmcpIHtcbiAgICB0aGlzLnBhcnRzdGFydGVsZW0uYW5jaG9yMj1hbmNob3I7XG4gICAgdGhpcy5wYXJ0c3RhcnRlbGVtID0gbnVsbDtcbiAgfVxuXG4gIGlmIChzZWNvbmR0aGluKSB7XG4gICAgZHgrPTM7IC8vMyBoYXJkY29kZWQ7XG4gICAgYW5jaG9yID0gbmV3IFJlbGF0aXZlRWxlbWVudChudWxsLCBkeCwgMSwgMiwge1widHlwZVwiOiBcImJhclwiLCBcInBpdGNoMlwiOjEwLCBsaW5ld2lkdGg6MC42fSk7XG4gICAgYWJzZWxlbS5hZGRSaWdodChhbmNob3IpOyAvLyAzIGlzIGhhcmRjb2RlZFxuICB9XG5cbiAgaWYgKHNlY29uZGRvdHMpIHtcbiAgICBkeCs9MzsgLy8zIGhhcmRjb2RlZDtcbiAgICBhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJkb3RzLmRvdFwiLCBkeCwgMSwgNykpO1xuICAgIGFic2VsZW0uYWRkUmlnaHQobmV3IFJlbGF0aXZlRWxlbWVudChcImRvdHMuZG90XCIsIGR4LCAxLCA1KSk7XG4gIH0gLy8gMiBpcyBoYXJkY29kZWRcblxuICBpZiAoZWxlbS5zdGFydEVuZGluZyAmJiBpc0ZpcnN0U3RhZmYpIHsgLy8gb25seSBwdXQgdGhlIGZpcnN0ICYgc2Vjb25kIGVuZGluZyBtYXJrcyBvbiB0aGUgZmlyc3Qgc3RhZmZcblx0ICB2YXIgdGV4dFdpZHRoID0gdGhpcy5yZW5kZXJlci5nZXRUZXh0U2l6ZShlbGVtLnN0YXJ0RW5kaW5nLCBcInJlcGVhdGZvbnRcIiwgJycpLndpZHRoO1xuXHQgIGFic2VsZW0ubWluc3BhY2luZyArPSB0ZXh0V2lkdGggKyAxMDsgLy8gR2l2ZSBwbGVudHkgb2Ygcm9vbSBmb3IgdGhlIGVuZGluZyBudW1iZXIuXG4gICAgdGhpcy5wYXJ0c3RhcnRlbGVtID0gbmV3IEVuZGluZ0VsZW0oZWxlbS5zdGFydEVuZGluZywgYW5jaG9yLCBudWxsKTtcblx0ICB2b2ljZS5hZGRPdGhlcih0aGlzLnBhcnRzdGFydGVsZW0pO1xuICB9XG5cbiAgLy8gQWRkIGEgbGl0dGxlIHNwYWNlIHRvIHRoZSBsZWZ0IG9mIHRoZSBiYXIgbGluZSBzbyB0aGF0IG5vdGhpbmcgY2FuIGNyb3dkIGl0LlxuXHRhYnNlbGVtLmV4dHJhdyAtPSA1O1xuXG5cdHJldHVybiBhYnNlbGVtO1xuXG59O1xuXG5cbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gQWJzdHJhY3RFbmdyYXZlcjtcbiIsIi8vICAgIGFiY19iZWFtX2VsZW1lbnQuanM6IERlZmluaXRpb24gb2YgdGhlIEJlYW1FbGVtIGNsYXNzLlxuLy8gICAgQ29weXJpZ2h0IChDKSAyMDEwLTIwMTggR3JlZ29yeSBEeWtlIChncmVnZHlrZSBhdCBnbWFpbCBkb3QgY29tKSBhbmQgUGF1bCBSb3NlblxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgQWJzb2x1dGVFbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfYWJzb2x1dGVfZWxlbWVudCcpO1xudmFyIFJlbGF0aXZlRWxlbWVudCA9IHJlcXVpcmUoJy4vYWJjX3JlbGF0aXZlX2VsZW1lbnQnKTtcbnZhciBzcGFjaW5nID0gcmVxdWlyZSgnLi9hYmNfc3BhY2luZycpO1xuXG52YXIgZ2V0RHVybG9nID0gZnVuY3Rpb24oZHVyYXRpb24pIHtcbiAgICAgICAgLy8gVE9ETy1QRVI6IFRoaXMgaXMgYSBoYWNrIHRvIHByZXZlbnQgYSBDaHJvbWUgbG9ja3VwLiBEdXJhdGlvbiBzaG91bGQgaGF2ZSBiZWVuIGRlZmluZWQgYWxyZWFkeSxcbiAgICAgICAgLy8gYnV0IHRoZXJlJ3MgZGVmaW5pdGVseSBhIGNhc2Ugd2hlcmUgaXQgaXNuJ3QuIFtQcm9iYWJseSBzb21ldGhpbmcgdG8gZG8gd2l0aCB0cmlwbGV0cy5dXG4gICAgICAgIGlmIChkdXJhdGlvbiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgIH1cbi8vICAgICAgICBjb25zb2xlLmxvZyhcImdldER1cmxvZzogXCIgKyBkdXJhdGlvbik7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgubG9nKGR1cmF0aW9uKS9NYXRoLmxvZygyKSk7XG59O1xuXG5cbi8vIE1vc3QgZWxlbWVudHMgb24gdGhlIHBhZ2UgYXJlIHJlbGF0ZWQgdG8gYSBwYXJ0aWN1bGFyIGFic29sdXRlIGVsZW1lbnQgLS0gbm90ZXMsIHJlc3RzLCBiYXJzLCBldGMuIEJlYW1zLCBob3dldmVyLCBzcGFuIG11bHRpcGxlIGVsZW1lbnRzLlxuLy8gVGhpcyBtZWFucyB0aGF0IGJlYW1zIGNhbid0IGJlIGxhaWQgb3V0IHVudGlsIHRoZSBhYnNvbHV0ZSBlbGVtZW50cyBhcmUgcGxhY2VkLiBUaGVyZSBpcyB0aGUgZnVydGhlciBjb21wbGljYXRpb24gdGhhdCB0aGUgc3RlbXMgZm9yIGJlYW1lZFxuLy8gbm90ZXMgY2FuJ3QgYmUgbGFpZCBvdXQgdW50aWwgdGhlIGJlYW1zIGFyZSBiZWNhdXNlIHdlIGRvbid0IGtub3cgaG93IGxvbmcgdGhleSB3aWxsIGJlIHVudGlsIHdlIGtub3cgdGhlIHNsb3BlIG9mIHRoZSBiZWFtIGFuZCB0aGUgaG9yaXpvbnRhbFxuLy8gc3BhY2luZyBvZiB0aGUgYWJzb2x1dGUgZWxlbWVudHMuXG4vL1xuLy8gU28sIHdoZW4gYSBiZWFtIGlzIGRldGVjdGVkLCBhIEJlYW1FbGVtIGlzIGNyZWF0ZWQsIHRoZW4gYWxsIG5vdGVzIGJlbG9uZ2luZyB0byB0aGF0IGJlYW0gYXJlIGFkZGVkIHRvIGl0LiBUaGVzZSBub3RlcyBhcmUgbm90IGdpdmVuIHN0ZW1zIGF0IHRoYXQgdGltZS5cbi8vIFRoZW4sIGFmdGVyIHRoZSBob3Jpem9udGFsIGxheW91dCBpcyBjb21wbGV0ZSwgYWxsIG9mIHRoZSBCZWFtRWxlbSBhcmUgaXRlcmF0ZWQgdG8gc2V0IHRoZSBiZWFtIHBvc2l0aW9uLCB0aGVuIGFsbCBvZiB0aGUgbm90ZXMgdGhhdCBhcmUgYmVhbWVkIGFyZSBnaXZlblxuLy8gc3RlbXMuIEFmdGVyIHRoYXQsIHdlIGFyZSByZWFkeSBmb3IgdGhlIGRyYXdpbmcgc3RlcC5cblxuLy8gVGhlcmUgYXJlIHRocmVlIHBoYXNlczogdGhlIHNldHVwIHBoYXNlLCB3aGVuIG5ldyBlbGVtZW50cyBhcmUgYmVpbmcgZGlzY292ZXJlZCwgdGhlIGxheW91dCBwaGFzZSwgd2hlbiBldmVyeXRoaW5nIGlzIGNhbGN1bGF0ZWQsIGFuZCB0aGUgZHJhd2luZyBwaGFzZSxcbi8vIHdoZW4gdGhlIG9iamVjdCBpcyBub3QgY2hhbmdlZCwgYnV0IGlzIHVzZWQgdG8gcHV0IHRoZSBlbGVtZW50cyBvbiB0aGUgcGFnZS5cblxudmFyIEJlYW1FbGVtO1xuXG4oZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdC8vXG5cdC8vIFNldHVwIHBoYXNlXG5cdC8vXG5cdEJlYW1FbGVtID0gZnVuY3Rpb24gQmVhbUVsZW0oc3RlbUhlaWdodCwgdHlwZSwgZmxhdCkge1xuXHRcdC8vIHR5cGUgaXMgXCJncmFjZVwiLCBcInVwXCIsIFwiZG93blwiLCBvciB1bmRlZmluZWQuIGZsYXQgaXMgdXNlZCB0byBmb3JjZSBmbGF0IGJlYW1zLCBhcyBpdCBjb21tb25seSBmb3VuZCBpbiB0aGUgZ3JhY2Ugbm90ZXMgb2YgYmFncGlwZSBtdXNpYy5cblx0XHR0aGlzLmlzZmxhdCA9IGZsYXQ7XG5cdFx0dGhpcy5pc2dyYWNlID0gKHR5cGUgJiYgdHlwZSA9PT0gXCJncmFjZVwiKTtcblx0XHR0aGlzLmZvcmNldXAgPSB0aGlzLmlzZ3JhY2UgfHwgKHR5cGUgJiYgdHlwZSA9PT0gXCJ1cFwiKTtcblx0XHR0aGlzLmZvcmNlZG93biA9ICh0eXBlICYmIHR5cGUgPT09IFwiZG93blwiKTtcblx0XHR0aGlzLmVsZW1zID0gW107IC8vIGFsbCB0aGUgQWJzb2x1dGVFbGVtZW50cyB0aGF0IHRoaXMgYmVhbSB0b3VjaGVzLiBJdCBtYXkgaW5jbHVkZSBlbWJlZGRlZCByZXN0cy5cblx0XHR0aGlzLnRvdGFsID0gMDtcblx0XHR0aGlzLmFsbHJlc3RzID0gdHJ1ZTtcblx0XHR0aGlzLnN0ZW1IZWlnaHQgPSBzdGVtSGVpZ2h0O1xuXHRcdHRoaXMuYmVhbXMgPSBbXTsgLy8gRHVyaW5nIHRoZSBsYXlvdXQgcGhhc2UsIHRoaXMgd2lsbCBiZWNvbWUgYSBsaXN0IG9mIHRoZSBiZWFtcyB0aGF0IG5lZWQgdG8gYmUgZHJhd24uXG5cdH07XG5cblx0QmVhbUVsZW0ucHJvdG90eXBlLnNldEhpbnQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0dGhpcy5oaW50ID0gdHJ1ZTtcblx0fTtcblxuXHRCZWFtRWxlbS5wcm90b3R5cGUuYWRkID0gZnVuY3Rpb24oYWJzZWxlbSkge1xuXHRcdHZhciBwaXRjaCA9IGFic2VsZW0uYWJjZWxlbS5hdmVyYWdlcGl0Y2g7XG5cdFx0aWYgKHBpdGNoID09PSB1bmRlZmluZWQpIHJldHVybjsgLy8gZG9uJ3QgaW5jbHVkZSBlbGVtZW50cyBsaWtlIHNwYWNlcnMgaW4gYmVhbXNcblx0XHR0aGlzLmFsbHJlc3RzID0gdGhpcy5hbGxyZXN0cyAmJiBhYnNlbGVtLmFiY2VsZW0ucmVzdDtcblx0XHRhYnNlbGVtLmJlYW0gPSB0aGlzO1xuXHRcdHRoaXMuZWxlbXMucHVzaChhYnNlbGVtKTtcblx0XHQvL3ZhciBwaXRjaCA9IGFic2VsZW0uYWJjZWxlbS5hdmVyYWdlcGl0Y2g7XG5cdFx0dGhpcy50b3RhbCArPSBwaXRjaDsgLy8gVE9ETyBDSE9SRCAoZ2V0IHBpdGNoZXMgZnJvbSBhYnNlbGVtLmhlYWRzKVxuXHRcdGlmICghdGhpcy5taW4gfHwgYWJzZWxlbS5hYmNlbGVtLm1pbnBpdGNoIDwgdGhpcy5taW4pIHtcblx0XHRcdHRoaXMubWluID0gYWJzZWxlbS5hYmNlbGVtLm1pbnBpdGNoO1xuXHRcdH1cblx0XHRpZiAoIXRoaXMubWF4IHx8IGFic2VsZW0uYWJjZWxlbS5tYXhwaXRjaCA+IHRoaXMubWF4KSB7XG5cdFx0XHR0aGlzLm1heCA9IGFic2VsZW0uYWJjZWxlbS5tYXhwaXRjaDtcblx0XHR9XG5cdH07XG5cblx0dmFyIG1pZGRsZUxpbmUgPSA2O1x0Ly8gaGFyZGNvZGVkIDYgaXMgQlxuXG5cdEJlYW1FbGVtLnByb3RvdHlwZS5jYWxjRGlyID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuZm9yY2V1cCkgcmV0dXJuIHRydWU7XG5cdFx0aWYgKHRoaXMuZm9yY2Vkb3duKSByZXR1cm4gZmFsc2U7XG5cdFx0dmFyIGF2ZXJhZ2UgPSBjYWxjQXZlcmFnZSh0aGlzLnRvdGFsLCB0aGlzLmVsZW1zLmxlbmd0aCk7XG5cdFx0cmV0dXJuIGF2ZXJhZ2UgPCBtaWRkbGVMaW5lO1xuXHR9O1xuXG5cdC8vXG5cdC8vIGxheW91dCBwaGFzZVxuXHQvL1xuXHRCZWFtRWxlbS5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0aWYgKHRoaXMuZWxlbXMubGVuZ3RoID09PSAwIHx8IHRoaXMuYWxscmVzdHMpIHJldHVybjtcblxuXHRcdHRoaXMuc3RlbXNVcCA9IHRoaXMuY2FsY0RpcigpOyAvLyBUcnVlIG1lYW5zIHRoZSBzdGVtcyBhcmUgZmFjaW5nIHVwLlxuXHRcdHZhciBkeSA9IGNhbGNEeSh0aGlzLnN0ZW1zVXAsIHRoaXMuaXNncmFjZSk7IC8vIFRoaXMgaXMgdGhlIHdpZHRoIG9mIHRoZSBiZWFtIGxpbmUuXG5cblx0XHQvLyBjcmVhdGUgdGhlIG1haW4gYmVhbVxuXHRcdHZhciBmaXJzdEVsZW1lbnQgPSB0aGlzLmVsZW1zWzBdO1xuXHRcdHZhciBsYXN0RWxlbWVudCA9IHRoaXMuZWxlbXNbdGhpcy5lbGVtcy5sZW5ndGggLSAxXTtcblx0XHR2YXIgbWluU3RlbUhlaWdodCA9IDA7IC8vIFRoZSBmb2xsb3dpbmcgaXMgdG8gbGVhdmUgc3BhY2UgZm9yIFwiIS8vLyFcIiBtYXJrcy5cblx0XHR2YXIgcmVmZXJlbmNlUGl0Y2ggPSB0aGlzLnN0ZW1zVXAgPyBmaXJzdEVsZW1lbnQuYWJjZWxlbS5tYXhwaXRjaCA6IGZpcnN0RWxlbWVudC5hYmNlbGVtLm1pbnBpdGNoO1xuXHRcdG1pblN0ZW1IZWlnaHQgPSBtaW5TdGVtKGZpcnN0RWxlbWVudCwgdGhpcy5zdGVtc1VwLCByZWZlcmVuY2VQaXRjaCwgbWluU3RlbUhlaWdodCk7XG5cdFx0bWluU3RlbUhlaWdodCA9IG1pblN0ZW0obGFzdEVsZW1lbnQsIHRoaXMuc3RlbXNVcCwgcmVmZXJlbmNlUGl0Y2gsIG1pblN0ZW1IZWlnaHQpO1xuXHRcdG1pblN0ZW1IZWlnaHQgPSBNYXRoLm1heCh0aGlzLnN0ZW1IZWlnaHQsIG1pblN0ZW1IZWlnaHQgKyAzKTsgLy8gVE9ETy1QRVI6IFRoZSAzIGlzIHRoZSB3aWR0aCBvZiBhIDE2dGggYmVhbS4gVGhlIGFjdHVhbCBoZWlnaHQgb2YgdGhlIGJlYW0gc2hvdWxkIGJlIHVzZWQgaW5zdGVhZC5cblx0XHR2YXIgeVBvcyA9IGNhbGNZUG9zKHRoaXMudG90YWwsIHRoaXMuZWxlbXMubGVuZ3RoLCBtaW5TdGVtSGVpZ2h0LCB0aGlzLnN0ZW1zVXAsIGZpcnN0RWxlbWVudC5hYmNlbGVtLmF2ZXJhZ2VwaXRjaCwgbGFzdEVsZW1lbnQuYWJjZWxlbS5hdmVyYWdlcGl0Y2gsIHRoaXMuaXNmbGF0LCB0aGlzLm1pbiwgdGhpcy5tYXgsIHRoaXMuaXNncmFjZSk7XG5cdFx0dmFyIHhQb3MgPSBjYWxjWFBvcyh0aGlzLnN0ZW1zVXAsIGZpcnN0RWxlbWVudCwgbGFzdEVsZW1lbnQpO1xuXHRcdHRoaXMuYmVhbXMucHVzaCh7IHN0YXJ0WDogeFBvc1swXSwgZW5kWDogeFBvc1sxXSwgc3RhcnRZOiB5UG9zWzBdLCBlbmRZOiB5UG9zWzFdLCBkeTogZHkgfSk7XG5cblx0XHQvLyBjcmVhdGUgdGhlIHJlc3Qgb2YgdGhlIGJlYW1zIChpbiB0aGUgY2FzZSBvZiAxLzE2dGggbm90ZXMsIGV0Yy5cblx0XHR2YXIgYmVhbXMgPSBjcmVhdGVBZGRpdGlvbmFsQmVhbXModGhpcy5lbGVtcywgdGhpcy5zdGVtc1VwLCB0aGlzLmJlYW1zWzBdLCB0aGlzLmlzZ3JhY2UsIGR5KTtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGJlYW1zLmxlbmd0aDsgaSsrKVxuXHRcdFx0dGhpcy5iZWFtcy5wdXNoKGJlYW1zW2ldKTtcblxuXHRcdC8vIE5vdyB0aGF0IHRoZSBtYWluIGJlYW0gaXMgZGVmaW5lZCwgd2Uga25vdyBob3cgdGFsbCB0aGUgc3RlbXMgc2hvdWxkIGJlLCBzbyBjcmVhdGUgdGhlbSBhbmQgYXR0YWNoIHRoZW0gdG8gdGhlIG9yaWdpbmFsIG5vdGVzLlxuXHRcdGNyZWF0ZVN0ZW1zKHRoaXMuZWxlbXMsIHRoaXMuc3RlbXNVcCwgdGhpcy5iZWFtc1swXSwgZHksIHRoaXMubWFpbk5vdGUpO1xuXHR9O1xuXG5cdEJlYW1FbGVtLnByb3RvdHlwZS5pc0Fib3ZlID0gZnVuY3Rpb24oKSB7XG5cdFx0cmV0dXJuIHRoaXMuc3RlbXNVcDtcblx0fTtcblxuXHQvLyBXZSBjYW4ndCBqdXN0IHVzZSB0aGUgZW50aXJlIGJlYW0gZm9yIHRoZSBjYWxjdWxhdGlvbi4gVGhlIHJhbmdlIGhhcyB0byBiZSBwYXNzZWQgaW4sIGJlY2F1c2UgdGhlIGJlYW0gbWlnaHQgZXh0ZW5kIGludG8gc29tZSB1bnJlbGF0ZWQgbm90ZXMuIGZvciBpbnN0YW5jZSwgKDNfYSdmJ2UnZicyIHdoZW4gTDoxNlxuXHRCZWFtRWxlbS5wcm90b3R5cGUuaGVpZ2h0QXRNaWRwb2ludCA9IGZ1bmN0aW9uKHN0YXJ0WCwgZW5kWCkge1xuXHRcdGlmICh0aGlzLmJlYW1zLmxlbmd0aCA9PT0gMClcblx0XHRcdHJldHVybiAwO1xuXHRcdHZhciBiZWFtID0gdGhpcy5iZWFtc1swXTtcblx0XHR2YXIgbWlkUG9pbnQgPSBzdGFydFggKyAoZW5kWCAtIHN0YXJ0WCkgLyAyO1xuXHRcdHJldHVybiBnZXRCYXJZQXQoYmVhbS5zdGFydFgsIGJlYW0uc3RhcnRZLCBiZWFtLmVuZFgsIGJlYW0uZW5kWSwgbWlkUG9pbnQpO1xuXHR9O1xuXG5cdEJlYW1FbGVtLnByb3RvdHlwZS55QXROb3RlID0gZnVuY3Rpb24oZWxlbWVudCkge1xuXHRcdHZhciBiZWFtID0gdGhpcy5iZWFtc1swXTtcblx0XHRyZXR1cm4gZ2V0QmFyWUF0KGJlYW0uc3RhcnRYLCBiZWFtLnN0YXJ0WSwgYmVhbS5lbmRYLCBiZWFtLmVuZFksIGVsZW1lbnQueCk7XG5cdH07XG5cblx0QmVhbUVsZW0ucHJvdG90eXBlLnhBdE1pZHBvaW50ID0gZnVuY3Rpb24oc3RhcnRYLCBlbmRYKSB7XG5cdFx0cmV0dXJuIHN0YXJ0WCArIChlbmRYIC0gc3RhcnRYKS8yO1xuXHR9O1xuXG5cdC8vXG5cdC8vIERyYXdpbmcgcGhhc2Vcblx0Ly9cblx0QmVhbUVsZW0ucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbihyZW5kZXJlcikge1xuXHRcdGlmICh0aGlzLmJlYW1zLmxlbmd0aCA9PT0gMCkgcmV0dXJuO1xuXG5cdFx0cmVuZGVyZXIuYmVnaW5Hcm91cCgpO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5iZWFtcy5sZW5ndGg7IGkrKykge1xuXHRcdFx0dmFyIGJlYW0gPSB0aGlzLmJlYW1zW2ldO1xuXHRcdFx0ZHJhd0JlYW0ocmVuZGVyZXIsIGJlYW0uc3RhcnRYLCBiZWFtLnN0YXJ0WSwgYmVhbS5lbmRYLCBiZWFtLmVuZFksIGJlYW0uZHksIHRoaXMuaGludCk7XG5cdFx0fVxuXHRcdHJlbmRlcmVyLmVuZEdyb3VwKCdiZWFtLWVsZW0nKTtcblx0fTtcblxuXHQvL1xuXHQvLyBwcml2YXRlIGZ1bmN0aW9uc1xuXHQvL1xuXHRmdW5jdGlvbiBtaW5TdGVtKGVsZW1lbnQsIHN0ZW1zVXAsIHJlZmVyZW5jZVBpdGNoLCBtaW5TdGVtSGVpZ2h0KSB7XG5cdFx0aWYgKCFlbGVtZW50LmNoaWxkcmVuKVxuXHRcdFx0cmV0dXJuIG1pblN0ZW1IZWlnaHQ7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtZW50LmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgZWxlbSA9IGVsZW1lbnQuY2hpbGRyZW5baV07XG5cdFx0XHRpZiAoc3RlbXNVcCAmJiBlbGVtLnRvcCAhPT0gdW5kZWZpbmVkICYmIGVsZW0uYyA9PT0gXCJmbGFncy51Z3JhY2VcIilcblx0XHRcdFx0bWluU3RlbUhlaWdodCA9IE1hdGgubWF4KG1pblN0ZW1IZWlnaHQsIGVsZW0udG9wIC0gcmVmZXJlbmNlUGl0Y2gpO1xuXHRcdFx0ZWxzZSBpZiAoIXN0ZW1zVXAgJiYgZWxlbS5ib3R0b20gIT09IHVuZGVmaW5lZCAmJiBlbGVtLmMgPT09IFwiZmxhZ3MudWdyYWNlXCIpXG5cdFx0XHRcdG1pblN0ZW1IZWlnaHQgPSBNYXRoLm1heChtaW5TdGVtSGVpZ2h0LCByZWZlcmVuY2VQaXRjaCAtIGVsZW0uYm90dG9tICsgNyk7IC8vIFRoZSBleHRyYSA3IGlzIGJlY2F1c2Ugd2UgYXJlIG1lYXN1cmluZyB0aGUgc2xhc2ggZnJvbSB0aGUgdG9wLlxuXHRcdH1cblx0XHRyZXR1cm4gbWluU3RlbUhlaWdodDtcblx0fVxuXG5cdGZ1bmN0aW9uIGNhbGNTbGFudChsZWZ0QXZlcmFnZVBpdGNoLCByaWdodEF2ZXJhZ2VQaXRjaCwgbnVtU3RlbXMsIGlzRmxhdCkge1xuXHRcdGlmIChpc0ZsYXQpXG5cdFx0XHRyZXR1cm4gMDtcblx0XHR2YXIgc2xhbnQgPSBsZWZ0QXZlcmFnZVBpdGNoIC0gcmlnaHRBdmVyYWdlUGl0Y2g7XG5cdFx0dmFyIG1heFNsYW50ID0gbnVtU3RlbXMgLyAyO1xuXG5cdFx0aWYgKHNsYW50ID4gbWF4U2xhbnQpIHNsYW50ID0gbWF4U2xhbnQ7XG5cdFx0aWYgKHNsYW50IDwgLW1heFNsYW50KSBzbGFudCA9IC1tYXhTbGFudDtcblx0XHRyZXR1cm4gc2xhbnQ7XG5cdH1cblxuXHRmdW5jdGlvbiBjYWxjQXZlcmFnZSh0b3RhbCwgbnVtRWxlbWVudHMpIHtcblx0XHRpZiAoIW51bUVsZW1lbnRzKVxuXHRcdFx0cmV0dXJuIDA7XG5cdFx0cmV0dXJuIHRvdGFsIC8gbnVtRWxlbWVudHM7XG5cdH1cblxuXHRmdW5jdGlvbiBnZXRCYXJZQXQoc3RhcnR4LCBzdGFydHksIGVuZHgsIGVuZHksIHgpIHtcblx0XHRyZXR1cm4gc3RhcnR5ICsgKGVuZHkgLSBzdGFydHkpIC8gKGVuZHggLSBzdGFydHgpICogKHggLSBzdGFydHgpO1xuXHR9XG5cblx0ZnVuY3Rpb24gY2FsY0R5KGFzYywgaXNHcmFjZSkge1xuXHRcdHZhciBkeSA9IChhc2MpID8gc3BhY2luZy5TVEVQIDogLXNwYWNpbmcuU1RFUDtcblx0XHRpZiAoaXNHcmFjZSkgZHkgPSBkeSAqIDAuNDtcblx0XHRyZXR1cm4gZHk7XG5cdH1cblxuXHRmdW5jdGlvbiBkcmF3QmVhbShyZW5kZXJlciwgc3RhcnRYLCBzdGFydFksIGVuZFgsIGVuZFksIGR5LCBpc0hpbnQpIHtcblx0XHR2YXIga2xhc3MgPSAnYmVhbS1lbGVtJztcblx0XHRpZiAoaXNIaW50KVxuXHRcdFx0a2xhc3MgKz0gXCIgYWJjanMtaGludFwiO1xuXG5cdFx0Ly8gdGhlIFggY29vcmRpbmF0ZXMgYXJlIGFjdHVhbCBjb29yZGluYXRlcywgYnV0IHRoZSBZIGNvb3JkaW5hdGVzIGFyZSBpbiBwaXRjaGVzLlxuXHRcdHN0YXJ0WSA9IHJlbmRlcmVyLmNhbGNZKHN0YXJ0WSk7XG5cdFx0ZW5kWSA9IHJlbmRlcmVyLmNhbGNZKGVuZFkpO1xuXHRcdHZhciBwYXRoU3RyaW5nID0gXCJNXCIgKyBzdGFydFggKyBcIiBcIiArIHN0YXJ0WSArIFwiIExcIiArIGVuZFggKyBcIiBcIiArIGVuZFkgK1xuXHRcdFx0XCJMXCIgKyBlbmRYICsgXCIgXCIgKyAoZW5kWSArIGR5KSArIFwiIExcIiArIHN0YXJ0WCArIFwiIFwiICsgKHN0YXJ0WSArIGR5KSArIFwielwiO1xuXHRcdHJlbmRlcmVyLnByaW50UGF0aCh7XG5cdFx0XHRwYXRoOiBwYXRoU3RyaW5nLFxuXHRcdFx0c3Ryb2tlOiBcIm5vbmVcIixcblx0XHRcdGZpbGw6IFwiIzAwMDAwMFwiLFxuXHRcdFx0J2NsYXNzJzogcmVuZGVyZXIuYWRkQ2xhc3NlcyhrbGFzcylcblx0XHR9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGNhbGNYUG9zKGFzYywgZmlyc3RFbGVtZW50LCBsYXN0RWxlbWVudCkge1xuXHRcdHZhciBzdGFydGhlYWQgPSBmaXJzdEVsZW1lbnQuaGVhZHNbYXNjID8gMCA6IGZpcnN0RWxlbWVudC5oZWFkcy5sZW5ndGggLSAxXTtcblx0XHR2YXIgZW5kaGVhZCA9IGxhc3RFbGVtZW50LmhlYWRzW2FzYyA/IDAgOiBsYXN0RWxlbWVudC5oZWFkcy5sZW5ndGggLSAxXTtcblx0XHR2YXIgc3RhcnRYID0gc3RhcnRoZWFkLng7XG5cdFx0aWYgKGFzYykgc3RhcnRYICs9IHN0YXJ0aGVhZC53IC0gMC42O1xuXHRcdHZhciBlbmRYID0gZW5kaGVhZC54O1xuXHRcdGlmIChhc2MpIGVuZFggKz0gZW5kaGVhZC53O1xuXHRcdHJldHVybiBbIHN0YXJ0WCwgZW5kWCBdO1xuXHR9XG5cblx0ZnVuY3Rpb24gY2FsY1lQb3ModG90YWwsIG51bUVsZW1lbnRzLCBzdGVtSGVpZ2h0LCBhc2MsIGZpcnN0QXZlcmFnZVBpdGNoLCBsYXN0QXZlcmFnZVBpdGNoLCBpc0ZsYXQsIG1pblBpdGNoLCBtYXhQaXRjaCwgaXNHcmFjZSkge1xuXHRcdHZhciBhdmVyYWdlID0gY2FsY0F2ZXJhZ2UodG90YWwsIG51bUVsZW1lbnRzKTsgLy8gVGhpcyBpcyB0aGUgYXZlcmFnZSBwaXRjaCBmb3IgdGhlIGFsbCB0aGUgbm90ZXMgdGhhdCB3aWxsIGJlIGJlYW1lZC5cblx0XHR2YXIgYmFycG9zID0gc3RlbUhlaWdodCAtIDI7IC8vIChpc0dyYWNlKT8gNTo3O1xuXHRcdHZhciBiYXJtaW5wb3MgPSBzdGVtSGVpZ2h0IC0gMjtcblx0XHR2YXIgcG9zID0gTWF0aC5yb3VuZChhc2MgPyBNYXRoLm1heChhdmVyYWdlICsgYmFycG9zLCBtYXhQaXRjaCArIGJhcm1pbnBvcykgOiBNYXRoLm1pbihhdmVyYWdlIC0gYmFycG9zLCBtaW5QaXRjaCAtIGJhcm1pbnBvcykpO1xuXG5cdFx0dmFyIHNsYW50ID0gY2FsY1NsYW50KGZpcnN0QXZlcmFnZVBpdGNoLCBsYXN0QXZlcmFnZVBpdGNoLCBudW1FbGVtZW50cywgaXNGbGF0KTtcblx0XHR2YXIgc3RhcnRZID0gcG9zICsgTWF0aC5mbG9vcihzbGFudCAvIDIpO1xuXHRcdHZhciBlbmRZID0gcG9zICsgTWF0aC5mbG9vcigtc2xhbnQgLyAyKTtcblxuXHRcdC8vIElmIHRoZSBub3RlcyBhcmUgdG9vIGhpZ2ggb3IgdG9vIGxvdywgbWFrZSB0aGUgYmVhbSBnbyBkb3duIHRvIHRoZSBtaWRkbGVcblx0XHRpZiAoIWlzR3JhY2UpIHtcblx0XHRcdGlmIChhc2MgJiYgcG9zIDwgNikge1xuXHRcdFx0XHRzdGFydFkgPSA2O1xuXHRcdFx0XHRlbmRZID0gNjtcblx0XHRcdH0gZWxzZSBpZiAoIWFzYyAmJiBwb3MgPiA2KSB7XG5cdFx0XHRcdHN0YXJ0WSA9IDY7XG5cdFx0XHRcdGVuZFkgPSA2O1xuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHJldHVybiBbIHN0YXJ0WSwgZW5kWV07XG5cdH1cblxuXHRmdW5jdGlvbiBjcmVhdGVTdGVtcyhlbGVtcywgYXNjLCBiZWFtLCBkeSwgbWFpbk5vdGUpIHtcblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgZWxlbSA9IGVsZW1zW2ldO1xuXHRcdFx0aWYgKGVsZW0uYWJjZWxlbS5yZXN0KVxuXHRcdFx0XHRjb250aW51ZTtcblx0XHRcdC8vIFRPRE8tUEVSOiBUaGlzIGlzIG9kZC4gSWYgaXQgaXMgYSByZWd1bGFyIGJlYW0gdGhlbiBlbGVtcyBpcyBhbiBhcnJheSBvZiBBYnNvbHV0ZUVsZW1lbnRzLCBpZiBpdCBpcyBhIGdyYWNlIGJlYW0gdGhlbiBpdCBpcyBhbiBhcnJheSBvZiBvYmplY3RzICwgc28gd2UgZGlyZWN0bHkgYXR0YWNoIHRoZSBlbGVtZW50IHRvIHRoZSBwYXJlbnQuIFdlIHRlbGwgaXQgaWYgaXMgYSBncmFjZSBub3RlIGJlY2F1c2UgdGhleSBhcmUgcGFzc2VkIGluIGFzIGEgZ2VuZXJpYyBvYmplY3QgaW5zdGVhZCBvZiBhbiBBYnNvbHV0ZUVsZW1lbnQuXG5cdFx0XHR2YXIgaXNHcmFjZSA9IGVsZW0uYWRkRXh0cmEgPyBmYWxzZSA6IHRydWU7XG5cdFx0XHR2YXIgcGFyZW50ID0gaXNHcmFjZSA/IG1haW5Ob3RlIDogZWxlbTtcblx0XHRcdHZhciBmdXJ0aGVzdEhlYWQgPSBlbGVtLmhlYWRzWyhhc2MpID8gMCA6IGVsZW0uaGVhZHMubGVuZ3RoIC0gMV07XG5cdFx0XHR2YXIgb3ZhbERlbHRhID0gMSAvIDU7Ly8oaXNHcmFjZSk/MS8zOjEvNTtcblx0XHRcdHZhciBwaXRjaCA9IGZ1cnRoZXN0SGVhZC5waXRjaCArICgoYXNjKSA/IG92YWxEZWx0YSA6IC1vdmFsRGVsdGEpO1xuXHRcdFx0dmFyIGR4ID0gYXNjID8gZnVydGhlc3RIZWFkLncgOiAwOyAvLyBkb3duLXBvaW50aW5nIHN0ZW1zIHN0YXJ0IG9uIHRoZSBsZWZ0IHNpZGUgb2YgdGhlIG5vdGUsIHVwLXBvaW50aW5nIHN0ZW1zIHN0YXJ0IG9uIHRoZSByaWdodCBzaWRlLCBzbyB3ZSBvZmZzZXQgYnkgdGhlIG5vdGUgd2lkdGguXG5cdFx0XHR2YXIgeCA9IGZ1cnRoZXN0SGVhZC54ICsgZHg7IC8vIHRoaXMgaXMgbm93IHRoZSBhY3R1YWwgeCBsb2NhdGlvbiBpbiBwaXhlbHMuXG5cdFx0XHR2YXIgYmFyeSA9IGdldEJhcllBdChiZWFtLnN0YXJ0WCwgYmVhbS5zdGFydFksIGJlYW0uZW5kWCwgYmVhbS5lbmRZLCB4KTtcblx0XHRcdHZhciBsaW5lV2lkdGggPSAoYXNjKSA/IC0wLjYgOiAwLjY7XG5cdFx0XHRpZiAoIWFzYylcblx0XHRcdFx0YmFyeSAtPSAoZHkgLyAyKSAvIHNwYWNpbmcuU1RFUDtcdC8vIFRPRE8tUEVSOiBUaGlzIGlzIGp1c3QgYSBmdWRnZSBmYWN0b3Igc28gdGhlIGRvd24tcG9pbnRpbmcgc3RlbXMgZG9uJ3Qgb3ZlcmxhcC5cblx0XHRcdGlmIChpc0dyYWNlKVxuXHRcdFx0XHRkeCArPSBlbGVtLmhlYWRzWzBdLmR4O1xuXHRcdFx0Ly8gVE9ETy1QRVItSEFDSzogT25lIHR5cGUgb2Ygbm90ZSBoZWFkIGhhcyBhIGRpZmZlcmVudCBwbGFjZW1lbnQgb2YgdGhlIHN0ZW0uIFRoaXMgc2hvdWxkIGJlIG1vcmUgZ2VuZXJpY2FsbHkgY2FsY3VsYXRlZDpcblx0XHRcdGlmIChmdXJ0aGVzdEhlYWQuYyA9PT0gJ25vdGVoZWFkcy5zbGFzaC5xdWFydGVyJykge1xuXHRcdFx0XHRpZiAoYXNjKVxuXHRcdFx0XHRcdHBpdGNoICs9IDE7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHRwaXRjaCAtPSAxO1xuXHRcdFx0fVxuXHRcdFx0dmFyIHN0ZW0gPSBuZXcgUmVsYXRpdmVFbGVtZW50KG51bGwsIGR4LCAwLCBwaXRjaCwge1xuXHRcdFx0XHRcInR5cGVcIjogXCJzdGVtXCIsXG5cdFx0XHRcdFwicGl0Y2gyXCI6IGJhcnksXG5cdFx0XHRcdGxpbmV3aWR0aDogbGluZVdpZHRoXG5cdFx0XHR9KTtcblx0XHRcdHN0ZW0uc2V0WChwYXJlbnQueCk7IC8vIFRoaXMgaXMgYWZ0ZXIgdGhlIHggY29vcmRpbmF0ZXMgd2VyZSBzZXQsIHNvIHdlIGhhdmUgdG8gc2V0IGl0IGRpcmVjdGx5LlxuXHRcdFx0cGFyZW50LmFkZEV4dHJhKHN0ZW0pO1xuXHRcdH1cblxuXHR9XG5cblx0ZnVuY3Rpb24gY3JlYXRlQWRkaXRpb25hbEJlYW1zKGVsZW1zLCBhc2MsIGJlYW0sIGlzR3JhY2UsIGR5KSB7XG5cdFx0dmFyIGJlYW1zID0gW107XG5cdFx0dmFyIGF1eEJlYW1zID0gW107ICAvLyBhdXhiZWFtIHdpbGwgYmUge3gsIHksIGR1cmxvZywgc2luZ2xlfSBhdXhiZWFtWzBdIHNob3VsZCBtYXRjaCB3aXRoIGR1cmxvZz0tNCAoMTZ0aCkgKGo9LTQtZHVybG9nKVxuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHtcblx0XHRcdHZhciBlbGVtID0gZWxlbXNbaV07XG5cdFx0XHRpZiAoZWxlbS5hYmNlbGVtLnJlc3QpXG5cdFx0XHRcdGNvbnRpbnVlO1xuXHRcdFx0dmFyIGZ1cnRoZXN0SGVhZCA9IGVsZW0uaGVhZHNbKGFzYykgPyAwIDogZWxlbS5oZWFkcy5sZW5ndGggLSAxXTtcblx0XHRcdHZhciB4ID0gZnVydGhlc3RIZWFkLnggKyAoKGFzYykgPyBmdXJ0aGVzdEhlYWQudyA6IDApO1xuXHRcdFx0dmFyIGJhcnkgPSBnZXRCYXJZQXQoYmVhbS5zdGFydFgsIGJlYW0uc3RhcnRZLCBiZWFtLmVuZFgsIGJlYW0uZW5kWSwgeCk7XG5cblx0XHRcdHZhciBzeSA9IChhc2MpID8gLTEuNSA6IDEuNTtcblx0XHRcdGlmIChpc0dyYWNlKSBzeSA9IHN5ICogMiAvIDM7IC8vIFRoaXMgbWFrZXMgdGhlIHNlY29uZCBiZWFtIG9uIGdyYWNlIG5vdGVzIGNsb3NlciB0byB0aGUgZmlyc3Qgb25lLlxuXHRcdFx0dmFyIGR1cmF0aW9uID0gZWxlbS5hYmNlbGVtLmR1cmF0aW9uOyAvLyBnZXQgdGhlIGR1cmF0aW9uIHZpYSBhYmNlbGVtIGJlY2F1c2Ugb2YgdHJpcGxldHNcblx0XHRcdGlmIChkdXJhdGlvbiA9PT0gMCkgZHVyYXRpb24gPSAwLjI1OyAvLyBpZiB0aGlzIGlzIHN0ZW1sZXNzLCB0aGVuIHdlIHVzZSBxdWFydGVyIG5vdGUgYXMgdGhlIGR1cmF0aW9uLlxuXHRcdFx0Zm9yICh2YXIgZHVybG9nID0gZ2V0RHVybG9nKGR1cmF0aW9uKTsgZHVybG9nIDwgLTM7IGR1cmxvZysrKSB7XG5cdFx0XHRcdGlmIChhdXhCZWFtc1stNCAtIGR1cmxvZ10pIHtcblx0XHRcdFx0XHRhdXhCZWFtc1stNCAtIGR1cmxvZ10uc2luZ2xlID0gZmFsc2U7XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YXV4QmVhbXNbLTQgLSBkdXJsb2ddID0ge1xuXHRcdFx0XHRcdFx0eDogeCArICgoYXNjKSA/IC0wLjYgOiAwKSwgeTogYmFyeSArIHN5ICogKC00IC0gZHVybG9nICsgMSksXG5cdFx0XHRcdFx0XHRkdXJsb2c6IGR1cmxvZywgc2luZ2xlOiB0cnVlXG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXG5cdFx0XHRmb3IgKHZhciBqID0gYXV4QmVhbXMubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHtcblx0XHRcdFx0aWYgKGkgPT09IGVsZW1zLmxlbmd0aCAtIDEgfHwgZ2V0RHVybG9nKGVsZW1zW2kgKyAxXS5hYmNlbGVtLmR1cmF0aW9uKSA+ICgtaiAtIDQpKSB7XG5cblx0XHRcdFx0XHR2YXIgYXV4QmVhbUVuZFggPSB4O1xuXHRcdFx0XHRcdHZhciBhdXhCZWFtRW5kWSA9IGJhcnkgKyBzeSAqIChqICsgMSk7XG5cblxuXHRcdFx0XHRcdGlmIChhdXhCZWFtc1tqXS5zaW5nbGUpIHtcblx0XHRcdFx0XHRcdGF1eEJlYW1FbmRYID0gKGkgPT09IDApID8geCArIDUgOiB4IC0gNTtcblx0XHRcdFx0XHRcdGF1eEJlYW1FbmRZID0gZ2V0QmFyWUF0KGJlYW0uc3RhcnRYLCBiZWFtLnN0YXJ0WSwgYmVhbS5lbmRYLCBiZWFtLmVuZFksIGF1eEJlYW1FbmRYKSArIHN5ICogKGogKyAxKTtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YmVhbXMucHVzaCh7IHN0YXJ0WDogYXV4QmVhbXNbal0ueCwgZW5kWDogYXV4QmVhbUVuZFgsIHN0YXJ0WTogYXV4QmVhbXNbal0ueSwgZW5kWTogYXV4QmVhbUVuZFksIGR5OiBkeSB9KTtcblx0XHRcdFx0XHRhdXhCZWFtcyA9IGF1eEJlYW1zLnNsaWNlKDAsIGopO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBiZWFtcztcblx0fVxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBCZWFtRWxlbTtcbiIsIi8vICAgIGFiY19icmFjZV9lbGVtZW50LmpzOiBEZWZpbml0aW9uIG9mIHRoZSBCcmFjZUVsZW1lbnQgY2xhc3MuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBHcmVnb3J5IER5a2UgKGdyZWdkeWtlIGF0IGdtYWlsIGRvdCBjb20pIGFuZCBQYXVsIFJvc2VuXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbnZhciBCcmFjZUVsZW0gPSBmdW5jdGlvbiBCcmFjZUVsZW0oKSB7XG4gICAgdGhpcy5sZW5ndGggPSAxO1xufTtcblxuQnJhY2VFbGVtLnByb3RvdHlwZS5pbmNyZWFzZVN0YXZlc0luY2x1ZGVkID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5sZW5ndGgrKztcbn07XG5cbkJyYWNlRWxlbS5wcm90b3R5cGUuc2V0TG9jYXRpb24gPSBmdW5jdGlvbih4KSB7XG5cdHRoaXMueCA9IHg7XG59O1xuXG5CcmFjZUVsZW0ucHJvdG90eXBlLmdldFdpZHRoID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiAxMDsgLy8gVE9ETy1QRVI6IHJpZ2h0IG5vdyB0aGUgZHJhd2luZyBmdW5jdGlvbiBkb2Vzbid0IHZhcnkgdGhlIHdpZHRoIGF0IGFsbC4gSWYgaXQgZG9lcyBpbiB0aGUgZnV0dXJlIHRoZW4gdGhpcyB3aWxsIGNoYW5nZS5cbn07XG5cbkJyYWNlRWxlbS5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKHJlbmRlcmVyLCB0b3AsIGJvdHRvbSkge1xuICAgIHRoaXMuc3RhcnRZID0gdG9wO1xuICAgIHRoaXMuZW5kWSA9IGJvdHRvbTtcbn07XG5cbkJyYWNlRWxlbS5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uIChyZW5kZXJlciwgdG9wLCBib3R0b20pIHtcbiAgICB0aGlzLmxheW91dChyZW5kZXJlciwgdG9wLCBib3R0b20pO1xuICAgIHJlbmRlcmVyLmRyYXdCcmFjZSh0aGlzLngsdGhpcy5zdGFydFksIHRoaXMuZW5kWSk7XG5cbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQnJhY2VFbGVtO1xuIiwiLy8gICAgYWJjX2NyZWF0ZV9jbGVmLmpzXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBHcmVnb3J5IER5a2UgKGdyZWdkeWtlIGF0IGdtYWlsIGRvdCBjb20pIGFuZCBQYXVsIFJvc2VuXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbnZhciBBYnNvbHV0ZUVsZW1lbnQgPSByZXF1aXJlKCcuL2FiY19hYnNvbHV0ZV9lbGVtZW50Jyk7XG52YXIgZ2x5cGhzID0gcmVxdWlyZSgnLi9hYmNfZ2x5cGhzJyk7XG52YXIgUmVsYXRpdmVFbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfcmVsYXRpdmVfZWxlbWVudCcpO1xuXG52YXIgY3JlYXRlQ2xlZjtcblxuKGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblxuXHRjcmVhdGVDbGVmID0gZnVuY3Rpb24oZWxlbSwgdHVuZU51bWJlcikge1xuXHRcdHZhciBjbGVmO1xuXHRcdHZhciBvY3RhdmUgPSAwO1xuXHRcdHZhciBhYnNlbGVtID0gbmV3IEFic29sdXRlRWxlbWVudChlbGVtLDAsMTAsICdzdGFmZi1leHRyYScsIHR1bmVOdW1iZXIpO1xuXHRcdGFic2VsZW0uaXNDbGVmID0gdHJ1ZTtcblx0XHRzd2l0Y2ggKGVsZW0udHlwZSkge1xuXHRcdFx0Y2FzZSBcInRyZWJsZVwiOiBjbGVmID0gXCJjbGVmcy5HXCI7IGJyZWFrO1xuXHRcdFx0Y2FzZSBcInRlbm9yXCI6IGNsZWY9XCJjbGVmcy5DXCI7IGJyZWFrO1xuXHRcdFx0Y2FzZSBcImFsdG9cIjogY2xlZj1cImNsZWZzLkNcIjsgYnJlYWs7XG5cdFx0XHRjYXNlIFwiYmFzc1wiOiBjbGVmPVwiY2xlZnMuRlwiOyBicmVhaztcblx0XHRcdGNhc2UgJ3RyZWJsZSs4JzogY2xlZiA9IFwiY2xlZnMuR1wiOyBvY3RhdmUgPSAxOyBicmVhaztcblx0XHRcdGNhc2UgJ3Rlbm9yKzgnOmNsZWY9XCJjbGVmcy5DXCI7IG9jdGF2ZSA9IDE7IGJyZWFrO1xuXHRcdFx0Y2FzZSAnYmFzcys4JzogY2xlZj1cImNsZWZzLkZcIjsgb2N0YXZlID0gMTsgYnJlYWs7XG5cdFx0XHRjYXNlICdhbHRvKzgnOiBjbGVmPVwiY2xlZnMuQ1wiOyBvY3RhdmUgPSAxOyBicmVhaztcblx0XHRcdGNhc2UgJ3RyZWJsZS04JzogY2xlZiA9IFwiY2xlZnMuR1wiOyBvY3RhdmUgPSAtMTsgYnJlYWs7XG5cdFx0XHRjYXNlICd0ZW5vci04JzpjbGVmPVwiY2xlZnMuQ1wiOyBvY3RhdmUgPSAtMTsgYnJlYWs7XG5cdFx0XHRjYXNlICdiYXNzLTgnOiBjbGVmPVwiY2xlZnMuRlwiOyBvY3RhdmUgPSAtMTsgYnJlYWs7XG5cdFx0XHRjYXNlICdhbHRvLTgnOiBjbGVmPVwiY2xlZnMuQ1wiOyBvY3RhdmUgPSAtMTsgYnJlYWs7XG5cdFx0XHRjYXNlICdub25lJzogcmV0dXJuIG51bGw7XG5cdFx0XHRjYXNlICdwZXJjJzogY2xlZj1cImNsZWZzLnBlcmNcIjsgYnJlYWs7XG5cdFx0XHRkZWZhdWx0OiBhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJjbGVmPVwiK2VsZW0udHlwZSwgMCwgMCwgdW5kZWZpbmVkLCB7dHlwZTpcImRlYnVnXCJ9KSk7XG5cdFx0fVxuXHRcdC8vIGlmIChlbGVtLnZlcnRpY2FsUG9zKSB7XG5cdFx0Ly8gcGl0Y2ggPSBlbGVtLnZlcnRpY2FsUG9zO1xuXHRcdC8vIH1cblx0XHR2YXIgZHggPTU7XG5cdFx0aWYgKGNsZWYpIHtcblx0XHRcdGFic2VsZW0uYWRkUmlnaHQobmV3IFJlbGF0aXZlRWxlbWVudChjbGVmLCBkeCwgZ2x5cGhzLmdldFN5bWJvbFdpZHRoKGNsZWYpLCBlbGVtLmNsZWZQb3MpKTtcblxuXHRcdFx0aWYgKGNsZWYgPT09ICdjbGVmcy5HJykge1xuXHRcdFx0XHRhYnNlbGVtLnRvcCA9IDEzO1xuXHRcdFx0XHRhYnNlbGVtLmJvdHRvbSA9IC0xO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0YWJzZWxlbS50b3AgPSAxMDtcblx0XHRcdFx0YWJzZWxlbS5ib3R0b20gPSAyO1xuXHRcdFx0fVxuXHRcdFx0aWYgKG9jdGF2ZSAhPT0gMCkge1xuXHRcdFx0XHR2YXIgc2NhbGUgPSAyIC8gMztcblx0XHRcdFx0dmFyIGFkanVzdHNwYWNpbmcgPSAoZ2x5cGhzLmdldFN5bWJvbFdpZHRoKGNsZWYpIC0gZ2x5cGhzLmdldFN5bWJvbFdpZHRoKFwiOFwiKSAqIHNjYWxlKSAvIDI7XG5cdFx0XHRcdGFic2VsZW0uYWRkUmlnaHQobmV3IFJlbGF0aXZlRWxlbWVudChcIjhcIiwgZHggKyBhZGp1c3RzcGFjaW5nLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoXCI4XCIpICogc2NhbGUsIChvY3RhdmUgPiAwKSA/IGFic2VsZW0udG9wICsgMyA6IGFic2VsZW0uYm90dG9tIC0gMSwge1xuXHRcdFx0XHRcdHNjYWxleDogc2NhbGUsXG5cdFx0XHRcdFx0c2NhbGV5OiBzY2FsZVxuXHRcdFx0XHR9KSk7XG5cdFx0XHRcdGFic2VsZW0udG9wICs9IDI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHJldHVybiBhYnNlbGVtO1xuXHR9O1xuXG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUNsZWY7XG4iLCIvLyAgICBhYmNfY3JlYXRlX2tleV9zaWduYXR1cmUuanNcbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIEFic29sdXRlRWxlbWVudCA9IHJlcXVpcmUoJy4vYWJjX2Fic29sdXRlX2VsZW1lbnQnKTtcbnZhciBnbHlwaHMgPSByZXF1aXJlKCcuL2FiY19nbHlwaHMnKTtcbnZhciBSZWxhdGl2ZUVsZW1lbnQgPSByZXF1aXJlKCcuL2FiY19yZWxhdGl2ZV9lbGVtZW50Jyk7XG5cbnZhciBwYXJzZUNvbW1vbiA9IHJlcXVpcmUoJy4uL3BhcnNlL2FiY19jb21tb24nKTtcblxudmFyIGNyZWF0ZUtleVNpZ25hdHVyZTtcblxuKGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblxuXHRjcmVhdGVLZXlTaWduYXR1cmUgPSBmdW5jdGlvbihlbGVtLCB0dW5lTnVtYmVyKSB7XG5cdFx0aWYgKCFlbGVtLmFjY2lkZW50YWxzIHx8IGVsZW0uYWNjaWRlbnRhbHMubGVuZ3RoID09PSAwKVxuXHRcdFx0cmV0dXJuIG51bGw7XG5cdFx0dmFyIGFic2VsZW0gPSBuZXcgQWJzb2x1dGVFbGVtZW50KGVsZW0sIDAsIDEwLCAnc3RhZmYtZXh0cmEnLCB0dW5lTnVtYmVyKTtcblx0XHRhYnNlbGVtLmlzS2V5U2lnID0gdHJ1ZTtcblx0XHR2YXIgZHggPSAwO1xuXHRcdHBhcnNlQ29tbW9uLmVhY2goZWxlbS5hY2NpZGVudGFscywgZnVuY3Rpb24oYWNjKSB7XG5cdFx0XHR2YXIgc3ltYm9sID0gKGFjYy5hY2MgPT09IFwic2hhcnBcIikgPyBcImFjY2lkZW50YWxzLnNoYXJwXCIgOiAoYWNjLmFjYyA9PT0gXCJuYXR1cmFsXCIpID8gXCJhY2NpZGVudGFscy5uYXRcIiA6IFwiYWNjaWRlbnRhbHMuZmxhdFwiO1xuXHRcdFx0Ly92YXIgbm90ZXMgPSB7ICdBJzogNSwgJ0InOiA2LCAnQyc6IDAsICdEJzogMSwgJ0UnOiAyLCAnRic6IDMsICdHJzo0LCAnYSc6IDEyLCAnYic6IDEzLCAnYyc6IDcsICdkJzogOCwgJ2UnOiA5LCAnZic6IDEwLCAnZyc6MTEgfTtcblx0XHRcdGFic2VsZW0uYWRkUmlnaHQobmV3IFJlbGF0aXZlRWxlbWVudChzeW1ib2wsIGR4LCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoc3ltYm9sKSwgYWNjLnZlcnRpY2FsUG9zLCB7dGhpY2tuZXNzOiBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKHN5bWJvbCl9KSk7XG5cdFx0XHRkeCArPSBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoc3ltYm9sKSArIDI7XG5cdFx0fSwgdGhpcyk7XG5cdFx0cmV0dXJuIGFic2VsZW07XG5cdH07XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGNyZWF0ZUtleVNpZ25hdHVyZTtcbiIsIi8vICAgIGFiY19jcmVhdGVfdGltZV9zaWduYXR1cmUuanNcbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIEFic29sdXRlRWxlbWVudCA9IHJlcXVpcmUoJy4vYWJjX2Fic29sdXRlX2VsZW1lbnQnKTtcbnZhciBnbHlwaHMgPSByZXF1aXJlKCcuL2FiY19nbHlwaHMnKTtcbnZhciBSZWxhdGl2ZUVsZW1lbnQgPSByZXF1aXJlKCcuL2FiY19yZWxhdGl2ZV9lbGVtZW50Jyk7XG5cbnZhciBjcmVhdGVUaW1lU2lnbmF0dXJlO1xuXG4oZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdGNyZWF0ZVRpbWVTaWduYXR1cmUgPSBmdW5jdGlvbihlbGVtLCB0dW5lTnVtYmVyKSB7XG5cdFx0dmFyIGFic2VsZW0gPSBuZXcgQWJzb2x1dGVFbGVtZW50KGVsZW0sMCwxMCwgJ3N0YWZmLWV4dHJhJywgdHVuZU51bWJlcik7XG5cdFx0aWYgKGVsZW0udHlwZSA9PT0gXCJzcGVjaWZpZWRcIikge1xuXHRcdFx0dmFyIHggPSAwO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBlbGVtLnZhbHVlLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdGlmIChpICE9PSAwKSB7XG5cdFx0XHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KCcrJywgeCsxLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoXCIrXCIpLCA2LCB7dGhpY2tuZXNzOiBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKFwiK1wiKX0pKTtcblx0XHRcdFx0XHR4ICs9IGdseXBocy5nZXRTeW1ib2xXaWR0aChcIitcIikrMjtcblx0XHRcdFx0fVxuXHRcdFx0XHRpZiAoZWxlbS52YWx1ZVtpXS5kZW4pIHtcblx0XHRcdFx0XHR2YXIgbnVtV2lkdGggPSAwO1xuXHRcdFx0XHRcdGZvciAodmFyIGkyID0gMDsgaTIgPCBlbGVtLnZhbHVlW2ldLm51bS5sZW5ndGg7IGkyKyspXG5cdFx0XHRcdFx0XHRudW1XaWR0aCArPSBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoZWxlbS52YWx1ZVtpXS5udW0uY2hhckF0KGkyKSk7XG5cdFx0XHRcdFx0dmFyIGRlbldpZHRoID0gMDtcblx0XHRcdFx0XHRmb3IgKGkyID0gMDsgaTIgPCBlbGVtLnZhbHVlW2ldLm51bS5sZW5ndGg7IGkyKyspXG5cdFx0XHRcdFx0XHRkZW5XaWR0aCArPSBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoZWxlbS52YWx1ZVtpXS5kZW4uY2hhckF0KGkyKSk7XG5cdFx0XHRcdFx0dmFyIG1heFdpZHRoID0gTWF0aC5tYXgobnVtV2lkdGgsIGRlbldpZHRoKTtcblx0XHRcdFx0XHRhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoZWxlbS52YWx1ZVtpXS5udW0sIHgrKG1heFdpZHRoLW51bVdpZHRoKS8yLCBudW1XaWR0aCwgOCwgeyB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoZWxlbS52YWx1ZVtpXS5udW0uY2hhckF0KDApKSB9KSk7XG5cdFx0XHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KGVsZW0udmFsdWVbaV0uZGVuLCB4KyhtYXhXaWR0aC1kZW5XaWR0aCkvMiwgZGVuV2lkdGgsIDQsIHsgdGhpY2tuZXNzOiBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKGVsZW0udmFsdWVbaV0uZGVuLmNoYXJBdCgwKSkgfSkpO1xuXHRcdFx0XHRcdHggKz0gbWF4V2lkdGhcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR2YXIgdGhpc1dpZHRoID0gMDtcblx0XHRcdFx0XHRmb3IgKHZhciBpMyA9IDA7IGkzIDwgZWxlbS52YWx1ZVtpXS5udW0ubGVuZ3RoOyBpMysrKVxuXHRcdFx0XHRcdFx0dGhpc1dpZHRoICs9IGdseXBocy5nZXRTeW1ib2xXaWR0aChlbGVtLnZhbHVlW2ldLm51bS5jaGFyQXQoaTMpKTtcblx0XHRcdFx0XHRhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoZWxlbS52YWx1ZVtpXS5udW0sIHgsIHRoaXNXaWR0aCwgNiwgeyB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoZWxlbS52YWx1ZVtpXS5udW0uY2hhckF0KDApKSB9KSk7XG5cdFx0XHRcdFx0eCArPSB0aGlzV2lkdGg7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9IGVsc2UgaWYgKGVsZW0udHlwZSA9PT0gXCJjb21tb25fdGltZVwiKSB7XG5cdFx0XHRhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJ0aW1lc2lnLmNvbW1vblwiLCAwLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoXCJ0aW1lc2lnLmNvbW1vblwiKSwgNiwgeyB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoXCJ0aW1lc2lnLmNvbW1vblwiKSB9KSk7XG5cblx0XHR9IGVsc2UgaWYgKGVsZW0udHlwZSA9PT0gXCJjdXRfdGltZVwiKSB7XG5cdFx0XHRhYnNlbGVtLmFkZFJpZ2h0KG5ldyBSZWxhdGl2ZUVsZW1lbnQoXCJ0aW1lc2lnLmN1dFwiLCAwLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoXCJ0aW1lc2lnLmN1dFwiKSwgNiwgeyB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoXCJ0aW1lc2lnLmN1dFwiKSB9KSk7XG5cdFx0fSBlbHNlIGlmIChlbGVtLnR5cGUgPT09IFwidGVtcHVzX2ltcGVyZmVjdHVtXCIpIHtcblx0XHRcdGFic2VsZW0uYWRkUmlnaHQobmV3IFJlbGF0aXZlRWxlbWVudChcInRpbWVzaWcuaW1wZXJmZWN0dW1cIiwgMCwgZ2x5cGhzLmdldFN5bWJvbFdpZHRoKFwidGltZXNpZy5pbXBlcmZlY3R1bVwiKSwgNiwgeyB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoXCJ0aW1lc2lnLmltcGVyZmVjdHVtXCIpIH0pKTtcblx0XHR9IGVsc2UgaWYgKGVsZW0udHlwZSA9PT0gXCJ0ZW1wdXNfaW1wZXJmZWN0dW1fcHJvbGF0aW9cIikge1xuXHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KFwidGltZXNpZy5pbXBlcmZlY3R1bTJcIiwgMCwgZ2x5cGhzLmdldFN5bWJvbFdpZHRoKFwidGltZXNpZy5pbXBlcmZlY3R1bTJcIiksIDYsIHsgdGhpY2tuZXNzOiBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKFwidGltZXNpZy5pbXBlcmZlY3R1bTJcIikgfSkpO1xuXHRcdH0gZWxzZSBpZiAoZWxlbS50eXBlID09PSBcInRlbXB1c19wZXJmZWN0dW1cIikge1xuXHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KFwidGltZXNpZy5wZXJmZWN0dW1cIiwgMCwgZ2x5cGhzLmdldFN5bWJvbFdpZHRoKFwidGltZXNpZy5wZXJmZWN0dW1cIiksIDYsIHsgdGhpY2tuZXNzOiBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKFwidGltZXNpZy5wZXJmZWN0dW1cIikgfSkpO1xuXHRcdH0gZWxzZSBpZiAoZWxlbS50eXBlID09PSBcInRlbXB1c19wZXJmZWN0dW1fcHJvbGF0aW9cIikge1xuXHRcdFx0YWJzZWxlbS5hZGRSaWdodChuZXcgUmVsYXRpdmVFbGVtZW50KFwidGltZXNpZy5wZXJmZWN0dW0yXCIsIDAsIGdseXBocy5nZXRTeW1ib2xXaWR0aChcInRpbWVzaWcucGVyZmVjdHVtMlwiKSwgNiwgeyB0aGlja25lc3M6IGdseXBocy5zeW1ib2xIZWlnaHRJblBpdGNoZXMoXCJ0aW1lc2lnLnBlcmZlY3R1bTJcIikgfSkpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRjb25zb2xlLmxvZyhcInRpbWUgc2lnbmF0dXJlOlwiLGVsZW0pO1xuXHRcdH1cblx0XHRyZXR1cm4gYWJzZWxlbTtcblx0fTtcbn0pKCk7XG5cbm1vZHVsZS5leHBvcnRzID0gY3JlYXRlVGltZVNpZ25hdHVyZTtcbiIsIi8vICAgIGFiY19jcmVzY2VuZG9fZWxlbWVudC5qczogRGVmaW5pdGlvbiBvZiB0aGUgQ3Jlc2NlbmRvRWxlbSBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHNwcmludGYgPSByZXF1aXJlKCcuL3NwcmludGYnKTtcblxudmFyIENyZXNjZW5kb0VsZW0gPSBmdW5jdGlvbiBDcmVzY2VuZG9FbGVtKGFuY2hvcjEsIGFuY2hvcjIsIGRpciwgcG9zaXRpb25pbmcpIHtcblx0dGhpcy5hbmNob3IxID0gYW5jaG9yMTsgLy8gbXVzdCBoYXZlIGEgLnggYW5kIGEgLnBhcmVudCBwcm9wZXJ0eSBvciBiZSBudWxsIChtZWFucyBzdGFydHMgYXQgdGhlIFwiYmVnaW5uaW5nXCIgb2YgdGhlIGxpbmUgLSBhZnRlciBrZXlzaWcpXG5cdHRoaXMuYW5jaG9yMiA9IGFuY2hvcjI7IC8vIG11c3QgaGF2ZSBhIC54IHByb3BlcnR5IG9yIGJlIG51bGwgKG1lYW5zIGVuZHMgYXQgdGhlIGVuZCBvZiB0aGUgbGluZSlcblx0dGhpcy5kaXIgPSBkaXI7IC8vIGVpdGhlciBcIjxcIiBvciBcIj5cIlxuXHRpZiAocG9zaXRpb25pbmcgPT09ICdhYm92ZScpXG5cdFx0dGhpcy5keW5hbWljSGVpZ2h0QWJvdmUgPSA0O1xuXHRlbHNlXG5cdFx0dGhpcy5keW5hbWljSGVpZ2h0QmVsb3cgPSA0O1xuXHR0aGlzLnBpdGNoID0gdW5kZWZpbmVkOyAvLyBUaGlzIHdpbGwgYmUgc2V0IGxhdGVyXG59O1xuXG5DcmVzY2VuZG9FbGVtLnByb3RvdHlwZS5zZXRVcHBlckFuZExvd2VyRWxlbWVudHMgPSBmdW5jdGlvbihwb3NpdGlvblkpIHtcblx0aWYgKHRoaXMuZHluYW1pY0hlaWdodEFib3ZlKVxuXHRcdHRoaXMucGl0Y2ggPSBwb3NpdGlvblkuZHluYW1pY0hlaWdodEFib3ZlO1xuXHRlbHNlXG5cdFx0dGhpcy5waXRjaCA9IHBvc2l0aW9uWS5keW5hbWljSGVpZ2h0QmVsb3c7XG59O1xuXG5DcmVzY2VuZG9FbGVtLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKHJlbmRlcmVyKSB7XG5cdGlmICh0aGlzLnBpdGNoID09PSB1bmRlZmluZWQpXG5cdFx0d2luZG93LmNvbnNvbGUuZXJyb3IoXCJDcmVzY2VuZG8gRWxlbWVudCB5LWNvb3JkaW5hdGUgbm90IHNldC5cIik7XG5cdHZhciB5ID0gcmVuZGVyZXIuY2FsY1kodGhpcy5waXRjaCkgKyA0OyAvLyBUaGlzIGlzIHRoZSB0b3AgcGl4ZWwgdG8gdXNlIChpdCBpcyBvZmZzZXQgYSBsaXR0bGUgc28gdGhhdCBpdCBsb29rcyBnb29kIHdpdGggdGhlIHZvbHVtZSBtYXJrcy4pXG5cdHZhciBoZWlnaHQgPSA4O1xuXHRpZiAodGhpcy5kaXIgPT09IFwiPFwiKSB7XG5cdFx0dGhpcy5kcmF3TGluZShyZW5kZXJlciwgeStoZWlnaHQvMiwgeSk7XG5cdFx0dGhpcy5kcmF3TGluZShyZW5kZXJlciwgeStoZWlnaHQvMiwgeStoZWlnaHQpO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuZHJhd0xpbmUocmVuZGVyZXIsIHksIHkraGVpZ2h0LzIpO1xuXHRcdHRoaXMuZHJhd0xpbmUocmVuZGVyZXIsIHkraGVpZ2h0LCB5K2hlaWdodC8yKTtcblx0fVxufTtcblxuQ3Jlc2NlbmRvRWxlbS5wcm90b3R5cGUuZHJhd0xpbmUgPSBmdW5jdGlvbiAocmVuZGVyZXIsIHkxLCB5Mikge1xuXHQvLyBUT0RPLVBFUjogVGhpcyBpcyBqdXN0IGEgcXVpY2sgaGFjayB0byBtYWtlIHRoZSBkeW5hbWljIG1hcmtzIG5vdCBjcmFzaCBpZiB0aGV5IGFyZSBtaXNtYXRjaGVkLiBTZWUgdGhlIHNsdXIgdHJlYXRtZW50IGZvciB0aGUgd2F5IHRvIGdldCB0aGUgYmVnaW5uaW5nIGFuZCBlbmQuXG5cdHZhciBsZWZ0ID0gdGhpcy5hbmNob3IxID8gdGhpcy5hbmNob3IxLnggOiAwO1xuXHR2YXIgcmlnaHQgPSB0aGlzLmFuY2hvcjIgPyB0aGlzLmFuY2hvcjIueCA6IDgwMDtcblx0dmFyIHBhdGhTdHJpbmcgPSBzcHJpbnRmKFwiTSAlZiAlZiBMICVmICVmXCIsXG5cdFx0bGVmdCwgeTEsIHJpZ2h0LCB5Mik7XG5cdHJlbmRlcmVyLnByaW50UGF0aCh7cGF0aDpwYXRoU3RyaW5nLCBzdHJva2U6XCIjMDAwMDAwXCIsICdjbGFzcyc6IHJlbmRlcmVyLmFkZENsYXNzZXMoJ2RlY29yYXRpb24nKX0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDcmVzY2VuZG9FbGVtO1xuIiwiLy8gYWJjX2RlY29yYXRpb24uanM6IENyZWF0ZXMgYSBkYXRhIHN0cnVjdHVyZSBzdWl0YWJsZSBmb3IgcHJpbnRpbmcgYSBsaW5lIG9mIGFiY1xuLy8gQ29weXJpZ2h0IChDKSAyMDEwLTIwMTggR3JlZ29yeSBEeWtlIChncmVnZHlrZSBhdCBnbWFpbCBkb3QgY29tKSAmIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuLypnbG9iYWwgd2luZG93ICovXG5cbnZhciBEeW5hbWljRGVjb3JhdGlvbiA9IHJlcXVpcmUoJy4vYWJjX2R5bmFtaWNfZGVjb3JhdGlvbicpO1xudmFyIENyZXNjZW5kb0VsZW0gPSByZXF1aXJlKCcuL2FiY19jcmVzY2VuZG9fZWxlbWVudCcpO1xudmFyIGdseXBocyA9IHJlcXVpcmUoJy4vYWJjX2dseXBocycpO1xudmFyIFJlbGF0aXZlRWxlbWVudCA9IHJlcXVpcmUoJy4vYWJjX3JlbGF0aXZlX2VsZW1lbnQnKTtcbnZhciBUaWVFbGVtID0gcmVxdWlyZSgnLi9hYmNfdGllX2VsZW1lbnQnKTtcblxudmFyIERlY29yYXRpb247XG5cbihmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cblx0RGVjb3JhdGlvbiA9IGZ1bmN0aW9uIERlY29yYXRpb24oKSB7XG5cdFx0dGhpcy5zdGFydERpbWludWVuZG9YID0gdW5kZWZpbmVkO1xuXHRcdHRoaXMuc3RhcnRDcmVzY2VuZG9YID0gdW5kZWZpbmVkO1xuXHRcdHRoaXMubWluVG9wID0gMTI7XHQvLyBUT0RPLVBFUjogdGhpcyBpcyBhc3N1bWluZyBhIDUtbGluZSBzdGFmZi4gUGFzcyB0aGF0IGluZm8gaW4uXG5cdFx0dGhpcy5taW5Cb3R0b20gPSAwO1xuXHR9O1xuXG5cdHZhciBjbG9zZURlY29yYXRpb24gPSBmdW5jdGlvbih2b2ljZSwgZGVjb3JhdGlvbiwgcGl0Y2gsIHdpZHRoLCBhYnNlbGVtLCByb29tdGFrZW4sIGRpciwgbWluUGl0Y2gpIHtcblx0XHR2YXIgeVBvcztcblx0XHRmb3IgKHZhciBpPTA7aTxkZWNvcmF0aW9uLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAoZGVjb3JhdGlvbltpXT09PVwic3RhY2NhdG9cIiB8fCBkZWNvcmF0aW9uW2ldPT09XCJ0ZW51dG9cIiB8fCBkZWNvcmF0aW9uW2ldID09PSBcImFjY2VudFwiKSB7XG5cdFx0XHRcdHZhciBzeW1ib2wgPSBcInNjcmlwdHMuXCIgKyBkZWNvcmF0aW9uW2ldO1xuXHRcdFx0XHRpZiAoZGVjb3JhdGlvbltpXSA9PT0gXCJhY2NlbnRcIikgc3ltYm9sID0gXCJzY3JpcHRzLnNmb3J6YXRvXCI7XG5cdFx0XHRcdGlmICh5UG9zID09PSB1bmRlZmluZWQpXG5cdFx0XHRcdFx0eVBvcyA9IChkaXI9PT1cImRvd25cIikgPyBwaXRjaCsyOm1pblBpdGNoLTI7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR5UG9zID0gKGRpcj09PVwiZG93blwiKSA/IHlQb3MrMjp5UG9zLTI7XG5cdFx0XHRcdGlmIChkZWNvcmF0aW9uW2ldID09PSBcImFjY2VudFwiKSB7XG5cdFx0XHRcdFx0Ly8gQWx3YXlzIHBsYWNlIHRoZSBhY2NlbnQgdGhyZWUgcGl0Y2hlcyBhd2F5LCBubyBtYXR0ZXIgd2hldGhlciB0aGF0IGlzIGEgbGluZSBvciBzcGFjZS5cblx0XHRcdFx0XHRpZiAoZGlyID09PSBcInVwXCIpIHlQb3MtLTtcblx0XHRcdFx0XHRlbHNlIHlQb3MrKztcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHQvLyBkb24ndCBwbGFjZSBvbiBhIHN0YXZlIGxpbmUuIFRoZSBzdGF2ZSBsaW5lcyBhcmUgMiw0LDYsOCwxMFxuXHRcdFx0XHRcdHN3aXRjaCAoeVBvcykge1xuXHRcdFx0XHRcdFx0Y2FzZSAyOlxuXHRcdFx0XHRcdFx0Y2FzZSA0OlxuXHRcdFx0XHRcdFx0Y2FzZSA2OlxuXHRcdFx0XHRcdFx0Y2FzZSA4OlxuXHRcdFx0XHRcdFx0Y2FzZSAxMDpcblx0XHRcdFx0XHRcdFx0aWYgKGRpciA9PT0gXCJ1cFwiKSB5UG9zLS07XG5cdFx0XHRcdFx0XHRcdGVsc2UgeVBvcysrO1xuXHRcdFx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdFx0aWYgKHBpdGNoPjkpIHlQb3MrKzsgLy8gdGFrZSB1cCBzb21lIHJvb20gb2YgdGhvc2UgdGhhdCBhcmUgYWJvdmVcblx0XHRcdFx0dmFyIGRlbHRhWCA9IHdpZHRoLzI7XG5cdFx0XHRcdGlmIChnbHlwaHMuZ2V0U3ltYm9sQWxpZ24oc3ltYm9sKSE9PVwiY2VudGVyXCIpIHtcblx0XHRcdFx0XHRkZWx0YVggLT0gKGdseXBocy5nZXRTeW1ib2xXaWR0aChzeW1ib2wpLzIpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdGFic2VsZW0uYWRkQ2hpbGQobmV3IFJlbGF0aXZlRWxlbWVudChzeW1ib2wsIGRlbHRhWCwgZ2x5cGhzLmdldFN5bWJvbFdpZHRoKHN5bWJvbCksIHlQb3MpKTtcblx0XHRcdH1cblx0XHRcdGlmIChkZWNvcmF0aW9uW2ldPT09XCJzbGlkZVwiICYmIGFic2VsZW0uaGVhZHNbMF0pIHtcblx0XHRcdFx0dmFyIHlQb3MyID0gYWJzZWxlbS5oZWFkc1swXS5waXRjaDtcblx0XHRcdFx0eVBvczIgLT0gMjsgLy8gVE9ETy1QRVI6IG5vdCBzdXJlIHdoYXQgdGhpcyBmdWRnZSBmYWN0b3IgaXMuXG5cdFx0XHRcdHZhciBibGFuazEgPSBuZXcgUmVsYXRpdmVFbGVtZW50KFwiXCIsIC1yb29tdGFrZW4tMTUsIDAsIHlQb3MyLTEpO1xuXHRcdFx0XHR2YXIgYmxhbmsyID0gbmV3IFJlbGF0aXZlRWxlbWVudChcIlwiLCAtcm9vbXRha2VuLTUsIDAsIHlQb3MyKzEpO1xuXHRcdFx0XHRhYnNlbGVtLmFkZENoaWxkKGJsYW5rMSk7XG5cdFx0XHRcdGFic2VsZW0uYWRkQ2hpbGQoYmxhbmsyKTtcblx0XHRcdFx0dm9pY2UuYWRkT3RoZXIobmV3IFRpZUVsZW0oYmxhbmsxLCBibGFuazIsIGZhbHNlLCBmYWxzZSwgZmFsc2UpKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKHlQb3MgPT09IHVuZGVmaW5lZClcblx0XHRcdHlQb3MgPSBwaXRjaDtcblxuXHRcdHJldHVybiB7IGFib3ZlOiB5UG9zLCBiZWxvdzogYWJzZWxlbS5ib3R0b20gfTtcblx0fTtcblxuXHR2YXIgdm9sdW1lRGVjb3JhdGlvbiA9IGZ1bmN0aW9uKHZvaWNlLCBkZWNvcmF0aW9uLCBhYnNlbGVtLCBwb3NpdGlvbmluZykge1xuXHRcdGZvciAodmFyIGk9MDtpPGRlY29yYXRpb24ubGVuZ3RoOyBpKyspIHtcblx0XHRcdHN3aXRjaChkZWNvcmF0aW9uW2ldKSB7XG5cdFx0XHRcdGNhc2UgXCJwXCI6XG5cdFx0XHRcdGNhc2UgXCJtcFwiOlxuXHRcdFx0XHRjYXNlIFwicHBcIjpcblx0XHRcdFx0Y2FzZSBcInBwcFwiOlxuXHRcdFx0XHRjYXNlIFwicHBwcFwiOlxuXHRcdFx0XHRjYXNlIFwiZlwiOlxuXHRcdFx0XHRjYXNlIFwiZmZcIjpcblx0XHRcdFx0Y2FzZSBcImZmZlwiOlxuXHRcdFx0XHRjYXNlIFwiZmZmZlwiOlxuXHRcdFx0XHRjYXNlIFwic2Z6XCI6XG5cdFx0XHRcdGNhc2UgXCJtZlwiOlxuXHRcdFx0XHRcdHZhciBlbGVtID0gbmV3IER5bmFtaWNEZWNvcmF0aW9uKGFic2VsZW0sIGRlY29yYXRpb25baV0sIHBvc2l0aW9uaW5nKTtcblx0XHRcdFx0XHR2b2ljZS5hZGRPdGhlcihlbGVtKTtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0dmFyIGNvbXBvdW5kRGVjb3JhdGlvbiA9IGZ1bmN0aW9uKGRlY29yYXRpb24sIHBpdGNoLCB3aWR0aCwgYWJzZWxlbSwgZGlyKSB7XG5cdFx0ZnVuY3Rpb24gaGlnaGVzdFBpdGNoKCkge1xuXHRcdFx0aWYgKGFic2VsZW0uaGVhZHMubGVuZ3RoID09PSAwKVxuXHRcdFx0XHRyZXR1cm4gMTA7XHQvLyBUT0RPLVBFUjogSSBkb24ndCBrbm93IGlmIHRoaXMgY2FuIGhhcHBlbiwgYnV0IHdlJ2xsIHJldHVybiB0aGUgdG9wIG9mIHRoZSBzdGFmZiBpZiBzby5cblx0XHRcdHZhciBwaXRjaCA9IGFic2VsZW0uaGVhZHNbMF0ucGl0Y2g7XG5cdFx0XHRmb3IgKHZhciBpID0gMTsgaSA8IGFic2VsZW0uaGVhZHMubGVuZ3RoOyBpKyspXG5cdFx0XHRcdHBpdGNoID0gTWF0aC5tYXgocGl0Y2gsIGFic2VsZW0uaGVhZHNbaV0ucGl0Y2gpO1xuXHRcdFx0cmV0dXJuIHBpdGNoO1xuXHRcdH1cblx0XHRmdW5jdGlvbiBsb3dlc3RQaXRjaCgpIHtcblx0XHRcdGlmIChhYnNlbGVtLmhlYWRzLmxlbmd0aCA9PT0gMClcblx0XHRcdFx0cmV0dXJuIDI7XHQvLyBUT0RPLVBFUjogSSBkb24ndCBrbm93IGlmIHRoaXMgY2FuIGhhcHBlbiwgYnV0IHdlJ2xsIHJldHVybiB0aGUgYm90dG9tIG9mIHRoZSBzdGFmZiBpZiBzby5cblx0XHRcdHZhciBwaXRjaCA9IGFic2VsZW0uaGVhZHNbMF0ucGl0Y2g7XG5cdFx0XHRmb3IgKHZhciBpID0gMTsgaSA8IGFic2VsZW0uaGVhZHMubGVuZ3RoOyBpKyspXG5cdFx0XHRcdHBpdGNoID0gTWF0aC5taW4ocGl0Y2gsIGFic2VsZW0uaGVhZHNbaV0ucGl0Y2gpO1xuXHRcdFx0cmV0dXJuIHBpdGNoO1xuXHRcdH1cblx0XHRmdW5jdGlvbiBjb21wb3VuZERlY29yYXRpb24oc3ltYm9sLCBjb3VudCkge1xuXHRcdFx0dmFyIHBsYWNlbWVudCA9IChkaXIgPT09ICdkb3duJykgPyBsb3dlc3RQaXRjaCgpKzE6aGlnaGVzdFBpdGNoKCkrOTtcblx0XHRcdGlmIChkaXIgIT09ICdkb3duJyAmJiBjb3VudCA9PT0gMSlcblx0XHRcdFx0cGxhY2VtZW50LS07XG5cdFx0XHR2YXIgZGVsdGFYID0gd2lkdGgvMjtcblx0XHRcdGRlbHRhWCArPSAoZGlyID09PSAnZG93bicpID8gLTUgOiAzO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBjb3VudDsgaSsrKSB7XG5cdFx0XHRcdHBsYWNlbWVudCAtPSAxO1xuXHRcdFx0XHRhYnNlbGVtLmFkZENoaWxkKG5ldyBSZWxhdGl2ZUVsZW1lbnQoc3ltYm9sLCBkZWx0YVgsIGdseXBocy5nZXRTeW1ib2xXaWR0aChzeW1ib2wpLCBwbGFjZW1lbnQpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHRmb3IgKHZhciBpPTA7aTxkZWNvcmF0aW9uLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRzd2l0Y2goZGVjb3JhdGlvbltpXSkge1xuXHRcdFx0XHRjYXNlIFwiL1wiOiBjb21wb3VuZERlY29yYXRpb24oXCJmbGFncy51Z3JhY2VcIiwgMSk7IGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiLy9cIjogY29tcG91bmREZWNvcmF0aW9uKFwiZmxhZ3MudWdyYWNlXCIsIDIpOyBicmVhaztcblx0XHRcdFx0Y2FzZSBcIi8vL1wiOiBjb21wb3VuZERlY29yYXRpb24oXCJmbGFncy51Z3JhY2VcIiwgMyk7IGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiLy8vL1wiOiBjb21wb3VuZERlY29yYXRpb24oXCJmbGFncy51Z3JhY2VcIiwgNCk7IGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0fTtcblxuXHR2YXIgc3RhY2tlZERlY29yYXRpb24gPSBmdW5jdGlvbihkZWNvcmF0aW9uLCB3aWR0aCwgYWJzZWxlbSwgeVBvcywgcG9zaXRpb25pbmcsIG1pblRvcCwgbWluQm90dG9tKSB7XG5cdFx0ZnVuY3Rpb24gaW5jcmVtZW50UGxhY2VtZW50KHBsYWNlbWVudCwgaGVpZ2h0KSB7XG5cdFx0XHRpZiAocGxhY2VtZW50ID09PSAnYWJvdmUnKVxuXHRcdFx0XHR5UG9zLmFib3ZlICs9IGhlaWdodDtcblx0XHRcdGVsc2Vcblx0XHRcdFx0eVBvcy5iZWxvdyAtPSBoZWlnaHQ7XG5cdFx0fVxuXHRcdGZ1bmN0aW9uIGdldFBsYWNlbWVudChwbGFjZW1lbnQpIHtcblx0XHRcdHZhciB5O1xuXHRcdFx0aWYgKHBsYWNlbWVudCA9PT0gJ2Fib3ZlJykge1xuXHRcdFx0XHR5ID0geVBvcy5hYm92ZTtcblx0XHRcdFx0aWYgKHkgPCBtaW5Ub3ApXG5cdFx0XHRcdFx0eSA9IG1pblRvcDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdHkgPSB5UG9zLmJlbG93O1xuXHRcdFx0XHRpZiAoeSA+IG1pbkJvdHRvbSlcblx0XHRcdFx0XHR5ID0gbWluQm90dG9tO1xuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIHk7XG5cdFx0fVxuXHRcdGZ1bmN0aW9uIHRleHREZWNvcmF0aW9uKHRleHQsIHBsYWNlbWVudCkge1xuXHRcdFx0dmFyIHkgPSBnZXRQbGFjZW1lbnQocGxhY2VtZW50KTtcblx0XHRcdHZhciB0ZXh0RnVkZ2UgPSAyO1xuXHRcdFx0dmFyIHRleHRIZWlnaHQgPSA1O1xuXHRcdFx0Ly8gVE9ETy1QRVI6IEdldCB0aGUgaGVpZ2h0IG9mIHRoZSBjdXJyZW50IGZvbnQgYW5kIHVzZSB0aGF0IGZvciB0aGUgdGhpY2tuZXNzLlxuXHRcdFx0YWJzZWxlbS5hZGRDaGlsZChuZXcgUmVsYXRpdmVFbGVtZW50KHRleHQsIHdpZHRoLzIsIDAsIHkrdGV4dEZ1ZGdlLCB7dHlwZTpcImRlY29yYXRpb25cIiwga2xhc3M6ICdvcm5hbWVudCcsIHRoaWNrbmVzczogM30pKTtcblxuXHRcdFx0aW5jcmVtZW50UGxhY2VtZW50KHBsYWNlbWVudCwgdGV4dEhlaWdodCk7XG5cdFx0fVxuXHRcdGZ1bmN0aW9uIHN5bWJvbERlY29yYXRpb24oc3ltYm9sLCBwbGFjZW1lbnQpIHtcblx0XHRcdHZhciBkZWx0YVggPSB3aWR0aC8yO1xuXHRcdFx0aWYgKGdseXBocy5nZXRTeW1ib2xBbGlnbihzeW1ib2wpICE9PSBcImNlbnRlclwiKSB7XG5cdFx0XHRcdGRlbHRhWCAtPSAoZ2x5cGhzLmdldFN5bWJvbFdpZHRoKHN5bWJvbCkgLyAyKTtcblx0XHRcdH1cblx0XHRcdHZhciBoZWlnaHQgPSBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKHN5bWJvbCkgKyAxOyAvLyBhZGRpbmcgYSBsaXR0bGUgcGFkZGluZyBzbyBub3RoaW5nIHRvdWNoZXMuXG5cdFx0XHR2YXIgeSA9IGdldFBsYWNlbWVudChwbGFjZW1lbnQpO1xuXHRcdFx0eSA9IChwbGFjZW1lbnQgPT09ICdhYm92ZScpID8geSArIGhlaWdodC8yIDogeSAtIGhlaWdodC8yOy8vIENlbnRlciB0aGUgZWxlbWVudCB2ZXJ0aWNhbGx5LlxuXHRcdFx0YWJzZWxlbS5hZGRDaGlsZChuZXcgUmVsYXRpdmVFbGVtZW50KHN5bWJvbCwgZGVsdGFYLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgoc3ltYm9sKSwgeSwgeyBrbGFzczogJ29ybmFtZW50JywgdGhpY2tuZXNzOiBnbHlwaHMuc3ltYm9sSGVpZ2h0SW5QaXRjaGVzKHN5bWJvbCkgfSkpO1xuXG5cdFx0XHRpbmNyZW1lbnRQbGFjZW1lbnQocGxhY2VtZW50LCBoZWlnaHQpO1xuXHRcdH1cblxuXHRcdHZhciBzeW1ib2xMaXN0ID0ge1xuXHRcdFx0XCIrXCI6IFwic2NyaXB0cy5zdG9wcGVkXCIsXG5cdFx0XHRcIm9wZW5cIjogXCJzY3JpcHRzLm9wZW5cIixcblx0XHRcdFwic25hcFwiOiBcInNjcmlwdHMuc25hcFwiLFxuXHRcdFx0XCJ3ZWRnZVwiOiBcInNjcmlwdHMud2VkZ2VcIixcblx0XHRcdFwidGh1bWJcIjogXCJzY3JpcHRzLnRodW1iXCIsXG5cdFx0XHRcInNob3J0cGhyYXNlXCI6IFwic2NyaXB0cy5zaG9ydHBocmFzZVwiLFxuXHRcdFx0XCJtZWRpdW1waHJhc2VcIjogXCJzY3JpcHRzLm1lZGl1bXBocmFzZVwiLFxuXHRcdFx0XCJsb25ncGhyYXNlXCI6IFwic2NyaXB0cy5sb25ncGhyYXNlXCIsXG5cdFx0XHRcInRyaWxsXCI6IFwic2NyaXB0cy50cmlsbFwiLFxuXHRcdFx0XCJyb2xsXCI6IFwic2NyaXB0cy5yb2xsXCIsXG5cdFx0XHRcImlyaXNocm9sbFwiOiBcInNjcmlwdHMucm9sbFwiLFxuXHRcdFx0XCJtYXJjYXRvXCI6IFwic2NyaXB0cy51bWFyY2F0b1wiLFxuXHRcdFx0XCJkbWFyY2F0b1wiOiBcInNjcmlwdHMuZG1hcmNhdG9cIixcblx0XHRcdFwidW1hcmNhdG9cIjogXCJzY3JpcHRzLnVtYXJjYXRvXCIsXG5cdFx0XHRcInR1cm5cIjogXCJzY3JpcHRzLnR1cm5cIixcblx0XHRcdFwidXBwZXJtb3JkZW50XCI6IFwic2NyaXB0cy5wcmFsbFwiLFxuXHRcdFx0XCJwcmFsbHRyaWxsZXJcIjogXCJzY3JpcHRzLnByYWxsXCIsXG5cdFx0XHRcIm1vcmRlbnRcIjogXCJzY3JpcHRzLm1vcmRlbnRcIixcblx0XHRcdFwibG93ZXJtb3JkZW50XCI6IFwic2NyaXB0cy5tb3JkZW50XCIsXG5cdFx0XHRcImRvd25ib3dcIjogXCJzY3JpcHRzLmRvd25ib3dcIixcblx0XHRcdFwidXBib3dcIjogXCJzY3JpcHRzLnVwYm93XCIsXG5cdFx0XHRcImZlcm1hdGFcIjogXCJzY3JpcHRzLnVmZXJtYXRhXCIsXG5cdFx0XHRcImludmVydGVkZmVybWF0YVwiOiBcInNjcmlwdHMuZGZlcm1hdGFcIixcblx0XHRcdFwiYnJlYXRoXCI6IFwiLFwiLFxuXHRcdFx0XCJjb2RhXCI6IFwic2NyaXB0cy5jb2RhXCIsXG5cdFx0XHRcInNlZ25vXCI6IFwic2NyaXB0cy5zZWdub1wiXG5cdFx0fTtcblxuXHRcdHZhciBoYXNPbmUgPSBmYWxzZTtcblx0XHRmb3IgKHZhciBpPTA7aTxkZWNvcmF0aW9uLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRzd2l0Y2goZGVjb3JhdGlvbltpXSkge1xuXHRcdFx0XHRjYXNlIFwiMFwiOlxuXHRcdFx0XHRjYXNlIFwiMVwiOlxuXHRcdFx0XHRjYXNlIFwiMlwiOlxuXHRcdFx0XHRjYXNlIFwiM1wiOlxuXHRcdFx0XHRjYXNlIFwiNFwiOlxuXHRcdFx0XHRjYXNlIFwiNVwiOlxuXHRcdFx0XHRjYXNlIFwiRC5DLlwiOlxuXHRcdFx0XHRjYXNlIFwiRC5TLlwiOlxuXHRcdFx0XHRcdHRleHREZWNvcmF0aW9uKGRlY29yYXRpb25baV0sIHBvc2l0aW9uaW5nKTtcblx0XHRcdFx0XHRoYXNPbmUgPSB0cnVlO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiZmluZVwiOlxuXHRcdFx0XHRcdHRleHREZWNvcmF0aW9uKFwiRklORVwiLCBwb3NpdGlvbmluZyk7XG5cdFx0XHRcdFx0aGFzT25lID0gdHJ1ZTtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcIitcIjpcblx0XHRcdFx0Y2FzZSBcIm9wZW5cIjpcblx0XHRcdFx0Y2FzZSBcInNuYXBcIjpcblx0XHRcdFx0Y2FzZSBcIndlZGdlXCI6XG5cdFx0XHRcdGNhc2UgXCJ0aHVtYlwiOlxuXHRcdFx0XHRjYXNlIFwic2hvcnRwaHJhc2VcIjpcblx0XHRcdFx0Y2FzZSBcIm1lZGl1bXBocmFzZVwiOlxuXHRcdFx0XHRjYXNlIFwibG9uZ3BocmFzZVwiOlxuXHRcdFx0XHRjYXNlIFwidHJpbGxcIjpcblx0XHRcdFx0Y2FzZSBcInJvbGxcIjpcblx0XHRcdFx0Y2FzZSBcImlyaXNocm9sbFwiOlxuXHRcdFx0XHRjYXNlIFwibWFyY2F0b1wiOlxuXHRcdFx0XHRjYXNlIFwiZG1hcmNhdG9cIjpcblx0XHRcdFx0Y2FzZSBcInR1cm5cIjpcblx0XHRcdFx0Y2FzZSBcInVwcGVybW9yZGVudFwiOlxuXHRcdFx0XHRjYXNlIFwicHJhbGx0cmlsbGVyXCI6XG5cdFx0XHRcdGNhc2UgXCJtb3JkZW50XCI6XG5cdFx0XHRcdGNhc2UgXCJsb3dlcm1vcmRlbnRcIjpcblx0XHRcdFx0Y2FzZSBcImRvd25ib3dcIjpcblx0XHRcdFx0Y2FzZSBcInVwYm93XCI6XG5cdFx0XHRcdGNhc2UgXCJmZXJtYXRhXCI6XG5cdFx0XHRcdGNhc2UgXCJicmVhdGhcIjpcblx0XHRcdFx0Y2FzZSBcInVtYXJjYXRvXCI6XG5cdFx0XHRcdGNhc2UgXCJjb2RhXCI6XG5cdFx0XHRcdGNhc2UgXCJzZWdub1wiOlxuXHRcdFx0XHRcdHN5bWJvbERlY29yYXRpb24oc3ltYm9sTGlzdFtkZWNvcmF0aW9uW2ldXSwgcG9zaXRpb25pbmcpO1xuXHRcdFx0XHRcdGhhc09uZSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJpbnZlcnRlZGZlcm1hdGFcIjpcblx0XHRcdFx0XHRzeW1ib2xEZWNvcmF0aW9uKHN5bWJvbExpc3RbZGVjb3JhdGlvbltpXV0sICdiZWxvdycpO1xuXHRcdFx0XHRcdGhhc09uZSA9IHRydWU7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJtYXJrXCI6XG5cdFx0XHRcdFx0YWJzZWxlbS5rbGFzcyA9IFwibWFya1wiO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRyZXR1cm4gaGFzT25lO1xuXHR9O1xuXG5cdERlY29yYXRpb24ucHJvdG90eXBlLmR5bmFtaWNEZWNvcmF0aW9uID0gZnVuY3Rpb24odm9pY2UsIGRlY29yYXRpb24sIGFic2VsZW0sIHBvc2l0aW9uaW5nKSB7XG5cdFx0dmFyIGRpbWludWVuZG87XG5cdFx0dmFyIGNyZXNjZW5kbztcblx0XHRmb3IgKHZhciBpPTA7aTxkZWNvcmF0aW9uLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRzd2l0Y2goZGVjb3JhdGlvbltpXSkge1xuXHRcdFx0XHRjYXNlIFwiZGltaW51ZW5kbyhcIjpcblx0XHRcdFx0XHR0aGlzLnN0YXJ0RGltaW51ZW5kb1ggPSBhYnNlbGVtO1xuXHRcdFx0XHRcdGRpbWludWVuZG8gPSB1bmRlZmluZWQ7XG5cdFx0XHRcdFx0YnJlYWs7XG5cdFx0XHRcdGNhc2UgXCJkaW1pbnVlbmRvKVwiOlxuXHRcdFx0XHRcdGRpbWludWVuZG8gPSB7IHN0YXJ0OiB0aGlzLnN0YXJ0RGltaW51ZW5kb1gsIHN0b3A6IGFic2VsZW19O1xuXHRcdFx0XHRcdHRoaXMuc3RhcnREaW1pbnVlbmRvWCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdFx0Y2FzZSBcImNyZXNjZW5kbyhcIjpcblx0XHRcdFx0XHR0aGlzLnN0YXJ0Q3Jlc2NlbmRvWCA9IGFic2VsZW07XG5cdFx0XHRcdFx0Y3Jlc2NlbmRvID0gdW5kZWZpbmVkO1xuXHRcdFx0XHRcdGJyZWFrO1xuXHRcdFx0XHRjYXNlIFwiY3Jlc2NlbmRvKVwiOlxuXHRcdFx0XHRcdGNyZXNjZW5kbyA9IHsgc3RhcnQ6IHRoaXMuc3RhcnRDcmVzY2VuZG9YLCBzdG9wOiBhYnNlbGVtfTtcblx0XHRcdFx0XHR0aGlzLnN0YXJ0Q3Jlc2NlbmRvWCA9IHVuZGVmaW5lZDtcblx0XHRcdFx0XHRicmVhaztcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYgKGRpbWludWVuZG8pIHtcblx0XHRcdHZvaWNlLmFkZE90aGVyKG5ldyBDcmVzY2VuZG9FbGVtKGRpbWludWVuZG8uc3RhcnQsIGRpbWludWVuZG8uc3RvcCwgXCI+XCIsIHBvc2l0aW9uaW5nKSk7XG5cdFx0fVxuXHRcdGlmIChjcmVzY2VuZG8pIHtcblx0XHRcdHZvaWNlLmFkZE90aGVyKG5ldyBDcmVzY2VuZG9FbGVtKGNyZXNjZW5kby5zdGFydCwgY3Jlc2NlbmRvLnN0b3AsIFwiPFwiLCBwb3NpdGlvbmluZykpO1xuXHRcdH1cblx0fTtcblxuXHREZWNvcmF0aW9uLnByb3RvdHlwZS5jcmVhdGVEZWNvcmF0aW9uID0gZnVuY3Rpb24odm9pY2UsIGRlY29yYXRpb24sIHBpdGNoLCB3aWR0aCwgYWJzZWxlbSwgcm9vbXRha2VuLCBkaXIsIG1pblBpdGNoLCBwb3NpdGlvbmluZywgaGFzVm9jYWxzKSB7XG5cdFx0aWYgKCFwb3NpdGlvbmluZylcblx0XHRcdHBvc2l0aW9uaW5nID0geyBvcm5hbWVudFBvc2l0aW9uOiAnYWJvdmUnLCB2b2x1bWVQb3NpdGlvbjogaGFzVm9jYWxzID8gJ2Fib3ZlJyA6J2JlbG93JywgZHluYW1pY1Bvc2l0aW9uOiBoYXNWb2NhbHMgPyAnYWJvdmUnIDogJ2JlbG93JyB9O1xuXHRcdC8vIFRoZXNlIGRlY29yYXRpb25zIGRvbid0IGFmZmVjdCB0aGUgcGxhY2VtZW50IG9mIG90aGVyIGRlY29yYXRpb25zXG5cdFx0dm9sdW1lRGVjb3JhdGlvbih2b2ljZSwgZGVjb3JhdGlvbiwgYWJzZWxlbSwgcG9zaXRpb25pbmcudm9sdW1lUG9zaXRpb24pO1xuXHRcdHRoaXMuZHluYW1pY0RlY29yYXRpb24odm9pY2UsIGRlY29yYXRpb24sIGFic2VsZW0sIHBvc2l0aW9uaW5nLmR5bmFtaWNQb3NpdGlvbik7XG5cdFx0Y29tcG91bmREZWNvcmF0aW9uKGRlY29yYXRpb24sIHBpdGNoLCB3aWR0aCwgYWJzZWxlbSwgZGlyKTtcblxuXHRcdC8vIHRyZWF0IHN0YWNjYXRvLCBhY2NlbnQsIGFuZCB0ZW51dG8gZmlyc3QgKG1heSBuZWVkIHRvIHNoaWZ0IG90aGVyIG1hcmtlcnMpXG5cdFx0dmFyIHlQb3MgPSBjbG9zZURlY29yYXRpb24odm9pY2UsIGRlY29yYXRpb24sIHBpdGNoLCB3aWR0aCwgYWJzZWxlbSwgcm9vbXRha2VuLCBkaXIsIG1pblBpdGNoKTtcblx0XHQvLyB5UG9zIGlzIGFuIG9iamVjdCBjb250YWluaW5nICdhYm92ZScgYW5kICdiZWxvdycuIFRoYXQgaXMgdGhlIHBsYWNlbWVudCBvZiB0aGUgbmV4dCBzeW1ib2wgb24gZWl0aGVyIHNpZGUuXG5cblx0XHR5UG9zLmFib3ZlID0gTWF0aC5tYXgoeVBvcy5hYm92ZSwgdGhpcy5taW5Ub3ApO1xuXHRcdHZhciBoYXNPbmUgPSBzdGFja2VkRGVjb3JhdGlvbihkZWNvcmF0aW9uLCB3aWR0aCwgYWJzZWxlbSwgeVBvcywgcG9zaXRpb25pbmcub3JuYW1lbnRQb3NpdGlvbiwgdGhpcy5taW5Ub3AsIHRoaXMubWluQm90dG9tKTtcblx0XHRpZiAoaGFzT25lKSB7XG4vL1x0XHRcdGFic2VsZW0udG9wID0gTWF0aC5tYXgoeVBvcy5hYm92ZSArIDMsIGFic2VsZW0udG9wKTsgLy8gVE9ETy1QRVI6IE5vdCBzdXJlIHdoeSB3ZSBuZWVkIHRoaXMgZnVkZ2UgZmFjdG9yLlxuXHRcdH1cblx0fTtcblxufSkoKTtcblxubW9kdWxlLmV4cG9ydHMgPSBEZWNvcmF0aW9uO1xuIiwiLy8gICAgYWJjX2R5bmFtaWNfZGVjb3JhdGlvbi5qczogRGVmaW5pdGlvbiBvZiB0aGUgRHluYW1pY0RlY29yYXRpb24gY2xhc3MuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBHcmVnb3J5IER5a2UgKGdyZWdkeWtlIGF0IGdtYWlsIGRvdCBjb20pIGFuZCBQYXVsIFJvc2VuXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbnZhciBzcGFjaW5nID0gcmVxdWlyZSgnLi9hYmNfc3BhY2luZycpO1xuXG52YXIgRHluYW1pY0RlY29yYXRpb24gPSBmdW5jdGlvbiBEeW5hbWljRGVjb3JhdGlvbihhbmNob3IsIGRlYywgcG9zaXRpb24pIHtcblx0dGhpcy5hbmNob3IgPSBhbmNob3I7XG5cdHRoaXMuZGVjID0gZGVjO1xuXHRpZiAocG9zaXRpb24gPT09ICdiZWxvdycpXG5cdFx0dGhpcy52b2x1bWVIZWlnaHRCZWxvdyA9IDU7XG5cdGVsc2Vcblx0XHR0aGlzLnZvbHVtZUhlaWdodEFib3ZlID0gNTtcblx0dGhpcy5waXRjaCA9IHVuZGVmaW5lZDsgLy8gVGhpcyB3aWxsIGJlIHNldCBsYXRlclxufTtcblxuRHluYW1pY0RlY29yYXRpb24ucHJvdG90eXBlLnNldFVwcGVyQW5kTG93ZXJFbGVtZW50cyA9IGZ1bmN0aW9uKHBvc2l0aW9uWSkge1xuXHRpZiAodGhpcy52b2x1bWVIZWlnaHRBYm92ZSlcblx0XHR0aGlzLnBpdGNoID0gcG9zaXRpb25ZLnZvbHVtZUhlaWdodEFib3ZlO1xuXHRlbHNlXG5cdFx0dGhpcy5waXRjaCA9IHBvc2l0aW9uWS52b2x1bWVIZWlnaHRCZWxvdztcbn07XG5cbkR5bmFtaWNEZWNvcmF0aW9uLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24ocmVuZGVyZXIsIGxpbmVzdGFydHgsIGxpbmVlbmR4KSB7XG5cdGlmICh0aGlzLnBpdGNoID09PSB1bmRlZmluZWQpXG5cdFx0d2luZG93LmNvbnNvbGUuZXJyb3IoXCJEeW5hbWljIEVsZW1lbnQgeS1jb29yZGluYXRlIG5vdCBzZXQuXCIpO1xuXHR2YXIgc2NhbGV4ID0gMTtcblx0dmFyIHNjYWxleSA9IDE7XG5cdHJlbmRlcmVyLnByaW50U3ltYm9sKHRoaXMuYW5jaG9yLngsIHRoaXMucGl0Y2gsIHRoaXMuZGVjLCBzY2FsZXgsIHNjYWxleSwgcmVuZGVyZXIuYWRkQ2xhc3NlcygnZGVjb3JhdGlvbicpKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRHluYW1pY0RlY29yYXRpb247XG4iLCIvLyAgICBhYmNfZW5kaW5nX2VsZW1lbnQuanM6IERlZmluaXRpb24gb2YgdGhlIEVuZGluZ0VsZW1lbnQgY2xhc3MuXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTAtMjAxOCBHcmVnb3J5IER5a2UgKGdyZWdkeWtlIGF0IGdtYWlsIGRvdCBjb20pIGFuZCBQYXVsIFJvc2VuXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cbnZhciBzcHJpbnRmID0gcmVxdWlyZSgnLi9zcHJpbnRmJyk7XG5cbnZhciBFbmRpbmdFbGVtID0gZnVuY3Rpb24gRW5kaW5nRWxlbSh0ZXh0LCBhbmNob3IxLCBhbmNob3IyKSB7XG5cdHRoaXMudGV4dCA9IHRleHQ7IC8vIHRleHQgdG8gYmUgZGlzcGxheWVkIHRvcCBsZWZ0XG5cdHRoaXMuYW5jaG9yMSA9IGFuY2hvcjE7IC8vIG11c3QgaGF2ZSBhIC54IHByb3BlcnR5IG9yIGJlIG51bGwgKG1lYW5zIHN0YXJ0cyBhdCB0aGUgXCJiZWdpbm5pbmdcIiBvZiB0aGUgbGluZSAtIGFmdGVyIGtleXNpZylcblx0dGhpcy5hbmNob3IyID0gYW5jaG9yMjsgLy8gbXVzdCBoYXZlIGEgLnggcHJvcGVydHkgb3IgYmUgbnVsbCAobWVhbnMgZW5kcyBhdCB0aGUgZW5kIG9mIHRoZSBsaW5lKVxuXHR0aGlzLmVuZGluZ0hlaWdodEFib3ZlID0gNTtcblx0dGhpcy5waXRjaCA9IHVuZGVmaW5lZDsgLy8gVGhpcyB3aWxsIGJlIHNldCBsYXRlclxufTtcblxuRW5kaW5nRWxlbS5wcm90b3R5cGUuc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzID0gZnVuY3Rpb24ocG9zaXRpb25ZKSB7XG5cdHRoaXMucGl0Y2ggPSBwb3NpdGlvblkuZW5kaW5nSGVpZ2h0QWJvdmUgLSAyO1xufTtcblxuRW5kaW5nRWxlbS5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uIChyZW5kZXJlciwgbGluZXN0YXJ0eCwgbGluZWVuZHgpIHtcblx0aWYgKHRoaXMucGl0Y2ggPT09IHVuZGVmaW5lZClcblx0XHR3aW5kb3cuY29uc29sZS5lcnJvcihcIkVuZGluZyBFbGVtZW50IHktY29vcmRpbmF0ZSBub3Qgc2V0LlwiKTtcblx0dmFyIHkgPSByZW5kZXJlci5jYWxjWSh0aGlzLnBpdGNoKTtcblx0dmFyIGhlaWdodCA9IDIwO1xuXHR2YXIgcGF0aFN0cmluZztcblx0aWYgKHRoaXMuYW5jaG9yMSkge1xuXHRcdGxpbmVzdGFydHggPSB0aGlzLmFuY2hvcjEueCt0aGlzLmFuY2hvcjEudztcblx0XHRwYXRoU3RyaW5nID0gc3ByaW50ZihcIk0gJWYgJWYgTCAlZiAlZlwiLFxuXHRcdFx0bGluZXN0YXJ0eCwgeSwgbGluZXN0YXJ0eCwgeStoZWlnaHQpO1xuXHRcdHJlbmRlcmVyLnByaW50UGF0aCh7cGF0aDpwYXRoU3RyaW5nLCBzdHJva2U6XCIjMDAwMDAwXCIsIGZpbGw6XCIjMDAwMDAwXCIsICdjbGFzcyc6IHJlbmRlcmVyLmFkZENsYXNzZXMoJ2VuZGluZycpfSk7XG5cdFx0cmVuZGVyZXIucmVuZGVyVGV4dChsaW5lc3RhcnR4KzUsIHJlbmRlcmVyLmNhbGNZKHRoaXMucGl0Y2gtMC41KSwgdGhpcy50ZXh0LCAncmVwZWF0Zm9udCcsICdlbmRpbmcnLFwic3RhcnRcIik7XG5cdH1cblxuXHRpZiAodGhpcy5hbmNob3IyKSB7XG5cdFx0bGluZWVuZHggPSB0aGlzLmFuY2hvcjIueDtcblx0XHRwYXRoU3RyaW5nID0gc3ByaW50ZihcIk0gJWYgJWYgTCAlZiAlZlwiLFxuXHRcdFx0bGluZWVuZHgsIHksIGxpbmVlbmR4LCB5K2hlaWdodCk7XG5cdFx0cmVuZGVyZXIucHJpbnRQYXRoKHtwYXRoOnBhdGhTdHJpbmcsIHN0cm9rZTpcIiMwMDAwMDBcIiwgZmlsbDpcIiMwMDAwMDBcIiwgJ2NsYXNzJzogcmVuZGVyZXIuYWRkQ2xhc3NlcygnZW5kaW5nJyl9KTtcblx0fVxuXG5cblx0cGF0aFN0cmluZyA9IHNwcmludGYoXCJNICVmICVmIEwgJWYgJWZcIixcblx0XHRsaW5lc3RhcnR4LCB5LCBsaW5lZW5keCwgeSk7XG5cdHJlbmRlcmVyLnByaW50UGF0aCh7cGF0aDpwYXRoU3RyaW5nLCBzdHJva2U6XCIjMDAwMDAwXCIsIGZpbGw6XCIjMDAwMDAwXCIsICdjbGFzcyc6IHJlbmRlcmVyLmFkZENsYXNzZXMoJ2VuZGluZycpfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVuZGluZ0VsZW07XG4iLCIvLyAgICBhYmNfZW5ncmF2ZXJfY29udHJvbGxlci5qczogQ29udHJvbHMgdGhlIGVuZ3JhdmluZyBwcm9jZXNzIG9mIGFuIEFCQ0pTIGFic3RyYWN0IHN5bnRheCB0cmVlIGFzIHByb2R1Y2VkIGJ5IEFCQ0pTL3BhcnNlXG4vLyAgICBDb3B5cmlnaHQgKEMpIDIwMTQtMjAxOCBHcmVnb3J5IER5a2UgKGdyZWdkeWtlIGF0IGdtYWlsIGRvdCBjb20pXG4vL1xuLy8gICAgUGVybWlzc2lvbiBpcyBoZXJlYnkgZ3JhbnRlZCwgZnJlZSBvZiBjaGFyZ2UsIHRvIGFueSBwZXJzb24gb2J0YWluaW5nIGEgY29weSBvZiB0aGlzIHNvZnR3YXJlIGFuZCBhc3NvY2lhdGVkXG4vLyAgICBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUgXCJTb2Z0d2FyZVwiKSwgdG8gZGVhbCBpbiB0aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVkaW5nIHdpdGhvdXQgbGltaXRhdGlvblxuLy8gICAgdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZFxuLy8gICAgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczpcbi8vXG4vLyAgICBUaGUgYWJvdmUgY29weXJpZ2h0IG5vdGljZSBhbmQgdGhpcyBwZXJtaXNzaW9uIG5vdGljZSBzaGFsbCBiZSBpbmNsdWRlZCBpbiBhbGwgY29waWVzIG9yIHN1YnN0YW50aWFsIHBvcnRpb25zIG9mIHRoZSBTb2Z0d2FyZS5cbi8vXG4vLyAgICBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgXCJBUyBJU1wiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SIElNUExJRUQsIElOQ0xVRElOR1xuLy8gICAgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EXG4vLyAgICBOT05JTkZSSU5HRU1FTlQuIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZIENMQUlNLFxuLy8gICAgREFNQUdFUyBPUiBPVEhFUiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLFxuLy8gICAgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuXG5cblxuLypnbG9iYWwgTWF0aCAqL1xuXG52YXIgc3BhY2luZyA9IHJlcXVpcmUoJy4vYWJjX3NwYWNpbmcnKTtcbnZhciBBYnN0cmFjdEVuZ3JhdmVyID0gcmVxdWlyZSgnLi9hYmNfYWJzdHJhY3RfZW5ncmF2ZXInKTtcbnZhciBSZW5kZXJlciA9IHJlcXVpcmUoJy4vYWJjX3JlbmRlcmVyJyk7XG5cbi8qKlxuICogQGNsYXNzXG4gKiBDb250cm9scyB0aGUgZW5ncmF2aW5nIHByb2Nlc3MsIGZyb20gQUJDSlMgQWJzdHJhY3QgU3ludGF4IFRyZWUgKEFCQ0pTIEFTVCkgdG8gcmVuZGVyZWQgc2NvcmUgc2hlZXRcbiAqXG4gKiBDYWxsIGVuZ3JhdmVBQkMgdG8gcnVuIHRoZSBwcm9jZXNzLiBUaGlzIGNyZWF0ZXMgYSBncmFwaGVsZW1zIEFCQ0pTIEFic3RyYWN0IEVuZ3JhdmluZyBTdHJ1Y3R1cmUgKEFCQ0pTIEFFUykgdGhhdCBjYW4gYmUgYWNjZXNzZWQgdGhyb3VnaCB0aGlzLnN0YWZmZ3JvdXBzXG4gKiB0aGlzIGRhdGEgc3RydWN0dXJlIGlzIGZpcnN0IGxhaWQgb3V0IChnaXZpbmcgdGhlIGdyYXBoZWxlbXMgeCBhbmQgeSBjb29yZGluYXRlcykgYW5kIHRoZW4gZHJhd24gb250byB0aGUgcmVuZGVyZXJcbiAqIGVhY2ggQUJDSlMgQUVTIHJlcHJlc2VudHMgYSBzaW5nbGUgc3RhZmZncm91cCAtIGFsbCBlbGVtZW50cyB0aGF0IGFyZSBub3QgaW4gYSBzdGFmZmdyb3VwIGFyZSByZW5kZXJlZCBkaXJlY3RseSBieSB0aGUgY29udHJvbGxlclxuICpcbiAqIGVsZW1lbnRzIGluIEFCQ0pTIEFFUyBrbm93IHRoZWlyIFwic291cmNlIGRhdGFcIiBpbiB0aGUgQUJDSlMgQVNULCBhbmQgdGhlaXIgXCJ0YXJnZXQgc2hhcGVcIiBcbiAqIGluIHRoZSByZW5kZXJlciBmb3IgaGlnaGxpZ2h0aW5nIHB1cnBvc2VzXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHBhcGVyIGRpdiBlbGVtZW50IHRoYXQgd2lsbCB3cmFwIHRoZSBTVkdcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYXJhbXMgYWxsIHRoZSBwYXJhbXMgLS0gZG9jdW1lbnRlZCBvbiBnaXRodWIgLy9UT0RPLUdEIG1vdmUgc29tZSBvZiB0aGF0IGRvY3VtZW50YXRpb24gaGVyZVxuICovXG52YXIgRW5ncmF2ZXJDb250cm9sbGVyID0gZnVuY3Rpb24ocGFwZXIsIHBhcmFtcykge1xuICBwYXJhbXMgPSBwYXJhbXMgfHwge307XG4gIHRoaXMucmVzcG9uc2l2ZSA9IHBhcmFtcy5yZXNwb25zaXZlO1xuICB0aGlzLnNwYWNlID0gMypzcGFjaW5nLlNQQUNFO1xuICB0aGlzLnNjYWxlID0gcGFyYW1zLnNjYWxlID8gcGFyc2VGbG9hdChwYXJhbXMuc2NhbGUpIDogMDtcbiAgaWYgKCEodGhpcy5zY2FsZSA+IDAuMSkpXG4gIFx0dGhpcy5zY2FsZSA9IHVuZGVmaW5lZDtcblxuXHRpZiAocGFyYW1zLnN0YWZmd2lkdGgpIHtcblx0XHQvLyBOb3RlOiBOb3JtYWxseSBhbGwgbWVhc3VyZW1lbnRzIHRvIHRoZSBlbmdyYXZlciBhcmUgaW4gUE9JTlRTLiBIb3dldmVyLCBpZiBhIHBlcnNvbiBpcyBmb3JtYXR0aW5nIGZvciB0aGVcblx0XHQvLyBzY3JlZW4gYW5kIGRpcmVjdGx5IGlucHV0dGluZyB0aGUgd2lkdGgsIHRoZW4gaXQgaXMgbW9yZSBsb2dpY2FsIHRvIGhhdmUgdGhlIG1lYXN1cmVtZW50IGluIHBpeGVscy5cblx0XHR0aGlzLnN0YWZmd2lkdGhTY3JlZW4gPSBwYXJhbXMuc3RhZmZ3aWR0aDtcblx0XHR0aGlzLnN0YWZmd2lkdGhQcmludCA9IHBhcmFtcy5zdGFmZndpZHRoO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuc3RhZmZ3aWR0aFNjcmVlbiA9IDc0MDsgLy8gVE9ETy1QRVI6IE5vdCBzdXJlIHdoZXJlIHRoaXMgbnVtYmVyIGNvbWVzIGZyb20sIGJ1dCB0aGlzIGlzIGhvdyBpdCdzIGFsd2F5cyBiZWVuLlxuXHRcdHRoaXMuc3RhZmZ3aWR0aFByaW50ID0gNjgwOyAvLyBUaGUgbnVtYmVyIG9mIHBpeGVscyBpbiA4LjVcIiwgYWZ0ZXIgMWNtIG9mIG1hcmdpbiBoYXMgYmVlbiByZW1vdmVkLlxuXHR9XG4gIHRoaXMuZWRpdGFibGUgPSBwYXJhbXMuZWRpdGFibGUgfHwgZmFsc2U7XG5cdHRoaXMubGlzdGVuZXJzID0gW107XG5cdGlmIChwYXJhbXMuY2xpY2tMaXN0ZW5lcilcblx0XHR0aGlzLmFkZFNlbGVjdExpc3RlbmVyKHBhcmFtcy5jbGlja0xpc3RlbmVyKTtcblxuICB0aGlzLnJlbmRlcmVyPW5ldyBSZW5kZXJlcihwYXBlciwgcGFyYW1zLnJlZ3Jlc3Npb24sIHBhcmFtcy5hZGRfY2xhc3Nlcyk7XG5cdHRoaXMucmVuZGVyZXIuc2V0UGFkZGluZ092ZXJyaWRlKHBhcmFtcyk7XG4gIHRoaXMucmVuZGVyZXIuY29udHJvbGxlciA9IHRoaXM7IC8vIFRPRE8tR0QgbmVlZGVkIGZvciBoaWdobGlnaHRpbmdcblxuXHR0aGlzLnJlc2V0KCk7XG59O1xuXG5FbmdyYXZlckNvbnRyb2xsZXIucHJvdG90eXBlLnJlc2V0ID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMuc2VsZWN0ZWQgPSBbXTtcblx0dGhpcy5pbmdyb3VwID0gZmFsc2U7XG5cdHRoaXMuc3RhZmZncm91cHMgPSBbXTtcblx0dGhpcy5sYXN0U3RhZmZHcm91cEluZGV4ID0gLTE7XG5cdGlmICh0aGlzLmVuZ3JhdmVyKVxuXHRcdHRoaXMuZW5ncmF2ZXIucmVzZXQoKTtcblx0dGhpcy5lbmdyYXZlciA9IG51bGw7XG5cdHRoaXMucmVuZGVyZXIucmVzZXQoKTtcbn07XG5cbi8qKlxuICogcnVuIHRoZSBlbmdyYXZpbmcgcHJvY2Vzc1xuICogQHBhcmFtIHtBQkNKUy5UdW5lfEFCQ0pTLlR1bmVbXX0gYWJjdHVuZXMgXG4gKi9cbkVuZ3JhdmVyQ29udHJvbGxlci5wcm90b3R5cGUuZW5ncmF2ZUFCQyA9IGZ1bmN0aW9uKGFiY3R1bmVzLCB0dW5lTnVtYmVyKSB7XG4gIGlmIChhYmN0dW5lc1swXT09PXVuZGVmaW5lZCkge1xuICAgIGFiY3R1bmVzID0gW2FiY3R1bmVzXTtcbiAgfVxuXHR0aGlzLnJlc2V0KCk7XG5cbiAgZm9yICh2YXIgaSA9IDA7IGkgPCBhYmN0dW5lcy5sZW5ndGg7IGkrKykge1xuICBcdGlmICh0dW5lTnVtYmVyID09PSB1bmRlZmluZWQpXG4gIFx0XHR0dW5lTnVtYmVyID0gaTtcbiAgICB0aGlzLmVuZ3JhdmVUdW5lKGFiY3R1bmVzW2ldLCB0dW5lTnVtYmVyKTtcbiAgfVxuXHRpZiAodGhpcy5yZW5kZXJlci5kb1JlZ3Jlc3Npb24pXG5cdFx0cmV0dXJuIHRoaXMucmVuZGVyZXIucmVncmVzc2lvbkxpbmVzLmpvaW4oXCJcXG5cIik7XG59O1xuXG4vKipcbiAqIFNvbWUgb2YgdGhlIGl0ZW1zIG9uIHRoZSBwYWdlIGFyZSBub3Qgc2NhbGVkLCBzbyBhZGp1c3QgdGhlbSBpbiB0aGUgb3Bwb3NpdGUgZGlyZWN0aW9uIG9mIHNjYWxpbmcgdG8gY2FuY2VsIG91dCB0aGUgc2NhbGluZy5cbiAqIEBwYXJhbSB7ZmxvYXR9IHNjYWxlXG4gKi9cbkVuZ3JhdmVyQ29udHJvbGxlci5wcm90b3R5cGUuYWRqdXN0Tm9uU2NhbGVkSXRlbXMgPSBmdW5jdGlvbiAoc2NhbGUpIHtcblx0dGhpcy53aWR0aCAvPSBzY2FsZTtcblx0dGhpcy5yZW5kZXJlci5hZGp1c3ROb25TY2FsZWRJdGVtcyhzY2FsZSk7XG59O1xuXG5FbmdyYXZlckNvbnRyb2xsZXIucHJvdG90eXBlLmdldE1lYXN1cmVXaWR0aHMgPSBmdW5jdGlvbihhYmNUdW5lKSB7XG5cdHRoaXMucmVzZXQoKTtcblxuXHR0aGlzLnJlbmRlcmVyLmxpbmVOdW1iZXIgPSBudWxsO1xuXG5cdHRoaXMucmVuZGVyZXIubmV3VHVuZShhYmNUdW5lKTtcblx0dGhpcy5lbmdyYXZlciA9IG5ldyBBYnN0cmFjdEVuZ3JhdmVyKGFiY1R1bmUuZm9ybWF0dGluZy5iYWdwaXBlcyx0aGlzLnJlbmRlcmVyLCAwKTtcblx0dGhpcy5lbmdyYXZlci5zZXRTdGVtSGVpZ2h0KHRoaXMucmVuZGVyZXIuc3BhY2luZy5zdGVtSGVpZ2h0KTtcblx0aWYgKGFiY1R1bmUuZm9ybWF0dGluZy5zdGFmZndpZHRoKSB7XG5cdFx0dGhpcy53aWR0aCA9IGFiY1R1bmUuZm9ybWF0dGluZy5zdGFmZndpZHRoICogMS4zMzsgLy8gVGhlIHdpZHRoIGlzIGV4cHJlc3NlZCBpbiBwdDsgY29udmVydCB0byBweC5cblx0fSBlbHNlIHtcblx0XHR0aGlzLndpZHRoID0gdGhpcy5yZW5kZXJlci5pc1ByaW50ID8gdGhpcy5zdGFmZndpZHRoUHJpbnQgOiB0aGlzLnN0YWZmd2lkdGhTY3JlZW47XG5cdH1cblxuXHR2YXIgc2NhbGUgPSBhYmNUdW5lLmZvcm1hdHRpbmcuc2NhbGUgPyBhYmNUdW5lLmZvcm1hdHRpbmcuc2NhbGUgOiB0aGlzLnNjYWxlO1xuXHRpZiAodGhpcy5yZXNwb25zaXZlID09PSBcInJlc2l6ZVwiKSAvLyBUaGUgcmVzaXppbmcgd2lsbCBtZXNzIHdpdGggdGhlIHNjYWxpbmcsIHNvIGp1c3QgZG9uJ3QgZG8gaXQgZXhwbGljaXRseS5cblx0XHRzY2FsZSA9IHVuZGVmaW5lZDtcblx0aWYgKHNjYWxlID09PSB1bmRlZmluZWQpIHNjYWxlID0gdGhpcy5yZW5kZXJlci5pc1ByaW50ID8gMC43NSA6IDE7XG5cdHRoaXMuYWRqdXN0Tm9uU2NhbGVkSXRlbXMoc2NhbGUpO1xuXG5cdHZhciByZXQgPSB7IGxlZnQ6IDAsIG1lYXN1cmVXaWR0aHM6IFtdIH07XG5cdHZhciBkZWJ1ZyA9IGZhbHNlO1xuXHR2YXIgaGFzUHJpbnRlZFRlbXBvID0gZmFsc2U7XG5cdGZvcih2YXIgaT0wOyBpPGFiY1R1bmUubGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgYWJjTGluZSA9IGFiY1R1bmUubGluZXNbaV07XG5cdFx0aWYgKGFiY0xpbmUuc3RhZmYpIHtcblx0XHRcdGFiY0xpbmUuc3RhZmZHcm91cCA9IHRoaXMuZW5ncmF2ZXIuY3JlYXRlQUJDTGluZShhYmNMaW5lLnN0YWZmLCAhaGFzUHJpbnRlZFRlbXBvID8gYWJjVHVuZS5tZXRhVGV4dC50ZW1wbzogbnVsbCk7XG5cblx0XHRcdGFiY0xpbmUuc3RhZmZHcm91cC5sYXlvdXQoMCwgdGhpcy5yZW5kZXJlciwgZGVidWcpO1xuXHRcdFx0Ly8gQXQgdGhpcyBwb2ludCwgdGhlIHZvaWNlcyBhcmUgbGFpZCBvdXQgc28gdGhhdCB0aGUgYmFyIGxpbmVzIGFyZSBldmVuIHdpdGggZWFjaCBvdGhlci4gU28gd2UganVzdCBuZWVkIHRvIGdldCB0aGUgcGxhY2VtZW50IG9mIHRoZSBmaXJzdCB2b2ljZS5cblx0XHRcdGlmIChhYmNMaW5lLnN0YWZmR3JvdXAudm9pY2VzLmxlbmd0aCA+IDApIHtcblx0XHRcdFx0dmFyIHZvaWNlID0gYWJjTGluZS5zdGFmZkdyb3VwLnZvaWNlc1swXTtcblx0XHRcdFx0dmFyIGZvdW5kTm90U3RhZmZFeHRyYSA9IGZhbHNlO1xuXHRcdFx0XHR2YXIgbGFzdFhQb3NpdGlvbiA9IDA7XG5cdFx0XHRcdGZvciAodmFyIGsgPSAwOyBrIDwgdm9pY2UuY2hpbGRyZW4ubGVuZ3RoOyBrKyspIHtcblx0XHRcdFx0XHR2YXIgY2hpbGQgPSB2b2ljZS5jaGlsZHJlbltrXTtcblx0XHRcdFx0XHRpZiAoIWZvdW5kTm90U3RhZmZFeHRyYSAmJiAhY2hpbGQuaXNDbGVmICYmICFjaGlsZC5pc0tleVNpZykge1xuXHRcdFx0XHRcdFx0Zm91bmROb3RTdGFmZkV4dHJhID0gdHJ1ZTtcblx0XHRcdFx0XHRcdHJldC5sZWZ0ID0gY2hpbGQueDtcblx0XHRcdFx0XHRcdGxhc3RYUG9zaXRpb24gPSBjaGlsZC54O1xuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRpZiAoY2hpbGQudHlwZSA9PT0gJ2JhcicpIHtcblx0XHRcdFx0XHRcdHJldC5tZWFzdXJlV2lkdGhzLnB1c2goY2hpbGQueCAtIGxhc3RYUG9zaXRpb24pO1xuXHRcdFx0XHRcdFx0bGFzdFhQb3NpdGlvbiA9IGNoaWxkLng7XG5cdFx0XHRcdFx0fVxuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0XHRoYXNQcmludGVkVGVtcG8gPSB0cnVlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmV0O1xufTtcblxuLyoqXG4gKiBSdW4gdGhlIGVuZ3JhdmluZyBwcm9jZXNzIG9uIGEgc2luZ2xlIHR1bmVcbiAqIEBwYXJhbSB7QUJDSlMuVHVuZX0gYWJjdHVuZVxuICovXG5FbmdyYXZlckNvbnRyb2xsZXIucHJvdG90eXBlLmVuZ3JhdmVUdW5lID0gZnVuY3Rpb24gKGFiY3R1bmUsIHR1bmVOdW1iZXIpIHtcblx0dGhpcy5yZW5kZXJlci5saW5lTnVtYmVyID0gbnVsbDtcblxuXHR0aGlzLnJlbmRlcmVyLm5ld1R1bmUoYWJjdHVuZSk7XG5cdHRoaXMuZW5ncmF2ZXIgPSBuZXcgQWJzdHJhY3RFbmdyYXZlcihhYmN0dW5lLmZvcm1hdHRpbmcuYmFncGlwZXMsdGhpcy5yZW5kZXJlciwgdHVuZU51bWJlcik7XG5cdHRoaXMuZW5ncmF2ZXIuc2V0U3RlbUhlaWdodCh0aGlzLnJlbmRlcmVyLnNwYWNpbmcuc3RlbUhlaWdodCk7XG5cdGlmIChhYmN0dW5lLmZvcm1hdHRpbmcuc3RhZmZ3aWR0aCkge1xuXHRcdHRoaXMud2lkdGggPSBhYmN0dW5lLmZvcm1hdHRpbmcuc3RhZmZ3aWR0aCAqIDEuMzM7IC8vIFRoZSB3aWR0aCBpcyBleHByZXNzZWQgaW4gcHQ7IGNvbnZlcnQgdG8gcHguXG5cdH0gZWxzZSB7XG5cdFx0dGhpcy53aWR0aCA9IHRoaXMucmVuZGVyZXIuaXNQcmludCA/IHRoaXMuc3RhZmZ3aWR0aFByaW50IDogdGhpcy5zdGFmZndpZHRoU2NyZWVuO1xuXHR9XG5cblx0dmFyIHNjYWxlID0gYWJjdHVuZS5mb3JtYXR0aW5nLnNjYWxlID8gYWJjdHVuZS5mb3JtYXR0aW5nLnNjYWxlIDogdGhpcy5zY2FsZTtcblx0aWYgKHRoaXMucmVzcG9uc2l2ZSA9PT0gXCJyZXNpemVcIikgLy8gVGhlIHJlc2l6aW5nIHdpbGwgbWVzcyB3aXRoIHRoZSBzY2FsaW5nLCBzbyBqdXN0IGRvbid0IGRvIGl0IGV4cGxpY2l0bHkuXG5cdFx0c2NhbGUgPSB1bmRlZmluZWQ7XG5cdGlmIChzY2FsZSA9PT0gdW5kZWZpbmVkKSBzY2FsZSA9IHRoaXMucmVuZGVyZXIuaXNQcmludCA/IDAuNzUgOiAxO1xuXHR0aGlzLmFkanVzdE5vblNjYWxlZEl0ZW1zKHNjYWxlKTtcblxuXHQvLyBHZW5lcmF0ZSB0aGUgcmF3IHN0YWZmIGxpbmUgZGF0YVxuXHR2YXIgaTtcblx0dmFyIGFiY0xpbmU7XG5cdHZhciBoYXNQcmludGVkVGVtcG8gPSBmYWxzZTtcblx0Zm9yKGk9MDsgaTxhYmN0dW5lLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0YWJjTGluZSA9IGFiY3R1bmUubGluZXNbaV07XG5cdFx0aWYgKGFiY0xpbmUuc3RhZmYpIHtcblx0XHRcdGFiY0xpbmUuc3RhZmZHcm91cCA9IHRoaXMuZW5ncmF2ZXIuY3JlYXRlQUJDTGluZShhYmNMaW5lLnN0YWZmLCAhaGFzUHJpbnRlZFRlbXBvID8gYWJjdHVuZS5tZXRhVGV4dC50ZW1wbzogbnVsbCk7XG5cdFx0XHRoYXNQcmludGVkVGVtcG8gPSB0cnVlO1xuXHRcdH1cblx0fVxuXG5cdC8vIEFkanVzdCB0aGUgeC1jb29yZGluYXRlcyB0byB0aGVpciBhYnNvbHV0ZSBwb3NpdGlvbnNcblx0dmFyIG1heFdpZHRoID0gdGhpcy53aWR0aDtcblx0Zm9yKGk9MDsgaTxhYmN0dW5lLmxpbmVzLmxlbmd0aDsgaSsrKSB7XG5cdFx0YWJjTGluZSA9IGFiY3R1bmUubGluZXNbaV07XG5cdFx0aWYgKGFiY0xpbmUuc3RhZmYpIHtcblx0XHRcdHRoaXMuc2V0WFNwYWNpbmcoYWJjTGluZS5zdGFmZkdyb3VwLCBhYmN0dW5lLmZvcm1hdHRpbmcsIGkgPT09IGFiY3R1bmUubGluZXMubGVuZ3RoIC0gMSwgZmFsc2UpO1xuXHRcdFx0aWYgKGFiY0xpbmUuc3RhZmZHcm91cC53ID4gbWF4V2lkdGgpIG1heFdpZHRoID0gYWJjTGluZS5zdGFmZkdyb3VwLnc7XG5cdFx0fVxuXHR9XG5cblx0Ly8gTGF5b3V0IHRoZSBiZWFtcyBhbmQgYWRkIHRoZSBzdGVtcyB0byB0aGUgYmVhbWVkIG5vdGVzLlxuXHRmb3IoaT0wOyBpPGFiY3R1bmUubGluZXMubGVuZ3RoOyBpKyspIHtcblx0XHRhYmNMaW5lID0gYWJjdHVuZS5saW5lc1tpXTtcblx0XHRpZiAoYWJjTGluZS5zdGFmZkdyb3VwICYmIGFiY0xpbmUuc3RhZmZHcm91cC52b2ljZXMpIHtcblx0XHRcdGZvciAodmFyIGogPSAwOyBqIDwgYWJjTGluZS5zdGFmZkdyb3VwLnZvaWNlcy5sZW5ndGg7IGorKylcblx0XHRcdFx0YWJjTGluZS5zdGFmZkdyb3VwLnZvaWNlc1tqXS5sYXlvdXRCZWFtcygpO1xuXHRcdFx0YWJjTGluZS5zdGFmZkdyb3VwLnNldFVwcGVyQW5kTG93ZXJFbGVtZW50cyh0aGlzLnJlbmRlcmVyKTtcblx0XHR9XG5cdH1cblxuXHQvLyBTZXQgdGhlIHN0YWZmIHNwYWNpbmdcblx0Ly8gVE9ETy1QRVI6IHdlIHNob3VsZCBoYXZlIGJlZW4gYWJsZSB0byBkbyB0aGlzIGJ5IHRoZSB0aW1lIHdlIGNhbGxlZCBzZXRVcHBlckFuZExvd2VyRWxlbWVudHMsIGJ1dCBmb3Igc29tZSByZWFzb24gdGhlIFwiYm90dG9tXCIgZWxlbWVudCBzZWVtcyB0byBiZSBzZXQgYXMgYSBzaWRlIGVmZmVjdCBvZiBzZXR0aW5nIHRoZSBYIHNwYWNpbmcuXG5cdGZvcihpPTA7IGk8YWJjdHVuZS5saW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdGFiY0xpbmUgPSBhYmN0dW5lLmxpbmVzW2ldO1xuXHRcdGlmIChhYmNMaW5lLnN0YWZmR3JvdXApIHtcblx0XHRcdGFiY0xpbmUuc3RhZmZHcm91cC5oZWlnaHQgPSBhYmNMaW5lLnN0YWZmR3JvdXAuY2FsY0hlaWdodCgpO1xuXHRcdH1cblx0fVxuXG5cdC8vIERvIGFsbCB0aGUgd3JpdGluZyB0byBvdXRwdXRcblx0dGhpcy5yZW5kZXJlci50b3BNYXJnaW4oYWJjdHVuZSk7XG5cdC8vdGhpcy5yZW5kZXJlci5wcmludEhvcml6b250YWxMaW5lKHRoaXMud2lkdGggKyB0aGlzLnJlbmRlcmVyLnBhZGRpbmcubGVmdCArIHRoaXMucmVuZGVyZXIucGFkZGluZy5yaWdodCk7XG5cdHRoaXMucmVuZGVyZXIuZW5ncmF2ZVRvcFRleHQodGhpcy53aWR0aCwgYWJjdHVuZSk7XG5cdHRoaXMucmVuZGVyZXIuYWRkTXVzaWNQYWRkaW5nKCk7XG5cblx0dGhpcy5zdGFmZmdyb3VwcyA9IFtdO1xuXHR0aGlzLmxhc3RTdGFmZkdyb3VwSW5kZXggPSAtMTtcblx0Zm9yICh2YXIgbGluZSA9IDA7IGxpbmUgPCBhYmN0dW5lLmxpbmVzLmxlbmd0aDsgbGluZSsrKSB7XG5cdFx0dGhpcy5yZW5kZXJlci5saW5lTnVtYmVyID0gbGluZTtcblx0XHRhYmNMaW5lID0gYWJjdHVuZS5saW5lc1tsaW5lXTtcblx0XHRpZiAoYWJjTGluZS5zdGFmZikge1xuXHRcdFx0dGhpcy5lbmdyYXZlU3RhZmZMaW5lKGFiY0xpbmUuc3RhZmZHcm91cCk7XG5cdFx0fSBlbHNlIGlmIChhYmNMaW5lLnN1YnRpdGxlICYmIGxpbmUgIT09IDApIHtcblx0XHRcdHRoaXMucmVuZGVyZXIub3V0cHV0U3VidGl0bGUodGhpcy53aWR0aCwgYWJjTGluZS5zdWJ0aXRsZSk7XG5cdFx0fSBlbHNlIGlmIChhYmNMaW5lLnRleHQgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dGhpcy5yZW5kZXJlci5vdXRwdXRGcmVlVGV4dChhYmNMaW5lLnRleHQpO1xuXHRcdH1cblx0fVxuXG5cdHRoaXMucmVuZGVyZXIubW92ZVkoMjQpOyAvLyBUT0RPLVBFUjogRW1waXJpY2FsbHkgZGlzY292ZXJlZC4gV2hhdCB2YXJpYWJsZSBzaG91bGQgdGhpcyBiZT9cblx0dGhpcy5yZW5kZXJlci5lbmdyYXZlRXh0cmFUZXh0KHRoaXMud2lkdGgsIGFiY3R1bmUpO1xuXHR0aGlzLnJlbmRlcmVyLnNldFBhcGVyU2l6ZShtYXhXaWR0aCwgc2NhbGUsIHRoaXMucmVzcG9uc2l2ZSk7XG59O1xuXG5mdW5jdGlvbiBjYWxjSG9yaXpvbnRhbFNwYWNpbmcoaXNMYXN0TGluZSwgc3RyZXRjaExhc3QsIHRhcmdldFdpZHRoLCBsaW5lV2lkdGgsIHNwYWNpbmcsIHNwYWNpbmdVbml0cywgbWluU3BhY2UpIHtcblx0Ly8gVE9ETy1QRVI6IFRoaXMgdXNlZCB0byBzdHJldGNoIHRoZSBmaXJzdCBsaW5lIHdoZW4gaXQgaXMgdGhlIG9ubHkgbGluZSwgYnV0IEknbSBub3Qgc3VyZSB3aHkuIGFiY20ycHMgZG9lc24ndCBkbyB0aGF0XG5cdGlmIChpc0xhc3RMaW5lICYmIGxpbmVXaWR0aCAvIHRhcmdldFdpZHRoIDwgMC42NiAmJiAhc3RyZXRjaExhc3QpIHJldHVybiBudWxsOyAvLyBkb24ndCBzdHJldGNoIGxhc3QgbGluZSB0b28gbXVjaFxuXHRpZiAoTWF0aC5hYnModGFyZ2V0V2lkdGgtbGluZVdpZHRoKSA8IDIpIHJldHVybiBudWxsOyAvLyBpZiB3ZSBhcmUgYWxyZWFkeSBuZWFyIHRoZSB0YXJnZXQgd2lkdGgsIHdlJ3JlIGRvbmUuXG5cdHZhciByZWxTcGFjZSA9IHNwYWNpbmdVbml0cyAqIHNwYWNpbmc7XG5cdHZhciBjb25zdFNwYWNlID0gbGluZVdpZHRoIC0gcmVsU3BhY2U7XG5cdGlmIChzcGFjaW5nVW5pdHMgPiAwKSB7XG5cdFx0c3BhY2luZyA9ICh0YXJnZXRXaWR0aCAtIGNvbnN0U3BhY2UpIC8gc3BhY2luZ1VuaXRzO1xuXHRcdGlmIChzcGFjaW5nICogbWluU3BhY2UgPiA1MCkge1xuXHRcdFx0c3BhY2luZyA9IDUwIC8gbWluU3BhY2U7XG5cdFx0fVxuXHRcdHJldHVybiBzcGFjaW5nO1xuXHR9XG5cdHJldHVybiBudWxsO1xufVxuXG4vKipcbiAqIERvIHRoZSB4LWF4aXMgcG9zaXRpb25pbmcgZm9yIGEgc2luZ2xlIGxpbmUgKGEgZ3JvdXAgb2YgcmVsYXRlZCBzdGFmZnMpXG4gKiBAcGFyYW0ge0FCQ0pTLlR1bmV9IGFiY3R1bmUgYW4gQUJDSlMgQVNUXG4gKiBAcGFyYW0ge09iamVjdH0gc3RhZmZHcm91cCBhbiBzdGFmZkdyb3VwXG4gKiBAcGFyYW0ge09iamVjdH0gZm9ybWF0dGluZyBhbiBmb3JtYXR0aW5nXG4gKiBAcGFyYW0ge2Jvb2xlYW59IGlzTGFzdExpbmUgaXMgdGhpcyB0aGUgbGFzdCBsaW5lIHRvIGJlIHByaW50ZWQ/XG4gKiBAcHJpdmF0ZVxuICovXG5FbmdyYXZlckNvbnRyb2xsZXIucHJvdG90eXBlLnNldFhTcGFjaW5nID0gZnVuY3Rpb24gKHN0YWZmR3JvdXAsIGZvcm1hdHRpbmcsIGlzTGFzdExpbmUsIGRlYnVnKSB7XG4gICB2YXIgbmV3c3BhY2UgPSB0aGlzLnNwYWNlO1xuICBmb3IgKHZhciBpdCA9IDA7IGl0IDwgODsgaXQrKykgeyAvLyBUT0RPLVBFUjogc2hvdWxkbid0IG5lZWQgbXVsdGlwbGUgcGFzc2VzLCBidXQgZWFjaCBwYXNzIGdldHMgaXQgY2xvc2VyIHRvIHRoZSByaWdodCBzcGFjaW5nLiAoT25seSBhZmZlY3RzIGxvbmcgbGluZXM6IG5vcm1hbCBsaW5lcyBicmVhayBvdXQgb2YgdGhpcyBsb29wIHF1aWNrbHkuKVxuXHQgIHZhciByZXQgPSBzdGFmZkdyb3VwLmxheW91dChuZXdzcGFjZSwgdGhpcy5yZW5kZXJlciwgZGVidWcpO1xuXHQgIHZhciBzdHJldGNoTGFzdCA9IGZvcm1hdHRpbmcuc3RyZXRjaGxhc3QgPyBmb3JtYXR0aW5nLnN0cmV0Y2hsYXN0IDogZmFsc2U7XG5cdFx0bmV3c3BhY2UgPSBjYWxjSG9yaXpvbnRhbFNwYWNpbmcoaXNMYXN0TGluZSwgc3RyZXRjaExhc3QsIHRoaXMud2lkdGgrdGhpcy5yZW5kZXJlci5wYWRkaW5nLmxlZnQsIHN0YWZmR3JvdXAudywgbmV3c3BhY2UsIHJldC5zcGFjaW5nVW5pdHMsIHJldC5taW5TcGFjZSk7XG5cdFx0aWYgKGRlYnVnKVxuXHRcdFx0Y29uc29sZS5sb2coXCJzZXRYU3BhY2VcIiwgaXQsIHN0YWZmR3JvdXAudywgbmV3c3BhY2UsIHN0YWZmR3JvdXAubWluc3BhY2UpO1xuXHRcdGlmIChuZXdzcGFjZSA9PT0gbnVsbCkgYnJlYWs7XG4gIH1cblx0Y2VudGVyV2hvbGVSZXN0cyhzdGFmZkdyb3VwLnZvaWNlcyk7XG5cdC8vdGhpcy5yZW5kZXJlci5wcmludEhvcml6b250YWxMaW5lKHRoaXMud2lkdGgpO1xufTtcblxuLyoqXG4gKiBFbmdyYXZlIGEgc2luZ2xlIGxpbmUgKGEgZ3JvdXAgb2YgcmVsYXRlZCBzdGFmZnMpXG4gKiBAcGFyYW0ge0FCQ0pTLlR1bmV9IGFiY3R1bmUgYW4gQUJDSlMgQVNUXG4gKiBAcGFyYW0ge09iamVjdH0gc3RhZmZHcm91cCBhbiBzdGFmZkdyb3VwXG4gKiBAcHJpdmF0ZVxuICovXG5FbmdyYXZlckNvbnRyb2xsZXIucHJvdG90eXBlLmVuZ3JhdmVTdGFmZkxpbmUgPSBmdW5jdGlvbiAoc3RhZmZHcm91cCkge1xuXHRpZiAodGhpcy5sYXN0U3RhZmZHcm91cEluZGV4ID4gLTEpXG5cdFx0dGhpcy5yZW5kZXJlci5hZGRTdGFmZlBhZGRpbmcodGhpcy5zdGFmZmdyb3Vwc1t0aGlzLmxhc3RTdGFmZkdyb3VwSW5kZXhdLCBzdGFmZkdyb3VwKTtcblx0dGhpcy5yZW5kZXJlci52b2ljZU51bWJlciA9IG51bGw7XG5cdHN0YWZmR3JvdXAuZHJhdyh0aGlzLnJlbmRlcmVyKTtcblx0dmFyIGhlaWdodCA9IHN0YWZmR3JvdXAuaGVpZ2h0ICogc3BhY2luZy5TVEVQO1xuXHQvL3RoaXMucmVuZGVyZXIucHJpbnRWZXJ0aWNhbExpbmUodGhpcy53aWR0aCt0aGlzLnJlbmRlcmVyLnBhZGRpbmcubGVmdCwgdGhpcy5yZW5kZXJlci55LCB0aGlzLnJlbmRlcmVyLnkraGVpZ2h0KTtcbiAgdGhpcy5zdGFmZmdyb3Vwc1t0aGlzLnN0YWZmZ3JvdXBzLmxlbmd0aF0gPSBzdGFmZkdyb3VwO1xuXHR0aGlzLmxhc3RTdGFmZkdyb3VwSW5kZXggPSB0aGlzLnN0YWZmZ3JvdXBzLmxlbmd0aC0xO1xuXHR0aGlzLnJlbmRlcmVyLnkgKz0gaGVpZ2h0O1xufTtcblxuLyoqXG4gKiBDYWxsZWQgYnkgdGhlIEFic3RyYWN0IEVuZ3JhdmluZyBTdHJ1Y3R1cmUgb3IgYW55IG90aGVyIChlLmcuIG1pZGkgcGxheWJhY2spIHRvIHNheSBpdCB3YXMgc2VsZWN0ZWQgKG5vdGVoZWFkIGNsaWNrZWQgb24pXG4gKiBAcHJvdGVjdGVkXG4gKi9cbkVuZ3JhdmVyQ29udHJvbGxlci5wcm90b3R5cGUubm90aWZ5U2VsZWN0ID0gZnVuY3Rpb24gKGFic2VsZW0sIHR1bmVOdW1iZXIsIGNsYXNzZXMpIHtcbiAgdGhpcy5jbGVhclNlbGVjdGlvbigpO1xuICBpZiAoYWJzZWxlbS5oaWdobGlnaHQpIHtcbiAgICB0aGlzLnNlbGVjdGVkID0gW2Fic2VsZW1dO1xuICAgIGFic2VsZW0uaGlnaGxpZ2h0KCk7XG4gIH1cbiAgdmFyIGFiY2VsZW0gPSBhYnNlbGVtLmFiY2VsZW0gfHwge307XG4gIGZvciAodmFyIGk9MDsgaTx0aGlzLmxpc3RlbmVycy5sZW5ndGg7aSsrKSB7XG5cdCAgdGhpcy5saXN0ZW5lcnNbaV0oYWJjZWxlbSwgdHVuZU51bWJlciwgY2xhc3Nlcyk7XG4gIH1cbn07XG5cbi8qKlxuICogQ2FsbGVkIGJ5IHRoZSBBYnN0cmFjdCBFbmdyYXZpbmcgU3RydWN0dXJlIHRvIHNheSBpdCB3YXMgbW9kaWZpZWQgKGUuZy4gbm90ZWhlYWQgZHJhZ2dlZClcbiAqIEBwcm90ZWN0ZWRcbiAqL1xuLy8gRW5ncmF2ZXJDb250cm9sbGVyLnByb3RvdHlwZS5ub3RpZnlDaGFuZ2UgPSBmdW5jdGlvbiAoLyphYnNlbGVtKi8pIHtcbi8vICAgZm9yICh2YXIgaT0wOyBpPHRoaXMubGlzdGVuZXJzLmxlbmd0aDtpKyspIHtcbi8vICAgICBpZiAodGhpcy5saXN0ZW5lcnNbaV0ubW9kZWxDaGFuZ2VkKVxuLy8gICAgICAgdGhpcy5saXN0ZW5lcnNbaV0ubW9kZWxDaGFuZ2VkKCk7XG4vLyAgIH1cbi8vIH07XG5cbi8qKlxuICpcbiAqIEBwcml2YXRlXG4gKi9cbkVuZ3JhdmVyQ29udHJvbGxlci5wcm90b3R5cGUuY2xlYXJTZWxlY3Rpb24gPSBmdW5jdGlvbiAoKSB7XG4gIGZvciAodmFyIGk9MDtpPHRoaXMuc2VsZWN0ZWQubGVuZ3RoO2krKykge1xuICAgIHRoaXMuc2VsZWN0ZWRbaV0udW5oaWdobGlnaHQoKTtcbiAgfVxuICB0aGlzLnNlbGVjdGVkID0gW107XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7T2JqZWN0fSBsaXN0ZW5lclxuICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIubW9kZWxDaGFuZ2VkIHRoZSBtb2RlbCB0aGUgbGlzdGVuZXIgcGFzc2VkIHRvIHRoaXMgY29udHJvbGxlciBoYXMgY2hhbmdlZFxuICogQHBhcmFtIHtGdW5jdGlvbn0gbGlzdGVuZXIuaGlnaGxpZ2h0IHRoZSBhYmNlbGVtIG9mIHRoZSBtb2RlbCB0aGUgbGlzdGVuZXIgcGFzc2VkIHRvIHRoaXMgY29udHJvbGxlciBzaG91bGQgYmUgaGlnaGxpZ2h0ZWRcbiAqL1xuRW5ncmF2ZXJDb250cm9sbGVyLnByb3RvdHlwZS5hZGRTZWxlY3RMaXN0ZW5lciA9IGZ1bmN0aW9uIChjbGlja0xpc3RlbmVyKSB7XG4gIHRoaXMubGlzdGVuZXJzW3RoaXMubGlzdGVuZXJzLmxlbmd0aF0gPSBjbGlja0xpc3RlbmVyO1xufTtcblxuLyoqXG4gKiBUZWxsIHRoZSBjb250cm9sbGVyIHRvIGhpZ2hsaWdodCBzb21lIG5vdGVoZWFkcyBvZiBpdHMgZW5ncmF2ZWQgc2NvcmVcbiAqIEBwYXJhbSB7bnVtYmVyfSBzdGFydCB0aGUgY2hhcmFjdGVyIGluIHRoZSBzb3VyY2UgYWJjIHdoZXJlIGhpZ2hsaWdodGluZyBzaG91bGQgc3RhcnRcbiAqIEBwYXJhbSB7bnVtYmVyfSBlbmQgdGhlIGNoYXJhY3RlciBpbiB0aGUgc291cmNlIGFiYyB3aGVyZSBoaWdobGlnaHRpbmcgc2hvdWxkIGVuZFxuICovXG5FbmdyYXZlckNvbnRyb2xsZXIucHJvdG90eXBlLnJhbmdlSGlnaGxpZ2h0ID0gZnVuY3Rpb24oc3RhcnQsZW5kKVxue1xuICAgIHRoaXMuY2xlYXJTZWxlY3Rpb24oKTtcbiAgICBmb3IgKHZhciBsaW5lPTA7bGluZTx0aGlzLnN0YWZmZ3JvdXBzLmxlbmd0aDsgbGluZSsrKSB7XG5cdHZhciB2b2ljZXMgPSB0aGlzLnN0YWZmZ3JvdXBzW2xpbmVdLnZvaWNlcztcblx0Zm9yICh2YXIgdm9pY2U9MDt2b2ljZTx2b2ljZXMubGVuZ3RoO3ZvaWNlKyspIHtcblx0ICAgIHZhciBlbGVtcyA9IHZvaWNlc1t2b2ljZV0uY2hpbGRyZW47XG5cdCAgICBmb3IgKHZhciBlbGVtPTA7IGVsZW08ZWxlbXMubGVuZ3RoOyBlbGVtKyspIHtcblx0XHQvLyBTaW5jZSB0aGUgdXNlciBjYW4gaGlnaGxpZ2h0IG1vcmUgdGhhbiBhbiBlbGVtZW50LCBvciBwYXJ0IG9mIGFuIGVsZW1lbnQsIGEgaGl0IGlzIGlmIGFueSBvZiB0aGUgZW5kcG9pbnRzXG5cdFx0Ly8gaXMgaW5zaWRlIHRoZSBvdGhlciByYW5nZS5cblx0XHR2YXIgZWxTdGFydCA9IGVsZW1zW2VsZW1dLmFiY2VsZW0uc3RhcnRDaGFyO1xuXHRcdHZhciBlbEVuZCA9IGVsZW1zW2VsZW1dLmFiY2VsZW0uZW5kQ2hhcjtcblx0XHRpZiAoKGVuZD5lbFN0YXJ0ICYmIHN0YXJ0PGVsRW5kKSB8fCAoKGVuZD09PXN0YXJ0KSAmJiBlbmQ9PT1lbEVuZCkpIHtcblx0XHQgICAgLy9cdFx0aWYgKGVsZW1zW2VsZW1dLmFiY2VsZW0uc3RhcnRDaGFyPj1zdGFydCAmJiBlbGVtc1tlbGVtXS5hYmNlbGVtLmVuZENoYXI8PWVuZCkge1xuXHRcdCAgICB0aGlzLnNlbGVjdGVkW3RoaXMuc2VsZWN0ZWQubGVuZ3RoXT1lbGVtc1tlbGVtXTtcblx0XHQgICAgZWxlbXNbZWxlbV0uaGlnaGxpZ2h0KCk7XG5cdFx0fVxuXHQgICAgfVxuXHR9XG4gICAgfVxufTtcblxuXG5mdW5jdGlvbiBjZW50ZXJXaG9sZVJlc3RzKHZvaWNlcykge1xuXHQvLyB3aG9sZSByZXN0cyBhcmUgYSBzcGVjaWFsIGNhc2U6IGlmIHRoZXkgYXJlIGJ5IHRoZW1zZWx2ZXMgaW4gYSBtZWFzdXJlLCB0aGVuIHRoZXkgc2hvdWxkIGJlIGNlbnRlcmVkLlxuXHQvLyAoSWYgdGhleSBhcmUgbm90IGJ5IHRoZW1zZWx2ZXMsIHRoYXQgaXMgcHJvYmFibHkgYSB1c2VyIGVycm9yLCBidXQgd2UnbGwganVzdCBjZW50ZXIgaXQgYmV0d2VlbiB0aGUgdHdvIGl0ZW1zIHRvIGVpdGhlciBzaWRlIG9mIGl0Lilcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCB2b2ljZXMubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgdm9pY2UgPSB2b2ljZXNbaV07XG5cdFx0Ly8gTG9vayB0aHJvdWdoIGFsbCBvZiB0aGUgZWxlbWVudHMgZXhjZXB0IGZvciB0aGUgZmlyc3QgYW5kIGxhc3QuIElmIHRoZSB3aG9sZSBub3RlIGFwcGVhcnMgdGhlcmUgdGhlbiB0aGVyZSBpc24ndCBhbnl0aGluZyB0byBjZW50ZXIgaXQgYmV0d2VlbiBhbnl3YXkuXG5cdFx0Zm9yICh2YXIgaiA9IDE7IGogPCB2b2ljZS5jaGlsZHJlbi5sZW5ndGgtMTsgaisrKSB7XG5cdFx0XHR2YXIgYWJzRWxlbSA9IHZvaWNlLmNoaWxkcmVuW2pdO1xuXHRcdFx0aWYgKGFic0VsZW0uYWJjZWxlbS5yZXN0ICYmIChhYnNFbGVtLmFiY2VsZW0ucmVzdC50eXBlID09PSAnd2hvbGUnIHx8IGFic0VsZW0uYWJjZWxlbS5yZXN0LnR5cGUgPT09ICdtdWx0aW1lYXN1cmUnKSkge1xuXHRcdFx0XHR2YXIgYmVmb3JlID0gdm9pY2UuY2hpbGRyZW5bai0xXTtcblx0XHRcdFx0dmFyIGFmdGVyID0gdm9pY2UuY2hpbGRyZW5baisxXTtcblx0XHRcdFx0dmFyIG1pZHBvaW50ID0gKGFmdGVyLnggLSBiZWZvcmUueCkgLyAyICsgYmVmb3JlLng7XG5cdFx0XHRcdGFic0VsZW0ueCA9IG1pZHBvaW50IC0gYWJzRWxlbS53IC8gMjtcblx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCBhYnNFbGVtLmNoaWxkcmVuLmxlbmd0aDsgaysrKVxuXHRcdFx0XHRcdGFic0VsZW0uY2hpbGRyZW5ba10ueCA9IGFic0VsZW0ueDtcblx0XHRcdH1cblx0XHR9XG5cdH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBFbmdyYXZlckNvbnRyb2xsZXI7XG4iLCJ2YXIgc3BhY2luZyA9IHJlcXVpcmUoJy4vYWJjX3NwYWNpbmcnKTtcblxuLyoqXG4gKiBHbHlwaHMgYW5kIHNvbWUgbWV0aG9kcyB0byBhZGp1c3QgZm9yIHRoZWlyIHggYW5kIHkgYmFzZWxpbmVcbiAqL1xudmFyIEdseXBocyA9IGZ1bmN0aW9uKCkge1xuXHRcInVzZSBzdHJpY3RcIjtcblx0dmFyIGdseXBocyA9XG5cdHsnMCc6e2Q6W1snTScsNC44MywtMTQuOTddLFsnYycsMC4zMywtMC4wMywxLjExLDAuMDAsMS40NywwLjA2XSxbJ2MnLDEuNjgsMC4zNiwyLjk3LDEuNTksMy43OCwzLjYwXSxbJ2MnLDEuMjAsMi45NywwLjgxLDYuOTYsLTAuOTAsOS4yN10sWydjJywtMC43OCwxLjA4LC0xLjcxLDEuNzEsLTIuOTEsMS45NV0sWydjJywtMC40NSwwLjA5LC0xLjMyLDAuMDksLTEuNzcsMC4wMF0sWydjJywtMC44MSwtMC4xOCwtMS40NywtMC41MSwtMi4wNywtMS4wMl0sWydjJywtMi4zNCwtMi4wNywtMy4xNSwtNi43MiwtMS43NCwtMTAuMjBdLFsnYycsMC44NywtMi4xNiwyLjI4LC0zLjQyLDQuMTQsLTMuNjZdLFsneiddLFsnbScsMS4xMSwwLjg3XSxbJ2MnLC0wLjIxLC0wLjA2LC0wLjY5LC0wLjA5LC0wLjg3LC0wLjA2XSxbJ2MnLC0wLjU0LDAuMTIsLTAuODcsMC40MiwtMS4xNywwLjk5XSxbJ2MnLC0wLjM2LDAuNjYsLTAuNTEsMS41NiwtMC42MCwzLjAwXSxbJ2MnLC0wLjAzLDAuNzUsLTAuMDMsNC41OSwwLjAwLDUuMzFdLFsnYycsMC4wOSwxLjUwLDAuMjcsMi40MCwwLjYwLDMuMDZdLFsnYycsMC4yNCwwLjQ4LDAuNTcsMC43OCwwLjk2LDAuOTBdLFsnYycsMC4yNywwLjA5LDAuNzgsMC4wOSwxLjA1LDAuMDBdLFsnYycsMC4zOSwtMC4xMiwwLjcyLC0wLjQyLDAuOTYsLTAuOTBdLFsnYycsMC4zMywtMC42NiwwLjUxLC0xLjU2LDAuNjAsLTMuMDZdLFsnYycsMC4wMywtMC43MiwwLjAzLC00LjU2LDAuMDAsLTUuMzFdLFsnYycsLTAuMDksLTEuNDcsLTAuMjcsLTIuMzcsLTAuNjAsLTMuMDNdLFsnYycsLTAuMjQsLTAuNDgsLTAuNTQsLTAuNzgsLTAuOTMsLTAuOTBdLFsneiddXSx3OjEwLjc4LGg6MTQuOTU5fSxcblx0XHQnMSc6e2Q6W1snTScsMy4zMCwtMTUuMDZdLFsnYycsMC4wNiwtMC4wNiwwLjIxLC0wLjAzLDAuNjYsMC4xNV0sWydjJywwLjgxLDAuMzksMS4wOCwwLjM5LDEuODMsMC4wM10sWydjJywwLjIxLC0wLjA5LDAuMzksLTAuMTUsMC40MiwtMC4xNV0sWydjJywwLjEyLDAuMDAsMC4yMSwwLjA5LDAuMjcsMC4yMV0sWydjJywwLjA2LDAuMTIsMC4wNiwwLjMzLDAuMDYsNS45NF0sWydjJywwLjAwLDMuOTMsMC4wMCw1Ljg1LDAuMDMsNi4wM10sWydjJywwLjA2LDAuMzYsMC4xNSwwLjY5LDAuMjcsMC45Nl0sWydjJywwLjM2LDAuNzUsMC45MywxLjE3LDEuNjgsMS4yNl0sWydjJywwLjMwLDAuMDMsMC4zOSwwLjA5LDAuMzksMC4zMF0sWydjJywwLjAwLDAuMTUsLTAuMDMsMC4xOCwtMC4wOSwwLjI0XSxbJ2MnLC0wLjA2LDAuMDYsLTAuMDksMC4wNiwtMC40OCwwLjA2XSxbJ2MnLC0wLjQyLDAuMDAsLTAuNjksLTAuMDMsLTIuMTAsLTAuMjRdLFsnYycsLTAuOTAsLTAuMTUsLTEuNzcsLTAuMTUsLTIuNjcsMC4wMF0sWydjJywtMS40MSwwLjIxLC0xLjY4LDAuMjQsLTIuMTAsMC4yNF0sWydjJywtMC4zOSwwLjAwLC0wLjQyLDAuMDAsLTAuNDgsLTAuMDZdLFsnYycsLTAuMDYsLTAuMDYsLTAuMDYsLTAuMDksLTAuMDYsLTAuMjRdLFsnYycsMC4wMCwtMC4yMSwwLjA2LC0wLjI3LDAuMzYsLTAuMzBdLFsnYycsMC43NSwtMC4wOSwxLjMyLC0wLjUxLDEuNjgsLTEuMjZdLFsnYycsMC4xMiwtMC4yNywwLjIxLC0wLjYwLDAuMjcsLTAuOTZdLFsnYycsMC4wMywtMC4xOCwwLjAzLC0xLjU5LDAuMDMsLTQuMjldLFsnYycsMC4wMCwtMy44NywwLjAwLC00LjA1LC0wLjA2LC00LjE0XSxbJ2MnLC0wLjA5LC0wLjE1LC0wLjE4LC0wLjI0LC0wLjM5LC0wLjI0XSxbJ2MnLC0wLjEyLDAuMDAsLTAuMTUsMC4wMywtMC4yMSwwLjA2XSxbJ2MnLC0wLjAzLDAuMDYsLTAuNDUsMC45OSwtMC45NiwyLjEzXSxbJ2MnLC0wLjQ4LDEuMTQsLTAuOTAsMi4xMCwtMC45MywyLjE2XSxbJ2MnLC0wLjA2LDAuMTUsLTAuMjEsMC4yNCwtMC4zMywwLjI0XSxbJ2MnLC0wLjI0LDAuMDAsLTAuNDIsLTAuMTgsLTAuNDIsLTAuMzldLFsnYycsMC4wMCwtMC4wNiwzLjI3LC03LjYyLDMuMzMsLTcuNzRdLFsneiddXSx3OjguOTQsaDoxNS4wNTh9LFxuXHRcdCcyJzp7ZDpbWydNJyw0LjIzLC0xNC45N10sWydjJywwLjU3LC0wLjA2LDEuNjgsMC4wMCwyLjM0LDAuMThdLFsnYycsMC42OSwwLjE4LDEuNTAsMC41NCwyLjAxLDAuOTBdLFsnYycsMS4zNSwwLjk2LDEuOTUsMi4yNSwxLjc3LDMuODFdLFsnYycsLTAuMTUsMS4zNSwtMC42NiwyLjM0LC0xLjY4LDMuMTVdLFsnYycsLTAuNjAsMC40OCwtMS40NCwwLjkzLC0zLjEyLDEuNjVdLFsnYycsLTEuMzIsMC41NywtMS44MCwwLjgxLC0yLjM3LDEuMTRdLFsnYycsLTAuNTcsMC4zMywtMC41NywwLjMzLC0wLjI0LDAuMjddLFsnYycsMC4zOSwtMC4wOSwxLjI2LC0wLjA5LDEuNjgsMC4wMF0sWydjJywwLjcyLDAuMTUsMS40MSwwLjQ1LDIuMTAsMC45MF0sWydjJywwLjk5LDAuNjMsMS44NiwwLjg3LDIuNTUsMC43NV0sWydjJywwLjI0LC0wLjA2LDAuNDIsLTAuMTUsMC41NywtMC4zMF0sWydjJywwLjEyLC0wLjA5LDAuMzAsLTAuNDIsMC4zMCwtMC41MV0sWydjJywwLjAwLC0wLjA5LDAuMTIsLTAuMjEsMC4yNCwtMC4yNF0sWydjJywwLjE4LC0wLjAzLDAuMzksMC4xMiwwLjM5LDAuMzBdLFsnYycsMC4wMCwwLjEyLC0wLjE1LDAuNTcsLTAuMzAsMC44N10sWydjJywtMC41NCwxLjAyLC0xLjU2LDEuNzQsLTIuNzksMi4wMV0sWydjJywtMC40MiwwLjA5LC0xLjIzLDAuMDksLTEuNjIsMC4wM10sWydjJywtMC44MSwtMC4xOCwtMS4zMiwtMC40NSwtMi4wMSwtMS4xMV0sWydjJywtMC40NSwtMC40NSwtMC42MywtMC41NywtMC45NiwtMC42OV0sWydjJywtMC44NCwtMC4yNywtMS44OSwwLjEyLC0yLjI1LDAuOTBdLFsnYycsLTAuMTIsMC4yMSwtMC4yMSwwLjU0LC0wLjIxLDAuNzJdLFsnYycsMC4wMCwwLjEyLC0wLjEyLDAuMjEsLTAuMjcsMC4yNF0sWydjJywtMC4xNSwwLjAwLC0wLjI3LC0wLjAzLC0wLjMzLC0wLjE1XSxbJ2MnLC0wLjA5LC0wLjIxLDAuMDksLTEuMDgsMC4zMywtMS43MV0sWydjJywwLjI0LC0wLjY2LDAuNjYsLTEuMjYsMS4yOSwtMS44OV0sWydjJywwLjQ1LC0wLjQ1LDAuOTAsLTAuODEsMS45MiwtMS41Nl0sWydjJywxLjI5LC0wLjkzLDEuODksLTEuNDQsMi4zNCwtMS45OF0sWydjJywwLjg3LC0xLjA1LDEuMjYsLTIuMTksMS4yMCwtMy42M10sWydjJywtMC4wNiwtMS4yOSwtMC4zOSwtMi4zMSwtMC45NiwtMi45MV0sWydjJywtMC4zNiwtMC4zMywtMC43MiwtMC41MSwtMS4xNywtMC41NF0sWydjJywtMC44NCwtMC4wMywtMS41MywwLjQyLC0xLjU5LDEuMDVdLFsnYycsLTAuMDMsMC4zMywwLjEyLDAuNjAsMC41NywxLjE0XSxbJ2MnLDAuNDUsMC41NCwwLjU0LDAuODcsMC40MiwxLjQxXSxbJ2MnLC0wLjE1LDAuNjMsLTAuNTQsMS4xMSwtMS4wOCwxLjM4XSxbJ2MnLC0wLjYzLDAuMzMsLTEuMjAsMC4zMywtMS44MywwLjAwXSxbJ2MnLC0wLjI0LC0wLjEyLC0wLjMzLC0wLjE4LC0wLjU0LC0wLjM5XSxbJ2MnLC0wLjE4LC0wLjE4LC0wLjI3LC0wLjMwLC0wLjM2LC0wLjUxXSxbJ2MnLC0wLjI0LC0wLjQ1LC0wLjI3LC0wLjg0LC0wLjIxLC0xLjM4XSxbJ2MnLDAuMTIsLTAuNzUsMC40NSwtMS40MSwxLjAyLC0xLjk4XSxbJ2MnLDAuNzIsLTAuNzIsMS43NCwtMS4xNywyLjg1LC0xLjMyXSxbJ3onXV0sdzoxMC43NjQsaDoxNC45N30sXG5cdFx0JzMnOntkOltbJ00nLDMuNzgsLTE0Ljk3XSxbJ2MnLDAuMzAsLTAuMDMsMS40MSwwLjAwLDEuODMsMC4wNl0sWydjJywyLjIyLDAuMzAsMy41MSwxLjMyLDMuNzIsMi45MV0sWydjJywwLjAzLDAuMzMsMC4wMywxLjI2LC0wLjAzLDEuNjVdLFsnYycsLTAuMTIsMC44NCwtMC40OCwxLjQ3LC0xLjA1LDEuNzddLFsnYycsLTAuMjcsMC4xNSwtMC4zNiwwLjI0LC0wLjQ1LDAuMzldLFsnYycsLTAuMDksMC4yMSwtMC4wOSwwLjM2LDAuMDAsMC41N10sWydjJywwLjA5LDAuMTUsMC4xOCwwLjI0LDAuNTEsMC4zOV0sWydjJywwLjc1LDAuNDIsMS4yMywxLjE0LDEuNDEsMi4xM10sWydjJywwLjA2LDAuNDIsMC4wNiwxLjM1LDAuMDAsMS43MV0sWydjJywtMC4xOCwwLjgxLC0wLjQ4LDEuMzgsLTEuMDIsMS45NV0sWydjJywtMC43NSwwLjcyLC0xLjgwLDEuMjAsLTMuMTgsMS4zOF0sWydjJywtMC40MiwwLjA2LC0xLjU2LDAuMDYsLTEuOTUsMC4wMF0sWydjJywtMS44OSwtMC4zMywtMy4xOCwtMS4yOSwtMy41MSwtMi42NF0sWydjJywtMC4wMywtMC4xMiwtMC4wMywtMC4zMywtMC4wMywtMC42MF0sWydjJywwLjAwLC0wLjM2LDAuMDAsLTAuNDIsMC4wNiwtMC42M10sWydjJywwLjEyLC0wLjMwLDAuMjcsLTAuNTEsMC41MSwtMC43NV0sWydjJywwLjI0LC0wLjI0LDAuNDUsLTAuMzksMC43NSwtMC41MV0sWydjJywwLjIxLC0wLjA2LDAuMjcsLTAuMDYsMC42MCwtMC4wNl0sWydjJywwLjMzLDAuMDAsMC4zOSwwLjAwLDAuNjAsMC4wNl0sWydjJywwLjMwLDAuMTIsMC41MSwwLjI3LDAuNzUsMC41MV0sWydjJywwLjM2LDAuMzMsMC41NywwLjc1LDAuNjAsMS4yMF0sWydjJywwLjAwLDAuMjEsMC4wMCwwLjI3LC0wLjA2LDAuNDJdLFsnYycsLTAuMDksMC4xOCwtMC4xMiwwLjI0LC0wLjU0LDAuNTRdLFsnYycsLTAuNTEsMC4zNiwtMC42MywwLjU0LC0wLjYwLDAuODddLFsnYycsMC4wNiwwLjU0LDAuNTQsMC45MCwxLjM4LDAuOTldLFsnYycsMC4zNiwwLjA2LDAuNzIsMC4wMywwLjk2LC0wLjA2XSxbJ2MnLDAuODEsLTAuMjcsMS4yOSwtMS4yMywxLjQ0LC0yLjc5XSxbJ2MnLDAuMDMsLTAuNDUsMC4wMywtMS45NSwtMC4wMywtMi4zN10sWydjJywtMC4wOSwtMC43NSwtMC4zMywtMS4yMywtMC43NSwtMS40NF0sWydjJywtMC4zMywtMC4xOCwtMC40NSwtMC4xOCwtMS45OCwtMC4xOF0sWydjJywtMS4zNSwwLjAwLC0xLjQxLDAuMDAsLTEuNTAsLTAuMDZdLFsnYycsLTAuMTgsLTAuMTIsLTAuMjQsLTAuMzksLTAuMTIsLTAuNjBdLFsnYycsMC4xMiwtMC4xNSwwLjE1LC0wLjE1LDEuNjgsLTAuMTVdLFsnYycsMS41MCwwLjAwLDEuNjIsMC4wMCwxLjg5LC0wLjE1XSxbJ2MnLDAuMTgsLTAuMDksMC40MiwtMC4zNiwwLjU0LC0wLjU3XSxbJ2MnLDAuMTgsLTAuNDIsMC4yNywtMC45MCwwLjMwLC0xLjk1XSxbJ2MnLDAuMDMsLTEuMjAsLTAuMDYsLTEuODAsLTAuMzYsLTIuMzddLFsnYycsLTAuMjQsLTAuNDgsLTAuNjMsLTAuODEsLTEuMTQsLTAuOTZdLFsnYycsLTAuMzAsLTAuMDYsLTEuMDgsLTAuMDYsLTEuMzgsMC4wM10sWydjJywtMC42MCwwLjE1LC0wLjkwLDAuNDIsLTAuOTYsMC44NF0sWydjJywtMC4wMywwLjMwLDAuMDYsMC40NSwwLjYzLDAuODRdLFsnYycsMC4zMywwLjI0LDAuNDIsMC4zOSwwLjQ1LDAuNjNdLFsnYycsMC4wMywwLjcyLC0wLjU3LDEuNTAsLTEuMzIsMS42NV0sWydjJywtMS4wNSwwLjI3LC0yLjEwLC0wLjU3LC0yLjEwLC0xLjY1XSxbJ2MnLDAuMDAsLTAuNDUsMC4xNSwtMC45NiwwLjM5LC0xLjM4XSxbJ2MnLDAuMTIsLTAuMjEsMC41NCwtMC42MywwLjgxLC0wLjgxXSxbJ2MnLDAuNTcsLTAuNDIsMS4zOCwtMC42OSwyLjI1LC0wLjgxXSxbJ3onXV0sdzo5LjczNSxoOjE0Ljk2N30sXG5cdFx0JzQnOntkOltbJ00nLDguNjQsLTE0Ljk0XSxbJ2MnLDAuMjcsLTAuMDksMC40MiwtMC4xMiwwLjU0LC0wLjAzXSxbJ2MnLDAuMDksMC4wNiwwLjE1LDAuMjEsMC4xNSwwLjMwXSxbJ2MnLC0wLjAzLDAuMDYsLTEuOTIsMi4zMSwtNC4yMyw1LjA0XSxbJ2MnLC0yLjMxLDIuNzMsLTQuMjMsNC45OCwtNC4yNiw1LjAxXSxbJ2MnLC0wLjAzLDAuMDYsMC4xMiwwLjA2LDIuNTUsMC4wNl0sWydsJywyLjYxLDAuMDBdLFsnbCcsMC4wMCwtMi4zN10sWydjJywwLjAwLC0yLjE5LDAuMDMsLTIuMzcsMC4wNiwtMi40Nl0sWydjJywwLjAzLC0wLjA2LDAuMjEsLTAuMTgsMC41NywtMC40Ml0sWydjJywxLjA4LC0wLjcyLDEuMzgsLTEuMDgsMS44NiwtMi4xNl0sWydjJywwLjEyLC0wLjMwLDAuMjQsLTAuNTQsMC4yNywtMC41N10sWydjJywwLjEyLC0wLjEyLDAuMzksLTAuMDYsMC40NSwwLjEyXSxbJ2MnLDAuMDYsMC4wOSwwLjA2LDAuNTcsMC4wNiwzLjk2XSxbJ2wnLDAuMDAsMy45MF0sWydsJywxLjA4LDAuMDBdLFsnYycsMS4wNSwwLjAwLDEuMTEsMC4wMCwxLjIwLDAuMDZdLFsnYycsMC4yNCwwLjE1LDAuMjQsMC41NCwwLjAwLDAuNjldLFsnYycsLTAuMDksMC4wNiwtMC4xNSwwLjA2LC0xLjIwLDAuMDZdLFsnbCcsLTEuMDgsMC4wMF0sWydsJywwLjAwLDAuMzNdLFsnYycsMC4wMCwwLjU3LDAuMDksMS4xMSwwLjMwLDEuNTNdLFsnYycsMC4zNiwwLjc1LDAuOTMsMS4xNywxLjY4LDEuMjZdLFsnYycsMC4zMCwwLjAzLDAuMzksMC4wOSwwLjM5LDAuMzBdLFsnYycsMC4wMCwwLjE1LC0wLjAzLDAuMTgsLTAuMDksMC4yNF0sWydjJywtMC4wNiwwLjA2LC0wLjA5LDAuMDYsLTAuNDgsMC4wNl0sWydjJywtMC40MiwwLjAwLC0wLjY5LC0wLjAzLC0yLjEwLC0wLjI0XSxbJ2MnLC0wLjkwLC0wLjE1LC0xLjc3LC0wLjE1LC0yLjY3LDAuMDBdLFsnYycsLTEuNDEsMC4yMSwtMS42OCwwLjI0LC0yLjEwLDAuMjRdLFsnYycsLTAuMzksMC4wMCwtMC40MiwwLjAwLC0wLjQ4LC0wLjA2XSxbJ2MnLC0wLjA2LC0wLjA2LC0wLjA2LC0wLjA5LC0wLjA2LC0wLjI0XSxbJ2MnLDAuMDAsLTAuMjEsMC4wNiwtMC4yNywwLjM2LC0wLjMwXSxbJ2MnLDAuNzUsLTAuMDksMS4zMiwtMC41MSwxLjY4LC0xLjI2XSxbJ2MnLDAuMjEsLTAuNDIsMC4zMCwtMC45NiwwLjMwLC0xLjUzXSxbJ2wnLDAuMDAsLTAuMzNdLFsnbCcsLTIuNzAsMC4wMF0sWydjJywtMi45MSwwLjAwLC0yLjg1LDAuMDAsLTMuMDksLTAuMTVdLFsnYycsLTAuMTgsLTAuMTIsLTAuMzAsLTAuMzksLTAuMjcsLTAuNTRdLFsnYycsMC4wMywtMC4wNiwwLjE4LC0wLjI0LDAuMzMsLTAuNDVdLFsnYycsMC43NSwtMC45MCwxLjU5LC0yLjA3LDIuMTMsLTMuMDNdLFsnYycsMC4zMywtMC41NCwwLjg0LC0xLjYyLDEuMDUsLTIuMTZdLFsnYycsMC41NywtMS40MSwwLjg0LC0yLjY0LDAuOTAsLTQuMDVdLFsnYycsMC4wMywtMC42MywwLjA2LC0wLjcyLDAuMjQsLTAuODFdLFsnbCcsMC4xMiwtMC4wNl0sWydsJywwLjQ1LDAuMTJdLFsnYycsMC42NiwwLjE4LDEuMDIsMC4yNCwxLjQ3LDAuMjddLFsnYycsMC42MCwwLjAzLDEuMjMsLTAuMDksMi4wMSwtMC4zM10sWyd6J11dLHc6MTEuNzk1LGg6MTQuOTk0fSxcblx0XHQnNSc6e2Q6W1snTScsMS4wMiwtMTQuOTRdLFsnYycsMC4xMiwtMC4wOSwwLjAzLC0wLjA5LDEuMDgsMC4wNl0sWydjJywyLjQ5LDAuMzYsNC4zNSwwLjM2LDYuOTYsLTAuMDZdLFsnYycsMC41NywtMC4wOSwwLjY2LC0wLjA2LDAuODEsMC4wNl0sWydjJywwLjE1LDAuMTgsMC4xMiwwLjI0LC0wLjE1LDAuNTFdLFsnYycsLTEuMjksMS4yNiwtMy4yNCwyLjA0LC01LjU4LDIuMzFdLFsnYycsLTAuNjAsMC4wOSwtMS4yMCwwLjEyLC0xLjcxLDAuMTJdLFsnYycsLTAuMzksMC4wMCwtMC40NSwwLjAwLC0wLjU3LDAuMDZdLFsnYycsLTAuMDksMC4wNiwtMC4xNSwwLjEyLC0wLjIxLDAuMjFdLFsnbCcsLTAuMDYsMC4xMl0sWydsJywwLjAwLDEuNjVdLFsnbCcsMC4wMCwxLjY1XSxbJ2wnLDAuMjEsLTAuMjFdLFsnYycsMC42NiwtMC41NywxLjQxLC0wLjk2LDIuMTksLTEuMTRdLFsnYycsMC4zMywtMC4wNiwxLjQxLC0wLjA2LDEuOTUsMC4wMF0sWydjJywyLjYxLDAuMzYsNC4wMiwxLjc0LDQuMjYsNC4xNF0sWydjJywwLjAzLDAuNDUsMC4wMywxLjA4LC0wLjAzLDEuNDRdLFsnYycsLTAuMTgsMS4wMiwtMC43OCwyLjAxLC0xLjU5LDIuNzBdLFsnYycsLTAuNzIsMC41NywtMS42MiwxLjAyLC0yLjQ5LDEuMjBdLFsnYycsLTEuMzgsMC4yNywtMy4wMywwLjA2LC00LjIwLC0wLjU0XSxbJ2MnLC0xLjA4LC0wLjU0LC0xLjcxLC0xLjMyLC0xLjg2LC0yLjI4XSxbJ2MnLC0wLjA5LC0wLjY5LDAuMDksLTEuMjksMC41NywtMS43NF0sWydjJywwLjI0LC0wLjI0LDAuNDUsLTAuMzksMC43NSwtMC41MV0sWydjJywwLjIxLC0wLjA2LDAuMjcsLTAuMDYsMC42MCwtMC4wNl0sWydjJywwLjMzLDAuMDAsMC4zOSwwLjAwLDAuNjAsMC4wNl0sWydjJywwLjMwLDAuMTIsMC41MSwwLjI3LDAuNzUsMC41MV0sWydjJywwLjM2LDAuMzMsMC41NywwLjc1LDAuNjAsMS4yMF0sWydjJywwLjAwLDAuMjEsMC4wMCwwLjI3LC0wLjA2LDAuNDJdLFsnYycsLTAuMDksMC4xOCwtMC4xMiwwLjI0LC0wLjU0LDAuNTRdLFsnYycsLTAuMTgsMC4xMiwtMC4zNiwwLjMwLC0wLjQyLDAuMzNdLFsnYycsLTAuMzYsMC40MiwtMC4xOCwwLjk5LDAuMzYsMS4yNl0sWydjJywwLjUxLDAuMjcsMS40NywwLjM2LDIuMDEsMC4yN10sWydjJywwLjkzLC0wLjIxLDEuNDcsLTEuMTcsMS42NSwtMi45MV0sWydjJywwLjA2LC0wLjQ1LDAuMDYsLTEuODksMC4wMCwtMi4zMV0sWydjJywtMC4xNSwtMS4yMCwtMC41MSwtMi4xMCwtMS4wNSwtMi41NV0sWydjJywtMC4yMSwtMC4xOCwtMC41NCwtMC4zNiwtMC44MSwtMC4zOV0sWydjJywtMC4zMCwtMC4wNiwtMC44NCwtMC4wMywtMS4yNiwwLjA2XSxbJ2MnLC0wLjkzLDAuMTgsLTEuNjUsMC42MCwtMi4xNiwxLjIwXSxbJ2MnLC0wLjE1LDAuMjEsLTAuMjcsMC4zMCwtMC4zOSwwLjMwXSxbJ2MnLC0wLjE1LDAuMDAsLTAuMzAsLTAuMDksLTAuMzYsLTAuMThdLFsnYycsLTAuMDYsLTAuMDksLTAuMDYsLTAuMTUsLTAuMDYsLTMuNjZdLFsnYycsMC4wMCwtMy4zOSwwLjAwLC0zLjU3LDAuMDYsLTMuNjZdLFsnYycsMC4wMywtMC4wNiwwLjA5LC0wLjE1LDAuMTUsLTAuMThdLFsneiddXSx3OjEwLjIxMixoOjE0Ljk5N30sXG5cdFx0JzYnOntkOltbJ00nLDQuOTgsLTE0Ljk3XSxbJ2MnLDAuMzYsLTAuMDMsMS4yMCwwLjAwLDEuNTksMC4wNl0sWydjJywwLjkwLDAuMTUsMS42OCwwLjUxLDIuMjUsMS4wNV0sWydjJywwLjU3LDAuNTEsMC44NywxLjIzLDAuODQsMS45OF0sWydjJywtMC4wMywwLjUxLC0wLjIxLDAuOTAsLTAuNjAsMS4yNl0sWydjJywtMC4yNCwwLjI0LC0wLjQ1LDAuMzksLTAuNzUsMC41MV0sWydjJywtMC4yMSwwLjA2LC0wLjI3LDAuMDYsLTAuNjAsMC4wNl0sWydjJywtMC4zMywwLjAwLC0wLjM5LDAuMDAsLTAuNjAsLTAuMDZdLFsnYycsLTAuMzAsLTAuMTIsLTAuNTEsLTAuMjcsLTAuNzUsLTAuNTFdLFsnYycsLTAuMzksLTAuMzYsLTAuNTcsLTAuNzgsLTAuNTcsLTEuMjZdLFsnYycsMC4wMCwtMC4yNywwLjAwLC0wLjMwLDAuMDksLTAuNDJdLFsnYycsMC4wMywtMC4wOSwwLjE4LC0wLjIxLDAuMzAsLTAuMzBdLFsnYycsMC4xMiwtMC4wOSwwLjMwLC0wLjIxLDAuMzksLTAuMjddLFsnYycsMC4wOSwtMC4wNiwwLjIxLC0wLjE4LDAuMjcsLTAuMjRdLFsnYycsMC4wNiwtMC4xMiwwLjA5LC0wLjE1LDAuMDksLTAuMzNdLFsnYycsMC4wMCwtMC4xOCwtMC4wMywtMC4yNCwtMC4wOSwtMC4zNl0sWydjJywtMC4yNCwtMC4zOSwtMC43NSwtMC42MCwtMS4zOCwtMC41N10sWydjJywtMC41NCwwLjAzLC0wLjkwLDAuMTgsLTEuMjMsMC40OF0sWydjJywtMC44MSwwLjcyLC0xLjA4LDIuMTYsLTAuOTYsNS4zN10sWydsJywwLjAwLDAuNjNdLFsnbCcsMC4zMCwtMC4xMl0sWydjJywwLjc4LC0wLjI3LDEuMjksLTAuMzMsMi4xMCwtMC4yN10sWydjJywxLjQ3LDAuMTIsMi40OSwwLjU0LDMuMjcsMS4yOV0sWydjJywwLjQ4LDAuNTEsMC44MSwxLjExLDAuOTYsMS44OV0sWydjJywwLjA2LDAuMjcsMC4wNiwwLjQyLDAuMDYsMC45M10sWydjJywwLjAwLDAuNTQsMC4wMCwwLjY5LC0wLjA2LDAuOTZdLFsnYycsLTAuMTUsMC43OCwtMC40OCwxLjM4LC0wLjk2LDEuODldLFsnYycsLTAuNTQsMC41MSwtMS4xNywwLjg3LC0xLjk4LDEuMDhdLFsnYycsLTEuMTQsMC4zMCwtMi40MCwwLjMzLC0zLjI0LDAuMDNdLFsnYycsLTEuNTAsLTAuNDgsLTIuNjQsLTEuODksLTMuMjcsLTQuMDJdLFsnYycsLTAuMzYsLTEuMjMsLTAuNTEsLTIuODIsLTAuNDIsLTQuMDhdLFsnYycsMC4zMCwtMy42NiwyLjI4LC02LjMwLDQuOTUsLTYuNjZdLFsneiddLFsnbScsMC42Niw3LjQxXSxbJ2MnLC0wLjI3LC0wLjA5LC0wLjgxLC0wLjEyLC0xLjA4LC0wLjA2XSxbJ2MnLC0wLjcyLDAuMTgsLTEuMDgsMC42OSwtMS4yMywxLjcxXSxbJ2MnLC0wLjA2LDAuNTQsLTAuMDYsMy4wMCwwLjAwLDMuNTRdLFsnYycsMC4xOCwxLjI2LDAuNzIsMS43NywxLjgwLDEuNzRdLFsnYycsMC4zOSwtMC4wMywwLjYzLC0wLjA5LDAuOTAsLTAuMjddLFsnYycsMC42NiwtMC40MiwwLjkwLC0xLjMyLDAuOTAsLTMuMjRdLFsnYycsMC4wMCwtMi4yMiwtMC4zNiwtMy4xMiwtMS4yOSwtMy40Ml0sWyd6J11dLHc6OS45NTYsaDoxNC45ODJ9LFxuXHRcdCc3Jzp7ZDpbWydNJywwLjIxLC0xNC45N10sWydjJywwLjIxLC0wLjA2LDAuNDUsMC4wMCwwLjU0LDAuMTVdLFsnYycsMC4wNiwwLjA5LDAuMDYsMC4xNSwwLjA2LDAuMzldLFsnYycsMC4wMCwwLjI0LDAuMDAsMC4zMywwLjA2LDAuNDJdLFsnYycsMC4wNiwwLjEyLDAuMjEsMC4yNCwwLjI3LDAuMjRdLFsnYycsMC4wMywwLjAwLDAuMTIsLTAuMTIsMC4yNCwtMC4yMV0sWydjJywwLjk2LC0xLjIwLDIuNTgsLTEuMzUsMy45OSwtMC40Ml0sWydjJywwLjE1LDAuMTIsMC40MiwwLjMwLDAuNTQsMC40NV0sWydjJywwLjQ4LDAuMzksMC44MSwwLjU3LDEuMjksMC42MF0sWydjJywwLjY5LDAuMDMsMS41MCwtMC4zMCwyLjEzLC0wLjg3XSxbJ2MnLDAuMDksLTAuMDksMC4yNywtMC4zMCwwLjM5LC0wLjQ1XSxbJ2MnLDAuMTIsLTAuMTUsMC4yNCwtMC4yNywwLjMwLC0wLjMwXSxbJ2MnLDAuMTgsLTAuMDYsMC4zOSwwLjAzLDAuNTEsMC4yMV0sWydjJywwLjA2LDAuMTgsMC4wNiwwLjI0LC0wLjI3LDAuNzJdLFsnYycsLTAuMTgsMC4yNCwtMC41NCwwLjc4LC0wLjc4LDEuMTddLFsnYycsLTIuMzcsMy41NCwtMy41NCw2LjI3LC0zLjg3LDkuMDBdLFsnYycsLTAuMDMsMC4zMywtMC4wMywwLjY2LC0wLjAzLDEuMjZdLFsnYycsMC4wMCwwLjkwLDAuMDAsMS4wOCwwLjE1LDEuODldLFsnYycsMC4wNiwwLjQ1LDAuMDYsMC40OCwwLjAzLDAuNjBdLFsnYycsLTAuMDYsMC4wOSwtMC4yMSwwLjIxLC0wLjMwLDAuMjFdLFsnYycsLTAuMDMsMC4wMCwtMC4yNywtMC4wNiwtMC41NCwtMC4xNV0sWydjJywtMC44NCwtMC4yNywtMS4xMSwtMC4zMCwtMS42NSwtMC4zMF0sWydjJywtMC41NywwLjAwLC0wLjg0LDAuMDMsLTEuNTYsMC4yN10sWydjJywtMC42MCwwLjE4LC0wLjY5LDAuMjEsLTAuODEsMC4xNV0sWydjJywtMC4xMiwtMC4wNiwtMC4yMSwtMC4xOCwtMC4yMSwtMC4zMF0sWydjJywwLjAwLC0wLjE1LDAuNjAsLTEuNDQsMS4yMCwtMi42MV0sWydjJywxLjE0LC0yLjIyLDIuNzMsLTQuNjgsNS4xMCwtOC4wMV0sWydjJywwLjIxLC0wLjI3LDAuMzYsLTAuNDgsMC4zMywtMC40OF0sWydjJywwLjAwLDAuMDAsLTAuMTIsMC4wNiwtMC4yNywwLjEyXSxbJ2MnLC0wLjU0LDAuMzAsLTAuOTksMC4zOSwtMS41NiwwLjM5XSxbJ2MnLC0wLjc1LDAuMDMsLTEuMjAsLTAuMTgsLTEuODMsLTAuNzVdLFsnYycsLTAuOTksLTAuOTAsLTEuODMsLTEuMTcsLTIuMzEsLTAuNzJdLFsnYycsLTAuMTgsMC4xNSwtMC4zNiwwLjUxLC0wLjQ1LDAuODRdLFsnYycsLTAuMDYsMC4yNCwtMC4wNiwwLjMzLC0wLjA5LDEuOThdLFsnYycsMC4wMCwxLjYyLC0wLjAzLDEuNzQsLTAuMDYsMS44MF0sWydjJywtMC4xNSwwLjI0LC0wLjU0LDAuMjQsLTAuNjksMC4wMF0sWydjJywtMC4wNiwtMC4wOSwtMC4wNiwtMC4xNSwtMC4wNiwtMy41N10sWydjJywwLjAwLC0zLjQyLDAuMDAsLTMuNDgsMC4wNiwtMy41N10sWydjJywwLjAzLC0wLjA2LDAuMDksLTAuMTIsMC4xNSwtMC4xNV0sWyd6J11dLHc6MTAuNTYxLGg6MTUuMDkzfSxcblx0XHQnOCc6e2Q6W1snTScsNC45OCwtMTQuOTddLFsnYycsMC4zMywtMC4wMywxLjAyLC0wLjAzLDEuMzIsMC4wMF0sWydjJywxLjMyLDAuMTIsMi40OSwwLjYwLDMuMjEsMS4zMl0sWydjJywwLjM5LDAuMzksMC42NiwwLjgxLDAuNzgsMS4yOV0sWydjJywwLjA5LDAuMzYsMC4wOSwxLjA4LDAuMDAsMS40NF0sWydjJywtMC4yMSwwLjg0LC0wLjY2LDEuNTksLTEuNTksMi41NV0sWydsJywtMC4zMCwwLjMwXSxbJ2wnLDAuMjcsMC4xOF0sWydjJywxLjQ3LDAuOTMsMi4zMSwyLjMxLDIuMjUsMy43NV0sWydjJywtMC4wMywwLjc1LC0wLjI0LDEuMzUsLTAuNjMsMS45NV0sWydjJywtMC40NSwwLjY2LC0xLjAyLDEuMTQsLTEuODMsMS41M10sWydjJywtMS44MCwwLjg3LC00LjIwLDAuODcsLTYuMDAsMC4wM10sWydjJywtMS42MiwtMC43OCwtMi41MiwtMi4xNiwtMi40NiwtMy42Nl0sWydjJywwLjA2LC0wLjk5LDAuNTQsLTEuNzcsMS44MCwtMi45N10sWydjJywwLjU0LC0wLjUxLDAuNTQsLTAuNTQsMC40OCwtMC41N10sWydjJywtMC4zOSwtMC4yNywtMC45NiwtMC43OCwtMS4yMCwtMS4xNF0sWydjJywtMC43NSwtMS4xMSwtMC44NywtMi40MCwtMC4zMCwtMy42MF0sWydjJywwLjY5LC0xLjM1LDIuMjUsLTIuMjUsNC4yMCwtMi40MF0sWyd6J10sWydtJywxLjUzLDAuNjldLFsnYycsLTAuNDIsLTAuMDksLTEuMTEsLTAuMTIsLTEuMzgsLTAuMDZdLFsnYycsLTAuMzAsMC4wNiwtMC42MCwwLjE4LC0wLjgxLDAuMzBdLFsnYycsLTAuMjEsMC4xMiwtMC42MCwwLjUxLC0wLjcyLDAuNzJdLFsnYycsLTAuNTEsMC44NywtMC40MiwxLjg5LDAuMjEsMi41Ml0sWydjJywwLjIxLDAuMjEsMC4zNiwwLjMwLDEuOTUsMS4yM10sWydjJywwLjk2LDAuNTQsMS43NCwwLjk5LDEuNzcsMS4wMl0sWydjJywwLjA5LDAuMDAsMC42MywtMC42MCwwLjk5LC0xLjExXSxbJ2MnLDAuMjEsLTAuMzYsMC40OCwtMC44NywwLjU3LC0xLjIzXSxbJ2MnLDAuMDYsLTAuMjQsMC4wNiwtMC4zNiwwLjA2LC0wLjcyXSxbJ2MnLDAuMDAsLTAuNDUsLTAuMDMsLTAuNjYsLTAuMTUsLTAuOTldLFsnYycsLTAuMzksLTAuODEsLTEuMjksLTEuNDQsLTIuNDksLTEuNjhdLFsneiddLFsnbScsLTEuNDQsOC4wN10sWydsJywtMS44OSwtMS4wOF0sWydjJywtMC4wMywwLjAwLC0wLjE4LDAuMTUsLTAuMzksMC4zM10sWydjJywtMS4yMCwxLjA4LC0xLjY1LDEuOTUsLTEuNTksMy4wMF0sWydjJywwLjA5LDEuNTksMS4zNSwyLjg1LDMuMjEsMy4yNF0sWydjJywwLjMzLDAuMDYsMC40NSwwLjA2LDAuOTMsMC4wNl0sWydjJywwLjYzLDAuMDAsMC44MSwtMC4wMywxLjI5LC0wLjI3XSxbJ2MnLDAuOTAsLTAuNDIsMS40NywtMS40MSwxLjQxLC0yLjQwXSxbJ2MnLC0wLjA2LC0wLjY2LC0wLjM5LC0xLjI5LC0wLjkwLC0xLjY1XSxbJ2MnLC0wLjEyLC0wLjA5LC0xLjA1LC0wLjYzLC0yLjA3LC0xLjIzXSxbJ3onXV0sdzoxMC45MjYsaDoxNC45ODl9LFxuXHRcdCc5Jzp7ZDpbWydNJyw0LjIzLC0xNC45N10sWydjJywwLjQyLC0wLjAzLDEuMjksMC4wMCwxLjYyLDAuMDZdLFsnYycsMC41MSwwLjEyLDAuOTMsMC4zMCwxLjM4LDAuNTddLFsnYycsMS41MywxLjAyLDIuNTIsMy4yNCwyLjczLDUuOTRdLFsnYycsMC4xOCwyLjU1LC0wLjQ4LDQuOTgsLTEuODMsNi41N10sWydjJywtMS4wNSwxLjI2LC0yLjQwLDEuODksLTMuOTMsMS44M10sWydjJywtMS4yMywtMC4wNiwtMi4zMSwtMC40NSwtMy4wMywtMS4xNF0sWydjJywtMC41NywtMC41MSwtMC44NywtMS4yMywtMC44NCwtMS45OF0sWydjJywwLjAzLC0wLjUxLDAuMjEsLTAuOTAsMC42MCwtMS4yNl0sWydjJywwLjI0LC0wLjI0LDAuNDUsLTAuMzksMC43NSwtMC41MV0sWydjJywwLjIxLC0wLjA2LDAuMjcsLTAuMDYsMC42MCwtMC4wNl0sWydjJywwLjMzLDAuMDAsMC4zOSwwLjAwLDAuNjAsMC4wNl0sWydjJywwLjMwLDAuMTIsMC41MSwwLjI3LDAuNzUsMC41MV0sWydjJywwLjM5LDAuMzYsMC41NywwLjc4LDAuNTcsMS4yNl0sWydjJywwLjAwLDAuMjcsMC4wMCwwLjMwLC0wLjA5LDAuNDJdLFsnYycsLTAuMDMsMC4wOSwtMC4xOCwwLjIxLC0wLjMwLDAuMzBdLFsnYycsLTAuMTIsMC4wOSwtMC4zMCwwLjIxLC0wLjM5LDAuMjddLFsnYycsLTAuMDksMC4wNiwtMC4yMSwwLjE4LC0wLjI3LDAuMjRdLFsnYycsLTAuMDYsMC4xMiwtMC4wNiwwLjE1LC0wLjA2LDAuMzNdLFsnYycsMC4wMCwwLjE4LDAuMDAsMC4yNCwwLjA2LDAuMzZdLFsnYycsMC4yNCwwLjM5LDAuNzUsMC42MCwxLjM4LDAuNTddLFsnYycsMC41NCwtMC4wMywwLjkwLC0wLjE4LDEuMjMsLTAuNDhdLFsnYycsMC44MSwtMC43MiwxLjA4LC0yLjE2LDAuOTYsLTUuMzddLFsnbCcsMC4wMCwtMC42M10sWydsJywtMC4zMCwwLjEyXSxbJ2MnLC0wLjc4LDAuMjcsLTEuMjksMC4zMywtMi4xMCwwLjI3XSxbJ2MnLC0xLjQ3LC0wLjEyLC0yLjQ5LC0wLjU0LC0zLjI3LC0xLjI5XSxbJ2MnLC0wLjQ4LC0wLjUxLC0wLjgxLC0xLjExLC0wLjk2LC0xLjg5XSxbJ2MnLC0wLjA2LC0wLjI3LC0wLjA2LC0wLjQyLC0wLjA2LC0wLjk2XSxbJ2MnLDAuMDAsLTAuNTEsMC4wMCwtMC42NiwwLjA2LC0wLjkzXSxbJ2MnLDAuMTUsLTAuNzgsMC40OCwtMS4zOCwwLjk2LC0xLjg5XSxbJ2MnLDAuMTUsLTAuMTIsMC4zMywtMC4yNywwLjQyLC0wLjM2XSxbJ2MnLDAuNjksLTAuNTEsMS42MiwtMC44MSwyLjc2LC0wLjkzXSxbJ3onXSxbJ20nLDEuMTcsMC42Nl0sWydjJywtMC4yMSwtMC4wNiwtMC41NywtMC4wNiwtMC44MSwtMC4wM10sWydjJywtMC43OCwwLjEyLC0xLjI2LDAuNjksLTEuNDEsMS43NF0sWydjJywtMC4xMiwwLjYzLC0wLjE1LDEuOTUsLTAuMDksMi43OV0sWydjJywwLjEyLDEuNzEsMC42MywyLjQwLDEuNzcsMi40Nl0sWydjJywxLjA4LDAuMDMsMS42MiwtMC40OCwxLjgwLC0xLjc0XSxbJ2MnLDAuMDYsLTAuNTQsMC4wNiwtMy4wMCwwLjAwLC0zLjU0XSxbJ2MnLC0wLjE1LC0xLjA1LC0wLjUxLC0xLjUzLC0xLjI2LC0xLjY4XSxbJ3onXV0sdzo5Ljk1OSxoOjE0Ljk4Nn0sXG5cdFx0J3Jlc3RzLm11bHRpbWVhc3VyZSc6e2Q6W1snTScsMCwtNF0sWydsJywwLDE2XSxbJ2wnLDEsMF0sWydsJywwLC01XSxbJ2wnLDQwLDBdLFsnbCcsMCw1XSxbJ2wnLDEsMF0sWydsJywwLC0xNl0sWydsJywtMSwwXSxbJ2wnLDAsNV0sWydsJywtNDAsMF0sWydsJywwLC01XSxbJ3onXV0sdzo0MixoOjE4fSxcblx0XHQncmVzdHMud2hvbGUnOntkOltbJ00nLDAuMDYsMC4wM10sWydsJywwLjA5LC0wLjA2XSxbJ2wnLDUuNDYsMC4wMF0sWydsJyw1LjQ5LDAuMDBdLFsnbCcsMC4wOSwwLjA2XSxbJ2wnLDAuMDYsMC4wOV0sWydsJywwLjAwLDIuMTldLFsnbCcsMC4wMCwyLjE5XSxbJ2wnLC0wLjA2LDAuMDldLFsnbCcsLTAuMDksMC4wNl0sWydsJywtNS40OSwwLjAwXSxbJ2wnLC01LjQ2LDAuMDBdLFsnbCcsLTAuMDksLTAuMDZdLFsnbCcsLTAuMDYsLTAuMDldLFsnbCcsMC4wMCwtMi4xOV0sWydsJywwLjAwLC0yLjE5XSxbJ3onXV0sdzoxMS4yNSxoOjQuNjh9LFxuXHRcdCdyZXN0cy5oYWxmJzp7ZDpbWydNJywwLjA2LC00LjYyXSxbJ2wnLDAuMDksLTAuMDZdLFsnbCcsNS40NiwwLjAwXSxbJ2wnLDUuNDksMC4wMF0sWydsJywwLjA5LDAuMDZdLFsnbCcsMC4wNiwwLjA5XSxbJ2wnLDAuMDAsMi4xOV0sWydsJywwLjAwLDIuMTldLFsnbCcsLTAuMDYsMC4wOV0sWydsJywtMC4wOSwwLjA2XSxbJ2wnLC01LjQ5LDAuMDBdLFsnbCcsLTUuNDYsMC4wMF0sWydsJywtMC4wOSwtMC4wNl0sWydsJywtMC4wNiwtMC4wOV0sWydsJywwLjAwLC0yLjE5XSxbJ2wnLDAuMDAsLTIuMTldLFsneiddXSx3OjExLjI1LGg6NC42OH0sXG5cdFx0J3Jlc3RzLnF1YXJ0ZXInOntkOltbJ00nLDEuODksLTExLjgyXSxbJ2MnLDAuMTIsLTAuMDYsMC4yNCwtMC4wNiwwLjM2LC0wLjAzXSxbJ2MnLDAuMDksMC4wNiw0Ljc0LDUuNTgsNC44Niw1LjgyXSxbJ2MnLDAuMjEsMC4zOSwwLjE1LDAuNzgsLTAuMTUsMS4yNl0sWydjJywtMC4yNCwwLjMzLC0wLjcyLDAuODEsLTEuNjIsMS41Nl0sWydjJywtMC40NSwwLjM2LC0wLjg3LDAuNzUsLTAuOTYsMC44NF0sWydjJywtMC45MywwLjk5LC0xLjE0LDIuNDksLTAuNjAsMy42M10sWydjJywwLjE4LDAuMzksMC4yNywwLjQ4LDEuMzIsMS42OF0sWydjJywxLjkyLDIuMjUsMS44MywyLjE2LDEuODMsMi4zNF0sWydjJywwLjAwLDAuMTgsLTAuMTgsMC4zNiwtMC4zNiwwLjM5XSxbJ2MnLC0wLjE1LDAuMDAsLTAuMjcsLTAuMDYsLTAuNDgsLTAuMjddLFsnYycsLTAuNzUsLTAuNzUsLTIuNDYsLTEuMjksLTMuMzksLTEuMDhdLFsnYycsLTAuNDUsMC4wOSwtMC42OSwwLjI3LC0wLjkwLDAuNjldLFsnYycsLTAuMTIsMC4zMCwtMC4yMSwwLjY2LC0wLjI0LDEuMTRdLFsnYycsLTAuMDMsMC42NiwwLjA5LDEuMzUsMC4zMCwyLjAxXSxbJ2MnLDAuMTUsMC40MiwwLjI0LDAuNjYsMC40NSwwLjk2XSxbJ2MnLDAuMTgsMC4yNCwwLjE4LDAuMzMsMC4wMywwLjQyXSxbJ2MnLC0wLjEyLDAuMDYsLTAuMTgsMC4wMywtMC40NSwtMC4zMF0sWydjJywtMS4wOCwtMS4zOCwtMi4wNywtMy4zNiwtMi40MCwtNC44M10sWydjJywtMC4yNywtMS4wNSwtMC4xNSwtMS43NywwLjI3LC0yLjA3XSxbJ2MnLDAuMjEsLTAuMTIsMC40MiwtMC4xNSwwLjg3LC0wLjE1XSxbJ2MnLDAuODcsMC4wNiwyLjEwLDAuMzksMy4zMCwwLjkwXSxbJ2wnLDAuMzksMC4xOF0sWydsJywtMS42NSwtMS45NV0sWydjJywtMi41MiwtMi45NywtMi42MSwtMy4wOSwtMi43MCwtMy4yN10sWydjJywtMC4wOSwtMC4yNCwtMC4xMiwtMC40OCwtMC4wMywtMC43NV0sWydjJywwLjE1LC0wLjQ4LDAuNTcsLTAuOTYsMS44MywtMi4wMV0sWydjJywwLjQ1LC0wLjM2LDAuODQsLTAuNzIsMC45MywtMC43OF0sWydjJywwLjY5LC0wLjc1LDEuMDIsLTEuODAsMC45MCwtMi43OV0sWydjJywtMC4wNiwtMC4zMywtMC4yMSwtMC44NCwtMC4zOSwtMS4xMV0sWydjJywtMC4wOSwtMC4xNSwtMC40NSwtMC42MCwtMC44MSwtMS4wNV0sWydjJywtMC4zNiwtMC40MiwtMC42OSwtMC44MSwtMC43MiwtMC44N10sWydjJywtMC4wOSwtMC4xOCwwLjAwLC0wLjQyLDAuMjEsLTAuNTFdLFsneiddXSx3OjcuODg4LGg6MjEuNDM1fSxcblx0XHQncmVzdHMuOHRoJzp7ZDpbWydNJywxLjY4LC02LjEyXSxbJ2MnLDAuNjYsLTAuMDksMS4yMywwLjA5LDEuNjgsMC41MV0sWydjJywwLjI3LDAuMzAsMC4zOSwwLjU0LDAuNTcsMS4yNl0sWydjJywwLjA5LDAuMzMsMC4xOCwwLjY2LDAuMjEsMC43Ml0sWydjJywwLjEyLDAuMjcsMC4zMywwLjQ1LDAuNjAsMC40OF0sWydjJywwLjEyLDAuMDAsMC4xOCwwLjAwLDAuMzMsLTAuMDldLFsnYycsMC4zOSwtMC4xOCwxLjMyLC0xLjI5LDEuNjgsLTEuOThdLFsnYycsMC4wOSwtMC4yMSwwLjI0LC0wLjMwLDAuMzksLTAuMzBdLFsnYycsMC4xMiwwLjAwLDAuMjcsMC4wOSwwLjMzLDAuMThdLFsnYycsMC4wMywwLjA2LC0wLjI3LDEuMTEsLTEuODYsNi40Ml0sWydjJywtMS4wMiwzLjQ4LC0xLjg5LDYuMzksLTEuOTIsNi40Ml0sWydjJywwLjAwLDAuMDMsLTAuMTIsMC4xMiwtMC4yNCwwLjE1XSxbJ2MnLC0wLjE4LDAuMDksLTAuMjEsMC4wOSwtMC40NSwwLjA5XSxbJ2MnLC0wLjI0LDAuMDAsLTAuMzAsMC4wMCwtMC40OCwtMC4wNl0sWydjJywtMC4wOSwtMC4wNiwtMC4yMSwtMC4xMiwtMC4yMSwtMC4xNV0sWydjJywtMC4wNiwtMC4wMywwLjE1LC0wLjU3LDEuNjgsLTQuOTJdLFsnYycsMC45NiwtMi42NywxLjc0LC00Ljg5LDEuNzEsLTQuODldLFsnbCcsLTAuNTEsMC4xNV0sWydjJywtMS4wOCwwLjM2LC0xLjc0LDAuNDgsLTIuNTUsMC40OF0sWydjJywtMC42NiwwLjAwLC0wLjg0LC0wLjAzLC0xLjMyLC0wLjI3XSxbJ2MnLC0xLjMyLC0wLjYzLC0xLjc3LC0yLjE2LC0xLjAyLC0zLjMwXSxbJ2MnLDAuMzMsLTAuNDUsMC44NCwtMC44MSwxLjM4LC0wLjkwXSxbJ3onXV0sdzo3LjUzNCxoOjEzLjg4M30sXG5cdFx0J3Jlc3RzLjE2dGgnOntkOltbJ00nLDMuMzMsLTYuMTJdLFsnYycsMC42NiwtMC4wOSwxLjIzLDAuMDksMS42OCwwLjUxXSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMDksMC4zMywwLjE4LDAuNjYsMC4yMSwwLjcyXSxbJ2MnLDAuMTUsMC4zOSwwLjU3LDAuNTcsMC44NywwLjQyXSxbJ2MnLDAuMzksLTAuMTgsMS4yMCwtMS4yMywxLjYyLC0yLjA3XSxbJ2MnLDAuMDYsLTAuMTUsMC4yNCwtMC4yNCwwLjM2LC0wLjI0XSxbJ2MnLDAuMTIsMC4wMCwwLjI3LDAuMDksMC4zMywwLjE4XSxbJ2MnLDAuMDMsMC4wNiwtMC40NSwxLjg2LC0yLjY3LDEwLjE3XSxbJ2MnLC0xLjUwLDUuNTUsLTIuNzMsMTAuMTQsLTIuNzYsMTAuMTddLFsnYycsLTAuMDMsMC4wMywtMC4xMiwwLjEyLC0wLjI0LDAuMTVdLFsnYycsLTAuMTgsMC4wOSwtMC4yMSwwLjA5LC0wLjQ1LDAuMDldLFsnYycsLTAuMjQsMC4wMCwtMC4zMCwwLjAwLC0wLjQ4LC0wLjA2XSxbJ2MnLC0wLjA5LC0wLjA2LC0wLjIxLC0wLjEyLC0wLjIxLC0wLjE1XSxbJ2MnLC0wLjA2LC0wLjAzLDAuMTIsLTAuNTcsMS40NCwtNC45Ml0sWydjJywwLjgxLC0yLjY3LDEuNDcsLTQuODYsMS40NywtNC44OV0sWydjJywtMC4wMywwLjAwLC0wLjI3LDAuMDYsLTAuNTQsMC4xNV0sWydjJywtMS4wOCwwLjM2LC0xLjc3LDAuNDgsLTIuNTgsMC40OF0sWydjJywtMC42NiwwLjAwLC0wLjg0LC0wLjAzLC0xLjMyLC0wLjI3XSxbJ2MnLC0xLjMyLC0wLjYzLC0xLjc3LC0yLjE2LC0xLjAyLC0zLjMwXSxbJ2MnLDAuNzIsLTEuMDUsMi4yMiwtMS4yMywzLjA2LC0wLjQyXSxbJ2MnLDAuMzAsMC4zMywwLjQyLDAuNjAsMC42MCwxLjM4XSxbJ2MnLDAuMDksMC40NSwwLjIxLDAuNzgsMC4zMywwLjkwXSxbJ2MnLDAuMDksMC4wOSwwLjI3LDAuMTgsMC40NSwwLjIxXSxbJ2MnLDAuMTIsMC4wMCwwLjE4LDAuMDAsMC4zMywtMC4wOV0sWydjJywwLjMzLC0wLjE1LDEuMDIsLTAuOTMsMS40MSwtMS41OV0sWydjJywwLjEyLC0wLjIxLDAuMTgsLTAuMzksMC4zOSwtMS4wOF0sWydjJywwLjY2LC0yLjEwLDEuMTcsLTMuODQsMS4xNywtMy44N10sWydjJywwLjAwLDAuMDAsLTAuMjEsMC4wNiwtMC40MiwwLjE1XSxbJ2MnLC0wLjUxLDAuMTUsLTEuMjAsMC4zMywtMS42OCwwLjQyXSxbJ2MnLC0wLjMzLDAuMDYsLTAuNTEsMC4wNiwtMC45NiwwLjA2XSxbJ2MnLC0wLjY2LDAuMDAsLTAuODQsLTAuMDMsLTEuMzIsLTAuMjddLFsnYycsLTEuMzIsLTAuNjMsLTEuNzcsLTIuMTYsLTEuMDIsLTMuMzBdLFsnYycsMC4zMywtMC40NSwwLjg0LC0wLjgxLDEuMzgsLTAuOTBdLFsneiddXSx3OjkuNzI0LGg6MjEuMzgzfSxcblx0XHQncmVzdHMuMzJuZCc6e2Q6W1snTScsNC4yMywtMTMuNjJdLFsnYycsMC42NiwtMC4wOSwxLjIzLDAuMDksMS42OCwwLjUxXSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMDksMC4zMywwLjE4LDAuNjYsMC4yMSwwLjcyXSxbJ2MnLDAuMTIsMC4yNywwLjMzLDAuNDUsMC42MCwwLjQ4XSxbJ2MnLDAuMTIsMC4wMCwwLjE4LDAuMDAsMC4yNywtMC4wNl0sWydjJywwLjMzLC0wLjIxLDAuOTksLTEuMTEsMS40NCwtMS45OF0sWydjJywwLjA5LC0wLjI0LDAuMjEsLTAuMzMsMC4zOSwtMC4zM10sWydjJywwLjEyLDAuMDAsMC4yNywwLjA5LDAuMzMsMC4xOF0sWydjJywwLjAzLDAuMDYsLTAuNTcsMi42NywtMy4yMSwxMy44OV0sWydjJywtMS44MCw3LjYyLC0zLjMwLDEzLjg5LC0zLjMwLDEzLjkyXSxbJ2MnLC0wLjAzLDAuMDYsLTAuMTIsMC4xMiwtMC4yNCwwLjE4XSxbJ2MnLC0wLjIxLDAuMDksLTAuMjQsMC4wOSwtMC40OCwwLjA5XSxbJ2MnLC0wLjI0LDAuMDAsLTAuMzAsMC4wMCwtMC40OCwtMC4wNl0sWydjJywtMC4wOSwtMC4wNiwtMC4yMSwtMC4xMiwtMC4yMSwtMC4xNV0sWydjJywtMC4wNiwtMC4wMywwLjA5LC0wLjU3LDEuMjMsLTQuOTJdLFsnYycsMC42OSwtMi42NywxLjI2LC00Ljg2LDEuMjksLTQuODldLFsnYycsMC4wMCwtMC4wMywtMC4xMiwtMC4wMywtMC40OCwwLjEyXSxbJ2MnLC0xLjE3LDAuMzksLTIuMjIsMC41NywtMy4wMCwwLjU0XSxbJ2MnLC0wLjQyLC0wLjAzLC0wLjc1LC0wLjEyLC0xLjExLC0wLjMwXSxbJ2MnLC0xLjMyLC0wLjYzLC0xLjc3LC0yLjE2LC0xLjAyLC0zLjMwXSxbJ2MnLDAuNzIsLTEuMDUsMi4yMiwtMS4yMywzLjA2LC0wLjQyXSxbJ2MnLDAuMzAsMC4zMywwLjQyLDAuNjAsMC42MCwxLjM4XSxbJ2MnLDAuMDksMC40NSwwLjIxLDAuNzgsMC4zMywwLjkwXSxbJ2MnLDAuMTIsMC4wOSwwLjMwLDAuMTgsMC40OCwwLjIxXSxbJ2MnLDAuMTIsMC4wMCwwLjE4LDAuMDAsMC4zMCwtMC4wOV0sWydjJywwLjQyLC0wLjIxLDEuMjksLTEuMjksMS41NiwtMS44OV0sWydjJywwLjAzLC0wLjEyLDEuMjMsLTQuNTksMS4yMywtNC42NV0sWydjJywwLjAwLC0wLjAzLC0wLjE4LDAuMDMsLTAuMzksMC4xMl0sWydjJywtMC42MywwLjE4LC0xLjIwLDAuMzYsLTEuNzQsMC40NV0sWydjJywtMC4zOSwwLjA2LC0wLjU0LDAuMDYsLTEuMDIsMC4wNl0sWydjJywtMC42NiwwLjAwLC0wLjg0LC0wLjAzLC0xLjMyLC0wLjI3XSxbJ2MnLC0xLjMyLC0wLjYzLC0xLjc3LC0yLjE2LC0xLjAyLC0zLjMwXSxbJ2MnLDAuNzIsLTEuMDUsMi4yMiwtMS4yMywzLjA2LC0wLjQyXSxbJ2MnLDAuMzAsMC4zMywwLjQyLDAuNjAsMC42MCwxLjM4XSxbJ2MnLDAuMDksMC40NSwwLjIxLDAuNzgsMC4zMywwLjkwXSxbJ2MnLDAuMTgsMC4xOCwwLjUxLDAuMjcsMC43MiwwLjE1XSxbJ2MnLDAuMzAsLTAuMTIsMC42OSwtMC41NywxLjA4LC0xLjE3XSxbJ2MnLDAuNDIsLTAuNjAsMC4zOSwtMC41MSwxLjA1LC0zLjAzXSxbJ2MnLDAuMzMsLTEuMjYsMC42MCwtMi4zMSwwLjYwLC0yLjM0XSxbJ2MnLDAuMDAsMC4wMCwtMC4yMSwwLjAzLC0wLjQ1LDAuMTJdLFsnYycsLTAuNTcsMC4xOCwtMS4xNCwwLjMzLC0xLjYyLDAuNDJdLFsnYycsLTAuMzMsMC4wNiwtMC41MSwwLjA2LC0wLjk2LDAuMDZdLFsnYycsLTAuNjYsMC4wMCwtMC44NCwtMC4wMywtMS4zMiwtMC4yN10sWydjJywtMS4zMiwtMC42MywtMS43NywtMi4xNiwtMS4wMiwtMy4zMF0sWydjJywwLjMzLC0wLjQ1LDAuODQsLTAuODEsMS4zOCwtMC45MF0sWyd6J11dLHc6MTEuMzczLGg6MjguODgzfSxcblx0XHQncmVzdHMuNjR0aCc6e2Q6W1snTScsNS4xMywtMTMuNjJdLFsnYycsMC42NiwtMC4wOSwxLjIzLDAuMDksMS42OCwwLjUxXSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMTUsMC42MywwLjIxLDAuODEsMC4zMywwLjk2XSxbJ2MnLDAuMTgsMC4yMSwwLjU0LDAuMzAsMC43NSwwLjE4XSxbJ2MnLDAuMjQsLTAuMTIsMC42MywtMC42NiwxLjA4LC0xLjU2XSxbJ2MnLDAuMzMsLTAuNjYsMC4zOSwtMC43MiwwLjYwLC0wLjcyXSxbJ2MnLDAuMTIsMC4wMCwwLjI3LDAuMDksMC4zMywwLjE4XSxbJ2MnLDAuMDMsMC4wNiwtMC42OSwzLjY2LC0zLjU0LDE3LjY0XSxbJ2MnLC0xLjk1LDkuNjYsLTMuNTcsMTcuNjEsLTMuNTcsMTcuNjRdLFsnYycsLTAuMDMsMC4wNiwtMC4xMiwwLjEyLC0wLjI0LDAuMThdLFsnYycsLTAuMjEsMC4wOSwtMC4yNCwwLjA5LC0wLjQ4LDAuMDldLFsnYycsLTAuMjQsMC4wMCwtMC4zMCwwLjAwLC0wLjQ4LC0wLjA2XSxbJ2MnLC0wLjA5LC0wLjA2LC0wLjIxLC0wLjEyLC0wLjIxLC0wLjE1XSxbJ2MnLC0wLjA2LC0wLjAzLDAuMDYsLTAuNTcsMS4wNSwtNC45NV0sWydjJywwLjYwLC0yLjcwLDEuMDgsLTQuODksMS4wOCwtNC45Ml0sWydjJywwLjAwLDAuMDAsLTAuMjQsMC4wNiwtMC41MSwwLjE1XSxbJ2MnLC0wLjY2LDAuMjQsLTEuMjAsMC4zNiwtMS43NywwLjQ4XSxbJ2MnLC0wLjQyLDAuMDYsLTAuNTcsMC4wNiwtMS4wNSwwLjA2XSxbJ2MnLC0wLjY5LDAuMDAsLTAuODcsLTAuMDMsLTEuMzUsLTAuMjddLFsnYycsLTEuMzIsLTAuNjMsLTEuNzcsLTIuMTYsLTEuMDIsLTMuMzBdLFsnYycsMC43MiwtMS4wNSwyLjIyLC0xLjIzLDMuMDYsLTAuNDJdLFsnYycsMC4zMCwwLjMzLDAuNDIsMC42MCwwLjYwLDEuMzhdLFsnYycsMC4wOSwwLjQ1LDAuMjEsMC43OCwwLjMzLDAuOTBdLFsnYycsMC4wOSwwLjA5LDAuMjcsMC4xOCwwLjQ1LDAuMjFdLFsnYycsMC4yMSwwLjAzLDAuMzksLTAuMDksMC43MiwtMC40Ml0sWydjJywwLjQ1LC0wLjQ1LDEuMDIsLTEuMjYsMS4xNywtMS42NV0sWydjJywwLjAzLC0wLjA5LDAuMjcsLTEuMTQsMC41NCwtMi4zNF0sWydjJywwLjI3LC0xLjIwLDAuNDgsLTIuMTksMC41MSwtMi4yMl0sWydjJywwLjAwLC0wLjAzLC0wLjA5LC0wLjAzLC0wLjQ4LDAuMTJdLFsnYycsLTEuMTcsMC4zOSwtMi4yMiwwLjU3LC0zLjAwLDAuNTRdLFsnYycsLTAuNDIsLTAuMDMsLTAuNzUsLTAuMTIsLTEuMTEsLTAuMzBdLFsnYycsLTEuMzIsLTAuNjMsLTEuNzcsLTIuMTYsLTEuMDIsLTMuMzBdLFsnYycsMC4zNiwtMC41NCwwLjk2LC0wLjg3LDEuNjUsLTAuOTNdLFsnYycsMC41NCwtMC4wMywxLjAyLDAuMTUsMS40MSwwLjU0XSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMDksMC4zMywwLjE4LDAuNjYsMC4yMSwwLjcyXSxbJ2MnLDAuMTUsMC4zOSwwLjU3LDAuNTcsMC45MCwwLjQyXSxbJ2MnLDAuMzYsLTAuMTgsMS4yMCwtMS4yNiwxLjQ3LC0xLjg5XSxbJ2MnLDAuMDMsLTAuMDksMC4zMCwtMS4yMCwwLjU3LC0yLjQzXSxbJ2wnLDAuNTEsLTIuMjhdLFsnbCcsLTAuNTQsMC4xOF0sWydjJywtMS4xMSwwLjM2LC0xLjgwLDAuNDgsLTIuNjEsMC40OF0sWydjJywtMC42NiwwLjAwLC0wLjg0LC0wLjAzLC0xLjMyLC0wLjI3XSxbJ2MnLC0xLjMyLC0wLjYzLC0xLjc3LC0yLjE2LC0xLjAyLC0zLjMwXSxbJ2MnLDAuMzYsLTAuNTQsMC45NiwtMC44NywxLjY1LC0wLjkzXSxbJ2MnLDAuNTQsLTAuMDMsMS4wMiwwLjE1LDEuNDEsMC41NF0sWydjJywwLjI3LDAuMzAsMC4zOSwwLjU0LDAuNTcsMS4yNl0sWydjJywwLjE1LDAuNjMsMC4yMSwwLjgxLDAuMzMsMC45Nl0sWydjJywwLjIxLDAuMjEsMC41NCwwLjMwLDAuNzUsMC4xOF0sWydjJywwLjM2LC0wLjE4LDAuOTMsLTAuOTMsMS4yOSwtMS42OF0sWydjJywwLjEyLC0wLjI0LDAuMTgsLTAuNDgsMC42MywtMi41NV0sWydsJywwLjUxLC0yLjMxXSxbJ2MnLDAuMDAsLTAuMDMsLTAuMTgsMC4wMywtMC4zOSwwLjEyXSxbJ2MnLC0xLjE0LDAuMzYsLTIuMTAsMC41NCwtMi44MiwwLjUxXSxbJ2MnLC0wLjQyLC0wLjAzLC0wLjc1LC0wLjEyLC0xLjExLC0wLjMwXSxbJ2MnLC0xLjMyLC0wLjYzLC0xLjc3LC0yLjE2LC0xLjAyLC0zLjMwXSxbJ2MnLDAuMzMsLTAuNDUsMC44NCwtMC44MSwxLjM4LC0wLjkwXSxbJ3onXV0sdzoxMi40NTMsaDozNi4zODN9LFxuXHRcdCdyZXN0cy4xMjh0aCc6e2Q6W1snTScsNi4wMywtMjEuMTJdLFsnYycsMC42NiwtMC4wOSwxLjIzLDAuMDksMS42OCwwLjUxXSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMDksMC4zMywwLjE4LDAuNjYsMC4yMSwwLjcyXSxbJ2MnLDAuMTIsMC4yNywwLjMzLDAuNDUsMC42MCwwLjQ4XSxbJ2MnLDAuMjEsMC4wMCwwLjMzLC0wLjA2LDAuNTQsLTAuMzZdLFsnYycsMC4xNSwtMC4yMSwwLjU0LC0wLjkzLDAuNzgsLTEuNDddLFsnYycsMC4xNSwtMC4zMywwLjE4LC0wLjM5LDAuMzAsLTAuNDhdLFsnYycsMC4xOCwtMC4wOSwwLjQ1LDAuMDAsMC41MSwwLjE1XSxbJ2MnLDAuMDMsMC4wOSwtNy4xMSw0Mi43NSwtNy4xNyw0Mi44NF0sWydjJywtMC4wMywwLjAzLC0wLjE1LDAuMDksLTAuMjQsMC4xNV0sWydjJywtMC4xOCwwLjA2LC0wLjI0LDAuMDYsLTAuNDUsMC4wNl0sWydjJywtMC4yNCwwLjAwLC0wLjMwLDAuMDAsLTAuNDgsLTAuMDZdLFsnYycsLTAuMDksLTAuMDYsLTAuMjEsLTAuMTIsLTAuMjEsLTAuMTVdLFsnYycsLTAuMDYsLTAuMDMsMC4wMywtMC41NywwLjg0LC00Ljk4XSxbJ2MnLDAuNTEsLTIuNzAsMC45MywtNC45MiwwLjkwLC00LjkyXSxbJ2MnLDAuMDAsMC4wMCwtMC4xNSwwLjA2LC0wLjM2LDAuMTJdLFsnYycsLTAuNzgsMC4yNywtMS42MiwwLjQ4LC0yLjMxLDAuNTddLFsnYycsLTAuMTUsMC4wMywtMC41NCwwLjAzLC0wLjgxLDAuMDNdLFsnYycsLTAuNjYsMC4wMCwtMC44NCwtMC4wMywtMS4zMiwtMC4yN10sWydjJywtMS4zMiwtMC42MywtMS43NywtMi4xNiwtMS4wMiwtMy4zMF0sWydjJywwLjM2LC0wLjU0LDAuOTYsLTAuODcsMS42NSwtMC45M10sWydjJywwLjU0LC0wLjAzLDEuMDIsMC4xNSwxLjQxLDAuNTRdLFsnYycsMC4yNywwLjMwLDAuMzksMC41NCwwLjU3LDEuMjZdLFsnYycsMC4wOSwwLjMzLDAuMTgsMC42NiwwLjIxLDAuNzJdLFsnYycsMC4xMiwwLjI3LDAuMzMsMC40NSwwLjYzLDAuNDhdLFsnYycsMC4xMiwwLjAwLDAuMTgsMC4wMCwwLjMwLC0wLjA5XSxbJ2MnLDAuNDIsLTAuMjEsMS4xNCwtMS4xMSwxLjUwLC0xLjgzXSxbJ2MnLDAuMTIsLTAuMjcsMC4xMiwtMC4yNywwLjU0LC0yLjUyXSxbJ2MnLDAuMjQsLTEuMjMsMC40MiwtMi4yNSwwLjM5LC0yLjI1XSxbJ2MnLDAuMDAsMC4wMCwtMC4yNCwwLjA2LC0wLjUxLDAuMThdLFsnYycsLTEuMjYsMC4zOSwtMi4yNSwwLjU3LC0zLjA2LDAuNTRdLFsnYycsLTAuNDIsLTAuMDMsLTAuNzUsLTAuMTIsLTEuMTEsLTAuMzBdLFsnYycsLTEuMzIsLTAuNjMsLTEuNzcsLTIuMTYsLTEuMDIsLTMuMzBdLFsnYycsMC4zNiwtMC41NCwwLjk2LC0wLjg3LDEuNjUsLTAuOTNdLFsnYycsMC41NCwtMC4wMywxLjAyLDAuMTUsMS40MSwwLjU0XSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMTUsMC42MywwLjIxLDAuODEsMC4zMywwLjk2XSxbJ2MnLDAuMTgsMC4yMSwwLjUxLDAuMzAsMC43NSwwLjE4XSxbJ2MnLDAuMzYsLTAuMTUsMS4wNSwtMC45OSwxLjQxLC0xLjc3XSxbJ2wnLDAuMTUsLTAuMzBdLFsnbCcsMC40MiwtMi4yNV0sWydjJywwLjIxLC0xLjI2LDAuNDIsLTIuMjgsMC4zOSwtMi4yOF0sWydsJywtMC41MSwwLjE1XSxbJ2MnLC0xLjExLDAuMzksLTEuODksMC41MSwtMi43MCwwLjUxXSxbJ2MnLC0wLjY2LDAuMDAsLTAuODQsLTAuMDMsLTEuMzIsLTAuMjddLFsnYycsLTEuMzIsLTAuNjMsLTEuNzcsLTIuMTYsLTEuMDIsLTMuMzBdLFsnYycsMC4zNiwtMC41NCwwLjk2LC0wLjg3LDEuNjUsLTAuOTNdLFsnYycsMC41NCwtMC4wMywxLjAyLDAuMTUsMS40MSwwLjU0XSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMTUsMC42MywwLjIxLDAuODEsMC4zMywwLjk2XSxbJ2MnLDAuMTgsMC4xOCwwLjQ4LDAuMjcsMC43MiwwLjIxXSxbJ2MnLDAuMzMsLTAuMTIsMS4xNCwtMS4yNiwxLjQxLC0xLjk1XSxbJ2MnLDAuMDAsLTAuMDksMC4yMSwtMS4xMSwwLjQ1LC0yLjM0XSxbJ2MnLDAuMjEsLTEuMjAsMC4zOSwtMi4yMiwwLjM5LC0yLjI4XSxbJ2MnLDAuMDMsLTAuMDMsMC4wMCwtMC4wMywtMC40NSwwLjEyXSxbJ2MnLC0wLjU3LDAuMTgsLTEuMjAsMC4zMywtMS43MSwwLjQyXSxbJ2MnLC0wLjMwLDAuMDYsLTAuNTEsMC4wNiwtMC45MywwLjA2XSxbJ2MnLC0wLjY2LDAuMDAsLTAuODQsLTAuMDMsLTEuMzIsLTAuMjddLFsnYycsLTEuMzIsLTAuNjMsLTEuNzcsLTIuMTYsLTEuMDIsLTMuMzBdLFsnYycsMC4zNiwtMC41NCwwLjk2LC0wLjg3LDEuNjUsLTAuOTNdLFsnYycsMC41NCwtMC4wMywxLjAyLDAuMTUsMS40MSwwLjU0XSxbJ2MnLDAuMjcsMC4zMCwwLjM5LDAuNTQsMC41NywxLjI2XSxbJ2MnLDAuMDksMC4zMywwLjE4LDAuNjYsMC4yMSwwLjcyXSxbJ2MnLDAuMTIsMC4yNywwLjMzLDAuNDUsMC42MCwwLjQ4XSxbJ2MnLDAuMTgsMC4wMCwwLjM2LC0wLjA5LDAuNTcsLTAuMzNdLFsnYycsMC4zMywtMC4zNiwwLjc4LC0xLjE0LDAuOTMsLTEuNTZdLFsnYycsMC4wMywtMC4xMiwwLjI0LC0xLjIwLDAuNDUsLTIuNDBdLFsnYycsMC4yNCwtMS4yMCwwLjQyLC0yLjIyLDAuNDIsLTIuMjhdLFsnYycsMC4wMywtMC4wMywwLjAwLC0wLjAzLC0wLjM5LDAuMDldLFsnYycsLTEuMDUsMC4zNiwtMS44MCwwLjQ4LC0yLjU4LDAuNDhdLFsnYycsLTAuNjMsMC4wMCwtMC44NCwtMC4wMywtMS4yOSwtMC4yN10sWydjJywtMS4zMiwtMC42MywtMS43NywtMi4xNiwtMS4wMiwtMy4zMF0sWydjJywwLjMzLC0wLjQ1LDAuODQsLTAuODEsMS4zOCwtMC45MF0sWyd6J11dLHc6MTIuOTkyLGg6NDMuODgzfSxcblx0XHQnYWNjaWRlbnRhbHMuc2hhcnAnOntkOltbJ00nLDUuNzMsLTExLjE5XSxbJ2MnLDAuMjEsLTAuMTIsMC41NCwtMC4wMywwLjY2LDAuMjRdLFsnYycsMC4wNiwwLjEyLDAuMDYsMC4yMSwwLjA2LDIuMzFdLFsnYycsMC4wMCwxLjIzLDAuMDAsMi4yMiwwLjAzLDIuMjJdLFsnYycsMC4wMCwwLjAwLDAuMjcsLTAuMTIsMC42MCwtMC4yNF0sWydjJywwLjY5LC0wLjI3LDAuNzgsLTAuMzAsMC45NiwtMC4xNV0sWydjJywwLjIxLDAuMTUsMC4yMSwwLjE4LDAuMjEsMS4zOF0sWydjJywwLjAwLDEuMDIsMC4wMCwxLjExLC0wLjA2LDEuMjBdLFsnYycsLTAuMDMsMC4wNiwtMC4wOSwwLjEyLC0wLjEyLDAuMTVdLFsnYycsLTAuMDYsMC4wMywtMC40MiwwLjIxLC0wLjg0LDAuMzZdLFsnbCcsLTAuNzUsMC4zM10sWydsJywtMC4wMywyLjQzXSxbJ2MnLDAuMDAsMS4zMiwwLjAwLDIuNDMsMC4wMywyLjQzXSxbJ2MnLDAuMDAsMC4wMCwwLjI3LC0wLjEyLDAuNjAsLTAuMjRdLFsnYycsMC42OSwtMC4yNywwLjc4LC0wLjMwLDAuOTYsLTAuMTVdLFsnYycsMC4yMSwwLjE1LDAuMjEsMC4xOCwwLjIxLDEuMzhdLFsnYycsMC4wMCwxLjAyLDAuMDAsMS4xMSwtMC4wNiwxLjIwXSxbJ2MnLC0wLjAzLDAuMDYsLTAuMDksMC4xMiwtMC4xMiwwLjE1XSxbJ2MnLC0wLjA2LDAuMDMsLTAuNDIsMC4yMSwtMC44NCwwLjM2XSxbJ2wnLC0wLjc1LDAuMzNdLFsnbCcsLTAuMDMsMi41Ml0sWydjJywwLjAwLDIuMjgsLTAuMDMsMi41NSwtMC4wNiwyLjY0XSxbJ2MnLC0wLjIxLDAuMzYsLTAuNzIsMC4zNiwtMC45MywwLjAwXSxbJ2MnLC0wLjAzLC0wLjA5LC0wLjA2LC0wLjMzLC0wLjA2LC0yLjQzXSxbJ2wnLDAuMDAsLTIuMzFdLFsnbCcsLTEuMjksMC41MV0sWydsJywtMS4yNiwwLjUxXSxbJ2wnLDAuMDAsMi40M10sWydjJywwLjAwLDIuNTgsMC4wMCwyLjUyLC0wLjE1LDIuNjddLFsnYycsLTAuMDYsMC4wOSwtMC4yNywwLjE4LC0wLjM2LDAuMThdLFsnYycsLTAuMTIsMC4wMCwtMC4zMywtMC4wOSwtMC4zOSwtMC4xOF0sWydjJywtMC4xNSwtMC4xNSwtMC4xNSwtMC4wOSwtMC4xNSwtMi40M10sWydjJywwLjAwLC0xLjIzLDAuMDAsLTIuMjIsLTAuMDMsLTIuMjJdLFsnYycsMC4wMCwwLjAwLC0wLjI3LDAuMTIsLTAuNjAsMC4yNF0sWydjJywtMC42OSwwLjI3LC0wLjc4LDAuMzAsLTAuOTYsMC4xNV0sWydjJywtMC4yMSwtMC4xNSwtMC4yMSwtMC4xOCwtMC4yMSwtMS4zOF0sWydjJywwLjAwLC0xLjAyLDAuMDAsLTEuMTEsMC4wNiwtMS4yMF0sWydjJywwLjAzLC0wLjA2LDAuMDksLTAuMTIsMC4xMiwtMC4xNV0sWydjJywwLjA2LC0wLjAzLDAuNDIsLTAuMjEsMC44NCwtMC4zNl0sWydsJywwLjc4LC0wLjMzXSxbJ2wnLDAuMDAsLTIuNDNdLFsnYycsMC4wMCwtMS4zMiwwLjAwLC0yLjQzLC0wLjAzLC0yLjQzXSxbJ2MnLDAuMDAsMC4wMCwtMC4yNywwLjEyLC0wLjYwLDAuMjRdLFsnYycsLTAuNjksMC4yNywtMC43OCwwLjMwLC0wLjk2LDAuMTVdLFsnYycsLTAuMjEsLTAuMTUsLTAuMjEsLTAuMTgsLTAuMjEsLTEuMzhdLFsnYycsMC4wMCwtMS4wMiwwLjAwLC0xLjExLDAuMDYsLTEuMjBdLFsnYycsMC4wMywtMC4wNiwwLjA5LC0wLjEyLDAuMTIsLTAuMTVdLFsnYycsMC4wNiwtMC4wMywwLjQyLC0wLjIxLDAuODQsLTAuMzZdLFsnbCcsMC43OCwtMC4zM10sWydsJywwLjAwLC0yLjUyXSxbJ2MnLDAuMDAsLTIuMjgsMC4wMywtMi41NSwwLjA2LC0yLjY0XSxbJ2MnLDAuMjEsLTAuMzYsMC43MiwtMC4zNiwwLjkzLDAuMDBdLFsnYycsMC4wMywwLjA5LDAuMDYsMC4zMywwLjA2LDIuNDNdLFsnbCcsMC4wMywyLjMxXSxbJ2wnLDEuMjYsLTAuNTFdLFsnbCcsMS4yNiwtMC41MV0sWydsJywwLjAwLC0yLjQzXSxbJ2MnLDAuMDAsLTIuMjgsMC4wMCwtMi40MywwLjA2LC0yLjU1XSxbJ2MnLDAuMDYsLTAuMTIsMC4xMiwtMC4xOCwwLjI3LC0wLjI0XSxbJ3onXSxbJ20nLC0wLjMzLDEwLjY1XSxbJ2wnLDAuMDAsLTIuNDNdLFsnbCcsLTEuMjksMC41MV0sWydsJywtMS4yNiwwLjUxXSxbJ2wnLDAuMDAsMi40Nl0sWydsJywwLjAwLDIuNDNdLFsnbCcsMC4wOSwtMC4wM10sWydjJywwLjA2LC0wLjAzLDAuNjMsLTAuMjcsMS4yOSwtMC41MV0sWydsJywxLjE3LC0wLjQ4XSxbJ2wnLDAuMDAsLTIuNDZdLFsneiddXSx3OjguMjUsaDoyMi40NjJ9LFxuXHRcdCdhY2NpZGVudGFscy5oYWxmc2hhcnAnOntkOltbJ00nLDIuNDMsLTEwLjA1XSxbJ2MnLDAuMjEsLTAuMTIsMC41NCwtMC4wMywwLjY2LDAuMjRdLFsnYycsMC4wNiwwLjEyLDAuMDYsMC4yMSwwLjA2LDIuMDFdLFsnYycsMC4wMCwxLjA1LDAuMDAsMS44OSwwLjAzLDEuODldLFsnbCcsMC43MiwtMC40OF0sWydjJywwLjY5LC0wLjQ4LDAuNjksLTAuNTEsMC44NywtMC41MV0sWydjJywwLjE1LDAuMDAsMC4xOCwwLjAzLDAuMjcsMC4wOV0sWydjJywwLjIxLDAuMTUsMC4yMSwwLjE4LDAuMjEsMS40MV0sWydjJywwLjAwLDEuMTEsLTAuMDMsMS4xNCwtMC4wOSwxLjIzXSxbJ2MnLC0wLjAzLDAuMDMsLTAuNDgsMC4zOSwtMS4wMiwwLjc1XSxbJ2wnLC0wLjk5LDAuNjZdLFsnbCcsMC4wMCwyLjM3XSxbJ2MnLDAuMDAsMS4zMiwwLjAwLDIuMzcsMC4wMywyLjM3XSxbJ2wnLDAuNzIsLTAuNDhdLFsnYycsMC42OSwtMC40OCwwLjY5LC0wLjUxLDAuODcsLTAuNTFdLFsnYycsMC4xNSwwLjAwLDAuMTgsMC4wMywwLjI3LDAuMDldLFsnYycsMC4yMSwwLjE1LDAuMjEsMC4xOCwwLjIxLDEuNDFdLFsnYycsMC4wMCwxLjExLC0wLjAzLDEuMTQsLTAuMDksMS4yM10sWydjJywtMC4wMywwLjAzLC0wLjQ4LDAuMzksLTEuMDIsMC43NV0sWydsJywtMC45OSwwLjY2XSxbJ2wnLDAuMDAsMi4yNV0sWydjJywwLjAwLDEuOTUsMC4wMCwyLjI4LC0wLjA2LDIuMzddLFsnYycsLTAuMDYsMC4xMiwtMC4xMiwwLjIxLC0wLjI0LDAuMjddLFsnYycsLTAuMjcsMC4xMiwtMC41NCwwLjAzLC0wLjY5LC0wLjI0XSxbJ2MnLC0wLjA2LC0wLjEyLC0wLjA2LC0wLjIxLC0wLjA2LC0yLjAxXSxbJ2MnLDAuMDAsLTEuMDUsMC4wMCwtMS44OSwtMC4wMywtMS44OV0sWydsJywtMC43MiwwLjQ4XSxbJ2MnLC0wLjY5LDAuNDgsLTAuNjksMC40OCwtMC44NywwLjQ4XSxbJ2MnLC0wLjE1LDAuMDAsLTAuMTgsMC4wMCwtMC4yNywtMC4wNl0sWydjJywtMC4yMSwtMC4xNSwtMC4yMSwtMC4xOCwtMC4yMSwtMS40MV0sWydjJywwLjAwLC0xLjExLDAuMDMsLTEuMTQsMC4wOSwtMS4yM10sWydjJywwLjAzLC0wLjAzLDAuNDgsLTAuMzksMS4wMiwtMC43NV0sWydsJywwLjk5LC0wLjY2XSxbJ2wnLDAuMDAsLTIuMzddLFsnYycsMC4wMCwtMS4zMiwwLjAwLC0yLjM3LC0wLjAzLC0yLjM3XSxbJ2wnLC0wLjcyLDAuNDhdLFsnYycsLTAuNjksMC40OCwtMC42OSwwLjQ4LC0wLjg3LDAuNDhdLFsnYycsLTAuMTUsMC4wMCwtMC4xOCwwLjAwLC0wLjI3LC0wLjA2XSxbJ2MnLC0wLjIxLC0wLjE1LC0wLjIxLC0wLjE4LC0wLjIxLC0xLjQxXSxbJ2MnLDAuMDAsLTEuMTEsMC4wMywtMS4xNCwwLjA5LC0xLjIzXSxbJ2MnLDAuMDMsLTAuMDMsMC40OCwtMC4zOSwxLjAyLC0wLjc1XSxbJ2wnLDAuOTksLTAuNjZdLFsnbCcsMC4wMCwtMi4yNV0sWydjJywwLjAwLC0yLjEzLDAuMDAsLTIuMjgsMC4wNiwtMi40MF0sWydjJywwLjA2LC0wLjEyLDAuMTIsLTAuMTgsMC4yNywtMC4yNF0sWyd6J11dLHc6NS4yNSxoOjIwLjE3NH0sXG5cdFx0J2FjY2lkZW50YWxzLm5hdCc6e2Q6W1snTScsMC4yMSwtMTEuNDBdLFsnYycsMC4yNCwtMC4wNiwwLjc4LDAuMDAsMC45OSwwLjE1XSxbJ2MnLDAuMDMsMC4wMywwLjAzLDAuNDgsMC4wMCwyLjYxXSxbJ2MnLC0wLjAzLDEuNDQsLTAuMDMsMi42MSwtMC4wMywyLjYxXSxbJ2MnLDAuMDAsMC4wMywwLjc1LC0wLjA5LDEuNjgsLTAuMjRdLFsnYycsMC45NiwtMC4xOCwxLjcxLC0wLjI3LDEuNzQsLTAuMjddLFsnYycsMC4xNSwwLjAzLDAuMjcsMC4xNSwwLjM2LDAuMzBdLFsnbCcsMC4wNiwwLjEyXSxbJ2wnLDAuMDksOC42N10sWydjJywwLjA5LDYuOTYsMC4xMiw4LjY3LDAuMDksOC42N10sWydjJywtMC4wMywwLjAzLC0wLjEyLDAuMDYsLTAuMjEsMC4wOV0sWydjJywtMC4yNCwwLjA5LC0wLjcyLDAuMDksLTAuOTYsMC4wMF0sWydjJywtMC4wOSwtMC4wMywtMC4xOCwtMC4wNiwtMC4yMSwtMC4wOV0sWydjJywtMC4wMywtMC4wMywtMC4wMywtMC40OCwwLjAwLC0yLjYxXSxbJ2MnLDAuMDMsLTEuNDQsMC4wMywtMi42MSwwLjAzLC0yLjYxXSxbJ2MnLDAuMDAsLTAuMDMsLTAuNzUsMC4wOSwtMS42OCwwLjI0XSxbJ2MnLC0wLjk2LDAuMTgsLTEuNzEsMC4yNywtMS43NCwwLjI3XSxbJ2MnLC0wLjE1LC0wLjAzLC0wLjI3LC0wLjE1LC0wLjM2LC0wLjMwXSxbJ2wnLC0wLjA2LC0wLjE1XSxbJ2wnLC0wLjA5LC03LjUzXSxbJ2MnLC0wLjA2LC00LjE0LC0wLjA5LC04LjA0LC0wLjEyLC04LjY3XSxbJ2wnLDAuMDAsLTEuMTFdLFsnbCcsMC4xNSwtMC4wNl0sWydjJywwLjA5LC0wLjAzLDAuMjEsLTAuMDYsMC4yNywtMC4wOV0sWyd6J10sWydtJywzLjc1LDguNDBdLFsnYycsMC4wMCwtMC4zMywwLjAwLC0wLjQyLC0wLjAzLC0wLjQyXSxbJ2MnLC0wLjEyLDAuMDAsLTIuNzksMC40NSwtMi43OSwwLjQ4XSxbJ2MnLC0wLjAzLDAuMDAsLTAuMDksNi4zMCwtMC4wOSw2LjMzXSxbJ2MnLDAuMDMsMC4wMCwyLjc5LC0wLjQ1LDIuODIsLTAuNDhdLFsnYycsMC4wMCwwLjAwLDAuMDksLTQuNTMsMC4wOSwtNS45MV0sWyd6J11dLHc6NS40LGg6MjIuOH0sXG5cdFx0J2FjY2lkZW50YWxzLmZsYXQnOntkOltbJ00nLC0wLjM2LC0xNC4wN10sWydjJywwLjMzLC0wLjA2LDAuODcsMC4wMCwxLjA4LDAuMTVdLFsnYycsMC4wNiwwLjAzLDAuMDYsMC4zNiwtMC4wMyw1LjI1XSxbJ2MnLC0wLjA2LDIuODUsLTAuMDksNS4xOSwtMC4wOSw1LjE5XSxbJ2MnLDAuMDAsMC4wMywwLjEyLC0wLjAzLDAuMjQsLTAuMTJdLFsnYycsMC42MywtMC40MiwxLjQxLC0wLjY2LDIuMTksLTAuNzJdLFsnYycsMC44MSwtMC4wMywxLjQ3LDAuMjEsMi4wNCwwLjc4XSxbJ2MnLDAuNTcsMC41NCwwLjg3LDEuMjYsMC45MywyLjA0XSxbJ2MnLDAuMDMsMC41NywtMC4wOSwxLjA4LC0wLjM2LDEuNjJdLFsnYycsLTAuNDIsMC44MSwtMS4wMiwxLjM4LC0yLjgyLDIuNjFdLFsnYycsLTEuMTQsMC43OCwtMS40NCwxLjAyLC0xLjgwLDEuNDRdLFsnYycsLTAuMTgsMC4xOCwtMC4zOSwwLjM5LC0wLjQ1LDAuNDJdLFsnYycsLTAuMjcsMC4xOCwtMC41NywwLjE1LC0wLjgxLC0wLjA2XSxbJ2MnLC0wLjA2LC0wLjA5LC0wLjEyLC0wLjE4LC0wLjE1LC0wLjI3XSxbJ2MnLC0wLjAzLC0wLjA2LC0wLjA5LC0zLjI3LC0wLjE4LC04LjM0XSxbJ2MnLC0wLjA5LC00LjUzLC0wLjE1LC04LjU4LC0wLjE4LC05LjAzXSxbJ2wnLDAuMDAsLTAuNzhdLFsnbCcsMC4xMiwtMC4wNl0sWydjJywwLjA2LC0wLjAzLDAuMTgsLTAuMDksMC4yNywtMC4xMl0sWyd6J10sWydtJywzLjE4LDExLjAxXSxbJ2MnLC0wLjIxLC0wLjEyLC0wLjU0LC0wLjE1LC0wLjgxLC0wLjA2XSxbJ2MnLC0wLjU0LDAuMTUsLTAuOTksMC42MywtMS4xNywxLjI2XSxbJ2MnLC0wLjA2LDAuMzAsLTAuMTIsMi44OCwtMC4wNiwzLjg3XSxbJ2MnLDAuMDMsMC40MiwwLjAzLDAuODEsMC4wNiwwLjkwXSxbJ2wnLDAuMDMsMC4xMl0sWydsJywwLjQ1LC0wLjM5XSxbJ2MnLDAuNjMsLTAuNTQsMS4yNiwtMS4xNywxLjU2LC0xLjU5XSxbJ2MnLDAuMzAsLTAuNDIsMC42MCwtMC45OSwwLjcyLC0xLjQxXSxbJ2MnLDAuMTgsLTAuNjksMC4wOSwtMS40NywtMC4xOCwtMi4wN10sWydjJywtMC4xNSwtMC4zMCwtMC4zMywtMC41MSwtMC42MCwtMC42M10sWyd6J11dLHc6Ni43NSxoOjE4LjgwMX0sXG5cdFx0J2FjY2lkZW50YWxzLmhhbGZmbGF0Jzp7ZDpbWydNJyw0LjgzLC0xNC4wN10sWydjJywwLjMzLC0wLjA2LDAuODcsMC4wMCwxLjA4LDAuMTVdLFsnYycsMC4wNiwwLjAzLDAuMDYsMC42MCwtMC4xMiw5LjA2XSxbJ2MnLC0wLjA5LDUuNTUsLTAuMTUsOS4wNiwtMC4xOCw5LjEyXSxbJ2MnLC0wLjAzLDAuMDksLTAuMDksMC4xOCwtMC4xNSwwLjI3XSxbJ2MnLC0wLjI0LDAuMjEsLTAuNTQsMC4yNCwtMC44MSwwLjA2XSxbJ2MnLC0wLjA2LC0wLjAzLC0wLjI3LC0wLjI0LC0wLjQ1LC0wLjQyXSxbJ2MnLC0wLjM2LC0wLjQyLC0wLjY2LC0wLjY2LC0xLjgwLC0xLjQ0XSxbJ2MnLC0xLjIzLC0wLjg0LC0xLjgzLC0xLjMyLC0yLjI1LC0xLjc3XSxbJ2MnLC0wLjY2LC0wLjc4LC0wLjk2LC0xLjU2LC0wLjkzLC0yLjQ2XSxbJ2MnLDAuMDksLTEuNDEsMS4xMSwtMi41OCwyLjQwLC0yLjc5XSxbJ2MnLDAuMzAsLTAuMDYsMC44NCwtMC4wMywxLjIzLDAuMDZdLFsnYycsMC41NCwwLjEyLDEuMDgsMC4zMywxLjUzLDAuNjNdLFsnYycsMC4xMiwwLjA5LDAuMjQsMC4xNSwwLjI0LDAuMTJdLFsnYycsMC4wMCwwLjAwLC0wLjEyLC04LjM3LC0wLjE4LC05Ljc1XSxbJ2wnLDAuMDAsLTAuNjZdLFsnbCcsMC4xMiwtMC4wNl0sWydjJywwLjA2LC0wLjAzLDAuMTgsLTAuMDksMC4yNywtMC4xMl0sWyd6J10sWydtJywtMS42NSwxMC45NV0sWydjJywtMC42MCwtMC4xOCwtMS4wOCwwLjA5LC0xLjM4LDAuNjldLFsnYycsLTAuMjcsMC42MCwtMC4zNiwxLjM4LC0wLjE4LDIuMDddLFsnYycsMC4xMiwwLjQyLDAuNDIsMC45OSwwLjcyLDEuNDFdLFsnYycsMC4zMCwwLjQyLDAuOTMsMS4wNSwxLjU2LDEuNTldLFsnbCcsMC40OCwwLjM5XSxbJ2wnLDAuMDAsLTAuMTJdLFsnYycsMC4wMywtMC4wOSwwLjAzLC0wLjQ4LDAuMDYsLTAuOTBdLFsnYycsMC4wMywtMC41NywwLjAzLC0xLjA4LDAuMDAsLTIuMjJdLFsnYycsLTAuMDMsLTEuNjIsLTAuMDMsLTEuNjIsLTAuMjQsLTIuMDddLFsnYycsLTAuMjEsLTAuNDIsLTAuNjAsLTAuNzUsLTEuMDIsLTAuODRdLFsneiddXSx3OjYuNzI4LGg6MTguODAxfSxcblx0XHQnYWNjaWRlbnRhbHMuZGJsZmxhdCc6e2Q6W1snTScsLTAuMzYsLTE0LjA3XSxbJ2MnLDAuMzMsLTAuMDYsMC44NywwLjAwLDEuMDgsMC4xNV0sWydjJywwLjA2LDAuMDMsMC4wNiwwLjMzLC0wLjAzLDQuODldLFsnYycsLTAuMDYsMi42NywtMC4wOSw1LjAxLC0wLjA5LDUuMjJdLFsnbCcsMC4wMCwwLjM2XSxbJ2wnLDAuMTUsLTAuMTVdLFsnYycsMC4zNiwtMC4zMCwwLjc1LC0wLjUxLDEuMjAsLTAuNjNdLFsnYycsMC4zMywtMC4wOSwwLjk2LC0wLjA5LDEuMjYsLTAuMDNdLFsnYycsMC4yNywwLjA5LDAuNjMsMC4yNywwLjg3LDAuNDVdLFsnbCcsMC4yMSwwLjE1XSxbJ2wnLDAuMDAsLTAuMjddLFsnYycsMC4wMCwtMC4xNSwtMC4wMywtMi40MywtMC4wOSwtNS4xMF0sWydjJywtMC4wOSwtNC41NiwtMC4wOSwtNC44NiwtMC4wMywtNC44OV0sWydjJywwLjE1LC0wLjEyLDAuMzksLTAuMTUsMC43MiwtMC4xNV0sWydjJywwLjMwLDAuMDAsMC41NCwwLjAzLDAuNjksMC4xNV0sWydjJywwLjA2LDAuMDMsMC4wNiwwLjMzLC0wLjAzLDQuOTVdLFsnYycsLTAuMDYsMi43MCwtMC4wOSw1LjA0LC0wLjA5LDUuMjJdLFsnbCcsMC4wMywwLjMwXSxbJ2wnLDAuMjEsLTAuMTVdLFsnYycsMC42OSwtMC40OCwxLjQ0LC0wLjY5LDIuMjgsLTAuNjldLFsnYycsMC41MSwwLjAwLDAuNzgsMC4wMywxLjIwLDAuMjFdLFsnYycsMS4zMiwwLjYzLDIuMDEsMi4yOCwxLjUzLDMuNjldLFsnYycsLTAuMjEsMC41NywtMC41MSwxLjAyLC0xLjA1LDEuNTZdLFsnYycsLTAuNDIsMC40MiwtMC44MSwwLjcyLC0xLjkyLDEuNTBdLFsnYycsLTEuMjYsMC44NywtMS41MCwxLjA4LC0xLjg2LDEuNTBdLFsnYycsLTAuMzksMC40NSwtMC41NCwwLjU0LC0wLjgxLDAuNTFdLFsnYycsLTAuMTgsMC4wMCwtMC4yMSwwLjAwLC0wLjMzLC0wLjA2XSxbJ2wnLC0wLjIxLC0wLjIxXSxbJ2wnLC0wLjA2LC0wLjEyXSxbJ2wnLC0wLjAzLC0wLjk5XSxbJ2MnLC0wLjAzLC0wLjU0LC0wLjAzLC0xLjI5LC0wLjA2LC0xLjY4XSxbJ2wnLDAuMDAsLTAuNjldLFsnbCcsLTAuMjEsMC4yNF0sWydjJywtMC4zNiwwLjQyLC0wLjc1LDAuNzUsLTEuODAsMS42Ml0sWydjJywtMS4wMiwwLjg0LC0xLjIwLDAuOTksLTEuNDQsMS4zOF0sWydjJywtMC4zNiwwLjUxLC0wLjU0LDAuNjAsLTAuOTAsMC41MV0sWydjJywtMC4xNSwtMC4wMywtMC4zOSwtMC4yNywtMC40MiwtMC40Ml0sWydjJywtMC4wMywtMC4wNiwtMC4wOSwtMy4yNywtMC4xOCwtOC4zNF0sWydjJywtMC4wOSwtNC41MywtMC4xNSwtOC41OCwtMC4xOCwtOS4wM10sWydsJywwLjAwLC0wLjc4XSxbJ2wnLDAuMTIsLTAuMDZdLFsnYycsMC4wNiwtMC4wMywwLjE4LC0wLjA5LDAuMjcsLTAuMTJdLFsneiddLFsnbScsMi41MiwxMC45OF0sWydjJywtMC4xOCwtMC4wOSwtMC40OCwtMC4xMiwtMC42NiwtMC4wNl0sWydjJywtMC4zOSwwLjE1LC0wLjY5LDAuNTQsLTAuODQsMS4xNF0sWydjJywtMC4wNiwwLjI0LC0wLjA2LDAuMzksLTAuMDksMS43NF0sWydjJywtMC4wMywxLjQ0LDAuMDAsMi43MywwLjA2LDMuMThdLFsnbCcsMC4wMywwLjE1XSxbJ2wnLDAuMjcsLTAuMjddLFsnYycsMC45MywtMC45NiwxLjUwLC0xLjk1LDEuNzQsLTMuMDZdLFsnYycsMC4wNiwtMC4yNywwLjA2LC0wLjM5LDAuMDYsLTAuOTZdLFsnYycsMC4wMCwtMC41NCwwLjAwLC0wLjY5LC0wLjA2LC0wLjkzXSxbJ2MnLC0wLjA5LC0wLjUxLC0wLjI3LC0wLjgxLC0wLjUxLC0wLjkzXSxbJ3onXSxbJ20nLDUuNDMsMC4wMF0sWydjJywtMC4xOCwtMC4wOSwtMC41MSwtMC4xMiwtMC43MiwtMC4wNl0sWydjJywtMC41NCwwLjEyLC0wLjk2LDAuNjMsLTEuMTcsMS4yNl0sWydjJywtMC4wNiwwLjMwLC0wLjEyLDIuODgsLTAuMDYsMy45MF0sWydjJywwLjAzLDAuNDIsMC4wMywwLjgxLDAuMDYsMC45MF0sWydsJywwLjAzLDAuMTJdLFsnbCcsMC4zNiwtMC4zMF0sWydjJywwLjQyLC0wLjM2LDEuMDIsLTAuOTYsMS4yOSwtMS4yOV0sWydjJywwLjM2LC0wLjQ1LDAuNjYsLTAuOTksMC44MSwtMS40MV0sWydjJywwLjQyLC0xLjIzLDAuMTUsLTIuNzYsLTAuNjAsLTMuMTJdLFsneiddXSx3OjExLjYxMyxoOjE4LjgwNH0sXG5cdFx0J2FjY2lkZW50YWxzLmRibHNoYXJwJzp7ZDpbWydNJywtMC4xOCwtMy45Nl0sWydjJywwLjA2LC0wLjAzLDAuMTIsLTAuMDYsMC4xNSwtMC4wNl0sWydjJywwLjA5LDAuMDAsMi43NiwwLjI3LDIuNzksMC4zMF0sWydjJywwLjEyLDAuMDMsMC4xNSwwLjEyLDAuMTUsMC41MV0sWydjJywwLjA2LDAuOTYsMC4yNCwxLjU5LDAuNTcsMi4xMF0sWydjJywwLjA2LDAuMDksMC4xNSwwLjIxLDAuMTgsMC4yNF0sWydsJywwLjA5LDAuMDZdLFsnbCcsMC4wOSwtMC4wNl0sWydjJywwLjAzLC0wLjAzLDAuMTIsLTAuMTUsMC4xOCwtMC4yNF0sWydjJywwLjMzLC0wLjUxLDAuNTEsLTEuMTQsMC41NywtMi4xMF0sWydjJywwLjAwLC0wLjM5LDAuMDMsLTAuNDUsMC4xMiwtMC41MV0sWydjJywwLjAzLDAuMDAsMC42NiwtMC4wOSwxLjQ0LC0wLjE1XSxbJ2MnLDEuNDcsLTAuMTUsMS41MCwtMC4xNSwxLjU2LC0wLjAzXSxbJ2MnLDAuMDMsMC4wNiwwLjAwLDAuNDIsLTAuMDksMS40NF0sWydjJywtMC4wOSwwLjcyLC0wLjE1LDEuMzUsLTAuMTUsMS4zOF0sWydjJywwLjAwLDAuMDMsLTAuMDMsMC4wOSwtMC4wNiwwLjEyXSxbJ2MnLC0wLjA2LDAuMDYsLTAuMTIsMC4wOSwtMC41MSwwLjA5XSxbJ2MnLC0xLjA4LDAuMDYsLTEuODAsMC4zMCwtMi4yOCwwLjc1XSxbJ2wnLC0wLjEyLDAuMDldLFsnbCcsMC4wOSwwLjA5XSxbJ2MnLDAuMTIsMC4xNSwwLjM5LDAuMzMsMC42MywwLjQ1XSxbJ2MnLDAuNDIsMC4xOCwwLjk2LDAuMjcsMS42OCwwLjMzXSxbJ2MnLDAuMzksMC4wMCwwLjQ1LDAuMDMsMC41MSwwLjA5XSxbJ2MnLDAuMDMsMC4wMywwLjA2LDAuMDksMC4wNiwwLjEyXSxbJ2MnLDAuMDAsMC4wMywwLjA2LDAuNjYsMC4xNSwxLjM4XSxbJ2MnLDAuMDksMS4wMiwwLjEyLDEuMzgsMC4wOSwxLjQ0XSxbJ2MnLC0wLjA2LDAuMTIsLTAuMDksMC4xMiwtMS41NiwtMC4wM10sWydjJywtMC43OCwtMC4wNiwtMS40MSwtMC4xNSwtMS40NCwtMC4xNV0sWydjJywtMC4wOSwtMC4wNiwtMC4xMiwtMC4xMiwtMC4xMiwtMC41NF0sWydjJywtMC4wNiwtMC45MywtMC4yNCwtMS41NiwtMC41NywtMi4wN10sWydjJywtMC4wNiwtMC4wOSwtMC4xNSwtMC4yMSwtMC4xOCwtMC4yNF0sWydsJywtMC4wOSwtMC4wNl0sWydsJywtMC4wOSwwLjA2XSxbJ2MnLC0wLjAzLDAuMDMsLTAuMTIsMC4xNSwtMC4xOCwwLjI0XSxbJ2MnLC0wLjMzLDAuNTEsLTAuNTEsMS4xNCwtMC41NywyLjA3XSxbJ2MnLDAuMDAsMC40MiwtMC4wMywwLjQ4LC0wLjEyLDAuNTRdLFsnYycsLTAuMDMsMC4wMCwtMC42NiwwLjA5LC0xLjQ0LDAuMTVdLFsnYycsLTEuNDcsMC4xNSwtMS41MCwwLjE1LC0xLjU2LDAuMDNdLFsnYycsLTAuMDMsLTAuMDYsMC4wMCwtMC40MiwwLjA5LC0xLjQ0XSxbJ2MnLDAuMDksLTAuNzIsMC4xNSwtMS4zNSwwLjE1LC0xLjM4XSxbJ2MnLDAuMDAsLTAuMDMsMC4wMywtMC4wOSwwLjA2LC0wLjEyXSxbJ2MnLDAuMDYsLTAuMDYsMC4xMiwtMC4wOSwwLjUxLC0wLjA5XSxbJ2MnLDAuNzIsLTAuMDYsMS4yNiwtMC4xNSwxLjY4LC0wLjMzXSxbJ2MnLDAuMjQsLTAuMTIsMC41MSwtMC4zMCwwLjYzLC0wLjQ1XSxbJ2wnLDAuMDksLTAuMDldLFsnbCcsLTAuMTIsLTAuMDldLFsnYycsLTAuNDgsLTAuNDUsLTEuMjAsLTAuNjksLTIuMjgsLTAuNzVdLFsnYycsLTAuMzksMC4wMCwtMC40NSwtMC4wMywtMC41MSwtMC4wOV0sWydjJywtMC4wMywtMC4wMywtMC4wNiwtMC4wOSwtMC4wNiwtMC4xMl0sWydjJywwLjAwLC0wLjAzLC0wLjA2LC0wLjYzLC0wLjEyLC0xLjM4XSxbJ2MnLC0wLjA5LC0wLjcyLC0wLjE1LC0xLjM1LC0wLjE1LC0xLjM4XSxbJ3onXV0sdzo3Ljk1LGg6Ny45Nzd9LFxuXHRcdCdkb3RzLmRvdCc6e2Q6W1snTScsMS4zMiwtMS42OF0sWydjJywwLjA5LC0wLjAzLDAuMjcsLTAuMDYsMC4zOSwtMC4wNl0sWydjJywwLjk2LDAuMDAsMS43NCwwLjc4LDEuNzQsMS43MV0sWydjJywwLjAwLDAuOTYsLTAuNzgsMS43NCwtMS43MSwxLjc0XSxbJ2MnLC0wLjk2LDAuMDAsLTEuNzQsLTAuNzgsLTEuNzQsLTEuNzFdLFsnYycsMC4wMCwtMC43OCwwLjU0LC0xLjUwLDEuMzIsLTEuNjhdLFsneiddXSx3OjMuNDUsaDozLjQ1fSxcblx0XHQnbm90ZWhlYWRzLmRibCc6e2Q6W1snTScsLTAuNjksLTQuMDJdLFsnYycsMC4xOCwtMC4wOSwwLjM2LC0wLjA5LDAuNTQsMC4wMF0sWydjJywwLjE4LDAuMDksMC4yNCwwLjE1LDAuMzMsMC4zMF0sWydjJywwLjA2LDAuMTUsMC4wNiwwLjE4LDAuMDYsMS40MV0sWydsJywwLjAwLDEuMjNdLFsnbCcsMC4xMiwtMC4xOF0sWydjJywwLjcyLC0xLjI2LDIuNjQsLTIuMzEsNC44NiwtMi42NF0sWydjJywwLjgxLC0wLjE1LDEuMTEsLTAuMTUsMi4xMywtMC4xNV0sWydjJywwLjk5LDAuMDAsMS4yOSwwLjAwLDIuMTAsMC4xNV0sWydjJywwLjc1LDAuMTIsMS4zOCwwLjI3LDIuMDQsMC41NF0sWydjJywxLjM1LDAuNTEsMi4zNCwxLjI2LDIuODIsMi4xMF0sWydsJywwLjEyLDAuMThdLFsnbCcsMC4wMCwtMS4yM10sWydjJywwLjAwLC0xLjIwLDAuMDAsLTEuMjYsMC4wNiwtMS4zOF0sWydjJywwLjA5LC0wLjE4LDAuMTUsLTAuMjQsMC4zMywtMC4zM10sWydjJywwLjE4LC0wLjA5LDAuMzYsLTAuMDksMC41NCwwLjAwXSxbJ2MnLDAuMTgsMC4wOSwwLjI0LDAuMTUsMC4zMywwLjMwXSxbJ2wnLDAuMDYsMC4xNV0sWydsJywwLjAwLDMuNTRdLFsnbCcsMC4wMCwzLjU0XSxbJ2wnLC0wLjA2LDAuMTVdLFsnYycsLTAuMDksMC4xOCwtMC4xNSwwLjI0LC0wLjMzLDAuMzNdLFsnYycsLTAuMTgsMC4wOSwtMC4zNiwwLjA5LC0wLjU0LDAuMDBdLFsnYycsLTAuMTgsLTAuMDksLTAuMjQsLTAuMTUsLTAuMzMsLTAuMzNdLFsnYycsLTAuMDYsLTAuMTIsLTAuMDYsLTAuMTgsLTAuMDYsLTEuMzhdLFsnbCcsMC4wMCwtMS4yM10sWydsJywtMC4xMiwwLjE4XSxbJ2MnLC0wLjQ4LDAuODQsLTEuNDcsMS41OSwtMi44MiwyLjEwXSxbJ2MnLC0wLjg0LDAuMzMsLTEuNzEsMC41NCwtMi44NSwwLjY2XSxbJ2MnLC0wLjQ1LDAuMDYsLTIuMTYsMC4wNiwtMi42MSwwLjAwXSxbJ2MnLC0xLjE0LC0wLjEyLC0yLjAxLC0wLjMzLC0yLjg1LC0wLjY2XSxbJ2MnLC0xLjM1LC0wLjUxLC0yLjM0LC0xLjI2LC0yLjgyLC0yLjEwXSxbJ2wnLC0wLjEyLC0wLjE4XSxbJ2wnLDAuMDAsMS4yM10sWydjJywwLjAwLDEuMjMsMC4wMCwxLjI2LC0wLjA2LDEuMzhdLFsnYycsLTAuMDksMC4xOCwtMC4xNSwwLjI0LC0wLjMzLDAuMzNdLFsnYycsLTAuMTgsMC4wOSwtMC4zNiwwLjA5LC0wLjU0LDAuMDBdLFsnYycsLTAuMTgsLTAuMDksLTAuMjQsLTAuMTUsLTAuMzMsLTAuMzNdLFsnbCcsLTAuMDYsLTAuMTVdLFsnbCcsMC4wMCwtMy41NF0sWydjJywwLjAwLC0zLjQ4LDAuMDAsLTMuNTQsMC4wNiwtMy42Nl0sWydjJywwLjA5LC0wLjE4LDAuMTUsLTAuMjQsMC4zMywtMC4zM10sWyd6J10sWydtJyw3LjcxLDAuNjNdLFsnYycsLTAuMzYsLTAuMDYsLTAuOTAsLTAuMDYsLTEuMTQsMC4wMF0sWydjJywtMC4zMCwwLjAzLC0wLjY2LDAuMjQsLTAuODcsMC40Ml0sWydjJywtMC42MCwwLjU0LC0wLjkwLDEuNjIsLTAuNzUsMi44Ml0sWydjJywwLjEyLDAuOTMsMC41MSwxLjY4LDEuMTEsMi4zMV0sWydjJywwLjc1LDAuNzIsMS44MywxLjIwLDIuODUsMS4yNl0sWydjJywxLjA1LDAuMDYsMS44MywtMC41NCwyLjEwLC0xLjY1XSxbJ2MnLDAuMjEsLTAuOTAsMC4xMiwtMS45NSwtMC4yNCwtMi44Ml0sWydjJywtMC4zNiwtMC44MSwtMS4wOCwtMS41MywtMS45NSwtMS45NV0sWydjJywtMC4zMCwtMC4xNSwtMC43OCwtMC4zMCwtMS4xMSwtMC4zOV0sWyd6J11dLHc6MTYuODMsaDo4LjE0NX0sXG5cdFx0J25vdGVoZWFkcy53aG9sZSc6e2Q6W1snTScsNi41MSwtNC4wNV0sWydjJywwLjUxLC0wLjAzLDIuMDEsMC4wMCwyLjUyLDAuMDNdLFsnYycsMS40MSwwLjE4LDIuNjQsMC41MSwzLjcyLDEuMDhdLFsnYycsMS4yMCwwLjYzLDEuOTUsMS40MSwyLjE5LDIuMzFdLFsnYycsMC4wOSwwLjMzLDAuMDksMC45MCwwLjAwLDEuMjNdLFsnYycsLTAuMjQsMC45MCwtMC45OSwxLjY4LC0yLjE5LDIuMzFdLFsnYycsLTEuMDgsMC41NywtMi4yOCwwLjkwLC0zLjc1LDEuMDhdLFsnYycsLTAuNjYsMC4wNiwtMi4zMSwwLjA2LC0yLjk3LDAuMDBdLFsnYycsLTEuNDcsLTAuMTgsLTIuNjcsLTAuNTEsLTMuNzUsLTEuMDhdLFsnYycsLTEuMjAsLTAuNjMsLTEuOTUsLTEuNDEsLTIuMTksLTIuMzFdLFsnYycsLTAuMDksLTAuMzMsLTAuMDksLTAuOTAsMC4wMCwtMS4yM10sWydjJywwLjI0LC0wLjkwLDAuOTksLTEuNjgsMi4xOSwtMi4zMV0sWydjJywxLjIwLC0wLjYzLDIuNjEsLTAuOTksNC4yMywtMS4xMV0sWyd6J10sWydtJywwLjU3LDAuNjZdLFsnYycsLTAuODcsLTAuMTUsLTEuNTMsMC4wMCwtMi4wNCwwLjUxXSxbJ2MnLC0wLjE1LDAuMTUsLTAuMjQsMC4yNywtMC4zMywwLjQ4XSxbJ2MnLC0wLjI0LDAuNTEsLTAuMzYsMS4wOCwtMC4zMywxLjc3XSxbJ2MnLDAuMDMsMC42OSwwLjE4LDEuMjYsMC40MiwxLjc3XSxbJ2MnLDAuNjAsMS4xNywxLjc0LDEuOTgsMy4xOCwyLjIyXSxbJ2MnLDEuMTEsMC4yMSwxLjk1LC0wLjE1LDIuMzQsLTAuOTldLFsnYycsMC4yNCwtMC41MSwwLjM2LC0xLjA4LDAuMzMsLTEuODBdLFsnYycsLTAuMDYsLTEuMTEsLTAuNDUsLTIuMDQsLTEuMTcsLTIuNzZdLFsnYycsLTAuNjMsLTAuNjMsLTEuNDcsLTEuMDUsLTIuNDAsLTEuMjBdLFsneiddXSx3OjE0Ljk4NSxoOjguMDk3fSxcblx0XHQnbm90ZWhlYWRzLmhhbGYnOntkOltbJ00nLDcuNDQsLTQuMDVdLFsnYycsMC4wNiwtMC4wMywwLjI3LC0wLjAzLDAuNDgsLTAuMDNdLFsnYycsMS4wNSwwLjAwLDEuNzEsMC4yNCwyLjEwLDAuODFdLFsnYycsMC40MiwwLjYwLDAuNDUsMS4zNSwwLjE4LDIuNDBdLFsnYycsLTAuNDIsMS41OSwtMS4xNCwyLjczLC0yLjE2LDMuMzldLFsnYycsLTEuNDEsMC45MywtMy4xOCwxLjQ0LC01LjQwLDEuNTNdLFsnYycsLTEuMTcsMC4wMywtMS44OSwtMC4yMSwtMi4yOCwtMC44MV0sWydjJywtMC40MiwtMC42MCwtMC40NSwtMS4zNSwtMC4xOCwtMi40MF0sWydjJywwLjQyLC0xLjU5LDEuMTQsLTIuNzMsMi4xNiwtMy4zOV0sWydjJywwLjYzLC0wLjQyLDEuMjMsLTAuNzIsMS45OCwtMC45Nl0sWydjJywwLjkwLC0wLjMwLDEuNjUsLTAuNDIsMy4xMiwtMC41NF0sWyd6J10sWydtJywxLjI5LDAuODddLFsnYycsLTAuMjcsLTAuMDksLTAuNjMsLTAuMTIsLTAuOTAsLTAuMDNdLFsnYycsLTAuNzIsMC4yNCwtMS41MywwLjY5LC0zLjI3LDEuODBdLFsnYycsLTIuMzQsMS41MCwtMy4zMCwyLjI1LC0zLjU3LDIuNzldLFsnYycsLTAuMzYsMC43MiwtMC4wNiwxLjUwLDAuNjYsMS43N10sWydjJywwLjI0LDAuMTIsMC42OSwwLjA5LDAuOTksMC4wMF0sWydjJywwLjg0LC0wLjMwLDEuOTIsLTAuOTMsNC4xNCwtMi4zN10sWydjJywxLjYyLC0xLjA4LDIuMzcsLTEuNzEsMi42MSwtMi4xOV0sWydjJywwLjM2LC0wLjcyLDAuMDYsLTEuNTAsLTAuNjYsLTEuNzddLFsneiddXSx3OjEwLjM3LGg6OC4xMzJ9LFxuXHRcdCdub3RlaGVhZHMucXVhcnRlcic6e2Q6W1snTScsNi4wOSwtNC4wNV0sWydjJywwLjM2LC0wLjAzLDEuMjAsMC4wMCwxLjUzLDAuMDZdLFsnYycsMS4xNywwLjI0LDEuODksMC44NCwyLjE2LDEuODNdLFsnYycsMC4wNiwwLjE4LDAuMDYsMC4zMCwwLjA2LDAuNjZdLFsnYycsMC4wMCwwLjQ1LDAuMDAsMC42MywtMC4xNSwxLjA4XSxbJ2MnLC0wLjY2LDIuMDQsLTMuMDYsMy45MywtNS41Miw0LjM4XSxbJ2MnLC0wLjU0LDAuMDksLTEuNDQsMC4wOSwtMS44MywwLjAzXSxbJ2MnLC0xLjIzLC0wLjI3LC0xLjk4LC0wLjg3LC0yLjI1LC0xLjg2XSxbJ2MnLC0wLjA2LC0wLjE4LC0wLjA2LC0wLjMwLC0wLjA2LC0wLjY2XSxbJ2MnLDAuMDAsLTAuNDUsMC4wMCwtMC42MywwLjE1LC0xLjA4XSxbJ2MnLDAuMjQsLTAuNzgsMC43NSwtMS41MywxLjQ0LC0yLjIyXSxbJ2MnLDEuMjAsLTEuMjAsMi44NSwtMi4wMSw0LjQ3LC0yLjIyXSxbJ3onXV0sdzo5LjgxLGg6OC4wOTR9LFxuXHRcdCdub3RlaGVhZHMuc2xhc2gubm9zdGVtJzp7ZDpbWydNJyw5LjMwLC03Ljc3XSxbJ2MnLDAuMDYsLTAuMDYsMC4xOCwtMC4wNiwxLjcxLC0wLjA2XSxbJ2wnLDEuNjUsMC4wMF0sWydsJywwLjA5LDAuMDldLFsnYycsMC4wNiwwLjA2LDAuMDYsMC4wOSwwLjA2LDAuMTVdLFsnYycsLTAuMDMsMC4xMiwtOS4yMSwxNS4yNCwtOS4zMCwxNS4zM10sWydjJywtMC4wNiwwLjA2LC0wLjE4LDAuMDYsLTEuNzEsMC4wNl0sWydsJywtMS42NSwwLjAwXSxbJ2wnLC0wLjA5LC0wLjA5XSxbJ2MnLC0wLjA2LC0wLjA2LC0wLjA2LC0wLjA5LC0wLjA2LC0wLjE1XSxbJ2MnLDAuMDMsLTAuMTIsOS4yMSwtMTUuMjQsOS4zMCwtMTUuMzNdLFsneiddXSx3OjEyLjgxLGg6MTUuNjN9LFxuXHRcdCdub3RlaGVhZHMuaW5kZXRlcm1pbmF0ZSc6e2Q6W1snTScsMC43OCwtNC4wNV0sWydjJywwLjEyLC0wLjAzLDAuMjQsLTAuMDMsMC4zNiwwLjAzXSxbJ2MnLDAuMDMsMC4wMywwLjkzLDAuNzIsMS45NSwxLjU2XSxbJ2wnLDEuODYsMS41MF0sWydsJywxLjg2LC0xLjUwXSxbJ2MnLDEuMDIsLTAuODQsMS45MiwtMS41MywxLjk1LC0xLjU2XSxbJ2MnLDAuMjEsLTAuMTIsMC4zMywtMC4wOSwwLjc1LDAuMjRdLFsnYycsMC4zMCwwLjI3LDAuMzYsMC4zNiwwLjM2LDAuNTRdLFsnYycsMC4wMCwwLjAzLC0wLjAzLDAuMTIsLTAuMDYsMC4xOF0sWydjJywtMC4wMywwLjA2LC0wLjkwLDAuNzUsLTEuODksMS41Nl0sWydsJywtMS44MCwxLjQ3XSxbJ2MnLDAuMDAsMC4wMywwLjgxLDAuNjksMS44MCwxLjUwXSxbJ2MnLDAuOTksMC44MSwxLjg2LDEuNTAsMS44OSwxLjU2XSxbJ2MnLDAuMDMsMC4wNiwwLjA2LDAuMTUsMC4wNiwwLjE4XSxbJ2MnLDAuMDAsMC4xOCwtMC4wNiwwLjI3LC0wLjM2LDAuNTRdLFsnYycsLTAuNDIsMC4zMywtMC41NCwwLjM2LC0wLjc1LDAuMjRdLFsnYycsLTAuMDMsLTAuMDMsLTAuOTMsLTAuNzIsLTEuOTUsLTEuNTZdLFsnbCcsLTEuODYsLTEuNTBdLFsnbCcsLTEuODYsMS41MF0sWydjJywtMS4wMiwwLjg0LC0xLjkyLDEuNTMsLTEuOTUsMS41Nl0sWydjJywtMC4yMSwwLjEyLC0wLjMzLDAuMDksLTAuNzUsLTAuMjRdLFsnYycsLTAuMzAsLTAuMjcsLTAuMzYsLTAuMzYsLTAuMzYsLTAuNTRdLFsnYycsMC4wMCwtMC4wMywwLjAzLC0wLjEyLDAuMDYsLTAuMThdLFsnYycsMC4wMywtMC4wNiwwLjkwLC0wLjc1LDEuODksLTEuNTZdLFsnbCcsMS44MCwtMS40N10sWydjJywwLjAwLC0wLjAzLC0wLjgxLC0wLjY5LC0xLjgwLC0xLjUwXSxbJ2MnLC0wLjk5LC0wLjgxLC0xLjg2LC0xLjUwLC0xLjg5LC0xLjU2XSxbJ2MnLC0wLjA2LC0wLjEyLC0wLjA5LC0wLjIxLC0wLjAzLC0wLjM2XSxbJ2MnLDAuMDMsLTAuMDksMC41NywtMC41NywwLjcyLC0wLjYzXSxbJ3onXV0sdzo5Ljg0MyxoOjguMTM5fSxcblx0XHQnc2NyaXB0cy51ZmVybWF0YSc6e2Q6W1snTScsLTAuNzUsLTEwLjc3XSxbJ2MnLDAuMTIsMC4wMCwwLjQ1LC0wLjAzLDAuNjksLTAuMDNdLFsnYycsMi45MSwtMC4wMyw1LjU1LDEuNTMsNy40MSw0LjM1XSxbJ2MnLDEuMTcsMS43MSwxLjk1LDMuNzIsMi40Myw2LjAzXSxbJ2MnLDAuMTIsMC41MSwwLjEyLDAuNTcsMC4wMywwLjY5XSxbJ2MnLC0wLjEyLDAuMjEsLTAuNDgsMC4yNywtMC42OSwwLjEyXSxbJ2MnLC0wLjEyLC0wLjA5LC0wLjE4LC0wLjI0LC0wLjI3LC0wLjY5XSxbJ2MnLC0wLjc4LC0zLjYzLC0zLjQyLC02LjU0LC02Ljc4LC03LjM4XSxbJ2MnLC0wLjc4LC0wLjIxLC0xLjIwLC0wLjI0LC0yLjA3LC0wLjI0XSxbJ2MnLC0wLjYzLDAuMDAsLTAuODQsMC4wMCwtMS4yMCwwLjA2XSxbJ2MnLC0xLjgzLDAuMjcsLTMuNDIsMS4wOCwtNC44MCwyLjM3XSxbJ2MnLC0xLjQxLDEuMzUsLTIuNDAsMy4yMSwtMi44NSw1LjE5XSxbJ2MnLC0wLjA5LDAuNDUsLTAuMTUsMC42MCwtMC4yNywwLjY5XSxbJ2MnLC0wLjIxLDAuMTUsLTAuNTcsMC4wOSwtMC42OSwtMC4xMl0sWydjJywtMC4wOSwtMC4xMiwtMC4wOSwtMC4xOCwwLjAzLC0wLjY5XSxbJ2MnLDAuMzMsLTEuNjIsMC43OCwtMy4wMCwxLjQ3LC00LjM4XSxbJ2MnLDEuNzcsLTMuNTQsNC40NCwtNS42Nyw3LjU2LC01Ljk3XSxbJ3onXSxbJ20nLDAuMzMsNy40N10sWydjJywxLjM4LC0wLjMwLDIuNTgsMC45MCwyLjMxLDIuMjVdLFsnYycsLTAuMTUsMC43MiwtMC43OCwxLjM1LC0xLjQ3LDEuNTBdLFsnYycsLTEuMzgsMC4yNywtMi41OCwtMC45MywtMi4zMSwtMi4zMV0sWydjJywwLjE1LC0wLjY5LDAuNzgsLTEuMjksMS40NywtMS40NF0sWyd6J11dLHc6MTkuNzQ4LGg6MTEuMjg5fSxcblx0XHQnc2NyaXB0cy5kZmVybWF0YSc6e2Q6W1snTScsLTkuNjMsLTAuNDJdLFsnYycsMC4xNSwtMC4wOSwwLjM2LC0wLjA2LDAuNTEsMC4wM10sWydjJywwLjEyLDAuMDksMC4xOCwwLjI0LDAuMjcsMC42Nl0sWydjJywwLjc4LDMuNjYsMy40Miw2LjU3LDYuNzgsNy40MV0sWydjJywwLjc4LDAuMjEsMS4yMCwwLjI0LDIuMDcsMC4yNF0sWydjJywwLjYzLDAuMDAsMC44NCwwLjAwLDEuMjAsLTAuMDZdLFsnYycsMS44MywtMC4yNywzLjQyLC0xLjA4LDQuODAsLTIuMzddLFsnYycsMS40MSwtMS4zNSwyLjQwLC0zLjIxLDIuODUsLTUuMjJdLFsnYycsMC4wOSwtMC40MiwwLjE1LC0wLjU3LDAuMjcsLTAuNjZdLFsnYycsMC4yMSwtMC4xNSwwLjU3LC0wLjA5LDAuNjksMC4xMl0sWydjJywwLjA5LDAuMTIsMC4wOSwwLjE4LC0wLjAzLDAuNjldLFsnYycsLTAuMzMsMS42MiwtMC43OCwzLjAwLC0xLjQ3LDQuMzhdLFsnYycsLTEuOTIsMy44NCwtNC44OSw2LjAwLC04LjMxLDYuMDBdLFsnYycsLTMuNDIsMC4wMCwtNi4zOSwtMi4xNiwtOC4zMSwtNi4wMF0sWydjJywtMC40OCwtMC45NiwtMC44NCwtMS45MiwtMS4xNCwtMi45N10sWydjJywtMC4xOCwtMC42OSwtMC40MiwtMS43NCwtMC40MiwtMS45Ml0sWydjJywwLjAwLC0wLjEyLDAuMDksLTAuMjcsMC4yNCwtMC4zM10sWyd6J10sWydtJyw5LjIxLDAuMDBdLFsnYycsMS4yMCwtMC4yNywyLjM0LDAuNjMsMi4zNCwxLjg2XSxbJ2MnLDAuMDAsMC45MCwtMC42NiwxLjY4LC0xLjUwLDEuODldLFsnYycsLTEuMzgsMC4yNywtMi41OCwtMC45MywtMi4zMSwtMi4zMV0sWydjJywwLjE1LC0wLjY5LDAuNzgsLTEuMjksMS40NywtMS40NF0sWyd6J11dLHc6MTkuNzQ0LGg6MTEuMjc0fSxcblx0XHQnc2NyaXB0cy5zZm9yemF0byc6e2Q6W1snTScsLTYuNDUsLTMuNjldLFsnYycsMC4wNiwtMC4wMywwLjE1LC0wLjA2LDAuMTgsLTAuMDZdLFsnYycsMC4wNiwwLjAwLDIuODUsMC43Miw2LjI0LDEuNTldLFsnbCcsNi4zMywxLjY1XSxbJ2MnLDAuMzMsMC4wNiwwLjQ1LDAuMjEsMC40NSwwLjUxXSxbJ2MnLDAuMDAsMC4zMCwtMC4xMiwwLjQ1LC0wLjQ1LDAuNTFdLFsnbCcsLTYuMzMsMS42NV0sWydjJywtMy4zOSwwLjg3LC02LjE4LDEuNTksLTYuMjEsMS41OV0sWydjJywtMC4yMSwwLjAwLC0wLjQ4LC0wLjI0LC0wLjUxLC0wLjQ1XSxbJ2MnLDAuMDAsLTAuMTUsMC4wNiwtMC4zNiwwLjE4LC0wLjQ1XSxbJ2MnLDAuMDksLTAuMDYsMC44NywtMC4yNywzLjg0LC0xLjA1XSxbJ2MnLDIuMDQsLTAuNTQsMy44NCwtMC45OSw0LjAyLC0xLjAyXSxbJ2MnLDAuMTUsLTAuMDYsMS4xNCwtMC4yNCwyLjIyLC0wLjQyXSxbJ2MnLDEuMDUsLTAuMTgsMS45MiwtMC4zNiwxLjkyLC0wLjM2XSxbJ2MnLDAuMDAsMC4wMCwtMC44NywtMC4xOCwtMS45MiwtMC4zNl0sWydjJywtMS4wOCwtMC4xOCwtMi4wNywtMC4zNiwtMi4yMiwtMC40Ml0sWydjJywtMC4xOCwtMC4wMywtMS45OCwtMC40OCwtNC4wMiwtMS4wMl0sWydjJywtMi45NywtMC43OCwtMy43NSwtMC45OSwtMy44NCwtMS4wNV0sWydjJywtMC4xMiwtMC4wOSwtMC4xOCwtMC4zMCwtMC4xOCwtMC40NV0sWydjJywwLjAzLC0wLjE1LDAuMTUsLTAuMzAsMC4zMCwtMC4zOV0sWyd6J11dLHc6MTMuNSxoOjcuNX0sXG5cdFx0J3NjcmlwdHMuc3RhY2NhdG8nOntkOltbJ00nLC0wLjM2LC0xLjQ3XSxbJ2MnLDAuOTMsLTAuMjEsMS44NiwwLjUxLDEuODYsMS40N10sWydjJywwLjAwLDAuOTMsLTAuODcsMS42NSwtMS44MCwxLjQ3XSxbJ2MnLC0wLjU0LC0wLjEyLC0xLjAyLC0wLjU3LC0xLjE0LC0xLjA4XSxbJ2MnLC0wLjIxLC0wLjgxLDAuMjcsLTEuNjUsMS4wOCwtMS44Nl0sWyd6J11dLHc6Mi45ODksaDozLjAwNH0sXG5cdFx0J3NjcmlwdHMudGVudXRvJzp7ZDpbWydNJywtNC4yMCwtMC40OF0sWydsJywwLjEyLC0wLjA2XSxbJ2wnLDQuMDgsMC4wMF0sWydsJyw0LjA4LDAuMDBdLFsnbCcsMC4xMiwwLjA2XSxbJ2MnLDAuMzksMC4yMSwwLjM5LDAuNzUsMC4wMCwwLjk2XSxbJ2wnLC0wLjEyLDAuMDZdLFsnbCcsLTQuMDgsMC4wMF0sWydsJywtNC4wOCwwLjAwXSxbJ2wnLC0wLjEyLC0wLjA2XSxbJ2MnLC0wLjM5LC0wLjIxLC0wLjM5LC0wLjc1LDAuMDAsLTAuOTZdLFsneiddXSx3OjguOTg1LGg6MS4wOH0sXG5cdFx0J3NjcmlwdHMudW1hcmNhdG8nOntkOltbJ00nLC0wLjE1LC04LjE5XSxbJ2MnLDAuMTUsLTAuMTIsMC4zNiwtMC4wMywwLjQ1LDAuMTVdLFsnYycsMC4yMSwwLjQyLDMuNDUsNy42NSwzLjQ1LDcuNzFdLFsnYycsMC4wMCwwLjEyLC0wLjEyLDAuMjcsLTAuMjEsMC4zMF0sWydjJywtMC4wMywwLjAzLC0wLjUxLDAuMDMsLTEuMTQsMC4wM10sWydjJywtMS4wNSwwLjAwLC0xLjA4LDAuMDAsLTEuMTcsLTAuMDZdLFsnYycsLTAuMDksLTAuMDYsLTAuMjQsLTAuMzYsLTEuMTcsLTIuNDBdLFsnYycsLTAuNTcsLTEuMjksLTEuMDUsLTIuMzQsLTEuMDgsLTIuMzRdLFsnYycsMC4wMCwtMC4wMywtMC41MSwxLjAyLC0xLjA4LDIuMzRdLFsnYycsLTAuOTMsMi4wNywtMS4wOCwyLjM0LC0xLjE0LDIuNDBdLFsnYycsLTAuMDYsMC4wMywtMC4xNSwwLjA2LC0wLjE4LDAuMDZdLFsnYycsLTAuMTUsMC4wMCwtMC4zMywtMC4xOCwtMC4zMywtMC4zM10sWydjJywwLjAwLC0wLjA2LDMuMjQsLTcuMzIsMy40NSwtNy43MV0sWydjJywwLjAzLC0wLjA2LDAuMDksLTAuMTUsMC4xNSwtMC4xNV0sWyd6J11dLHc6Ny41LGg6OC4yNDV9LFxuXHRcdCdzY3JpcHRzLmRtYXJjYXRvJzp7ZDpbWydNJywtMy41NywwLjAzXSxbJ2MnLDAuMDMsMC4wMCwwLjU3LC0wLjAzLDEuMTcsLTAuMDNdLFsnYycsMS4wNSwwLjAwLDEuMDgsMC4wMCwxLjE3LDAuMDZdLFsnYycsMC4wOSwwLjA2LDAuMjQsMC4zNiwxLjE3LDIuNDBdLFsnYycsMC41NywxLjI5LDEuMDUsMi4zNCwxLjA4LDIuMzRdLFsnYycsMC4wMCwwLjAzLDAuNTEsLTEuMDIsMS4wOCwtMi4zNF0sWydjJywwLjkzLC0yLjA3LDEuMDgsLTIuMzQsMS4xNCwtMi40MF0sWydjJywwLjA2LC0wLjAzLDAuMTUsLTAuMDYsMC4xOCwtMC4wNl0sWydjJywwLjE1LDAuMDAsMC4zMywwLjE4LDAuMzMsMC4zM10sWydjJywwLjAwLDAuMDksLTMuNDUsNy43NCwtMy41NCw3LjgzXSxbJ2MnLC0wLjEyLDAuMTIsLTAuMzAsMC4xMiwtMC40MiwwLjAwXSxbJ2MnLC0wLjA5LC0wLjA5LC0zLjU0LC03Ljc0LC0zLjU0LC03LjgzXSxbJ2MnLDAuMDAsLTAuMDksMC4xMiwtMC4yNywwLjE4LC0wLjMwXSxbJ3onXV0sdzo3LjUsaDo4LjI1fSxcblx0XHQnc2NyaXB0cy5zdG9wcGVkJzp7ZDpbWydNJywtMC4yNywtNC4wOF0sWydjJywwLjE4LC0wLjA5LDAuMzYsLTAuMDksMC41NCwwLjAwXSxbJ2MnLDAuMTgsMC4wOSwwLjI0LDAuMTUsMC4zMywwLjMwXSxbJ2wnLDAuMDYsMC4xNV0sWydsJywwLjAwLDEuNTBdLFsnbCcsMC4wMCwxLjQ3XSxbJ2wnLDEuNDcsMC4wMF0sWydsJywxLjUwLDAuMDBdLFsnbCcsMC4xNSwwLjA2XSxbJ2MnLDAuMTUsMC4wOSwwLjIxLDAuMTUsMC4zMCwwLjMzXSxbJ2MnLDAuMDksMC4xOCwwLjA5LDAuMzYsMC4wMCwwLjU0XSxbJ2MnLC0wLjA5LDAuMTgsLTAuMTUsMC4yNCwtMC4zMywwLjMzXSxbJ2MnLC0wLjEyLDAuMDYsLTAuMTgsMC4wNiwtMS42MiwwLjA2XSxbJ2wnLC0xLjQ3LDAuMDBdLFsnbCcsMC4wMCwxLjQ3XSxbJ2wnLDAuMDAsMS40N10sWydsJywtMC4wNiwwLjE1XSxbJ2MnLC0wLjA5LDAuMTgsLTAuMTUsMC4yNCwtMC4zMywwLjMzXSxbJ2MnLC0wLjE4LDAuMDksLTAuMzYsMC4wOSwtMC41NCwwLjAwXSxbJ2MnLC0wLjE4LC0wLjA5LC0wLjI0LC0wLjE1LC0wLjMzLC0wLjMzXSxbJ2wnLC0wLjA2LC0wLjE1XSxbJ2wnLDAuMDAsLTEuNDddLFsnbCcsMC4wMCwtMS40N10sWydsJywtMS40NywwLjAwXSxbJ2MnLC0xLjQ0LDAuMDAsLTEuNTAsMC4wMCwtMS42MiwtMC4wNl0sWydjJywtMC4xOCwtMC4wOSwtMC4yNCwtMC4xNSwtMC4zMywtMC4zM10sWydjJywtMC4wOSwtMC4xOCwtMC4wOSwtMC4zNiwwLjAwLC0wLjU0XSxbJ2MnLDAuMDksLTAuMTgsMC4xNSwtMC4yNCwwLjMzLC0wLjMzXSxbJ2wnLDAuMTUsLTAuMDZdLFsnbCcsMS40NywwLjAwXSxbJ2wnLDEuNDcsMC4wMF0sWydsJywwLjAwLC0xLjQ3XSxbJ2MnLDAuMDAsLTEuNDQsMC4wMCwtMS41MCwwLjA2LC0xLjYyXSxbJ2MnLDAuMDksLTAuMTgsMC4xNSwtMC4yNCwwLjMzLC0wLjMzXSxbJ3onXV0sdzo4LjI5NSxoOjguMjk1fSxcblx0XHQnc2NyaXB0cy51cGJvdyc6e2Q6W1snTScsLTQuNjUsLTE1LjU0XSxbJ2MnLDAuMTIsLTAuMDksMC4zNiwtMC4wNiwwLjQ4LDAuMDNdLFsnYycsMC4wMywwLjAzLDAuMDksMC4wOSwwLjEyLDAuMTVdLFsnYycsMC4wMywwLjA2LDAuNjYsMi4xMywxLjQxLDQuNjJdLFsnYycsMS4zNSw0LjQxLDEuMzgsNC41NiwyLjAxLDYuOTZdLFsnbCcsMC42MywyLjQ2XSxbJ2wnLDAuNjMsLTIuNDZdLFsnYycsMC42MywtMi40MCwwLjY2LC0yLjU1LDIuMDEsLTYuOTZdLFsnYycsMC43NSwtMi40OSwxLjM4LC00LjU2LDEuNDEsLTQuNjJdLFsnYycsMC4wNiwtMC4xNSwwLjE4LC0wLjIxLDAuMzYsLTAuMjRdLFsnYycsMC4xNSwwLjAwLDAuMzAsMC4wNiwwLjM5LDAuMThdLFsnYycsMC4xNSwwLjIxLDAuMjQsLTAuMTgsLTIuMTAsNy41Nl0sWydjJywtMS4yMCwzLjk2LC0yLjIyLDcuMzIsLTIuMjUsNy40MV0sWydjJywwLjAwLDAuMTIsLTAuMDYsMC4yNywtMC4wOSwwLjMwXSxbJ2MnLC0wLjEyLDAuMjEsLTAuNjAsMC4yMSwtMC43MiwwLjAwXSxbJ2MnLC0wLjAzLC0wLjAzLC0wLjA5LC0wLjE4LC0wLjA5LC0wLjMwXSxbJ2MnLC0wLjAzLC0wLjA5LC0xLjA1LC0zLjQ1LC0yLjI1LC03LjQxXSxbJ2MnLC0yLjM0LC03Ljc0LC0yLjI1LC03LjM1LC0yLjEwLC03LjU2XSxbJ2MnLDAuMDMsLTAuMDMsMC4wOSwtMC4wOSwwLjE1LC0wLjEyXSxbJ3onXV0sdzo5LjczLGg6MTUuNjA4fSxcblx0XHQnc2NyaXB0cy5kb3duYm93Jzp7ZDpbWydNJywtNS41NSwtOS45M10sWydsJywwLjA5LC0wLjA2XSxbJ2wnLDUuNDYsMC4wMF0sWydsJyw1LjQ2LDAuMDBdLFsnbCcsMC4wOSwwLjA2XSxbJ2wnLDAuMDYsMC4wOV0sWydsJywwLjAwLDQuNzddLFsnYycsMC4wMCw1LjI4LDAuMDAsNC44OSwtMC4xOCw1LjAxXSxbJ2MnLC0wLjE4LDAuMTIsLTAuNDIsMC4wNiwtMC41NCwtMC4xMl0sWydjJywtMC4wNiwtMC4wOSwtMC4wNiwtMC4xOCwtMC4wNiwtMi45N10sWydsJywwLjAwLC0yLjg1XSxbJ2wnLC00LjgzLDAuMDBdLFsnbCcsLTQuODMsMC4wMF0sWydsJywwLjAwLDIuODVdLFsnYycsMC4wMCwyLjc5LDAuMDAsMi44OCwtMC4wNiwyLjk3XSxbJ2MnLC0wLjE1LDAuMjQsLTAuNTEsMC4yNCwtMC42NiwwLjAwXSxbJ2MnLC0wLjA2LC0wLjA5LC0wLjA2LC0wLjIxLC0wLjA2LC00Ljg5XSxbJ2wnLDAuMDAsLTQuNzddLFsneiddXSx3OjExLjIyLGg6OS45OTJ9LFxuXHRcdCdzY3JpcHRzLnR1cm4nOntkOltbJ00nLC00Ljc3LC0zLjkwXSxbJ2MnLDAuMzYsLTAuMDYsMS4wNSwtMC4wNiwxLjQ0LDAuMDNdLFsnYycsMC43OCwwLjE1LDEuNTAsMC41MSwyLjM0LDEuMTRdLFsnYycsMC42MCwwLjQ1LDEuMDUsMC44NywyLjIyLDIuMDFdLFsnYycsMS4xMSwxLjA4LDEuNjIsMS41MCwyLjIyLDEuODZdLFsnYycsMC42MCwwLjM2LDEuMzIsMC41NywxLjkyLDAuNTddLFsnYycsMC45MCwwLjAwLDEuNzEsLTAuNTcsMS44OSwtMS4zNV0sWydjJywwLjI0LC0wLjkzLC0wLjM5LC0xLjg5LC0xLjM1LC0yLjEwXSxbJ2wnLC0wLjE1LC0wLjA2XSxbJ2wnLC0wLjA5LDAuMTVdLFsnYycsLTAuMDMsMC4wOSwtMC4xNSwwLjI0LC0wLjI0LDAuMzNdLFsnYycsLTAuNzIsMC43MiwtMi4wNCwwLjU0LC0yLjQ5LC0wLjM2XSxbJ2MnLC0wLjQ4LC0wLjkzLDAuMDMsLTEuODYsMS4xNywtMi4xOV0sWydjJywwLjMwLC0wLjA5LDEuMDIsLTAuMDksMS4zNSwwLjAwXSxbJ2MnLDAuOTksMC4yNywxLjc0LDAuODcsMi4yNSwxLjgzXSxbJ2MnLDAuNjksMS40MSwwLjYzLDMuMDAsLTAuMjEsNC4yNl0sWydjJywtMC4yMSwwLjMwLC0wLjY5LDAuODEsLTAuOTksMS4wMl0sWydjJywtMC4zMCwwLjIxLC0wLjg0LDAuNDUsLTEuMTcsMC41NF0sWydjJywtMS4yMywwLjM2LC0yLjQ5LDAuMTUsLTMuNzIsLTAuNjBdLFsnYycsLTAuNzUsLTAuNDgsLTEuNDEsLTEuMDIsLTIuODUsLTIuNDZdLFsnYycsLTEuMTEsLTEuMDgsLTEuNjIsLTEuNTAsLTIuMjIsLTEuODZdLFsnYycsLTAuNjAsLTAuMzYsLTEuMzIsLTAuNTcsLTEuOTIsLTAuNTddLFsnYycsLTAuOTAsMC4wMCwtMS43MSwwLjU3LC0xLjg5LDEuMzVdLFsnYycsLTAuMjQsMC45MywwLjM5LDEuODksMS4zNSwyLjEwXSxbJ2wnLDAuMTUsMC4wNl0sWydsJywwLjA5LC0wLjE1XSxbJ2MnLDAuMDMsLTAuMDksMC4xNSwtMC4yNCwwLjI0LC0wLjMzXSxbJ2MnLDAuNzIsLTAuNzIsMi4wNCwtMC41NCwyLjQ5LDAuMzZdLFsnYycsMC40OCwwLjkzLC0wLjAzLDEuODYsLTEuMTcsMi4xOV0sWydjJywtMC4zMCwwLjA5LC0xLjAyLDAuMDksLTEuMzUsMC4wMF0sWydjJywtMC45OSwtMC4yNywtMS43NCwtMC44NywtMi4yNSwtMS44M10sWydjJywtMC42OSwtMS40MSwtMC42MywtMy4wMCwwLjIxLC00LjI2XSxbJ2MnLDAuMjEsLTAuMzAsMC42OSwtMC44MSwwLjk5LC0xLjAyXSxbJ2MnLDAuNDgsLTAuMzMsMS4xMSwtMC41NywxLjc0LC0wLjY2XSxbJ3onXV0sdzoxNi4zNjYsaDo3Ljg5M30sXG5cdFx0J3NjcmlwdHMudHJpbGwnOntkOltbJ00nLC0wLjUxLC0xNi4wMl0sWydjJywwLjEyLC0wLjA5LDAuMjEsLTAuMTgsMC4yMSwtMC4xOF0sWydsJywtMC44MSw0LjAyXSxbJ2wnLC0wLjgxLDQuMDJdLFsnYycsMC4wMywwLjAwLDAuNTEsLTAuMjcsMS4wOCwtMC42MF0sWydjJywwLjYwLC0wLjMwLDEuMTQsLTAuNjMsMS4yNiwtMC42Nl0sWydjJywxLjE0LC0wLjU0LDIuMzEsLTAuNjAsMy4wOSwtMC4xOF0sWydjJywwLjI3LDAuMTUsMC41NCwwLjM2LDAuNjAsMC41MV0sWydsJywwLjA2LDAuMTJdLFsnbCcsMC4yMSwtMC4yMV0sWydjJywwLjkwLC0wLjgxLDIuMjIsLTAuOTksMy4xMiwtMC40Ml0sWydjJywwLjYwLDAuNDIsMC45MCwxLjE0LDAuNzgsMi4wN10sWydjJywtMC4xNSwxLjI5LC0xLjA1LDIuMzEsLTEuOTUsMi4yNV0sWydjJywtMC40OCwtMC4wMywtMC43OCwtMC4zMCwtMC45NiwtMC44MV0sWydjJywtMC4wOSwtMC4yNywtMC4wOSwtMC45MCwtMC4wMywtMS4yMF0sWydjJywwLjIxLC0wLjc1LDAuODEsLTEuMjMsMS41OSwtMS4zMl0sWydsJywwLjI0LC0wLjAzXSxbJ2wnLC0wLjA5LC0wLjEyXSxbJ2MnLC0wLjUxLC0wLjY2LC0xLjYyLC0wLjYzLC0yLjMxLDAuMDNdLFsnYycsLTAuMzksMC40MiwtMC4zMCwwLjA5LC0xLjIzLDQuNzddLFsnbCcsLTAuODEsNC4xNF0sWydjJywtMC4wMywwLjAwLC0wLjEyLC0wLjAzLC0wLjIxLC0wLjA5XSxbJ2MnLC0wLjMzLC0wLjE1LC0wLjU0LC0wLjE4LC0wLjk5LC0wLjE4XSxbJ2MnLC0wLjQyLDAuMDAsLTAuNjYsMC4wMywtMS4wNSwwLjE4XSxbJ2MnLC0wLjEyLDAuMDYsLTAuMjEsMC4wOSwtMC4yMSwwLjA5XSxbJ2MnLDAuMDAsLTAuMDMsMC4zNiwtMS44NiwwLjgxLC00LjExXSxbJ2MnLDAuOTAsLTQuNDcsMC44NywtNC4yNiwwLjY5LC00LjUzXSxbJ2MnLC0wLjIxLC0wLjM2LC0wLjY2LC0wLjUxLC0xLjE3LC0wLjM2XSxbJ2MnLC0wLjE1LDAuMDYsLTIuMjIsMS4xNCwtMi41OCwxLjM4XSxbJ2MnLC0wLjEyLDAuMDksLTAuMTIsMC4wOSwtMC4yMSwwLjYwXSxbJ2wnLC0wLjA5LDAuNTFdLFsnbCcsMC4yMSwwLjI0XSxbJ2MnLDAuNjMsMC43NSwxLjAyLDEuNDcsMS4yMCwyLjE5XSxbJ2MnLDAuMDYsMC4yNywwLjA2LDAuMzYsMC4wNiwwLjgxXSxbJ2MnLDAuMDAsMC40MiwwLjAwLDAuNTQsLTAuMDYsMC43OF0sWydjJywtMC4xNSwwLjU0LC0wLjMzLDAuOTMsLTAuNjMsMS4zNV0sWydjJywtMC4xOCwwLjI0LC0wLjU3LDAuNjMsLTAuODEsMC43OF0sWydjJywtMC4yNCwwLjE1LC0wLjYzLDAuMzYsLTAuODQsMC40Ml0sWydjJywtMC4yNywwLjA2LC0wLjY2LDAuMDYsLTAuODcsMC4wM10sWydjJywtMC44MSwtMC4xOCwtMS4zMiwtMS4wNSwtMS4zOCwtMi40Nl0sWydjJywtMC4wMywtMC42MCwwLjAzLC0wLjk5LDAuMzMsLTIuNDZdLFsnYycsMC4yMSwtMS4wOCwwLjI0LC0xLjMyLDAuMjEsLTEuMjldLFsnYycsLTEuMjAsMC40OCwtMi40MCwwLjc1LC0zLjIxLDAuNzJdLFsnYycsLTAuNjksLTAuMDYsLTEuMTcsLTAuMzAsLTEuNDEsLTAuNzJdLFsnYycsLTAuMzksLTAuNzUsLTAuMTIsLTEuODAsMC42NiwtMi40Nl0sWydjJywwLjI0LC0wLjE4LDAuNjksLTAuNDIsMS4wMiwtMC41MV0sWydjJywwLjY5LC0wLjE4LDEuNTMsLTAuMTUsMi4zMSwwLjA5XSxbJ2MnLDAuMzAsMC4wOSwwLjc1LDAuMzAsMC45OSwwLjQ1XSxbJ2MnLDAuMTIsMC4wOSwwLjE1LDAuMDksMC4xNSwwLjAzXSxbJ2MnLDAuMDMsLTAuMDMsMC4zMywtMS41OSwwLjcyLC0zLjQ1XSxbJ2MnLDAuMzYsLTEuODYsMC42NiwtMy40MiwwLjY5LC0zLjQ1XSxbJ2MnLDAuMDAsLTAuMDMsMC4wMywtMC4wMywwLjIxLDAuMDNdLFsnYycsMC4yMSwwLjA2LDAuMjcsMC4wNiwwLjQ4LDAuMDZdLFsnYycsMC40MiwtMC4wMywwLjc4LC0wLjE4LDEuMjYsLTAuNDhdLFsnYycsMC4xNSwtMC4xMiwwLjM2LC0wLjI3LDAuNDgsLTAuMzldLFsneiddLFsnbScsLTUuNzMsNy42OF0sWydjJywtMC4yNywtMC4wMywtMC45NiwtMC4wNiwtMS4yMCwtMC4wM10sWydjJywtMC44MSwwLjEyLC0xLjM1LDAuNTcsLTEuNTAsMS4yMF0sWydjJywtMC4xOCwwLjY2LDAuMTIsMS4xNCwwLjc1LDEuMjldLFsnYycsMC42NiwwLjEyLDEuOTIsLTAuMTIsMy4xOCwtMC42Nl0sWydsJywwLjMzLC0wLjE1XSxbJ2wnLDAuMDksLTAuMzldLFsnYycsMC4wNiwtMC4yMSwwLjA5LC0wLjQyLDAuMDksLTAuNDVdLFsnYycsMC4wMCwtMC4wMywtMC40NSwtMC4zMCwtMC43NSwtMC40NV0sWydjJywtMC4yNywtMC4xNSwtMC42NiwtMC4yNywtMC45OSwtMC4zNl0sWyd6J10sWydtJyw0LjI5LDMuNjNdLFsnYycsLTAuMjQsLTAuMzksLTAuNTEsLTAuNzUsLTAuNTEsLTAuNjldLFsnYycsLTAuMDYsMC4xMiwtMC4zOSwxLjkyLC0wLjQ1LDIuMjhdLFsnYycsLTAuMDksMC41NCwtMC4xMiwxLjE0LC0wLjA2LDEuMzhdLFsnYycsMC4wNiwwLjQyLDAuMjEsMC42MCwwLjUxLDAuNTddLFsnYycsMC4zOSwtMC4wNiwwLjc1LC0wLjQ4LDAuOTMsLTEuMTRdLFsnYycsMC4wOSwtMC4zMywwLjA5LC0xLjA1LDAuMDAsLTEuMzhdLFsnYycsLTAuMDksLTAuMzksLTAuMjQsLTAuNjksLTAuNDIsLTEuMDJdLFsneiddXSx3OjE3Ljk2MyxoOjE2LjQ5fSxcblx0XHQnc2NyaXB0cy5zZWdubyc6e2Q6W1snTScsLTMuNzIsLTExLjIyXSxbJ2MnLDAuNzgsLTAuMDksMS41OSwwLjAzLDIuMzEsMC40Ml0sWydjJywxLjIwLDAuNjAsMi4wMSwxLjcxLDIuMzEsMy4wOV0sWydjJywwLjA5LDAuNDIsMC4wOSwxLjIwLDAuMDMsMS41MF0sWydjJywtMC4xNSwwLjQ1LC0wLjM5LDAuODEsLTAuNjYsMC45M10sWydjJywtMC4zMywwLjE4LC0wLjg0LDAuMjEsLTEuMjMsMC4xNV0sWydjJywtMC44MSwtMC4xOCwtMS4zMiwtMC45MywtMS4yNiwtMS44OV0sWydjJywwLjAzLC0wLjM2LDAuMDksLTAuNTcsMC4yNCwtMC45MF0sWydjJywwLjE1LC0wLjMzLDAuNDUsLTAuNjAsMC43MiwtMC43NV0sWydjJywwLjEyLC0wLjA2LDAuMTgsLTAuMDksMC4xOCwtMC4xMl0sWydjJywwLjAwLC0wLjAzLC0wLjAzLC0wLjE1LC0wLjA5LC0wLjI0XSxbJ2MnLC0wLjE4LC0wLjQ1LC0wLjU0LC0wLjg3LC0wLjk2LC0xLjA4XSxbJ2MnLC0xLjExLC0wLjU3LC0yLjM0LC0wLjE4LC0yLjg4LDAuOTBdLFsnYycsLTAuMjQsMC41MSwtMC4zMywxLjExLC0wLjI0LDEuODNdLFsnYycsMC4yNywxLjkyLDEuNTAsMy41NCwzLjkzLDUuMTNdLFsnYycsMC40OCwwLjMzLDEuMjYsMC43OCwxLjI5LDAuNzhdLFsnYycsMC4wMywwLjAwLDEuMzUsLTIuMTksMi45NCwtNC44OV0sWydsJywyLjg4LC00Ljg5XSxbJ2wnLDAuODQsMC4wMF0sWydsJywwLjg3LDAuMDBdLFsnbCcsLTAuMDMsMC4wNl0sWydjJywtMC4xNSwwLjIxLC02LjE1LDEwLjQxLC02LjE1LDEwLjQ0XSxbJ2MnLDAuMDAsMC4wMCwwLjIxLDAuMTUsMC40OCwwLjI3XSxbJ2MnLDIuNjEsMS40Nyw0LjM1LDMuMDMsNS4xMyw0LjY1XSxbJ2MnLDEuMTQsMi4zNCwwLjUxLDUuMDcsLTEuNDQsNi4zOV0sWydjJywtMC42NiwwLjQyLC0xLjMyLDAuNjMsLTIuMTMsMC42OV0sWydjJywtMi4wMSwwLjA5LC0zLjgxLC0xLjQxLC00LjI2LC0zLjU0XSxbJ2MnLC0wLjA5LC0wLjQyLC0wLjA5LC0xLjIwLC0wLjAzLC0xLjUwXSxbJ2MnLDAuMTUsLTAuNDUsMC4zOSwtMC44MSwwLjY2LC0wLjkzXSxbJ2MnLDAuMzMsLTAuMTgsMC44NCwtMC4yMSwxLjIzLC0wLjE1XSxbJ2MnLDAuODEsMC4xOCwxLjMyLDAuOTMsMS4yNiwxLjg5XSxbJ2MnLC0wLjAzLDAuMzYsLTAuMDksMC41NywtMC4yNCwwLjkwXSxbJ2MnLC0wLjE1LDAuMzMsLTAuNDUsMC42MCwtMC43MiwwLjc1XSxbJ2MnLC0wLjEyLDAuMDYsLTAuMTgsMC4wOSwtMC4xOCwwLjEyXSxbJ2MnLDAuMDAsMC4wMywwLjAzLDAuMTUsMC4wOSwwLjI0XSxbJ2MnLDAuMTgsMC40NSwwLjU0LDAuODcsMC45NiwxLjA4XSxbJ2MnLDEuMTEsMC41NywyLjM0LDAuMTgsMi44OCwtMC45MF0sWydjJywwLjI0LC0wLjUxLDAuMzMsLTEuMTEsMC4yNCwtMS44M10sWydjJywtMC4yNywtMS45MiwtMS41MCwtMy41NCwtMy45MywtNS4xM10sWydjJywtMC40OCwtMC4zMywtMS4yNiwtMC43OCwtMS4yOSwtMC43OF0sWydjJywtMC4wMywwLjAwLC0xLjM1LDIuMTksLTIuOTEsNC44OV0sWydsJywtMi44OCw0Ljg5XSxbJ2wnLC0wLjg3LDAuMDBdLFsnbCcsLTAuODcsMC4wMF0sWydsJywwLjAzLC0wLjA2XSxbJ2MnLDAuMTUsLTAuMjEsNi4xNSwtMTAuNDEsNi4xNSwtMTAuNDRdLFsnYycsMC4wMCwwLjAwLC0wLjIxLC0wLjE1LC0wLjQ4LC0wLjMwXSxbJ2MnLC0yLjYxLC0xLjQ0LC00LjM1LC0zLjAwLC01LjEzLC00LjYyXSxbJ2MnLC0wLjkwLC0xLjg5LC0wLjcyLC00LjAyLDAuNDgsLTUuNTJdLFsnYycsMC42OSwtMC44NCwxLjY4LC0xLjQxLDIuNzMsLTEuNTNdLFsneiddLFsnbScsOC43Niw5LjA5XSxbJ2MnLDAuMDMsLTAuMDMsMC4xNSwtMC4wMywwLjI3LC0wLjAzXSxbJ2MnLDAuMzMsMC4wMywwLjU3LDAuMTgsMC43MiwwLjQ4XSxbJ2MnLDAuMDksMC4xOCwwLjA5LDAuNTcsMC4wMCwwLjc1XSxbJ2MnLC0wLjA5LDAuMTgsLTAuMjEsMC4zMCwtMC4zNiwwLjM5XSxbJ2MnLC0wLjE1LDAuMDYsLTAuMjEsMC4wNiwtMC4zOSwwLjA2XSxbJ2MnLC0wLjIxLDAuMDAsLTAuMjcsMC4wMCwtMC4zOSwtMC4wNl0sWydjJywtMC4zMCwtMC4xNSwtMC40OCwtMC40NSwtMC40OCwtMC43NV0sWydjJywwLjAwLC0wLjM5LDAuMjQsLTAuNzIsMC42MywtMC44NF0sWyd6J10sWydtJywtMTAuNTMsMi42MV0sWydjJywwLjAzLC0wLjAzLDAuMTUsLTAuMDMsMC4yNywtMC4wM10sWydjJywwLjMzLDAuMDMsMC41NywwLjE4LDAuNzIsMC40OF0sWydjJywwLjA5LDAuMTgsMC4wOSwwLjU3LDAuMDAsMC43NV0sWydjJywtMC4wOSwwLjE4LC0wLjIxLDAuMzAsLTAuMzYsMC4zOV0sWydjJywtMC4xNSwwLjA2LC0wLjIxLDAuMDYsLTAuMzksMC4wNl0sWydjJywtMC4yMSwwLjAwLC0wLjI3LDAuMDAsLTAuMzksLTAuMDZdLFsnYycsLTAuMzAsLTAuMTUsLTAuNDgsLTAuNDUsLTAuNDgsLTAuNzVdLFsnYycsMC4wMCwtMC4zOSwwLjI0LC0wLjcyLDAuNjMsLTAuODRdLFsneiddXSx3OjE1LGg6MjIuNTA0fSxcblx0XHQnc2NyaXB0cy5jb2RhJzp7ZDpbWydNJywtMC4yMSwtMTAuNDddLFsnYycsMC4xOCwtMC4xMiwwLjQyLC0wLjA2LDAuNTQsMC4xMl0sWydjJywwLjA2LDAuMDksMC4wNiwwLjE4LDAuMDYsMS41MF0sWydsJywwLjAwLDEuMzhdLFsnbCcsMC4xOCwwLjAwXSxbJ2MnLDAuMzksMC4wNiwwLjk2LDAuMjQsMS4zOCwwLjQ4XSxbJ2MnLDEuNjgsMC45MywyLjgyLDMuMjQsMy4wMyw2LjEyXSxbJ2MnLDAuMDMsMC4yNCwwLjAzLDAuNDUsMC4wMywwLjQ1XSxbJ2MnLDAuMDAsMC4wMywwLjYwLDAuMDMsMS4zNSwwLjAzXSxbJ2MnLDEuNTAsMC4wMCwxLjQ3LDAuMDAsMS41OSwwLjE4XSxbJ2MnLDAuMDksMC4xMiwwLjA5LDAuMzAsMC4wMCwwLjQyXSxbJ2MnLC0wLjEyLDAuMTgsLTAuMDksMC4xOCwtMS41OSwwLjE4XSxbJ2MnLC0wLjc1LDAuMDAsLTEuMzUsMC4wMCwtMS4zNSwwLjAzXSxbJ2MnLDAuMDAsMC4wMCwwLjAwLDAuMjEsLTAuMDMsMC40Ml0sWydjJywtMC4yNCwzLjE1LC0xLjUzLDUuNTgsLTMuNDUsNi4zNl0sWydjJywtMC4yNywwLjEyLC0wLjcyLDAuMjQsLTAuOTYsMC4yN10sWydsJywtMC4xOCwwLjAwXSxbJ2wnLDAuMDAsMS4zOF0sWydjJywwLjAwLDEuMzIsMC4wMCwxLjQxLC0wLjA2LDEuNTBdLFsnYycsLTAuMTUsMC4yNCwtMC41MSwwLjI0LC0wLjY2LDAuMDBdLFsnYycsLTAuMDYsLTAuMDksLTAuMDYsLTAuMTgsLTAuMDYsLTEuNTBdLFsnbCcsMC4wMCwtMS4zOF0sWydsJywtMC4xOCwwLjAwXSxbJ2MnLC0wLjM5LC0wLjA2LC0wLjk2LC0wLjI0LC0xLjM4LC0wLjQ4XSxbJ2MnLC0xLjY4LC0wLjkzLC0yLjgyLC0zLjI0LC0zLjAzLC02LjE1XSxbJ2MnLC0wLjAzLC0wLjIxLC0wLjAzLC0wLjQyLC0wLjAzLC0wLjQyXSxbJ2MnLDAuMDAsLTAuMDMsLTAuNjAsLTAuMDMsLTEuMzUsLTAuMDNdLFsnYycsLTEuNTAsMC4wMCwtMS40NywwLjAwLC0xLjU5LC0wLjE4XSxbJ2MnLC0wLjA5LC0wLjEyLC0wLjA5LC0wLjMwLDAuMDAsLTAuNDJdLFsnYycsMC4xMiwtMC4xOCwwLjA5LC0wLjE4LDEuNTksLTAuMThdLFsnYycsMC43NSwwLjAwLDEuMzUsMC4wMCwxLjM1LC0wLjAzXSxbJ2MnLDAuMDAsMC4wMCwwLjAwLC0wLjIxLDAuMDMsLTAuNDVdLFsnYycsMC4yNCwtMy4xMiwxLjUzLC01LjU1LDMuNDUsLTYuMzNdLFsnYycsMC4yNywtMC4xMiwwLjcyLC0wLjI0LDAuOTYsLTAuMjddLFsnbCcsMC4xOCwwLjAwXSxbJ2wnLDAuMDAsLTEuMzhdLFsnYycsMC4wMCwtMS41MywwLjAwLC0xLjUwLDAuMTgsLTEuNjJdLFsneiddLFsnbScsLTAuMTgsNi45M10sWydjJywwLjAwLC0yLjk3LDAuMDAsLTMuMTUsLTAuMDYsLTMuMTVdLFsnYycsLTAuMDksMC4wMCwtMC41MSwwLjE1LC0wLjY2LDAuMjFdLFsnYycsLTAuODcsMC41MSwtMS4zOCwxLjYyLC0xLjU2LDMuNTFdLFsnYycsLTAuMDYsMC41NCwtMC4xMiwxLjU5LC0wLjEyLDIuMTZdLFsnbCcsMC4wMCwwLjQyXSxbJ2wnLDEuMjAsMC4wMF0sWydsJywxLjIwLDAuMDBdLFsnbCcsMC4wMCwtMy4xNV0sWyd6J10sWydtJywxLjE3LC0zLjA2XSxbJ2MnLC0wLjA5LC0wLjAzLC0wLjIxLC0wLjA2LC0wLjI3LC0wLjA5XSxbJ2wnLC0wLjEyLDAuMDBdLFsnbCcsMC4wMCwzLjE1XSxbJ2wnLDAuMDAsMy4xNV0sWydsJywxLjIwLDAuMDBdLFsnbCcsMS4yMCwwLjAwXSxbJ2wnLDAuMDAsLTAuODFdLFsnYycsLTAuMDYsLTIuNDAsLTAuMzMsLTMuNjksLTAuOTMsLTQuNTldLFsnYycsLTAuMjcsLTAuMzksLTAuNjYsLTAuNjksLTEuMDgsLTAuODFdLFsneiddLFsnbScsLTEuMTcsMTAuMTRdLFsnbCcsMC4wMCwtMy4xNV0sWydsJywtMS4yMCwwLjAwXSxbJ2wnLC0xLjIwLDAuMDBdLFsnbCcsMC4wMCwwLjgxXSxbJ2MnLDAuMDMsMC45NiwwLjA2LDEuNDcsMC4xNSwyLjEzXSxbJ2MnLDAuMjQsMi4wNCwwLjk2LDMuMTIsMi4xMywzLjM2XSxbJ2wnLDAuMTIsMC4wMF0sWydsJywwLjAwLC0zLjE1XSxbJ3onXSxbJ20nLDMuMTgsLTIuMzRdLFsnbCcsMC4wMCwtMC44MV0sWydsJywtMS4yMCwwLjAwXSxbJ2wnLC0xLjIwLDAuMDBdLFsnbCcsMC4wMCwzLjE1XSxbJ2wnLDAuMDAsMy4xNV0sWydsJywwLjEyLDAuMDBdLFsnYycsMS4xNywtMC4yNCwxLjg5LC0xLjMyLDIuMTMsLTMuMzZdLFsnYycsMC4wOSwtMC42NiwwLjEyLC0xLjE3LDAuMTUsLTIuMTNdLFsneiddXSx3OjE2LjAzNSxoOjIxLjA2Mn0sXG5cdFx0J3NjcmlwdHMuY29tbWEnOntkOltbJ00nLDEuMTQsLTQuNjJdLFsnYycsMC4zMCwtMC4xMiwwLjY5LC0wLjAzLDAuOTMsMC4xNV0sWydjJywwLjEyLDAuMTIsMC4zNiwwLjQ1LDAuNTEsMC43OF0sWydjJywwLjkwLDEuNzcsMC41NCw0LjA1LC0xLjA4LDYuNzVdLFsnYycsLTAuMzYsMC42MywtMC44NywxLjM4LC0wLjk2LDEuNDRdLFsnYycsLTAuMTgsMC4xMiwtMC40MiwwLjA2LC0wLjU0LC0wLjEyXSxbJ2MnLC0wLjA5LC0wLjE4LC0wLjA5LC0wLjMwLDAuMTIsLTAuNjBdLFsnYycsMC45NiwtMS40NCwxLjQ0LC0yLjk3LDEuMzgsLTQuMzVdLFsnYycsLTAuMDYsLTAuOTMsLTAuMzAsLTEuNjgsLTAuNzgsLTIuNDZdLFsnYycsLTAuMjcsLTAuMzksLTAuMzMsLTAuNjMsLTAuMjQsLTAuOTZdLFsnYycsMC4wOSwtMC4yNywwLjM2LC0wLjU0LDAuNjYsLTAuNjNdLFsneiddXSx3OjMuMDQyLGg6OS4yMzd9LFxuXHRcdCdzY3JpcHRzLnJvbGwnOntkOltbJ00nLDEuOTUsLTYuMDBdLFsnYycsMC4yMSwtMC4wOSwwLjM2LC0wLjA5LDAuNTcsMC4wMF0sWydjJywwLjM5LDAuMTUsMC42MywwLjM5LDEuNDcsMS4zNV0sWydjJywwLjY2LDAuNzUsMC43OCwwLjg3LDEuMDgsMS4wNV0sWydjJywwLjc1LDAuNDUsMS42NSwwLjQyLDIuNDAsLTAuMDZdLFsnYycsMC4xMiwtMC4wOSwwLjI3LC0wLjI3LDAuNTQsLTAuNjBdLFsnYycsMC40MiwtMC41NCwwLjUxLC0wLjYzLDAuNjksLTAuNjNdLFsnYycsMC4wOSwwLjAwLDAuMzAsMC4xMiwwLjM2LDAuMjFdLFsnYycsMC4wOSwwLjEyLDAuMTIsMC4zMCwwLjAzLDAuNDJdLFsnYycsLTAuMDYsMC4xMiwtMy4xNSwzLjkwLC0zLjMwLDQuMDhdLFsnYycsLTAuMDYsMC4wNiwtMC4xOCwwLjEyLC0wLjI3LDAuMThdLFsnYycsLTAuMjcsMC4xMiwtMC42MCwwLjA2LC0wLjk5LC0wLjI3XSxbJ2MnLC0wLjI3LC0wLjIxLC0wLjQyLC0wLjM5LC0xLjA4LC0xLjE0XSxbJ2MnLC0wLjYzLC0wLjcyLC0wLjgxLC0wLjkwLC0xLjE3LC0xLjA4XSxbJ2MnLC0wLjM2LC0wLjE4LC0wLjU3LC0wLjIxLC0wLjk5LC0wLjIxXSxbJ2MnLC0wLjM5LDAuMDAsLTAuNjMsMC4wMywtMC45MywwLjE4XSxbJ2MnLC0wLjM2LDAuMTUsLTAuNTEsMC4yNywtMC45MCwwLjgxXSxbJ2MnLC0wLjI0LDAuMjcsLTAuNDUsMC41MSwtMC40OCwwLjU0XSxbJ2MnLC0wLjEyLDAuMDksLTAuMjcsMC4wNiwtMC4zOSwwLjAwXSxbJ2MnLC0wLjI0LC0wLjE1LC0wLjMzLC0wLjM5LC0wLjIxLC0wLjYwXSxbJ2MnLDAuMDksLTAuMTIsMy4xOCwtMy44NywzLjMzLC00LjAyXSxbJ2MnLDAuMDYsLTAuMDYsMC4xOCwtMC4xNSwwLjI0LC0wLjIxXSxbJ3onXV0sdzoxMC44MTcsaDo2LjEyNX0sXG5cdFx0J3NjcmlwdHMucHJhbGwnOntkOltbJ00nLC00LjM4LC0zLjY5XSxbJ2MnLDAuMDYsLTAuMDMsMC4xOCwtMC4wNiwwLjI0LC0wLjA2XSxbJ2MnLDAuMzAsMC4wMCwwLjI3LC0wLjAzLDEuODksMS45NV0sWydsJywxLjUzLDEuODNdLFsnYycsMC4wMywwLjAwLDAuNTcsLTAuODQsMS4yMywtMS44M10sWydjJywxLjE0LC0xLjY4LDEuMjMsLTEuODMsMS4zNSwtMS44OV0sWydjJywwLjA2LC0wLjAzLDAuMTgsLTAuMDYsMC4yNCwtMC4wNl0sWydjJywwLjMwLDAuMDAsMC4yNywtMC4wMywxLjg5LDEuOTVdLFsnbCcsMS41MywxLjgzXSxbJ2wnLDAuNDgsLTAuNjldLFsnYycsMC41MSwtMC43OCwwLjU0LC0wLjg0LDAuNjksLTAuOTBdLFsnYycsMC40MiwtMC4xOCwwLjg3LDAuMTUsMC44MSwwLjYwXSxbJ2MnLC0wLjAzLDAuMTIsLTAuMzAsMC41MSwtMS41MCwyLjM3XSxbJ2MnLC0xLjM4LDIuMDcsLTEuNTAsMi4yMiwtMS42MiwyLjI4XSxbJ2MnLC0wLjA2LDAuMDMsLTAuMTgsMC4wNiwtMC4yNCwwLjA2XSxbJ2MnLC0wLjMwLDAuMDAsLTAuMjcsMC4wMywtMS44OSwtMS45NV0sWydsJywtMS41MywtMS44M10sWydjJywtMC4wMywwLjAwLC0wLjU3LDAuODQsLTEuMjMsMS44M10sWydjJywtMS4xNCwxLjY4LC0xLjIzLDEuODMsLTEuMzUsMS44OV0sWydjJywtMC4wNiwwLjAzLC0wLjE4LDAuMDYsLTAuMjQsMC4wNl0sWydjJywtMC4zMCwwLjAwLC0wLjI3LDAuMDMsLTEuODksLTEuOTVdLFsnbCcsLTEuNTMsLTEuODNdLFsnbCcsLTAuNDgsMC42OV0sWydjJywtMC41MSwwLjc4LC0wLjU0LDAuODQsLTAuNjksMC45MF0sWydjJywtMC40MiwwLjE4LC0wLjg3LC0wLjE1LC0wLjgxLC0wLjYwXSxbJ2MnLDAuMDMsLTAuMTIsMC4zMCwtMC41MSwxLjUwLC0yLjM3XSxbJ2MnLDEuMzgsLTIuMDcsMS41MCwtMi4yMiwxLjYyLC0yLjI4XSxbJ3onXV0sdzoxNS4wMTEsaDo3LjV9LFxuXHRcdCdzY3JpcHRzLm1vcmRlbnQnOntkOltbJ00nLC0wLjIxLC00Ljk1XSxbJ2MnLDAuMjcsLTAuMTUsMC42MywwLjAwLDAuNzUsMC4yN10sWydjJywwLjA2LDAuMTIsMC4wNiwwLjI0LDAuMDYsMS40NF0sWydsJywwLjAwLDEuMjldLFsnbCcsMC41NywtMC44NF0sWydjJywwLjUxLC0wLjc1LDAuNTcsLTAuODQsMC42OSwtMC45MF0sWydjJywwLjA2LC0wLjAzLDAuMTgsLTAuMDYsMC4yNCwtMC4wNl0sWydjJywwLjMwLDAuMDAsMC4yNywtMC4wMywxLjg5LDEuOTVdLFsnbCcsMS41MywxLjgzXSxbJ2wnLDAuNDgsLTAuNjldLFsnYycsMC41MSwtMC43OCwwLjU0LC0wLjg0LDAuNjksLTAuOTBdLFsnYycsMC40MiwtMC4xOCwwLjg3LDAuMTUsMC44MSwwLjYwXSxbJ2MnLC0wLjAzLDAuMTIsLTAuMzAsMC41MSwtMS41MCwyLjM3XSxbJ2MnLC0xLjM4LDIuMDcsLTEuNTAsMi4yMiwtMS42MiwyLjI4XSxbJ2MnLC0wLjA2LDAuMDMsLTAuMTgsMC4wNiwtMC4yNCwwLjA2XSxbJ2MnLC0wLjMwLDAuMDAsLTAuMjcsMC4wMywtMS44MywtMS44OV0sWydjJywtMC44MSwtMC45OSwtMS41MCwtMS44MCwtMS41MywtMS44Nl0sWydjJywtMC4wNiwtMC4wMywtMC4wNiwtMC4wMywtMC4xMiwwLjAzXSxbJ2MnLC0wLjA2LDAuMDYsLTAuMDYsMC4xNSwtMC4wNiwyLjI4XSxbJ2MnLDAuMDAsMS45NSwwLjAwLDIuMjUsLTAuMDYsMi4zNF0sWydjJywtMC4xOCwwLjQ1LC0wLjgxLDAuNDgsLTEuMDUsMC4wM10sWydjJywtMC4wMywtMC4wNiwtMC4wNiwtMC4yNCwtMC4wNiwtMS40MV0sWydsJywwLjAwLC0xLjM1XSxbJ2wnLC0wLjU3LDAuODRdLFsnYycsLTAuNTQsMC43OCwtMC42MCwwLjg3LC0wLjcyLDAuOTNdLFsnYycsLTAuMDYsMC4wMywtMC4xOCwwLjA2LC0wLjI0LDAuMDZdLFsnYycsLTAuMzAsMC4wMCwtMC4yNywwLjAzLC0xLjg5LC0xLjk1XSxbJ2wnLC0xLjUzLC0xLjgzXSxbJ2wnLC0wLjQ4LDAuNjldLFsnYycsLTAuNTEsMC43OCwtMC41NCwwLjg0LC0wLjY5LDAuOTBdLFsnYycsLTAuNDIsMC4xOCwtMC44NywtMC4xNSwtMC44MSwtMC42MF0sWydjJywwLjAzLC0wLjEyLDAuMzAsLTAuNTEsMS41MCwtMi4zN10sWydjJywxLjM4LC0yLjA3LDEuNTAsLTIuMjIsMS42MiwtMi4yOF0sWydjJywwLjA2LC0wLjAzLDAuMTgsLTAuMDYsMC4yNCwtMC4wNl0sWydjJywwLjMwLDAuMDAsMC4yNywtMC4wMywxLjg5LDEuOTVdLFsnbCcsMS41MywxLjgzXSxbJ2MnLDAuMDMsMC4wMCwwLjA2LC0wLjA2LDAuMDksLTAuMDldLFsnYycsMC4wNiwtMC4xMiwwLjA2LC0wLjE1LDAuMDYsLTIuMjhdLFsnYycsMC4wMCwtMS45MiwwLjAwLC0yLjIyLDAuMDYsLTIuMzFdLFsnYycsMC4wNiwtMC4xNSwwLjE1LC0wLjI0LDAuMzAsLTAuMzBdLFsneiddXSx3OjE1LjAxMSxoOjEwLjAxMn0sXG5cdFx0J2ZsYWdzLnU4dGgnOntkOltbJ00nLC0wLjQyLDMuNzVdLFsnbCcsMC4wMCwtMy43NV0sWydsJywwLjIxLDAuMDBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMDAsMC4xOF0sWydjJywwLjAwLDAuMzAsMC4wNiwwLjg0LDAuMTIsMS4yM10sWydjJywwLjI0LDEuNTMsMC45MCwzLjEyLDIuMTMsNS4xNl0sWydsJywwLjk5LDEuNTldLFsnYycsMC44NywxLjQ0LDEuMzgsMi4zNCwxLjc3LDMuMDldLFsnYycsMC44MSwxLjY4LDEuMjAsMy4wNiwxLjI2LDQuNTNdLFsnYycsMC4wMywxLjUzLC0wLjIxLDMuMjcsLTAuNzUsNS4wMV0sWydjJywtMC4yMSwwLjY5LC0wLjUxLDEuNTAsLTAuNjAsMS41OV0sWydjJywtMC4wOSwwLjEyLC0wLjI3LDAuMjEsLTAuNDIsMC4yMV0sWydjJywtMC4xNSwwLjAwLC0wLjQyLC0wLjEyLC0wLjUxLC0wLjIxXSxbJ2MnLC0wLjE1LC0wLjE4LC0wLjE4LC0wLjQyLC0wLjA5LC0wLjY2XSxbJ2MnLDAuMTUsLTAuMzMsMC40NSwtMS4yMCwwLjU3LC0xLjYyXSxbJ2MnLDAuNDIsLTEuMzgsMC42MCwtMi41OCwwLjYwLC0zLjkwXSxbJ2MnLDAuMDAsLTAuNjYsMC4wMCwtMC44MSwtMC4wNiwtMS4xMV0sWydjJywtMC4zOSwtMi4wNywtMS44MCwtNC4yNiwtNC41OSwtNy4xNF0sWydsJywtMC40MiwtMC40NV0sWydsJywtMC4yMSwwLjAwXSxbJ2wnLC0wLjIxLDAuMDBdLFsnbCcsMC4wMCwtMy43NV0sWyd6J11dLHc6Ni42OTIsaDoyMi41OX0sXG5cdFx0J2ZsYWdzLnUxNnRoJzp7ZDpbWydNJywtMC40Miw3LjUwXSxbJ2wnLDAuMDAsLTcuNTBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMjEsMC4wMF0sWydsJywwLjAwLDAuMzldLFsnYycsMC4wNiwxLjA4LDAuMzksMi4xOSwwLjk5LDMuMzldLFsnYycsMC40NSwwLjkwLDAuODcsMS41OSwxLjk1LDMuMTJdLFsnYycsMS4yOSwxLjg2LDEuNzcsMi42NCwyLjIyLDMuNTddLFsnYycsMC40NSwwLjkzLDAuNzIsMS44MCwwLjg3LDIuNjRdLFsnYycsMC4wNiwwLjUxLDAuMDYsMS41MCwwLjAwLDEuOTJdLFsnYycsLTAuMTIsMC42MCwtMC4zMCwxLjIwLC0wLjU0LDEuNzFdLFsnbCcsLTAuMDksMC4yNF0sWydsJywwLjE4LDAuNDVdLFsnYycsMC41MSwxLjIwLDAuNzIsMi4yMiwwLjY5LDMuNDJdLFsnYycsLTAuMDYsMS41MywtMC4zOSwzLjAzLC0wLjk5LDQuNTNdLFsnYycsLTAuMzAsMC43NSwtMC4zNiwwLjgxLC0wLjU3LDAuOTBdLFsnYycsLTAuMTUsMC4wOSwtMC4zMywwLjA2LC0wLjQ4LDAuMDBdLFsnYycsLTAuMTgsLTAuMDksLTAuMjcsLTAuMTgsLTAuMzMsLTAuMzNdLFsnYycsLTAuMDksLTAuMTgsLTAuMDYsLTAuMzAsMC4xMiwtMC43NV0sWydjJywwLjY2LC0xLjQxLDEuMDIsLTIuODgsMS4wOCwtNC4zMl0sWydjJywwLjAwLC0wLjYwLC0wLjAzLC0xLjA1LC0wLjE4LC0xLjU5XSxbJ2MnLC0wLjMwLC0xLjIwLC0wLjk5LC0yLjQwLC0yLjI1LC0zLjg3XSxbJ2MnLC0wLjQyLC0wLjQ4LC0xLjUzLC0xLjYyLC0yLjE5LC0yLjIyXSxbJ2wnLC0wLjQ1LC0wLjQyXSxbJ2wnLC0wLjAzLDEuMTFdLFsnbCcsMC4wMCwxLjExXSxbJ2wnLC0wLjIxLDAuMDBdLFsnbCcsLTAuMjEsMC4wMF0sWydsJywwLjAwLC03LjUwXSxbJ3onXSxbJ20nLDEuNjUsMC4wOV0sWydjJywtMC4zMCwtMC4zMCwtMC42OSwtMC43MiwtMC45MCwtMC44N10sWydsJywtMC4zMywtMC4zM10sWydsJywwLjAwLDAuMTVdLFsnYycsMC4wMCwwLjMwLDAuMDYsMC44MSwwLjE1LDEuMjZdLFsnYycsMC4yNywxLjI5LDAuODcsMi42MSwyLjA0LDQuMjldLFsnYycsMC4xNSwwLjI0LDAuNjAsMC44NywwLjk2LDEuMzhdLFsnbCcsMS4wOCwxLjUzXSxbJ2wnLDAuNDIsMC42M10sWydjJywwLjAzLDAuMDAsMC4xMiwtMC4zNiwwLjIxLC0wLjcyXSxbJ2MnLDAuMDYsLTAuMzMsMC4wNiwtMS4yMCwwLjAwLC0xLjYyXSxbJ2MnLC0wLjMzLC0xLjcxLC0xLjQ0LC0zLjQ4LC0zLjYzLC01LjcwXSxbJ3onXV0sdzo2LjY5MyxoOjI2LjMzN30sXG5cdFx0J2ZsYWdzLnUzMm5kJzp7ZDpbWydNJywtMC40MiwxMS4yNV0sWydsJywwLjAwLC0xMS4yNV0sWydsJywwLjIxLDAuMDBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMDAsMC4zNl0sWydjJywwLjA5LDEuNjgsMC42OSwzLjI3LDIuMDcsNS40Nl0sWydsJywwLjg3LDEuMzVdLFsnYycsMS4wMiwxLjYyLDEuNDcsMi4zNywxLjg2LDMuMThdLFsnYycsMC40OCwxLjAyLDAuNzgsMS45MiwwLjkzLDIuODhdLFsnYycsMC4wNiwwLjQ4LDAuMDYsMS41MCwwLjAwLDEuODldLFsnYycsLTAuMDksMC40MiwtMC4yMSwwLjg3LC0wLjM2LDEuMjZdLFsnbCcsLTAuMTIsMC4zMF0sWydsJywwLjE1LDAuMzldLFsnYycsMC42OSwxLjU2LDAuODQsMi44OCwwLjU0LDQuMzhdLFsnYycsLTAuMDksMC40NSwtMC4yNywxLjA4LC0wLjQ1LDEuNDddLFsnbCcsLTAuMTIsMC4yNF0sWydsJywwLjE4LDAuMzZdLFsnYycsMC4zMywwLjcyLDAuNTcsMS41NiwwLjY5LDIuMzRdLFsnYycsMC4xMiwxLjAyLC0wLjA2LDIuNTIsLTAuNDIsMy44NF0sWydjJywtMC4yNywwLjkzLC0wLjc1LDIuMTMsLTAuOTMsMi4zMV0sWydjJywtMC4xOCwwLjE1LC0wLjQ1LDAuMTgsLTAuNjYsMC4wOV0sWydjJywtMC4xOCwtMC4wOSwtMC4yNywtMC4xOCwtMC4zMywtMC4zM10sWydjJywtMC4wOSwtMC4xOCwtMC4wNiwtMC4zMCwwLjA2LC0wLjYwXSxbJ2MnLDAuMjEsLTAuMzYsMC40MiwtMC45MCwwLjU3LC0xLjM4XSxbJ2MnLDAuNTEsLTEuNDEsMC42OSwtMy4wNiwwLjQ4LC00LjA4XSxbJ2MnLC0wLjE1LC0wLjgxLC0wLjU3LC0xLjY4LC0xLjIwLC0yLjU1XSxbJ2MnLC0wLjcyLC0wLjk5LC0xLjgzLC0yLjEzLC0zLjMwLC0zLjMzXSxbJ2wnLC0wLjQ4LC0wLjQyXSxbJ2wnLC0wLjAzLDEuNTNdLFsnbCcsMC4wMCwxLjU2XSxbJ2wnLC0wLjIxLDAuMDBdLFsnbCcsLTAuMjEsMC4wMF0sWydsJywwLjAwLC0xMS4yNV0sWyd6J10sWydtJywxLjI2LC0zLjk2XSxbJ2MnLC0wLjI3LC0wLjMwLC0wLjU0LC0wLjYwLC0wLjY2LC0wLjcyXSxbJ2wnLC0wLjE4LC0wLjIxXSxbJ2wnLDAuMDAsMC40Ml0sWydjJywwLjA2LDAuODcsMC4yNCwxLjc0LDAuNjYsMi42N10sWydjJywwLjM2LDAuODcsMC45NiwxLjg2LDEuOTIsMy4xOF0sWydjJywwLjIxLDAuMzMsMC42MywwLjg3LDAuODcsMS4yM10sWydjJywwLjI3LDAuMzksMC42MCwwLjg0LDAuNzUsMS4wOF0sWydsJywwLjI3LDAuMzldLFsnbCcsMC4wMywtMC4xMl0sWydjJywwLjEyLC0wLjQ1LDAuMTUsLTEuMDUsMC4wOSwtMS41OV0sWydjJywtMC4yNywtMS44NiwtMS4zOCwtMy43OCwtMy43NSwtNi4zM10sWyd6J10sWydtJywtMC4yNyw2LjA5XSxbJ2MnLC0wLjI3LC0wLjIxLC0wLjQ4LC0wLjQyLC0wLjUxLC0wLjQ1XSxbJ2MnLC0wLjA2LC0wLjAzLC0wLjA2LC0wLjAzLC0wLjA2LDAuMjFdLFsnYycsMC4wMCwwLjkwLDAuMzAsMi4wNCwwLjgxLDMuMDldLFsnYycsMC40OCwxLjAyLDAuOTYsMS43NywyLjM3LDMuNjNdLFsnYycsMC42MCwwLjc4LDEuMDUsMS40NCwxLjI5LDEuNzddLFsnYycsMC4wNiwwLjEyLDAuMTUsMC4yMSwwLjE1LDAuMThdLFsnYycsMC4wMywtMC4wMywwLjE4LC0wLjU3LDAuMjQsLTAuODddLFsnYycsMC4wNiwtMC40NSwwLjA2LC0xLjMyLC0wLjAzLC0xLjc0XSxbJ2MnLC0wLjA5LC0wLjQ4LC0wLjI0LC0wLjkwLC0wLjUxLC0xLjQ0XSxbJ2MnLC0wLjY2LC0xLjM1LC0xLjgzLC0yLjcwLC0zLjc1LC00LjM4XSxbJ3onXV0sdzo2LjY5NyxoOjMyLjE0NX0sXG5cdFx0J2ZsYWdzLnU2NHRoJzp7ZDpbWydNJywtMC40MiwxNS4wMF0sWydsJywwLjAwLC0xNS4wMF0sWydsJywwLjIxLDAuMDBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMDAsMC4zNl0sWydjJywwLjA2LDEuMjAsMC4zOSwyLjM3LDEuMDIsMy42Nl0sWydjJywwLjM5LDAuODEsMC44NCwxLjU2LDEuODAsMy4wOV0sWydjJywwLjgxLDEuMjYsMS4wNSwxLjY4LDEuMzUsMi4yMl0sWydjJywwLjg3LDEuNTAsMS4zNSwyLjc5LDEuNTYsNC4wOF0sWydjJywwLjA2LDAuNTQsMC4wNiwxLjU2LC0wLjAzLDIuMDRdLFsnYycsLTAuMDksMC40OCwtMC4yMSwwLjk5LC0wLjM2LDEuMzVdLFsnbCcsLTAuMTIsMC4yN10sWydsJywwLjEyLDAuMjddLFsnYycsMC4wOSwwLjE1LDAuMjEsMC40NSwwLjI3LDAuNjZdLFsnYycsMC42OSwxLjg5LDAuNjMsMy42NiwtMC4xOCw1LjQ2XSxbJ2wnLC0wLjE4LDAuMzldLFsnbCcsMC4xNSwwLjMzXSxbJ2MnLDAuMzAsMC42NiwwLjUxLDEuNDQsMC42MywyLjEwXSxbJ2MnLDAuMDYsMC40OCwwLjA2LDEuMzUsMC4wMCwxLjcxXSxbJ2MnLC0wLjE1LDAuNTcsLTAuNDIsMS4yMCwtMC43OCwxLjY4XSxbJ2wnLC0wLjIxLDAuMjddLFsnbCcsMC4xOCwwLjMzXSxbJ2MnLDAuNTcsMS4wNSwwLjkzLDIuMTMsMS4wMiwzLjE4XSxbJ2MnLDAuMDYsMC43MiwwLjAwLDEuODMsLTAuMjEsMi43OV0sWydjJywtMC4xOCwxLjAyLC0wLjYzLDIuMzQsLTEuMDIsMy4wOV0sWydjJywtMC4xNSwwLjMzLC0wLjQ4LDAuNDUsLTAuNzgsMC4zMF0sWydjJywtMC4xOCwtMC4wOSwtMC4yNywtMC4xOCwtMC4zMywtMC4zM10sWydjJywtMC4wOSwtMC4xOCwtMC4wNiwtMC4zMCwwLjAzLC0wLjU0XSxbJ2MnLDAuNzUsLTEuNTAsMS4yMywtMy40NSwxLjE3LC00Ljg5XSxbJ2MnLC0wLjA2LC0xLjAyLC0wLjQyLC0yLjAxLC0xLjE3LC0zLjE1XSxbJ2MnLC0wLjQ4LC0wLjcyLC0xLjAyLC0xLjM1LC0xLjg5LC0yLjIyXSxbJ2MnLC0wLjU3LC0wLjU3LC0xLjU2LC0xLjUwLC0xLjkyLC0xLjc3XSxbJ2wnLC0wLjEyLC0wLjA5XSxbJ2wnLDAuMDAsMS42OF0sWydsJywwLjAwLDEuNjhdLFsnbCcsLTAuMjEsMC4wMF0sWydsJywtMC4yMSwwLjAwXSxbJ2wnLDAuMDAsLTE1LjAwXSxbJ3onXSxbJ20nLDAuOTMsLTguMDddLFsnYycsLTAuMjcsLTAuMzAsLTAuNDgsLTAuNTQsLTAuNTEsLTAuNTRdLFsnYycsMC4wMCwwLjAwLDAuMDAsMC42OSwwLjAzLDEuMDJdLFsnYycsMC4xNSwxLjQ3LDAuNzUsMi45NCwyLjA0LDQuODNdLFsnbCcsMS4wOCwxLjUzXSxbJ2MnLDAuMzksMC41NywwLjg0LDEuMjAsMC45OSwxLjQ0XSxbJ2MnLDAuMTUsMC4yNCwwLjMwLDAuNDUsMC4zMCwwLjQ1XSxbJ2MnLDAuMDAsMC4wMCwwLjAzLC0wLjA5LDAuMDYsLTAuMjFdLFsnYycsMC4zNiwtMS41OSwtMC4xNSwtMy4zMywtMS40NywtNS40MF0sWydjJywtMC42MywtMC45MywtMS4zNSwtMS44MywtMi41MiwtMy4xMl0sWyd6J10sWydtJywwLjA2LDYuNzJdLFsnYycsLTAuMjQsLTAuMjEsLTAuNDgsLTAuNDIsLTAuNTEsLTAuNDVdLFsnbCcsLTAuMDYsLTAuMDZdLFsnbCcsMC4wMCwwLjMzXSxbJ2MnLDAuMDAsMS4yMCwwLjMwLDIuMzQsMC45MywzLjYwXSxbJ2MnLDAuNDUsMC45MCwwLjk2LDEuNjgsMi4yNSwzLjUxXSxbJ2MnLDAuMzksMC41NCwwLjg0LDEuMTcsMS4wMiwxLjQ0XSxbJ2MnLDAuMjEsMC4zMywwLjMzLDAuNTEsMC4zMywwLjQ4XSxbJ2MnLDAuMDYsLTAuMDksMC4yMSwtMC42MywwLjMwLC0wLjk5XSxbJ2MnLDAuMDYsLTAuMzMsMC4wNiwtMC40NSwwLjA2LC0wLjk2XSxbJ2MnLDAuMDAsLTAuNjAsLTAuMDMsLTAuODQsLTAuMTgsLTEuMzVdLFsnYycsLTAuMzAsLTEuMDgsLTEuMDIsLTIuMjgsLTIuMTMsLTMuNTddLFsnYycsLTAuMzksLTAuNDUsLTEuNDQsLTEuNDcsLTIuMDEsLTEuOThdLFsneiddLFsnbScsMC4wMCw2LjcyXSxbJ2MnLC0wLjI0LC0wLjIxLC0wLjQ4LC0wLjM5LC0wLjUxLC0wLjQyXSxbJ2wnLC0wLjA2LC0wLjA2XSxbJ2wnLDAuMDAsMC4zM10sWydjJywwLjAwLDEuNDEsMC40NSwyLjgyLDEuMzgsNC4zNV0sWydjJywwLjQyLDAuNzIsMC43MiwxLjE0LDEuODYsMi43M10sWydjJywwLjM2LDAuNDUsMC43NSwwLjk5LDAuODcsMS4yMF0sWydjJywwLjE1LDAuMjEsMC4zMCwwLjM2LDAuMzAsMC4zNl0sWydjJywwLjA2LDAuMDAsMC4zMCwtMC40OCwwLjM5LC0wLjc1XSxbJ2MnLDAuMDksLTAuMzYsMC4xMiwtMC42MywwLjEyLC0xLjA1XSxbJ2MnLC0wLjA2LC0xLjA1LC0wLjQ1LC0yLjA0LC0xLjIwLC0zLjE4XSxbJ2MnLC0wLjU3LC0wLjg3LC0xLjExLC0xLjUzLC0yLjA3LC0yLjQ5XSxbJ2MnLC0wLjM2LC0wLjMzLC0wLjg0LC0wLjc4LC0xLjA4LC0xLjAyXSxbJ3onXV0sdzo2LjY4MixoOjM5LjY5NH0sXG5cdFx0J2ZsYWdzLmQ4dGgnOntkOltbJ00nLDUuNjcsLTIxLjYzXSxbJ2MnLDAuMjQsLTAuMTIsMC41NCwtMC4wNiwwLjY5LDAuMTVdLFsnYycsMC4wNiwwLjA2LDAuMjEsMC4zNiwwLjM5LDAuNjZdLFsnYycsMC44NCwxLjc3LDEuMjYsMy4zNiwxLjMyLDUuMTBdLFsnYycsMC4wMywxLjI5LC0wLjIxLDIuMzcsLTAuODEsMy42M10sWydjJywtMC42MCwxLjIzLC0xLjI2LDIuMTMsLTMuMjEsNC4zOF0sWydjJywtMS4zNSwxLjUzLC0xLjg2LDIuMTksLTIuNDAsMi45N10sWydjJywtMC42MywwLjkzLC0xLjExLDEuOTIsLTEuMzgsMi43OV0sWydjJywtMC4xNSwwLjU0LC0wLjI3LDEuMzUsLTAuMjcsMS44MF0sWydsJywwLjAwLDAuMTVdLFsnbCcsLTAuMjEsMC4wMF0sWydsJywtMC4yMSwwLjAwXSxbJ2wnLDAuMDAsLTMuNzVdLFsnbCcsMC4wMCwtMy43NV0sWydsJywwLjIxLDAuMDBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuNDgsLTAuMzBdLFsnYycsMS44MywtMS4xMSwzLjEyLC0yLjEwLDQuMTcsLTMuMTJdLFsnYycsMC43OCwtMC44MSwxLjMyLC0xLjUzLDEuNzEsLTIuMzFdLFsnYycsMC40NSwtMC45MywwLjYwLC0xLjc0LDAuNTEsLTIuODhdLFsnYycsLTAuMTIsLTEuNTYsLTAuNjMsLTMuMTgsLTEuNDcsLTQuNjhdLFsnYycsLTAuMTIsLTAuMjEsLTAuMTUsLTAuMzMsLTAuMDYsLTAuNTFdLFsnYycsMC4wNiwtMC4xNSwwLjE1LC0wLjI0LDAuMzMsLTAuMzNdLFsneiddXSx3OjguNDkyLGg6MjEuNjkxfSxcblx0XHQnZmxhZ3MudWdyYWNlJzp7ZDpbWydNJyw2LjAzLDYuOTNdLFsnYycsMC4xNSwtMC4wOSwwLjMzLC0wLjA2LDAuNTEsMC4wMF0sWydjJywwLjE1LDAuMDksMC4yMSwwLjE1LDAuMzAsMC4zM10sWydjJywwLjA5LDAuMTgsMC4wNiwwLjM5LC0wLjAzLDAuNTRdLFsnYycsLTAuMDYsMC4xNSwtMTAuODksOC44OCwtMTEuMDcsOC45N10sWydjJywtMC4xNSwwLjA5LC0wLjMzLDAuMDYsLTAuNDgsMC4wMF0sWydjJywtMC4xOCwtMC4wOSwtMC4yNCwtMC4xNSwtMC4zMywtMC4zM10sWydjJywtMC4wOSwtMC4xOCwtMC4wNiwtMC4zOSwwLjAzLC0wLjU0XSxbJ2MnLDAuMDYsLTAuMTUsMTAuODksLTguODgsMTEuMDcsLTguOTddLFsneiddXSx3OjEyLjAxOSxoOjkuOTU0fSxcblx0XHQnZmxhZ3MuZGdyYWNlJzp7ZDpbWydNJywtNi4wNiwtMTUuOTNdLFsnYycsMC4xOCwtMC4wOSwwLjMzLC0wLjEyLDAuNDgsLTAuMDZdLFsnYycsMC4xOCwwLjA5LDE0LjAxLDguMDQsMTQuMTAsOC4xMF0sWydjJywwLjEyLDAuMTIsMC4xOCwwLjMzLDAuMTgsMC41MV0sWydjJywtMC4wMywwLjIxLC0wLjE1LDAuMzksLTAuMzYsMC40OF0sWydjJywtMC4xOCwwLjA5LC0wLjMzLDAuMTIsLTAuNDgsMC4wNl0sWydjJywtMC4xOCwtMC4wOSwtMTQuMDEsLTguMDQsLTE0LjEwLC04LjEwXSxbJ2MnLC0wLjEyLC0wLjEyLC0wLjE4LC0wLjMzLC0wLjE4LC0wLjUxXSxbJ2MnLDAuMDMsLTAuMjEsMC4xNSwtMC4zOSwwLjM2LC0wLjQ4XSxbJ3onXV0sdzoxNS4xMixoOjkuMjEyfSxcblx0XHQnZmxhZ3MuZDE2dGgnOntkOltbJ00nLDYuODQsLTIyLjUzXSxbJ2MnLDAuMjcsLTAuMTIsMC41NywtMC4wNiwwLjcyLDAuMTVdLFsnYycsMC4xNSwwLjE1LDAuMzMsMC44NywwLjQ1LDEuNTZdLFsnYycsMC4wNiwwLjMzLDAuMDYsMS4zNSwwLjAwLDEuNjVdLFsnYycsLTAuMDYsMC4zMywtMC4xNSwwLjc4LC0wLjI3LDEuMTFdLFsnYycsLTAuMTIsMC4zMywtMC40NSwwLjk2LC0wLjY2LDEuMzJdLFsnbCcsLTAuMTgsMC4yN10sWydsJywwLjA5LDAuMThdLFsnYycsMC40OCwxLjAyLDAuNzIsMi4yNSwwLjY5LDMuMzBdLFsnYycsLTAuMDYsMS4yMywtMC40MiwyLjI4LC0xLjI2LDMuNDVdLFsnYycsLTAuNTcsMC44NywtMC45OSwxLjMyLC0zLjAwLDMuMzldLFsnYycsLTEuNTYsMS41NiwtMi4yMiwyLjQwLC0yLjc2LDMuNDVdLFsnYycsLTAuNDIsMC44NCwtMC42NiwxLjgwLC0wLjY2LDIuNTVdLFsnbCcsMC4wMCwwLjE1XSxbJ2wnLC0wLjIxLDAuMDBdLFsnbCcsLTAuMjEsMC4wMF0sWydsJywwLjAwLC03LjUwXSxbJ2wnLDAuMDAsLTcuNTBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMjEsMC4wMF0sWydsJywwLjAwLDEuMTRdLFsnbCcsMC4wMCwxLjExXSxbJ2wnLDAuMjcsLTAuMTVdLFsnYycsMS4xMSwtMC41NywxLjc3LC0wLjk5LDIuNTIsLTEuNDddLFsnYycsMi4zNywtMS41NiwzLjY5LC0zLjE1LDQuMDUsLTQuODNdLFsnYycsMC4wMywtMC4xOCwwLjAzLC0wLjM5LDAuMDMsLTAuNzhdLFsnYycsMC4wMCwtMC42MCwtMC4wMywtMC45MywtMC4yNCwtMS41MF0sWydjJywtMC4wNiwtMC4xOCwtMC4xMiwtMC4zOSwtMC4xNSwtMC40NV0sWydjJywtMC4wMywtMC4yNCwwLjEyLC0wLjQ4LDAuMzYsLTAuNjBdLFsneiddLFsnbScsLTAuNjMsNy41MF0sWydjJywtMC4wNiwtMC4xOCwtMC4xNSwtMC4zNiwtMC4xNSwtMC4zNl0sWydjJywtMC4wMywwLjAwLC0wLjAzLDAuMDMsLTAuMDYsMC4wNl0sWydjJywtMC4wNiwwLjEyLC0wLjk2LDEuMDIsLTEuOTUsMS45OF0sWydjJywtMC42MywwLjU3LC0xLjI2LDEuMTcsLTEuNDQsMS4zNV0sWydjJywtMS41MywxLjYyLC0yLjI4LDIuODUsLTIuNTUsNC4zMl0sWydjJywtMC4wMywwLjE4LC0wLjAzLDAuNTQsLTAuMDYsMC45OV0sWydsJywwLjAwLDAuNjldLFsnbCcsMC4xOCwtMC4wOV0sWydjJywwLjkzLC0wLjU0LDIuMTAsLTEuMjksMi44MiwtMS44M10sWydjJywwLjY5LC0wLjUxLDEuMDIsLTAuODEsMS41MywtMS4yOV0sWydjJywxLjg2LC0xLjg5LDIuMzcsLTMuNjYsMS42OCwtNS44Ml0sWyd6J11dLHc6OC40NzUsaDoyMi41OTF9LFxuXHRcdCdmbGFncy5kMzJuZCc6e2Q6W1snTScsNi44NCwtMjkuMTNdLFsnYycsMC4yNywtMC4xMiwwLjU3LC0wLjA2LDAuNzIsMC4xNV0sWydjJywwLjEyLDAuMTIsMC4yNywwLjYzLDAuMzYsMS4xMV0sWydjJywwLjMzLDEuNTksMC4wNiwzLjA2LC0wLjgxLDQuNDddLFsnbCcsLTAuMTgsMC4yN10sWydsJywwLjA5LDAuMTVdLFsnYycsMC4xMiwwLjI0LDAuMzMsMC42OSwwLjQ1LDEuMDVdLFsnYycsMC42MywxLjgzLDAuNDUsMy41NywtMC41Nyw1LjIyXSxbJ2wnLC0wLjE4LDAuMzBdLFsnbCcsMC4xNSwwLjI3XSxbJ2MnLDAuNDIsMC44NywwLjYwLDEuNzEsMC41NywyLjYxXSxbJ2MnLC0wLjA2LDEuMjksLTAuNDgsMi40NiwtMS4zNSwzLjc4XSxbJ2MnLC0wLjU0LDAuODEsLTAuOTMsMS4yOSwtMi40NiwzLjAwXSxbJ2MnLC0wLjUxLDAuNTQsLTEuMDUsMS4xNywtMS4yNiwxLjQxXSxbJ2MnLC0xLjU2LDEuODYsLTIuMjUsMy4zNiwtMi4zNyw1LjAxXSxbJ2wnLDAuMDAsMC4zM10sWydsJywtMC4yMSwwLjAwXSxbJ2wnLC0wLjIxLDAuMDBdLFsnbCcsMC4wMCwtMTEuMjVdLFsnbCcsMC4wMCwtMTEuMjVdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMjEsMC4wMF0sWydsJywwLjAwLDEuMzVdLFsnbCcsMC4wMywxLjM1XSxbJ2wnLDAuNzgsLTAuMzldLFsnYycsMS4zOCwtMC42OSwyLjM0LC0xLjI2LDMuMjQsLTEuOTJdLFsnYycsMS4zOCwtMS4wMiwyLjI4LC0yLjEzLDIuNjQsLTMuMjFdLFsnYycsMC4xNSwtMC40OCwwLjE4LC0wLjcyLDAuMTgsLTEuMjldLFsnYycsMC4wMCwtMC41NywtMC4wNiwtMC45MCwtMC4yNCwtMS40N10sWydjJywtMC4wNiwtMC4xOCwtMC4xMiwtMC4zOSwtMC4xNSwtMC40NV0sWydjJywtMC4wMywtMC4yNCwwLjEyLC0wLjQ4LDAuMzYsLTAuNjBdLFsneiddLFsnbScsLTAuNjMsNy4yMF0sWydjJywtMC4wOSwtMC4xOCwtMC4xMiwtMC4yMSwtMC4xMiwtMC4xNV0sWydjJywtMC4wMywwLjA5LC0xLjAyLDEuMDgsLTIuMDQsMi4wNF0sWydjJywtMS4xNywxLjA4LC0xLjY1LDEuNTYsLTIuMDcsMi4wNF0sWydjJywtMC44NCwwLjk2LC0xLjM4LDEuODYsLTEuNjgsMi43Nl0sWydjJywtMC4yMSwwLjU3LC0wLjI3LDAuOTksLTAuMzAsMS42NV0sWydsJywwLjAwLDAuNTRdLFsnbCcsMC42NiwtMC4zM10sWydjJywzLjU3LC0xLjg2LDUuNDksLTMuNjksNS45NCwtNS43MF0sWydjJywwLjA2LC0wLjM5LDAuMDYsLTEuMjAsLTAuMDMsLTEuNjVdLFsnYycsLTAuMDYsLTAuMzksLTAuMjQsLTAuOTAsLTAuMzYsLTEuMjBdLFsneiddLFsnbScsLTAuMDYsNy4yMF0sWydjJywtMC4wNiwtMC4xNSwtMC4xMiwtMC4zMywtMC4xNSwtMC40NV0sWydsJywtMC4wNiwtMC4xOF0sWydsJywtMC4xOCwwLjIxXSxbJ2wnLC0xLjgzLDEuODNdLFsnYycsLTAuODcsMC45MCwtMS43NywxLjgwLC0xLjk1LDIuMDFdLFsnYycsLTEuMDgsMS4yOSwtMS42MiwyLjMxLC0xLjg5LDMuNTFdLFsnYycsLTAuMDYsMC4zMCwtMC4wNiwwLjUxLC0wLjA5LDAuOTNdLFsnbCcsMC4wMCwwLjU3XSxbJ2wnLDAuMDksLTAuMDZdLFsnYycsMC43NSwtMC40NSwxLjg5LC0xLjI2LDIuNTIsLTEuNzRdLFsnYycsMC44MSwtMC42NiwxLjc0LC0xLjUzLDIuMjIsLTIuMTZdLFsnYycsMS4yNiwtMS41MywxLjY4LC0zLjA2LDEuMzIsLTQuNDddLFsneiddXSx3OjguMzg1LGg6MjkuMTkxfSxcblx0XHQnZmxhZ3MuZDY0dGgnOntkOltbJ00nLDcuMDgsLTMyLjg4XSxbJ2MnLDAuMzAsLTAuMTIsMC42NiwtMC4wMywwLjc4LDAuMjRdLFsnYycsMC4xOCwwLjMzLDAuMjcsMi4xMCwwLjE1LDIuNjRdLFsnYycsLTAuMDksMC4zOSwtMC4yMSwwLjc4LC0wLjM5LDEuMDhdLFsnbCcsLTAuMTUsMC4zMF0sWydsJywwLjA5LDAuMjddLFsnYycsMC4wMywwLjEyLDAuMDksMC40NSwwLjEyLDAuNjldLFsnYycsMC4yNywxLjQ0LDAuMTgsMi41NSwtMC4zMCwzLjYwXSxbJ2wnLC0wLjEyLDAuMzNdLFsnbCcsMC4wNiwwLjQyXSxbJ2MnLDAuMjcsMS4zNSwwLjMzLDIuODIsMC4yMSwzLjYzXSxbJ2MnLC0wLjEyLDAuNjAsLTAuMzAsMS4yMywtMC41NywxLjgwXSxbJ2wnLC0wLjE1LDAuMjddLFsnbCcsMC4wMywwLjQyXSxbJ2MnLDAuMDYsMS4wMiwwLjA2LDIuNzAsMC4wMywzLjA2XSxbJ2MnLC0wLjE1LDEuNDcsLTAuNjYsMi43NiwtMS43NCw0LjQxXSxbJ2MnLC0wLjQ1LDAuNjksLTAuNzUsMS4xMSwtMS43NCwyLjM3XSxbJ2MnLC0xLjA1LDEuMzgsLTEuNTAsMS45OCwtMS45NSwyLjczXSxbJ2MnLC0wLjkzLDEuNTAsLTEuMzgsMi44MiwtMS40NCw0LjIwXSxbJ2wnLDAuMDAsMC40Ml0sWydsJywtMC4yMSwwLjAwXSxbJ2wnLC0wLjIxLDAuMDBdLFsnbCcsMC4wMCwtMTUuMDBdLFsnbCcsMC4wMCwtMTUuMDBdLFsnbCcsMC4yMSwwLjAwXSxbJ2wnLDAuMjEsMC4wMF0sWydsJywwLjAwLDEuODZdLFsnbCcsMC4wMCwxLjg5XSxbJ2MnLDAuMDAsMC4wMCwwLjIxLC0wLjAzLDAuNDUsLTAuMDldLFsnYycsMi4yMiwtMC4zOSw0LjA4LC0xLjExLDUuMTksLTIuMDFdLFsnYycsMC42MywtMC41NCwxLjAyLC0xLjE0LDEuMjAsLTEuODBdLFsnYycsMC4wNiwtMC4zMCwwLjA2LC0xLjE0LC0wLjAzLC0xLjY1XSxbJ2MnLC0wLjAzLC0wLjE4LC0wLjA2LC0wLjM5LC0wLjA5LC0wLjQ4XSxbJ2MnLC0wLjAzLC0wLjI0LDAuMTIsLTAuNDgsMC4zNiwtMC42MF0sWyd6J10sWydtJywtMC40NSw2LjE1XSxbJ2MnLC0wLjAzLC0wLjE4LC0wLjA2LC0wLjQyLC0wLjA2LC0wLjU0XSxbJ2wnLC0wLjAzLC0wLjE4XSxbJ2wnLC0wLjMzLDAuMzBdLFsnYycsLTAuNDIsMC4zNiwtMC44NywwLjcyLC0xLjY4LDEuMjldLFsnYycsLTEuOTgsMS4zOCwtMi4yNSwxLjU5LC0yLjg1LDIuMTZdLFsnYycsLTAuNzUsMC42OSwtMS4yMywxLjQ0LC0xLjQ3LDIuMTldLFsnYycsLTAuMTUsMC40NSwtMC4xOCwwLjYzLC0wLjIxLDEuMzVdLFsnbCcsMC4wMCwwLjY2XSxbJ2wnLDAuMzksLTAuMThdLFsnYycsMS44MywtMC45MCwzLjQ1LC0xLjk1LDQuNDcsLTIuOTFdLFsnYycsMC45MywtMC45MCwxLjUzLC0xLjgzLDEuNzQsLTIuODJdLFsnYycsMC4wNiwtMC4zMywwLjA2LC0wLjg3LDAuMDMsLTEuMzJdLFsneiddLFsnbScsLTAuMjcsNC44Nl0sWydjJywtMC4wMywtMC4yMSwtMC4wNiwtMC4zNiwtMC4wNiwtMC4zNl0sWydjJywwLjAwLC0wLjAzLC0wLjEyLDAuMDksLTAuMjQsMC4yNF0sWydjJywtMC4zOSwwLjQ4LC0wLjk5LDEuMDgsLTIuMTYsMi4xOV0sWydjJywtMS40NywxLjM4LC0xLjkyLDEuODMsLTIuNDYsMi40OV0sWydjJywtMC42NiwwLjg3LC0xLjA4LDEuNzQsLTEuMjksMi41OF0sWydjJywtMC4wOSwwLjQyLC0wLjE1LDAuODcsLTAuMTUsMS40NF0sWydsJywwLjAwLDAuNTRdLFsnbCcsMC40OCwtMC4zM10sWydjJywxLjUwLC0xLjAyLDIuNTgsLTEuODksMy41MSwtMi44Ml0sWydjJywxLjQ3LC0xLjQ3LDIuMjUsLTIuODUsMi40MCwtNC4yNl0sWydjJywwLjAzLC0wLjM5LDAuMDMsLTEuMTcsLTAuMDMsLTEuNzFdLFsneiddLFsnbScsLTAuNjYsNy42OF0sWydjJywwLjAzLC0wLjE1LDAuMDMsLTAuNjAsMC4wMywtMC45OV0sWydsJywwLjAwLC0wLjcyXSxbJ2wnLC0wLjI3LDAuMzNdLFsnbCcsLTEuNzQsMS45OF0sWydjJywtMS43NywxLjkyLC0yLjQzLDIuNzYsLTIuOTcsMy45MF0sWydjJywtMC41MSwxLjAyLC0wLjcyLDEuNzcsLTAuNzUsMi45MV0sWydjJywwLjAwLDAuNjMsMC4wMCwwLjYzLDAuMDYsMC42MF0sWydjJywwLjAzLC0wLjAzLDAuMzAsLTAuMjcsMC42MywtMC41NF0sWydjJywwLjY2LC0wLjYwLDEuODYsLTEuODAsMi4zMSwtMi4zMV0sWydjJywxLjY1LC0xLjg5LDIuNTIsLTMuNTQsMi43MCwtNS4xNl0sWyd6J11dLHc6OC40ODUsaDozMi45MzJ9LFxuXHRcdCdjbGVmcy5DJzp7ZDpbWydNJywwLjA2LC0xNC45NF0sWydsJywwLjA5LC0wLjA2XSxbJ2wnLDEuOTIsMC4wMF0sWydsJywxLjkyLDAuMDBdLFsnbCcsMC4wOSwwLjA2XSxbJ2wnLDAuMDYsMC4wOV0sWydsJywwLjAwLDE0Ljg1XSxbJ2wnLDAuMDAsMTQuODJdLFsnbCcsLTAuMDYsMC4wOV0sWydsJywtMC4wOSwwLjA2XSxbJ2wnLC0xLjkyLDAuMDBdLFsnbCcsLTEuOTIsMC4wMF0sWydsJywtMC4wOSwtMC4wNl0sWydsJywtMC4wNiwtMC4wOV0sWydsJywwLjAwLC0xNC44Ml0sWydsJywwLjAwLC0xNC44NV0sWyd6J10sWydtJyw1LjM3LDAuMDBdLFsnYycsMC4wOSwtMC4wNiwwLjA5LC0wLjA2LDAuNTcsLTAuMDZdLFsnYycsMC40NSwwLjAwLDAuNDUsMC4wMCwwLjU0LDAuMDZdLFsnbCcsMC4wNiwwLjA5XSxbJ2wnLDAuMDAsNy4xNF0sWydsJywwLjAwLDcuMTFdLFsnbCcsMC4wOSwtMC4wNl0sWydjJywwLjE4LC0wLjE4LDAuNzIsLTAuODQsMC45NiwtMS4yMF0sWydjJywwLjMwLC0wLjQ1LDAuNjYsLTEuMTcsMC44NCwtMS42NV0sWydjJywwLjM2LC0wLjkwLDAuNTcsLTEuODMsMC42MCwtMi43OV0sWydjJywwLjAzLC0wLjQ4LDAuMDMsLTAuNTQsMC4wOSwtMC42M10sWydjJywwLjEyLC0wLjE4LDAuMzYsLTAuMjEsMC41NCwtMC4xMl0sWydjJywwLjE4LDAuMDksMC4yMSwwLjE1LDAuMjQsMC42Nl0sWydjJywwLjA2LDAuODcsMC4yMSwxLjU2LDAuNTcsMi4yMl0sWydjJywwLjUxLDEuMDIsMS4yNiwxLjY4LDIuMjIsMS45Ml0sWydjJywwLjIxLDAuMDYsMC4zMywwLjA2LDAuNzgsMC4wNl0sWydjJywwLjQ1LDAuMDAsMC41NywwLjAwLDAuODQsLTAuMDZdLFsnYycsMC40NSwtMC4xMiwwLjgxLC0wLjMzLDEuMDgsLTAuNjBdLFsnYycsMC41NywtMC41NywwLjg3LC0xLjQxLDAuOTksLTIuODhdLFsnYycsMC4wNiwtMC41NCwwLjA2LC0zLjAwLDAuMDAsLTMuNTddLFsnYycsLTAuMjEsLTIuNTgsLTAuODQsLTMuODcsLTIuMTYsLTQuNTBdLFsnYycsLTAuNDgsLTAuMjEsLTEuMTcsLTAuMzYsLTEuNzcsLTAuMzZdLFsnYycsLTAuNjksMC4wMCwtMS4yOSwwLjI3LC0xLjUwLDAuNzJdLFsnYycsLTAuMDYsMC4xNSwtMC4wNiwwLjIxLC0wLjA2LDAuNDJdLFsnYycsMC4wMCwwLjI0LDAuMDAsMC4zMCwwLjA2LDAuNDVdLFsnYycsMC4xMiwwLjI0LDAuMjQsMC4zOSwwLjYzLDAuNjZdLFsnYycsMC40MiwwLjMwLDAuNTcsMC40OCwwLjY5LDAuNzJdLFsnYycsMC4wNiwwLjE1LDAuMDYsMC4yMSwwLjA2LDAuNDhdLFsnYycsMC4wMCwwLjM5LC0wLjAzLDAuNjMsLTAuMjEsMC45Nl0sWydjJywtMC4zMCwwLjYwLC0wLjg3LDEuMDgsLTEuNTAsMS4yNl0sWydjJywtMC4yNywwLjA2LC0wLjg3LDAuMDYsLTEuMTQsMC4wMF0sWydjJywtMC43OCwtMC4yNCwtMS40NCwtMC44NywtMS42NSwtMS42OF0sWydjJywtMC4xMiwtMC40MiwtMC4wOSwtMS4xNywwLjA5LC0xLjcxXSxbJ2MnLDAuNTEsLTEuNjUsMS45OCwtMi44MiwzLjgxLC0zLjA5XSxbJ2MnLDAuODQsLTAuMDksMi40NiwwLjAzLDMuNTEsMC4yN10sWydjJywyLjIyLDAuNTcsMy42OSwxLjgwLDQuNDQsMy43NV0sWydjJywwLjM2LDAuOTMsMC41NywyLjEzLDAuNTcsMy4zNl0sWydjJywwLjAwLDEuNDQsLTAuNDgsMi43MywtMS4zOCwzLjgxXSxbJ2MnLC0xLjI2LDEuNTAsLTMuMjcsMi40MywtNS4yOCwyLjQzXSxbJ2MnLC0wLjQ4LDAuMDAsLTAuNTEsMC4wMCwtMC43NSwtMC4wOV0sWydjJywtMC4xNSwtMC4wMywtMC40OCwtMC4yMSwtMC43OCwtMC4zNl0sWydjJywtMC42OSwtMC4zNiwtMC44NywtMC40MiwtMS4yNiwtMC40Ml0sWydjJywtMC4yNywwLjAwLC0wLjMwLDAuMDAsLTAuNTEsMC4wOV0sWydjJywtMC41NywwLjMwLC0wLjgxLDAuOTAsLTAuODEsMi4xMF0sWydjJywwLjAwLDEuMjMsMC4yNCwxLjgzLDAuODEsMi4xM10sWydjJywwLjIxLDAuMDksMC4yNCwwLjA5LDAuNTEsMC4wOV0sWydjJywwLjM5LDAuMDAsMC41NywtMC4wNiwxLjI2LC0wLjQyXSxbJ2MnLDAuMzAsLTAuMTUsMC42MywtMC4zMywwLjc4LC0wLjM2XSxbJ2MnLDAuMjQsLTAuMDksMC4yNywtMC4wOSwwLjc1LC0wLjA5XSxbJ2MnLDIuMDEsMC4wMCw0LjAyLDAuOTMsNS4yOCwyLjQwXSxbJ2MnLDAuOTAsMS4xMSwxLjM4LDIuNDAsMS4zOCwzLjg0XSxbJ2MnLDAuMDAsMS41MCwtMC4zMCwyLjg4LC0wLjg0LDMuOTZdLFsnYycsLTAuNzgsMS41OSwtMi4xOSwyLjY0LC00LjE3LDMuMTVdLFsnYycsLTEuMDUsMC4yNCwtMi42NywwLjM2LC0zLjUxLDAuMjddLFsnYycsLTEuODMsLTAuMjcsLTMuMzAsLTEuNDQsLTMuODEsLTMuMDldLFsnYycsLTAuMTgsLTAuNTQsLTAuMjEsLTEuMjksLTAuMDksLTEuNzRdLFsnYycsMC4xNSwtMC42MCwwLjYzLC0xLjIwLDEuMjMsLTEuNDddLFsnYycsMC4zNiwtMC4xOCwwLjU3LC0wLjIxLDAuOTksLTAuMjFdLFsnYycsMC40MiwwLjAwLDAuNjMsMC4wMywxLjAyLDAuMjFdLFsnYycsMC40MiwwLjIxLDAuODQsMC42MywxLjA1LDEuMDVdLFsnYycsMC4xOCwwLjM2LDAuMjEsMC42MCwwLjIxLDAuOTZdLFsnYycsMC4wMCwwLjMwLDAuMDAsMC4zNiwtMC4wNiwwLjUxXSxbJ2MnLC0wLjEyLDAuMjQsLTAuMjcsMC40MiwtMC42OSwwLjcyXSxbJ2MnLC0wLjU3LDAuNDIsLTAuNjksMC42MywtMC42OSwxLjA4XSxbJ2MnLDAuMDAsMC4yNCwwLjAwLDAuMzAsMC4wNiwwLjQ1XSxbJ2MnLDAuMTIsMC4yMSwwLjMwLDAuMzksMC41NywwLjU0XSxbJ2MnLDAuNDIsMC4xOCwwLjg3LDAuMjEsMS41MywwLjE1XSxbJ2MnLDEuMDgsLTAuMTUsMS44MCwtMC41NywyLjM0LC0xLjMyXSxbJ2MnLDAuNTQsLTAuNzUsMC44NCwtMS44MywwLjk5LC0zLjUxXSxbJ2MnLDAuMDYsLTAuNTcsMC4wNiwtMy4wMywwLjAwLC0zLjU3XSxbJ2MnLC0wLjEyLC0xLjQ3LC0wLjQyLC0yLjMxLC0wLjk5LC0yLjg4XSxbJ2MnLC0wLjI3LC0wLjI3LC0wLjYzLC0wLjQ4LC0xLjA4LC0wLjYwXSxbJ2MnLC0wLjI3LC0wLjA2LC0wLjM5LC0wLjA2LC0wLjg0LC0wLjA2XSxbJ2MnLC0wLjQ1LDAuMDAsLTAuNTcsMC4wMCwtMC43OCwwLjA2XSxbJ2MnLC0xLjE0LDAuMjcsLTIuMDEsMS4xNywtMi40NiwyLjQ5XSxbJ2MnLC0wLjIxLDAuNTcsLTAuMzAsMC45OSwtMC4zMywxLjY1XSxbJ2MnLC0wLjAzLDAuNTEsLTAuMDYsMC41NywtMC4yNCwwLjY2XSxbJ2MnLC0wLjEyLDAuMDYsLTAuMjcsMC4wNiwtMC4zOSwwLjAwXSxbJ2MnLC0wLjIxLC0wLjA5LC0wLjIxLC0wLjE1LC0wLjI0LC0wLjc1XSxbJ2MnLC0wLjA5LC0xLjkyLC0wLjc4LC0zLjcyLC0yLjAxLC01LjE5XSxbJ2MnLC0wLjE4LC0wLjIxLC0wLjM2LC0wLjQyLC0wLjM5LC0wLjQ1XSxbJ2wnLC0wLjA5LC0wLjA2XSxbJ2wnLDAuMDAsNy4xMV0sWydsJywwLjAwLDcuMTRdLFsnbCcsLTAuMDYsMC4wOV0sWydjJywtMC4wOSwwLjA2LC0wLjA5LDAuMDYsLTAuNTQsMC4wNl0sWydjJywtMC40OCwwLjAwLC0wLjQ4LDAuMDAsLTAuNTcsLTAuMDZdLFsnbCcsLTAuMDYsLTAuMDldLFsnbCcsMC4wMCwtMTQuODJdLFsnbCcsMC4wMCwtMTQuODVdLFsneiddXSx3OjIwLjMxLGg6MjkuOTd9LFxuXHRcdCdjbGVmcy5GJzp7ZDpbWydNJyw2LjMwLC03LjgwXSxbJ2MnLDAuMzYsLTAuMDMsMS42NSwwLjAwLDIuMTMsMC4wM10sWydjJywzLjYwLDAuNDIsNi4wMywyLjEwLDYuOTMsNC44Nl0sWydjJywwLjI3LDAuODQsMC4zNiwxLjUwLDAuMzYsMi41OF0sWydjJywwLjAwLDAuOTAsLTAuMDMsMS4zNSwtMC4xOCwyLjE2XSxbJ2MnLC0wLjc4LDMuNzgsLTMuNTQsNy4wOCwtOC4zNyw5Ljk2XSxbJ2MnLC0xLjc0LDEuMDUsLTMuODcsMi4xMywtNi4xOCwzLjEyXSxbJ2MnLC0wLjM5LDAuMTgsLTAuNzUsMC4zMywtMC44MSwwLjM2XSxbJ2MnLC0wLjA2LDAuMDMsLTAuMTUsMC4wNiwtMC4xOCwwLjA2XSxbJ2MnLC0wLjE1LDAuMDAsLTAuMzMsLTAuMTgsLTAuMzMsLTAuMzNdLFsnYycsMC4wMCwtMC4xNSwwLjA2LC0wLjIxLDAuNTEsLTAuNDhdLFsnYycsMy4wMCwtMS43Nyw1LjEzLC0zLjIxLDYuODQsLTQuNzRdLFsnYycsMC41MSwtMC40NSwxLjU5LC0xLjUwLDEuOTUsLTEuOTVdLFsnYycsMS44OSwtMi4xOSwyLjg4LC00LjMyLDMuMTUsLTYuNzhdLFsnYycsMC4wNiwtMC40MiwwLjA2LC0xLjc3LDAuMDAsLTIuMTldLFsnYycsLTAuMjQsLTIuMDEsLTAuOTMsLTMuNjMsLTIuMDQsLTQuNzFdLFsnYycsLTAuNjMsLTAuNjMsLTEuMjksLTEuMDIsLTIuMDcsLTEuMjBdLFsnYycsLTEuNjIsLTAuMzksLTMuMzYsMC4xNSwtNC41NiwxLjQ0XSxbJ2MnLC0wLjU0LDAuNjAsLTEuMDUsMS40NywtMS4zMiwyLjIyXSxbJ2wnLC0wLjA5LDAuMjFdLFsnbCcsMC4yNCwtMC4xMl0sWydjJywwLjM5LC0wLjIxLDAuNjMsLTAuMjQsMS4xMSwtMC4yNF0sWydjJywwLjMwLDAuMDAsMC40NSwwLjAwLDAuNjYsMC4wNl0sWydjJywxLjkyLDAuNDgsMi44NSwyLjU1LDEuOTUsNC4zOF0sWydjJywtMC40NSwwLjk5LC0xLjQxLDEuNjIsLTIuNDYsMS43MV0sWydjJywtMS40NywwLjA5LC0yLjkxLC0wLjg3LC0zLjM5LC0yLjI1XSxbJ2MnLC0wLjE4LC0wLjU3LC0wLjIxLC0xLjMyLC0wLjAzLC0yLjI4XSxbJ2MnLDAuMzksLTIuMjUsMS44MywtNC4yMCwzLjgxLC01LjE5XSxbJ2MnLDAuNjksLTAuMzYsMS41OSwtMC42MCwyLjM3LC0wLjY5XSxbJ3onXSxbJ20nLDExLjU4LDIuNTJdLFsnYycsMC44NCwtMC4yMSwxLjcxLDAuMzAsMS44OSwxLjE0XSxbJ2MnLDAuMzAsMS4xNywtMC43MiwyLjE5LC0xLjg5LDEuODldLFsnYycsLTAuOTksLTAuMjEsLTEuNTAsLTEuMzIsLTEuMDIsLTIuMjVdLFsnYycsMC4xOCwtMC4zOSwwLjYwLC0wLjY5LDEuMDIsLTAuNzhdLFsneiddLFsnbScsMC4wMCw3LjUwXSxbJ2MnLDAuODQsLTAuMjEsMS43MSwwLjMwLDEuODksMS4xNF0sWydjJywwLjIxLDAuODcsLTAuMzAsMS43MSwtMS4xNCwxLjg5XSxbJ2MnLC0wLjg3LDAuMjEsLTEuNzEsLTAuMzAsLTEuODksLTEuMTRdLFsnYycsLTAuMjEsLTAuODQsMC4zMCwtMS43MSwxLjE0LC0xLjg5XSxbJ3onXV0sdzoyMC4xNTMsaDoyMy4xNDJ9LFxuXHRcdCdjbGVmcy5HJzp7ZDpbWydNJyw5LjY5LC0zNy40MV0sWydjJywwLjA5LC0wLjA5LDAuMjQsLTAuMDYsMC4zNiwwLjAwXSxbJ2MnLDAuMTIsMC4wOSwwLjU3LDAuNjAsMC45NiwxLjExXSxbJ2MnLDEuNzcsMi4zNCwzLjIxLDUuODUsMy41Nyw4LjczXSxbJ2MnLDAuMjEsMS41NiwwLjAzLDMuMjcsLTAuNDUsNC44Nl0sWydjJywtMC42OSwyLjMxLC0xLjkyLDQuNDcsLTQuMjMsNy40NF0sWydjJywtMC4zMCwwLjM5LC0wLjU3LDAuNzIsLTAuNjAsMC43NV0sWydjJywtMC4wMywwLjA2LDAuMDAsMC4xNSwwLjE4LDAuNzhdLFsnYycsMC41NCwxLjY4LDEuMzgsNC40NCwxLjY4LDUuNDldLFsnbCcsMC4wOSwwLjQyXSxbJ2wnLDAuMzksMC4wMF0sWydjJywxLjQ3LDAuMDksMi43NiwwLjUxLDMuOTYsMS4yOV0sWydjJywxLjgzLDEuMjMsMy4wNiwzLjIxLDMuMzksNS41Ml0sWydjJywwLjA5LDAuNDUsMC4xMiwxLjI5LDAuMDYsMS43NF0sWydjJywtMC4wOSwxLjAyLC0wLjMzLDEuODMsLTAuNzUsMi43M10sWydjJywtMC44NCwxLjcxLC0yLjI4LDMuMDYsLTQuMDIsMy43Ml0sWydsJywtMC4zMywwLjEyXSxbJ2wnLDAuMDMsMS4yNl0sWydjJywwLjAwLDEuNzQsLTAuMDYsMy42MywtMC4yMSw0LjYyXSxbJ2MnLC0wLjQ1LDMuMDYsLTIuMTksNS40OSwtNC40Nyw2LjIxXSxbJ2MnLC0wLjU3LDAuMTgsLTAuOTAsMC4yMSwtMS41OSwwLjIxXSxbJ2MnLC0wLjY5LDAuMDAsLTEuMDIsLTAuMDMsLTEuNjUsLTAuMjFdLFsnYycsLTEuMTQsLTAuMjcsLTIuMTMsLTAuODQsLTIuOTQsLTEuNjVdLFsnYycsLTAuOTksLTAuOTksLTEuNTYsLTIuMTYsLTEuNzEsLTMuNTRdLFsnYycsLTAuMDksLTAuODEsMC4wNiwtMS41MywwLjQ1LC0yLjEzXSxbJ2MnLDAuNjMsLTAuOTksMS44MywtMS41NiwzLjAwLC0xLjUzXSxbJ2MnLDEuNTAsMC4wOSwyLjY0LDEuMzIsMi43MywyLjk0XSxbJ2MnLDAuMDYsMS40NywtMC45MywyLjcwLC0yLjM3LDIuOTddLFsnYycsLTAuNDUsMC4wNiwtMC44NCwwLjAzLC0xLjI5LC0wLjA5XSxbJ2wnLC0wLjIxLC0wLjA5XSxbJ2wnLDAuMDksMC4xMl0sWydjJywwLjM5LDAuNTQsMC43OCwwLjkzLDEuMzIsMS4yNl0sWydjJywxLjM1LDAuODcsMy4wNiwxLjAyLDQuMzUsMC4zNl0sWydjJywxLjQ0LC0wLjcyLDIuNTIsLTIuMjgsMi45NywtNC4zNV0sWydjJywwLjE1LC0wLjY2LDAuMjQsLTEuNTAsMC4zMCwtMy4wM10sWydjJywwLjAzLC0wLjg0LDAuMDMsLTIuOTQsMC4wMCwtMy4wMF0sWydjJywtMC4wMywwLjAwLC0wLjE4LDAuMDAsLTAuMzYsMC4wM10sWydjJywtMC42NiwwLjEyLC0wLjk5LDAuMTIsLTEuODMsMC4xMl0sWydjJywtMS4wNSwwLjAwLC0xLjcxLC0wLjA2LC0yLjYxLC0wLjMwXSxbJ2MnLC00LjAyLC0wLjk5LC03LjExLC00LjM1LC03LjgwLC04LjQ2XSxbJ2MnLC0wLjEyLC0wLjY2LC0wLjEyLC0wLjk5LC0wLjEyLC0xLjgzXSxbJ2MnLDAuMDAsLTAuODQsMC4wMCwtMS4xNCwwLjE1LC0xLjkyXSxbJ2MnLDAuMzYsLTIuMjgsMS40MSwtNC42MiwzLjMwLC03LjI5XSxbJ2wnLDIuNzksLTMuNjBdLFsnYycsMC41NCwtMC42NiwwLjk2LC0xLjIwLDAuOTYsLTEuMjNdLFsnYycsMC4wMCwtMC4wMywtMC4wOSwtMC4zMywtMC4xOCwtMC42OV0sWydjJywtMC45NiwtMy4yMSwtMS40MSwtNS4yOCwtMS41OSwtNy42OF0sWydjJywtMC4xMiwtMS4zOCwtMC4xNSwtMy4wOSwtMC4wNiwtMy45Nl0sWydjJywwLjMzLC0yLjY3LDEuMzgsLTUuMDcsMy4xMiwtNy4wOF0sWydjJywwLjM2LC0wLjQyLDAuOTksLTEuMDUsMS4xNywtMS4xNF0sWyd6J10sWydtJywyLjAxLDQuNzFdLFsnYycsLTAuMTUsLTAuMzAsLTAuMzAsLTAuNTQsLTAuMzAsLTAuNTRdLFsnYycsLTAuMDMsMC4wMCwtMC4xOCwwLjA5LC0wLjMwLDAuMjFdLFsnYycsLTIuNDAsMS43NCwtMy44Nyw0LjIwLC00LjI2LDcuMTFdLFsnYycsLTAuMDYsMC41NCwtMC4wNiwxLjQxLC0wLjAzLDEuODldLFsnYycsMC4wOSwxLjI5LDAuNDgsMy4xMiwxLjA4LDUuMjJdLFsnYycsMC4xNSwwLjQyLDAuMjQsMC43OCwwLjI0LDAuODFdLFsnYycsMC4wMCwwLjAzLDAuODQsLTEuMTEsMS4yMywtMS42OF0sWydjJywxLjg5LC0yLjczLDIuODgsLTUuMDcsMy4xNSwtNy41M10sWydjJywwLjA5LC0wLjU3LDAuMTIsLTEuNzQsMC4wNiwtMi4zN10sWydjJywtMC4wOSwtMS4yMywtMC4yNywtMS45MiwtMC44NywtMy4xMl0sWyd6J10sWydtJywtMi45NCwyMC43MF0sWydjJywtMC4yMSwtMC43MiwtMC4zOSwtMS4zMiwtMC40MiwtMS4zMl0sWydjJywwLjAwLDAuMDAsLTEuMjAsMS40NywtMS44NiwyLjM3XSxbJ2MnLC0yLjc5LDMuNjMsLTQuMDIsNi4zMCwtNC4zNSw5LjMwXSxbJ2MnLC0wLjAzLDAuMjEsLTAuMDMsMC42OSwtMC4wMywxLjA4XSxbJ2MnLDAuMDAsMC42OSwwLjAwLDAuNzUsMC4wNiwxLjExXSxbJ2MnLDAuMTIsMC41NCwwLjI3LDAuOTksMC41MSwxLjQ3XSxbJ2MnLDAuNjksMS4zOCwxLjgzLDIuNTUsMy40MiwzLjQyXSxbJ2MnLDAuOTYsMC41NCwyLjA3LDAuOTAsMy4yMSwxLjA4XSxbJ2MnLDAuNzgsMC4xMiwyLjA0LDAuMTIsMi45NCwtMC4wM10sWydjJywwLjUxLC0wLjA2LDAuNDUsLTAuMDMsMC40MiwtMC4zMF0sWydjJywtMC4yNCwtMy4zMywtMC43MiwtNi4zMywtMS42MiwtMTAuMDhdLFsnYycsLTAuMDksLTAuMzksLTAuMTgsLTAuNzUsLTAuMTgsLTAuNzhdLFsnYycsLTAuMDMsLTAuMDMsLTAuNDIsMC4wMCwtMC44MSwwLjA5XSxbJ2MnLC0wLjkwLDAuMTgsLTEuNjUsMC41NywtMi4yMiwxLjE0XSxbJ2MnLC0wLjcyLDAuNzIsLTEuMDgsMS42NSwtMS4wNSwyLjY0XSxbJ2MnLDAuMDYsMC45NiwwLjQ4LDEuODMsMS4yMywyLjU4XSxbJ2MnLDAuMzYsMC4zNiwwLjcyLDAuNjMsMS4xNywwLjkwXSxbJ2MnLDAuMzMsMC4xOCwwLjM2LDAuMjEsMC40MiwwLjMzXSxbJ2MnLDAuMTgsMC40MiwtMC4xOCwwLjkwLC0wLjYwLDAuODddLFsnYycsLTAuMTgsLTAuMDMsLTAuODQsLTAuMzYsLTEuMjYsLTAuNjNdLFsnYycsLTAuNzgsLTAuNTEsLTEuMzgsLTEuMTEsLTEuODYsLTEuODNdLFsnYycsLTEuNzcsLTIuNzAsLTAuOTksLTYuNDIsMS43MSwtOC4xOV0sWydjJywwLjMwLC0wLjIxLDAuODEsLTAuNDgsMS4xNywtMC42M10sWydjJywwLjMwLC0wLjA5LDEuMDIsLTAuMzAsMS4xNCwtMC4zMF0sWydjJywwLjA2LDAuMDAsMC4wOSwwLjAwLDAuMDksLTAuMDNdLFsnYycsMC4wMywtMC4wMywtMC41MSwtMS45MiwtMS4yMywtNC4yNl0sWyd6J10sWydtJywzLjc4LDcuNDFdLFsnYycsLTAuMTgsLTAuMDMsLTAuMzYsLTAuMDYsLTAuMzksLTAuMDZdLFsnYycsLTAuMDMsMC4wMCwwLjAwLDAuMjEsMC4xOCwxLjAyXSxbJ2MnLDAuNzUsMy4xOCwxLjI2LDYuMzAsMS41MCw5LjA5XSxbJ2MnLDAuMDYsMC43MiwwLjAwLDAuNjksMC41MSwwLjQyXSxbJ2MnLDAuNzgsLTAuMzYsMS40NCwtMC45NiwxLjk4LC0xLjc3XSxbJ2MnLDEuMDgsLTEuNjIsMS4yMCwtMy42OSwwLjMwLC01LjU1XSxbJ2MnLC0wLjgxLC0xLjYyLC0yLjMxLC0yLjc5LC00LjA4LC0zLjE1XSxbJ3onXV0sdzoxOS4wNTEsaDo1Ny4wNTd9LFxuXHRcdCdjbGVmcy5wZXJjJzp7ZDpbWydNJyw1LjA3LC03LjQ0XSxbJ2wnLDAuMDksLTAuMDZdLFsnbCcsMS41MywwLjAwXSxbJ2wnLDEuNTMsMC4wMF0sWydsJywwLjA5LDAuMDZdLFsnbCcsMC4wNiwwLjA5XSxbJ2wnLDAuMDAsNy4zNV0sWydsJywwLjAwLDcuMzJdLFsnbCcsLTAuMDYsMC4wOV0sWydsJywtMC4wOSwwLjA2XSxbJ2wnLC0xLjUzLDAuMDBdLFsnbCcsLTEuNTMsMC4wMF0sWydsJywtMC4wOSwtMC4wNl0sWydsJywtMC4wNiwtMC4wOV0sWydsJywwLjAwLC03LjMyXSxbJ2wnLDAuMDAsLTcuMzVdLFsneiddLFsnbScsNi42MywwLjAwXSxbJ2wnLDAuMDksLTAuMDZdLFsnbCcsMS41MywwLjAwXSxbJ2wnLDEuNTMsMC4wMF0sWydsJywwLjA5LDAuMDZdLFsnbCcsMC4wNiwwLjA5XSxbJ2wnLDAuMDAsNy4zNV0sWydsJywwLjAwLDcuMzJdLFsnbCcsLTAuMDYsMC4wOV0sWydsJywtMC4wOSwwLjA2XSxbJ2wnLC0xLjUzLDAuMDBdLFsnbCcsLTEuNTMsMC4wMF0sWydsJywtMC4wOSwtMC4wNl0sWydsJywtMC4wNiwtMC4wOV0sWydsJywwLjAwLC03LjMyXSxbJ2wnLDAuMDAsLTcuMzVdLFsneiddXSx3OjkuOTksaDoxNC45N30sXG5cdFx0J3RpbWVzaWcuY29tbW9uJzp7ZDpbWydNJyw2LjY2LC03LjgzXSxbJ2MnLDAuNzIsLTAuMDYsMS40MSwtMC4wMywxLjk4LDAuMDldLFsnYycsMS4yMCwwLjI3LDIuMzQsMC45NiwzLjA5LDEuOTJdLFsnYycsMC42MywwLjgxLDEuMDgsMS44NiwxLjE0LDIuNzNdLFsnYycsMC4wNiwxLjAyLC0wLjUxLDEuOTIsLTEuNDQsMi4yMl0sWydjJywtMC4yNCwwLjA5LC0wLjMwLDAuMDksLTAuNjMsMC4wOV0sWydjJywtMC4zMywwLjAwLC0wLjQyLDAuMDAsLTAuNjMsLTAuMDZdLFsnYycsLTAuNjYsLTAuMjQsLTEuMTQsLTAuNjMsLTEuNDEsLTEuMjBdLFsnYycsLTAuMTUsLTAuMzAsLTAuMjEsLTAuNTEsLTAuMjQsLTAuOTBdLFsnYycsLTAuMDYsLTEuMDgsMC41NywtMi4wNCwxLjU2LC0yLjM3XSxbJ2MnLDAuMTgsLTAuMDYsMC4yNywtMC4wNiwwLjYzLC0wLjA2XSxbJ2wnLDAuNDUsMC4wMF0sWydjJywwLjA2LDAuMDMsMC4wOSwwLjAzLDAuMDksMC4wMF0sWydjJywwLjAwLDAuMDAsLTAuMDksLTAuMTIsLTAuMjQsLTAuMjddLFsnYycsLTEuMDIsLTEuMTEsLTIuNTUsLTEuNjgsLTQuMDgsLTEuNTBdLFsnYycsLTEuMjksMC4xNSwtMi4wNCwwLjY5LC0yLjQwLDEuNzRdLFsnYycsLTAuMzYsMC45MywtMC40MiwxLjg5LC0wLjQyLDUuMzddLFsnYycsMC4wMCwyLjk3LDAuMDYsMy45NiwwLjI0LDQuNzddLFsnYycsMC4yNCwxLjA4LDAuNjMsMS42OCwxLjQxLDIuMDddLFsnYycsMC44MSwwLjM5LDIuMTYsMC40NSwzLjE4LDAuMDldLFsnYycsMS4yOSwtMC40NSwyLjM3LC0xLjUzLDMuMDMsLTIuOTddLFsnYycsMC4xNSwtMC4zMywwLjMzLC0wLjg3LDAuMzksLTEuMTddLFsnYycsMC4wOSwtMC4yNCwwLjE1LC0wLjM2LDAuMzAsLTAuMzldLFsnYycsMC4yMSwtMC4wMywwLjQyLDAuMTUsMC4zOSwwLjM2XSxbJ2MnLC0wLjA2LDAuMzksLTAuNDIsMS4zOCwtMC42OSwxLjg5XSxbJ2MnLC0wLjk2LDEuODAsLTIuNDksMi45NCwtNC4yMywzLjE4XSxbJ2MnLC0wLjk5LDAuMTIsLTIuNTgsLTAuMDYsLTMuNjMsLTAuNDVdLFsnYycsLTAuOTYsLTAuMzYsLTEuNzEsLTAuODQsLTIuNDAsLTEuNTBdLFsnYycsLTEuMTEsLTEuMTEsLTEuODAsLTIuNjEsLTIuMDQsLTQuNTZdLFsnYycsLTAuMDYsLTAuNjAsLTAuMDYsLTIuMDEsMC4wMCwtMi42MV0sWydjJywwLjI0LC0xLjk1LDAuOTAsLTMuNDUsMi4wMSwtNC41Nl0sWydjJywwLjY5LC0wLjY2LDEuNDQsLTEuMTEsMi4zNywtMS40N10sWydjJywwLjYzLC0wLjI0LDEuNDcsLTAuNDIsMi4yMiwtMC40OF0sWyd6J11dLHc6MTMuMDM4LGg6MTUuNjg5fSxcblx0XHQndGltZXNpZy5jdXQnOntkOltbJ00nLDYuMjQsLTEwLjQ0XSxbJ2MnLDAuMDksLTAuMDYsMC4wOSwtMC4wNiwwLjQ4LC0wLjA2XSxbJ2MnLDAuMzYsMC4wMCwwLjM2LDAuMDAsMC40NSwwLjA2XSxbJ2wnLDAuMDYsMC4wOV0sWydsJywwLjAwLDEuMjNdLFsnbCcsMC4wMCwxLjI2XSxbJ2wnLDAuMjcsMC4wMF0sWydjJywxLjI2LDAuMDAsMi40OSwwLjQ1LDMuNDgsMS4yOV0sWydjJywxLjA1LDAuODcsMS44MCwyLjI4LDEuODksMy40OF0sWydjJywwLjA2LDEuMDIsLTAuNTEsMS45MiwtMS40NCwyLjIyXSxbJ2MnLC0wLjI0LDAuMDksLTAuMzAsMC4wOSwtMC42MywwLjA5XSxbJ2MnLC0wLjMzLDAuMDAsLTAuNDIsMC4wMCwtMC42MywtMC4wNl0sWydjJywtMC42NiwtMC4yNCwtMS4xNCwtMC42MywtMS40MSwtMS4yMF0sWydjJywtMC4xNSwtMC4zMCwtMC4yMSwtMC41MSwtMC4yNCwtMC45MF0sWydjJywtMC4wNiwtMS4wOCwwLjU3LC0yLjA0LDEuNTYsLTIuMzddLFsnYycsMC4xOCwtMC4wNiwwLjI3LC0wLjA2LDAuNjMsLTAuMDZdLFsnbCcsMC40NSwwLjAwXSxbJ2MnLDAuMDYsMC4wMywwLjA5LDAuMDMsMC4wOSwwLjAwXSxbJ2MnLDAuMDAsLTAuMDMsLTAuNDUsLTAuNTEsLTAuNjYsLTAuNjldLFsnYycsLTAuODcsLTAuNjksLTEuODMsLTEuMDUsLTIuOTQsLTEuMTFdLFsnbCcsLTAuNDIsMC4wMF0sWydsJywwLjAwLDcuMTddLFsnbCcsMC4wMCw3LjE0XSxbJ2wnLDAuNDIsMC4wMF0sWydjJywwLjY5LC0wLjAzLDEuMjMsLTAuMTgsMS44NiwtMC41MV0sWydjJywxLjA1LC0wLjUxLDEuODksLTEuNDcsMi40NiwtMi43MF0sWydjJywwLjE1LC0wLjMzLDAuMzMsLTAuODcsMC4zOSwtMS4xN10sWydjJywwLjA5LC0wLjI0LDAuMTUsLTAuMzYsMC4zMCwtMC4zOV0sWydjJywwLjIxLC0wLjAzLDAuNDIsMC4xNSwwLjM5LDAuMzZdLFsnYycsLTAuMDMsMC4yNCwtMC4yMSwwLjc4LC0wLjM5LDEuMjBdLFsnYycsLTAuOTYsMi4zNywtMi45NCwzLjkwLC01LjEzLDMuOTBdLFsnbCcsLTAuMzAsMC4wMF0sWydsJywwLjAwLDEuMjZdLFsnbCcsMC4wMCwxLjIzXSxbJ2wnLC0wLjA2LDAuMDldLFsnYycsLTAuMDksMC4wNiwtMC4wOSwwLjA2LC0wLjQ1LDAuMDZdLFsnYycsLTAuMzksMC4wMCwtMC4zOSwwLjAwLC0wLjQ4LC0wLjA2XSxbJ2wnLC0wLjA2LC0wLjA5XSxbJ2wnLDAuMDAsLTEuMjldLFsnbCcsMC4wMCwtMS4yOV0sWydsJywtMC4yMSwtMC4wM10sWydjJywtMS4yMywtMC4yMSwtMi4zMSwtMC42MywtMy4yMSwtMS4yOV0sWydjJywtMC4xNSwtMC4wOSwtMC40NSwtMC4zNiwtMC42NiwtMC41N10sWydjJywtMS4xMSwtMS4xMSwtMS44MCwtMi42MSwtMi4wNCwtNC41Nl0sWydjJywtMC4wNiwtMC42MCwtMC4wNiwtMi4wMSwwLjAwLC0yLjYxXSxbJ2MnLDAuMjQsLTEuOTUsMC45MywtMy40NSwyLjA0LC00LjU5XSxbJ2MnLDAuNDIsLTAuMzksMC43OCwtMC42NiwxLjI2LC0wLjkzXSxbJ2MnLDAuNzUsLTAuNDUsMS42NSwtMC43NSwyLjYxLC0wLjkwXSxbJ2wnLDAuMjEsLTAuMDNdLFsnbCcsMC4wMCwtMS4yOV0sWydsJywwLjAwLC0xLjI5XSxbJ3onXSxbJ20nLC0wLjA2LDEwLjQ0XSxbJ2MnLDAuMDAsLTUuNTgsMC4wMCwtNi45OSwtMC4wMywtNi45OV0sWydjJywtMC4xNSwwLjAwLC0wLjYzLDAuMjcsLTAuODcsMC40NV0sWydjJywtMC40NSwwLjM2LC0wLjc1LDAuOTMsLTAuOTMsMS43N10sWydjJywtMC4xOCwwLjgxLC0wLjI0LDEuODAsLTAuMjQsNC43NF0sWydjJywwLjAwLDIuOTcsMC4wNiwzLjk2LDAuMjQsNC43N10sWydjJywwLjI0LDEuMDgsMC42NiwxLjY4LDEuNDEsMi4wN10sWydjJywwLjEyLDAuMDYsMC4zMCwwLjEyLDAuMzMsMC4xNV0sWydsJywwLjA5LDAuMDBdLFsnbCcsMC4wMCwtNi45Nl0sWyd6J11dLHc6MTMuMDM4LGg6MjAuOTd9LFxuXHRcdCd0aW1lc2lnLmltcGVyZmVjdHVtJzp7ZDpbWydNJywxMywtNV0sWydhJyw4LDgsMCwxLDAsMCwxMF1dLHc6MTMuMDM4LGg6MjAuOTd9LFxuXHRcdCd0aW1lc2lnLmltcGVyZmVjdHVtMic6e2Q6W1snTScsMTMsLTVdLFsnYScsOCw4LDAsMSwwLDAsMTBdXSx3OjEzLjAzOCxoOjIwLjk3fSxcblx0XHQndGltZXNpZy5wZXJmZWN0dW0nOntkOltbJ00nLDEzLC01XSxbJ2EnLDgsOCwwLDEsMCwwLDEwXV0sdzoxMy4wMzgsaDoyMC45N30sXG5cdFx0J3RpbWVzaWcucGVyZmVjdHVtMic6e2Q6W1snTScsMTMsLTVdLFsnYScsOCw4LDAsMSwwLDAsMTBdXSx3OjEzLjAzOCxoOjIwLjk3fSxcblx0XHQnZic6e2Q6W1snTScsOS45MywtMTQuMjhdLFsnYycsMS41MywtMC4xOCwyLjg4LDAuNDUsMy4xMiwxLjUwXSxbJ2MnLDAuMTIsMC41MSwwLjAwLDEuMzIsLTAuMjcsMS44Nl0sWydjJywtMC4xNSwwLjMwLC0wLjQyLDAuNTcsLTAuNjMsMC42OV0sWydjJywtMC42OSwwLjM2LC0xLjU2LDAuMDMsLTEuODMsLTAuNjldLFsnYycsLTAuMDksLTAuMjQsLTAuMDksLTAuNjksMC4wMCwtMC44N10sWydjJywwLjA2LC0wLjEyLDAuMjEsLTAuMjQsMC40NSwtMC40Ml0sWydjJywwLjQyLC0wLjI0LDAuNTcsLTAuNDUsMC42MCwtMC43Ml0sWydjJywwLjAzLC0wLjMzLC0wLjA5LC0wLjM5LC0wLjYzLC0wLjQyXSxbJ2MnLC0wLjMwLDAuMDAsLTAuNDUsMC4wMCwtMC42MCwwLjAzXSxbJ2MnLC0wLjgxLDAuMjEsLTEuMzUsMC45MywtMS43NCwyLjQ2XSxbJ2MnLC0wLjA2LDAuMjcsLTAuNDgsMi4yNSwtMC40OCwyLjMxXSxbJ2MnLDAuMDAsMC4wMywwLjM5LDAuMDMsMC45MCwwLjAzXSxbJ2MnLDAuNzIsMC4wMCwwLjkwLDAuMDAsMC45OSwwLjA2XSxbJ2MnLDAuNDIsMC4xNSwwLjQ1LDAuNzIsMC4wMywwLjkwXSxbJ2MnLC0wLjEyLDAuMDYsLTAuMjQsMC4wNiwtMS4xNywwLjA2XSxbJ2wnLC0xLjA1LDAuMDBdLFsnbCcsLTAuNzgsMi41NV0sWydjJywtMC40NSwxLjQxLC0wLjg3LDIuNzksLTAuOTYsMy4wNl0sWydjJywtMC44NywyLjM3LC0yLjM3LDQuNzQsLTMuNzgsNS45MV0sWydjJywtMS4wNSwwLjkwLC0yLjA0LDEuMjMsLTMuMDksMS4wOF0sWydjJywtMS4xMSwtMC4xOCwtMS44OSwtMC43OCwtMi4wNCwtMS41OV0sWydjJywtMC4xMiwtMC42NiwwLjE1LC0xLjcxLDAuNTQsLTIuMTldLFsnYycsMC42OSwtMC43NSwxLjg2LC0wLjU0LDIuMjIsMC4zOV0sWydjJywwLjA2LDAuMTUsMC4wOSwwLjI3LDAuMDksMC40OF0sWydjJywwLjAwLDAuMjQsLTAuMDMsMC4yNywtMC4xMiwwLjQyXSxbJ2MnLC0wLjAzLDAuMDksLTAuMTUsMC4xOCwtMC4yNywwLjI3XSxbJ2MnLC0wLjA5LDAuMDYsLTAuMjcsMC4yMSwtMC4zNiwwLjI3XSxbJ2MnLC0wLjI0LDAuMTgsLTAuMzYsMC4zNiwtMC4zOSwwLjYwXSxbJ2MnLC0wLjAzLDAuMzMsMC4wOSwwLjM5LDAuNjMsMC40Ml0sWydjJywwLjQyLDAuMDAsMC42MywtMC4wMywwLjkwLC0wLjE1XSxbJ2MnLDAuNjAsLTAuMzAsMC45NiwtMC45NiwxLjM4LC0yLjY0XSxbJ2MnLDAuMDksLTAuNDIsMC42MywtMi41NSwxLjE3LC00Ljc3XSxbJ2wnLDEuMDIsLTQuMDhdLFsnYycsMC4wMCwtMC4wMywtMC4zNiwtMC4wMywtMC44MSwtMC4wM10sWydjJywtMC43MiwwLjAwLC0wLjgxLDAuMDAsLTAuOTMsLTAuMDZdLFsnYycsLTAuNDIsLTAuMTgsLTAuMzksLTAuNzUsMC4wMywtMC45MF0sWydjJywwLjA5LC0wLjA2LDAuMjcsLTAuMDYsMS4wNSwtMC4wNl0sWydsJywwLjk2LDAuMDBdLFsnbCcsMC4wMCwtMC4wOV0sWydjJywwLjA2LC0wLjE4LDAuMzAsLTAuNzIsMC41MSwtMS4xN10sWydjJywxLjIwLC0yLjQ2LDMuMzAsLTQuMjMsNS4zNCwtNC41MF0sWyd6J11dLHc6MTYuMTU1LGg6MTkuNDQ1fSxcblx0XHQnbSc6e2Q6W1snTScsMi43OSwtOC45MV0sWydjJywwLjA5LDAuMDAsMC4zMCwtMC4wMywwLjQ1LC0wLjAzXSxbJ2MnLDAuMjQsMC4wMywwLjMwLDAuMDMsMC40NSwwLjEyXSxbJ2MnLDAuMzYsMC4xNSwwLjYzLDAuNTQsMC43NSwxLjAyXSxbJ2wnLDAuMDMsMC4yMV0sWydsJywwLjMzLC0wLjMwXSxbJ2MnLDAuNjksLTAuNjksMS4zOCwtMS4wMiwyLjA3LC0xLjAyXSxbJ2MnLDAuMjcsMC4wMCwwLjMzLDAuMDAsMC40OCwwLjA2XSxbJ2MnLDAuMjEsMC4wOSwwLjQ4LDAuMzYsMC42MywwLjYwXSxbJ2MnLDAuMDMsMC4wOSwwLjEyLDAuMjcsMC4xOCwwLjQyXSxbJ2MnLDAuMDMsMC4xNSwwLjA5LDAuMjcsMC4xMiwwLjI3XSxbJ2MnLDAuMDAsMC4wMCwwLjA5LC0wLjA5LDAuMTgsLTAuMjFdLFsnYycsMC4zMywtMC4zOSwwLjg3LC0wLjgxLDEuMjksLTAuOTldLFsnYycsMC43OCwtMC4zMywxLjQ3LC0wLjIxLDIuMDEsMC4zM10sWydjJywwLjMwLDAuMzMsMC40OCwwLjY5LDAuNjAsMS4xNF0sWydjJywwLjA5LDAuNDIsMC4wNiwwLjU0LC0wLjU0LDMuMDZdLFsnYycsLTAuMzMsMS4yOSwtMC41NywyLjQwLC0wLjU3LDIuNDNdLFsnYycsMC4wMCwwLjEyLDAuMDksMC4yMSwwLjIxLDAuMjFdLFsnYycsMC4yNCwwLjAwLDAuNzUsLTAuMzAsMS4yMCwtMC43Ml0sWydjJywwLjQ1LC0wLjM5LDAuNjAsLTAuNDUsMC43OCwtMC4yN10sWydjJywwLjE4LDAuMTgsMC4wOSwwLjM2LC0wLjQ1LDAuODddLFsnYycsLTEuMDUsMC45NiwtMS44MywxLjQ3LC0yLjU4LDEuNzFdLFsnYycsLTAuOTMsMC4zMywtMS41MywwLjIxLC0xLjgwLC0wLjMzXSxbJ2MnLC0wLjA2LC0wLjE1LC0wLjA2LC0wLjIxLC0wLjA2LC0wLjQ1XSxbJ2MnLDAuMDAsLTAuMjQsMC4wMywtMC40OCwwLjYwLC0yLjgyXSxbJ2MnLDAuNDIsLTEuNzEsMC42MCwtMi42NCwwLjYzLC0yLjc5XSxbJ2MnLDAuMDMsLTAuNTcsLTAuMzAsLTAuNzUsLTAuODQsLTAuNDhdLFsnYycsLTAuMjQsMC4xMiwtMC41NCwwLjM5LC0wLjY2LDAuNjNdLFsnYycsLTAuMDMsMC4wOSwtMC40MiwxLjM4LC0wLjkwLDMuMDBdLFsnYycsLTAuOTAsMy4xNSwtMC44NCwzLjAwLC0xLjE0LDMuMTVdLFsnbCcsLTAuMTUsMC4wOV0sWydsJywtMC43OCwwLjAwXSxbJ2MnLC0wLjYwLDAuMDAsLTAuNzgsMC4wMCwtMC44NCwtMC4wNl0sWydjJywtMC4wOSwtMC4wMywtMC4xOCwtMC4xOCwtMC4xOCwtMC4yN10sWydjJywwLjAwLC0wLjAzLDAuMzYsLTEuMzgsMC44NCwtMi45N10sWydjJywwLjU3LC0yLjA0LDAuODEsLTIuOTcsMC44NCwtMy4xMl0sWydjJywwLjAzLC0wLjU0LC0wLjMwLC0wLjcyLC0wLjg0LC0wLjQ1XSxbJ2MnLC0wLjI0LDAuMTIsLTAuNTcsMC40MiwtMC42NiwwLjYzXSxbJ2MnLC0wLjA2LDAuMDksLTAuNTEsMS40NCwtMS4wNSwyLjk3XSxbJ2MnLC0wLjUxLDEuNTYsLTAuOTksMi44NSwtMC45OSwyLjkxXSxbJ2MnLC0wLjA2LDAuMTIsLTAuMjEsMC4yNCwtMC4zNiwwLjMwXSxbJ2MnLC0wLjEyLDAuMDYsLTAuMjEsMC4wNiwtMC45MCwwLjA2XSxbJ2MnLC0wLjYwLDAuMDAsLTAuNzgsMC4wMCwtMC44NCwtMC4wNl0sWydjJywtMC4wOSwtMC4wMywtMC4xOCwtMC4xOCwtMC4xOCwtMC4yN10sWydjJywwLjAwLC0wLjAzLDAuNDUsLTEuMzgsMC45OSwtMi45N10sWydjJywxLjA1LC0zLjE4LDEuMDUsLTMuMTgsMC45MywtMy40NV0sWydjJywtMC4xMiwtMC4yNywtMC4zOSwtMC4zMCwtMC43MiwtMC4xNV0sWydjJywtMC41NCwwLjI3LC0xLjE0LDEuMTcsLTEuNTYsMi40MF0sWydjJywtMC4wNiwwLjE1LC0wLjE1LDAuMzAsLTAuMTgsMC4zNl0sWydjJywtMC4yMSwwLjIxLC0wLjU3LDAuMjcsLTAuNzIsMC4wOV0sWydjJywtMC4wOSwtMC4wOSwtMC4wNiwtMC4yMSwwLjA2LC0wLjYzXSxbJ2MnLDAuNDgsLTEuMjYsMS4yNiwtMi40NiwyLjAxLC0zLjIxXSxbJ2MnLDAuNTcsLTAuNTQsMS4yMCwtMC44NywxLjgzLC0xLjAyXSxbJ3onXV0sdzoxNC42ODcsaDo5LjEyNn0sXG5cdFx0J3AnOntkOltbJ00nLDEuOTIsLTguNzBdLFsnYycsMC4yNywtMC4wOSwwLjgxLC0wLjA2LDEuMTEsMC4wM10sWydjJywwLjU0LDAuMTgsMC45MywwLjUxLDEuMTcsMC45OV0sWydjJywwLjA5LDAuMTUsMC4xNSwwLjMzLDAuMTgsMC4zNl0sWydsJywwLjAwLDAuMTJdLFsnbCcsMC4zMCwtMC4yN10sWydjJywwLjY2LC0wLjYwLDEuMzUsLTEuMDIsMi4xMywtMS4yMF0sWydjJywwLjIxLC0wLjA2LDAuMzMsLTAuMDYsMC43OCwtMC4wNl0sWydjJywwLjQ1LDAuMDAsMC41MSwwLjAwLDAuODQsMC4wOV0sWydjJywxLjI5LDAuMzMsMi4wNywxLjMyLDIuMjUsMi43OV0sWydjJywwLjA5LDAuODEsLTAuMDksMi4wMSwtMC40NSwyLjc5XSxbJ2MnLC0wLjU0LDEuMjYsLTEuODYsMi41NSwtMy4xOCwzLjAzXSxbJ2MnLC0wLjQ1LDAuMTgsLTAuODEsMC4yNCwtMS4yOSwwLjI0XSxbJ2MnLC0wLjY5LC0wLjAzLC0xLjM1LC0wLjE4LC0xLjg2LC0wLjQ1XSxbJ2MnLC0wLjMwLC0wLjE1LC0wLjUxLC0wLjE4LC0wLjY5LC0wLjA5XSxbJ2MnLC0wLjA5LDAuMDMsLTAuMTgsMC4wOSwtMC4xOCwwLjEyXSxbJ2MnLC0wLjA5LDAuMTIsLTEuMDUsMi45NCwtMS4wNSwzLjA2XSxbJ2MnLDAuMDAsMC4yNCwwLjE4LDAuNDgsMC41MSwwLjYzXSxbJ2MnLDAuMTgsMC4wNiwwLjU0LDAuMTUsMC43NSwwLjE1XSxbJ2MnLDAuMjEsMC4wMCwwLjM2LDAuMDYsMC40MiwwLjE4XSxbJ2MnLDAuMTIsMC4xOCwwLjA2LDAuNDIsLTAuMTIsMC41NF0sWydjJywtMC4wOSwwLjAzLC0wLjE1LDAuMDMsLTAuNzgsMC4wMF0sWydjJywtMS45OCwtMC4xNSwtMy44MSwtMC4xNSwtNS43OSwwLjAwXSxbJ2MnLC0wLjYzLDAuMDMsLTAuNjksMC4wMywtMC43OCwwLjAwXSxbJ2MnLC0wLjI0LC0wLjE1LC0wLjI0LC0wLjU3LDAuMDMsLTAuNjZdLFsnYycsMC4wNiwtMC4wMywwLjQ4LC0wLjA5LDAuOTksLTAuMTJdLFsnYycsMC44NywtMC4wNiwxLjExLC0wLjA5LDEuMzUsLTAuMjFdLFsnYycsMC4xOCwtMC4wNiwwLjMzLC0wLjE4LDAuMzksLTAuMzBdLFsnYycsMC4wNiwtMC4xMiwzLjI0LC05LjQyLDMuMjcsLTkuNjBdLFsnYycsMC4wNiwtMC4zMywwLjAzLC0wLjU3LC0wLjE1LC0wLjY5XSxbJ2MnLC0wLjA5LC0wLjA2LC0wLjEyLC0wLjA2LC0wLjMwLC0wLjA2XSxbJ2MnLC0wLjY5LDAuMDYsLTEuNTMsMS4wMiwtMi4yOCwyLjYxXSxbJ2MnLC0wLjA5LDAuMjEsLTAuMjEsMC40NSwtMC4yNywwLjUxXSxbJ2MnLC0wLjA5LDAuMTIsLTAuMzMsMC4yNCwtMC40OCwwLjI0XSxbJ2MnLC0wLjE4LDAuMDAsLTAuMzYsLTAuMTUsLTAuMzYsLTAuMzBdLFsnYycsMC4wMCwtMC4yNCwwLjc4LC0xLjgzLDEuMjYsLTIuNTVdLFsnYycsMC43MiwtMS4xMSwxLjQ3LC0xLjc0LDIuMjgsLTEuOTJdLFsneiddLFsnbScsNS4zNywxLjQ3XSxbJ2MnLC0wLjI3LC0wLjEyLC0wLjc1LC0wLjAzLC0xLjE0LDAuMjFdLFsnYycsLTAuNzUsMC40OCwtMS40NywxLjY4LC0xLjg5LDMuMTVdLFsnYycsLTAuNDUsMS40NywtMC40MiwyLjM0LDAuMDAsMi43MF0sWydjJywwLjQ1LDAuMzksMS4yNiwwLjIxLDEuODMsLTAuMzZdLFsnYycsMC41MSwtMC41MSwwLjk5LC0xLjY4LDEuMzgsLTMuMjddLFsnYycsMC4zMCwtMS4xNywwLjMzLC0xLjc0LDAuMTUsLTIuMTNdLFsnYycsLTAuMDksLTAuMTUsLTAuMTUsLTAuMjEsLTAuMzMsLTAuMzBdLFsneiddXSx3OjE0LjY4OSxoOjEzLjEyN30sXG5cdFx0J3InOntkOltbJ00nLDYuMzMsLTkuMTJdLFsnYycsMC4yNywtMC4wMywwLjkzLDAuMDAsMS4yMCwwLjA2XSxbJ2MnLDAuODQsMC4yMSwxLjIzLDAuODEsMS4wMiwxLjUzXSxbJ2MnLC0wLjI0LDAuNzUsLTAuOTAsMS4xNywtMS41NiwwLjk2XSxbJ2MnLC0wLjMzLC0wLjA5LC0wLjUxLC0wLjMwLC0wLjY2LC0wLjc1XSxbJ2MnLC0wLjAzLC0wLjEyLC0wLjA5LC0wLjI0LC0wLjEyLC0wLjMwXSxbJ2MnLC0wLjA5LC0wLjE1LC0wLjMwLC0wLjI0LC0wLjQ4LC0wLjI0XSxbJ2MnLC0wLjU3LDAuMDAsLTEuMzgsMC41NCwtMS42NSwxLjA4XSxbJ2MnLC0wLjA2LDAuMTUsLTAuMzMsMS4xNywtMC45MCwzLjI3XSxbJ2MnLC0wLjU3LDIuMzEsLTAuODEsMy4xMiwtMC44NywzLjIxXSxbJ2MnLC0wLjAzLDAuMDYsLTAuMTIsMC4xNSwtMC4xOCwwLjIxXSxbJ2wnLC0wLjEyLDAuMDZdLFsnbCcsLTAuODEsMC4wM10sWydjJywtMC42OSwwLjAwLC0wLjgxLDAuMDAsLTAuOTAsLTAuMDNdLFsnYycsLTAuMDksLTAuMDYsLTAuMTgsLTAuMjEsLTAuMTgsLTAuMzBdLFsnYycsMC4wMCwtMC4wNiwwLjM5LC0xLjYyLDAuOTAsLTMuNTFdLFsnYycsMC44NCwtMy4yNCwwLjg3LC0zLjQ1LDAuODcsLTMuNzJdLFsnYycsMC4wMCwtMC4yMSwwLjAwLC0wLjI3LC0wLjAzLC0wLjM2XSxbJ2MnLC0wLjEyLC0wLjE1LC0wLjIxLC0wLjI0LC0wLjQyLC0wLjI0XSxbJ2MnLC0wLjI0LDAuMDAsLTAuNDUsMC4xNSwtMC43OCwwLjQyXSxbJ2MnLC0wLjMzLDAuMzYsLTAuNDUsMC41NCwtMC43MiwxLjE0XSxbJ2MnLC0wLjAzLDAuMTIsLTAuMjEsMC4yNCwtMC4zNiwwLjI3XSxbJ2MnLC0wLjEyLDAuMDAsLTAuMTUsMC4wMCwtMC4yNCwtMC4wNl0sWydjJywtMC4xOCwtMC4xMiwtMC4xOCwtMC4yMSwtMC4wNiwtMC41NF0sWydjJywwLjIxLC0wLjU3LDAuNDIsLTAuOTMsMC43OCwtMS4zMl0sWydjJywwLjU0LC0wLjUxLDEuMjAsLTAuODEsMS45NSwtMC44N10sWydjJywwLjgxLC0wLjAzLDEuNTMsMC4zMCwxLjkyLDAuODddLFsnbCcsMC4xMiwwLjE4XSxbJ2wnLDAuMDksLTAuMDldLFsnYycsMC41NywtMC40NSwxLjQxLC0wLjg0LDIuMTksLTAuOTZdLFsneiddXSx3OjkuNDEsaDo5LjEzMn0sXG5cdFx0J3MnOntkOltbJ00nLDQuNDcsLTguNzNdLFsnYycsMC4wOSwwLjAwLDAuMzYsLTAuMDMsMC41NywtMC4wM10sWydjJywwLjc1LDAuMDMsMS4yOSwwLjI0LDEuNzEsMC42M10sWydjJywwLjUxLDAuNTQsMC42NiwxLjI2LDAuMzYsMS44M10sWydjJywtMC4yNCwwLjQyLC0wLjYzLDAuNTcsLTEuMTEsMC40Ml0sWydjJywtMC4zMywtMC4wOSwtMC42MCwtMC4zNiwtMC42MCwtMC41N10sWydjJywwLjAwLC0wLjAzLDAuMDYsLTAuMjEsMC4xNSwtMC4zOV0sWydjJywwLjEyLC0wLjIxLDAuMTUsLTAuMzMsMC4xOCwtMC40OF0sWydjJywwLjAwLC0wLjI0LC0wLjA2LC0wLjQ4LC0wLjE1LC0wLjYwXSxbJ2MnLC0wLjE1LC0wLjIxLC0wLjQyLC0wLjI0LC0wLjc1LC0wLjE1XSxbJ2MnLC0wLjI3LDAuMDYsLTAuNDgsMC4xOCwtMC42OSwwLjM2XSxbJ2MnLC0wLjM5LDAuMzksLTAuNTEsMC45NiwtMC4zMywxLjM4XSxbJ2MnLDAuMDksMC4yMSwwLjQyLDAuNTEsMC43OCwwLjcyXSxbJ2MnLDEuMTEsMC42OSwxLjU5LDEuMTEsMS44OSwxLjY4XSxbJ2MnLDAuMjEsMC4zOSwwLjI0LDAuNzgsMC4xNSwxLjI5XSxbJ2MnLC0wLjE4LDEuMjAsLTEuMTcsMi4xNiwtMi41MiwyLjUyXSxbJ2MnLC0xLjAyLDAuMjQsLTEuOTUsMC4xMiwtMi43MCwtMC40Ml0sWydjJywtMC43MiwtMC41MSwtMC45OSwtMS40NywtMC42MCwtMi4xOV0sWydjJywwLjI0LC0wLjQ4LDAuNzIsLTAuNjMsMS4xNywtMC40Ml0sWydjJywwLjMzLDAuMTgsMC41NCwwLjQ1LDAuNTcsMC44MV0sWydjJywwLjAwLDAuMjEsLTAuMDMsMC4zMCwtMC4zMywwLjUxXSxbJ2MnLC0wLjMzLDAuMjQsLTAuMzksMC40MiwtMC4yNywwLjY5XSxbJ2MnLDAuMDYsMC4xNSwwLjIxLDAuMjcsMC40NSwwLjMzXSxbJ2MnLDAuMzAsMC4wOSwwLjg3LDAuMDksMS4yMCwwLjAwXSxbJ2MnLDAuNzUsLTAuMjEsMS4yMywtMC43MiwxLjI5LC0xLjM1XSxbJ2MnLDAuMDMsLTAuNDIsLTAuMTUsLTAuODEsLTAuNTQsLTEuMjBdLFsnYycsLTAuMjQsLTAuMjQsLTAuNDgsLTAuNDIsLTEuNDEsLTEuMDJdLFsnYycsLTAuNjksLTAuNDIsLTEuMDUsLTAuOTMsLTEuMDUsLTEuNDddLFsnYycsMC4wMCwtMC4zOSwwLjEyLC0wLjg3LDAuMzAsLTEuMjNdLFsnYycsMC4yNywtMC41NywwLjc4LC0xLjA1LDEuMzgsLTEuMzVdLFsnYycsMC4yNCwtMC4xMiwwLjYzLC0wLjI3LDAuOTAsLTAuMzBdLFsneiddXSx3OjYuNjMyLGg6OC43NTh9LFxuXHRcdCd6Jzp7ZDpbWydNJywyLjY0LC03Ljk1XSxbJ2MnLDAuMzYsLTAuMDksMC44MSwtMC4wMywxLjcxLDAuMjddLFsnYycsMC43OCwwLjIxLDAuOTYsMC4yNywxLjc0LDAuMzBdLFsnYycsMC44NywwLjA2LDEuMDIsMC4wMywxLjM4LC0wLjIxXSxbJ2MnLDAuMjEsLTAuMTUsMC4zMywtMC4xNSwwLjQ4LC0wLjA2XSxbJ2MnLDAuMTUsMC4wOSwwLjIxLDAuMzAsMC4xNSwwLjQ1XSxbJ2MnLC0wLjAzLDAuMDYsLTEuMjYsMS4yNiwtMi43NiwyLjY3XSxbJ2wnLC0yLjczLDIuNTVdLFsnbCcsMC41NCwwLjAzXSxbJ2MnLDAuNTQsMC4wMywwLjcyLDAuMDMsMi4wMSwwLjE1XSxbJ2MnLDAuMzYsMC4wMywwLjkwLDAuMDYsMS4yMCwwLjA5XSxbJ2MnLDAuNjYsMC4wMCwwLjgxLC0wLjAzLDEuMDIsLTAuMjRdLFsnYycsMC4zMCwtMC4zMCwwLjM5LC0wLjcyLDAuMjcsLTEuMjNdLFsnYycsLTAuMDYsLTAuMjcsLTAuMDYsLTAuMjcsLTAuMDMsLTAuMzldLFsnYycsMC4xNSwtMC4zMCwwLjU0LC0wLjI3LDAuNjksMC4wM10sWydjJywwLjE1LDAuMzMsMC4yNywxLjAyLDAuMjcsMS41MF0sWydjJywwLjAwLDEuNDcsLTEuMTEsMi43MCwtMi41MiwyLjc5XSxbJ2MnLC0wLjU3LDAuMDMsLTEuMDIsLTAuMDksLTIuMDEsLTAuNTFdLFsnYycsLTEuMDIsLTAuNDIsLTEuMjMsLTAuNDgsLTIuMTMsLTAuNTRdLFsnYycsLTAuODEsLTAuMDYsLTAuOTYsLTAuMDMsLTEuMjYsMC4xOF0sWydjJywtMC4xMiwwLjA2LC0wLjI0LDAuMTIsLTAuMjcsMC4xMl0sWydjJywtMC4yNywwLjAwLC0wLjQ1LC0wLjMwLC0wLjM2LC0wLjUxXSxbJ2MnLDAuMDMsLTAuMDYsMS4zMiwtMS4zMiwyLjkxLC0yLjc5XSxbJ2wnLDIuODgsLTIuNzNdLFsnYycsLTAuMDMsMC4wMCwtMC4yMSwwLjAzLC0wLjQyLDAuMDZdLFsnYycsLTAuMjEsMC4wMywtMC43OCwwLjA5LC0xLjIzLDAuMTJdLFsnYycsLTEuMTEsMC4xMiwtMS4yMywwLjE1LC0xLjk1LDAuMjddLFsnYycsLTAuNzIsMC4xNSwtMS4xNywwLjE4LC0xLjI5LDAuMDldLFsnYycsLTAuMjcsLTAuMTgsLTAuMjEsLTAuNzUsMC4xMiwtMS4yNl0sWydjJywwLjM5LC0wLjYwLDAuOTMsLTEuMDIsMS41OSwtMS4yMF0sWyd6J11dLHc6OC41NzMsaDo4Ljc0M30sXG5cdFx0JysnOntkOltbJ00nLDMuNDgsLTkuM10sWydjJywwLjE4LC0wLjA5LDAuMzYsLTAuMDksMC41NCwwLjAwXSxbJ2MnLDAuMTgsMC4wOSwwLjI0LDAuMTUsMC4zMywwLjMwXSxbJ2wnLDAuMDYsMC4xNV0sWydsJywwLjAwLDEuMjldLFsnbCcsMC4wMCwxLjI5XSxbJ2wnLDEuMjksMC4wMF0sWydjJywxLjIzLDAuMDAsMS4yOSwwLjAwLDEuNDEsMC4wNl0sWydjJywwLjA2LDAuMDMsMC4xNSwwLjA5LDAuMTgsMC4xMl0sWydjJywwLjEyLDAuMDksMC4yMSwwLjMzLDAuMjEsMC40OF0sWydjJywwLjAwLDAuMTUsLTAuMDksMC4zOSwtMC4yMSwwLjQ4XSxbJ2MnLC0wLjAzLDAuMDMsLTAuMTIsMC4wOSwtMC4xOCwwLjEyXSxbJ2MnLC0wLjEyLDAuMDYsLTAuMTgsMC4wNiwtMS40MSwwLjA2XSxbJ2wnLC0xLjI5LDAuMDBdLFsnbCcsMC4wMCwxLjI5XSxbJ2MnLDAuMDAsMS4yMywwLjAwLDEuMjksLTAuMDYsMS40MV0sWydjJywtMC4wOSwwLjE4LC0wLjE1LDAuMjQsLTAuMzAsMC4zM10sWydjJywtMC4yMSwwLjA5LC0wLjM5LDAuMDksLTAuNTcsMC4wMF0sWydjJywtMC4xOCwtMC4wOSwtMC4yNCwtMC4xNSwtMC4zMywtMC4zM10sWydjJywtMC4wNiwtMC4xMiwtMC4wNiwtMC4xOCwtMC4wNiwtMS40MV0sWydsJywwLjAwLC0xLjI5XSxbJ2wnLC0xLjI5LDAuMDBdLFsnYycsLTEuMjMsMC4wMCwtMS4yOSwwLjAwLC0xLjQxLC0wLjA2XSxbJ2MnLC0wLjE4LC0wLjA5LC0wLjI0LC0wLjE1LC0wLjMzLC0wLjMzXSxbJ2MnLC0wLjA5LC0wLjE4LC0wLjA5LC0wLjM2LDAuMDAsLTAuNTRdLFsnYycsMC4wOSwtMC4xOCwwLjE1LC0wLjI0LDAuMzMsLTAuMzNdLFsnbCcsMC4xNSwtMC4wNl0sWydsJywxLjI2LDAuMDBdLFsnbCcsMS4yOSwwLjAwXSxbJ2wnLDAuMDAsLTEuMjldLFsnYycsMC4wMCwtMS4yMywwLjAwLC0xLjI5LDAuMDYsLTEuNDFdLFsnYycsMC4wOSwtMC4xOCwwLjE1LC0wLjI0LDAuMzMsLTAuMzNdLFsneiddXSx3OjcuNTA3LGg6Ny41MTV9LFxuXHRcdCcsJzp7ZDpbWydNJywxLjMyLC0zLjM2XSxbJ2MnLDAuNTcsLTAuMTUsMS4xNywwLjAzLDEuNTksMC40NV0sWydjJywwLjQ1LDAuNDUsMC42MCwwLjk2LDAuNTEsMS44OV0sWydjJywtMC4wOSwxLjIzLC0wLjQyLDIuNDYsLTAuOTksMy45M10sWydjJywtMC4zMCwwLjcyLC0wLjcyLDEuNjIsLTAuNzgsMS42OF0sWydjJywtMC4xOCwwLjIxLC0wLjUxLDAuMTgsLTAuNjYsLTAuMDZdLFsnYycsLTAuMDMsLTAuMDYsLTAuMDYsLTAuMTUsLTAuMDYsLTAuMThdLFsnYycsMC4wMCwtMC4wNiwwLjEyLC0wLjMzLDAuMjQsLTAuNjNdLFsnYycsMC44NCwtMS44MCwxLjAyLC0yLjYxLDAuNjksLTMuMjRdLFsnYycsLTAuMTIsLTAuMjQsLTAuMjcsLTAuMzYsLTAuNzUsLTAuNjBdLFsnYycsLTAuMzYsLTAuMTUsLTAuNDIsLTAuMjEsLTAuNjAsLTAuMzldLFsnYycsLTAuNjksLTAuNjksLTAuNjksLTEuNzEsMC4wMCwtMi40MF0sWydjJywwLjIxLC0wLjIxLDAuNTEsLTAuMzksMC44MSwtMC40NV0sWyd6J11dLHc6My40NTIsaDo4LjE0M30sXG5cdFx0Jy0nOntkOltbJ00nLDAuMTgsLTUuMzRdLFsnYycsMC4wOSwtMC4wNiwwLjE1LC0wLjA2LDIuMzEsLTAuMDZdLFsnYycsMi40NiwwLjAwLDIuMzcsMC4wMCwyLjQ2LDAuMjFdLFsnYycsMC4xMiwwLjIxLDAuMDMsMC40MiwtMC4xNSwwLjU0XSxbJ2MnLC0wLjA5LDAuMDYsLTAuMTUsMC4wNiwtMi4yOCwwLjA2XSxbJ2MnLC0yLjE2LDAuMDAsLTIuMjIsMC4wMCwtMi4zMSwtMC4wNl0sWydjJywtMC4yNywtMC4xNSwtMC4yNywtMC41NCwtMC4wMywtMC42OV0sWyd6J11dLHc6NS4wMDEsaDowLjgxfSxcblx0XHQnLic6e2Q6W1snTScsMS4zMiwtMy4zNl0sWydjJywxLjA1LC0wLjI3LDIuMTAsMC41NywyLjEwLDEuNjVdLFsnYycsMC4wMCwxLjA4LC0xLjA1LDEuOTIsLTIuMTAsMS42NV0sWydjJywtMC45MCwtMC4yMSwtMS41MCwtMS4xNCwtMS4yNiwtMi4wNF0sWydjJywwLjEyLC0wLjYzLDAuNjMsLTEuMTEsMS4yNiwtMS4yNl0sWyd6J11dLHc6My40MTMsaDozLjQwMn0sXG5cdFx0J3NjcmlwdHMud2VkZ2UnOntkOltbJ00nLC0zLjY2LC03LjQ0XSxbJ2MnLDAuMDYsLTAuMDksMC4wMCwtMC4wOSwwLjgxLDAuMDNdLFsnYycsMS44NiwwLjMwLDMuODQsMC4zMCw1LjczLDAuMDBdLFsnYycsMC43OCwtMC4xMiwwLjcyLC0wLjEyLDAuNzgsLTAuMDNdLFsnYycsMC4xNSwwLjE1LDAuMTIsMC4yNCwtMC4yNCwwLjYwXSxbJ2MnLC0wLjkzLDAuOTMsLTEuOTgsMi43NiwtMi42Nyw0LjYyXSxbJ2MnLC0wLjMwLDAuNzgsLTAuNTEsMS43MSwtMC41MSwyLjEzXSxbJ2MnLDAuMDAsMC4xNSwwLjAwLDAuMTgsLTAuMDYsMC4yN10sWydjJywtMC4xMiwwLjA5LC0wLjI0LDAuMDksLTAuMzYsMC4wMF0sWydjJywtMC4wNiwtMC4wOSwtMC4wNiwtMC4xMiwtMC4wNiwtMC4yN10sWydjJywwLjAwLC0wLjQyLC0wLjIxLC0xLjM1LC0wLjUxLC0yLjEzXSxbJ2MnLC0wLjY5LC0xLjg2LC0xLjc0LC0zLjY5LC0yLjY3LC00LjYyXSxbJ2MnLC0wLjM2LC0wLjM2LC0wLjM5LC0wLjQ1LC0wLjI0LC0wLjYwXSxbJ3onXV0sdzo3LjQ5LGg6Ny43NTJ9LFxuXHRcdCdzY3JpcHRzLnRodW1iJzp7ZDpbWydNJywtMC41NCwtMy42OV0sWydjJywwLjE1LC0wLjAzLDAuMzYsLTAuMDYsMC41MSwtMC4wNl0sWydjJywxLjQ0LDAuMDAsMi41OCwxLjExLDIuOTQsMi44NV0sWydjJywwLjA5LDAuNDgsMC4wOSwxLjMyLDAuMDAsMS44MF0sWydjJywtMC4yNywxLjQxLC0xLjA4LDIuNDMsLTIuMTYsMi43M10sWydsJywtMC4xOCwwLjA2XSxbJ2wnLDAuMDAsMC4xMl0sWydjJywwLjAzLDAuMDYsMC4wNiwwLjQ1LDAuMDksMC44N10sWydjJywwLjAzLDAuNTcsMC4wMywwLjc4LDAuMDAsMC44NF0sWydjJywtMC4wOSwwLjI3LC0wLjM5LDAuNDgsLTAuNjYsMC40OF0sWydjJywtMC4yNywwLjAwLC0wLjU3LC0wLjIxLC0wLjY2LC0wLjQ4XSxbJ2MnLC0wLjAzLC0wLjA2LC0wLjAzLC0wLjI3LDAuMDAsLTAuODRdLFsnYycsMC4wMywtMC40MiwwLjA2LC0wLjgxLDAuMDksLTAuODddLFsnbCcsMC4wMCwtMC4xMl0sWydsJywtMC4xOCwtMC4wNl0sWydjJywtMS4wOCwtMC4zMCwtMS44OSwtMS4zMiwtMi4xNiwtMi43M10sWydjJywtMC4wOSwtMC40OCwtMC4wOSwtMS4zMiwwLjAwLC0xLjgwXSxbJ2MnLDAuMTUsLTAuODQsMC41MSwtMS41MywxLjAyLC0yLjA0XSxbJ2MnLDAuMzksLTAuMzksMC44NCwtMC42MywxLjM1LC0wLjc1XSxbJ3onXSxbJ20nLDEuMDUsMC45MF0sWydjJywtMC4xNSwtMC4wOSwtMC4yMSwtMC4wOSwtMC40NSwtMC4xMl0sWydjJywtMC4xNSwwLjAwLC0wLjMwLDAuMDMsLTAuMzksMC4wM10sWydjJywtMC41NywwLjE4LC0wLjkwLDAuNzIsLTEuMDgsMS43NF0sWydjJywtMC4wNiwwLjQ4LC0wLjA2LDEuODAsMC4wMCwyLjI4XSxbJ2MnLDAuMTUsMC45MCwwLjQyLDEuNDQsMC45MCwxLjY1XSxbJ2MnLDAuMTgsMC4wOSwwLjIxLDAuMDksMC41MSwwLjA5XSxbJ2MnLDAuMzAsMC4wMCwwLjMzLDAuMDAsMC41MSwtMC4wOV0sWydjJywwLjQ4LC0wLjIxLDAuNzUsLTAuNzUsMC45MCwtMS42NV0sWydjJywwLjAzLC0wLjI3LDAuMDMsLTAuNTQsMC4wMywtMS4xNF0sWydjJywwLjAwLC0wLjYwLDAuMDAsLTAuODcsLTAuMDMsLTEuMTRdLFsnYycsLTAuMTUsLTAuOTAsLTAuNDUsLTEuNDQsLTAuOTAsLTEuNjVdLFsneiddXSx3OjUuOTU1LGg6OS43NX0sXG5cdFx0J3NjcmlwdHMub3Blbic6e2Q6W1snTScsLTAuNTQsLTMuNjldLFsnYycsMC4xNSwtMC4wMywwLjM2LC0wLjA2LDAuNTEsLTAuMDZdLFsnYycsMS40NCwwLjAwLDIuNTgsMS4xMSwyLjk0LDIuODVdLFsnYycsMC4wOSwwLjQ4LDAuMDksMS4zMiwwLjAwLDEuODBdLFsnYycsLTAuMzMsMS43NCwtMS40NywyLjg1LC0yLjkxLDIuODVdLFsnYycsLTEuNDQsMC4wMCwtMi41OCwtMS4xMSwtMi45MSwtMi44NV0sWydjJywtMC4wOSwtMC40OCwtMC4wOSwtMS4zMiwwLjAwLC0xLjgwXSxbJ2MnLDAuMTUsLTAuODQsMC41MSwtMS41MywxLjAyLC0yLjA0XSxbJ2MnLDAuMzksLTAuMzksMC44NCwtMC42MywxLjM1LC0wLjc1XSxbJ3onXSxbJ20nLDEuMTEsMC45MF0sWydjJywtMC4yMSwtMC4wOSwtMC4yNywtMC4wOSwtMC41MSwtMC4xMl0sWydjJywtMC4zMCwwLjAwLC0wLjQyLDAuMDMsLTAuNjYsMC4xNV0sWydjJywtMC4yNCwwLjEyLC0wLjUxLDAuMzksLTAuNjYsMC42M10sWydjJywtMC41NCwwLjkzLC0wLjYzLDIuNjQsLTAuMjEsMy44MV0sWydjJywwLjIxLDAuNTQsMC41MSwwLjkwLDAuOTMsMS4xMV0sWydjJywwLjIxLDAuMDksMC4yNCwwLjA5LDAuNTQsMC4wOV0sWydjJywwLjMwLDAuMDAsMC4zMywwLjAwLDAuNTQsLTAuMDldLFsnYycsMC40MiwtMC4yMSwwLjcyLC0wLjU3LDAuOTMsLTEuMTFdLFsnYycsMC4zNiwtMC45OSwwLjM2LC0yLjM3LDAuMDAsLTMuMzZdLFsnYycsLTAuMjEsLTAuNTQsLTAuNTEsLTAuOTAsLTAuOTAsLTEuMTFdLFsneiddXSx3OjUuOTU1LGg6Ny41fSxcblx0XHQnc2NyaXB0cy5sb25ncGhyYXNlJzp7ZDpbWydNJywxLjQ3LC0xNS4wOV0sWydjJywwLjM2LC0wLjA5LDAuNjYsLTAuMTgsMC42OSwtMC4xOF0sWydjJywwLjA2LDAuMDAsMC4wNiwwLjU0LDAuMDYsMTEuMjVdLFsnbCcsMC4wMCwxMS4yNV0sWydsJywtMC42MywwLjE1XSxbJ2MnLC0wLjY2LDAuMTgsLTEuNDQsMC4zOSwtMS41MCwwLjM5XSxbJ2MnLC0wLjAzLDAuMDAsLTAuMDMsLTMuMzksLTAuMDMsLTExLjI1XSxbJ2wnLDAuMDAsLTExLjI1XSxbJ2wnLDAuMzYsLTAuMDldLFsnYycsMC4yMSwtMC4wNiwwLjY2LC0wLjE4LDEuMDUsLTAuMjddLFsneiddXSx3OjIuMTYsaDoyMy4wNH0sXG5cdFx0J3NjcmlwdHMubWVkaXVtcGhyYXNlJzp7ZDpbWydNJywxLjQ3LC03LjU5XSxbJ2MnLDAuMzYsLTAuMDksMC42NiwtMC4xOCwwLjY5LC0wLjE4XSxbJ2MnLDAuMDYsMC4wMCwwLjA2LDAuMzksMC4wNiw3LjUwXSxbJ2wnLDAuMDAsNy41MF0sWydsJywtMC42MywwLjE1XSxbJ2MnLC0wLjY2LDAuMTgsLTEuNDQsMC4zOSwtMS41MCwwLjM5XSxbJ2MnLC0wLjAzLDAuMDAsLTAuMDMsLTIuMjgsLTAuMDMsLTcuNTBdLFsnbCcsMC4wMCwtNy41MF0sWydsJywwLjM2LC0wLjA5XSxbJ2MnLDAuMjEsLTAuMDYsMC42NiwtMC4xOCwxLjA1LC0wLjI3XSxbJ3onXV0sdzoyLjE2LGg6MTUuNTR9LFxuXHRcdCdzY3JpcHRzLnNob3J0cGhyYXNlJzp7ZDpbWydNJywxLjQ3LC03LjU5XSxbJ2MnLDAuMzYsLTAuMDksMC42NiwtMC4xOCwwLjY5LC0wLjE4XSxbJ2MnLDAuMDYsMC4wMCwwLjA2LDAuMjEsMC4wNiwzLjc1XSxbJ2wnLDAuMDAsMy43NV0sWydsJywtMC40MiwwLjA5XSxbJ2MnLC0wLjU3LDAuMTgsLTEuNjUsMC40NSwtMS43MSwwLjQ1XSxbJ2MnLC0wLjAzLDAuMDAsLTAuMDMsLTAuNzIsLTAuMDMsLTMuNzVdLFsnbCcsMC4wMCwtMy43NV0sWydsJywwLjM2LC0wLjA5XSxbJ2MnLDAuMjEsLTAuMDYsMC42NiwtMC4xOCwxLjA1LC0wLjI3XSxbJ3onXV0sdzoyLjE2LGg6OC4wNH0sXG5cdFx0J3NjcmlwdHMuc25hcCc6e2Q6W1snTScsNC41MCwtMy4zOV0sWydjJywwLjM2LC0wLjAzLDAuOTYsLTAuMDMsMS4zNSwwLjAwXSxbJ2MnLDEuNTYsMC4xNSwzLjE1LDAuOTAsNC4yMCwyLjAxXSxbJ2MnLDAuMjQsMC4yNywwLjMzLDAuNDIsMC4zMywwLjYwXSxbJ2MnLDAuMDAsMC4yNywwLjAzLDAuMjQsLTIuNDYsMi4yMl0sWydjJywtMS4yOSwxLjAyLC0yLjQwLDEuODYsLTIuNDksMS45Ml0sWydjJywtMC4xOCwwLjA5LC0wLjMwLDAuMDksLTAuNDgsMC4wMF0sWydjJywtMC4wOSwtMC4wNiwtMS4yMCwtMC45MCwtMi40OSwtMS45Ml0sWydjJywtMi40OSwtMS45OCwtMi40NiwtMS45NSwtMi40NiwtMi4yMl0sWydjJywwLjAwLC0wLjE4LDAuMDksLTAuMzMsMC4zMywtMC42MF0sWydjJywxLjA1LC0xLjA4LDIuNjQsLTEuODYsNC4xNywtMi4wMV0sWyd6J10sWydtJywxLjI5LDEuMTddLFsnYycsLTEuNDcsLTAuMTUsLTIuOTcsMC4zMCwtNC4xNCwxLjIwXSxbJ2wnLC0wLjE4LDAuMTVdLFsnbCcsMC4wNiwwLjA5XSxbJ2MnLDAuMTUsMC4xMiwzLjYzLDIuODUsMy42NiwyLjg1XSxbJ2MnLDAuMDMsMC4wMCwzLjUxLC0yLjczLDMuNjYsLTIuODVdLFsnbCcsMC4wNiwtMC4wOV0sWydsJywtMC4xOCwtMC4xNV0sWydjJywtMC44NCwtMC42NiwtMS44OSwtMS4wOCwtMi45NCwtMS4yMF0sWyd6J11dLHc6MTAuMzgsaDo2Ljg0fX07XG5cblx0Ly8gQ3VzdG9tIGNoYXJhY3RlcnMgdGhhdCB3ZXJlbid0IGdlbmVyYXRlZCBmcm9tIHRoZSBmb250OlxuXHRnbHlwaHNbJ25vdGVoZWFkcy5zbGFzaC53aG9sZSddID0ge2Q6W1snTScsNSwtNV0sWydsJywxLDFdLFsnbCcsLTUsNV0sWydsJywtMSwtMV0sWyd6J10sWydtJyw0LDZdLFsnbCcsLTUsLTVdLFsnbCcsMiwtMl0sWydsJyw1LDVdLFsneiddLFsnbScsMCwtMl0sWydsJywxLDFdLFsnbCcsLTUsNV0sWydsJywtMSwtMV0sWyd6J10sWydtJywtNCw2XSxbJ2wnLC01LC01XSxbJ2wnLDIsLTJdLFsnbCcsNSw1XSxbJ3onXV0sdzoxMC44MSxoOjE1LjYzfTtcblxuXHRnbHlwaHNbJ25vdGVoZWFkcy5zbGFzaC5xdWFydGVyJ10gPSB7ZDpbWydNJyw5LC02XSxbJ2wnLDAsNF0sWydsJywtOSw5XSxbJ2wnLDAsLTRdLFsneiddXSx3OjksaDo5fTtcblxuXHRnbHlwaHNbJ25vdGVoZWFkcy5oYXJtb25pYy5xdWFydGVyJ10gPSB7ZDpbWydNJywzLjYzLC00LjAyXSxbJ2MnLDAuMDksLTAuMDYsMC4xOCwtMC4wOSwwLjI0LC0wLjAzXSxbJ2MnLDAuMDMsMC4wMywwLjg3LDAuOTMsMS44MywyLjAxXSxbJ2MnLDEuNTAsMS42NSwxLjgwLDEuOTgsMS44MCwyLjA0XSxbJ2MnLDAuMDAsMC4wNiwtMC4zMCwwLjM5LC0xLjgwLDIuMDRdLFsnYycsLTAuOTYsMS4wOCwtMS44MCwxLjk4LC0xLjgzLDIuMDFdLFsnYycsLTAuMDYsMC4wNiwtMC4xNSwwLjAzLC0wLjI0LC0wLjAzXSxbJ2MnLC0wLjEyLC0wLjA5LC0zLjU0LC0zLjg0LC0zLjYwLC0zLjkzXSxbJ2MnLC0wLjAzLC0wLjAzLC0wLjAzLC0wLjA5LC0wLjAzLC0wLjE1XSxbJ2MnLDAuMDMsLTAuMDYsMy40NSwtMy44NCwzLjYzLC0zLjk2XSxbJ3onXV0sdzo3LjUsaDo4LjE2NX07XG5cblxuICB0aGlzLnByaW50U3ltYm9sID0gZnVuY3Rpb24gKHgseSxzeW1iLHBhcGVyLCBrbGFzcykge1xuICAgIGlmICghZ2x5cGhzW3N5bWJdKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgcGF0aEFycmF5ID0gdGhpcy5wYXRoQ2xvbmUoZ2x5cGhzW3N5bWJdLmQpO1xuICAgIHBhdGhBcnJheVswXVsxXSArPXg7XG4gICAgcGF0aEFycmF5WzBdWzJdICs9eTtcbiAgICB2YXIgcGF0aCA9IFwiXCI7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwYXRoQXJyYXkubGVuZ3RoOyBpKyspXG4gICAgXHRwYXRoICs9IHBhdGhBcnJheVtpXS5qb2luKFwiIFwiKTtcbiAgICByZXR1cm4gcGFwZXIucGF0aCh7cGF0aDpwYXRoLCBzdHJva2U6XCJub25lXCIsIGZpbGw6XCIjMDAwMDAwXCIsICdjbGFzcyc6IGtsYXNzIH0pO1xuICAgfTtcbiAgXG4gIHRoaXMuZ2V0UGF0aEZvclN5bWJvbCA9IGZ1bmN0aW9uICh4LHksc3ltYixzY2FsZXgsIHNjYWxleSkge1xuICAgIHNjYWxleCA9IHNjYWxleCB8fCAxO1xuICAgIHNjYWxleSA9IHNjYWxleSB8fCAxO1xuICAgIGlmICghZ2x5cGhzW3N5bWJdKSByZXR1cm4gbnVsbDtcbiAgICB2YXIgcGF0aEFycmF5ID0gdGhpcy5wYXRoQ2xvbmUoZ2x5cGhzW3N5bWJdLmQpO1xuICAgIGlmIChzY2FsZXghPT0xIHx8IHNjYWxleSE9PTEpIHRoaXMucGF0aFNjYWxlKHBhdGhBcnJheSxzY2FsZXgsc2NhbGV5KTtcbiAgICBwYXRoQXJyYXlbMF1bMV0gKz14O1xuICAgIHBhdGhBcnJheVswXVsyXSArPXk7XG5cbiAgICByZXR1cm4gcGF0aEFycmF5O1xuICB9O1xuICBcbiAgdGhpcy5nZXRTeW1ib2xXaWR0aCA9IGZ1bmN0aW9uIChzeW1ib2wpIHtcbiAgICBpZiAoZ2x5cGhzW3N5bWJvbF0pIHJldHVybiBnbHlwaHNbc3ltYm9sXS53O1xuICAgIHJldHVybiAwO1xuICB9O1xuICBcbiAgdGhpcy5nZXRTeW1ib2xIZWlnaHQgPSBmdW5jdGlvbiAoc3ltYm9sKSB7XG4gICAgaWYgKGdseXBoc1tzeW1ib2xdKSByZXR1cm4gZ2x5cGhzW3N5bWJvbF0uaDtcbiAgICByZXR1cm4gMDtcbiAgfTtcblxuXHR0aGlzLnN5bWJvbEhlaWdodEluUGl0Y2hlcyA9IGZ1bmN0aW9uKHN5bWJvbCkge1xuXHRcdHJldHVybiB0aGlzLmdldFN5bWJvbEhlaWdodChzeW1ib2wpIC8gc3BhY2luZy5TVEVQO1xuXHR9O1xuXG4gIHRoaXMuZ2V0U3ltYm9sQWxpZ24gPSBmdW5jdGlvbiAoc3ltYm9sKSB7XG4gICAgaWYgKHN5bWJvbC5zdWJzdHJpbmcoMCw3KT09PVwic2NyaXB0c1wiICYmIFxuXHRzeW1ib2whPT1cInNjcmlwdHMucm9sbFwiKSB7XG4gICAgICByZXR1cm4gXCJjZW50ZXJcIjtcbiAgICB9XG4gICAgcmV0dXJuIFwibGVmdFwiO1xuICB9O1xuXG4gIHRoaXMucGF0aENsb25lID0gZnVuY3Rpb24gKHBhdGhBcnJheSkge1xuICAgIHZhciByZXMgPSBbXTtcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwYXRoQXJyYXkubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgcmVzW2ldID0gW107XG4gICAgICBmb3IgKHZhciBqID0gMCwgamogPSBwYXRoQXJyYXlbaV0ubGVuZ3RoOyBqIDwgamo7IGorKykge1xuXHRyZXNbaV1bal0gPSBwYXRoQXJyYXlbaV1bal07XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiByZXM7XG4gIH07XG5cbiAgdGhpcy5wYXRoU2NhbGUgPSBmdW5jdGlvbiAocGF0aEFycmF5LCBreCwga3kpIHtcbiAgICBmb3IgKHZhciBpID0gMCwgaWkgPSBwYXRoQXJyYXkubGVuZ3RoOyBpIDwgaWk7IGkrKykge1xuICAgICAgdmFyIHAgPSBwYXRoQXJyYXlbaV07XG4gICAgICB2YXIgaiwgamo7XG4gICAgICBmb3IgKGogPSAxLCBqaiA9IHAubGVuZ3RoOyBqIDwgamo7IGorKykge1xuXHRwW2pdICo9IChqICUgMikgPyBreCA6IGt5O1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgIFxuICB0aGlzLmdldFlDb3JyID0gZnVuY3Rpb24gKHN5bWJvbCkge1xuICAgIHN3aXRjaChzeW1ib2wpIHtcbiAgICBjYXNlIFwiMFwiOlxuICAgIGNhc2UgXCIxXCI6XG4gICAgY2FzZSBcIjJcIjpcbiAgICBjYXNlIFwiM1wiOlxuICAgIGNhc2UgXCI0XCI6XG4gICAgY2FzZSBcIjVcIjpcbiAgICBjYXNlIFwiNlwiOlxuICAgIGNhc2UgXCI3XCI6XG4gICAgY2FzZSBcIjhcIjpcbiAgICBjYXNlIFwiOVwiOlxuICAgIGNhc2UgXCIrXCI6IHJldHVybiAtMjtcbiAgICBjYXNlIFwidGltZXNpZy5jb21tb25cIjpcbiAgICBjYXNlIFwidGltZXNpZy5jdXRcIjogcmV0dXJuIDA7XG4gICAgY2FzZSBcImZsYWdzLmQzMm5kXCI6IHJldHVybiAtMTtcbiAgICBjYXNlIFwiZmxhZ3MuZDY0dGhcIjogcmV0dXJuIC0yO1xuICAgIGNhc2UgXCJmbGFncy51MzJuZFwiOiByZXR1cm4gMTtcbiAgICBjYXNlIFwiZmxhZ3MudTY0dGhcIjogcmV0dXJuIDM7XG4gICAgY2FzZSBcInJlc3RzLndob2xlXCI6IHJldHVybiAxO1xuICAgIGNhc2UgXCJyZXN0cy5oYWxmXCI6IHJldHVybiAtMTtcbiAgICBjYXNlIFwicmVzdHMuOHRoXCI6IHJldHVybiAtMTtcbiAgICBjYXNlIFwicmVzdHMucXVhcnRlclwiOiByZXR1cm4gLTE7XG4gICAgY2FzZSBcInJlc3RzLjE2dGhcIjogcmV0dXJuIC0xO1xuICAgIGNhc2UgXCJyZXN0cy4zMm5kXCI6IHJldHVybiAtMTtcbiAgICBjYXNlIFwicmVzdHMuNjR0aFwiOiByZXR1cm4gLTE7XG5cdFx0Y2FzZSBcImZcIjpcblx0XHRjYXNlIFwibVwiOlxuXHRcdGNhc2UgXCJwXCI6XG5cdFx0Y2FzZSBcInNcIjpcblx0XHRjYXNlIFwielwiOlxuXHRcdFx0cmV0dXJuIC00O1xuXHRcdGNhc2UgXCJzY3JpcHRzLnRyaWxsXCI6XG5cdFx0Y2FzZSBcInNjcmlwdHMudXBib3dcIjpcblx0XHRjYXNlIFwic2NyaXB0cy5kb3duYm93XCI6XG5cdFx0XHRyZXR1cm4gLTI7XG5cdFx0Y2FzZSBcInNjcmlwdHMudWZlcm1hdGFcIjpcblx0XHRjYXNlIFwic2NyaXB0cy53ZWRnZVwiOlxuXHRcdGNhc2UgXCJzY3JpcHRzLnJvbGxcIjpcblx0XHRjYXNlIFwic2NyaXB0cy5zaG9ydHBocmFzZVwiOlxuXHRcdGNhc2UgXCJzY3JpcHRzLmxvbmdwaHJhc2VcIjpcblx0XHRcdHJldHVybiAtMTtcblx0XHRjYXNlIFwic2NyaXB0cy5kZmVybWF0YVwiOlxuXHRcdFx0cmV0dXJuIDE7XG4gICAgZGVmYXVsdDogcmV0dXJuIDA7XG4gICAgfVxuICB9O1xufTtcbm1vZHVsZS5leHBvcnRzID0gbmV3IEdseXBocygpOyAvLyB3ZSBuZWVkIHRoZSBnbHlwaHMgZm9yIGxheW91dCBpbmZvcm1hdGlvblxuIiwiLy8gICAgYWJjX3JlbGF0aXZlX2VsZW1lbnQuanM6IERlZmluaXRpb24gb2YgdGhlIFJlbGF0aXZlRWxlbWVudCBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIGdseXBocyA9IHJlcXVpcmUoJy4vYWJjX2dseXBocycpO1xuXG52YXIgUmVsYXRpdmVFbGVtZW50ID0gZnVuY3Rpb24gUmVsYXRpdmVFbGVtZW50KGMsIGR4LCB3LCBwaXRjaCwgb3B0KSB7XG5cdG9wdCA9IG9wdCB8fCB7fTtcblx0dGhpcy54ID0gMDtcblx0dGhpcy5jID0gYzsgICAgICAvLyBjaGFyYWN0ZXIgb3IgcGF0aCBvciBzdHJpbmdcblx0dGhpcy5keCA9IGR4OyAgICAvLyByZWxhdGl2ZSB4IHBvc2l0aW9uXG5cdHRoaXMudyA9IHc7ICAgICAgLy8gbWluaW11bSB3aWR0aCB0YWtlbiB1cCBieSB0aGlzIGVsZW1lbnQgKGNhbiBpbmNsdWRlIGdyYXR1aXRvdXMgc3BhY2UpXG5cdHRoaXMucGl0Y2ggPSBwaXRjaDsgLy8gcmVsYXRpdmUgeSBwb3NpdGlvbiBieSBwaXRjaFxuXHR0aGlzLnNjYWxleCA9IG9wdC5zY2FsZXggfHwgMTsgLy8gc2hvdWxkIHRoZSBjaGFyYWN0ZXIvcGF0aCBiZSBzY2FsZWQ/XG5cdHRoaXMuc2NhbGV5ID0gb3B0LnNjYWxleSB8fCAxOyAvLyBzaG91bGQgdGhlIGNoYXJhY3Rlci9wYXRoIGJlIHNjYWxlZD9cblx0dGhpcy50eXBlID0gb3B0LnR5cGUgfHwgXCJzeW1ib2xcIjsgLy8gY2hlYXAgdHlwZXMuXG5cdHRoaXMucGl0Y2gyID0gb3B0LnBpdGNoMjtcblx0dGhpcy5saW5ld2lkdGggPSBvcHQubGluZXdpZHRoO1xuXHR0aGlzLmtsYXNzID0gb3B0LmtsYXNzO1xuXHR0aGlzLnRvcCA9IHBpdGNoO1xuXHRpZiAodGhpcy5waXRjaDIgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnBpdGNoMiA+IHRoaXMudG9wKSB0aGlzLnRvcCA9IHRoaXMucGl0Y2gyO1xuXHR0aGlzLmJvdHRvbSA9IHBpdGNoO1xuXHRpZiAodGhpcy5waXRjaDIgIT09IHVuZGVmaW5lZCAmJiB0aGlzLnBpdGNoMiA8IHRoaXMuYm90dG9tKSB0aGlzLmJvdHRvbSA9IHRoaXMucGl0Y2gyO1xuXHRpZiAob3B0LnRoaWNrbmVzcykge1xuXHRcdHRoaXMudG9wICs9IG9wdC50aGlja25lc3MvMjtcblx0XHR0aGlzLmJvdHRvbSAtPSBvcHQudGhpY2tuZXNzLzI7XG5cdH1cblx0aWYgKG9wdC5zdGVtSGVpZ2h0KSB7XG5cdFx0aWYgKG9wdC5zdGVtSGVpZ2h0ID4gMClcblx0XHRcdHRoaXMudG9wICs9IG9wdC5zdGVtSGVpZ2h0O1xuXHRcdGVsc2Vcblx0XHRcdHRoaXMuYm90dG9tICs9IG9wdC5zdGVtSGVpZ2h0O1xuXHR9XG5cdC8vaWYgKHRoaXMudHlwZSA9PT0gXCJzeW1ib2xcIikge1xuXHQvL1x0dmFyIG9mZnNldCA9IGdseXBocy5nZXRZQ29ycih0aGlzLmMpO1xuXHQvL1x0dGhpcy50b3AgKz0gb2Zmc2V0O1xuXHQvL1x0dGhpcy5ib3R0b20gKz0gb2Zmc2V0O1xuXHQvL31cblx0dGhpcy5oZWlnaHQgPSBvcHQuaGVpZ2h0ID8gb3B0LmhlaWdodCA6IDQ7IC8vIFRoZSArMSBpcyB0byBnaXZlIGEgbGl0dGxlIGJpdCBvZiBwYWRkaW5nLlxuXHR0aGlzLmNlbnRlclZlcnRpY2FsbHkgPSBmYWxzZTtcblx0c3dpdGNoICh0aGlzLnR5cGUpIHtcblx0XHRjYXNlIFwiZGVidWdcIjpcblx0XHRcdHRoaXMuY2hvcmRIZWlnaHRBYm92ZSA9IHRoaXMuaGVpZ2h0O1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImx5cmljXCI6XG5cdFx0XHRpZiAob3B0LnBvc2l0aW9uICYmIG9wdC5wb3NpdGlvbiA9PT0gJ2JlbG93Jylcblx0XHRcdFx0dGhpcy5seXJpY0hlaWdodEJlbG93ID0gdGhpcy5oZWlnaHQ7XG5cdFx0XHRlbHNlXG5cdFx0XHRcdHRoaXMubHlyaWNIZWlnaHRBYm92ZSA9IHRoaXMuaGVpZ2h0O1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImNob3JkXCI6XG5cdFx0XHRpZiAob3B0LnBvc2l0aW9uICYmIG9wdC5wb3NpdGlvbiA9PT0gJ2JlbG93Jylcblx0XHRcdFx0dGhpcy5jaG9yZEhlaWdodEJlbG93ID0gdGhpcy5oZWlnaHQ7XG5cdFx0XHRlbHNlXG5cdFx0XHRcdHRoaXMuY2hvcmRIZWlnaHRBYm92ZSA9IHRoaXMuaGVpZ2h0O1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcInRleHRcIjpcblx0XHRcdGlmICh0aGlzLnBpdGNoID09PSB1bmRlZmluZWQpIHtcblx0XHRcdFx0aWYgKG9wdC5wb3NpdGlvbiAmJiBvcHQucG9zaXRpb24gPT09ICdiZWxvdycpXG5cdFx0XHRcdFx0dGhpcy5jaG9yZEhlaWdodEJlbG93ID0gdGhpcy5oZWlnaHQ7XG5cdFx0XHRcdGVsc2Vcblx0XHRcdFx0XHR0aGlzLmNob3JkSGVpZ2h0QWJvdmUgPSB0aGlzLmhlaWdodDtcblx0XHRcdH0gZWxzZVxuXHRcdFx0XHR0aGlzLmNlbnRlclZlcnRpY2FsbHkgPSB0cnVlO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcInBhcnRcIjogdGhpcy5wYXJ0SGVpZ2h0QWJvdmUgPSB0aGlzLmhlaWdodDsgYnJlYWs7XG5cdH1cbn07XG5cblJlbGF0aXZlRWxlbWVudC5wcm90b3R5cGUuc2V0WCA9IGZ1bmN0aW9uICh4KSB7XG5cdHRoaXMueCA9IHgrdGhpcy5keDtcbn07XG5cblJlbGF0aXZlRWxlbWVudC5wcm90b3R5cGUuc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzID0gZnVuY3Rpb24ocG9zaXRpb25ZKSB7XG5cdHN3aXRjaCh0aGlzLnR5cGUpIHtcblx0XHRjYXNlIFwicGFydFwiOlxuXHRcdFx0dGhpcy50b3AgPSBwb3NpdGlvblkucGFydEhlaWdodEFib3ZlICsgdGhpcy5oZWlnaHQ7XG5cdFx0XHR0aGlzLmJvdHRvbSA9IHBvc2l0aW9uWS5wYXJ0SGVpZ2h0QWJvdmU7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwidGV4dFwiOlxuXHRcdGNhc2UgXCJjaG9yZFwiOlxuXHRcdFx0aWYgKHRoaXMuY2hvcmRIZWlnaHRBYm92ZSkge1xuXHRcdFx0XHR0aGlzLnRvcCA9IHBvc2l0aW9uWS5jaG9yZEhlaWdodEFib3ZlO1xuXHRcdFx0XHR0aGlzLmJvdHRvbSA9IHBvc2l0aW9uWS5jaG9yZEhlaWdodEFib3ZlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50b3AgPSBwb3NpdGlvblkuY2hvcmRIZWlnaHRCZWxvdztcblx0XHRcdFx0dGhpcy5ib3R0b20gPSBwb3NpdGlvblkuY2hvcmRIZWlnaHRCZWxvdztcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJseXJpY1wiOlxuXHRcdFx0aWYgKHRoaXMubHlyaWNIZWlnaHRBYm92ZSkge1xuXHRcdFx0XHR0aGlzLnRvcCA9IHBvc2l0aW9uWS5seXJpY0hlaWdodEFib3ZlO1xuXHRcdFx0XHR0aGlzLmJvdHRvbSA9IHBvc2l0aW9uWS5seXJpY0hlaWdodEFib3ZlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy50b3AgPSBwb3NpdGlvblkubHlyaWNIZWlnaHRCZWxvdztcblx0XHRcdFx0dGhpcy5ib3R0b20gPSBwb3NpdGlvblkubHlyaWNIZWlnaHRCZWxvdztcblx0XHRcdH1cblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJkZWJ1Z1wiOlxuXHRcdFx0dGhpcy50b3AgPSBwb3NpdGlvblkuY2hvcmRIZWlnaHRBYm92ZTtcblx0XHRcdHRoaXMuYm90dG9tID0gcG9zaXRpb25ZLmNob3JkSGVpZ2h0QWJvdmU7XG5cdFx0XHRicmVhaztcblx0fVxuXHRpZiAodGhpcy5waXRjaCA9PT0gdW5kZWZpbmVkIHx8IHRoaXMudG9wID09PSB1bmRlZmluZWQpXG5cdFx0d2luZG93LmNvbnNvbGUuZXJyb3IoXCJSZWxhdGl2ZUVsZW1lbnQgcG9zaXRpb24gbm90IHNldC5cIiwgdGhpcy50eXBlLCB0aGlzLnBpdGNoLCB0aGlzLnRvcCwgcG9zaXRpb25ZKTtcbn07XG5cblJlbGF0aXZlRWxlbWVudC5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uIChyZW5kZXJlciwgYmFydG9wKSB7XG5cdGlmICh0aGlzLnBpdGNoID09PSB1bmRlZmluZWQpXG5cdFx0d2luZG93LmNvbnNvbGUuZXJyb3IodGhpcy50eXBlICsgXCIgUmVsYXRpdmUgRWxlbWVudCB5LWNvb3JkaW5hdGUgbm90IHNldC5cIik7XG5cdHZhciB5ID0gcmVuZGVyZXIuY2FsY1kodGhpcy5waXRjaCk7XG5cdHN3aXRjaCh0aGlzLnR5cGUpIHtcblx0XHRjYXNlIFwic3ltYm9sXCI6XG5cdFx0XHRpZiAodGhpcy5jPT09bnVsbCkgcmV0dXJuIG51bGw7XG5cdFx0XHR2YXIga2xhc3MgPSBcInN5bWJvbFwiO1xuXHRcdFx0aWYgKHRoaXMua2xhc3MpIGtsYXNzICs9IFwiIFwiICsgdGhpcy5rbGFzcztcblx0XHRcdHRoaXMuZ3JhcGhlbGVtID0gcmVuZGVyZXIucHJpbnRTeW1ib2wodGhpcy54LCB0aGlzLnBpdGNoLCB0aGlzLmMsIHRoaXMuc2NhbGV4LCB0aGlzLnNjYWxleSwgcmVuZGVyZXIuYWRkQ2xhc3NlcyhrbGFzcykpOyBicmVhaztcblx0XHRjYXNlIFwiZGVidWdcIjpcblx0XHRcdHRoaXMuZ3JhcGhlbGVtID0gcmVuZGVyZXIucmVuZGVyVGV4dCh0aGlzLngsIHJlbmRlcmVyLmNhbGNZKDE1KSwgXCJcIit0aGlzLmMsIFwiZGVidWdmb250XCIsICdkZWJ1Zy1tc2cnLCAnc3RhcnQnKTsgYnJlYWs7XG5cdFx0Y2FzZSBcImJhck51bWJlclwiOlxuXHRcdFx0dGhpcy5ncmFwaGVsZW0gPSByZW5kZXJlci5yZW5kZXJUZXh0KHRoaXMueCwgeSwgXCJcIit0aGlzLmMsIFwibWVhc3VyZWZvbnRcIiwgJ2Jhci1udW1iZXInLCBcIm1pZGRsZVwiKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJseXJpY1wiOlxuXHRcdFx0dGhpcy5ncmFwaGVsZW0gPSByZW5kZXJlci5yZW5kZXJUZXh0KHRoaXMueCwgeSwgdGhpcy5jLCBcInZvY2FsZm9udFwiLCAnbHlyaWMnLCBcIm1pZGRsZVwiKTtcblx0XHRcdGJyZWFrO1xuXHRcdGNhc2UgXCJjaG9yZFwiOlxuXHRcdFx0dGhpcy5ncmFwaGVsZW0gPSByZW5kZXJlci5yZW5kZXJUZXh0KHRoaXMueCwgeSwgdGhpcy5jLCAnZ2Nob3JkZm9udCcsIFwiY2hvcmRcIiwgXCJtaWRkbGVcIik7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwiZGVjb3JhdGlvblwiOlxuXHRcdFx0dGhpcy5ncmFwaGVsZW0gPSByZW5kZXJlci5yZW5kZXJUZXh0KHRoaXMueCwgeSwgdGhpcy5jLCAnYW5ub3RhdGlvbmZvbnQnLCBcImFubm90YXRpb25cIiwgXCJtaWRkbGVcIiwgdHJ1ZSk7XG5cdFx0XHRicmVhaztcblx0XHRjYXNlIFwidGV4dFwiOlxuXHRcdFx0dGhpcy5ncmFwaGVsZW0gPSByZW5kZXJlci5yZW5kZXJUZXh0KHRoaXMueCwgeSwgdGhpcy5jLCAnYW5ub3RhdGlvbmZvbnQnLCBcImFubm90YXRpb25cIiwgXCJzdGFydFwiLCB0aGlzLmNlbnRlclZlcnRpY2FsbHkpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcIm11bHRpbWVhc3VyZS10ZXh0XCI6XG5cdFx0XHR0aGlzLmdyYXBoZWxlbSA9IHJlbmRlcmVyLnJlbmRlclRleHQodGhpcy54K3RoaXMudy8yLCB5LCB0aGlzLmMsICd0ZW1wb2ZvbnQnLCBcInJlc3RcIiwgXCJtaWRkbGVcIiwgZmFsc2UpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcInBhcnRcIjpcblx0XHRcdHRoaXMuZ3JhcGhlbGVtID0gcmVuZGVyZXIucmVuZGVyVGV4dCh0aGlzLngsIHksIHRoaXMuYywgJ3BhcnRzZm9udCcsIFwicGFydFwiLCBcInN0YXJ0XCIpO1xuXHRcdFx0YnJlYWs7XG5cdFx0Y2FzZSBcImJhclwiOlxuXHRcdFx0dGhpcy5ncmFwaGVsZW0gPSByZW5kZXJlci5wcmludFN0ZW0odGhpcy54LCB0aGlzLmxpbmV3aWR0aCwgeSwgKGJhcnRvcCk/YmFydG9wOnJlbmRlcmVyLmNhbGNZKHRoaXMucGl0Y2gyKSk7IGJyZWFrOyAvLyBiYXJ0b3AgY2FuJ3QgYmUgMFxuXHRcdGNhc2UgXCJzdGVtXCI6XG5cdFx0XHR0aGlzLmdyYXBoZWxlbSA9IHJlbmRlcmVyLnByaW50U3RlbSh0aGlzLngsIHRoaXMubGluZXdpZHRoLCB5LCByZW5kZXJlci5jYWxjWSh0aGlzLnBpdGNoMikpOyBicmVhaztcblx0XHRjYXNlIFwibGVkZ2VyXCI6XG5cdFx0XHR0aGlzLmdyYXBoZWxlbSA9IHJlbmRlcmVyLnByaW50U3RhdmVMaW5lKHRoaXMueCwgdGhpcy54K3RoaXMudywgdGhpcy5waXRjaCk7IGJyZWFrO1xuXHR9XG5cdGlmICh0aGlzLnNjYWxleCE9PTEgJiYgdGhpcy5ncmFwaGVsZW0pIHtcblx0XHRyZW5kZXJlci5zY2FsZUV4aXN0aW5nRWxlbSh0aGlzLmdyYXBoZWxlbSwgdGhpcy5zY2FsZXgsIHRoaXMuc2NhbGV5LCB0aGlzLngsIHkpO1xuXHR9XG5cdHJldHVybiB0aGlzLmdyYXBoZWxlbTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUmVsYXRpdmVFbGVtZW50O1xuIiwiLy8gICAgYWJjX3JlbmRlcmVyLmpzOiBBUEkgdG8gcmVuZGVyIHRvIFNWRy9SYXBoYWVsL3doYXRldmVyIHJlbmRlcmluZyBlbmdpbmVcbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSlcbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuXG4vKmdsb2JhbCBNYXRoLCBjb25zb2xlICovXG5cbnZhciBnbHlwaHMgPSByZXF1aXJlKCcuL2FiY19nbHlwaHMnKTtcbnZhciBzcGFjaW5nID0gcmVxdWlyZSgnLi9hYmNfc3BhY2luZycpO1xudmFyIHNwcmludGYgPSByZXF1aXJlKCcuL3NwcmludGYnKTtcbnZhciBTdmcgPSByZXF1aXJlKCcuL3N2ZycpO1xuXG4vKipcbiAqIEltcGxlbWVudHMgdGhlIEFQSSBmb3IgcmVuZGVyaW5nIEFCQ0pTIEFic3RyYWN0IFJlbmRlcmluZyBTdHJ1Y3R1cmUgdG8gYSBjYW52YXMvcGFwZXIgKGUuZy4gU1ZHLCBSYXBoYWVsLCBldGMpXG4gKiBAcGFyYW0ge09iamVjdH0gcGFwZXJcbiAqIEBwYXJhbSB7Ym9vbH0gZG9SZWdyZXNzaW9uXG4gKi9cbnZhciBSZW5kZXJlciA9IGZ1bmN0aW9uKHBhcGVyLCBkb1JlZ3Jlc3Npb24sIHNob3VsZEFkZENsYXNzZXMpIHtcbiAgdGhpcy5wYXBlciA9IG5ldyBTdmcocGFwZXIpO1xuICB0aGlzLmNvbnRyb2xsZXIgPSBudWxsOyAvL1RPRE8tR0Qgb25seSB1c2VkIHdoZW4gZHJhd2luZyB0aGUgQUJDSlMgQVJTIHRvIGNvbm5lY3QgdGhlIGNvbnRyb2xsZXIgd2l0aCB0aGUgZWxlbWVudHMgZm9yIGhpZ2hsaWdodGluZ1xuXG5cdHRoaXMuc3BhY2UgPSAzKnNwYWNpbmcuU1BBQ0U7XG4gIHRoaXMucGFkZGluZyA9IHt9OyAvLyByZW5kZXJlcidzIHBhZGRpbmcgaXMgbWFuYWdlZCBieSB0aGUgY29udHJvbGxlclxuICB0aGlzLmRvUmVncmVzc2lvbiA9IGRvUmVncmVzc2lvbjtcbiAgdGhpcy5zaG91bGRBZGRDbGFzc2VzID0gc2hvdWxkQWRkQ2xhc3NlcztcbiAgaWYgKHRoaXMuZG9SZWdyZXNzaW9uKVxuICAgIHRoaXMucmVncmVzc2lvbkxpbmVzID0gW107XG5cdHRoaXMucmVzZXQoKTtcbn07XG5cblJlbmRlcmVyLnByb3RvdHlwZS5yZXNldCA9IGZ1bmN0aW9uKCkge1xuXG5cdHRoaXMucGFwZXIuY2xlYXIoKTtcblx0dGhpcy55ID0gMDtcblx0dGhpcy5hYmN0dW5lID0gbnVsbDtcblx0dGhpcy5sYXN0TSA9IG51bGw7XG5cdHRoaXMuaW5ncm91cCA9IGZhbHNlO1xuXHR0aGlzLnBhdGggPSBudWxsO1xuXHR0aGlzLmlzUHJpbnQgPSBmYWxzZTtcblx0dGhpcy5pbml0VmVydGljYWxTcGFjZSgpO1xuXHRpZiAodGhpcy5kb1JlZ3Jlc3Npb24pXG5cdFx0dGhpcy5yZWdyZXNzaW9uTGluZXMgPSBbXTtcblx0Ly8gSEFDSy1QRVI6IFRoZXJlIHdhcyBhIHByb2JsZW0gaW4gUmFwaGFlbCB3aGVyZSBldmVyeSBwYXRoIHN0cmluZyB0aGF0IHdhcyBzZW50IHRvIGl0IHdhcyBjYWNoZWQuXG5cdC8vIFRoYXQgd2FzIGNhdXNpbmcgdGhlIGJyb3dzZXIncyBtZW1vcnkgdG8gc3RlYWRpbHkgZ3JvdyB1bnRpbCB0aGUgYnJvd3NlciB3ZW50IHNsb3dlciBhbmQgc2xvd2VyIHVudGlsXG5cdC8vIGl0IGNyYXNoZWQuIFRoZSBmaXggdG8gdGhhdCB3YXMgYSBwYXRjaCB0byBSYXBoYWVsLCBzbyBpdCBpcyBvbmx5IHBhdGNoZWQgb24gdGhlIHZlcnNpb25zIG9mIHRoaXMgbGlicmFyeSB0aGF0XG5cdC8vIGJ1bmRsZSBSYXBoYWVsIHdpdGggaXQuIEFsc28sIGlmIFJhcGhhZWwgZ2V0cyBhbiB1cGRhdGUsIHRoZW4gdGhhdCBwYXRjaCB3aWxsIGJlIGxvc3QuIE9uIHZlcnNpb24gMi4xLjIgb2YgUmFwaGFlbCxcblx0Ly8gdGhlIHBhdGNoIGlzIG9uIGxpbmUgMTU0MiBhbmQgMTU0NSBhbmQgaXQgaXM6XG5cdC8vICAgICAgICAgICAgIHBbcHNdLnNsZWVwID0gMTtcbn07XG5cblJlbmRlcmVyLnByb3RvdHlwZS5uZXdUdW5lID0gZnVuY3Rpb24oYWJjVHVuZSkge1xuXHR0aGlzLmFiY3R1bmUgPSBhYmNUdW5lOyAvLyBUT0RPLVBFUjogdGhpcyBpcyBqdXN0IHRvIGdldCB0aGUgZm9udCBpbmZvLlxuXHR0aGlzLnNldFZlcnRpY2FsU3BhY2UoYWJjVHVuZS5mb3JtYXR0aW5nKTtcblx0dGhpcy5tZWFzdXJlTnVtYmVyID0gbnVsbDtcblx0dGhpcy5ub3RlTnVtYmVyID0gbnVsbDtcblx0dGhpcy5zZXRQcmludE1vZGUoYWJjVHVuZS5tZWRpYSA9PT0gJ3ByaW50Jyk7XG5cdHRoaXMuc2V0UGFkZGluZyhhYmNUdW5lKTtcbn07XG5cblJlbmRlcmVyLnByb3RvdHlwZS5jcmVhdGVFbGVtU2V0ID0gZnVuY3Rpb24oKSB7XG5cdHJldHVybiB0aGlzLnBhcGVyLm9wZW5Hcm91cCgpO1xufTtcblxuUmVuZGVyZXIucHJvdG90eXBlLmNsb3NlRWxlbVNldCA9IGZ1bmN0aW9uKCkge1xuXHRyZXR1cm4gdGhpcy5wYXBlci5jbG9zZUdyb3VwKCk7XG59O1xuXG4vKipcbiAqIFNldCB3aGV0aGVyIHdlIGFyZSBmb3JtYXR0aW5nIHRoaXMgZm9yIHRoZSBzY3JlZW4sIG9yIGFzIGEgcHJldmlldyBmb3IgY3JlYXRpbmcgYSBQREYgdmVyc2lvbi5cbiAqIEBwYXJhbSB7Ym9vbH0gaXNQcmludFxuICovXG5SZW5kZXJlci5wcm90b3R5cGUuc2V0UHJpbnRNb2RlID0gZnVuY3Rpb24gKGlzUHJpbnQpIHtcblx0dGhpcy5pc1ByaW50ID0gaXNQcmludDtcbn07XG5cbi8qKlxuICogU2V0IHRoZSBzaXplIG9mIHRoZSBjYW52YXMuXG4gKiBAcGFyYW0ge29iamVjdH0gbWF4d2lkdGhcbiAqIEBwYXJhbSB7b2JqZWN0fSBzY2FsZVxuICovXG5SZW5kZXJlci5wcm90b3R5cGUuc2V0UGFwZXJTaXplID0gZnVuY3Rpb24gKG1heHdpZHRoLCBzY2FsZSwgcmVzcG9uc2l2ZSkge1xuXHR2YXIgdyA9IChtYXh3aWR0aCt0aGlzLnBhZGRpbmcucmlnaHQpKnNjYWxlO1xuXHR2YXIgaCA9ICh0aGlzLnkrdGhpcy5wYWRkaW5nLmJvdHRvbSkqc2NhbGU7XG5cdGlmICh0aGlzLmlzUHJpbnQpXG5cdFx0aCA9IE1hdGgubWF4KGgsIDEwNTYpOyAvLyAxMWluIHggNzJwdC9pbiB4IDEuMzNweC9wdFxuXHQvLyBUT0RPLVBFUjogV2UgYXJlIGxldHRpbmcgdGhlIHBhZ2UgZ2V0IGFzIGxvbmcgYXMgaXQgbmVlZHMgbm93LCBidXQgZXZlbnR1YWxseSB0aGF0IHNob3VsZCBnbyB0byBhIHNlY29uZCBwYWdlLlxuXHRpZiAodGhpcy5kb1JlZ3Jlc3Npb24pXG5cdFx0dGhpcy5yZWdyZXNzaW9uTGluZXMucHVzaChcIlBBUEVSIFNJWkU6IChcIit3K1wiLFwiK2grXCIpXCIpO1xuXG5cdC8vIGZvciBhY2Nlc3NpYmlsaXR5XG5cdHZhciB0ZXh0ID0gXCJTaGVldCBNdXNpY1wiO1xuXHRpZiAodGhpcy5hYmN0dW5lICYmIHRoaXMuYWJjdHVuZS5tZXRhVGV4dCAmJiB0aGlzLmFiY3R1bmUubWV0YVRleHQudGl0bGUpXG5cdFx0dGV4dCArPSBcIiBmb3IgXFxcIlwiICsgdGhpcy5hYmN0dW5lLm1ldGFUZXh0LnRpdGxlICsgJ1wiJztcblx0dGhpcy5wYXBlci5zZXRUaXRsZSh0ZXh0KTtcblxuXHR2YXIgcGFyZW50U3R5bGVzID0geyBvdmVyZmxvdzogXCJoaWRkZW5cIiB9O1xuXHRpZiAocmVzcG9uc2l2ZSA9PT0gJ3Jlc2l6ZScpIHtcblx0XHR0aGlzLnBhcGVyLnNldFJlc3BvbnNpdmVXaWR0aCh3LCBoKTtcblx0fSBlbHNlIHtcblx0XHRwYXJlbnRTdHlsZXMud2lkdGggPSBcIlwiO1xuXHRcdHBhcmVudFN0eWxlcy5oZWlnaHQgPSBoICsgXCJweFwiO1xuXHRcdGlmIChzY2FsZSA8IDEpIHtcblx0XHRcdHBhcmVudFN0eWxlcy53aWR0aCA9IHcgKyBcInB4XCI7XG5cdFx0XHR0aGlzLnBhcGVyLnNldFNpemUodyAvIHNjYWxlLCBoIC8gc2NhbGUpO1xuXHRcdH0gZWxzZVxuXHRcdFx0dGhpcy5wYXBlci5zZXRTaXplKHcsIGgpO1xuXHR9XG5cdHRoaXMucGFwZXIuc2V0U2NhbGUoc2NhbGUpO1xuXHR0aGlzLnBhcGVyLnNldFBhcmVudFN0eWxlcyhwYXJlbnRTdHlsZXMpO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIHBhZGRpbmdcbiAqIEBwYXJhbSB7b2JqZWN0fSBwYXJhbXNcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLnNldFBhZGRpbmdPdmVycmlkZSA9IGZ1bmN0aW9uKHBhcmFtcykge1xuXHR0aGlzLnBhZGRpbmdPdmVycmlkZSA9IHsgdG9wOiBwYXJhbXMucGFkZGluZ3RvcCwgYm90dG9tOiBwYXJhbXMucGFkZGluZ2JvdHRvbSxcblx0XHRyaWdodDogcGFyYW1zLnBhZGRpbmdyaWdodCwgbGVmdDogcGFyYW1zLnBhZGRpbmdsZWZ0IH07XG59O1xuXG4vKipcbiAqIFNldCB0aGUgcGFkZGluZ1xuICogQHBhcmFtIHtvYmplY3R9IHBhcmFtc1xuICovXG5SZW5kZXJlci5wcm90b3R5cGUuc2V0UGFkZGluZyA9IGZ1bmN0aW9uKGFiY3R1bmUpIHtcblx0Ly8gSWYgdGhlIHBhZGRpbmcgaXMgc2V0IGluIHRoZSB0dW5lLCB0aGVuIHVzZSB0aGF0LlxuXHQvLyBPdGhlcndpc2UsIGlmIHRoZSBwYWRkaW5nIGlzIHNldCBpbiB0aGUgb3ZlcnJpZGUsIHVzZSB0aGF0LlxuXHQvLyBPdGhlcndpc2UsIHVzZSB0aGUgZGVmYXVsdHMgKHRoZXJlIGFyZSBhIGRpZmZlcmVudCBzZXQgb2YgZGVmYXVsdHMgZm9yIHNjcmVlbiBhbmQgcHJpbnQuKVxuXHRmdW5jdGlvbiBzZXRQYWRkaW5nVmFyaWFibGUoc2VsZiwgcGFkZGluZ0tleSwgZm9ybWF0dGluZ0tleSwgcHJpbnREZWZhdWx0LCBzY3JlZW5EZWZhdWx0KSB7XG5cdFx0aWYgKGFiY3R1bmUuZm9ybWF0dGluZ1tmb3JtYXR0aW5nS2V5XSAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0c2VsZi5wYWRkaW5nW3BhZGRpbmdLZXldID0gYWJjdHVuZS5mb3JtYXR0aW5nW2Zvcm1hdHRpbmdLZXldO1xuXHRcdGVsc2UgaWYgKHNlbGYucGFkZGluZ092ZXJyaWRlW3BhZGRpbmdLZXldICE9PSB1bmRlZmluZWQpXG5cdFx0XHRzZWxmLnBhZGRpbmdbcGFkZGluZ0tleV0gPSBzZWxmLnBhZGRpbmdPdmVycmlkZVtwYWRkaW5nS2V5XTtcblx0XHRlbHNlIGlmIChzZWxmLmlzUHJpbnQpXG5cdFx0XHRzZWxmLnBhZGRpbmdbcGFkZGluZ0tleV0gPSBwcmludERlZmF1bHQ7XG5cdFx0ZWxzZVxuXHRcdFx0c2VsZi5wYWRkaW5nW3BhZGRpbmdLZXldID0gc2NyZWVuRGVmYXVsdDtcblx0fVxuXHQvLyAxY20geCAwLjM5MzcwMWluL2NtIHggNzJwdC9pbiB4IDEuMzNweC9wdCA9IDM4cHhcblx0Ly8gMS44Y20geCAwLjM5MzcwMWluL2NtIHggNzJwdC9pbiB4IDEuMzNweC9wdCA9IDY4cHhcblx0c2V0UGFkZGluZ1ZhcmlhYmxlKHRoaXMsICd0b3AnLCAndG9wbWFyZ2luJywgMzgsIDE1KTtcblx0c2V0UGFkZGluZ1ZhcmlhYmxlKHRoaXMsICdib3R0b20nLCAnYm90bWFyZ2luJywgMzgsIDE1KTtcblx0c2V0UGFkZGluZ1ZhcmlhYmxlKHRoaXMsICdsZWZ0JywgJ2xlZnRtYXJnaW4nLCA2OCwgMTUpO1xuXHRzZXRQYWRkaW5nVmFyaWFibGUodGhpcywgJ3JpZ2h0JywgJ3JpZ2h0bWFyZ2luJywgNjgsIDE1KTtcbn07XG5cbi8qKlxuICogU29tZSBvZiB0aGUgaXRlbXMgb24gdGhlIHBhZ2UgYXJlIG5vdCBzY2FsZWQsIHNvIGFkanVzdCB0aGVtIGluIHRoZSBvcHBvc2l0ZSBkaXJlY3Rpb24gb2Ygc2NhbGluZyB0byBjYW5jZWwgb3V0IHRoZSBzY2FsaW5nLlxuICogQHBhcmFtIHtmbG9hdH0gc2NhbGVcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLmFkanVzdE5vblNjYWxlZEl0ZW1zID0gZnVuY3Rpb24gKHNjYWxlKSB7XG5cdHRoaXMucGFkZGluZy50b3AgLz0gc2NhbGU7XG5cdHRoaXMucGFkZGluZy5ib3R0b20gLz0gc2NhbGU7XG5cdHRoaXMucGFkZGluZy5sZWZ0IC89IHNjYWxlO1xuXHR0aGlzLnBhZGRpbmcucmlnaHQgLz0gc2NhbGU7XG5cdHRoaXMuYWJjdHVuZS5mb3JtYXR0aW5nLmhlYWRlcmZvbnQuc2l6ZSAvPSBzY2FsZTtcblx0dGhpcy5hYmN0dW5lLmZvcm1hdHRpbmcuZm9vdGVyZm9udC5zaXplIC89IHNjYWxlO1xufTtcblxuLyoqXG4gKiBTZXQgdGhlIHRoZSB2YWx1ZXMgZm9yIGFsbCB0aGUgY29uZmlndXJhYmxlIHZlcnRpY2FsIHNwYWNlIG9wdGlvbnMuXG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5pbml0VmVydGljYWxTcGFjZSA9IGZ1bmN0aW9uKCkge1xuXHQvLyBjb252ZXJzaW9uOiAzNy43OTUzID0gY29udmVyc2lvbiBmYWN0b3IgZm9yIGNtIHRvIHB4LlxuXHQvLyBBbGwgb2YgdGhlIGZvbGxvd2luZyB2YWx1ZXMgYXJlIGluIHB4LlxuXHR0aGlzLnNwYWNpbmcgPSB7XG5cdFx0Y29tcG9zZXI6IDcuNTYsIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgdGhlIGNvbXBvc2VyLlxuXHRcdGdyYWNlQmVmb3JlOiA4LjY3LCAvLyBEZWZpbmUgdGhlIHNwYWNlIGJlZm9yZSwgaW5zaWRlIGFuZCBhZnRlciB0aGUgZ3JhY2Ugbm90ZXMuXG5cdFx0Z3JhY2VJbnNpZGU6IDEwLjY3LFxuXHRcdGdyYWNlQWZ0ZXI6IDE2LFxuXHRcdGluZm86IDAsIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgdGhlIGluZm9saW5lLlxuXHRcdGxpbmVTa2lwRmFjdG9yOiAxLjEsIC8vIFNldCB0aGUgZmFjdG9yIGZvciBzcGFjaW5nIGJldHdlZW4gbGluZXMgb2YgdGV4dC4gKG11bHRpcGx5IHRoaXMgYnkgdGhlIGZvbnQgc2l6ZSlcblx0XHRtdXNpYzogNy41NiwgLy8gU2V0IHRoZSB2ZXJ0aWNhbCBzcGFjZSBhYm92ZSB0aGUgZmlyc3Qgc3RhZmYuXG5cdFx0cGFyYWdyYXBoU2tpcEZhY3RvcjogMC40LCAvLyBTZXQgdGhlIGZhY3RvciBmb3Igc3BhY2luZyBiZXR3ZWVuIHRleHQgcGFyYWdyYXBocy4gKG11bHRpcGx5IHRoaXMgYnkgdGhlIGZvbnQgc2l6ZSlcblx0XHRwYXJ0czogMTEuMzMsIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgYSBuZXcgcGFydC5cblx0XHRzbHVySGVpZ2h0OiAxLjAsIC8vIFNldCB0aGUgc2x1ciBoZWlnaHQgZmFjdG9yLlxuXHRcdHN0YWZmU2VwYXJhdGlvbjogNjEuMzMsIC8vIERvIG5vdCBwdXQgYSBzdGFmZiBzeXN0ZW0gY2xvc2VyIHRoYW4gPHVuaXQ+IGZyb20gdGhlIHByZXZpb3VzIHN5c3RlbS5cblx0XHRzdGVtSGVpZ2h0OiAyNi42NysxMCwgLy8gU2V0IHRoZSBzdGVtIGhlaWdodC5cblx0XHRzdWJ0aXRsZTogMy43OCwgLy8gU2V0IHRoZSB2ZXJ0aWNhbCBzcGFjZSBhYm92ZSB0aGUgc3VidGl0bGUuXG5cdFx0c3lzdGVtU3RhZmZTZXBhcmF0aW9uOiA0OCwgLy8gRG8gbm90IHBsYWNlIHRoZSBzdGF2ZXMgY2xvc2VyIHRoYW4gPHVuaXQ+IGluc2lkZSBhIHN5c3RlbS4gKiBUaGlzIHZhbHVlcyBhcHBsaWVzIHRvIGFsbCBzdGF2ZXMgd2hlbiBpbiB0aGUgdHVuZSBoZWFkZXIuIE90aGVyd2lzZSwgaXQgYXBwbGllcyB0byB0aGUgbmV4dCBzdGFmZlxuXHRcdHRleHQ6IDE4LjksIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgdGhlIGhpc3RvcnkuXG5cdFx0dGl0bGU6IDcuNTYsIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgdGhlIHRpdGxlLlxuXHRcdHRvcDogMzAuMjQsIC8vU2V0IHRoZSB2ZXJ0aWNhbCBzcGFjZSBhYm92ZSB0aGUgdHVuZXMgYW5kIG9uIHRoZSB0b3Agb2YgdGhlIGNvbnRpbnVhdGlvbiBwYWdlcy5cblx0XHR2b2NhbDogMzAuNjcsIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgdGhlIGx5cmljcyB1bmRlciB0aGUgc3RhdmVzLlxuXHRcdHdvcmRzOiAwIC8vIFNldCB0aGUgdmVydGljYWwgc3BhY2UgYWJvdmUgdGhlIGx5cmljcyBhdCB0aGUgZW5kIG9mIHRoZSB0dW5lLlxuXHR9O1xuXHQvKlxuXHRUT0RPLVBFUjogSGFuZGxlIHRoZSB4LWNvb3JkaW5hdGUgc3BhY2luZyBpdGVtcywgdG9vLlxubWF4c2hyaW5rIDxmbG9hdD5EZWZhdWx0OiAwLjY1XG5TZXQgaG93IG11Y2ggdG8gY29tcHJlc3MgaG9yaXpvbnRhbGx5IHdoZW4gbXVzaWMgbGluZSBicmVha3NcbmFyZSBhdXRvbWF0aWMuXG48ZmxvYXQ+IG11c3QgYmUgYmV0d2VlbiAwIChuYXR1cmFsIHNwYWNpbmcpXG5hbmQgMSAobWF4IHNocmlua2luZykuXG5cbi8vIFRoaXMgbmV4dCB2YWx1ZSBpcyB1c2VkIHRvIGNvbXB1dGUgdGhlIG5hdHVyYWwgc3BhY2luZyBvZlxuLy8gdGhlIG5vdGVzLiBUaGUgYmFzZSBzcGFjaW5nIG9mIHRoZSBjcm90Y2hldCBpcyBhbHdheXNcbi8vIDQwIHB0cy4gV2hlbiB0aGUgZHVyYXRpb24gb2YgYSBub3RlIHR5cGUgaXMgdHdpY2UgdGhlXG4vLyBkdXJhdGlvbiBvZiBhbiBvdGhlciBub3RlIHR5cGUsIGl0cyBzcGFjaW5nIGlzIG11bHRpcGxpZWRcbi8vIGJ5IHRoaXMgZmFjdG9yLlxuLy8gVGhlIGRlZmF1bHQgdmFsdWUgY2F1c2VzIHRoZSBub3RlIHNwYWNpbmcgdG8gYmUgbXVsdGlwbGllZFxuLy8gYnkgMiB3aGVuIGl0cyBkdXJhdGlvbiBpcyBtdWx0aXBsaWVkIGJ5IDQsIGkuZS4gdGhlXG4vLyBzcGFjZSBvZiB0aGUgc2VtaWJyZXZlIGlzIDgwIHB0cyBhbmQgdGhlIHNwYWNlIG9mIHRoZVxuLy8gc2VtaXF1YXZlciBpcyAyMCBwdHMuXG4vLyBTZXR0aW5nIHRoaXMgdmFsdWUgdG8gMSBzZXRzIGFsbCBub3RlIHNwYWNpbmcgdG8gNDAgcHRzLlxubm90ZVNwYWNpbmdGYWN0b3I6IDEuNDE0LCAvLyBTZXQgdGhlIG5vdGUgc3BhY2luZyBmYWN0b3IgdG8gPGZsb2F0PiAocmFuZ2UgMS4uMikuXG5cbnNjYWxlIDxmbG9hdD4gRGVmYXVsdDogMC43NSBTZXQgdGhlIHBhZ2Ugc2NhbGUgZmFjdG9yLiBOb3RlIHRoYXQgdGhlIGhlYWRlciBhbmQgZm9vdGVyIGFyZSBub3Qgc2NhbGVkLlxuXG5zdHJldGNobGFzdCA8ZmxvYXQ+RGVmYXVsdDogMC44XG5TdHJldGNoIHRoZSBsYXN0IG11c2ljIGxpbmUgb2YgYSB0dW5lIHdoZW4gaXQgZXhjZWVkc1xudGhlIDxmbG9hdD4gZnJhY3Rpb24gb2YgdGhlIHBhZ2Ugd2lkdGguXG48ZmxvYXQ+IHJhbmdlIGlzIDAuMCB0byAxLjAuXG5cdCAqL1xufTtcblxuUmVuZGVyZXIucHJvdG90eXBlLnNldFZlcnRpY2FsU3BhY2UgPSBmdW5jdGlvbihmb3JtYXR0aW5nKSB7XG5cdC8vIGNvbnZlcnNpb24gZnJvbSBwdHMgdG8gcHggNC8zXG5cdGlmIChmb3JtYXR0aW5nLnN0YWZmc2VwICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5zcGFjaW5nLnN0YWZmU2VwYXJhdGlvbiA9IGZvcm1hdHRpbmcuc3RhZmZzZXAgKjQvMztcblx0aWYgKGZvcm1hdHRpbmcuY29tcG9zZXJzcGFjZSAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMuc3BhY2luZy5jb21wb3NlciA9IGZvcm1hdHRpbmcuY29tcG9zZXJzcGFjZSAqNC8zO1xuXHRpZiAoZm9ybWF0dGluZy5wYXJ0c3NwYWNlICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5zcGFjaW5nLnBhcnRzID0gZm9ybWF0dGluZy5wYXJ0c3NwYWNlICo0LzM7XG5cdGlmIChmb3JtYXR0aW5nLnRleHRzcGFjZSAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMuc3BhY2luZy50ZXh0ID0gZm9ybWF0dGluZy50ZXh0c3BhY2UgKjQvMztcblx0aWYgKGZvcm1hdHRpbmcubXVzaWNzcGFjZSAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMuc3BhY2luZy5tdXNpYyA9IGZvcm1hdHRpbmcubXVzaWNzcGFjZSAqNC8zO1xuXHRpZiAoZm9ybWF0dGluZy50aXRsZXNwYWNlICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5zcGFjaW5nLnRpdGxlID0gZm9ybWF0dGluZy50aXRsZXNwYWNlICo0LzM7XG5cdGlmIChmb3JtYXR0aW5nLnN5c3N0YWZmc2VwICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5zcGFjaW5nLnN5c3RlbVN0YWZmU2VwYXJhdGlvbiA9IGZvcm1hdHRpbmcuc3lzc3RhZmZzZXAgKjQvMztcblx0aWYgKGZvcm1hdHRpbmcuc3VidGl0bGVzcGFjZSAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMuc3BhY2luZy5zdWJ0aXRsZSA9IGZvcm1hdHRpbmcuc3VidGl0bGVzcGFjZSAqNC8zO1xuXHRpZiAoZm9ybWF0dGluZy50b3BzcGFjZSAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMuc3BhY2luZy50b3AgPSBmb3JtYXR0aW5nLnRvcHNwYWNlICo0LzM7XG5cdGlmIChmb3JtYXR0aW5nLnZvY2Fsc3BhY2UgIT09IHVuZGVmaW5lZClcblx0XHR0aGlzLnNwYWNpbmcudm9jYWwgPSBmb3JtYXR0aW5nLnZvY2Fsc3BhY2UgKjQvMztcblx0aWYgKGZvcm1hdHRpbmcud29yZHNzcGFjZSAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMuc3BhY2luZy53b3JkcyA9IGZvcm1hdHRpbmcud29yZHNzcGFjZSAqNC8zO1xufTtcblxuLyoqXG4gKiBMZWF2ZSBzcGFjZSBhdCB0aGUgdG9wIG9mIHRoZSBwYXBlclxuICogQHBhcmFtIHtvYmplY3R9IGFiY3R1bmVcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLnRvcE1hcmdpbiA9IGZ1bmN0aW9uKGFiY3R1bmUpIHtcblx0XHR0aGlzLm1vdmVZKHRoaXMucGFkZGluZy50b3ApO1xufTtcblxuLyoqXG4gKiBMZWF2ZSBzcGFjZSBiZWZvcmUgcHJpbnRpbmcgdGhlIG11c2ljXG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5hZGRNdXNpY1BhZGRpbmcgPSBmdW5jdGlvbigpIHtcblx0XHR0aGlzLm1vdmVZKHRoaXMuc3BhY2luZy5tdXNpYyk7XG59O1xuXG4vKipcbiAqIExlYXZlIHNwYWNlIGJlZm9yZSBwcmludGluZyBhIHN0YWZmIHN5c3RlbVxuICovXG5SZW5kZXJlci5wcm90b3R5cGUuYWRkU3RhZmZQYWRkaW5nID0gZnVuY3Rpb24obGFzdFN0YWZmR3JvdXAsIHRoaXNTdGFmZkdyb3VwKSB7XG5cdHZhciBsYXN0U3RhZmYgPSBsYXN0U3RhZmZHcm91cC5zdGFmZnNbbGFzdFN0YWZmR3JvdXAuc3RhZmZzLmxlbmd0aC0xXTtcblx0dmFyIGxhc3RCb3R0b21MaW5lID0gLShsYXN0U3RhZmYuYm90dG9tIC0gMik7IC8vIFRoZSAyIGlzIGJlY2F1c2UgdGhlIHNjYWxlIGdvZXMgdG8gMiBiZWxvdyB0aGUgbGFzdCBsaW5lLlxuXHR2YXIgbmV4dFRvcExpbmUgPSB0aGlzU3RhZmZHcm91cC5zdGFmZnNbMF0udG9wIC0gMTA7IC8vIEJlY2F1c2UgMTAgcmVwcmVzZW50cyB0aGUgdG9wIGxpbmUuXG5cdHZhciBuYXR1cmFsU2VwYXJhdGlvbiA9IG5leHRUb3BMaW5lICsgbGFzdEJvdHRvbUxpbmU7IC8vIFRoaXMgaXMgaG93IGZhciBhcGFydCB0aGV5J2QgYmUgd2l0aG91dCBleHRyYSBzcGFjaW5nXG5cdHZhciBzZXBhcmF0aW9uSW5QaXhlbHMgPSBuYXR1cmFsU2VwYXJhdGlvbiAqIHNwYWNpbmcuU1RFUDtcblx0aWYgKHNlcGFyYXRpb25JblBpeGVscyA8IHRoaXMuc3BhY2luZy5zdGFmZlNlcGFyYXRpb24pXG5cdFx0dGhpcy5tb3ZlWSh0aGlzLnNwYWNpbmcuc3RhZmZTZXBhcmF0aW9uLXNlcGFyYXRpb25JblBpeGVscyk7XG59O1xuXG4vKipcbiAqIFRleHQgdGhhdCBnb2VzIGFib3ZlIHRoZSBzY29yZVxuICogQHBhcmFtIHtudW1iZXJ9IHdpZHRoXG4gKiBAcGFyYW0ge29iamVjdH0gYWJjdHVuZVxuICovXG5SZW5kZXJlci5wcm90b3R5cGUuZW5ncmF2ZVRvcFRleHQgPSBmdW5jdGlvbih3aWR0aCwgYWJjdHVuZSkge1xuXHRpZiAoYWJjdHVuZS5tZXRhVGV4dC5oZWFkZXIgJiYgdGhpcy5pc1ByaW50KSB7XG5cdFx0Ly8gTm90ZTogd2hldGhlciB0aGVyZSBpcyBhIGhlYWRlciBvciBub3QgZG9lc24ndCBjaGFuZ2UgYW55IG90aGVyIHBvc2l0aW9uaW5nLCBzbyB0aGlzIGRvZXNuJ3QgY2hhbmdlIHRoZSBZLWNvb3JkaW5hdGUuXG5cdFx0Ly8gVGhpcyB0ZXh0IGdvZXMgYWJvdmUgdGhlIG1hcmdpbiwgc28gd2UnbGwgdGVtcG9yYXJpbHkgbW92ZSB1cC5cblx0XHR2YXIgaGVhZGVyVGV4dEhlaWdodCA9IHRoaXMuZ2V0VGV4dFNpemUoXCJYWFhYXCIsIFwiaGVhZGVyZm9udFwiLCAnYWJjanMtaGVhZGVyIGFiY2pzLW1ldGEtdG9wJykuaGVpZ2h0O1xuXHRcdHRoaXMueSAtPWhlYWRlclRleHRIZWlnaHQ7XG5cdFx0dGhpcy5vdXRwdXRUZXh0SWYodGhpcy5wYWRkaW5nLmxlZnQsIGFiY3R1bmUubWV0YVRleHQuaGVhZGVyLmxlZnQsICdoZWFkZXJmb250JywgJ2hlYWRlciBtZXRhLXRvcCcsIDAsIG51bGwsICdzdGFydCcpO1xuXHRcdHRoaXMub3V0cHV0VGV4dElmKHRoaXMucGFkZGluZy5sZWZ0ICsgd2lkdGggLyAyLCBhYmN0dW5lLm1ldGFUZXh0LmhlYWRlci5jZW50ZXIsICdoZWFkZXJmb250JywgJ2hlYWRlciBtZXRhLXRvcCcsIDAsIG51bGwsICdtaWRkbGUnKTtcblx0XHR0aGlzLm91dHB1dFRleHRJZih0aGlzLnBhZGRpbmcubGVmdCArIHdpZHRoLCBhYmN0dW5lLm1ldGFUZXh0LmhlYWRlci5yaWdodCwgJ2hlYWRlcmZvbnQnLCAnaGVhZGVyIG1ldGEtdG9wJywgMCwgbnVsbCwgJ2VuZCcpO1xuXHRcdHRoaXMueSArPSBoZWFkZXJUZXh0SGVpZ2h0O1xuXHR9XG5cdGlmICh0aGlzLmlzUHJpbnQpXG5cdFx0dGhpcy5tb3ZlWSh0aGlzLnNwYWNpbmcudG9wKTtcblx0dGhpcy5vdXRwdXRUZXh0SWYodGhpcy5wYWRkaW5nLmxlZnQgKyB3aWR0aCAvIDIsIGFiY3R1bmUubWV0YVRleHQudGl0bGUsICd0aXRsZWZvbnQnLCAndGl0bGUgbWV0YS10b3AnLCB0aGlzLnNwYWNpbmcudGl0bGUsIDAsICdtaWRkbGUnKTtcblx0aWYgKGFiY3R1bmUubGluZXNbMF0pXG5cdFx0dGhpcy5vdXRwdXRUZXh0SWYodGhpcy5wYWRkaW5nLmxlZnQgKyB3aWR0aCAvIDIsIGFiY3R1bmUubGluZXNbMF0uc3VidGl0bGUsICdzdWJ0aXRsZWZvbnQnLCAndGV4dCBtZXRhLXRvcCcsIHRoaXMuc3BhY2luZy5zdWJ0aXRsZSwgMCwgJ21pZGRsZScpO1xuXG5cdGlmIChhYmN0dW5lLm1ldGFUZXh0LnJoeXRobSB8fCBhYmN0dW5lLm1ldGFUZXh0Lm9yaWdpbiB8fCBhYmN0dW5lLm1ldGFUZXh0LmNvbXBvc2VyKSB7XG5cdFx0dGhpcy5tb3ZlWSh0aGlzLnNwYWNpbmcuY29tcG9zZXIpO1xuXHRcdHZhciByU3BhY2UgPSB0aGlzLm91dHB1dFRleHRJZih0aGlzLnBhZGRpbmcubGVmdCwgYWJjdHVuZS5tZXRhVGV4dC5yaHl0aG0sICdpbmZvZm9udCcsICdtZXRhLXRvcCcsIDAsIG51bGwsIFwic3RhcnRcIik7XG5cblx0XHR2YXIgY29tcG9zZXJMaW5lID0gXCJcIjtcblx0XHRpZiAoYWJjdHVuZS5tZXRhVGV4dC5jb21wb3NlcikgY29tcG9zZXJMaW5lICs9IGFiY3R1bmUubWV0YVRleHQuY29tcG9zZXI7XG5cdFx0aWYgKGFiY3R1bmUubWV0YVRleHQub3JpZ2luKSBjb21wb3NlckxpbmUgKz0gJyAoJyArIGFiY3R1bmUubWV0YVRleHQub3JpZ2luICsgJyknO1xuXHRcdGlmIChjb21wb3NlckxpbmUubGVuZ3RoID4gMCkge1xuXHRcdFx0dmFyIHNwYWNlID0gdGhpcy5vdXRwdXRUZXh0SWYodGhpcy5wYWRkaW5nLmxlZnQgKyB3aWR0aCwgY29tcG9zZXJMaW5lLCAnY29tcG9zZXJmb250JywgJ21ldGEtdG9wJywgMCwgbnVsbCwgXCJlbmRcIik7XG5cdFx0XHR0aGlzLm1vdmVZKHNwYWNlWzFdKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0dGhpcy5tb3ZlWShyU3BhY2VbMV0pO1xuXHRcdH1cblx0XHQvLyBUT0RPLVBFUjogVGhlIGZvbGxvd2luZyBpcyBhIGhhY2sgdG8gbWFrZSB0aGUgZWxlbWVudHMgbGluZSB1cCB3aXRoIGFiY20ycHMuIERvbid0IGtub3cgd2hlcmUgdGhlIGV4dHJhIHNwYWNlIGlzIGNvbWluZyBmcm9tLlxuXHRcdHRoaXMubW92ZVkoLTYpO1xuXHQvL30gZWxzZSBpZiAodGhpcy5pc1ByaW50KSB7XG5cdC8vXHQvLyBhYmNtMnBzIGFkZHMgdGhpcyBzcGFjZSB3aGV0aGVyIHRoZXJlIGlzIGFueXRoaW5nIHRvIHdyaXRlIG9yIG5vdC5cblx0Ly9cdHRoaXMubW92ZVkodGhpcy5zcGFjaW5nLmNvbXBvc2VyKTtcblx0Ly9cdHZhciBzcGFjZTIgPSB0aGlzLmdldFRleHRTaXplKFwiTVwiLCAnY29tcG9zZXJmb250JywgJ21ldGEtdG9wJyk7XG5cdC8vXHR0aGlzLm1vdmVZKHNwYWNlMi5oZWlnaHQpO1xuXHR9XG5cblx0dGhpcy5vdXRwdXRUZXh0SWYodGhpcy5wYWRkaW5nLmxlZnQgKyB3aWR0aCwgYWJjdHVuZS5tZXRhVGV4dC5hdXRob3IsICdjb21wb3NlcmZvbnQnLCAnbWV0YS10b3AnLCAwLCAwLCBcImVuZFwiKTtcblx0Ly90aGlzLnNraXBTcGFjZVkoKTtcblxuXHR0aGlzLm91dHB1dFRleHRJZih0aGlzLnBhZGRpbmcubGVmdCwgYWJjdHVuZS5tZXRhVGV4dC5wYXJ0T3JkZXIsICdwYXJ0c2ZvbnQnLCAnbWV0YS1ib3R0b20nLCAwLCAwLCBcInN0YXJ0XCIpO1xufTtcblxuLyoqXG4gKiBUZXh0IHRoYXQgZ29lcyBiZWxvdyB0aGUgc2NvcmVcbiAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICogQHBhcmFtIHtvYmplY3R9IGFiY3R1bmVcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLmVuZ3JhdmVFeHRyYVRleHQgPSBmdW5jdGlvbih3aWR0aCwgYWJjdHVuZSkge1xuXHR0aGlzLmxpbmVOdW1iZXIgPSBudWxsO1xuXHR0aGlzLm1lYXN1cmVOdW1iZXIgPSBudWxsO1xuXHR0aGlzLm5vdGVOdW1iZXIgPSBudWxsO1xuXHR0aGlzLnZvaWNlTnVtYmVyID0gbnVsbDtcblxuXHR2YXIgZXh0cmFUZXh0O1xuXHRpZiAoYWJjdHVuZS5tZXRhVGV4dC51bmFsaWduZWRXb3Jkcykge1xuXHRcdGV4dHJhVGV4dCA9IFwiXCI7XG5cdFx0Zm9yICh2YXIgaiA9IDA7IGogPCBhYmN0dW5lLm1ldGFUZXh0LnVuYWxpZ25lZFdvcmRzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHRpZiAodHlwZW9mIGFiY3R1bmUubWV0YVRleHQudW5hbGlnbmVkV29yZHNbal0gPT09ICdzdHJpbmcnKVxuXHRcdFx0XHRleHRyYVRleHQgKz0gYWJjdHVuZS5tZXRhVGV4dC51bmFsaWduZWRXb3Jkc1tqXSArIFwiXFxuXCI7XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0Zm9yICh2YXIgayA9IDA7IGsgPCBhYmN0dW5lLm1ldGFUZXh0LnVuYWxpZ25lZFdvcmRzW2pdLmxlbmd0aDsgaysrKSB7XG5cdFx0XHRcdFx0ZXh0cmFUZXh0ICs9IFwiIEZPTlQgXCIgKyBhYmN0dW5lLm1ldGFUZXh0LnVuYWxpZ25lZFdvcmRzW2pdW2tdLnRleHQ7XG5cdFx0XHRcdH1cblx0XHRcdFx0ZXh0cmFUZXh0ICs9IFwiXFxuXCI7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdHRoaXMub3V0cHV0VGV4dElmKHRoaXMucGFkZGluZy5sZWZ0ICsgc3BhY2luZy5JTkRFTlQsIGV4dHJhVGV4dCwgJ3dvcmRzZm9udCcsICdtZXRhLWJvdHRvbScsIHRoaXMuc3BhY2luZy53b3JkcywgMiwgXCJzdGFydFwiKTtcblx0fVxuXG5cdGV4dHJhVGV4dCA9IFwiXCI7XG5cdGlmIChhYmN0dW5lLm1ldGFUZXh0LmJvb2spIGV4dHJhVGV4dCArPSBcIkJvb2s6IFwiICsgYWJjdHVuZS5tZXRhVGV4dC5ib29rICsgXCJcXG5cIjtcblx0aWYgKGFiY3R1bmUubWV0YVRleHQuc291cmNlKSBleHRyYVRleHQgKz0gXCJTb3VyY2U6IFwiICsgYWJjdHVuZS5tZXRhVGV4dC5zb3VyY2UgKyBcIlxcblwiO1xuXHRpZiAoYWJjdHVuZS5tZXRhVGV4dC5kaXNjb2dyYXBoeSkgZXh0cmFUZXh0ICs9IFwiRGlzY29ncmFwaHk6IFwiICsgYWJjdHVuZS5tZXRhVGV4dC5kaXNjb2dyYXBoeSArIFwiXFxuXCI7XG5cdGlmIChhYmN0dW5lLm1ldGFUZXh0Lm5vdGVzKSBleHRyYVRleHQgKz0gXCJOb3RlczogXCIgKyBhYmN0dW5lLm1ldGFUZXh0Lm5vdGVzICsgXCJcXG5cIjtcblx0aWYgKGFiY3R1bmUubWV0YVRleHQudHJhbnNjcmlwdGlvbikgZXh0cmFUZXh0ICs9IFwiVHJhbnNjcmlwdGlvbjogXCIgKyBhYmN0dW5lLm1ldGFUZXh0LnRyYW5zY3JpcHRpb24gKyBcIlxcblwiO1xuXHRpZiAoYWJjdHVuZS5tZXRhVGV4dC5oaXN0b3J5KSBleHRyYVRleHQgKz0gXCJIaXN0b3J5OiBcIiArIGFiY3R1bmUubWV0YVRleHQuaGlzdG9yeSArIFwiXFxuXCI7XG5cdGlmIChhYmN0dW5lLm1ldGFUZXh0WydhYmMtY29weXJpZ2h0J10pIGV4dHJhVGV4dCArPSBcIkNvcHlyaWdodDogXCIgKyBhYmN0dW5lLm1ldGFUZXh0WydhYmMtY29weXJpZ2h0J10gKyBcIlxcblwiO1xuXHRpZiAoYWJjdHVuZS5tZXRhVGV4dFsnYWJjLWNyZWF0b3InXSkgZXh0cmFUZXh0ICs9IFwiQ3JlYXRvcjogXCIgKyBhYmN0dW5lLm1ldGFUZXh0WydhYmMtY3JlYXRvciddICsgXCJcXG5cIjtcblx0aWYgKGFiY3R1bmUubWV0YVRleHRbJ2FiYy1lZGl0ZWQtYnknXSkgZXh0cmFUZXh0ICs9IFwiRWRpdGVkIEJ5OiBcIiArIGFiY3R1bmUubWV0YVRleHRbJ2FiYy1lZGl0ZWQtYnknXSArIFwiXFxuXCI7XG5cdHRoaXMub3V0cHV0VGV4dElmKHRoaXMucGFkZGluZy5sZWZ0LCBleHRyYVRleHQsICdoaXN0b3J5Zm9udCcsICdtZXRhLWJvdHRvbScsIHRoaXMuc3BhY2luZy5pbmZvLCAwLCBcInN0YXJ0XCIpO1xuXG5cdGlmIChhYmN0dW5lLm1ldGFUZXh0LmZvb3RlciAmJiB0aGlzLmlzUHJpbnQpIHtcblx0XHQvLyBOb3RlOiB3aGV0aGVyIHRoZXJlIGlzIGEgZm9vdGVyIG9yIG5vdCBkb2Vzbid0IGNoYW5nZSBhbnkgb3RoZXIgcG9zaXRpb25pbmcsIHNvIHRoaXMgZG9lc24ndCBjaGFuZ2UgdGhlIFktY29vcmRpbmF0ZS5cblx0XHR0aGlzLm91dHB1dFRleHRJZih0aGlzLnBhZGRpbmcubGVmdCwgYWJjdHVuZS5tZXRhVGV4dC5mb290ZXIubGVmdCwgJ2Zvb3RlcmZvbnQnLCAnaGVhZGVyIG1ldGEtYm90dG9tJywgMCwgbnVsbCwgJ3N0YXJ0Jyk7XG5cdFx0dGhpcy5vdXRwdXRUZXh0SWYodGhpcy5wYWRkaW5nLmxlZnQgKyB3aWR0aCAvIDIsIGFiY3R1bmUubWV0YVRleHQuZm9vdGVyLmNlbnRlciwgJ2Zvb3RlcmZvbnQnLCAnaGVhZGVyIG1ldGEtYm90dG9tJywgMCwgbnVsbCwgJ21pZGRsZScpO1xuXHRcdHRoaXMub3V0cHV0VGV4dElmKHRoaXMucGFkZGluZy5sZWZ0ICsgd2lkdGgsIGFiY3R1bmUubWV0YVRleHQuZm9vdGVyLnJpZ2h0LCAnZm9vdGVyZm9udCcsICdoZWFkZXIgbWV0YS1ib3R0b20nLCAwLCBudWxsLCAnZW5kJyk7XG5cdH1cbn07XG5cbi8qKlxuICogT3V0cHV0IHRleHQgZGVmaW5lZCB3aXRoICUldGV4dC5cbiAqIEBwYXJhbSB7YXJyYXkgb3Igc3RyaW5nfSB0ZXh0XG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5vdXRwdXRGcmVlVGV4dCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG5cdGlmICh0ZXh0ID09PSBcIlwiKSB7XHQvLyB3ZSBkbyB3YW50IHRvIHByaW50IG91dCBibGFuayBsaW5lcyBpZiB0aGV5IGhhdmUgYmVlbiBzcGVjaWZpZWQuXG5cdFx0dmFyIGhhc2ggPSB0aGlzLmdldEZvbnRBbmRBdHRyKCd0ZXh0Zm9udCcsICdkZWZpbmVkLXRleHQnKTtcblx0XHR0aGlzLm1vdmVZKGhhc2guYXR0clsnZm9udC1zaXplJ10gKiAyKTsgLy8gbW92ZSB0aGUgZGlzdGFuY2Ugb2YgdGhlIGxpbmUsIHBsdXMgdGhlIGRpc3RhbmNlIG9mIHRoZSBtYXJnaW4sIHdoaWNoIGlzIGFsc28gb25lIGxpbmUuXG5cdH0gZWxzZSBpZiAodHlwZW9mIHRleHQgPT09ICdzdHJpbmcnKVxuXHRcdHRoaXMub3V0cHV0VGV4dElmKHRoaXMucGFkZGluZy5sZWZ0LCB0ZXh0LCAndGV4dGZvbnQnLCAnZGVmaW5lZC10ZXh0JywgMCwgMSwgXCJzdGFydFwiKTtcblx0ZWxzZSB7XG5cdFx0dmFyIHN0ciA9IFwiXCI7XG5cdFx0dmFyIGlzQ2VudGVyZWQgPSBmYWxzZTsgLy8gVGhlIHN0cnVjdHVyZSBpcyB3cm9uZyBoZXJlOiBpdCByZXF1aXJlcyBhbiBhcnJheSB0byBkbyBjZW50ZXJpbmcsIGJ1dCBpdCBzaG91bGRuJ3QgaGF2ZS5cblx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRleHQubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmICh0ZXh0W2ldLmZvbnQpXG5cdFx0XHRcdHN0ciArPSBcIkZPTlQoXCIgKyB0ZXh0W2ldLmZvbnQgKyBcIilcIjtcblx0XHRcdHN0ciArPSB0ZXh0W2ldLnRleHQ7XG5cdFx0XHRpZiAodGV4dFtpXS5jZW50ZXIpXG5cdFx0XHRcdGlzQ2VudGVyZWQgPSB0cnVlO1xuXHRcdH1cblx0XHR2YXIgYWxpZ25tZW50ID0gaXNDZW50ZXJlZCA/ICdtaWRkbGUnIDogJ3N0YXJ0Jztcblx0XHR2YXIgeCA9IGlzQ2VudGVyZWQgPyB0aGlzLmNvbnRyb2xsZXIud2lkdGggLyAyIDogdGhpcy5wYWRkaW5nLmxlZnQ7XG5cdFx0dGhpcy5vdXRwdXRUZXh0SWYoeCwgc3RyLCAndGV4dGZvbnQnLCAnZGVmaW5lZC10ZXh0JywgMCwgMSwgYWxpZ25tZW50KTtcblx0fVxufTtcblxuLyoqXG4gKiBPdXRwdXQgYW4gZXh0cmEgc3VidGl0bGUgdGhhdCBpcyBkZWZpbmVkIGxhdGVyIGluIHRoZSB0dW5lLlxuICovXG5SZW5kZXJlci5wcm90b3R5cGUub3V0cHV0U3VidGl0bGUgPSBmdW5jdGlvbiAod2lkdGgsIHN1YnRpdGxlKSB7XG5cdHRoaXMub3V0cHV0VGV4dElmKHRoaXMucGFkZGluZy5sZWZ0ICsgd2lkdGggLyAyLCBzdWJ0aXRsZSwgJ3N1YnRpdGxlZm9udCcsICd0ZXh0IG1ldGEtdG9wJywgdGhpcy5zcGFjaW5nLnN1YnRpdGxlLCAwLCAnbWlkZGxlJyk7XG59O1xuXG4vKipcbiAqIEJlZ2luIGEgZ3JvdXAgb2YgZ2x5cGhzIHRoYXQgd2lsbCBhbHdheXMgYmUgbW92ZWQsIHNjYWxlZCBhbmQgaGlnaGxpZ2h0ZWQgdG9nZXRoZXJcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLmJlZ2luR3JvdXAgPSBmdW5jdGlvbiAoKSB7XG4gIHRoaXMucGF0aCA9IFtdO1xuICB0aGlzLmxhc3RNID0gWzAsMF07XG4gIHRoaXMuaW5ncm91cCA9IHRydWU7XG59O1xuXG4vKipcbiAqIEFkZCBhIHBhdGggdG8gdGhlIGN1cnJlbnQgZ3JvdXBcbiAqIEBwYXJhbSB7QXJyYXl9IHBhdGhcbiAqIEBwcml2YXRlXG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5hZGRQYXRoID0gZnVuY3Rpb24gKHBhdGgpIHtcbiAgcGF0aCA9IHBhdGggfHwgW107XG4gIGlmIChwYXRoLmxlbmd0aD09PTApIHJldHVybjtcbiAgcGF0aFswXVswXT1cIm1cIjtcbiAgcGF0aFswXVsxXS09dGhpcy5sYXN0TVswXTtcbiAgcGF0aFswXVsyXS09dGhpcy5sYXN0TVsxXTtcbiAgdGhpcy5sYXN0TVswXSs9cGF0aFswXVsxXTtcbiAgdGhpcy5sYXN0TVsxXSs9cGF0aFswXVsyXTtcbiAgdGhpcy5wYXRoLnB1c2gocGF0aFswXSk7XG4gIGZvciAodmFyIGk9MSxpaT1wYXRoLmxlbmd0aDtpPGlpO2krKykge1xuICAgIGlmIChwYXRoW2ldWzBdPT09XCJtXCIpIHtcbiAgICAgIHRoaXMubGFzdE1bMF0rPXBhdGhbaV1bMV07XG4gICAgICB0aGlzLmxhc3RNWzFdKz1wYXRoW2ldWzJdO1xuICAgIH1cbiAgICB0aGlzLnBhdGgucHVzaChwYXRoW2ldKTtcbiAgfVxufTtcblxuLyoqXG4gKiBFbmQgYSBncm91cCBvZiBnbHlwaHMgdGhhdCB3aWxsIGFsd2F5cyBiZSBtb3ZlZCwgc2NhbGVkIGFuZCBoaWdobGlnaHRlZCB0b2dldGhlclxuICovXG5SZW5kZXJlci5wcm90b3R5cGUuZW5kR3JvdXAgPSBmdW5jdGlvbiAoa2xhc3MpIHtcbiAgdGhpcy5pbmdyb3VwID0gZmFsc2U7XG4gIGlmICh0aGlzLnBhdGgubGVuZ3RoPT09MCkgcmV0dXJuIG51bGw7XG4gIHZhciBwYXRoID0gXCJcIjtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnBhdGgubGVuZ3RoOyBpKyspXG5cdFx0cGF0aCArPSB0aGlzLnBhdGhbaV0uam9pbihcIiBcIik7XG5cdHZhciByZXQgPSB0aGlzLnBhcGVyLnBhdGgoe3BhdGg6IHBhdGgsIHN0cm9rZTpcIm5vbmVcIiwgZmlsbDpcIiMwMDAwMDBcIiwgJ2NsYXNzJzogdGhpcy5hZGRDbGFzc2VzKGtsYXNzKX0pO1xuXHR0aGlzLnBhdGggPSBbXTtcbiAgaWYgKHRoaXMuZG9SZWdyZXNzaW9uKSB0aGlzLmFkZFRvUmVncmVzc2lvbihyZXQpO1xuXG4gIHJldHVybiByZXQ7XG59O1xuXG4vKipcbiAqIGdldHMgc2NhbGVkXG4gKiBAcGFyYW0ge251bWJlcn0geDEgc3RhcnQgeFxuICogQHBhcmFtIHtudW1iZXJ9IHgyIGVuZCB4XG4gKiBAcGFyYW0ge251bWJlcn0gcGl0Y2ggcGl0Y2ggdGhlIHN0YXZlIGxpbmUgaXMgZHJhd24gYXRcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLnByaW50U3RhdmVMaW5lID0gZnVuY3Rpb24gKHgxLHgyLCBwaXRjaCwga2xhc3MpIHtcblx0dmFyIGV4dHJhQ2xhc3MgPSBcInN0YWZmXCI7XG5cdGlmIChrbGFzcyAhPT0gdW5kZWZpbmVkKVxuXHRcdGV4dHJhQ2xhc3MgKz0gXCIgXCIgKyBrbGFzcztcbiAgdmFyIGlzSUU9LypAY2Nfb24hQCovZmFsc2U7Ly9JRSBkZXRlY3RvclxuICB2YXIgZHkgPSAwLjM1O1xuICB2YXIgZmlsbCA9IFwiIzAwMDAwMFwiO1xuICBpZiAoaXNJRSkge1xuICAgIGR5ID0gMTtcbiAgICBmaWxsID0gXCIjNjY2NjY2XCI7XG4gIH1cbiAgdmFyIHkgPSB0aGlzLmNhbGNZKHBpdGNoKTtcbiAgdmFyIHBhdGhTdHJpbmcgPSBzcHJpbnRmKFwiTSAlZiAlZiBMICVmICVmIEwgJWYgJWYgTCAlZiAlZiB6XCIsIHgxLCB5LWR5LCB4MiwgeS1keSxcbiAgICAgeDIsIHkrZHksIHgxLCB5K2R5KTtcbiAgdmFyIHJldCA9IHRoaXMucGFwZXIucGF0aFRvQmFjayh7cGF0aDpwYXRoU3RyaW5nLCBzdHJva2U6XCJub25lXCIsIGZpbGw6ZmlsbCwgJ2NsYXNzJzogdGhpcy5hZGRDbGFzc2VzKGV4dHJhQ2xhc3MpfSk7XG4gIGlmICh0aGlzLmRvUmVncmVzc2lvbikgdGhpcy5hZGRUb1JlZ3Jlc3Npb24ocmV0KTtcblxuICByZXR1cm4gcmV0O1xufTtcblxuLyoqXG4gKiBnZXRzIHNjYWxlZCBpZiBub3QgaW4gYSBncm91cFxuICogQHBhcmFtIHtudW1iZXJ9IHggeCBjb29yZGluYXRlIG9mIHRoZSBzdGVtXG4gKiBAcGFyYW0ge251bWJlcn0gZHggc3RlbSB3aWR0aFxuICogQHBhcmFtIHtudW1iZXJ9IHkxIHkgY29vcmRpbmF0ZSBvZiB0aGUgc3RlbSBib3R0b21cbiAqIEBwYXJhbSB7bnVtYmVyfSB5MiB5IGNvb3JkaW5hdGUgb2YgdGhlIHN0ZW0gdG9wXG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5wcmludFN0ZW0gPSBmdW5jdGlvbiAoeCwgZHgsIHkxLCB5Mikge1xuICBpZiAoZHg8MCkgeyAvLyBjb3JyZWN0IHBhdGggXCJoYW5kZWRuZXNzXCIgZm9yIGludGVyc2VjdGlvbiB3aXRoIG90aGVyIGVsZW1lbnRzXG4gICAgdmFyIHRtcCA9IHkyO1xuICAgIHkyID0geTE7XG4gICAgeTEgPSB0bXA7XG4gIH1cbiAgdmFyIGlzSUU9LypAY2Nfb24hQCovZmFsc2U7Ly9JRSBkZXRlY3RvclxuICB2YXIgZmlsbCA9IFwiIzAwMDAwMFwiO1xuICBpZiAoaXNJRSAmJiBkeDwxKSB7XG4gICAgZHggPSAxO1xuICAgIGZpbGwgPSBcIiM2NjY2NjZcIjtcbiAgfVxuICBpZiAofn54ID09PSB4KSB4Kz0wLjA1OyAvLyByYXBoYWVsIGRvZXMgd2VpcmQgcm91bmRpbmcgKGZvciBWTUwpXG4gIHZhciBwYXRoQXJyYXkgPSBbW1wiTVwiLHgseTFdLFtcIkxcIiwgeCwgeTJdLFtcIkxcIiwgeCtkeCwgeTJdLFtcIkxcIix4K2R4LHkxXSxbXCJ6XCJdXTtcbiAgaWYgKCFpc0lFICYmIHRoaXMuaW5ncm91cCkge1xuICAgIHRoaXMuYWRkUGF0aChwYXRoQXJyYXkpO1xuICB9IGVsc2Uge1xuICBcdHZhciBwYXRoID0gXCJcIjtcbiAgXHRmb3IgKHZhciBpID0gMDsgaSA8IHBhdGhBcnJheS5sZW5ndGg7IGkrKylcbiAgXHRcdHBhdGggKz0gcGF0aEFycmF5W2ldLmpvaW4oXCIgXCIpO1xuICAgIHZhciByZXQgPSB0aGlzLnBhcGVyLnBhdGhUb0JhY2soe3BhdGg6cGF0aCwgc3Ryb2tlOlwibm9uZVwiLCBmaWxsOmZpbGwsICdjbGFzcyc6IHRoaXMuYWRkQ2xhc3Nlcygnc3RlbScpfSk7XG4gICAgaWYgKHRoaXMuZG9SZWdyZXNzaW9uKSB0aGlzLmFkZFRvUmVncmVzc2lvbihyZXQpO1xuXG4gICAgcmV0dXJuIHJldDtcbiAgfVxufTtcblxuZnVuY3Rpb24ga2VyblN5bWJvbHMobGFzdFN5bWJvbCwgdGhpc1N5bWJvbCwgbGFzdFN5bWJvbFdpZHRoKSB7XG5cdC8vIFRoaXMgaXMganVzdCBzb21lIGFkanVzdG1lbnRzIHRvIG1ha2UgaXQgbG9vayBiZXR0ZXIuXG5cdHZhciB3aWR0aCA9IGxhc3RTeW1ib2xXaWR0aDtcblx0aWYgKGxhc3RTeW1ib2wgPT09ICdmJyAmJiB0aGlzU3ltYm9sID09PSAnZicpXG5cdFx0d2lkdGggPSB3aWR0aCoyLzM7XG5cdGlmIChsYXN0U3ltYm9sID09PSAncCcgJiYgdGhpc1N5bWJvbCA9PT0gJ3AnKVxuXHRcdHdpZHRoID0gd2lkdGgqNS82O1xuXHRpZiAobGFzdFN5bWJvbCA9PT0gJ2YnICYmIHRoaXNTeW1ib2wgPT09ICd6Jylcblx0XHR3aWR0aCA9IHdpZHRoKjUvODtcblx0cmV0dXJuIHdpZHRoO1xufVxuXG4vKipcbiAqIGFzc3VtZXMgdGhpcy55IGlzIHNldCBhcHByb3ByaWF0ZWx5XG4gKiBpZiBzeW1ib2wgaXMgYSBtdWx0aWNoYXIgc3RyaW5nIHdpdGhvdXQgYSAuIChhcyBpbiBzY3JpcHRzLnN0YWNjYXRvKSAxIHN5bWJvbCBwZXIgY2hhciBpcyBhc3N1bWVkXG4gKiBub3Qgc2NhbGVkIGlmIG5vdCBpbiBwcmludGdyb3VwXG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5wcmludFN5bWJvbCA9IGZ1bmN0aW9uICh4LCBvZmZzZXQsIHN5bWJvbCwgc2NhbGV4LCBzY2FsZXksIGtsYXNzKSB7XG5cdHZhciBlbDtcblx0dmFyIHljb3JyO1xuXHRpZiAoIXN5bWJvbCkgcmV0dXJuIG51bGw7XG5cdGlmIChzeW1ib2wubGVuZ3RoID4gMSAmJiBzeW1ib2wuaW5kZXhPZihcIi5cIikgPCAwKSB7XG5cdFx0dGhpcy5wYXBlci5vcGVuR3JvdXAoKTtcblx0XHR2YXIgZHggPSAwO1xuXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgc3ltYm9sLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHR2YXIgcyA9IHN5bWJvbC5jaGFyQXQoaSk7XG5cdFx0XHR5Y29yciA9IGdseXBocy5nZXRZQ29ycihzKTtcblx0XHRcdGVsID0gZ2x5cGhzLnByaW50U3ltYm9sKHggKyBkeCwgdGhpcy5jYWxjWShvZmZzZXQgKyB5Y29yciksIHMsIHRoaXMucGFwZXIsIGtsYXNzKTtcblx0XHRcdGlmIChlbCkge1xuXHRcdFx0XHRpZiAodGhpcy5kb1JlZ3Jlc3Npb24pIHRoaXMuYWRkVG9SZWdyZXNzaW9uKGVsKTtcblx0XHRcdFx0Ly9lbGVtc2V0LnB1c2goZWwpO1xuXHRcdFx0XHRpZiAoaSA8IHN5bWJvbC5sZW5ndGggLSAxKVxuXHRcdFx0XHRcdGR4ICs9IGtlcm5TeW1ib2xzKHMsIHN5bWJvbC5jaGFyQXQoaSArIDEpLCBnbHlwaHMuZ2V0U3ltYm9sV2lkdGgocykpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5yZW5kZXJUZXh0KHgsIHRoaXMueSwgXCJubyBzeW1ib2w6XCIgKyBzeW1ib2wsIFwiZGVidWdmb250XCIsICdkZWJ1Zy1tc2cnLCAnc3RhcnQnKTtcblx0XHRcdH1cblx0XHR9XG5cdFx0cmV0dXJuIHRoaXMucGFwZXIuY2xvc2VHcm91cCgpO1xuXHR9IGVsc2Uge1xuXHRcdHljb3JyID0gZ2x5cGhzLmdldFlDb3JyKHN5bWJvbCk7XG5cdFx0aWYgKHRoaXMuaW5ncm91cCkge1xuXHRcdFx0dGhpcy5hZGRQYXRoKGdseXBocy5nZXRQYXRoRm9yU3ltYm9sKHgsIHRoaXMuY2FsY1kob2Zmc2V0ICsgeWNvcnIpLCBzeW1ib2wsIHNjYWxleCwgc2NhbGV5KSk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdGVsID0gZ2x5cGhzLnByaW50U3ltYm9sKHgsIHRoaXMuY2FsY1kob2Zmc2V0ICsgeWNvcnIpLCBzeW1ib2wsIHRoaXMucGFwZXIsIGtsYXNzKTtcblx0XHRcdGlmIChlbCkge1xuXHRcdFx0XHRpZiAodGhpcy5kb1JlZ3Jlc3Npb24pIHRoaXMuYWRkVG9SZWdyZXNzaW9uKGVsKTtcblx0XHRcdFx0cmV0dXJuIGVsO1xuXHRcdFx0fSBlbHNlXG5cdFx0XHRcdHRoaXMucmVuZGVyVGV4dCh4LCB0aGlzLnksIFwibm8gc3ltYm9sOlwiICsgc3ltYm9sLCBcImRlYnVnZm9udFwiLCAnZGVidWctbXNnJywgJ3N0YXJ0Jyk7XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9XG59O1xuXG5SZW5kZXJlci5wcm90b3R5cGUuc2NhbGVFeGlzdGluZ0VsZW0gPSBmdW5jdGlvbiAoZWxlbSwgc2NhbGVYLCBzY2FsZVksIHgsIHkpIHtcblx0dGhpcy5wYXBlci5zZXRBdHRyaWJ1dGVPbkVsZW1lbnQoZWxlbSwgeyBzdHlsZTogXCJ0cmFuc2Zvcm06c2NhbGUoXCIrc2NhbGVYK1wiLFwiK3NjYWxlWSArIFwiKTt0cmFuc2Zvcm0tb3JpZ2luOlwiICsgeCArIFwicHggXCIgKyB5ICsgXCJweDtcIn0pO1xufTtcblxuUmVuZGVyZXIucHJvdG90eXBlLnByaW50UGF0aCA9IGZ1bmN0aW9uIChhdHRycykge1xuICB2YXIgcmV0ID0gdGhpcy5wYXBlci5wYXRoKGF0dHJzKTtcbiAgaWYgKHRoaXMuZG9SZWdyZXNzaW9uKSB0aGlzLmFkZFRvUmVncmVzc2lvbihyZXQpO1xuICByZXR1cm4gcmV0O1xufTtcblxuUmVuZGVyZXIucHJvdG90eXBlLmRyYXdCcmFjZSA9IGZ1bmN0aW9uKHhMZWZ0LCB5VG9wLCB5Qm90dG9tKSB7Ly9Ub255XG5cdHZhciB5SGVpZ2h0ID0geUJvdHRvbSAtIHlUb3A7XG5cblx0dmFyIHhDdXJ2ZSA9IFs3LjUsIC04LCAyMSwgMCwgMTguNSwgLTEwLjUsIDcuNV07XG5cdHZhciB5Q3VydmUgPSBbMCwgeUhlaWdodC81LjUsIHlIZWlnaHQvMy4xNCwgeUhlaWdodC8yLCB5SGVpZ2h0LzIuOTMsIHlIZWlnaHQvNC44OCwgMF07XG5cblx0dmFyIHBhdGhTdHJpbmcgPSBzcHJpbnRmKFwiTSAlZiAlZiBDICVmICVmICVmICVmICVmICVmIEMgJWYgJWYgJWYgJWYgJWYgJWYgelwiLFxuXHRcdHhMZWZ0K3hDdXJ2ZVswXSwgeVRvcCt5Q3VydmVbMF0sXG5cdFx0eExlZnQreEN1cnZlWzFdLCB5VG9wK3lDdXJ2ZVsxXSxcblx0XHR4TGVmdCt4Q3VydmVbMl0sIHlUb3AreUN1cnZlWzJdLFxuXHRcdHhMZWZ0K3hDdXJ2ZVszXSwgeVRvcCt5Q3VydmVbM10sXG5cdFx0eExlZnQreEN1cnZlWzRdLCB5VG9wK3lDdXJ2ZVs0XSxcblx0XHR4TGVmdCt4Q3VydmVbNV0sIHlUb3AreUN1cnZlWzVdLFxuXHRcdHhMZWZ0K3hDdXJ2ZVs2XSwgeVRvcCt5Q3VydmVbNl0pO1xuXHR2YXIgcmV0MSA9IHRoaXMucGFwZXIucGF0aCh7cGF0aDpwYXRoU3RyaW5nLCBzdHJva2U6XCIjMDAwMDAwXCIsIGZpbGw6XCIjMDAwMDAwXCIsICdjbGFzcyc6IHRoaXMuYWRkQ2xhc3NlcygnYnJhY2UnKX0pO1xuXG5cdHhDdXJ2ZSA9IFswLCAxNy41LCAtNy41LCA2LjYsIC01LCAyMCwgMF07XG5cdHlDdXJ2ZSA9IFt5SGVpZ2h0LzIsIHlIZWlnaHQvMS40NiwgeUhlaWdodC8xLjIyLCB5SGVpZ2h0LCB5SGVpZ2h0LzEuMTksIHlIZWlnaHQvMS40MiwgeUhlaWdodC8yXTtcblxuXHRwYXRoU3RyaW5nID0gc3ByaW50ZihcIk0gJWYgJWYgQyAlZiAlZiAlZiAlZiAlZiAlZiBDICVmICVmICVmICVmICVmICVmIHpcIixcblx0XHR4TGVmdCt4Q3VydmVbIDBdLCB5VG9wK3lDdXJ2ZVswXSxcblx0XHR4TGVmdCt4Q3VydmVbMV0sIHlUb3AreUN1cnZlWzFdLFxuXHRcdHhMZWZ0K3hDdXJ2ZVsyXSwgeVRvcCt5Q3VydmVbMl0sXG5cdFx0eExlZnQreEN1cnZlWzNdLCB5VG9wK3lDdXJ2ZVszXSxcblx0XHR4TGVmdCt4Q3VydmVbNF0sIHlUb3AreUN1cnZlWzRdLFxuXHRcdHhMZWZ0K3hDdXJ2ZVs1XSwgeVRvcCt5Q3VydmVbNV0sXG5cdFx0eExlZnQreEN1cnZlWzZdLCB5VG9wK3lDdXJ2ZVs2XSk7XG5cdHZhciByZXQyID0gdGhpcy5wYXBlci5wYXRoKHtwYXRoOnBhdGhTdHJpbmcsIHN0cm9rZTpcIiMwMDAwMDBcIiwgZmlsbDpcIiMwMDAwMDBcIiwgJ2NsYXNzJzogdGhpcy5hZGRDbGFzc2VzKCdicmFjZScpfSk7XG5cblx0aWYgKHRoaXMuZG9SZWdyZXNzaW9uKXtcblx0XHR0aGlzLmFkZFRvUmVncmVzc2lvbihyZXQxKTtcblx0XHR0aGlzLmFkZFRvUmVncmVzc2lvbihyZXQyKTtcblx0fVxuXHRyZXR1cm4gcmV0MSArIHJldDI7XG59O1xuXG5SZW5kZXJlci5wcm90b3R5cGUuZHJhd0FyYyA9IGZ1bmN0aW9uKHgxLCB4MiwgcGl0Y2gxLCBwaXRjaDIsIGFib3ZlLCBrbGFzcywgaXNUaWUpIHtcblx0Ly8gSWYgaXQgaXMgYSB0aWUgdnMuIGEgc2x1ciwgZHJhdyBpdCBzaGFsbG93ZXIuXG5cdHZhciBzcGFjaW5nID0gaXNUaWUgPyAxLjIgOiAxLjU7XG5cbiAgeDEgPSB4MSArIDY7XG4gIHgyID0geDIgKyA0O1xuICBwaXRjaDEgPSBwaXRjaDEgKyAoKGFib3ZlKT9zcGFjaW5nOi1zcGFjaW5nKTtcbiAgcGl0Y2gyID0gcGl0Y2gyICsgKChhYm92ZSk/c3BhY2luZzotc3BhY2luZyk7XG4gIHZhciB5MSA9IHRoaXMuY2FsY1kocGl0Y2gxKTtcbiAgdmFyIHkyID0gdGhpcy5jYWxjWShwaXRjaDIpO1xuXG4gIC8vdW5pdCBkaXJlY3Rpb24gdmVjdG9yXG4gIHZhciBkeCA9IHgyLXgxO1xuICB2YXIgZHkgPSB5Mi15MTtcbiAgdmFyIG5vcm09IE1hdGguc3FydChkeCpkeCtkeSpkeSk7XG4gIHZhciB1eCA9IGR4L25vcm07XG4gIHZhciB1eSA9IGR5L25vcm07XG5cbiAgdmFyIGZsYXR0ZW4gPSBub3JtLzMuNTtcbiAgdmFyIG1heEZsYXR0ZW4gPSBpc1RpZSA/IDEwIDogMjU7ICAvLyBJZiBpdCBpcyBhIHRpZSB2cy4gYSBzbHVyLCBkcmF3IGl0IHNoYWxsb3dlci5cbiAgdmFyIGN1cnZlID0gKChhYm92ZSk/LTE6MSkqTWF0aC5taW4obWF4RmxhdHRlbiwgTWF0aC5tYXgoNCwgZmxhdHRlbikpO1xuXG4gIHZhciBjb250cm9seDEgPSB4MStmbGF0dGVuKnV4LWN1cnZlKnV5O1xuICB2YXIgY29udHJvbHkxID0geTErZmxhdHRlbip1eStjdXJ2ZSp1eDtcbiAgdmFyIGNvbnRyb2x4MiA9IHgyLWZsYXR0ZW4qdXgtY3VydmUqdXk7XG4gIHZhciBjb250cm9seTIgPSB5Mi1mbGF0dGVuKnV5K2N1cnZlKnV4O1xuICB2YXIgdGhpY2tuZXNzID0gMjtcbiAgdmFyIHBhdGhTdHJpbmcgPSBzcHJpbnRmKFwiTSAlZiAlZiBDICVmICVmICVmICVmICVmICVmIEMgJWYgJWYgJWYgJWYgJWYgJWYgelwiLCB4MSwgeTEsXG4gICAgIGNvbnRyb2x4MSwgY29udHJvbHkxLCBjb250cm9seDIsIGNvbnRyb2x5MiwgeDIsIHkyLFxuICAgICBjb250cm9seDItdGhpY2tuZXNzKnV5LCBjb250cm9seTIrdGhpY2tuZXNzKnV4LCBjb250cm9seDEtdGhpY2tuZXNzKnV5LCBjb250cm9seTErdGhpY2tuZXNzKnV4LCB4MSwgeTEpO1xuXHRpZiAoa2xhc3MpXG5cdFx0a2xhc3MgKz0gJyBzbHVyJztcblx0ZWxzZVxuXHRcdGtsYXNzID0gJ3NsdXInO1xuICB2YXIgcmV0ID0gdGhpcy5wYXBlci5wYXRoKHtwYXRoOnBhdGhTdHJpbmcsIHN0cm9rZTpcIm5vbmVcIiwgZmlsbDpcIiMwMDAwMDBcIiwgJ2NsYXNzJzogdGhpcy5hZGRDbGFzc2VzKGtsYXNzKX0pO1xuICBpZiAodGhpcy5kb1JlZ3Jlc3Npb24pIHRoaXMuYWRkVG9SZWdyZXNzaW9uKHJldCk7XG5cbiAgcmV0dXJuIHJldDtcbn07XG4vKipcbiAqIENhbGN1bGF0ZXMgdGhlIHkgZm9yIGEgZ2l2ZW4gcGl0Y2ggdmFsdWUgKHJlbGF0aXZlIHRvIHRoZSBzdGF2ZSB0aGUgcmVuZGVyZXIgaXMgY3VycmVudGx5IHByaW50aW5nKVxuICogQHBhcmFtIHtudW1iZXJ9IG9mcyBwaXRjaCB2YWx1ZSAoYm90dG9tIEMgb24gYSBHIGNsZWYgPSAwLCBEPTEsIGV0Yy4pXG4gKi9cblJlbmRlcmVyLnByb3RvdHlwZS5jYWxjWSA9IGZ1bmN0aW9uKG9mcykge1xuICByZXR1cm4gdGhpcy55IC0gb2ZzKnNwYWNpbmcuU1RFUDtcbn07XG5cbi8qKlxuICogUHJpbnQgQHBhcmFtIHtudW1iZXJ9IG51bUxpbmVzLiBJZiB0aGVyZSBpcyAxIGxpbmUgaXQgaXMgdGhlIEIgbGluZS4gT3RoZXJ3aXNlIHRoZSBib3R0b20gbGluZSBpcyB0aGUgRSBsaW5lLlxuICovXG5SZW5kZXJlci5wcm90b3R5cGUucHJpbnRTdGF2ZSA9IGZ1bmN0aW9uIChzdGFydHgsIGVuZHgsIG51bUxpbmVzKSB7XG5cdHZhciBrbGFzcyA9IFwidG9wLWxpbmVcIjtcblx0dGhpcy5wYXBlci5vcGVuR3JvdXAoeyBwcmVwZW5kOiB0cnVlIH0pO1xuXHQvLyBJZiB0aGVyZSBpcyBvbmUgbGluZSwgaXQgaXMgdGhlIEIgbGluZS4gT3RoZXJ3aXNlLCB0aGUgYm90dG9tIGxpbmUgaXMgdGhlIEUgbGluZS5cblx0aWYgKG51bUxpbmVzID09PSAxKSB7XG5cdFx0dGhpcy5wcmludFN0YXZlTGluZShzdGFydHgsZW5keCw2LCBrbGFzcyk7XG5cdFx0cmV0dXJuO1xuXHR9XG5cdGZvciAodmFyIGkgPSBudW1MaW5lcy0xOyBpID49IDA7IGktLSkge1xuXHRcdHRoaXMucHJpbnRTdGF2ZUxpbmUoc3RhcnR4LGVuZHgsKGkrMSkqMiwga2xhc3MpO1xuXHRcdGtsYXNzID0gdW5kZWZpbmVkO1xuXHR9XG5cdHRoaXMucGFwZXIuY2xvc2VHcm91cCgpO1xufTtcblxuLyoqXG4gKlxuICogQHByaXZhdGVcbiAqL1xuUmVuZGVyZXIucHJvdG90eXBlLmFkZENsYXNzZXMgPSBmdW5jdGlvbiAoYywgaXNOb3RlKSB7XG5cdGlmICghdGhpcy5zaG91bGRBZGRDbGFzc2VzKVxuXHRcdHJldHVybiBcIlwiO1xuXHR2YXIgcmV0ID0gW107XG5cdGlmIChjLmxlbmd0aCA+IDApIHJldC5wdXNoKGMpO1xuXHRpZiAodGhpcy5saW5lTnVtYmVyICE9PSBudWxsICYmIHRoaXMubGluZU51bWJlciAhPT0gdW5kZWZpbmVkKSByZXQucHVzaChcImxcIit0aGlzLmxpbmVOdW1iZXIpO1xuXHRpZiAodGhpcy5tZWFzdXJlTnVtYmVyICE9PSBudWxsICYmIHRoaXMubWVhc3VyZU51bWJlciAhPT0gdW5kZWZpbmVkKSByZXQucHVzaChcIm1cIit0aGlzLm1lYXN1cmVOdW1iZXIpO1xuXHRpZiAodGhpcy52b2ljZU51bWJlciAhPT0gbnVsbCAmJiB0aGlzLnZvaWNlTnVtYmVyICE9PSB1bmRlZmluZWQpIHJldC5wdXNoKFwidlwiK3RoaXMudm9pY2VOdW1iZXIpO1xuXHRpZiAoKGMuaW5kZXhPZignbm90ZScpID49IDAgfHwgYy5pbmRleE9mKCdyZXN0JykgPj0gMCkgJiYgdGhpcy5ub3RlTnVtYmVyICE9PSBudWxsICYmIHRoaXMubm90ZU51bWJlciAhPT0gdW5kZWZpbmVkKSByZXQucHVzaChcIm5cIit0aGlzLm5vdGVOdW1iZXIpO1xuXHQvLyBhZGQgYSBwcmVmaXggdG8gYWxsIGNsYXNzZXMgdGhhdCBhYmNqcyBhZGRzLlxuXHRpZiAocmV0Lmxlbmd0aCA+IDApIHtcblx0XHRyZXQgPSByZXQuam9pbignICcpOyAvLyBTb21lIHN0cmluZ3MgYXJlIGNvbXBvdW5kIGNsYXNzZXMgLSB0aGF0IGlzLCBzcGVjaWZ5IG1vcmUgdGhhbiBvbmUgY2xhc3MgaW4gYSBzdHJpbmcuXG5cdFx0cmV0ID0gcmV0LnNwbGl0KCcgJyk7XG5cdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCByZXQubGVuZ3RoOyBpKyspIHtcblx0XHRcdGlmIChyZXRbaV0uaW5kZXhPZignYWJjanMtJykgIT09IDAgJiYgcmV0W2ldLmxlbmd0aCA+IDApIC8vIGlmIHRoZSBwcmVmaXggZG9lc24ndCBhbHJlYWR5IGV4aXN0IGFuZCB0aGUgY2xhc3MgaXMgbm90IGJsYW5rLlxuXHRcdFx0XHRyZXRbaV0gPSAnYWJjanMtJyArIHJldFtpXTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJldC5qb2luKCcgJyk7XG59O1xuXG5SZW5kZXJlci5wcm90b3R5cGUuZ2V0Rm9udEFuZEF0dHIgPSBmdW5jdGlvbih0eXBlLCBrbGFzcykge1xuXHR2YXIgZm9udCA9IHRoaXMuYWJjdHVuZS5mb3JtYXR0aW5nW3R5cGVdO1xuXHQvLyBSYXBoYWVsIGRlbGliZXJhdGVseSBjaGFuZ2VzIHRoZSBmb250IHVuaXRzIHRvIHBpeGVscyBmb3Igc29tZSByZWFzb24sIHNvIHdlIG5lZWQgdG8gY2hhbmdlIHBvaW50cyB0byBwaXhlbHMgaGVyZS5cblx0aWYgKGZvbnQpXG5cdFx0Zm9udCA9IHsgZmFjZTogZm9udC5mYWNlLCBzaXplOiBmb250LnNpemUqNC8zLCBkZWNvcmF0aW9uOiBmb250LmRlY29yYXRpb24sIHN0eWxlOiBmb250LnN0eWxlLCB3ZWlnaHQ6IGZvbnQud2VpZ2h0LCBib3g6IGZvbnQuYm94IH07XG5cdGVsc2Vcblx0XHRmb250ID0geyBmYWNlOiBcIkFyaWFsXCIsIHNpemU6IDEyKjQvMywgZGVjb3JhdGlvbjogXCJ1bmRlcmxpbmVcIiwgc3R5bGU6IFwibm9ybWFsXCIsIHdlaWdodDogXCJub3JtYWxcIiB9O1xuXG5cdHZhciBhdHRyID0ge1wiZm9udC1zaXplXCI6IGZvbnQuc2l6ZSwgJ2ZvbnQtc3R5bGUnOiBmb250LnN0eWxlLFxuXHRcdFwiZm9udC1mYW1pbHlcIjogZm9udC5mYWNlLCAnZm9udC13ZWlnaHQnOiBmb250LndlaWdodCwgJ3RleHQtZGVjb3JhdGlvbic6IGZvbnQuZGVjb3JhdGlvbixcblx0XHQnY2xhc3MnOiB0aGlzLmFkZENsYXNzZXMoa2xhc3MpIH07XG5cdGF0dHIuZm9udCA9IFwiXCI7XHQvLyBUaGVyZSBpcyBhIHNwdXJpb3VzIGZvbnQgZGVmaW5pdGlvbiB0aGF0IGlzIHB1dCBvbiBhbGwgdGV4dCBlbGVtZW50cy4gVGhpcyBvdmVyd3JpdGVzIGl0LlxuXHRyZXR1cm4geyBmb250OiBmb250LCBhdHRyOiBhdHRyIH07XG59O1xuXG5SZW5kZXJlci5wcm90b3R5cGUuZ2V0VGV4dFNpemUgPSBmdW5jdGlvbih0ZXh0LCB0eXBlLCBrbGFzcykge1xuXHR2YXIgaGFzaCA9IHRoaXMuZ2V0Rm9udEFuZEF0dHIodHlwZSwga2xhc3MpO1xuXHR2YXIgc2l6ZSA9IHRoaXMucGFwZXIuZ2V0VGV4dFNpemUodGV4dCwgaGFzaC5hdHRyKTtcblx0aWYgKGhhc2guZm9udC5ib3gpIHtcblx0XHRzaXplLmhlaWdodCArPSA4O1xuXHRcdC8vIFRPRE8tUEVSOiBTaG91bGRuJ3QgdGhlIHdpZHRoIGFsc28gYmUgaW5jcmVhc2VkIGhlcmU/XG5cdH1cblx0cmV0dXJuIHNpemU7XG59O1xuXG5SZW5kZXJlci5wcm90b3R5cGUucmVuZGVyVGV4dCA9IGZ1bmN0aW9uKHgsIHksIHRleHQsIHR5cGUsIGtsYXNzLCBhbmNob3IsIGNlbnRlclZlcnRpY2FsbHkpIHtcblx0dmFyIGhhc2ggPSB0aGlzLmdldEZvbnRBbmRBdHRyKHR5cGUsIGtsYXNzKTtcblx0aWYgKGFuY2hvcilcblx0XHRoYXNoLmF0dHJbXCJ0ZXh0LWFuY2hvclwiXSA9IGFuY2hvcjtcblx0aGFzaC5hdHRyLnggPSB4O1xuXHRoYXNoLmF0dHIueSA9IHkgKyA3OyAvLyBUT0RPLVBFUjogTm90IHN1cmUgd2h5IHRoZSB0ZXh0IGFwcGVhcnMgdG8gYmUgNyBwaXhlbHMgb2ZmLlxuXHRpZiAoIWNlbnRlclZlcnRpY2FsbHkpXG5cdFx0aGFzaC5hdHRyLmR5ID0gXCIwLjVlbVwiO1xuXHRpZiAodHlwZSA9PT0gJ2RlYnVnZm9udCcpIHtcblx0XHRjb25zb2xlLmxvZyhcIkRlYnVnIG1zZzogXCIgKyB0ZXh0KTtcblx0XHRoYXNoLmF0dHIuc3Ryb2tlID0gXCIjZmYwMDAwXCI7XG5cdH1cblxuXHR0ZXh0ID0gdGV4dC5yZXBsYWNlKC9cXG5cXG4vZywgXCJcXG4gXFxuXCIpO1xuXHR0ZXh0ID0gdGV4dC5yZXBsYWNlKC9eXFxuLywgXCJcXHhBMFxcblwiKTtcblxuXHR2YXIgZWwgPSB0aGlzLnBhcGVyLnRleHQodGV4dCwgaGFzaC5hdHRyKTtcblxuXHRpZiAoaGFzaC5mb250LmJveCkge1xuXHRcdHZhciBzaXplID0gZWwuZ2V0QkJveCgpO1xuXHRcdHZhciBwYWRkaW5nID0gMjtcblx0XHR2YXIgbWFyZ2luID0gMjtcblx0XHR0aGlzLnBhcGVyLnJlY3QoeyB4OiBzaXplLnggLSBwYWRkaW5nLCB5OiBzaXplLnkgKyBwYWRkaW5nLCB3aWR0aDogc2l6ZS53aWR0aCArIHBhZGRpbmcqMiwgaGVpZ2h0OiBzaXplLmhlaWdodCArIHBhZGRpbmcqMiAtIG1hcmdpbiwgIHN0cm9rZTogXCIjODg4ODg4XCIsIGZpbGw6IFwidHJhbnNwYXJlbnRcIn0pO1xuXHRcdC8vc2l6ZS5oZWlnaHQgKz0gODtcblx0fVxuXHRpZiAodGhpcy5kb1JlZ3Jlc3Npb24pIHRoaXMuYWRkVG9SZWdyZXNzaW9uKGVsKTtcblx0cmV0dXJuIGVsO1xufTtcblxuUmVuZGVyZXIucHJvdG90eXBlLm1vdmVZID0gZnVuY3Rpb24gKGVtLCBudW1MaW5lcykge1xuXHRpZiAobnVtTGluZXMgPT09IHVuZGVmaW5lZCkgbnVtTGluZXMgPSAxO1xuXHR0aGlzLnkgKz0gZW0qbnVtTGluZXM7XG59O1xuXG5SZW5kZXJlci5wcm90b3R5cGUuc2tpcFNwYWNlWSA9IGZ1bmN0aW9uICgpIHtcblx0dGhpcy55ICs9IHRoaXMuc3BhY2U7XG59O1xuXG4vLyBDYWxsIHdpdGggJ2tpbmQnIGJlaW5nIHRoZSBmb250IHR5cGUgdG8gdXNlLFxuLy8gaWYgbWFyZ2luQm90dG9tID09PSBudWxsIHRoZW4gZG9uJ3QgaW5jcmVtZW50IHRoZSBZIGFmdGVyIHByaW50aW5nLCBvdGhlcndpc2UgdGhhdCBpcyB0aGUgZXh0cmEgbnVtYmVyIG9mIGVtJ3MgdG8gbGVhdmUgYmVsb3cgdGhlIGxpbmUuXG4vLyBhbmQgYWxpZ25tZW50IGJlaW5nIFwic3RhcnRcIiwgXCJtaWRkbGVcIiwgb3IgXCJlbmRcIi5cblJlbmRlcmVyLnByb3RvdHlwZS5vdXRwdXRUZXh0SWYgPSBmdW5jdGlvbih4LCBzdHIsIGtpbmQsIGtsYXNzLCBtYXJnaW5Ub3AsIG1hcmdpbkJvdHRvbSwgYWxpZ25tZW50KSB7XG5cdGlmIChzdHIpIHtcblx0XHRpZiAobWFyZ2luVG9wKVxuXHRcdFx0dGhpcy5tb3ZlWShtYXJnaW5Ub3ApO1xuXHRcdHZhciBlbCA9IHRoaXMucmVuZGVyVGV4dCh4LCB0aGlzLnksIHN0ciwga2luZCwga2xhc3MsIGFsaWdubWVudCk7XG5cdFx0dmFyIGJiID0gZWwuZ2V0QkJveCgpOyAvLyBUaGlzIGNhbiByZXR1cm4gTmFOIGlmIHRoZSBlbGVtZW50IGlzbid0IHZpc2libGUuXG5cdFx0dmFyIHdpZHRoID0gaXNOYU4oYmIud2lkdGgpID8gMCA6IGJiLndpZHRoO1xuXHRcdHZhciBoZWlnaHQgPSBpc05hTihiYi5oZWlnaHQpID8gMCA6IGJiLmhlaWdodDtcblx0XHRpZiAobWFyZ2luQm90dG9tICE9PSBudWxsKSB7XG5cdFx0XHR2YXIgbnVtTGluZXMgPSBzdHIuc3BsaXQoXCJcXG5cIikubGVuZ3RoO1xuXHRcdFx0aWYgKCFpc05hTihiYi5oZWlnaHQpKVxuXHRcdFx0XHR0aGlzLm1vdmVZKGhlaWdodC9udW1MaW5lcywgKG51bUxpbmVzICsgbWFyZ2luQm90dG9tKSk7XG5cdFx0fVxuXHRcdHJldHVybiBbd2lkdGgsIGhlaWdodF07XG5cdH1cblx0cmV0dXJuIFswLDBdO1xufTtcblxuUmVuZGVyZXIucHJvdG90eXBlLmFkZEludmlzaWJsZU1hcmtlciA9IGZ1bmN0aW9uIChjbGFzc05hbWUpIHtcblx0dmFyIGR5ID0gMC4zNTtcblx0dmFyIGZpbGwgPSBcInJnYmEoMCwwLDAsMClcIjtcblx0dmFyIHkgPSB0aGlzLnk7XG5cdHkgPSBNYXRoLnJvdW5kKHkpO1xuXHR2YXIgeDEgPSAwO1xuXHR2YXIgeDIgPSAxMDA7XG5cdHZhciBwYXRoU3RyaW5nID0gc3ByaW50ZihcIk0gJWYgJWYgTCAlZiAlZiBMICVmICVmIEwgJWYgJWYgelwiLCB4MSwgeS1keSwgeDEreDIsIHktZHksXG5cdFx0eDIsIHkrZHksIHgxLCB5K2R5KTtcblx0dGhpcy5wYXBlci5wYXRoVG9CYWNrKHtwYXRoOnBhdGhTdHJpbmcsIHN0cm9rZTpcIm5vbmVcIiwgZmlsbDpmaWxsLCBcImZpbGwtb3BhY2l0eVwiOiAwLCAnY2xhc3MnOiB0aGlzLmFkZENsYXNzZXMoY2xhc3NOYW1lKSwgJ2RhdGEtdmVydGljYWwnOiB5IH0pO1xufTtcblxuLy8gRm9yIGRlYnVnZ2luZywgaXQgaXMgc29tZXRpbWVzIHVzZWZ1bCB0byBrbm93IHdoZXJlIHlvdSBhcmUgdmVydGljYWxseS5cblJlbmRlcmVyLnByb3RvdHlwZS5wcmludEhvcml6b250YWxMaW5lID0gZnVuY3Rpb24gKHdpZHRoLCB2ZXJ0aWNhbCwgY29tbWVudCkge1xuXHR2YXIgZHkgPSAwLjM1O1xuXHR2YXIgZmlsbCA9IFwicmdiYSgwLDAsMjU1LC40KVwiO1xuXHR2YXIgeSA9IHRoaXMueTtcblx0aWYgKHZlcnRpY2FsKSB5ID0gdmVydGljYWw7XG5cdHkgPSBNYXRoLnJvdW5kKHkpO1xuXHR0aGlzLnBhcGVyLnRleHQoXCJcIitNYXRoLnJvdW5kKHkpLCB7eDogMTAsIHk6IHksIFwidGV4dC1hbmNob3JcIjogXCJzdGFydFwiLCBcImZvbnQtc2l6ZVwiOlwiMThweFwiLCBmaWxsOiBmaWxsLCBzdHJva2U6IGZpbGwgfSk7XG5cdHZhciB4MSA9IDUwO1xuXHR2YXIgeDIgPSB3aWR0aDtcblx0dmFyIHBhdGhTdHJpbmcgPSBzcHJpbnRmKFwiTSAlZiAlZiBMICVmICVmIEwgJWYgJWYgTCAlZiAlZiB6XCIsIHgxLCB5LWR5LCB4MSt4MiwgeS1keSxcblx0XHR4MiwgeStkeSwgeDEsIHkrZHkpO1xuXHR0aGlzLnBhcGVyLnBhdGhUb0JhY2soe3BhdGg6cGF0aFN0cmluZywgc3Ryb2tlOlwibm9uZVwiLCBmaWxsOmZpbGwsICdjbGFzcyc6IHRoaXMuYWRkQ2xhc3Nlcygnc3RhZmYnKX0pO1xuXHRmb3IgKHZhciBpID0gMTsgaSA8IHdpZHRoLzEwMDsgaSsrKSB7XG5cdFx0cGF0aFN0cmluZyA9IHNwcmludGYoXCJNICVmICVmIEwgJWYgJWYgTCAlZiAlZiBMICVmICVmIHpcIiwgaSoxMDAtZHksIHktNSwgaSoxMDAtZHksIHkrNSxcblx0XHRcdGkqMTAwK2R5LCB5LTUsIGkqMTAwK2R5LCB5KzUpO1xuXHRcdHRoaXMucGFwZXIucGF0aFRvQmFjayh7cGF0aDpwYXRoU3RyaW5nLCBzdHJva2U6XCJub25lXCIsIGZpbGw6ZmlsbCwgJ2NsYXNzJzogdGhpcy5hZGRDbGFzc2VzKCdzdGFmZicpfSk7XG5cdH1cblx0aWYgKGNvbW1lbnQpXG5cdFx0dGhpcy5wYXBlci50ZXh0KGNvbW1lbnQsIHt4OiB3aWR0aCs3MCwgeTogeSwgXCJ0ZXh0LWFuY2hvclwiOiBcInN0YXJ0XCIsIFwiZm9udC1zaXplXCI6XCIxOHB4XCIsIGZpbGw6IGZpbGwsIHN0cm9rZTogZmlsbCB9KTtcbn07XG5cblJlbmRlcmVyLnByb3RvdHlwZS5wcmludFNoYWRlZEJveCA9IGZ1bmN0aW9uICh4LCB5LCB3aWR0aCwgaGVpZ2h0LCBjb2xvciwgb3BhY2l0eSwgY29tbWVudCkge1xuXHR2YXIgYm94ID0gdGhpcy5wYXBlci5yZWN0KHsgeDogeCwgeTogeSwgd2lkdGg6IHdpZHRoLCBoZWlnaHQ6IGhlaWdodCwgZmlsbDogY29sb3IsIHN0cm9rZTogY29sb3IsIFwiZmlsbC1vcGFjaXR5XCI6IG9wYWNpdHksIFwic3Ryb2tlLW9wYWNpdHlcIjogb3BhY2l0eSB9KTtcblx0aWYgKGNvbW1lbnQpXG5cdFx0dGhpcy5wYXBlci50ZXh0KGNvbW1lbnQsIHt4OiAwLCB5OiB5KzcsIFwidGV4dC1hbmNob3JcIjogXCJzdGFydFwiLCBcImZvbnQtc2l6ZVwiOlwiMTRweFwiLCBmaWxsOiBcInJnYmEoMCwwLDI1NSwuNClcIiwgc3Ryb2tlOiBcInJnYmEoMCwwLDI1NSwuNClcIiB9KTtcblx0cmV0dXJuIGJveDtcbn07XG5cblJlbmRlcmVyLnByb3RvdHlwZS5wcmludFZlcnRpY2FsTGluZSA9IGZ1bmN0aW9uICh4LCB5MSwgeTIpIHtcblx0dmFyIGR5ID0gMC4zNTtcblx0dmFyIGZpbGwgPSBcIiMwMGFhYWFcIjtcblx0dmFyIHBhdGhTdHJpbmcgPSBzcHJpbnRmKFwiTSAlZiAlZiBMICVmICVmIEwgJWYgJWYgTCAlZiAlZiB6XCIsIHggLSBkeSwgeTEsIHggLSBkeSwgeTIsXG5cdFx0XHR4ICsgZHksIHkxLCB4ICsgZHksIHkyKTtcblx0dGhpcy5wYXBlci5wYXRoVG9CYWNrKHtwYXRoOiBwYXRoU3RyaW5nLCBzdHJva2U6IFwibm9uZVwiLCBmaWxsOiBmaWxsLCAnY2xhc3MnOiB0aGlzLmFkZENsYXNzZXMoJ3N0YWZmJyl9KTtcblx0cGF0aFN0cmluZyA9IHNwcmludGYoXCJNICVmICVmIEwgJWYgJWYgTCAlZiAlZiBMICVmICVmIHpcIiwgeCAtIDIwLCB5MSwgeCAtIDIwLCB5MSszLFxuXHRcdHgsIHkxLCB4LCB5MSszKTtcblx0dGhpcy5wYXBlci5wYXRoVG9CYWNrKHtwYXRoOiBwYXRoU3RyaW5nLCBzdHJva2U6IFwibm9uZVwiLCBmaWxsOiBmaWxsLCAnY2xhc3MnOiB0aGlzLmFkZENsYXNzZXMoJ3N0YWZmJyl9KTtcblx0cGF0aFN0cmluZyA9IHNwcmludGYoXCJNICVmICVmIEwgJWYgJWYgTCAlZiAlZiBMICVmICVmIHpcIiwgeCArIDIwLCB5MiwgeCArIDIwLCB5MiszLFxuXHRcdHgsIHkyLCB4LCB5MiszKTtcblx0dGhpcy5wYXBlci5wYXRoVG9CYWNrKHtwYXRoOiBwYXRoU3RyaW5nLCBzdHJva2U6IFwibm9uZVwiLCBmaWxsOiBmaWxsLCAnY2xhc3MnOiB0aGlzLmFkZENsYXNzZXMoJ3N0YWZmJyl9KTtcblxufTtcblxuLyoqXG4gKiBAcHJpdmF0ZVxuICovXG5SZW5kZXJlci5wcm90b3R5cGUuYWRkVG9SZWdyZXNzaW9uID0gZnVuY3Rpb24gKGVsKSB7XG5cdHZhciBib3ggPSBlbC5nZXRCQm94KCk7XG5cdC8vdmFyIHN0ciA9IFwiKFwiK2JveC54K1wiLFwiK2JveC55K1wiKVtcIitib3gud2lkdGgrXCIsXCIrYm94LmhlaWdodCtcIl0gXCJcblx0dmFyIHN0ciA9IGVsLnR5cGUgKyAnICcgKyBib3gudG9TdHJpbmcoKSArICcgJztcblx0dmFyIGF0dHJzID0gW107XG5cdGZvciAodmFyIGtleSBpbiBlbC5hdHRycykge1xuXHRcdGlmIChlbC5hdHRycy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRpZiAoa2V5ID09PSAnY2xhc3MnKVxuXHRcdFx0XHRzdHIgPSBlbC5hdHRyc1trZXldICsgXCIgXCIgKyBzdHI7XG5cdFx0XHRlbHNlXG5cdFx0XHRcdGF0dHJzLnB1c2goa2V5K1wiOiBcIitlbC5hdHRyc1trZXldKTtcblx0XHR9XG5cdH1cblx0YXR0cnMuc29ydCgpO1xuXHRzdHIgKz0gXCJ7IFwiICthdHRycy5qb2luKFwiIFwiKSArIFwiIH1cIjtcblx0dGhpcy5yZWdyZXNzaW9uTGluZXMucHVzaChzdHIpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBSZW5kZXJlcjtcbiIsIi8vICAgIENvcHlyaWdodCAoQykgMjAxNC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSlcbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHNwYWNpbmcgPSB7fTtcblxuc3BhY2luZy5GT05URU0gPSAzNjA7XG5zcGFjaW5nLkZPTlRTSVpFID0gMzA7XG5zcGFjaW5nLlNURVAgPSBzcGFjaW5nLkZPTlRTSVpFKjkzLzcyMDtcbnNwYWNpbmcuU1BBQ0UgPSAxMDtcbnNwYWNpbmcuVE9QTk9URSA9IDE1O1xuc3BhY2luZy5TVEFWRUhFSUdIVCA9IDEwMDtcbnNwYWNpbmcuSU5ERU5UID0gNTA7XG5cbm1vZHVsZS5leHBvcnRzID0gc3BhY2luZztcbiIsIi8vICAgIGFiY19zdGFmZl9ncm91cF9lbGVtZW50LmpzOiBEZWZpbml0aW9uIG9mIHRoZSBTdGFmZkdyb3VwRWxlbWVudCBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuLypnbG9iYWxzIGNvbnNvbGUgKi9cblxudmFyIHNwYWNpbmcgPSByZXF1aXJlKCcuL2FiY19zcGFjaW5nJyk7XG5cbi8vIFN0YWZmR3JvdXBFbGVtZW50IGNvbnRhaW5zIGFsbCB0aGUgZWxlbWVudHMgdGhhdCBnbyB0b2dldGhlciB0byBtYWtlIG9uZSBsaW5lIG9mIG11c2ljLlxuLy8gVGhhdCBtaWdodCBiZSBtdWx0aXBsZSBzdGF2ZXMgdGhhdCBhcmUgdGllZCB0b2dldGhlciwgYW5kIGl0IG1pZ2h0IGJlIG11bHRpcGxlIHZvaWNlcyBvbiBvbmUgc3RhZmYuXG4vL1xuLy8gTWV0aG9kczpcbi8vIGNvbnN0cnVjdG9yOiBzb21lIGJhc2ljIGluaXRpYWxpemF0aW9uXG4vLyBhZGRWb2ljZSgpOiBDYWxsZWQgb25jZSBmb3IgZWFjaCB2b2ljZS4gTWF5IGFkZCBhIG5ldyBzdGFmZiBpZiBuZWVkZWQuXG4vLyBmaW5pc2hlZCgpOiBDYWxsZWQgb25seSBpbnRlcm5hbGx5IGJ5IGxheW91dCgpXG4vLyBsYXlvdXQoKTogVGhpcyBkb2VzIGFsbCB0aGUgbGF5b3V0LiBJdCBzZXRzIHRoZSBmb2xsb3dpbmc6IHNwYWNpbmd1bml0cywgc3RhcnR4LCBtaW5zcGFjZSwgdywgYW5kIHRoZSB4LWNvb3JkaW5hdGUgb2YgZWFjaCBlbGVtZW50IGluIGVhY2ggdm9pY2UuXG4vLyBkcmF3KCk6IENhbGxzIHRoZSB1bmRlcmx5aW5nIG1ldGhvZHMgb24gdGhlIHZvaWNlIG9iamVjdHMgdG8gZG8gdGhlIGRyYXdpbmcuIFNldHMgeSBhbmQgaGVpZ2h0LlxuLy9cbi8vIE1lbWJlcnM6XG4vLyBzdGFmZnM6IGFuIGFycmF5IG9mIGFsbCB0aGUgc3RhdmVzIGluIHRoaXMgZ3JvdXAuIEVhY2ggc3RhZmYgY29udGFpbnMgdGhlIGZvbGxvd2luZyBlbGVtZW50czpcbi8vICAgIHsgdG9wLCBib3R0b20sIGhpZ2hlc3QsIGxvd2VzdCwgeSB9XG4vLyB2b2ljZXM6IGFycmF5IG9mIFZvaWNlRWxlbWVudCBvYmplY3RzLiBUaGlzIGlzIG1vc3RseSBwYXNzZWQgaW4sIGJ1dCB0aGUgVm9pY2VFbGVtZW50IG9iamVjdHMgYXJlIG1vZGlmaWVkIGhlcmUuXG4vL1xuLy8gc3BhY2luZ3VuaXRzOiBudW1iZXIgb2YgcmVsYXRpdmUgeC11bml0cyBpbiB0aGUgbGluZS4gVXNlZCBieSB0aGUgY2FsbGluZyBmdW5jdGlvbiB0byBwYXNzIGJhY2sgaW4gYXMgdGhlIFwic3BhY2luZ1wiIGlucHV0IHBhcmFtZXRlci5cbi8vIFRPRE8tUEVSOiBUaGlzIHNob3VsZCBhY3R1YWxseSBiZSBwYXNzZWQgYmFjayBhcyBhIHJldHVybiB2YWx1ZS5cbi8vIG1pbnNwYWNlOiBzbWFsbGVzdCBzcGFjZSBiZXR3ZWVuIHR3byBub3Rlcy4gVXNlZCBieSB0aGUgY2FsbGluZyBmdW5jdGlvbiB0byBwYXNzIGJhY2sgaW4gYXMgdGhlIFwic3BhY2luZ1wiIGlucHV0IHBhcmFtZXRlci5cbi8vIFRPRE8tUEVSOiBUaGlzIHNob3VsZCBhY3R1YWxseSBiZSBwYXNzZWQgYmFjayBhcyBhIHJldHVybiB2YWx1ZS5cbi8vIHN0YXJ0eDogVGhlIGxlZnQgZWRnZSwgdGFraW5nIHRoZSBtYXJnaW4gYW5kIHRoZSBvcHRpb25hbCB2b2ljZSBuYW1lLiBVc2VkIGJ5IHRoZSBkcmF3KCkgbWV0aG9kLlxuLy8gdzogVGhlIHdpZHRoIG9mIHRoZSBsaW5lLiBVc2VkIGJ5IGNhbGxpbmcgZnVuY3Rpb24gdG8gcGFzcyBiYWNrIGluIGFzIHRoZSBcInNwYWNpbmdcIiBpbnB1dCBwYXJhbWV0ZXIsIGFuZCB0aGUgZHJhdygpIG1ldGhvZC5cbi8vIFRPRE8tUEVSOiBUaGlzIHNob3VsZCBhY3R1YWxseSBiZSBwYXNzZWQgYmFjayBhcyBhIHJldHVybiB2YWx1ZS4gIChUT0RPLVBFUjogaW4gcGl4ZWxzIG9yIHNwYWNpbmcgdW5pdHM/KVxuLy8geTogVGhlIHRvcCBvZiB0aGUgc3RhZmYgZ3JvdXAsIGluIHBpeGVscy4gVGhpcyBpcyBzZXQgaW4gdGhlIGRyYXcgbWV0aG9kLlxuLy8gVE9ETy1QRVI6IFdoZXJlIGlzIHRoYXQgdXNlZD8gSXQgbG9va3MgbGlrZSBpdCBtaWdodCBub3QgYmUgbmVlZGVkLlxuLy8gaGVpZ2h0OiBTZXQgaW4gdGhlIGRyYXcoKSBtZXRob2QgdG8gdGhlIGhlaWdodCBhY3R1YWxseSB1c2VkLiBVc2VkIGJ5IHRoZSBjYWxsaW5nIGZ1bmN0aW9uIHRvIGtub3cgd2hlcmUgdG8gc3RhcnQgdGhlIG5leHQgc3RhZmYgZ3JvdXAuXG4vLyBUT0RPLVBFUjogVGhpcyBzaG91bGQgYWN0dWFsbHkgYmUgc2V0IGluIHRoZSBsYXlvdXQgbWV0aG9kIGFuZCBwYXNzZWQgYmFjayBhcyBhIHJldHVybiB2YWx1ZS5cblxudmFyIFN0YWZmR3JvdXBFbGVtZW50ID0gZnVuY3Rpb24oKSB7XG5cdHRoaXMudm9pY2VzID0gW107XG5cdHRoaXMuc3RhZmZzID0gW107XG5cdHRoaXMuYnJhY2UgPSB1bmRlZmluZWQ7IC8vdG9ueVxufTtcblxuU3RhZmZHcm91cEVsZW1lbnQucHJvdG90eXBlLnNldExpbWl0ID0gZnVuY3Rpb24obWVtYmVyLCB2b2ljZSkge1xuXHRpZiAoIXZvaWNlLnNwZWNpYWxZW21lbWJlcl0pIHJldHVybjtcblx0aWYgKCF2b2ljZS5zdGFmZi5zcGVjaWFsWVttZW1iZXJdKVxuXHRcdHZvaWNlLnN0YWZmLnNwZWNpYWxZW21lbWJlcl0gPSB2b2ljZS5zcGVjaWFsWVttZW1iZXJdO1xuXHRlbHNlXG5cdFx0dm9pY2Uuc3RhZmYuc3BlY2lhbFlbbWVtYmVyXSA9IE1hdGgubWF4KHZvaWNlLnN0YWZmLnNwZWNpYWxZW21lbWJlcl0sIHZvaWNlLnNwZWNpYWxZW21lbWJlcl0pO1xufTtcblxuU3RhZmZHcm91cEVsZW1lbnQucHJvdG90eXBlLmFkZFZvaWNlID0gZnVuY3Rpb24gKHZvaWNlLCBzdGFmZm51bWJlciwgc3RhZmZsaW5lcykge1xuXHR2YXIgdm9pY2VOdW0gPSB0aGlzLnZvaWNlcy5sZW5ndGg7XG5cdHRoaXMudm9pY2VzW3ZvaWNlTnVtXSA9IHZvaWNlO1xuXHRpZiAodGhpcy5zdGFmZnNbc3RhZmZudW1iZXJdKVxuXHRcdHRoaXMuc3RhZmZzW3N0YWZmbnVtYmVyXS52b2ljZXMucHVzaCh2b2ljZU51bSk7XG5cdGVsc2Uge1xuXHRcdC8vIFRPRE8tUEVSOiBob3cgZG9lcyB0aGUgbWluL21heCBjaGFuZ2Ugd2hlbiBzdGFmZmxpbmVzIGlzIG5vdCA1P1xuXHRcdHRoaXMuc3RhZmZzW3RoaXMuc3RhZmZzLmxlbmd0aF0gPSB7XG5cdFx0XHR0b3A6IDEwLFxuXHRcdFx0Ym90dG9tOiAyLFxuXHRcdFx0bGluZXM6IHN0YWZmbGluZXMsXG5cdFx0XHR2b2ljZXM6IFt2b2ljZU51bV0sXG5cdFx0XHRzcGVjaWFsWToge1xuXHRcdFx0XHR0ZW1wb0hlaWdodEFib3ZlOiAwLFxuXHRcdFx0XHRwYXJ0SGVpZ2h0QWJvdmU6IDAsXG5cdFx0XHRcdHZvbHVtZUhlaWdodEFib3ZlOiAwLFxuXHRcdFx0XHRkeW5hbWljSGVpZ2h0QWJvdmU6IDAsXG5cdFx0XHRcdGVuZGluZ0hlaWdodEFib3ZlOiAwLFxuXHRcdFx0XHRjaG9yZEhlaWdodEFib3ZlOiAwLFxuXHRcdFx0XHRseXJpY0hlaWdodEFib3ZlOiAwLFxuXG5cdFx0XHRcdGx5cmljSGVpZ2h0QmVsb3c6IDAsXG5cdFx0XHRcdGNob3JkSGVpZ2h0QmVsb3c6IDAsXG5cdFx0XHRcdHZvbHVtZUhlaWdodEJlbG93OiAwLFxuXHRcdFx0XHRkeW5hbWljSGVpZ2h0QmVsb3c6IDBcblx0XHRcdH1cblx0XHR9O1xuXHR9XG5cdHZvaWNlLnN0YWZmID0gdGhpcy5zdGFmZnNbc3RhZmZudW1iZXJdO1xufTtcblxuU3RhZmZHcm91cEVsZW1lbnQucHJvdG90eXBlLnNldFN0YWZmTGltaXRzID0gZnVuY3Rpb24gKHZvaWNlKSB7XG5cdHZvaWNlLnN0YWZmLnRvcCA9IE1hdGgubWF4KHZvaWNlLnN0YWZmLnRvcCwgdm9pY2UudG9wKTtcblx0dm9pY2Uuc3RhZmYuYm90dG9tID0gTWF0aC5taW4odm9pY2Uuc3RhZmYuYm90dG9tLCB2b2ljZS5ib3R0b20pO1xuXHR0aGlzLnNldExpbWl0KCd0ZW1wb0hlaWdodEFib3ZlJywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCdwYXJ0SGVpZ2h0QWJvdmUnLCB2b2ljZSk7XG5cdHRoaXMuc2V0TGltaXQoJ3ZvbHVtZUhlaWdodEFib3ZlJywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCdkeW5hbWljSGVpZ2h0QWJvdmUnLCB2b2ljZSk7XG5cdHRoaXMuc2V0TGltaXQoJ2VuZGluZ0hlaWdodEFib3ZlJywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCdjaG9yZEhlaWdodEFib3ZlJywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCdseXJpY0hlaWdodEFib3ZlJywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCdseXJpY0hlaWdodEJlbG93Jywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCdjaG9yZEhlaWdodEJlbG93Jywgdm9pY2UpO1xuXHR0aGlzLnNldExpbWl0KCd2b2x1bWVIZWlnaHRCZWxvdycsIHZvaWNlKTtcblx0dGhpcy5zZXRMaW1pdCgnZHluYW1pY0hlaWdodEJlbG93Jywgdm9pY2UpO1xufTtcblxuU3RhZmZHcm91cEVsZW1lbnQucHJvdG90eXBlLnNldFVwcGVyQW5kTG93ZXJFbGVtZW50cyA9IGZ1bmN0aW9uKHJlbmRlcmVyKSB7XG5cdC8vIEVhY2ggc3RhZmYgYWxyZWFkeSBoYXMgdGhlIHRvcCBhbmQgYm90dG9tIHNldCwgbm93IHdlIHNlZSBpZiB0aGVyZSBhcmUgZWxlbWVudHMgdGhhdCBhcmUgYWx3YXlzIG9uIHRvcCBhbmQgYm90dG9tLCBhbmQgcmVzb2x2ZSB0aGVpciBwaXRjaC5cblx0Ly8gQWxzbywgZ2V0IHRoZSBvdmVyYWxsIGhlaWdodCBvZiBhbGwgdGhlIHN0YXZlcyBpbiB0aGlzIGdyb3VwLlxuXHR2YXIgbGFzdFN0YWZmQm90dG9tO1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuc3RhZmZzLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIHN0YWZmID0gdGhpcy5zdGFmZnNbaV07XG5cdFx0Ly8gdGhlIHZlcnRpY2FsIG9yZGVyIG9mIGVsZW1lbnRzIHRoYXQgYXJlIGFib3ZlIGlzOiB0ZW1wbywgcGFydCwgdm9sdW1lL2R5bmFtaWMsIGVuZGluZy9jaG9yZCwgbHlyaWNcblx0XHQvLyB0aGUgdmVydGljYWwgb3JkZXIgb2YgZWxlbWVudHMgdGhhdCBhcmUgYmVsb3cgaXM6IGx5cmljLCBjaG9yZCwgdm9sdW1lL2R5bmFtaWNcblx0XHR2YXIgcG9zaXRpb25ZID0ge1xuXHRcdFx0dGVtcG9IZWlnaHRBYm92ZTogMCxcblx0XHRcdHBhcnRIZWlnaHRBYm92ZTogMCxcblx0XHRcdHZvbHVtZUhlaWdodEFib3ZlOiAwLFxuXHRcdFx0ZHluYW1pY0hlaWdodEFib3ZlOiAwLFxuXHRcdFx0ZW5kaW5nSGVpZ2h0QWJvdmU6IDAsXG5cdFx0XHRjaG9yZEhlaWdodEFib3ZlOiAwLFxuXHRcdFx0bHlyaWNIZWlnaHRBYm92ZTogMCxcblxuXHRcdFx0bHlyaWNIZWlnaHRCZWxvdzogMCxcblx0XHRcdGNob3JkSGVpZ2h0QmVsb3c6IDAsXG5cdFx0XHR2b2x1bWVIZWlnaHRCZWxvdzogMCxcblx0XHRcdGR5bmFtaWNIZWlnaHRCZWxvdzogMFxuXHRcdH07XG5cblx0XHRpZiAoLypBQkNKUy53cml0ZS5kZWJ1Z1BsYWNlbWVudCovZmFsc2UpIHtcblx0XHRcdHN0YWZmLm9yaWdpbmFsVG9wID0gc3RhZmYudG9wOyAvLyBUaGlzIGlzIGp1c3QgYmVpbmcgc3RvcmVkIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMuXG5cdFx0XHRzdGFmZi5vcmlnaW5hbEJvdHRvbSA9IHN0YWZmLmJvdHRvbTsgLy8gVGhpcyBpcyBqdXN0IGJlaW5nIHN0b3JlZCBmb3IgZGVidWdnaW5nIHB1cnBvc2VzLlxuXHRcdH1cblxuXHRcdGlmIChzdGFmZi5zcGVjaWFsWS5seXJpY0hlaWdodEFib3ZlKSB7IHN0YWZmLnRvcCArPSBzdGFmZi5zcGVjaWFsWS5seXJpY0hlaWdodEFib3ZlOyBwb3NpdGlvblkubHlyaWNIZWlnaHRBYm92ZSA9IHN0YWZmLnRvcDsgfVxuXHRcdGlmIChzdGFmZi5zcGVjaWFsWS5jaG9yZEhlaWdodEFib3ZlKSB7IHN0YWZmLnRvcCArPSBzdGFmZi5zcGVjaWFsWS5jaG9yZEhlaWdodEFib3ZlOyBwb3NpdGlvblkuY2hvcmRIZWlnaHRBYm92ZSA9IHN0YWZmLnRvcDsgfVxuXHRcdGlmIChzdGFmZi5zcGVjaWFsWS5lbmRpbmdIZWlnaHRBYm92ZSkge1xuXHRcdFx0aWYgKHN0YWZmLnNwZWNpYWxZLmNob3JkSGVpZ2h0QWJvdmUpXG5cdFx0XHRcdHN0YWZmLnRvcCArPSAyO1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRzdGFmZi50b3AgKz0gc3RhZmYuc3BlY2lhbFkuZW5kaW5nSGVpZ2h0QWJvdmU7XG5cdFx0XHRwb3NpdGlvblkuZW5kaW5nSGVpZ2h0QWJvdmUgPSBzdGFmZi50b3A7XG5cdFx0fVxuXHRcdGlmIChzdGFmZi5zcGVjaWFsWS5keW5hbWljSGVpZ2h0QWJvdmUgJiYgc3RhZmYuc3BlY2lhbFkudm9sdW1lSGVpZ2h0QWJvdmUpIHtcblx0XHRcdHN0YWZmLnRvcCArPSBNYXRoLm1heChzdGFmZi5zcGVjaWFsWS5keW5hbWljSGVpZ2h0QWJvdmUsIHN0YWZmLnNwZWNpYWxZLnZvbHVtZUhlaWdodEFib3ZlKTtcblx0XHRcdHBvc2l0aW9uWS5keW5hbWljSGVpZ2h0QWJvdmUgPSBzdGFmZi50b3A7XG5cdFx0XHRwb3NpdGlvblkudm9sdW1lSGVpZ2h0QWJvdmUgPSBzdGFmZi50b3A7XG5cdFx0fSBlbHNlIGlmIChzdGFmZi5zcGVjaWFsWS5keW5hbWljSGVpZ2h0QWJvdmUpIHtcblx0XHRcdHN0YWZmLnRvcCArPSBzdGFmZi5zcGVjaWFsWS5keW5hbWljSGVpZ2h0QWJvdmU7IHBvc2l0aW9uWS5keW5hbWljSGVpZ2h0QWJvdmUgPSBzdGFmZi50b3A7XG5cdFx0fSBlbHNlIGlmIChzdGFmZi5zcGVjaWFsWS52b2x1bWVIZWlnaHRBYm92ZSkgeyBzdGFmZi50b3AgKz0gc3RhZmYuc3BlY2lhbFkudm9sdW1lSGVpZ2h0QWJvdmU7IHBvc2l0aW9uWS52b2x1bWVIZWlnaHRBYm92ZSA9IHN0YWZmLnRvcDsgfVxuXHRcdGlmIChzdGFmZi5zcGVjaWFsWS5wYXJ0SGVpZ2h0QWJvdmUpIHsgc3RhZmYudG9wICs9IHN0YWZmLnNwZWNpYWxZLnBhcnRIZWlnaHRBYm92ZTsgcG9zaXRpb25ZLnBhcnRIZWlnaHRBYm92ZSA9IHN0YWZmLnRvcDsgfVxuXHRcdGlmIChzdGFmZi5zcGVjaWFsWS50ZW1wb0hlaWdodEFib3ZlKSB7IHN0YWZmLnRvcCArPSBzdGFmZi5zcGVjaWFsWS50ZW1wb0hlaWdodEFib3ZlOyBwb3NpdGlvblkudGVtcG9IZWlnaHRBYm92ZSA9IHN0YWZmLnRvcDsgfVxuXG5cdFx0aWYgKHN0YWZmLnNwZWNpYWxZLmx5cmljSGVpZ2h0QmVsb3cpIHsgcG9zaXRpb25ZLmx5cmljSGVpZ2h0QmVsb3cgPSBzdGFmZi5ib3R0b207IHN0YWZmLmJvdHRvbSAtPSBzdGFmZi5zcGVjaWFsWS5seXJpY0hlaWdodEJlbG93OyB9XG5cdFx0aWYgKHN0YWZmLnNwZWNpYWxZLmNob3JkSGVpZ2h0QmVsb3cpIHsgcG9zaXRpb25ZLmNob3JkSGVpZ2h0QmVsb3cgPSBzdGFmZi5ib3R0b207IHN0YWZmLmJvdHRvbSAtPSBzdGFmZi5zcGVjaWFsWS5jaG9yZEhlaWdodEJlbG93OyB9XG5cdFx0aWYgKHN0YWZmLnNwZWNpYWxZLnZvbHVtZUhlaWdodEJlbG93ICYmIHN0YWZmLnNwZWNpYWxZLmR5bmFtaWNIZWlnaHRCZWxvdykge1xuXHRcdFx0cG9zaXRpb25ZLnZvbHVtZUhlaWdodEJlbG93ID0gc3RhZmYuYm90dG9tO1xuXHRcdFx0cG9zaXRpb25ZLmR5bmFtaWNIZWlnaHRCZWxvdyA9IHN0YWZmLmJvdHRvbTtcblx0XHRcdHN0YWZmLmJvdHRvbSAtPSBNYXRoLm1heChzdGFmZi5zcGVjaWFsWS52b2x1bWVIZWlnaHRCZWxvdywgc3RhZmYuc3BlY2lhbFkuZHluYW1pY0hlaWdodEJlbG93KTtcblx0XHR9IGVsc2UgaWYgKHN0YWZmLnNwZWNpYWxZLnZvbHVtZUhlaWdodEJlbG93KSB7XG5cdFx0XHRwb3NpdGlvblkudm9sdW1lSGVpZ2h0QmVsb3cgPSBzdGFmZi5ib3R0b207IHN0YWZmLmJvdHRvbSAtPSBzdGFmZi5zcGVjaWFsWS52b2x1bWVIZWlnaHRCZWxvdztcblx0XHR9IGVsc2UgaWYgKHN0YWZmLnNwZWNpYWxZLmR5bmFtaWNIZWlnaHRCZWxvdykge1xuXHRcdFx0cG9zaXRpb25ZLmR5bmFtaWNIZWlnaHRCZWxvdyA9IHN0YWZmLmJvdHRvbTsgc3RhZmYuYm90dG9tIC09IHN0YWZmLnNwZWNpYWxZLmR5bmFtaWNIZWlnaHRCZWxvdztcblx0XHR9XG5cblx0XHRpZiAoLypBQkNKUy53cml0ZS5kZWJ1Z1BsYWNlbWVudCovZmFsc2UpXG5cdFx0XHRzdGFmZi5wb3NpdGlvblkgPSBwb3NpdGlvblk7IC8vIFRoaXMgaXMganVzdCBiZWluZyBzdG9yZWQgZm9yIGRlYnVnZ2luZyBwdXJwb3Nlcy5cblxuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgc3RhZmYudm9pY2VzLmxlbmd0aDsgaisrKSB7XG5cdFx0XHR2YXIgdm9pY2UgPSB0aGlzLnZvaWNlc1tzdGFmZi52b2ljZXNbal1dO1xuXHRcdFx0dm9pY2Uuc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzKHBvc2l0aW9uWSk7XG5cdFx0fVxuXHRcdC8vIFdlIG1pZ2h0IG5lZWQgYSBsaXR0bGUgc3BhY2UgaW4gYmV0d2VlbiBzdGF2ZXMgaWYgdGhlIHN0YXZlcyBoYXZlbid0IGJlZW4gcHVzaGVkIGZhciBlbm91Z2ggYXBhcnQgYnkgbm90ZXMgb3IgZXh0cmEgdmVydGljYWwgc3R1ZmYuXG5cdFx0Ly8gT25seSB0cnkgdG8gcHV0IGluIGV4dHJhIHNwYWNlIGlmIHRoaXMgaXNuJ3QgdGhlIHRvcCBzdGFmZi5cblx0XHRpZiAobGFzdFN0YWZmQm90dG9tICE9PSB1bmRlZmluZWQpIHtcblx0XHRcdHZhciB0aGlzU3RhZmZUb3AgPSBzdGFmZi50b3AgLSAxMDtcblx0XHRcdHZhciBmb3JjZWRTcGFjaW5nQmV0d2VlbiA9IGxhc3RTdGFmZkJvdHRvbSArIHRoaXNTdGFmZlRvcDtcblx0XHRcdHZhciBtaW5TcGFjaW5nSW5QaXRjaGVzID0gcmVuZGVyZXIuc3BhY2luZy5zeXN0ZW1TdGFmZlNlcGFyYXRpb24vc3BhY2luZy5TVEVQO1xuXHRcdFx0dmFyIGFkZGVkU3BhY2UgPSBtaW5TcGFjaW5nSW5QaXRjaGVzIC0gZm9yY2VkU3BhY2luZ0JldHdlZW47XG5cdFx0XHRpZiAoYWRkZWRTcGFjZSA+IDApXG5cdFx0XHRcdHN0YWZmLnRvcCArPSBhZGRlZFNwYWNlO1xuXHRcdH1cblx0XHRsYXN0U3RhZmZCb3R0b20gPSAyIC0gc3RhZmYuYm90dG9tOyAvLyB0aGUgc3RhZmYgc3RhcnRzIGF0IHBvc2l0aW9uIDIgYW5kIHRoZSBib3R0b20gdmFyaWFibGUgaXMgbmVnYXRpdmUuIFRoZXJlZm9yZSB0byBmaW5kIG91dCBob3cgbGFyZ2UgdGhlIGJvdHRvbSBpcywgd2UgcmV2ZXJzZSB0aGUgc2lnbiBvZiB0aGUgYm90dG9tLCBhbmQgYWRkIHRoZSAyIGluLlxuXG5cdFx0Ly8gTm93IHdlIG5lZWQgYSBsaXR0bGUgbWFyZ2luIG9uIHRoZSB0b3AsIHNvIHdlJ2xsIGp1c3QgdGhyb3cgdGhhdCBpbi5cblx0XHQvL3N0YWZmLnRvcCArPSA0O1xuXHRcdC8vY29uc29sZS5sb2coXCJTdGFmZiBZOiBcIixpLGhlaWdodEluUGl0Y2hlcyxzdGFmZi50b3Asc3RhZmYuYm90dG9tKTtcblx0fVxuXHQvL2NvbnNvbGUubG9nKFwiU3RhZmYgSGVpZ2h0OiBcIixoZWlnaHRJblBpdGNoZXMsdGhpcy5oZWlnaHQpO1xufTtcblxuU3RhZmZHcm91cEVsZW1lbnQucHJvdG90eXBlLmZpbmlzaGVkID0gZnVuY3Rpb24oKSB7XG5cdGZvciAodmFyIGk9MDtpPHRoaXMudm9pY2VzLmxlbmd0aDtpKyspIHtcblx0XHRpZiAoIXRoaXMudm9pY2VzW2ldLmxheW91dEVuZGVkKCkpIHJldHVybiBmYWxzZTtcblx0fVxuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cbmZ1bmN0aW9uIGdldExlZnRFZGdlT2ZTdGFmZihyZW5kZXJlciwgdm9pY2VzLCBicmFjZSkge1xuXHR2YXIgeCA9IHJlbmRlcmVyLnBhZGRpbmcubGVmdDtcblxuXHQvLyBmaW5kIG91dCBob3cgbXVjaCBzcGFjZSB3aWxsIGJlIHRha2VuIHVwIGJ5IHZvaWNlIGhlYWRlcnNcblx0dmFyIHZvaWNlaGVhZGVydyA9IDA7XG5cdGZvciAodmFyIGk9MDtpPHZvaWNlcy5sZW5ndGg7aSsrKSB7XG5cdFx0aWYodm9pY2VzW2ldLmhlYWRlcikge1xuXHRcdFx0dmFyIHNpemUgPSByZW5kZXJlci5nZXRUZXh0U2l6ZSh2b2ljZXNbaV0uaGVhZGVyLCAndm9pY2Vmb250JywgJycpO1xuXHRcdFx0dm9pY2VoZWFkZXJ3ID0gTWF0aC5tYXgodm9pY2VoZWFkZXJ3LHNpemUud2lkdGgpO1xuXHRcdH1cblx0fVxuXHRpZiAodm9pY2VoZWFkZXJ3KSB7XG5cdFx0Ly8gR2l2ZSBlbm91Z2ggc3BhY2luZyB0byB0aGUgcmlnaHQgLSB3ZSB1c2UgdGhlIHdpZHRoIG9mIGFuIEEgZm9yIHRoZSBhbW91bnQgb2Ygc3BhY2luZy5cblx0XHR2YXIgc2l6ZVcgPSByZW5kZXJlci5nZXRUZXh0U2l6ZShcIkFcIiwgJ3ZvaWNlZm9udCcsICcnKTtcblx0XHR2b2ljZWhlYWRlcncgKz0gc2l6ZVcud2lkdGg7XG5cdH1cblx0eCArPSB2b2ljZWhlYWRlcnc7XG5cblx0aWYgKGJyYWNlKSB7XG5cdFx0YnJhY2Uuc2V0TG9jYXRpb24oeCk7XG5cdFx0eCArPSBicmFjZS5nZXRXaWR0aCgpO1xuXHR9XG5cdHJldHVybiB4O1xufVxuXG5TdGFmZkdyb3VwRWxlbWVudC5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24oc3BhY2luZywgcmVuZGVyZXIsIGRlYnVnKSB7XG5cdHZhciBlcHNpbG9uID0gMC4wMDAwMDAxOyAvLyBGdWRnaW5nIGZvciBpbmV4YWN0bmVzcyBvZiBmbG9hdGluZyBwb2ludCBtYXRoLlxuXHR2YXIgc3BhY2luZ3VuaXRzID0gMDsgLy8gbnVtYmVyIG9mIHRpbWVzIHdlIHdpbGwgaGF2ZSBlbmRlZCB1cCB1c2luZyB0aGUgc3BhY2luZyBkaXN0YW5jZSAoYXMgb3Bwb3NlZCB0byBmaXhlZCB3aWR0aCBkaXN0YW5jZXMpXG5cdHZhciBtaW5zcGFjZSA9IDEwMDA7IC8vIGEgYmlnIG51bWJlciB0byBzdGFydCBvZmYgd2l0aCAtIHVzZWQgdG8gZmluZCBvdXQgd2hhdCB0aGUgc21hbGxlc3Qgc3BhY2UgYmV0d2VlbiB0d28gbm90ZXMgaXMgLS0gR0QgMjAxNC4xLjdcblxuXHR2YXIgeCA9IGdldExlZnRFZGdlT2ZTdGFmZihyZW5kZXJlciwgdGhpcy52b2ljZXMsIHRoaXMuYnJhY2UpO1xuXHR0aGlzLnN0YXJ0eD14O1xuXHR2YXIgaTtcblxuXHR2YXIgY3VycmVudGR1cmF0aW9uID0gMDtcblx0aWYgKGRlYnVnKSBjb25zb2xlLmxvZyhcImluaXQgbGF5b3V0XCIsIHNwYWNpbmcpO1xuXHRmb3IgKGk9MDtpPHRoaXMudm9pY2VzLmxlbmd0aDtpKyspIHtcblx0XHR0aGlzLnZvaWNlc1tpXS5iZWdpbkxheW91dCh4KTtcblx0fVxuXG5cdHZhciBzcGFjaW5ndW5pdCA9IDA7IC8vIG51bWJlciBvZiBzcGFjaW5ndW5pdHMgY29taW5nIGZyb20gdGhlIHByZXZpb3VzbHkgbGFpZCBvdXQgZWxlbWVudCB0byB0aGlzIG9uZVxuXHR3aGlsZSAoIXRoaXMuZmluaXNoZWQoKSkge1xuXHRcdC8vIGZpbmQgZmlyc3QgZHVyYXRpb24gbGV2ZWwgdG8gYmUgbGFpZCBvdXQgYW1vbmcgY2FuZGlkYXRlcyBhY3Jvc3Mgdm9pY2VzXG5cdFx0Y3VycmVudGR1cmF0aW9uPSBudWxsOyAvLyBjYW5kaWRhdGUgc21hbGxlc3QgZHVyYXRpb24gbGV2ZWxcblx0XHRmb3IgKGk9MDtpPHRoaXMudm9pY2VzLmxlbmd0aDtpKyspIHtcblx0XHRcdGlmICghdGhpcy52b2ljZXNbaV0ubGF5b3V0RW5kZWQoKSAmJiAoIWN1cnJlbnRkdXJhdGlvbiB8fCB0aGlzLnZvaWNlc1tpXS5nZXREdXJhdGlvbkluZGV4KCk8Y3VycmVudGR1cmF0aW9uKSlcblx0XHRcdFx0Y3VycmVudGR1cmF0aW9uPXRoaXMudm9pY2VzW2ldLmdldER1cmF0aW9uSW5kZXgoKTtcblx0XHR9XG5cblxuXHRcdC8vIGlzb2xhdGUgdm9pY2VzIGF0IGN1cnJlbnQgZHVyYXRpb24gbGV2ZWxcblx0XHR2YXIgY3VycmVudHZvaWNlcyA9IFtdO1xuXHRcdHZhciBvdGhlcnZvaWNlcyA9IFtdO1xuXHRcdGZvciAoaT0wO2k8dGhpcy52b2ljZXMubGVuZ3RoO2krKykge1xuXHRcdFx0dmFyIGR1cmF0aW9uSW5kZXggPSB0aGlzLnZvaWNlc1tpXS5nZXREdXJhdGlvbkluZGV4KCk7XG5cdFx0XHQvLyBQRVI6IEJlY2F1c2Ugb2YgdGhlIGluZXhhY3RuZXNzIG9mIEpTIGZsb2F0aW5nIHBvaW50IG1hdGgsIHdlIGp1c3QgZ2V0IGNsb3NlLlxuXHRcdFx0aWYgKGR1cmF0aW9uSW5kZXggLSBjdXJyZW50ZHVyYXRpb24gPiBlcHNpbG9uKSB7XG5cdFx0XHRcdG90aGVydm9pY2VzLnB1c2godGhpcy52b2ljZXNbaV0pO1xuXHRcdFx0XHQvL2NvbnNvbGUubG9nKFwib3V0OiB2b2ljZSBcIixpKTtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdGN1cnJlbnR2b2ljZXMucHVzaCh0aGlzLnZvaWNlc1tpXSk7XG5cdFx0XHRcdC8vaWYgKGRlYnVnKSBjb25zb2xlLmxvZyhcImluOiB2b2ljZSBcIixpKTtcblx0XHRcdH1cblx0XHR9XG5cblx0XHQvLyBhbW9uZyB0aGUgY3VycmVudCBkdXJhdGlvbiBsZXZlbCBmaW5kIHRoZSBvbmUgd2hpY2ggbmVlZHMgc3RhcnRpbmcgZnVydGhlc3QgcmlnaHRcblx0XHRzcGFjaW5ndW5pdCA9IDA7IC8vIG51bWJlciBvZiBzcGFjaW5ndW5pdHMgY29taW5nIGZyb20gdGhlIHByZXZpb3VzbHkgbGFpZCBvdXQgZWxlbWVudCB0byB0aGlzIG9uZVxuXHRcdHZhciBzcGFjaW5nZHVyYXRpb24gPSAwO1xuXHRcdGZvciAoaT0wO2k8Y3VycmVudHZvaWNlcy5sZW5ndGg7aSsrKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiZ3JlYXRlc3Qgc3BhY2luZyB1bml0XCIsIHgsIGN1cnJlbnR2b2ljZXNbaV0uZ2V0TmV4dFgoKSwgY3VycmVudHZvaWNlc1tpXS5nZXRTcGFjaW5nVW5pdHMoKSwgY3VycmVudHZvaWNlc1tpXS5zcGFjaW5nZHVyYXRpb24pO1xuXHRcdFx0aWYgKGN1cnJlbnR2b2ljZXNbaV0uZ2V0TmV4dFgoKT54KSB7XG5cdFx0XHRcdHg9Y3VycmVudHZvaWNlc1tpXS5nZXROZXh0WCgpO1xuXHRcdFx0XHRzcGFjaW5ndW5pdD1jdXJyZW50dm9pY2VzW2ldLmdldFNwYWNpbmdVbml0cygpO1xuXHRcdFx0XHRzcGFjaW5nZHVyYXRpb24gPSBjdXJyZW50dm9pY2VzW2ldLnNwYWNpbmdkdXJhdGlvbjtcblx0XHRcdH1cblx0XHR9XG5cdFx0c3BhY2luZ3VuaXRzKz1zcGFjaW5ndW5pdDtcblx0XHRtaW5zcGFjZSA9IE1hdGgubWluKG1pbnNwYWNlLHNwYWNpbmd1bml0KTtcblx0XHRpZiAoZGVidWcpIGNvbnNvbGUubG9nKFwiY3VycmVudGR1cmF0aW9uOiBcIixjdXJyZW50ZHVyYXRpb24sIHNwYWNpbmd1bml0cywgbWluc3BhY2UpO1xuXG5cdFx0Zm9yIChpPTA7aTxjdXJyZW50dm9pY2VzLmxlbmd0aDtpKyspIHtcblx0XHRcdHZhciB2b2ljZWNoaWxkeCA9IGN1cnJlbnR2b2ljZXNbaV0ubGF5b3V0T25lSXRlbSh4LHNwYWNpbmcpO1xuXHRcdFx0dmFyIGR4ID0gdm9pY2VjaGlsZHgteDtcblx0XHRcdGlmIChkeD4wKSB7XG5cdFx0XHRcdHggPSB2b2ljZWNoaWxkeDsgLy91cGRhdGUgeFxuXHRcdFx0XHRmb3IgKHZhciBqPTA7ajxpO2orKykgeyAvLyBzaGlmdCBvdmVyIGFsbCBwcmV2aW91c2x5IGxhaWQgb3V0IGVsZW1lbnRzXG5cdFx0XHRcdFx0Y3VycmVudHZvaWNlc1tqXS5zaGlmdFJpZ2h0KGR4KTtcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdC8vIHJlbW92ZSB0aGUgdmFsdWUgb2YgYWxyZWFkeSBjb3VudGVkIHNwYWNpbmcgdW5pdHMgaW4gb3RoZXIgdm9pY2VzIChlLmcuIGlmIGEgdm9pY2UgaGFkIHBsYW5uZWQgdG8gdXNlIHVwIDUgc3BhY2luZyB1bml0cyBidXQgaXMgbm90IGluIGxpbmUgdG8gYmUgbGFpZCBvdXQgYXQgdGhpcyBkdXJhdGlvbiBsZXZlbCAtIHdoZXJlIHdlJ3ZlIHVzZWQgMiBzcGFjaW5nIHVuaXRzIC0gdGhlbiB3ZSBtdXN0IHVzZSB1cCAzIHNwYWNpbmcgdW5pdHMsIG5vdCA1KVxuXHRcdGZvciAoaT0wO2k8b3RoZXJ2b2ljZXMubGVuZ3RoO2krKykge1xuXHRcdFx0b3RoZXJ2b2ljZXNbaV0uc3BhY2luZ2R1cmF0aW9uLT1zcGFjaW5nZHVyYXRpb247XG5cdFx0XHRvdGhlcnZvaWNlc1tpXS51cGRhdGVOZXh0WCh4LHNwYWNpbmcpOyAvLyBhZGp1c3Qgb3RoZXIgdm9pY2VzIGV4cGVjdGF0aW9uc1xuXHRcdH1cblxuXHRcdC8vIHVwZGF0ZSBpbmRleGVzIG9mIGN1cnJlbnRseSBsYWlkIG91dCBlbGVtc1xuXHRcdGZvciAoaT0wO2k8Y3VycmVudHZvaWNlcy5sZW5ndGg7aSsrKSB7XG5cdFx0XHR2YXIgdm9pY2UgPSBjdXJyZW50dm9pY2VzW2ldO1xuXHRcdFx0dm9pY2UudXBkYXRlSW5kaWNlcygpO1xuXHRcdH1cblx0fSAvLyBmaW5pc2hlZCBsYXlpbmcgb3V0XG5cblxuXHQvLyBmaW5kIHRoZSBncmVhdGVzdCByZW1haW5pbmcgeCBhcyBhIGJhc2UgZm9yIHRoZSB3aWR0aFxuXHRmb3IgKGk9MDtpPHRoaXMudm9pY2VzLmxlbmd0aDtpKyspIHtcblx0XHRpZiAodGhpcy52b2ljZXNbaV0uZ2V0TmV4dFgoKT54KSB7XG5cdFx0XHR4PXRoaXMudm9pY2VzW2ldLmdldE5leHRYKCk7XG5cdFx0XHRzcGFjaW5ndW5pdD10aGlzLnZvaWNlc1tpXS5nZXRTcGFjaW5nVW5pdHMoKTtcblx0XHR9XG5cdH1cblx0Ly9jb25zb2xlLmxvZyhcImdyZWF0ZXN0IHJlbWFpbmluZ1wiLHNwYWNpbmd1bml0LHgpO1xuXHRzcGFjaW5ndW5pdHMrPXNwYWNpbmd1bml0O1xuXHR0aGlzLncgPSB4O1xuXG5cdGZvciAoaT0wO2k8dGhpcy52b2ljZXMubGVuZ3RoO2krKykge1xuXHRcdHRoaXMudm9pY2VzW2ldLnc9dGhpcy53O1xuXHR9XG5cdHJldHVybiB7IHNwYWNpbmdVbml0czogc3BhY2luZ3VuaXRzLCBtaW5TcGFjZTogbWluc3BhY2UgfTtcbn07XG5cblN0YWZmR3JvdXBFbGVtZW50LnByb3RvdHlwZS5jYWxjSGVpZ2h0ID0gZnVuY3Rpb24gKCkge1xuXHQvLyB0aGUgaGVpZ2h0IGlzIGNhbGN1bGF0ZWQgaGVyZSBpbiBhIHBhcmFsbGVsIHdheSB0byB0aGUgZHJhd2luZyBiZWxvdyBpbiBob3BlcyB0aGF0IGJvdGggb2YgdGhlc2UgZnVuY3Rpb25zIHdpbGwgYmUgbW9kaWZpZWQgdG9nZXRoZXIuXG5cdC8vIFRPRE8tUEVSOiBhbHNvIGFkZCB0aGUgc3BhY2UgYmV0d2VlbiBzdGF2ZXMuIChUaGF0J3Mgc3lzdGVtU3RhZmZTZXBhcmF0aW9uLCB3aGljaCBpcyB0aGUgbWluaW11bSBkaXN0YW5jZSBiZXR3ZWVuIHRoZSBzdGFmZiBMSU5FUy4pXG5cdHZhciBoZWlnaHQgPSAwO1xuXHRmb3IgKHZhciBpPTA7aTx0aGlzLnZvaWNlcy5sZW5ndGg7aSsrKSB7XG5cdFx0dmFyIHN0YWZmID0gdGhpcy52b2ljZXNbaV0uc3RhZmY7XG5cdFx0aWYgKCF0aGlzLnZvaWNlc1tpXS5kdXBsaWNhdGUpIHtcblx0XHRcdGhlaWdodCArPSBzdGFmZi50b3A7XG5cdFx0XHRpZiAoc3RhZmYuYm90dG9tIDwgMClcblx0XHRcdFx0aGVpZ2h0ICs9IC1zdGFmZi5ib3R0b207XG5cdFx0fVxuXHR9XG5cdHJldHVybiBoZWlnaHQ7XG59O1xuXG5TdGFmZkdyb3VwRWxlbWVudC5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uIChyZW5kZXJlcikge1xuXHQvLyBXZSBlbnRlciB0aGlzIG1ldGhvZCB3aXRoIHJlbmRlcmVyLnkgcG9pbnRpbmcgdG8gdGhlIHRvcG1vc3QgY29vcmRpbmF0ZSB0aGF0IHdlJ3JlIGFsbG93ZWQgdG8gZHJhdy5cblx0Ly8gQWxsIG9mIHRoZSBjaGlsZHJlbiB0aGF0IHdpbGwgYmUgZHJhd24gaGF2ZSBhIHJlbGF0aXZlIFwicGl0Y2hcIiBzZXQsIHdoZXJlIHplcm8gaXMgdGhlIGZpcnN0IGxlZGdlciBsaW5lIGJlbG93IHRoZSBzdGFmZi5cblx0Ly8gcmVuZGVyZXIueSB3aWxsIGJlIG9mZnNldCBhdCB0aGUgYmVnaW5uaW5nIG9mIGVhY2ggc3RhZmYgYnkgdGhlIGFtb3VudCByZXF1aXJlZCB0byBtYWtlIHRoZSByZWxhdGl2ZSBwaXRjaCB3b3JrLlxuXHQvLyBJZiB0aGVyZSBhcmUgbXVsdGlwbGUgc3RhdmVzLCB0aGVuIHJlbmRlcmVyLnkgd2lsbCBiZSBpbmNyZW1lbnRlZCBmb3IgZWFjaCBuZXcgc3RhZmYuXG5cblx0dmFyIGRlYnVnUHJpbnQ7XG5cdHZhciBjb2xvckluZGV4O1xuXHRpZiAoLypBQkNKUy53cml0ZS5kZWJ1Z1BsYWNlbWVudCovZmFsc2UpIHtcblx0XHR2YXIgY29sb3JzID0gWyBcInJnYigyMDcsMjcsMzYpXCIsIFwicmdiKDE2OCwyMTQsODApXCIsIFwicmdiKDExMCwxNjEsMjI0KVwiLCBcInJnYigxOTEsMTE5LDIxOClcIiwgXCJyZ2IoMTk1LDMwLDE1MSlcIixcblx0XHRcdFwicmdiKDMxLDE3MCwxNzcpXCIsIFwicmdiKDIyMCwxNjYsMTQyKVwiIF07XG5cdFx0ZGVidWdQcmludCA9IGZ1bmN0aW9uKHN0YWZmLCBrZXkpIHtcblx0XHRcdGlmIChzdGFmZi5wb3NpdGlvbllba2V5XSkge1xuXHRcdFx0XHQvL3JlbmRlcmVyLnByaW50SG9yaXpvbnRhbExpbmUoNTAsIHJlbmRlcmVyLmNhbGNZKHN0YWZmLnBvc2l0aW9uWVtrZXldKSwga2V5LnN1YnN0cigwLCA0KSArIFwiIFwiICsgTWF0aC5yb3VuZChzdGFmZi5wb3NpdGlvbllba2V5XSkpO1xuXHRcdFx0XHR2YXIgaGVpZ2h0ID0gc3RhZmYuc3BlY2lhbFlba2V5XSAqIHNwYWNpbmcuU1RFUDtcblx0XHRcdFx0cmVuZGVyZXIucHJpbnRTaGFkZWRCb3gocmVuZGVyZXIucGFkZGluZy5sZWZ0LCByZW5kZXJlci5jYWxjWShzdGFmZi5wb3NpdGlvbllba2V5XSksIHJlbmRlcmVyLmNvbnRyb2xsZXIud2lkdGgsIGhlaWdodCxjb2xvcnNbY29sb3JJbmRleF0sIDAuNCwga2V5LnN1YnN0cigwLCA0KSk7XG5cdFx0XHRcdGNvbG9ySW5kZXggKz0gMTsgaWYgKGNvbG9ySW5kZXggPiA2KSBjb2xvckluZGV4ID0gMDtcblx0XHRcdH1cblx0XHR9O1xuXHR9XG5cblx0Ly8gQW4gaW52aXNpYmxlIG1hcmtlciBpcyB1c2VmdWwgdG8gYmUgYWJsZSB0byBmaW5kIHdoZXJlIGVhY2ggc3lzdGVtIHN0YXJ0cy5cblx0cmVuZGVyZXIuYWRkSW52aXNpYmxlTWFya2VyKFwiYWJjanMtdG9wLW9mLXN5c3RlbVwiKTtcblxuXHR2YXIgc3RhcnRZID0gcmVuZGVyZXIueTsgLy8gU28gdGhhdCBpdCBjYW4gYmUgcmVzdG9yZWQgYWZ0ZXIgd2UncmUgZG9uZS5cblx0Ly8gU2V0IHRoZSBhYnNvbHV0ZSBZIHBvc2l0aW9uIGZvciBlYWNoIHN0YWZmIGhlcmUsIHNvIHRoZSB2b2ljZSBkcmF3aW5nIGJlbG93IGNhbiBqdXN0IHVzZSBpZi5cblx0Zm9yICh2YXIgaiA9IDA7IGogPCB0aGlzLnN0YWZmcy5sZW5ndGg7IGorKykge1xuXHRcdHZhciBzdGFmZjEgPSB0aGlzLnN0YWZmc1tqXTtcblx0XHQvL3JlbmRlcmVyLnByaW50SG9yaXpvbnRhbExpbmUoNTAsIHJlbmRlcmVyLnksIFwic3RhcnRcIik7XG5cdFx0cmVuZGVyZXIubW92ZVkoc3BhY2luZy5TVEVQLCBzdGFmZjEudG9wKTtcblx0XHRzdGFmZjEuYWJzb2x1dGVZID0gcmVuZGVyZXIueTtcblx0XHRpZiAoLypBQkNKUy53cml0ZS5kZWJ1Z1BsYWNlbWVudCovZmFsc2UpIHtcblx0XHRcdGNvbG9ySW5kZXggPSAwO1xuXHRcdFx0cmVuZGVyZXIucHJpbnRTaGFkZWRCb3gocmVuZGVyZXIucGFkZGluZy5sZWZ0LCByZW5kZXJlci5jYWxjWShzdGFmZjEub3JpZ2luYWxUb3ApLCByZW5kZXJlci5jb250cm9sbGVyLndpZHRoLCByZW5kZXJlci5jYWxjWShzdGFmZjEub3JpZ2luYWxCb3R0b20pLXJlbmRlcmVyLmNhbGNZKHN0YWZmMS5vcmlnaW5hbFRvcCksIFwiIzAwMDAwMFwiLCAwLjEpO1xuXHRcdFx0ZGVidWdQcmludChzdGFmZjEsICdjaG9yZEhlaWdodEFib3ZlJyk7XG5cdFx0XHRkZWJ1Z1ByaW50KHN0YWZmMSwgJ2Nob3JkSGVpZ2h0QmVsb3cnKTtcblx0XHRcdGRlYnVnUHJpbnQoc3RhZmYxLCAnZHluYW1pY0hlaWdodEFib3ZlJyk7XG5cdFx0XHRkZWJ1Z1ByaW50KHN0YWZmMSwgJ2R5bmFtaWNIZWlnaHRCZWxvdycpO1xuXHRcdFx0ZGVidWdQcmludChzdGFmZjEsICdlbmRpbmdIZWlnaHRBYm92ZScpO1xuXHRcdFx0ZGVidWdQcmludChzdGFmZjEsICdseXJpY0hlaWdodEFib3ZlJyk7XG5cdFx0XHRkZWJ1Z1ByaW50KHN0YWZmMSwgJ2x5cmljSGVpZ2h0QmVsb3cnKTtcblx0XHRcdGRlYnVnUHJpbnQoc3RhZmYxLCAncGFydEhlaWdodEFib3ZlJyk7XG5cdFx0XHRkZWJ1Z1ByaW50KHN0YWZmMSwgJ3RlbXBvSGVpZ2h0QWJvdmUnKTtcblx0XHRcdGRlYnVnUHJpbnQoc3RhZmYxLCAndm9sdW1lSGVpZ2h0QWJvdmUnKTtcblx0XHRcdGRlYnVnUHJpbnQoc3RhZmYxLCAndm9sdW1lSGVpZ2h0QmVsb3cnKTtcblx0XHR9XG5cdFx0aWYgKHN0YWZmMS5ib3R0b20gPCAwKVxuXHRcdFx0cmVuZGVyZXIubW92ZVkoc3BhY2luZy5TVEVQLCAtc3RhZmYxLmJvdHRvbSk7XG5cdH1cblx0dmFyIHRvcExpbmU7IC8vIHRoZXNlIGFyZSB0byBjb25uZWN0IG11bHRpcGxlIHN0YXZlcy4gV2UgbmVlZCB0byByZW1lbWJlciB3aGVyZSB0aGV5IGFyZS5cblx0dmFyIGJvdHRvbUxpbmU7XG5cblx0dmFyIGJhcnRvcCA9IDA7XG5cdHJlbmRlcmVyLm1lYXN1cmVOdW1iZXIgPSBudWxsO1xuXHRyZW5kZXJlci5ub3RlTnVtYmVyID0gbnVsbDtcblx0Zm9yICh2YXIgaT0wO2k8dGhpcy52b2ljZXMubGVuZ3RoO2krKykge1xuXHRcdHZhciBzdGFmZiA9IHRoaXMudm9pY2VzW2ldLnN0YWZmO1xuXHRcdHJlbmRlcmVyLnkgPSBzdGFmZi5hYnNvbHV0ZVk7XG5cdFx0cmVuZGVyZXIudm9pY2VOdW1iZXIgPSBpO1xuXHRcdC8vcmVuZGVyZXIueSA9IHN0YWZmLnk7XG5cdFx0Ly8gb2Zmc2V0IGZvciBzdGFydGluZyB0aGUgY291bnRpbmcgYXQgbWlkZGxlIENcblx0XHRpZiAoIXRoaXMudm9pY2VzW2ldLmR1cGxpY2F0ZSkge1xuLy9cdFx0XHRyZW5kZXJlci5tb3ZlWShzcGFjaW5nLlNURVAsIHN0YWZmLnRvcCk7XG5cdFx0XHRpZiAoIXRvcExpbmUpIHRvcExpbmUgID0gcmVuZGVyZXIuY2FsY1koMTApO1xuXHRcdFx0Ym90dG9tTGluZSAgPSByZW5kZXJlci5jYWxjWSgyKTtcblx0XHRcdGlmIChzdGFmZi5saW5lcyAhPT0gMCkge1xuXHRcdFx0XHRyZW5kZXJlci5tZWFzdXJlTnVtYmVyID0gbnVsbDtcblx0XHRcdFx0cmVuZGVyZXIubm90ZU51bWJlciA9IG51bGw7XG5cdFx0XHRcdHJlbmRlcmVyLnByaW50U3RhdmUodGhpcy5zdGFydHgsIHRoaXMudywgc3RhZmYubGluZXMpO1xuXHRcdFx0fVxuXHRcdH1cblx0XHR0aGlzLnZvaWNlc1tpXS5kcmF3KHJlbmRlcmVyLCBiYXJ0b3ApO1xuXHRcdHJlbmRlcmVyLm1lYXN1cmVOdW1iZXIgPSBudWxsO1xuXHRcdHJlbmRlcmVyLm5vdGVOdW1iZXIgPSBudWxsO1xuXHRcdGlmICghdGhpcy52b2ljZXNbaV0uZHVwbGljYXRlKSB7XG5cdFx0XHRiYXJ0b3AgPSByZW5kZXJlci5jYWxjWSgyKTsgLy8gVGhpcyBjb25uZWN0cyB0aGUgYmFyIGxpbmVzIGJldHdlZW4gdHdvIGRpZmZlcmVudCBzdGF2ZXMuXG4vL1x0XHRcdGlmIChzdGFmZi5ib3R0b20gPCAwKVxuLy9cdFx0XHRcdHJlbmRlcmVyLm1vdmVZKHNwYWNpbmcuU1RFUCwgLXN0YWZmLmJvdHRvbSk7XG5cdFx0fVxuXHRcdGlmKHRoaXMuYnJhY2UpIHsvL1Rvbnlcblx0XHRcdGlmIChpID09PSB0aGlzLmJyYWNlLmxlbmd0aCAtIDEpIHtcblx0XHRcdFx0aWYgKHRoaXMuYnJhY2UpIHtcblx0XHRcdFx0XHR0aGlzLmJyYWNlLmRyYXcocmVuZGVyZXIsIHRvcExpbmUsIGJvdHRvbUxpbmUpOyAvL3Rvbnlcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXHRyZW5kZXJlci5tZWFzdXJlTnVtYmVyID0gbnVsbDtcblx0cmVuZGVyZXIubm90ZU51bWJlciA9IG51bGw7XG5cblx0Ly8gY29ubmVjdCBhbGwgdGhlIHN0YXZlcyB0b2dldGhlciB3aXRoIGEgdmVydGljYWwgbGluZVxuXHRpZiAodGhpcy5zdGFmZnMubGVuZ3RoPjEpIHtcblx0XHRyZW5kZXJlci5wcmludFN0ZW0odGhpcy5zdGFydHgsIDAuNiwgdG9wTGluZSwgYm90dG9tTGluZSk7XG5cdH1cblx0cmVuZGVyZXIueSA9IHN0YXJ0WTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU3RhZmZHcm91cEVsZW1lbnQ7XG4iLCIvLyAgICBhYmNfdGVtcG9fZWxlbWVudC5qczogRGVmaW5pdGlvbiBvZiB0aGUgVGVtcG9FbGVtZW50IGNsYXNzLlxuLy8gICAgQ29weXJpZ2h0IChDKSAyMDE0LTIwMTggR3JlZ29yeSBEeWtlIChncmVnZHlrZSBhdCBnbWFpbCBkb3QgY29tKSBhbmQgUGF1bCBSb3NlblxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSxcbi8vICAgIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSxcbi8vICAgIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLlxuXG52YXIgQWJzb2x1dGVFbGVtZW50ID0gcmVxdWlyZSgnLi9hYmNfYWJzb2x1dGVfZWxlbWVudCcpO1xudmFyIFJlbGF0aXZlRWxlbWVudCA9IHJlcXVpcmUoJy4vYWJjX3JlbGF0aXZlX2VsZW1lbnQnKTtcblxudmFyIFRlbXBvRWxlbWVudDtcbihmdW5jdGlvbigpIHtcblx0XCJ1c2Ugc3RyaWN0XCI7XG5cdHZhciB0b3RhbEhlaWdodEluUGl0Y2hlcyA9IDU7XG5cblx0VGVtcG9FbGVtZW50ID0gZnVuY3Rpb24gVGVtcG9FbGVtZW50KHRlbXBvLCB0dW5lTnVtYmVyLCBjcmVhdGVOb3RlSGVhZCkge1xuXHRcdHRoaXMudGVtcG8gPSB0ZW1wbztcblx0XHR0aGlzLnR1bmVOdW1iZXIgPSB0dW5lTnVtYmVyO1xuXHRcdHRoaXMudGVtcG9IZWlnaHRBYm92ZSA9IHRvdGFsSGVpZ2h0SW5QaXRjaGVzO1xuXHRcdHRoaXMucGl0Y2ggPSB1bmRlZmluZWQ7IC8vIFRoaXMgd2lsbCBiZSBzZXQgbGF0ZXJcblx0XHRpZiAodGhpcy50ZW1wby5kdXJhdGlvbiAmJiAhdGhpcy50ZW1wby5zdXBwcmVzc0JwbSkge1xuXHRcdFx0dGhpcy5ub3RlID0gdGhpcy5jcmVhdGVOb3RlKGNyZWF0ZU5vdGVIZWFkLCB0ZW1wbywgdHVuZU51bWJlcik7XG5cdFx0fVxuXHR9O1xuXG5cdFRlbXBvRWxlbWVudC5wcm90b3R5cGUuc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzID0gZnVuY3Rpb24ocG9zaXRpb25ZKSB7IC8vIFRPRE8tUEVSOiBUaGlzIG1pZ2h0IG5vdCBiZSBjYWxsZWQuXG5cdFx0dGhpcy5waXRjaCA9IHBvc2l0aW9uWS50ZW1wb0hlaWdodEFib3ZlO1xuXHRcdHRoaXMudG9wID0gcG9zaXRpb25ZLnRlbXBvSGVpZ2h0QWJvdmU7XG5cdFx0dGhpcy5ib3R0b20gPSBwb3NpdGlvblkudGVtcG9IZWlnaHRBYm92ZTtcblx0XHRpZiAodGhpcy5ub3RlKSB7XG5cdFx0XHR2YXIgdGVtcG9QaXRjaCA9IHRoaXMucGl0Y2ggLSB0b3RhbEhlaWdodEluUGl0Y2hlcyArIDE7IC8vIFRoZSBwaXRjaCB3ZSByZWNlaXZlIGlzIHRoZSB0b3Agb2YgdGhlIGFsbG90dGVkIGFyZWE6IGNoYW5nZSB0aGF0IHRvIHByYWN0aWNhbGx5IHRoZSBib3R0b20uXG5cdFx0XHR0aGlzLm5vdGUudG9wID0gdGVtcG9QaXRjaDtcblx0XHRcdHRoaXMubm90ZS5ib3R0b20gPSB0ZW1wb1BpdGNoO1xuXHRcdFx0Zm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLm5vdGUuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRcdFx0dmFyIGNoaWxkID0gdGhpcy5ub3RlLmNoaWxkcmVuW2ldO1xuXHRcdFx0XHRjaGlsZC50b3AgKz0gdGVtcG9QaXRjaDtcblx0XHRcdFx0Y2hpbGQuYm90dG9tICs9IHRlbXBvUGl0Y2g7XG5cdFx0XHRcdGNoaWxkLnBpdGNoICs9IHRlbXBvUGl0Y2g7XG5cdFx0XHRcdGlmIChjaGlsZC5waXRjaDIgIT09IHVuZGVmaW5lZClcblx0XHRcdFx0XHRjaGlsZC5waXRjaDIgKz0gdGVtcG9QaXRjaDtcblx0XHRcdH1cblx0XHR9XG5cdH07XG5cblx0VGVtcG9FbGVtZW50LnByb3RvdHlwZS5zZXRYID0gZnVuY3Rpb24gKHgpIHtcblx0XHR0aGlzLnggPSB4O1xuXHR9O1xuXG5cdFRlbXBvRWxlbWVudC5wcm90b3R5cGUuY3JlYXRlTm90ZSA9IGZ1bmN0aW9uKGNyZWF0ZU5vdGVIZWFkLCB0ZW1wbywgdHVuZU51bWJlcikge1xuXHRcdHZhciB0ZW1wb3NjYWxlID0gMC43NTtcblx0XHR2YXIgZHVyYXRpb24gPSB0ZW1wby5kdXJhdGlvblswXTsgLy8gVE9ETyB3aGVuIG11bHRpcGxlIGR1cmF0aW9uc1xuXHRcdHZhciBhYnNFbGVtID0gbmV3IEFic29sdXRlRWxlbWVudCh0ZW1wbywgZHVyYXRpb24sIDEsICd0ZW1wbycsIHR1bmVOdW1iZXIpO1xuXHRcdC8vIFRoZXJlIGFyZW4ndCBhbiBpbmZpbml0ZSBudW1iZXIgb2Ygbm90ZSB2YWx1ZXMsIGJ1dCB3ZSBhcmUgcGFzc2VkIGEgZmxvYXQsIHNvIGp1c3QgaW4gY2FzZSBzb21ldGhpbmcgaXMgb2ZmIHVwc3RyZWFtLFxuXHRcdC8vIG1lcmdlIGFsbCBvZiB0aGUgaW4gYmV0d2VlbiBwb2ludHMuXG5cdFx0dmFyIGRvdDtcblx0XHR2YXIgZmxhZztcblx0XHR2YXIgbm90ZTtcblx0XHRpZiAoZHVyYXRpb24gPD0gMS8zMikgeyBub3RlID0gXCJub3RlaGVhZHMucXVhcnRlclwiOyBmbGFnID0gXCJmbGFncy51MzJuZFwiOyBkb3QgPSAwOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMS8xNikgeyBub3RlID0gXCJub3RlaGVhZHMucXVhcnRlclwiOyBmbGFnID0gXCJmbGFncy51MTZ0aFwiOyBkb3QgPSAwOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMy8zMikgeyBub3RlID0gXCJub3RlaGVhZHMucXVhcnRlclwiOyBmbGFnID0gXCJmbGFncy51MTZuZFwiOyBkb3QgPSAxOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMS84KSB7IG5vdGUgPSBcIm5vdGVoZWFkcy5xdWFydGVyXCI7IGZsYWcgPSBcImZsYWdzLnU4dGhcIjsgZG90ID0gMDsgfVxuXHRcdGVsc2UgaWYgKGR1cmF0aW9uIDw9IDMvMTYpIHsgbm90ZSA9IFwibm90ZWhlYWRzLnF1YXJ0ZXJcIjsgZmxhZyA9IFwiZmxhZ3MudTh0aFwiOyBkb3QgPSAxOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMS80KSB7IG5vdGUgPSBcIm5vdGVoZWFkcy5xdWFydGVyXCI7IGRvdCA9IDA7IH1cblx0XHRlbHNlIGlmIChkdXJhdGlvbiA8PSAzLzgpIHsgbm90ZSA9IFwibm90ZWhlYWRzLnF1YXJ0ZXJcIjsgZG90ID0gMTsgfVxuXHRcdGVsc2UgaWYgKGR1cmF0aW9uIDw9IDEvMikgeyBub3RlID0gXCJub3RlaGVhZHMuaGFsZlwiOyBkb3QgPSAwOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMy80KSB7IG5vdGUgPSBcIm5vdGVoZWFkcy5oYWxmXCI7IGRvdCA9IDE7IH1cblx0XHRlbHNlIGlmIChkdXJhdGlvbiA8PSAxKSB7IG5vdGUgPSBcIm5vdGVoZWFkcy53aG9sZVwiOyBkb3QgPSAwOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMS41KSB7IG5vdGUgPSBcIm5vdGVoZWFkcy53aG9sZVwiOyBkb3QgPSAxOyB9XG5cdFx0ZWxzZSBpZiAoZHVyYXRpb24gPD0gMikgeyBub3RlID0gXCJub3RlaGVhZHMuZGJsXCI7IGRvdCA9IDA7IH1cblx0XHRlbHNlIHsgbm90ZSA9IFwibm90ZWhlYWRzLmRibFwiOyBkb3QgPSAxOyB9XG5cblx0XHR2YXIgcmV0ID0gY3JlYXRlTm90ZUhlYWQoYWJzRWxlbSxcblx0XHRcdG5vdGUsXG5cdFx0XHR7IHZlcnRpY2FsUG9zOiAwfSwgLy8gVGhpcyBpcyBqdXN0IHRlbXBvcmFyeTogd2UnbGwgb2Zmc2V0IHRoZSB2ZXJ0aWNhbCBwb3NpdGlvbmluZyB3aGVuIHdlIGdldCB0aGUgYWN0dWFsIHZlcnRpY2FsIHNwb3QuXG5cdFx0XHRcInVwXCIsXG5cdFx0XHQwLFxuXHRcdFx0MCxcblx0XHRcdGZsYWcsXG5cdFx0XHRkb3QsXG5cdFx0XHQwLFxuXHRcdFx0dGVtcG9zY2FsZVxuXHRcdCk7XG5cdFx0dmFyIHRlbXBvTm90ZSA9IHJldC5ub3RlaGVhZDtcblx0XHRhYnNFbGVtLmFkZEhlYWQodGVtcG9Ob3RlKTtcblx0XHR2YXIgc3RlbTtcblx0XHRpZiAobm90ZSAhPT0gXCJub3RlaGVhZHMud2hvbGVcIiAmJiBub3RlICE9PSBcIm5vdGVoZWFkcy5kYmxcIikge1xuXHRcdFx0dmFyIHAxID0gMSAvIDMgKiB0ZW1wb3NjYWxlO1xuXHRcdFx0dmFyIHAyID0gNyAqIHRlbXBvc2NhbGU7XG5cdFx0XHR2YXIgZHggPSB0ZW1wb05vdGUuZHggKyB0ZW1wb05vdGUudztcblx0XHRcdHZhciB3aWR0aCA9IC0wLjY7XG5cdFx0XHRzdGVtID0gbmV3IFJlbGF0aXZlRWxlbWVudChudWxsLCBkeCwgMCwgcDEsIHtcInR5cGVcIjogXCJzdGVtXCIsIFwicGl0Y2gyXCI6IHAyLCBsaW5ld2lkdGg6IHdpZHRofSk7XG5cdFx0XHRhYnNFbGVtLmFkZEV4dHJhKHN0ZW0pO1xuXHRcdH1cblx0XHRyZXR1cm4gYWJzRWxlbTtcblx0fTtcblxuXHRUZW1wb0VsZW1lbnQucHJvdG90eXBlLmRyYXcgPSBmdW5jdGlvbihyZW5kZXJlcikge1xuXHRcdHZhciB4ID0gdGhpcy54O1xuXHRcdGlmICh0aGlzLnBpdGNoID09PSB1bmRlZmluZWQpXG5cdFx0XHR3aW5kb3cuY29uc29sZS5lcnJvcihcIlRlbXBvIEVsZW1lbnQgeS1jb29yZGluYXRlIG5vdCBzZXQuXCIpO1xuXG5cdFx0dmFyIHkgPSByZW5kZXJlci5jYWxjWSh0aGlzLnBpdGNoKTtcblx0XHR2YXIgdGV4dDtcblx0XHRpZiAodGhpcy50ZW1wby5wcmVTdHJpbmcpIHtcblx0XHRcdHRleHQgPSByZW5kZXJlci5yZW5kZXJUZXh0KHgsIHksIHRoaXMudGVtcG8ucHJlU3RyaW5nLCAndGVtcG9mb250JywgJ3RlbXBvJywgXCJzdGFydFwiKTtcblx0XHRcdHZhciBwcmVXaWR0aCA9IHRleHQuZ2V0QkJveCgpLndpZHRoO1xuXHRcdFx0dmFyIGNoYXJXaWR0aCA9IHByZVdpZHRoIC8gdGhpcy50ZW1wby5wcmVTdHJpbmcubGVuZ3RoOyAvLyBKdXN0IGdldCBzb21lIGF2ZXJhZ2UgbnVtYmVyIHRvIGluY3JlYXNlIHRoZSBzcGFjaW5nLlxuXHRcdFx0eCArPSBwcmVXaWR0aCArIGNoYXJXaWR0aDtcblx0XHR9XG5cdFx0aWYgKHRoaXMubm90ZSkge1xuXHRcdFx0aWYgKHRoaXMubm90ZSlcblx0XHRcdFx0dGhpcy5ub3RlLnNldFgoeCk7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMubm90ZS5jaGlsZHJlbi5sZW5ndGg7IGkrKylcblx0XHRcdFx0dGhpcy5ub3RlLmNoaWxkcmVuW2ldLmRyYXcocmVuZGVyZXIsIHgpO1xuXHRcdFx0eCArPSAodGhpcy5ub3RlLncgKyA1KTtcblx0XHRcdHZhciBzdHIgPSBcIj0gXCIgKyB0aGlzLnRlbXBvLmJwbTtcblx0XHRcdHRleHQgPSByZW5kZXJlci5yZW5kZXJUZXh0KHgsIHksIHN0ciwgJ3RlbXBvZm9udCcsICd0ZW1wbycsIFwic3RhcnRcIik7XG5cdFx0XHR2YXIgcG9zdFdpZHRoID0gdGV4dC5nZXRCQm94KCkud2lkdGg7XG5cdFx0XHR2YXIgY2hhcldpZHRoMiA9IHBvc3RXaWR0aCAvIHN0ci5sZW5ndGg7IC8vIEp1c3QgZ2V0IHNvbWUgYXZlcmFnZSBudW1iZXIgdG8gaW5jcmVhc2UgdGhlIHNwYWNpbmcuXG5cdFx0XHR4ICs9IHBvc3RXaWR0aCArIGNoYXJXaWR0aDI7XG5cdFx0fVxuXHRcdGlmICh0aGlzLnRlbXBvLnBvc3RTdHJpbmcpIHtcblx0XHRcdHJlbmRlcmVyLnJlbmRlclRleHQoeCwgeSwgdGhpcy50ZW1wby5wb3N0U3RyaW5nLCAndGVtcG9mb250JywgJ3RlbXBvJywgXCJzdGFydFwiKTtcblx0XHR9XG5cdH07XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRlbXBvRWxlbWVudDtcbiIsIi8vICAgIGFiY190aWVfZWxlbWVudC5qczogRGVmaW5pdGlvbiBvZiB0aGUgVGllRWxlbWVudCBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIFRpZUVsZW0gPSBmdW5jdGlvbiBUaWVFbGVtKGFuY2hvcjEsIGFuY2hvcjIsIGFib3ZlLCBmb3JjZWFuZHNoaWZ0LCBpc1RpZSkge1xuXHR0aGlzLmFuY2hvcjEgPSBhbmNob3IxOyAvLyBtdXN0IGhhdmUgYSAueCBhbmQgYSAucGl0Y2gsIGFuZCBhIC5wYXJlbnQgcHJvcGVydHkgb3IgYmUgbnVsbCAobWVhbnMgc3RhcnRzIGF0IHRoZSBcImJlZ2lubmluZ1wiIG9mIHRoZSBsaW5lIC0gYWZ0ZXIga2V5c2lnKVxuXHR0aGlzLmFuY2hvcjIgPSBhbmNob3IyOyAvLyBtdXN0IGhhdmUgYSAueCBhbmQgYSAucGl0Y2ggcHJvcGVydHkgb3IgYmUgbnVsbCAobWVhbnMgZW5kcyBhdCB0aGUgZW5kIG9mIHRoZSBsaW5lKVxuXHR0aGlzLmFib3ZlID0gYWJvdmU7IC8vIHRydWUgaWYgdGhlIGFyYyBjdXJ2ZXMgYWJvdmVcblx0dGhpcy5mb3JjZSA9IGZvcmNlYW5kc2hpZnQ7IC8vIGZvcmNlIHRoZSBhcmMgY3VydmUsIHJlZ2FyZGxlc3Mgb2YgYmVhbWluZyBpZiB0cnVlXG5cdHRoaXMuaXNUaWUgPSBpc1RpZTtcbn07XG5cblRpZUVsZW0ucHJvdG90eXBlLnNldEVuZEFuY2hvciA9IGZ1bmN0aW9uKGFuY2hvcjIpIHtcblx0dGhpcy5hbmNob3IyID0gYW5jaG9yMjsgLy8gbXVzdCBoYXZlIGEgLnggYW5kIGEgLnBpdGNoIHByb3BlcnR5IG9yIGJlIG51bGwgKG1lYW5zIGVuZHMgYXQgdGhlIGVuZCBvZiB0aGUgbGluZSlcblx0aWYgKHRoaXMuaXNUaWUpIHtcblx0XHRpZiAodGhpcy5hbmNob3IxKSAvLyB0aGlzIGNhbiBoYXBwZW4gaWYgdGhlIHRpZSBjb21lcyBmcm9tIHRoZSBwcmV2aW91cyBsaW5lLlxuXHRcdFx0dGhpcy5hbmNob3IxLmlzVGllID0gdHJ1ZTtcblx0XHRpZiAodGhpcy5hbmNob3IyKSAvLyB0aGlzIGNhbiBoYXBwZW4gaWYgdGhlIHRpZSBnb2VzIHRvIHRoZSBuZXh0IGxpbmUuXG5cdFx0XHR0aGlzLmFuY2hvcjIuaXNUaWUgPSB0cnVlO1xuXHR9XG59O1xuXG4vLyBJZiB3ZSBlbmNvdW50ZXIgYSByZXBlYXQgc2lnbiwgdGhlbiB3ZSBkb24ndCB3YW50IHRvIGV4dGVuZCBlaXRoZXIgYSB0aWUgb3IgYSBzbHVyIHBhc3QgaXQsIHNvIHRoZXNlIGFyZSBjYWxsZWQgdG8gYmUgYSBsaW1pdC5cblRpZUVsZW0ucHJvdG90eXBlLnNldFN0YXJ0WCA9IGZ1bmN0aW9uKHN0YXJ0TGltaXRFbGVtKSB7XG5cdHRoaXMuc3RhcnRMaW1pdFggPSBzdGFydExpbWl0RWxlbTtcbn07XG5cblRpZUVsZW0ucHJvdG90eXBlLnNldEVuZFggPSBmdW5jdGlvbihlbmRMaW1pdEVsZW0pIHtcblx0dGhpcy5lbmRMaW1pdFggPSBlbmRMaW1pdEVsZW07XG59O1xuXG5UaWVFbGVtLnByb3RvdHlwZS5zZXRIaW50ID0gZnVuY3Rpb24gKCkge1xuXHR0aGlzLmhpbnQgPSB0cnVlO1xufTtcblxuVGllRWxlbS5wcm90b3R5cGUuc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzID0gZnVuY3Rpb24ocG9zaXRpb25ZKSB7XG5cdC8vIERvZXNuJ3QgZGVwZW5kIG9uIHRoZSBoaWdoZXN0IGFuZCBsb3dlc3QsIHNvIHRoZXJlJ3Mgbm90aGluZyB0byBkbyBoZXJlLlxufTtcblxuVGllRWxlbS5wcm90b3R5cGUubGF5b3V0ID0gZnVuY3Rpb24gKGxpbmVTdGFydFgsIGxpbmVFbmRYKSB7XG5cdGZ1bmN0aW9uIGdldFBpdGNoKGFuY2hvciwgaXNBYm92ZSwgaXNUaWUpIHtcblx0XHRpZiAoaXNUaWUpIHtcblx0XHRcdC8vIEFsd2F5cyBnbyB0byB0aGUgbm90ZVxuXHRcdFx0cmV0dXJuIGFuY2hvci5waXRjaDtcblx0XHR9XG5cdFx0aWYgKGlzQWJvdmUgJiYgYW5jaG9yLmhpZ2hlc3RWZXJ0ICE9PSB1bmRlZmluZWQpXG5cdFx0XHRyZXR1cm4gYW5jaG9yLmhpZ2hlc3RWZXJ0O1xuXHRcdHJldHVybiBhbmNob3IucGl0Y2g7XG5cdH1cblx0Ly8gV2Ugbm93IGhhdmUgYWxsIG9mIHRoZSBpbnB1dCB2YXJpYWJsZXMgc2V0LCBzbyB3ZSBjYW4gZmlndXJlIG91dCB0aGUgc3RhcnQgYW5kIGVuZGluZyB4LHkgY29vcmRpbmF0ZXMsIGFuZCBmaW5hbGl6ZSB0aGUgZGlyZWN0aW9uIG9mIHRoZSBhcmMuXG5cblx0Ly8gUEVSOiBXZSBtaWdodCBoYXZlIHRvIG92ZXJyaWRlIHRoZSBuYXR1cmFsIHNsdXIgZGlyZWN0aW9uIGlmIHRoZSBmaXJzdCBhbmQgbGFzdCBub3RlcyBhcmUgbm90IGluIHRoZVxuXHQvLyBzYW1lIGRpcmVjdGlvbi4gV2UgYWx3YXlzIHB1dCB0aGUgc2x1ciB1cCBpbiB0aGlzIGNhc2UuIFRoZSBvbmUgY2FzZSB0aGF0IHdvcmtzIG91dCB3cm9uZyBpcyB0aGF0IHdlIGFsd2F5c1xuXHQvLyB3YW50IHRoZSBzbHVyIHRvIGJlIHVwIHdoZW4gdGhlIGxhc3Qgbm90ZSBpcyBzdGVtIGRvd24uIFdlIGNhbiB0ZWxsIHRoZSBzdGVtIGRpcmVjdGlvbiBpZiB0aGUgdG9wIGlzXG5cdC8vIGVxdWFsIHRvIHRoZSBwaXRjaDogaWYgc28sIHRoZXJlIGlzIG5vIHN0ZW0gYWJvdmUgaXQuXG5cdGlmICghdGhpcy5mb3JjZSAmJiB0aGlzLmFuY2hvcjIgJiYgdGhpcy5hbmNob3IyLnBpdGNoID09PSB0aGlzLmFuY2hvcjIuaGlnaGVzdFZlcnQpIC8vIFRPRE8tUEVSOiB0aGlzIGlzIGEgZnJhZ2lsZSB3YXkgdG8gZGV0ZWN0IHRoYXQgdGhlcmUgaXMgbm8gc3RlbSBnb2luZyB1cCBvbiB0aGlzIG5vdGUuXG5cdFx0dGhpcy5hYm92ZSA9IHRydWU7XG5cblx0Ly8gVGhlcmUgaXMgYW4gZXhjZXB0aW9uIGluIHRoZSBzbHVyIGRpcmVjdGlvbiBpZiB0aGVyZSBpcyBhbHNvIGEgdGllIG9uIHRoZSBzdGFydGluZyBvciBlbmRpbmcgbm90ZS5cblx0aWYgKHRoaXMuaXNUaWUpIHtcblx0XHRpZiAodGhpcy5hbmNob3IxKSAvLyB0aGlzIGNhbiBoYXBwZW4gaWYgdGhlIHRpZSBjb21lcyBmcm9tIHRoZSBwcmV2aW91cyBsaW5lLlxuXHRcdFx0dGhpcy5hbmNob3IxLnRpZUFib3ZlID0gdGhpcy5hYm92ZTtcblx0XHRpZiAodGhpcy5hbmNob3IyKSAvLyB0aGlzIGNhbiBoYXBwZW4gaWYgdGhlIHRpZSBnb2VzIHRvIHRoZSBuZXh0IGxpbmUuXG5cdFx0XHR0aGlzLmFuY2hvcjIudGllQWJvdmUgPSB0aGlzLmFib3ZlO1xuXHR9IGVsc2Uge1xuXHRcdGlmICh0aGlzLmFuY2hvcjIgJiYgdGhpcy5hbmNob3IyLmlzVGllKVxuXHRcdFx0dGhpcy5hYm92ZSA9IHRoaXMuYW5jaG9yMi50aWVBYm92ZTtcblx0XHRlbHNlIGlmICh0aGlzLmFuY2hvcjEgJiYgdGhpcy5hbmNob3IxLmlzVGllKVxuXHRcdFx0dGhpcy5hYm92ZSA9IHRoaXMuYW5jaG9yMS50aWVBYm92ZTtcblx0fVxuXHRpZiAodGhpcy5hbmNob3IxKSB7XG5cdFx0dGhpcy5zdGFydFggPSB0aGlzLmFuY2hvcjEueDsgLy8gVGhlIG5vcm1hbCBjYXNlIHdoZXJlIHRoZXJlIGlzIGEgc3RhcnRpbmcgZWxlbWVudCB0byBhdHRhY2ggdG8uXG5cdFx0aWYgKHRoaXMuYW5jaG9yMS5zY2FsZXggPCAxKSAvLyB0aGlzIGlzIGEgZ3JhY2Ugbm90ZSAtIGRvbid0IG9mZnNldCB0aGUgdGllIGFzIG11Y2guXG5cdFx0XHR0aGlzLnN0YXJ0WCAtPSAzO1xuXHR9IGVsc2UgaWYgKHRoaXMuc3RhcnRMaW1pdFgpXG5cdFx0dGhpcy5zdGFydFggPSB0aGlzLnN0YXJ0TGltaXRYLngrdGhpcy5zdGFydExpbWl0WC53OyAvLyBpZiB0aGVyZSBpcyBubyBzdGFydCBlbGVtZW50LCBidXQgdGhlcmUgaXMgYSByZXBlYXQgbWFyayBiZWZvcmUgdGhlIHN0YXJ0IG9mIHRoZSBsaW5lLlxuXHRlbHNlXG5cdFx0dGhpcy5zdGFydFggPSBsaW5lU3RhcnRYOyAvLyBUaGVyZSBpcyBubyBlbGVtZW50IGFuZCBubyByZXBlYXQgbWFyazogZXh0ZW5kIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGxpbmUuXG5cblx0aWYgKHRoaXMuYW5jaG9yMilcblx0XHR0aGlzLmVuZFggPSB0aGlzLmFuY2hvcjIueDsgLy8gVGhlIG5vcm1hbCBjYXNlIHdoZXJlIHRoZXJlIGlzIGEgc3RhcnRpbmcgZWxlbWVudCB0byBhdHRhY2ggdG8uXG5cdGVsc2UgaWYgKHRoaXMuZW5kTGltaXRYKVxuXHRcdHRoaXMuZW5kWCA9IHRoaXMuZW5kTGltaXRYLng7IC8vIGlmIHRoZXJlIGlzIG5vIHN0YXJ0IGVsZW1lbnQsIGJ1dCB0aGVyZSBpcyBhIHJlcGVhdCBtYXJrIGJlZm9yZSB0aGUgc3RhcnQgb2YgdGhlIGxpbmUuXG5cdGVsc2Vcblx0XHR0aGlzLmVuZFggPSBsaW5lRW5kWDsgLy8gVGhlcmUgaXMgbm8gZWxlbWVudCBhbmQgbm8gcmVwZWF0IG1hcms6IGV4dGVuZCB0byB0aGUgYmVnaW5uaW5nIG9mIHRoZSBsaW5lLlxuXG5cdC8vIEZvciB0aGUgcGl0Y2hlcywgaWYgb25lIG9mIHRoZSBhbmNob3JzIGlzIHByZXNlbnQsIGJvdGggb2YgdGhlIHBpdGNoZXMgYXJlIHRoYXQgYW5jaG9yLiBJZiBib3RoIGFyZSBwcmVzZW50LCB0aGVuIHdlIHVzZSBib3RoLiBJZiBuZWl0aGVyIGlzIHByZXNlbnQsIHdlIHVzZSB0aGUgdG9wIG9mIHRoZSBzdGFmZi5cblx0aWYgKHRoaXMuYW5jaG9yMSAmJiB0aGlzLmFuY2hvcjIpIHtcblx0XHR0aGlzLnN0YXJ0WSA9IGdldFBpdGNoKHRoaXMuYW5jaG9yMSwgdGhpcy5hYm92ZSwgdGhpcy5pc1RpZSk7XG5cdFx0dGhpcy5lbmRZID0gZ2V0UGl0Y2godGhpcy5hbmNob3IyLCB0aGlzLmFib3ZlLCB0aGlzLmlzVGllKTtcblx0fSBlbHNlIGlmICh0aGlzLmFuY2hvcjEpIHtcblx0XHR0aGlzLnN0YXJ0WSA9IGdldFBpdGNoKHRoaXMuYW5jaG9yMSwgdGhpcy5hYm92ZSwgdGhpcy5pc1RpZSk7XG5cdFx0dGhpcy5lbmRZID0gZ2V0UGl0Y2godGhpcy5hbmNob3IxLCB0aGlzLmFib3ZlLCB0aGlzLmlzVGllKTtcblx0fSBlbHNlIGlmICh0aGlzLmFuY2hvcjIpIHtcblx0XHR0aGlzLnN0YXJ0WSA9IGdldFBpdGNoKHRoaXMuYW5jaG9yMiwgdGhpcy5hYm92ZSwgdGhpcy5pc1RpZSk7XG5cdFx0dGhpcy5lbmRZID0gZ2V0UGl0Y2godGhpcy5hbmNob3IyLCB0aGlzLmFib3ZlLCB0aGlzLmlzVGllKTtcblx0fSBlbHNlIHtcblx0XHQvLyBUaGlzIGlzIHRoZSBjYXNlIHdoZXJlIHRoZSBzbHVyIGNvdmVycyB0aGUgZW50aXJlIGxpbmUuXG5cdFx0Ly8gVE9ETy1QRVI6IGZpZ3VyZSBvdXQgd2hlcmUgdGhlIHJlYWwgdG9wIGFuZCBib3R0b20gb2YgdGhlIGxpbmUgYXJlLlxuXHRcdHRoaXMuc3RhcnRZID0gdGhpcy5hYm92ZSA/IDE0IDogMDtcblx0XHR0aGlzLmVuZFkgPSB0aGlzLmFib3ZlID8gMTQgOiAwO1xuXHR9XG59O1xuXG5UaWVFbGVtLnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKHJlbmRlcmVyLCBsaW5lc3RhcnR4LCBsaW5lZW5keCkge1xuXHR0aGlzLmxheW91dChsaW5lc3RhcnR4LCBsaW5lZW5keCk7XG5cblx0dmFyIGtsYXNzO1xuXHRpZiAodGhpcy5oaW50KVxuXHRcdFx0a2xhc3MgPSBcImFiY2pzLWhpbnRcIjtcblx0cmVuZGVyZXIuZHJhd0FyYyh0aGlzLnN0YXJ0WCwgdGhpcy5lbmRYLCB0aGlzLnN0YXJ0WSwgdGhpcy5lbmRZLCAgdGhpcy5hYm92ZSwga2xhc3MsIHRoaXMuaXNUaWUpO1xuXG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRpZUVsZW07XG4iLCIvLyAgICBhYmNfdHJpcGxldF9lbGVtZW50LmpzOiBEZWZpbml0aW9uIG9mIHRoZSBUcmlwbGV0RWxlbSBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHNwcmludGYgPSByZXF1aXJlKCcuL3NwcmludGYnKTtcblxudmFyIFRyaXBsZXRFbGVtO1xuXG4oZnVuY3Rpb24oKSB7XG5cdFwidXNlIHN0cmljdFwiO1xuXG5cdFRyaXBsZXRFbGVtID0gZnVuY3Rpb24gVHJpcGxldEVsZW0obnVtYmVyLCBhbmNob3IxKSB7XG5cdFx0dGhpcy5hbmNob3IxID0gYW5jaG9yMTsgLy8gbXVzdCBoYXZlIGEgLnggYW5kIGEgLnBhcmVudCBwcm9wZXJ0eSBvciBiZSBudWxsIChtZWFucyBzdGFydHMgYXQgdGhlIFwiYmVnaW5uaW5nXCIgb2YgdGhlIGxpbmUgLSBhZnRlciBrZXkgc2lnbmF0dXJlKVxuXHRcdHRoaXMubnVtYmVyID0gbnVtYmVyO1xuXHRcdHRoaXMuZHVyYXRpb24gPSAoJycrYW5jaG9yMS5wYXJlbnQuZHVyYXRpb25DbGFzcykucmVwbGFjZSgvXFwuLywgJy0nKTtcblx0fTtcblxuXHRUcmlwbGV0RWxlbS5wcm90b3R5cGUuaXNDbG9zZWQgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gdGhpcy5hbmNob3IyO1xuXHR9O1xuXG5cdFRyaXBsZXRFbGVtLnByb3RvdHlwZS5zZXRDbG9zZUFuY2hvciA9IGZ1bmN0aW9uKGFuY2hvcjIpIHtcblx0XHR0aGlzLmFuY2hvcjIgPSBhbmNob3IyO1xuXHRcdC8vIFRPRE8tUEVSOiBVbmZvcnR1bmF0ZWx5LCBJIGRvbid0IGtub3cgaWYgdGhlcmUgaXMgYSBiZWFtIGFib3ZlIHVudGlsIGFmdGVyIHRoZSB2ZXJ0aWNhbCBwb3NpdGlvbmluZyBpcyBkb25lLFxuXHRcdC8vIHNvIEkgZG9uJ3Qga25vdyB3aGV0aGVyIHRvIGxlYXZlIHJvb20gZm9yIHRoZSBudW1iZXIgYWJvdmUuIFRoZXJlZm9yZSwgSWYgdGhlcmUgaXMgYSBiZWFtIG9uIHRoZSBmaXJzdCBub3RlLCBJJ2xsIGxlYXZlIHJvb20ganVzdCBpbiBjYXNlLlxuXHRcdGlmICh0aGlzLmFuY2hvcjEucGFyZW50LmJlYW0pXG5cdFx0XHR0aGlzLmVuZGluZ0hlaWdodEFib3ZlID0gNDtcblx0fTtcblxuXHRUcmlwbGV0RWxlbS5wcm90b3R5cGUuc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzID0gZnVuY3Rpb24oLypwb3NpdGlvblkqLykge1xuXHR9O1xuXG5cdFRyaXBsZXRFbGVtLnByb3RvdHlwZS5sYXlvdXQgPSBmdW5jdGlvbigpIHtcblx0XHQvLyBUT0RPIGVuZCBhbmQgYmVnaW5uaW5nIG9mIGxpbmUgKFBFUjogUC5TLiBJJ20gbm90IHN1cmUgdGhpcyBjYW4gaGFwcGVuOiBJIHRoaW5rIHRoZSBwYXJzZXIgd2lsbCBhbHdheXMgc3BlY2lmeSBib3RoIHRoZSBzdGFydCBhbmQgZW5kIHBvaW50cy4pXG5cdFx0aWYgKHRoaXMuYW5jaG9yMSAmJiB0aGlzLmFuY2hvcjIpIHtcblx0XHRcdHRoaXMuaGFzQmVhbSA9IHRoaXMuYW5jaG9yMS5wYXJlbnQuYmVhbSAmJiB0aGlzLmFuY2hvcjEucGFyZW50LmJlYW0gPT09IHRoaXMuYW5jaG9yMi5wYXJlbnQuYmVhbTtcblxuXHRcdFx0aWYgKHRoaXMuaGFzQmVhbSkge1xuXHRcdFx0XHQvLyBJZiB0aGVyZSBpcyBhIGJlYW0gdGhlbiB3ZSBkb24ndCBuZWVkIHRvIGRyYXcgYW55dGhpbmcgZXhjZXB0IHRoZSB0ZXh0LiBUaGUgYmVhbSBjb3VsZCBlaXRoZXIgYmUgYWJvdmUgb3IgYmVsb3cuXG5cdFx0XHRcdHZhciBiZWFtID0gdGhpcy5hbmNob3IxLnBhcmVudC5iZWFtO1xuXHRcdFx0XHR2YXIgbGVmdCA9IGJlYW0uaXNBYm92ZSgpID8gdGhpcy5hbmNob3IxLnggKyB0aGlzLmFuY2hvcjEudyA6IHRoaXMuYW5jaG9yMS54O1xuXHRcdFx0XHR0aGlzLnlUZXh0UG9zID0gYmVhbS5oZWlnaHRBdE1pZHBvaW50KGxlZnQsICB0aGlzLmFuY2hvcjIueCk7XG5cdFx0XHRcdHRoaXMueVRleHRQb3MgKz0gYmVhbS5pc0Fib3ZlKCkgPyA0IDogLTQ7IC8vIFRoaXMgY3JlYXRlcyBzb21lIHNwYWNlIGJldHdlZW4gdGhlIGJlYW0gYW5kIHRoZSBudW1iZXIuXG5cdFx0XHRcdGlmIChiZWFtLmlzQWJvdmUoKSlcblx0XHRcdFx0XHR0aGlzLmVuZGluZ0hlaWdodEFib3ZlID0gNDtcblx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdC8vIElmIHRoZXJlIGlzbid0IGEgYmVhbSwgdGhlbiB3ZSBuZWVkIHRvIGRyYXcgdGhlIGJyYWNrZXQgYW5kIHRoZSB0ZXh0LiBUaGUgYnJhY2tldCBpcyBhbHdheXMgYWJvdmUuXG5cdFx0XHRcdC8vIFRoZSBicmFja2V0IGlzIG5ldmVyIGxvd2VyIHRoYW4gdGhlICdhJyBsaW5lLCBidXQgaXMgNCBwaXRjaGVzIGFib3ZlIHRoZSBmaXJzdCBhbmQgbGFzdCBub3Rlcy4gSWYgdGhlcmUgaXNcblx0XHRcdFx0Ly8gYSB0YWxsIG5vdGUgaW4gdGhlIG1pZGRsZSwgdGhlIGJyYWNrZXQgaXMgaG9yaXpvbnRhbCBhbmQgYWJvdmUgdGhlIGhpZ2hlc3Qgbm90ZS5cblx0XHRcdFx0dGhpcy5zdGFydE5vdGUgPSBNYXRoLm1heCh0aGlzLmFuY2hvcjEucGFyZW50LnRvcCwgOSkgKyA0O1xuXHRcdFx0XHR0aGlzLmVuZE5vdGUgPSBNYXRoLm1heCh0aGlzLmFuY2hvcjIucGFyZW50LnRvcCwgOSkgKyA0O1xuXHRcdFx0XHQvLyBUT0RPLVBFUjogRG8gdGhlIGNhc2Ugd2hlcmUgdGhlIG1pZGRsZSBub3RlIGlzIHJlYWxseSBoaWdoLlxuXHRcdFx0XHR0aGlzLnlUZXh0UG9zID0gdGhpcy5zdGFydE5vdGUgKyAodGhpcy5lbmROb3RlIC0gdGhpcy5zdGFydE5vdGUpIC8gMjtcblx0XHRcdH1cblxuXHRcdH1cblx0fTtcblxuXHRUcmlwbGV0RWxlbS5wcm90b3R5cGUuZHJhdyA9IGZ1bmN0aW9uKHJlbmRlcmVyKSB7XG5cdFx0dmFyIHhUZXh0UG9zO1xuXHRcdGlmICh0aGlzLmhhc0JlYW0pIHtcblx0XHRcdHZhciBsZWZ0ID0gdGhpcy5hbmNob3IxLnBhcmVudC5iZWFtLmlzQWJvdmUoKSA/IHRoaXMuYW5jaG9yMS54ICsgdGhpcy5hbmNob3IxLncgOiB0aGlzLmFuY2hvcjEueDtcblx0XHRcdHhUZXh0UG9zID0gdGhpcy5hbmNob3IxLnBhcmVudC5iZWFtLnhBdE1pZHBvaW50KGxlZnQsIHRoaXMuYW5jaG9yMi54KTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0eFRleHRQb3MgPSB0aGlzLmFuY2hvcjEueCArICh0aGlzLmFuY2hvcjIueCArIHRoaXMuYW5jaG9yMi53IC0gdGhpcy5hbmNob3IxLngpIC8gMjtcblx0XHRcdGRyYXdCcmFja2V0KHJlbmRlcmVyLCB0aGlzLmFuY2hvcjEueCwgdGhpcy5zdGFydE5vdGUsIHRoaXMuYW5jaG9yMi54ICsgdGhpcy5hbmNob3IyLncsIHRoaXMuZW5kTm90ZSwgdGhpcy5kdXJhdGlvbik7XG5cdFx0fVxuXHRcdHJlbmRlcmVyLnJlbmRlclRleHQoeFRleHRQb3MsIHJlbmRlcmVyLmNhbGNZKHRoaXMueVRleHRQb3MpLCBcIlwiICsgdGhpcy5udW1iZXIsICd0cmlwbGV0Zm9udCcsIHJlbmRlcmVyLmFkZENsYXNzZXMoJ3RyaXBsZXQgZCcrdGhpcy5kdXJhdGlvbiksIFwibWlkZGxlXCIsIHRydWUpO1xuXHR9O1xuXG5cdGZ1bmN0aW9uIGRyYXdMaW5lKHJlbmRlcmVyLCBsLCB0LCByLCBiLCBkdXJhdGlvbikge1xuXHRcdHZhciBwYXRoU3RyaW5nID0gc3ByaW50ZihcIk0gJWYgJWYgTCAlZiAlZlwiLFxuXHRcdFx0bCwgdCwgciwgYik7XG5cdFx0cmVuZGVyZXIucHJpbnRQYXRoKHtwYXRoOiBwYXRoU3RyaW5nLCBzdHJva2U6IFwiIzAwMDAwMFwiLCAnY2xhc3MnOiByZW5kZXJlci5hZGRDbGFzc2VzKCd0cmlwbGV0IGQnK2R1cmF0aW9uKX0pO1xuXHR9XG5cblx0ZnVuY3Rpb24gZHJhd0JyYWNrZXQocmVuZGVyZXIsIHgxLCB5MSwgeDIsIHkyLCBkdXJhdGlvbikge1xuXHRcdHkxID0gcmVuZGVyZXIuY2FsY1koeTEpO1xuXHRcdHkyID0gcmVuZGVyZXIuY2FsY1koeTIpO1xuXHRcdHZhciBicmFja2V0SGVpZ2h0ID0gNTtcblxuXHRcdC8vIERyYXcgdmVydGljYWwgbGluZXMgYXQgdGhlIGJlZ2lubmluZyBhbmQgZW5kXG5cdFx0ZHJhd0xpbmUocmVuZGVyZXIsIHgxLCB5MSwgeDEsIHkxICsgYnJhY2tldEhlaWdodCwgZHVyYXRpb24pO1xuXHRcdGRyYXdMaW5lKHJlbmRlcmVyLCB4MiwgeTIsIHgyLCB5MiArIGJyYWNrZXRIZWlnaHQsIGR1cmF0aW9uKTtcblxuXHRcdC8vIGZpZ3VyZSBvdXQgbWlkcG9pbnRzIHRvIGRyYXcgdGhlIGJyb2tlbiBsaW5lLlxuXHRcdHZhciBtaWRYID0geDEgKyAoeDIteDEpLzI7XG5cdFx0Ly92YXIgbWlkWSA9IHkxICsgKHkyLXkxKS8yO1xuXHRcdHZhciBnYXBXaWR0aCA9IDg7XG5cdFx0dmFyIHNsb3BlID0gKHkyIC0geTEpIC8gKHgyIC0geDEpO1xuXHRcdHZhciBsZWZ0RW5kWCA9IG1pZFggLSBnYXBXaWR0aDtcblx0XHR2YXIgbGVmdEVuZFkgPSB5MSArIChsZWZ0RW5kWCAtIHgxKSAqIHNsb3BlO1xuXHRcdGRyYXdMaW5lKHJlbmRlcmVyLCB4MSwgeTEsIGxlZnRFbmRYLCBsZWZ0RW5kWSwgZHVyYXRpb24pO1xuXHRcdHZhciByaWdodFN0YXJ0WCA9IG1pZFggKyBnYXBXaWR0aDtcblx0XHR2YXIgcmlnaHRTdGFydFkgPSB5MSArIChyaWdodFN0YXJ0WCAtIHgxKSAqIHNsb3BlO1xuXHRcdGRyYXdMaW5lKHJlbmRlcmVyLCByaWdodFN0YXJ0WCwgcmlnaHRTdGFydFksIHgyLCB5MiwgZHVyYXRpb24pO1xuXHR9XG59KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyaXBsZXRFbGVtO1xuIiwiLy8gICAgYWJjX3ZvaWNlX2VsZW1lbnQuanM6IERlZmluaXRpb24gb2YgdGhlIFZvaWNlRWxlbWVudCBjbGFzcy5cbi8vICAgIENvcHlyaWdodCAoQykgMjAxMC0yMDE4IEdyZWdvcnkgRHlrZSAoZ3JlZ2R5a2UgYXQgZ21haWwgZG90IGNvbSkgYW5kIFBhdWwgUm9zZW5cbi8vXG4vLyAgICBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWRcbi8vICAgIGRvY3VtZW50YXRpb24gZmlsZXMgKHRoZSBcIlNvZnR3YXJlXCIpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uXG4vLyAgICB0aGUgcmlnaHRzIHRvIHVzZSwgY29weSwgbW9kaWZ5LCBtZXJnZSwgcHVibGlzaCwgZGlzdHJpYnV0ZSwgc3VibGljZW5zZSwgYW5kL29yIHNlbGwgY29waWVzIG9mIHRoZSBTb2Z0d2FyZSwgYW5kXG4vLyAgICB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8gdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOlxuLy9cbi8vICAgIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLlxuLy9cbi8vICAgIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCBcIkFTIElTXCIsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HXG4vLyAgICBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkRcbi8vICAgIE5PTklORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxudmFyIHBhcnNlQ29tbW9uID0gcmVxdWlyZSgnLi4vcGFyc2UvYWJjX2NvbW1vbicpO1xuXG52YXIgVm9pY2VFbGVtZW50ID0gZnVuY3Rpb24gVm9pY2VFbGVtZW50KHZvaWNlbnVtYmVyLCB2b2ljZXRvdGFsKSB7XG5cdHRoaXMuY2hpbGRyZW4gPSBbXTtcblx0dGhpcy5iZWFtcyA9IFtdO1xuXHR0aGlzLm90aGVyY2hpbGRyZW4gPSBbXTsgLy8gdGllcywgc2x1cnMsIHRyaXBsZXRzXG5cdHRoaXMudyA9IDA7XG5cdHRoaXMuZHVwbGljYXRlID0gZmFsc2U7XG5cdHRoaXMudm9pY2VudW1iZXIgPSB2b2ljZW51bWJlcjsgLy9udW1iZXIgb2YgdGhlIHZvaWNlIG9uIGEgZ2l2ZW4gc3RhdmUgKG5vdCBzdGFmZmdyb3VwKVxuXHR0aGlzLnZvaWNldG90YWwgPSB2b2ljZXRvdGFsO1xuXHR0aGlzLmJvdHRvbSA9IDc7XG5cdHRoaXMudG9wID0gNztcblx0dGhpcy5zcGVjaWFsWSA9IHtcblx0XHR0ZW1wb0hlaWdodEFib3ZlOiAwLFxuXHRcdHBhcnRIZWlnaHRBYm92ZTogMCxcblx0XHR2b2x1bWVIZWlnaHRBYm92ZTogMCxcblx0XHRkeW5hbWljSGVpZ2h0QWJvdmU6IDAsXG5cdFx0ZW5kaW5nSGVpZ2h0QWJvdmU6IDAsXG5cdFx0Y2hvcmRIZWlnaHRBYm92ZTogMCxcblx0XHRseXJpY0hlaWdodEFib3ZlOiAwLFxuXG5cdFx0bHlyaWNIZWlnaHRCZWxvdzogMCxcblx0XHRjaG9yZEhlaWdodEJlbG93OiAwLFxuXHRcdHZvbHVtZUhlaWdodEJlbG93OiAwLFxuXHRcdGR5bmFtaWNIZWlnaHRCZWxvdzogMFxuXHR9O1xufTtcblxuVm9pY2VFbGVtZW50LnByb3RvdHlwZS5hZGRDaGlsZCA9IGZ1bmN0aW9uIChjaGlsZCkge1xuXHRpZiAoY2hpbGQudHlwZSA9PT0gJ2JhcicpIHtcblx0XHR2YXIgZmlyc3RJdGVtID0gdHJ1ZTtcblx0XHRmb3IgKHZhciBpID0gMDsgZmlyc3RJdGVtICYmIGkgPCB0aGlzLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRpZiAodGhpcy5jaGlsZHJlbltpXS50eXBlICE9PSBcInN0YWZmLWV4dHJhXCIpXG5cdFx0XHRcdGZpcnN0SXRlbSA9IGZhbHNlO1xuXHRcdH1cblx0XHRpZiAoIWZpcnN0SXRlbSkge1xuXHRcdFx0dGhpcy5iZWFtcy5wdXNoKFwiYmFyXCIpO1xuXHRcdFx0dGhpcy5vdGhlcmNoaWxkcmVuLnB1c2goXCJiYXJcIik7XG5cdFx0fVxuXHR9XG5cdHRoaXMuY2hpbGRyZW5bdGhpcy5jaGlsZHJlbi5sZW5ndGhdID0gY2hpbGQ7XG5cdHRoaXMuc2V0UmFuZ2UoY2hpbGQpO1xufTtcblxuVm9pY2VFbGVtZW50LnByb3RvdHlwZS5zZXRMaW1pdCA9IGZ1bmN0aW9uKG1lbWJlciwgY2hpbGQpIHtcblx0Ly8gU29tZXRpbWVzIHdlIGdldCBhbiBhYnNvbHV0ZSBlbGVtZW50IGluIGhlcmUgYW5kIHNvbWV0aW1lcyB3ZSBnZXQgc29tZSB0eXBlIG9mIHJlbGF0aXZlIGVsZW1lbnQuXG5cdC8vIElmIHRoZXJlIGlzIGEgXCJzcGVjaWFsWVwiIGVsZW1lbnQsIHRoZW4gYXNzdW1lIGl0IGlzIGFuIGFic29sdXRlIGVsZW1lbnQuIElmIHRoYXQgZG9lc24ndCBleGlzdCwgbG9vayBmb3IgdGhlXG5cdC8vIHNhbWUgbWVtYmVycyBhdCB0aGUgdG9wIGxldmVsLCBiZWNhdXNlIHRoYXQncyB3aGVyZSB0aGV5IGFyZSBpbiByZWxhdGl2ZSBlbGVtZW50cy5cblx0dmFyIHNwZWNpYWxZID0gY2hpbGQuc3BlY2lhbFk7XG5cdGlmICghc3BlY2lhbFkpIHNwZWNpYWxZID0gY2hpbGQ7XG5cdGlmICghc3BlY2lhbFlbbWVtYmVyXSkgcmV0dXJuO1xuXHRpZiAoIXRoaXMuc3BlY2lhbFlbbWVtYmVyXSlcblx0XHR0aGlzLnNwZWNpYWxZW21lbWJlcl0gPSBzcGVjaWFsWVttZW1iZXJdO1xuXHRlbHNlXG5cdFx0dGhpcy5zcGVjaWFsWVttZW1iZXJdID0gTWF0aC5tYXgodGhpcy5zcGVjaWFsWVttZW1iZXJdLCBzcGVjaWFsWVttZW1iZXJdKTtcbn07XG5cblZvaWNlRWxlbWVudC5wcm90b3R5cGUubW92ZURlY29yYXRpb25zID0gZnVuY3Rpb24oYmVhbSkge1xuXHR2YXIgcGFkZGluZyA9IDEuNTsgLy8gVGhpcyBpcyB0aGUgdmVydGljYWwgcGFkZGluZyBiZXR3ZWVuIGVsZW1lbnRzLCBpbiBwaXRjaGVzLlxuXHRmb3IgKHZhciBjaCA9IDA7IGNoIDwgYmVhbS5lbGVtcy5sZW5ndGg7IGNoKyspIHtcblx0XHR2YXIgY2hpbGQgPSBiZWFtLmVsZW1zW2NoXTtcblx0XHRpZiAoY2hpbGQudG9wKSB7XG5cdFx0XHQvLyBXZSBub3cga25vdyB3aGVyZSB0aGUgb3JuYW1lbnRzIHNob3VsZCBoYXZlIGJlZW4gcGxhY2VkLCBzbyBtb3ZlIHRoZW0gaWYgdGhleSB3b3VsZCBvdmVybGFwLlxuXHRcdFx0dmFyIHRvcCA9IGJlYW0ueUF0Tm90ZShjaGlsZCk7XG5cdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IGNoaWxkLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0XHRcdHZhciBlbCA9IGNoaWxkLmNoaWxkcmVuW2ldO1xuXHRcdFx0XHRpZiAoZWwua2xhc3MgPT09ICdvcm5hbWVudCcpIHtcblx0XHRcdFx0XHRpZiAoZWwuYm90dG9tIC0gcGFkZGluZyA8IHRvcCkge1xuXHRcdFx0XHRcdFx0dmFyIGRpc3RhbmNlID0gdG9wIC0gZWwuYm90dG9tICsgcGFkZGluZzsgLy8gRmluZCB0aGUgZGlzdGFuY2UgdGhhdCBpdCBuZWVkcyB0byBtb3ZlIGFuZCBhZGQgYSBsaXR0bGUgbWFyZ2luIHNvIHRoZSBlbGVtZW50IGRvZXNuJ3QgdG91Y2ggdGhlIGJlYW0uXG5cdFx0XHRcdFx0XHRlbC5ib3R0b20gKz0gZGlzdGFuY2U7XG5cdFx0XHRcdFx0XHRlbC50b3AgKz0gZGlzdGFuY2U7XG5cdFx0XHRcdFx0XHRlbC5waXRjaCArPSBkaXN0YW5jZTtcblx0XHRcdFx0XHRcdHRvcCA9IGNoaWxkLnRvcCA9IGVsLnRvcDtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHR9XG5cdH1cbn07XG5cblZvaWNlRWxlbWVudC5wcm90b3R5cGUuYWRqdXN0UmFuZ2UgPSBmdW5jdGlvbihjaGlsZCkge1xuXHRpZiAoY2hpbGQuYm90dG9tICE9PSB1bmRlZmluZWQpXG5cdFx0dGhpcy5ib3R0b20gPSBNYXRoLm1pbih0aGlzLmJvdHRvbSwgY2hpbGQuYm90dG9tKTtcblx0aWYgKGNoaWxkLnRvcCAhPT0gdW5kZWZpbmVkKVxuXHRcdHRoaXMudG9wID0gTWF0aC5tYXgodGhpcy50b3AsIGNoaWxkLnRvcCk7XG59O1xuXG5Wb2ljZUVsZW1lbnQucHJvdG90eXBlLnNldFJhbmdlID0gZnVuY3Rpb24oY2hpbGQpIHtcblx0dGhpcy5hZGp1c3RSYW5nZShjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ3RlbXBvSGVpZ2h0QWJvdmUnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ3BhcnRIZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgndm9sdW1lSGVpZ2h0QWJvdmUnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ2R5bmFtaWNIZWlnaHRBYm92ZScsIGNoaWxkKTtcblx0dGhpcy5zZXRMaW1pdCgnZW5kaW5nSGVpZ2h0QWJvdmUnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ2Nob3JkSGVpZ2h0QWJvdmUnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ2x5cmljSGVpZ2h0QWJvdmUnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ2x5cmljSGVpZ2h0QmVsb3cnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ2Nob3JkSGVpZ2h0QmVsb3cnLCBjaGlsZCk7XG5cdHRoaXMuc2V0TGltaXQoJ3ZvbHVtZUhlaWdodEJlbG93JywgY2hpbGQpO1xuXHR0aGlzLnNldExpbWl0KCdkeW5hbWljSGVpZ2h0QmVsb3cnLCBjaGlsZCk7XG59O1xuXG5Wb2ljZUVsZW1lbnQucHJvdG90eXBlLnNldFVwcGVyQW5kTG93ZXJFbGVtZW50cyA9IGZ1bmN0aW9uKHBvc2l0aW9uWSkge1xuXHR2YXIgaTtcblx0Zm9yIChpID0gMDsgaSA8IHRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgYWJzZWxlbSA9IHRoaXMuY2hpbGRyZW5baV07XG5cdFx0YWJzZWxlbS5zZXRVcHBlckFuZExvd2VyRWxlbWVudHMocG9zaXRpb25ZKTtcblx0fVxuXHRmb3IgKGkgPSAwOyBpIDwgdGhpcy5vdGhlcmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIGFic2VsZW0gPSB0aGlzLm90aGVyY2hpbGRyZW5baV07XG5cdFx0aWYgKHR5cGVvZiBhYnNlbGVtICE9PSAnc3RyaW5nJylcblx0XHRcdGFic2VsZW0uc2V0VXBwZXJBbmRMb3dlckVsZW1lbnRzKHBvc2l0aW9uWSk7XG5cdH1cbn07XG5cblZvaWNlRWxlbWVudC5wcm90b3R5cGUuYWRkT3RoZXIgPSBmdW5jdGlvbiAoY2hpbGQpIHtcblx0dGhpcy5vdGhlcmNoaWxkcmVuLnB1c2goY2hpbGQpO1xuXHR0aGlzLnNldFJhbmdlKGNoaWxkKTtcbn07XG5cblZvaWNlRWxlbWVudC5wcm90b3R5cGUuYWRkQmVhbSA9IGZ1bmN0aW9uIChjaGlsZCkge1xuXHR0aGlzLmJlYW1zLnB1c2goY2hpbGQpO1xufTtcblxuVm9pY2VFbGVtZW50LnByb3RvdHlwZS51cGRhdGVJbmRpY2VzID0gZnVuY3Rpb24gKCkge1xuXHRpZiAoIXRoaXMubGF5b3V0RW5kZWQoKSkge1xuXHRcdHRoaXMuZHVyYXRpb25pbmRleCArPSB0aGlzLmNoaWxkcmVuW3RoaXMuaV0uZHVyYXRpb247XG5cdFx0aWYgKHRoaXMuY2hpbGRyZW5bdGhpcy5pXS5kdXJhdGlvbj09PTApIHRoaXMuZHVyYXRpb25pbmRleCA9IE1hdGgucm91bmQodGhpcy5kdXJhdGlvbmluZGV4KjY0KS82NDsgLy8gZXZlcnl0aW1lIHdlIG1lZXQgYSBiYXJsaW5lLCBkbyByb3VuZGluZyB0byBuZWFyZXN0IDY0dGhcblx0XHR0aGlzLmkrKztcblx0fVxufTtcblxuVm9pY2VFbGVtZW50LnByb3RvdHlwZS5sYXlvdXRFbmRlZCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuICh0aGlzLmk+PXRoaXMuY2hpbGRyZW4ubGVuZ3RoKTtcbn07XG5cblZvaWNlRWxlbWVudC5wcm90b3R5cGUuZ2V0RHVyYXRpb25JbmRleCA9IGZ1bmN0aW9uICgpIHtcblx0cmV0dXJuIHRoaXMuZHVyYXRpb25pbmRleCAtICh0aGlzLmNoaWxkcmVuW3RoaXMuaV0gJiYgKHRoaXMuY2hpbGRyZW5bdGhpcy5pXS5kdXJhdGlvbj4wKT8wOjAuMDAwMDAwNSk7IC8vIGlmIHRoZSBpdGggZWxlbWVudCBkb2Vzbid0IGhhdmUgYSBkdXJhdGlvbiAoaXMgbm90IGEgbm90ZSksIGl0cyBkdXJhdGlvbiBpbmRleCBpcyBmcmFjdGlvbmFsbHkgYmVmb3JlLiBUaGlzIGVuYWJsZXMgQ0xFRiBLRVlTSUcgVElNRVNJRyBQQVJULCBldGMuIHRvIGJlIGxhaWQgb3V0IGJlZm9yZSB3ZSBnZXQgdG8gdGhlIGZpcnN0IG5vdGUgb2Ygb3RoZXIgdm9pY2VzXG59O1xuXG4vLyBudW1iZXIgb2Ygc3BhY2luZyB1bml0cyBleHBlY3RlZCBmb3IgbmV4dCBwb3NpdGlvbmluZ1xuVm9pY2VFbGVtZW50LnByb3RvdHlwZS5nZXRTcGFjaW5nVW5pdHMgPSBmdW5jdGlvbiAoKSB7XG5cdHJldHVybiBNYXRoLnNxcnQodGhpcy5zcGFjaW5nZHVyYXRpb24qOCk7XG5cdC8vIFRPRE8tUEVSOiBPbiBzaG9ydCBsaW5lcywgdGhpcyB3b3VsZCBuZXZlciB0cmlnZ2VyLCBzbyB0aGUgc3BhY2luZyB3YXMgd3JvbmcuIEkganVzdCBjaGFuZ2VkIHRoaXMgbGluZSBlbXBpcmljYWxseSwgdGhvdWdoLCBzbyBJIGRvbid0IGtub3cgaWYgdGhlcmUgYXJlIG90aGVyIHJhbWlmaWNhdGlvbnMuXG5cdC8vcmV0dXJuICh0aGlzLm1pbng8dGhpcy5uZXh0eCkgPyBNYXRoLnNxcnQodGhpcy5zcGFjaW5nZHVyYXRpb24qOCkgOiAwOyAvLyB3ZSBoYXZlbid0IHVzZWQgYW55IHNwYWNpbmcgdW5pdHMgaWYgd2UgZW5kIHVwIHVzaW5nIG1pbnhcbn07XG5cbi8vXG5Wb2ljZUVsZW1lbnQucHJvdG90eXBlLmdldE5leHRYID0gZnVuY3Rpb24gKCkge1xuXHRyZXR1cm4gTWF0aC5tYXgodGhpcy5taW54LCB0aGlzLm5leHR4KTtcbn07XG5cblZvaWNlRWxlbWVudC5wcm90b3R5cGUuYmVnaW5MYXlvdXQgPSBmdW5jdGlvbiAoc3RhcnR4KSB7XG5cdHRoaXMuaT0wO1xuXHR0aGlzLmR1cmF0aW9uaW5kZXg9MDtcblx0Ly90aGlzLmlpPXRoaXMuY2hpbGRyZW4ubGVuZ3RoO1xuXHR0aGlzLnN0YXJ0eD1zdGFydHg7XG5cdHRoaXMubWlueD1zdGFydHg7IC8vIGZ1cnRoZXN0IGxlZnQgdG8gd2hlcmUgbmVnYXRpdmVseSBwb3NpdGlvbmVkIGVsZW1lbnRzIGFyZSBhbGxvd2VkIHRvIGdvXG5cdHRoaXMubmV4dHg9c3RhcnR4OyAvLyB4IHBvc2l0aW9uIHdoZXJlIHRoZSBuZXh0IGVsZW1lbnQgb2YgdGhpcyB2b2ljZSBzaG91bGQgYmUgcGxhY2VkIGFzc3VtaW5nIG5vIG90aGVyIHZvaWNlcyBhbmQgbm8gZml4ZWQgd2lkdGggY29uc3RyYWludHNcblx0dGhpcy5zcGFjaW5nZHVyYXRpb249MDsgLy8gZHVyYXRpb24gbGVmdCB0byBiZSBsYWlkIG91dCBpbiBjdXJyZW50IGl0ZXJhdGlvbiAob21pdHRpbmcgYWRkaXRpb25hbCBzcGFjaW5nIGR1ZSB0byBvdGhlciBhc3BlY3RzLCBzdWNoIGFzIGJhcnMsIGRvdHMsIHNoYXJwcyBhbmQgZmxhdHMpXG59O1xuXG4vLyBUcnkgdG8gbGF5b3V0IHRoZSBlbGVtZW50IGF0IGluZGV4IHRoaXMuaVxuLy8geCAtIHBvc2l0aW9uIHRvIHRyeSB0byBsYXlvdXQgdGhlIGVsZW1lbnQgYXRcbi8vIHNwYWNpbmcgLSBiYXNlIHNwYWNpbmdcbi8vIGNhbid0IGNhbGwgdGhpcyBmdW5jdGlvbiBtb3JlIHRoYW4gb25jZSBwZXIgaXRlcmF0aW9uXG5Wb2ljZUVsZW1lbnQucHJvdG90eXBlLmxheW91dE9uZUl0ZW0gPSBmdW5jdGlvbiAoeCwgc3BhY2luZykge1xuXHR2YXIgY2hpbGQgPSB0aGlzLmNoaWxkcmVuW3RoaXMuaV07XG5cdGlmICghY2hpbGQpIHJldHVybiAwO1xuXHR2YXIgZXIgPSB4IC0gdGhpcy5taW54OyAvLyBhdmFpbGFibGUgZXh0cmF3aWR0aCB0byB0aGUgbGVmdFxuXHRpZiAoZXI8Y2hpbGQuZ2V0RXh0cmFXaWR0aCgpKSB7IC8vIHNoaWZ0IHJpZ2h0IGJ5IG5lZWRlZCBhbW91bnRcblx0XHR4Kz1jaGlsZC5nZXRFeHRyYVdpZHRoKCktZXI7XG5cdH1cblx0Y2hpbGQuc2V0WCh4KTtcblxuXHR0aGlzLnNwYWNpbmdkdXJhdGlvbiA9IGNoaWxkLmR1cmF0aW9uO1xuXHQvL3VwZGF0ZSBtaW54XG5cdHRoaXMubWlueCA9IHgrY2hpbGQuZ2V0TWluV2lkdGgoKTsgLy8gYWRkIG5lY2Vzc2FyeSBsYXlvdXQgc3BhY2Vcblx0aWYgKHRoaXMuaSE9PXRoaXMuY2hpbGRyZW4ubGVuZ3RoLTEpIHRoaXMubWlueCs9Y2hpbGQubWluc3BhY2luZzsgLy8gYWRkIG1pbmltdW1zcGFjaW5nIGV4Y2VwdCBvbiBsYXN0IGVsZW1cblxuXHR0aGlzLnVwZGF0ZU5leHRYKHgsIHNwYWNpbmcpO1xuXG5cdC8vIGNvbnRyaWJ1dGUgdG8gc3RhZmYgeSBwb3NpdGlvblxuXHQvL3RoaXMuc3RhZmYudG9wID0gTWF0aC5tYXgoY2hpbGQudG9wLHRoaXMuc3RhZmYudG9wKTtcblx0Ly90aGlzLnN0YWZmLmJvdHRvbSA9IE1hdGgubWluKGNoaWxkLmJvdHRvbSx0aGlzLnN0YWZmLmJvdHRvbSk7XG5cblx0cmV0dXJuIHg7IC8vIHdoZXJlIHdlIGVuZCB1cCBoYXZpbmcgcGxhY2VkIHRoZSBjaGlsZFxufTtcblxuLy8gY2FsbCB3aGVuIHNwYWNpbmdkdXJhdGlvbiBoYXMgYmVlbiB1cGRhdGVkXG5Wb2ljZUVsZW1lbnQucHJvdG90eXBlLnVwZGF0ZU5leHRYID0gZnVuY3Rpb24gKHgsIHNwYWNpbmcpIHtcblx0dGhpcy5uZXh0eD0geCArIChzcGFjaW5nKk1hdGguc3FydCh0aGlzLnNwYWNpbmdkdXJhdGlvbio4KSk7XG59O1xuXG5Wb2ljZUVsZW1lbnQucHJvdG90eXBlLnNoaWZ0UmlnaHQgPSBmdW5jdGlvbiAoZHgpIHtcblx0dmFyIGNoaWxkID0gdGhpcy5jaGlsZHJlblt0aGlzLmldO1xuXHRpZiAoIWNoaWxkKSByZXR1cm47XG5cdGNoaWxkLnNldFgoY2hpbGQueCtkeCk7XG5cdHRoaXMubWlueCs9ZHg7XG5cdHRoaXMubmV4dHgrPWR4O1xufTtcblxuZnVuY3Rpb24gaXNOb25TcGFjZXJSZXN0KGVsZW0pIHtcblx0aWYgKGVsZW0udHlwZSAhPT0gJ3Jlc3QnKVxuXHRcdHJldHVybiBmYWxzZTtcblx0aWYgKGVsZW0uYWJjZWxlbSAmJiBlbGVtLmFiY2VsZW0ucmVzdCAmJiBlbGVtLmFiY2VsZW0ucmVzdC50eXBlICE9PSAnc3BhY2VyJylcblx0XHRyZXR1cm4gdHJ1ZTtcblx0cmV0dXJuIGZhbHNlO1xufVxuVm9pY2VFbGVtZW50LnByb3RvdHlwZS5kcmF3ID0gZnVuY3Rpb24gKHJlbmRlcmVyLCBiYXJ0b3ApIHtcblx0dmFyIHdpZHRoID0gdGhpcy53LTE7XG5cdHJlbmRlcmVyLnN0YWZmYm90dG9tID0gdGhpcy5zdGFmZi5ib3R0b207XG5cdC8vdGhpcy5iYXJib3R0b20gPSByZW5kZXJlci5jYWxjWSgyKTtcblxuXHRyZW5kZXJlci5tZWFzdXJlTnVtYmVyID0gbnVsbDtcblx0cmVuZGVyZXIubm90ZU51bWJlciA9IG51bGw7XG5cdGlmICh0aGlzLmhlYWRlcikgeyAvLyBwcmludCB2b2ljZSBuYW1lXG5cdFx0dmFyIHRleHRwaXRjaCA9IDE0IC0gKHRoaXMudm9pY2VudW1iZXIrMSkqKDEyLyh0aGlzLnZvaWNldG90YWwrMSkpO1xuXHRcdHJlbmRlcmVyLnJlbmRlclRleHQocmVuZGVyZXIucGFkZGluZy5sZWZ0LCByZW5kZXJlci5jYWxjWSh0ZXh0cGl0Y2gpLCB0aGlzLmhlYWRlciwgJ3ZvaWNlZm9udCcsICdzdGFmZi1leHRyYSB2b2ljZS1uYW1lJywgJ3N0YXJ0Jyk7XG5cdH1cblxuXHRmb3IgKHZhciBpPTAsIGlpPXRoaXMuY2hpbGRyZW4ubGVuZ3RoOyBpPGlpOyBpKyspIHtcblx0XHR2YXIgY2hpbGQgPSB0aGlzLmNoaWxkcmVuW2ldO1xuXHRcdHZhciBqdXN0SW5pdGlhbGl6ZWRNZWFzdXJlTnVtYmVyID0gZmFsc2U7XG5cdFx0aWYgKGNoaWxkLnR5cGUgIT09ICdzdGFmZi1leHRyYScgJiYgcmVuZGVyZXIubWVhc3VyZU51bWJlciA9PT0gbnVsbCkge1xuXHRcdFx0cmVuZGVyZXIubWVhc3VyZU51bWJlciA9IDA7XG5cdFx0XHRyZW5kZXJlci5ub3RlTnVtYmVyID0gMDtcblx0XHRcdGp1c3RJbml0aWFsaXplZE1lYXN1cmVOdW1iZXIgPSB0cnVlO1xuXHRcdH1cblx0XHRjaGlsZC5kcmF3KHJlbmRlcmVyLCAodGhpcy5iYXJ0byB8fCBpPT09aWktMSk/YmFydG9wOjApO1xuXHRcdGlmIChjaGlsZC50eXBlID09PSAnbm90ZScgfHwgaXNOb25TcGFjZXJSZXN0KGNoaWxkKSlcblx0XHRcdHJlbmRlcmVyLm5vdGVOdW1iZXIrKztcblx0XHRpZiAoY2hpbGQudHlwZSA9PT0gJ2JhcicgJiYgIWp1c3RJbml0aWFsaXplZE1lYXN1cmVOdW1iZXIpIHtcblx0XHRcdHJlbmRlcmVyLm1lYXN1cmVOdW1iZXIrKztcblx0XHRcdHJlbmRlcmVyLm5vdGVOdW1iZXIgPSAwO1xuXHRcdH1cblx0fVxuXG5cdHJlbmRlcmVyLm1lYXN1cmVOdW1iZXIgPSAwO1xuXHRyZW5kZXJlci5ub3RlTnVtYmVyID0gMDtcblx0cGFyc2VDb21tb24uZWFjaCh0aGlzLmJlYW1zLCBmdW5jdGlvbihiZWFtKSB7XG5cdFx0aWYgKGJlYW0gPT09ICdiYXInKSB7XG5cdFx0XHRyZW5kZXJlci5tZWFzdXJlTnVtYmVyKys7XG5cdFx0XHRyZW5kZXJlci5ub3RlTnVtYmVyID0gMDtcblx0XHR9IGVsc2Vcblx0XHRcdGJlYW0uZHJhdyhyZW5kZXJlcik7IC8vIGJlYW1zIG11c3QgYmUgZHJhd24gZmlyc3QgZm9yIHByb3BlciBwcmludGluZyBvZiB0cmlwbGV0cywgc2x1cnMgYW5kIHRpZXMuXG5cdH0pO1xuXG5cdHJlbmRlcmVyLm1lYXN1cmVOdW1iZXIgPSAwO1xuXHRyZW5kZXJlci5ub3RlTnVtYmVyID0gMDtcblx0dmFyIHNlbGYgPSB0aGlzO1xuXHRwYXJzZUNvbW1vbi5lYWNoKHRoaXMub3RoZXJjaGlsZHJlbiwgZnVuY3Rpb24oY2hpbGQpIHtcblx0XHRpZiAoY2hpbGQgPT09ICdiYXInKSB7XG5cdFx0XHRyZW5kZXJlci5tZWFzdXJlTnVtYmVyKys7XG5cdFx0XHRyZW5kZXJlci5ub3RlTnVtYmVyID0gMDtcblx0XHR9IGVsc2Vcblx0XHRcdGNoaWxkLmRyYXcocmVuZGVyZXIsc2VsZi5zdGFydHgrMTAsd2lkdGgpO1xuXHR9KTtcblxufTtcblxuVm9pY2VFbGVtZW50LnByb3RvdHlwZS5sYXlvdXRCZWFtcyA9IGZ1bmN0aW9uKCkge1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IHRoaXMuYmVhbXMubGVuZ3RoOyBpKyspIHtcblx0XHRpZiAodGhpcy5iZWFtc1tpXS5sYXlvdXQpIHtcblx0XHRcdHRoaXMuYmVhbXNbaV0ubGF5b3V0KCk7XG5cdFx0XHR0aGlzLm1vdmVEZWNvcmF0aW9ucyh0aGlzLmJlYW1zW2ldKTtcblx0XHRcdC8vIFRoZSBhYm92ZSB3aWxsIGNoYW5nZSB0aGUgdG9wIGFuZCBib3R0b20gb2YgdGhlIGFic2VsZW0gY2hpbGRyZW4sIHNvIHNlZSBpZiB3ZSBuZWVkIHRvIGV4cGFuZCBvdXIgcmFuZ2UuXG5cdFx0XHRmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuYmVhbXNbaV0uZWxlbXMubGVuZ3RoOyBqKyspIHtcblx0XHRcdFx0dGhpcy5hZGp1c3RSYW5nZSh0aGlzLmJlYW1zW2ldLmVsZW1zW2pdKTtcblx0XHRcdH1cblx0XHR9XG5cdH1cblx0Ly8gTm93IHdlIGNhbiBsYXlvdXQgdGhlIHRyaXBsZXRzXG5cdGZvciAoaSA9IDA7IGkgPCB0aGlzLm90aGVyY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHR2YXIgY2hpbGQgPSB0aGlzLm90aGVyY2hpbGRyZW5baV07XG5cdFx0aWYgKGNoaWxkLmxheW91dClcblx0XHRcdGNoaWxkLmxheW91dCgpO1xuXHR9XG5cdHRoaXMuc3RhZmYudG9wID0gTWF0aC5tYXgodGhpcy5zdGFmZi50b3AsIHRoaXMudG9wKTtcblx0dGhpcy5zdGFmZi5ib3R0b20gPSBNYXRoLm1pbih0aGlzLnN0YWZmLmJvdHRvbSwgdGhpcy5ib3R0b20pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBWb2ljZUVsZW1lbnQ7XG4iLCIvKipcbiAqIHNwcmludGYoKSBmb3IgSmF2YVNjcmlwdCB2LjAuNFxuICpcbiBDb3B5cmlnaHQgKGMpIDIwMDctcHJlc2VudCwgQWxleGFuZHJ1IE3Eg3LEg8iZdGVhbnUgPGhlbGxvQGFsZXhlaS5ybz5cbiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuXG4gUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0XG4gbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zIGFyZSBtZXQ6XG4gKiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodFxuIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci5cbiAqIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0XG4gbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZVxuIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uXG4gKiBOZWl0aGVyIHRoZSBuYW1lIG9mIHRoaXMgc29mdHdhcmUgbm9yIHRoZSBuYW1lcyBvZiBpdHMgY29udHJpYnV0b3JzIG1heSBiZVxuIHVzZWQgdG8gZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXRcbiBzcGVjaWZpYyBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uXG5cbiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIFRIRSBDT1BZUklHSFQgSE9MREVSUyBBTkQgQ09OVFJJQlVUT1JTIFwiQVMgSVNcIiBBTkRcbiBBTlkgRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUgSU1QTElFRFxuIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBUkVcbiBESVNDTEFJTUVELiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUgQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SXG4gQU5ZIERJUkVDVCwgSU5ESVJFQ1QsIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTXG4gKElOQ0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTO1xuIExPU1MgT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRTOyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORFxuIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElBQklMSVRZLCBPUiBUT1JUXG4gKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUgVVNFIE9GIFRISVNcbiBTT0ZUV0FSRSwgRVZFTiBJRiBBRFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNIIERBTUFHRS5cbiAqL1xuXG4vL2Z1bmN0aW9uIHN0cl9yZXBlYXQoaSwgbSkgeyBmb3IgKHZhciBvID0gW107IG0gPiAwOyBvWy0tbV0gPSBpKTsgcmV0dXJuKG8uam9pbignJykpOyB9XG5cbnZhciBzcHJpbnRmID0gZnVuY3Rpb24oKSB7XG4gIHZhciBpID0gMCwgYSwgZiA9IGFyZ3VtZW50c1tpKytdLCBvID0gW10sIG0sIHAsIGMsIHg7XG4gIHdoaWxlIChmKSB7XG4gICAgaWYgKG0gPSAvXlteXFx4MjVdKy8uZXhlYyhmKSkgby5wdXNoKG1bMF0pO1xuICAgIGVsc2UgaWYgKG0gPSAvXlxceDI1ezJ9Ly5leGVjKGYpKSBvLnB1c2goJyUnKTtcbiAgICBlbHNlIGlmIChtID0gL15cXHgyNSg/OihcXGQrKVxcJCk/KFxcKyk/KDB8J1teJF0pPygtKT8oXFxkKyk/KD86XFwuKFxcZCspKT8oW2ItZm9zdXhYXSkvLmV4ZWMoZikpIHtcbiAgICAgIGlmICgoKGEgPSBhcmd1bWVudHNbbVsxXSB8fCBpKytdKSA9PSBudWxsKSB8fCAoYSA9PSB1bmRlZmluZWQpKSB0aHJvdyhcIlRvbyBmZXcgYXJndW1lbnRzLlwiKTtcbiAgICAgIGlmICgvW15zXS8udGVzdChtWzddKSAmJiAodHlwZW9mKGEpICE9ICdudW1iZXInKSlcbiAgICAgICAgdGhyb3coXCJFeHBlY3RpbmcgbnVtYmVyIGJ1dCBmb3VuZCBcIiArIHR5cGVvZihhKSk7XG4gICAgICBzd2l0Y2ggKG1bN10pIHtcbiAgICAgICAgY2FzZSAnYic6IGEgPSBhLnRvU3RyaW5nKDIpOyBicmVhaztcbiAgICAgICAgY2FzZSAnYyc6IGEgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGEpOyBicmVhaztcbiAgICAgICAgY2FzZSAnZCc6IGEgPSBwYXJzZUludChhKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ2UnOiBhID0gbVs2XSA/IGEudG9FeHBvbmVudGlhbChtWzZdKSA6IGEudG9FeHBvbmVudGlhbCgpOyBicmVhaztcbiAgICAgICAgY2FzZSAnZic6IGEgPSBtWzZdID8gcGFyc2VGbG9hdChhKS50b0ZpeGVkKG1bNl0pIDogcGFyc2VGbG9hdChhKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ28nOiBhID0gYS50b1N0cmluZyg4KTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3MnOiBhID0gKChhID0gU3RyaW5nKGEpKSAmJiBtWzZdID8gYS5zdWJzdHJpbmcoMCwgbVs2XSkgOiBhKTsgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3UnOiBhID0gTWF0aC5hYnMoYSk7IGJyZWFrO1xuICAgICAgICBjYXNlICd4JzogYSA9IGEudG9TdHJpbmcoMTYpOyBicmVhaztcbiAgICAgICAgY2FzZSAnWCc6IGEgPSBhLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpOyBicmVhaztcbiAgICAgIH1cbiAgICAgIGEgPSAoL1tkZWZdLy50ZXN0KG1bN10pICYmIG1bMl0gJiYgYSA+IDAgPyAnKycgKyBhIDogYSk7XG4gICAgICBjID0gbVszXSA/IG1bM10gPT0gJzAnID8gJzAnIDogbVszXS5jaGFyQXQoMSkgOiAnICc7XG4gICAgICB4ID0gbVs1XSAtIFN0cmluZyhhKS5sZW5ndGg7XG4gICAgICBwID0gbVs1XSA/IHN0cl9yZXBlYXQoYywgeCkgOiAnJztcbiAgICAgIG8ucHVzaChtWzRdID8gYSArIHAgOiBwICsgYSk7XG4gICAgfVxuICAgIGVsc2UgdGhyb3cgKFwiSHVoID8hXCIpO1xuICAgIGYgPSBmLnN1YnN0cmluZyhtWzBdLmxlbmd0aCk7XG4gIH1cbiAgcmV0dXJuIG8uam9pbignJyk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHNwcmludGY7XG4iLCIvLyAgICBhYmNfdm9pY2VfZWxlbWVudC5qczogRGVmaW5pdGlvbiBvZiB0aGUgVm9pY2VFbGVtZW50IGNsYXNzLlxuLy8gICAgQ29weXJpZ2h0IChDKSAyMDEwLTIwMTggR3JlZ29yeSBEeWtlIChncmVnZHlrZSBhdCBnbWFpbCBkb3QgY29tKSBhbmQgUGF1bCBSb3NlblxuLy9cbi8vICAgIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZyBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZFxuLy8gICAgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlIFwiU29mdHdhcmVcIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZyB3aXRob3V0IGxpbWl0YXRpb25cbi8vICAgIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmRcbi8vICAgIHRvIHBlcm1pdCBwZXJzb25zIHRvIHdob20gdGhlIFNvZnR3YXJlIGlzIGZ1cm5pc2hlZCB0byBkbyBzbywgc3ViamVjdCB0byB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnM6XG4vL1xuLy8gICAgVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuXG4vL1xuLy8gICAgVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEIFwiQVMgSVNcIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkdcbi8vICAgIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORFxuLy8gICAgTk9OLUlORlJJTkdFTUVOVC4gSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkgQ0xBSU0sXG4vLyAgICBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sXG4vLyAgICBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOIFRIRSBTT0ZUV0FSRS5cblxuLypnbG9iYWwgbW9kdWxlICovXG5cbnZhciBzdmdOUyA9IFwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIjtcblxuZnVuY3Rpb24gU3ZnKHdyYXBwZXIpIHtcblx0dGhpcy5zdmcgPSBjcmVhdGVTdmcoKTtcblx0d3JhcHBlci5hcHBlbmRDaGlsZCh0aGlzLnN2Zyk7XG59XG5cblN2Zy5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcblx0aWYgKHRoaXMuc3ZnKSB7XG5cdFx0dmFyIHdyYXBwZXIgPSB0aGlzLnN2Zy5wYXJlbnROb2RlO1xuXHRcdHRoaXMuc3ZnID0gY3JlYXRlU3ZnKCk7XG5cdFx0aWYgKHdyYXBwZXIpIHtcblx0XHRcdC8vIFRPRE8tUEVSOiBJZiB0aGUgd3JhcHBlciBpcyBub3QgcHJlc2VudCwgdGhlbiB0aGUgdW5kZXJseWluZyBkaXYgd2FzIHB1bGxlZCBvdXQgZnJvbSB1bmRlciB0aGlzIGluc3RhbmNlLiBJdCdzIHBvc3NpYmxlIHRoYXQgaXMgc3RpbGwgdXNlZnVsIChmb3IgY3JlYXRpbmcgdGhlIG11c2ljIG9mZiBwYWdlPylcblx0XHRcdHdyYXBwZXIuaW5uZXJIVE1MID0gXCJcIjtcblx0XHRcdHdyYXBwZXIuYXBwZW5kQ2hpbGQodGhpcy5zdmcpO1xuXHRcdH1cblx0fVxufTtcblxuU3ZnLnByb3RvdHlwZS5zZXRUaXRsZSA9IGZ1bmN0aW9uKHRpdGxlKSB7XG5cdHZhciB0aXRsZUVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInRpdGxlXCIpO1xuXHR2YXIgdGl0bGVOb2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGl0bGUpO1xuXHR0aXRsZUVsLmFwcGVuZENoaWxkKHRpdGxlTm9kZSk7XG5cdHRoaXMuc3ZnLmluc2VydEJlZm9yZSh0aXRsZUVsLCB0aGlzLnN2Zy5maXJzdENoaWxkKTtcbn07XG5cblN2Zy5wcm90b3R5cGUuc2V0UmVzcG9uc2l2ZVdpZHRoID0gZnVuY3Rpb24odywgaCkge1xuXHQvLyB0aGlzIHRlY2huaXF1ZSBpcyBmcm9tOiBodHRwOi8vdGhlbmV3Y29kZS5jb20vNzQ0L01ha2UtU1ZHLVJlc3BvbnNpdmUsIHRoeCB0byBodHRwczovL2dpdGh1Yi5jb20vaWFudHJlc21hblxuXHR0aGlzLnN2Zy5zZXRBdHRyaWJ1dGUoXCJ2aWV3Qm94XCIsIFwiMCAwIFwiICsgdyArIFwiIFwiICsgaCk7XG5cdHRoaXMuc3ZnLnNldEF0dHJpYnV0ZShcInByZXNlcnZlQXNwZWN0UmF0aW9cIiwgXCJ4TWluWU1pbiBtZWV0XCIpO1xuXHR0aGlzLnN2Zy5yZW1vdmVBdHRyaWJ1dGUoXCJoZWlnaHRcIik7XG5cdHRoaXMuc3ZnLnJlbW92ZUF0dHJpYnV0ZShcIndpZHRoXCIpO1xuXHR0aGlzLnN2Zy5zdHlsZVsnZGlzcGxheSddID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0dGhpcy5zdmcuc3R5bGVbJ3Bvc2l0aW9uJ10gPSBcImFic29sdXRlXCI7XG5cdHRoaXMuc3ZnLnN0eWxlWyd0b3AnXSA9IFwiMFwiO1xuXHR0aGlzLnN2Zy5zdHlsZVsnbGVmdCddID0gXCIwXCI7XG5cblx0aWYgKHRoaXMuc3ZnLnBhcmVudE5vZGUpIHtcblx0XHR2YXIgY2xzID0gdGhpcy5zdmcucGFyZW50Tm9kZS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKTtcblx0XHRpZiAoIWNscylcblx0XHRcdHRoaXMuc3ZnLnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKFwiY2xhc3NcIiwgXCJhYmNqcy1jb250YWluZXJcIik7XG5cdFx0ZWxzZSBpZiAoY2xzLmluZGV4T2YoXCJhYmNqcy1jb250YWluZXJcIikgPCAwKVxuXHRcdFx0dGhpcy5zdmcucGFyZW50Tm9kZS5zZXRBdHRyaWJ1dGUoXCJjbGFzc1wiLCBjbHMgKyBcIiBhYmNqcy1jb250YWluZXJcIik7XG5cdFx0dGhpcy5zdmcucGFyZW50Tm9kZS5zdHlsZVsnZGlzcGxheSddID0gXCJpbmxpbmUtYmxvY2tcIjtcblx0XHR0aGlzLnN2Zy5wYXJlbnROb2RlLnN0eWxlWydwb3NpdGlvbiddID0gXCJyZWxhdGl2ZVwiO1xuXHRcdHRoaXMuc3ZnLnBhcmVudE5vZGUuc3R5bGVbJ3dpZHRoJ10gPSBcIjEwMCVcIjtcblx0XHQvLyBQRVI6IEkgY2hhbmdlZCB0aGUgcGFkZGluZyBmcm9tIDEwMCUgdG8gdGhpcyB0aHJvdWdoIHRyaWFsIGFuZCBlcnJvci5cblx0XHQvLyBUaGUgZXhhbXBsZSB3YXMgdXNpbmcgYSBzcXVhcmUgaW1hZ2UsIGJ1dCB0aGlzIG11c2ljIG1pZ2h0IGJlIGVpdGhlciB3aWRlciBvciB0YWxsZXIuXG5cdFx0dmFyIHBhZGRpbmcgPSBoIC8gdyAqIDEwMDtcblx0XHR0aGlzLnN2Zy5wYXJlbnROb2RlLnN0eWxlWydwYWRkaW5nLWJvdHRvbSddID0gcGFkZGluZyArIFwiJVwiO1xuXHRcdHRoaXMuc3ZnLnBhcmVudE5vZGUuc3R5bGVbJ3ZlcnRpY2FsLWFsaWduJ10gPSBcIm1pZGRsZVwiO1xuXHRcdHRoaXMuc3ZnLnBhcmVudE5vZGUuc3R5bGVbJ292ZXJmbG93J10gPSBcImhpZGRlblwiO1xuXHR9XG59O1xuXG5TdmcucHJvdG90eXBlLnNldFNpemUgPSBmdW5jdGlvbih3LCBoKSB7XG5cdHRoaXMuc3ZnLnNldEF0dHJpYnV0ZSgnd2lkdGgnLCB3KTtcblx0dGhpcy5zdmcuc2V0QXR0cmlidXRlKCdoZWlnaHQnLCBoKTtcblx0Ly8gVE9ETy1QRVI6IElzIHRoaXMgaGFjayBzdGlsbCBuZWVkZWQ/XG5cdC8vIENvcnJlY3QgZm9yIElFIHByb2JsZW0gaW4gY2FsY3VsYXRpbmcgaGVpZ2h0XG5cdC8vIHZhciBpc0lFID0gLypAY2Nfb24hQCovZmFsc2U7Ly9JRSBkZXRlY3RvclxuXHQvLyBpZiAoaXNJRSkge1xuXHQvLyBcdHRoaXMucGFwZXIuY2FudmFzLnBhcmVudE5vZGUuc3R5bGUud2lkdGggPSB3ICsgXCJweFwiO1xuXHQvLyBcdHRoaXMucGFwZXIuY2FudmFzLnBhcmVudE5vZGUuc3R5bGUuaGVpZ2h0ID0gXCJcIiArIGggKyBcInB4XCI7XG5cdC8vIH0gZWxzZVxuXHQvLyBcdHRoaXMucGFwZXIuY2FudmFzLnBhcmVudE5vZGUuc2V0QXR0cmlidXRlKFwic3R5bGVcIiwgXCJ3aWR0aDpcIiArIHcgKyBcInB4XCIpO1xufTtcblxuU3ZnLnByb3RvdHlwZS5zZXRTY2FsZSA9IGZ1bmN0aW9uKHNjYWxlKSB7XG5cdGlmIChzY2FsZSAhPT0gMSkge1xuXHRcdHRoaXMuc3ZnLnN0eWxlLnRyYW5zZm9ybSA9IFwic2NhbGUoXCIrc2NhbGUrXCIsXCIrc2NhbGUrXCIpXCI7XG5cdFx0dGhpcy5zdmcuc3R5bGVbJy1tcy10cmFuc2Zvcm0nXSA9IFwic2NhbGUoXCIrc2NhbGUrXCIsXCIrc2NhbGUrXCIpXCI7XG5cdFx0dGhpcy5zdmcuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSBcInNjYWxlKFwiK3NjYWxlK1wiLFwiK3NjYWxlK1wiKVwiO1xuXHRcdHRoaXMuc3ZnLnN0eWxlWyd0cmFuc2Zvcm0tb3JpZ2luJ10gPSBcIjAgMFwiO1xuXHRcdHRoaXMuc3ZnLnN0eWxlWyctbXMtdHJhbnNmb3JtLW9yaWdpbi14J10gPSBcIjBcIjtcblx0XHR0aGlzLnN2Zy5zdHlsZVsnLW1zLXRyYW5zZm9ybS1vcmlnaW4teSddID0gXCIwXCI7XG5cdFx0dGhpcy5zdmcuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtLW9yaWdpbi14J10gPSBcIjBcIjtcblx0XHR0aGlzLnN2Zy5zdHlsZVsnLXdlYmtpdC10cmFuc2Zvcm0tb3JpZ2luLXknXSA9IFwiMFwiO1xuXHR9IGVsc2Uge1xuXHRcdHRoaXMuc3ZnLnN0eWxlLnRyYW5zZm9ybSA9IFwiXCI7XG5cdFx0dGhpcy5zdmcuc3R5bGVbJy1tcy10cmFuc2Zvcm0nXSA9IFwiXCI7XG5cdFx0dGhpcy5zdmcuc3R5bGVbJy13ZWJraXQtdHJhbnNmb3JtJ10gPSBcIlwiO1xuXHR9XG59O1xuXG5TdmcucHJvdG90eXBlLnNldFBhcmVudFN0eWxlcyA9IGZ1bmN0aW9uKGF0dHIpIHtcblx0Ly8gVGhpcyBpcyBuZWVkZWQgdG8gZ2V0IHRoZSBzaXplIHJpZ2h0IHdoZW4gdGhlcmUgaXMgc2NhbGluZyBpbnZvbHZlZC5cblx0Zm9yICh2YXIga2V5IGluIGF0dHIpIHtcblx0XHRpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRpZiAodGhpcy5zdmcucGFyZW50Tm9kZSlcblx0XHRcdFx0dGhpcy5zdmcucGFyZW50Tm9kZS5zdHlsZVtrZXldID0gYXR0cltrZXldO1xuXHRcdH1cblx0fVxufTtcblxuU3ZnLnByb3RvdHlwZS5yZWN0ID0gZnVuY3Rpb24oYXR0cikge1xuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsIFwicmVjdFwiKTtcblx0Zm9yICh2YXIga2V5IGluIGF0dHIpIHtcblx0XHRpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHR2YXIgdG1wID0gXCJcIiArIGF0dHJba2V5XTtcblx0XHRcdGlmICh0bXAuaW5kZXhPZihcIk5hTlwiKSA+PSAwKVxuXHRcdFx0XHRkZWJ1Z2dlcjtcblx0XHRcdGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIGtleSwgYXR0cltrZXldKTtcblx0XHR9XG5cdH1cblx0dGhpcy5hcHBlbmQoZWwpO1xuXHRyZXR1cm4gZWw7XG59O1xuXG5TdmcucHJvdG90eXBlLnRleHQgPSBmdW5jdGlvbih0ZXh0LCBhdHRyKSB7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgJ3RleHQnKTtcblx0Zm9yICh2YXIga2V5IGluIGF0dHIpIHtcblx0XHRpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRlbC5zZXRBdHRyaWJ1dGUoa2V5LCBhdHRyW2tleV0pO1xuXHRcdH1cblx0fVxuXHR2YXIgbGluZXMgPSAoXCJcIit0ZXh0KS5zcGxpdChcIlxcblwiKTtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBsaW5lcy5sZW5ndGg7IGkrKykge1xuXHRcdHZhciBsaW5lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCAndHNwYW4nKTtcblx0XHRsaW5lLnRleHRDb250ZW50ID0gbGluZXNbaV07XG5cdFx0bGluZS5zZXRBdHRyaWJ1dGUoXCJ4XCIsIGF0dHIueCA/IGF0dHIueCA6IDApO1xuXHRcdGlmIChpICE9PSAwKVxuXHRcdFx0bGluZS5zZXRBdHRyaWJ1dGUoXCJkeVwiLCBcIjEuMmVtXCIpO1xuXHRcdGVsLmFwcGVuZENoaWxkKGxpbmUpO1xuXHR9XG5cdHRoaXMuYXBwZW5kKGVsKTtcblx0cmV0dXJuIGVsO1xufTtcblxuU3ZnLnByb3RvdHlwZS5nZXRUZXh0U2l6ZSA9IGZ1bmN0aW9uKHRleHQsIGF0dHIpIHtcblx0dmFyIGVsID0gdGhpcy50ZXh0KHRleHQsIGF0dHIpO1xuXHR2YXIgc2l6ZSA9IGVsLmdldEJCb3goKTtcblx0aWYgKGlzTmFOKHNpemUuaGVpZ2h0KSkgLy8gVGhpcyBjYW4gaGFwcGVuIGlmIHRoZSBlbGVtZW50IGlzbid0IHZpc2libGUuXG5cdFx0c2l6ZSA9IHsgd2lkdGg6IDAsIGhlaWdodDogMH07XG5cdGVsc2Vcblx0XHRzaXplID0geyB3aWR0aDogc2l6ZS53aWR0aCwgaGVpZ2h0OiBzaXplLmhlaWdodCB9O1xuXHQvLyBUT0RPLVBFUjogY2FuIHRoZSBzaXplIGJlIGdvdHRlbiB3aXRob3V0IGluc2VydGluZyBhbmQgZGVsZXRpbmcgdGhlIGVsZW1lbnQ/XG5cdGlmICh0aGlzLmN1cnJlbnRHcm91cClcblx0XHR0aGlzLmN1cnJlbnRHcm91cC5yZW1vdmVDaGlsZChlbCk7XG5cdGVsc2Vcblx0XHR0aGlzLnN2Zy5yZW1vdmVDaGlsZChlbCk7XG5cdHJldHVybiBzaXplO1xufTtcblxuU3ZnLnByb3RvdHlwZS5vcGVuR3JvdXAgPSBmdW5jdGlvbihvcHRpb25zKSB7XG5cdG9wdGlvbnMgPSBvcHRpb25zID8gb3B0aW9ucyA6IHt9O1xuXHR2YXIgZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsIFwiZ1wiKTtcblx0aWYgKG9wdGlvbnMucHJlcGVuZClcblx0XHR0aGlzLnN2Zy5pbnNlcnRCZWZvcmUoZWwsIHRoaXMuc3ZnLmZpcnN0Q2hpbGQpO1xuXHRlbHNlXG5cdFx0dGhpcy5zdmcuYXBwZW5kQ2hpbGQoZWwpO1xuXHR0aGlzLmN1cnJlbnRHcm91cCA9IGVsO1xuXHRyZXR1cm4gZWw7XG59O1xuXG5TdmcucHJvdG90eXBlLmNsb3NlR3JvdXAgPSBmdW5jdGlvbigpIHtcblx0dmFyIGcgPSB0aGlzLmN1cnJlbnRHcm91cDtcblx0dGhpcy5jdXJyZW50R3JvdXAgPSBudWxsO1xuXHRyZXR1cm4gZztcbn07XG5cblN2Zy5wcm90b3R5cGUucGF0aCA9IGZ1bmN0aW9uKGF0dHIpIHtcblx0dmFyIGVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHN2Z05TLCBcInBhdGhcIik7XG5cdGZvciAodmFyIGtleSBpbiBhdHRyKSB7XG5cdFx0aWYgKGF0dHIuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuXHRcdFx0aWYgKGtleSA9PT0gJ3BhdGgnKVxuXHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCAnZCcsIGF0dHIucGF0aCk7XG5cdFx0XHRlbHNlXG5cdFx0XHRcdGVsLnNldEF0dHJpYnV0ZU5TKG51bGwsIGtleSwgYXR0cltrZXldKTtcblx0XHR9XG5cdH1cblx0dGhpcy5hcHBlbmQoZWwpO1xuXHRyZXR1cm4gZWw7XG59O1xuXG5TdmcucHJvdG90eXBlLnBhdGhUb0JhY2sgPSBmdW5jdGlvbihhdHRyKSB7XG5cdHZhciBlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUyhzdmdOUywgXCJwYXRoXCIpO1xuXHRmb3IgKHZhciBrZXkgaW4gYXR0cikge1xuXHRcdGlmIChhdHRyLmhhc093blByb3BlcnR5KGtleSkpIHtcblx0XHRcdGlmIChrZXkgPT09ICdwYXRoJylcblx0XHRcdFx0ZWwuc2V0QXR0cmlidXRlTlMobnVsbCwgJ2QnLCBhdHRyLnBhdGgpO1xuXHRcdFx0ZWxzZVxuXHRcdFx0XHRlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBrZXksIGF0dHJba2V5XSk7XG5cdFx0fVxuXHR9XG5cdHRoaXMucHJlcGVuZChlbCk7XG5cdHJldHVybiBlbDtcbn07XG5cblN2Zy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24oZWwpIHtcblx0aWYgKHRoaXMuY3VycmVudEdyb3VwKVxuXHRcdHRoaXMuY3VycmVudEdyb3VwLmFwcGVuZENoaWxkKGVsKTtcblx0ZWxzZVxuXHRcdHRoaXMuc3ZnLmFwcGVuZENoaWxkKGVsKTtcbn07XG5cblN2Zy5wcm90b3R5cGUucHJlcGVuZCA9IGZ1bmN0aW9uKGVsKSB7XG5cdC8vIFRoZSBlbnRpcmUgZ3JvdXAgaXMgcHJlcGVuZGVkLCBzbyBkb24ndCBwcmVwZW5kIHRoZSBpbmRpdmlkdWFsIGVsZW1lbnRzLlxuXHRpZiAodGhpcy5jdXJyZW50R3JvdXApXG5cdFx0dGhpcy5jdXJyZW50R3JvdXAuYXBwZW5kQ2hpbGQoZWwpO1xuXHRlbHNlXG5cdFx0dGhpcy5zdmcuaW5zZXJ0QmVmb3JlKGVsLCB0aGlzLnN2Zy5maXJzdENoaWxkKTtcbn07XG5cblN2Zy5wcm90b3R5cGUuc2V0QXR0cmlidXRlT25FbGVtZW50ID0gZnVuY3Rpb24oZWwsIGF0dHIpIHtcblx0Zm9yICh2YXIga2V5IGluIGF0dHIpIHtcblx0XHRpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG5cdFx0XHRlbC5zZXRBdHRyaWJ1dGVOUyhudWxsLCBrZXksIGF0dHJba2V5XSk7XG5cdFx0fVxuXHR9XG59O1xuXG5mdW5jdGlvbiBjcmVhdGVTdmcoKSB7XG5cdHZhciBzdmcgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoc3ZnTlMsIFwic3ZnXCIpO1xuXHRzdmcuc2V0QXR0cmlidXRlTlMoXCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3htbG5zL1wiLCBcInhtbG5zOnhsaW5rXCIsIFwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGlua1wiKTtcblx0c3ZnLnNldEF0dHJpYnV0ZSgncm9sZScsICdpbWcnKTsgICAgLy8gZm9yIGFjY2Vzc2liaWxpdHlcblx0cmV0dXJuIHN2Zztcbn1cblxuXG5tb2R1bGUuZXhwb3J0cyA9IFN2ZztcbiJdfQ==
